1. ![[005 1.png]]
Este `fsociety.dic` podría ser un diccionario que podríamos usar más adelante.
2. Mirando más de cerca [[fsocity_dic]], nos damos cuenta de que no es taaaaan larga, sino que hay lineas que se repiten varias veces. Para cambiar eso hacemos `sort fsocity_dic.md | uniq > fsocity_dic_unic.md`. Ya tenemos un diccionario realista.
3. ![[004 1.png]]
Investigando más directorios vemos un directorio raro que habíamos pasado por alto: `/0`.
4. ![[009 1.png]]
Una vez allí vemos que es un "blog" de WP. Veamos la pestaña de Log In...
5. ![[010 1.png]]
Aquí vemos que si ponemos un usuario que no existe nos da un tipo de error.
6. ![[011.png]]
Sin embargo, si ponemos un usuario que sí existe nos da otro tipo de error. Extrapolando el nombre del protagonista de la serie, parece un nombre que posiblemente estaría en la base de datos de usuarios. Pero espera, teníamos un diccionario, vamos a usarlo:
7. ![[012 1.png]]
Haciendo uso del comando: `wpscan --url 10.10.146.45 --wp-content-dir wp-admin --usernames elliot --passwords fsocity_dic_unic.md` comenzamos a extraer información:
8. ![[013.png]]
Boom! Credenciales encontradas, vamos a entrar!
9. ![[14.png]]
Estamos dentro.
10. ![[015 1.png]]
Nos dirigimos a `Appearance > Editor`. El objetivo es cambiar la plantilla `404` (not found) por una reverse shell que sacamos de [aquí](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php).
11. ![[016 1.png]]
Cambiamos la IP y el puerto al de nuestra máquina por el que vayamos a escuchar.
12. ![[017 1.png]]
De esta manera obtenemos una reverse shell sh para investigar.
13. ![[018 1.png]]
Una vez en la consola navegamos por los directorios y nos encontramos con que no podemos leer la clave 2 de 3 porque no tenemos permisos :((. Pero espera, hay un archivo con un usuario y una contraseña en lo que parece ser md5 según el archivo.
14. Todos sabemos que el md5 no es seguro para las contraseñas, precisamente por páginas como [esta](https://md5.gromweb.com/). Introducimos `c3fcd3d76192e4007dfb496cca67e13b` --> `abcdefghijklmnopqrstuvwxyz`. Vamos a probar
15. Para hacer `su robot` necesitamos una tty mejorada, por eso ejecutamos: `python -c 'import pty; pty.spawn("/bin/bash")'`.
16. ![[019 1.png]]
Parece que algo estamos consiguiendo. Al leer los archivos vemos la key 2 de 3: `822c73956184f694993bede3eb39f959`