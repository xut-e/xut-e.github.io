![[Pasted image 20251212101057.png]]

XSS es una vulnerabilidad que permite a los atacantes ejecutar javascript en aplicaciones web. Estos son uno de los bugs más encontrados en aplicaciones web.

Hay tres tipos principales:

| Tipo                     | Descripción                                                                                           |
| ------------------------ | ----------------------------------------------------------------------------------------------------- |
| DOM (Special)            | Usa el entorno HTML para ejecutar JS malicioso.                                                       |
| Persistent (Server-side) | Permite al atacante almacenar código JS malicioso que es ejecutado cuando el cliente carga la página. |
| Reflected (Client-side)  | Es un código JS que corre en el navegador del cliente que lo introduce.                               |

----------------------------------------------------
1. Realiza una DOM XSS.
	1. Probaremos con la barra de búsqueda.
	   ![[Pasted image 20251212110427.png]]
	2. Introduciremos el payload `<iframe src="javascript:alert(`xss`)">`.
	   ![[Pasted image 20251212112133.png]]
	3. Obtenemos la flag.
	   ![[Pasted image 20251212112202.png]]
2. Realiza una Stored XSS.
	1. Iniciamos sessión en la cuenta de administrador.
	   ![[Pasted image 20251212113112.png]]
	2. Vamos a la página "Last Login IP" en "Privacy & Security".
	   ![[Pasted image 20251212114350.png]]
	   ![[Pasted image 20251212114615.png]]
	3. Activamos el modo intercepción de Burp Suite y hacemos log out.
	   ![[Pasted image 20251212114704.png]]
	4. Pillamos la petición.
	   ![[Pasted image 20251212121440.png]]
	5. Metemos la cookie `True-Client-IP` con el valor `<iframe src="javascript:alert('xss')">`.
	   ![[Pasted image 20251212121741.png]]
	6. Hacemos `Forward` de la petición.
	   ![[Pasted image 20251212121808.png]]
	7. Obtenemos la flag.
	   ![[Pasted image 20251212122009.png]]
3. Realiza una Reflected XSS.
	1. Volvemos a la cuenta de administrador, pero esta vez le damos a "Order History" en "Orders & Payment".
	   ![[Pasted image 20251212122510.png]]
	2. Aquí le damos al símbolo del camión.
	   ![[Pasted image 20251212122552.png]]
	3. Eso nos lleva a la página siguiente donde podemos ver que se refleja el id de búsqueda.
	   ![[Pasted image 20251212122652.png]]
	4. Cambiaremos la URL por el JS malicioso y recargamos.
	   ![[Pasted image 20251212123055.png]]
	5. Obtenemos la flag.
	   ![[Pasted image 20251212123116.png]]

