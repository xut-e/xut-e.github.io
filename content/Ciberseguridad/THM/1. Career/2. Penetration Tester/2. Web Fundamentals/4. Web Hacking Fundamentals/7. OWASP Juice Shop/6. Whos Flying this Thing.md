![[Pasted image 20251212144150.png]]

Los sistemas modernos permiten a múltiples usuarios tener acceso a diferentes páginas. Los administradores usan comúnmente páginas de administración para editas, añadir y eliminar contenido de la web. Puedes usarlas cuando estás construyendo un sitio web con herramientas como Weebly o Wix.

Cuando se encuentran exploits de Croken Access Control, pueden categorizarse en uno de estos dos tipos:

| Tipo                                | Descripción                                                                                                                                |
| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| **Horizontal** Privilege Escalation | Ocurre cuando un usuario puede realizar una acción o acceder a información reservada para un usuario con el mismo nivel de privilegios.    |
| **Vertical** Privilege Escalation   | Ocurre cuando un usuario puede realizar una acción o acceder a información reservada para un usuario con un nivel de privilegios superior. |

![[Pasted image 20251211190152.png]]

------------------------------------
1. Accede a la página de administración.
	1. Vamos al Debugger (Firefox) o Sources (Chrome) en las herramientas de desarrollador. Buscamos "main.js", le damos al boton `{}` abajo y luego `Ctrl + F` para buscar "admin".
	   ![[Pasted image 20251211191345.png]]
	   Nos interesa `path: 'administration'`.
	2. Lo buscamos.
	   ![[Pasted image 20251211191940.png]]
	3. Ya habíamos obtenido las credenciales, por lo que vamos a iniciar sesión.
	   ![[Pasted image 20251211193320.png]]
	4. Volvemos a mirar la página de administración.
	   ![[Pasted image 20251211193427.png]]
2. Mira el carrito de la compra de otro usuario.
	1. Nos logueamos como administrador y vamos a "Your Basket".
	   ![[Pasted image 20251212150544.png]]
	2. Capturamos las peticiones y las dejamos pasar con "Forward" hasta vet una que diga `GET /rest/basket/1 HTTP/1.1`.
	   ![[Pasted image 20251212151555.png]]
	3. Cambiamos la terminación por `2` en el repeater y le damos a mandar. Podemos ver que funciona, por lo que podemos hacer lo mismo en el proxy y darle a "Forward".
	   ![[Pasted image 20251212151756.png]]
	4. Obtenemos la flag.
	   ![[Pasted image 20251212151906.png]]
3. Elimina todas las reseñas de 5 estrellas.
	1. Vamos a `http://<IP>/#/administration`.
	   ![[Pasted image 20251212152213.png]]
	2. Eliminamos todas las reseñas con 5 estrellas (sólo hay 1).
	   ![[Pasted image 20251212152240.png]]
	3. Obtenemos la flag.
	   ![[Pasted image 20251212152258.png]]
