La máquina virtual de esta tarea corre el proyecto vulnerable [Hospital Management System](https://github.com/kishan0725/Hospital-Management-System). Fue subido hace unos años y no ha sido actualizado desde entonces. Es funcional, pero una vulnerabilidad stored XSS fue descubierta y nombrada [CVE-2021-38757](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38757) y el exploit fue publicado [aquí](https://packetstormsecurity.com/files/163869/Hospital-Management-System-Cross-Site-Scripting.html).

Para explotar la vulnerabilidad sólo hay que hacer click en "Contact" y rellenar el nombre, email, número de teléfono y subir el payload en el campo del mensaje.

Cualquier mensaje le aparece al recepcionista. Para iniciar sesión como dicho recepcionista, utiliza las credenciales:

- Username: `admin`
- Password: `admin123`

La aplicación vulnerable corre en el puerto `80`.

La vulnerabilidad se encuentra en `contact.php`. 

```php
<?php 
$con=mysqli_connect("localhost","root","","myhmsdb");
if(isset($_POST['btnSubmit']))
{
    $name = $_POST['txtName'];
    $email = $_POST['txtEmail'];
    $contact = $_POST['txtPhone'];
    $message = $_POST['txtMsg'];

    $query="insert into contact(name,email,contact,message) values('$name','$email','$contact','$message');";

//...
}
```

-----------------------------------------
1. Vamos a la página dada.
   ![[Pasted image 20251211162345.png]]
2. Le damos a "CONTACT".
   ![[Pasted image 20251211162410.png]]
3. Rellenamos los campos y el payload.
   ![[Pasted image 20251211163053.png]]
4. Mandamos el mensaje.
   ![[Pasted image 20251211163120.png]]
5. Iniciamos sesión como el recepcionista.
   ![[Pasted image 20251211162846.png]]
6. Nos sale la cookie.
   ![[Pasted image 20251211163158.png]]