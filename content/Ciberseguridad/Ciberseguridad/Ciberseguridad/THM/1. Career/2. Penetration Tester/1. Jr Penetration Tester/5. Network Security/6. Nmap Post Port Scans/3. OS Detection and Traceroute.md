<h2>OS Detection</h2>
Nmap puede detectar el Sistema Operativo (SO) basado en su comportamiento y cualquier detalle en su respuesta. La detección del OS se puede habilitar con la opción `-O` ("o" mayúscula, no cero).

En el siguiente ejemplo, usando la opción, no sólo nos muestra el sistema operativo sino también la versión del kernel.

```shell
pentester@TryHackMe$ sudo nmap -sS -O 10.80.135.73

Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:04 BST
Nmap scan report for 10.80.135.73
Host is up (0.00099s latency).
Not shown: 994 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
25/tcp  open  smtp
80/tcp  open  http
110/tcp open  pop3
111/tcp open  rpcbind
143/tcp open  imap
MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3.13
OS details: Linux 3.13
Network Distance: 1 hop

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 3.91 seconds
```

Aunque es una funcionalidad muy buena, no es 100% precisa y Nmap necesita al menos un puerto abierto y uno cerrado para hacer una estimación realista.

----------------------------------------
<h2>Traceroute</h2>
Si quieres que Nmap encuentre los routers entre tú y tu objetivo, simplemente añade la opción `--traceroute`. El traceroute de Nmap funciona a la inversa que el de Linux o Windows. Mientras que el de ellos empieza con un TTL bajo e incrementa hasta llegar a su objetivo, el de Nmap empieza con un TTL muy alto y va bajando. Veamos un ejemplo de esta opción aplicada.

```shell
pntester@TryHackMe$ sudo nmap -sS --traceroute 10.80.135.73

Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:05 BST
Nmap scan report for 10.80.135.73
Host is up (0.0015s latency).
Not shown: 994 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
25/tcp  open  smtp
80/tcp  open  http
110/tcp open  pop3
111/tcp open  rpcbind
143/tcp open  imap
MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)

TRACEROUTE
HOP RTT     ADDRESS
1   1.48 ms 10.80.135.73

Nmap done: 1 IP address (1 host up) scanned in 1.59 seconds
```

>[!IMPORTANT] Muchos routers están configurados para no mandar ICMP TTL lo que prevendría que descubriésemos su dirección IP.

