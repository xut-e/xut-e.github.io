El XSS reflejado es un tipo de vulnerabilidad XSS donde un script malicioso es reflejado en el navegador del usuario, normalmente vía una URL construida o formulario de subida. Considera una query de búsqueda que contenga `<script>alert(document.cookie)</script>`. Muchos usuarios no sospecharían de dicha URL incluso si la miraran de cerca. Si se procesa por un aplicación vulnerable, será ejecutada en el contexto del navegador del usuario.

--------------------------------
<h2>Aplicación Web Vulnerable</h2>
Una vulnerabilidad XSS reflejada simple es cuando el usuario busca por algún término y el string de búsqueda está incluido en los resultados de búsqueda. Este escenario simple ofrece un objetivo fácil para que el atacante lo explote.

Aunque descubir este tipo de vulnerabiliidades no es siempre fácil, arreglarlos sí lo es. Un input de usuario tal como `<script>alert('XSS')</script>` debería ser sanitizado o HTML-encodeado a `&lt;script&gt;alert('XSS')&lt;/script&gt;`.

En las siguientes subsecciones veremos ejemplos de código vulnerable en los siguientes lenguajes/frameworks.

- PHP
- JavaScript (Node.js)
- Python (Flask)
- C# (ASP.NET)


-------------------------------
<h2>PHP</h2>
<h4>Código Vulnerable</h4>
```php
<?php
$search_query = $_GET['q'];
echo "<p>You searched for: $search_query</p>";
?>
```

Si estás familiarizado con PHP, `$_GET` es una array de PHP que contiene valores de la URL. Además, `$_GET['q']` se refiere al parámetro de la query de string `q`. Por ejemplo, en `http://shop.thm/search.php?q=table`, `$_GET['q']` tiene el valor `table`.

El problema aquí es que el input del usuario no se está sanitizando y está siendo mostrado en la página resultante directamente. Por lo que un atacante puede añadir código malicioso a la URL como `http://shop.thm/search.php?q=<script>alert(document.cookie)</script>` y si el sitio es vulnerable mostrará la cookie de sesión.

<h4>Código Arreglado</h4>
```php
<?php
$search_query = $_GET['q'];
$escaped_search_query = htmlspecialchars($search_query);
echo "<p>You searched for: $escaped_search_query</p>";
?>
```

La función `htmlspecialchars()` convierte caracteres especiales a entidades HTML. Los caracteres `<`, `>`, `&`, `"`, `'` se reemplazan para prevenir el input de scripts al ejecutar. Puedes leer su documentación [aquí](https://www.php.net/htmlspecialchars).

---------------------------------
<h2>JavaScript (Node.js)</h2>


----------------------------
<h2>Python (Flask)</h2>


--------------------------------
<h2>ASP.NET</h2>
