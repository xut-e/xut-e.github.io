Habiendo ganado acceso al sistema de soporte, tenemos ahora la oportunidad de explorar sus funcionalidades y ver qué acciones podemos realizar.

Al acceder a la interfaz de **home** se nos muestra una tabla que enseña los diferentes tickets. Haciendo click en cualquier fila, nos redirige a una página donde podemos ver el ticket completo. Examinando la estructura de la URL, observamos que estas páginas están numeradas usando el formato:

`http://10.10.101.156/support/ticket/NUMBER`

El sistema de numeración indica que a los tickets se les asigna un entero para su ID. Esto nos da dos escenarios posibles:

1. **Access Control:** El endpoint puede estar configurado para restringir el acceso sólo a los tickets asignados a nuestro usuario actual. En este caso sólo podemos ver tickets asociados con nuestra cuenta.
2. **IDOR Vulnerability:** Alternativamente, puede estar mal configurado conllevando a una vulnerabilidad llamada **Insecure Direct Object Reference (IDOR)**. Si este es el caso, podríamos potencialmente explotar el sistema y leer los tickets existentes, sin importar el usuario asignado.

Para investigarlo más, usaremos la herramienta del Intruder para fuzzear el endpoint `/support/ticket/NUMBER`. 

--------------------------------
<h2>Challenge</h2>
1. Vamos a la página dada.
   ![[Pasted image 20251116170930.png]]
2. Iniciamos sesión con los resultados obtenidos de la última práctica.
   ![[Pasted image 20251116171101.png]]
3. Si nos metemos en uno de los tickets vemos el endpoint.
   ![[Pasted image 20251116171146.png]]
4. Capturamos una petición en Burp Suite y la mandamos al Intruder. Seleccionamos Sniper attack y configuramos el número como la parte a fuzzear:
   ![[Pasted image 20251116171352.png]]
5. Creamos una lista con números del 1 al 100.
   ![[Pasted image 20251116171540.png]]
6. Cargamos esa lista en el payload set.
   ![[Pasted image 20251116171618.png]]
7. Comenzamos el ataque y esperamos. Al terminar nos fijaremos en aquellas solicitudes con código de respuesta 200.
   ![[Pasted image 20251116172035.png]]
8. Haciendo click en las peticiones correspondientes y fijándonos en la respuesta llegamos hasta la flag.
   ![[Pasted image 20251116172318.png]]