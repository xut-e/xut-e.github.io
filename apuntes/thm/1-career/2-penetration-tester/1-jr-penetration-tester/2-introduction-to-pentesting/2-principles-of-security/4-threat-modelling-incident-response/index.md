---
layout: apunte
title: "4. Threat Modelling & Incident Response"
---

Threat Modelling es el proceso de revisar, mejorar y testear los protocolos de seguridad de la infraestructura de tecnologías de información de una organización.

Una fase crítica es identificar posibles peligros que pueden enfrentar una aplicación o sistema y sus vulnerabilidades.

El proceso es muy similar al manejo de riesgos hecho por los empleados y clientes en un sitio de trabajo. Los principios son:

- Preparación.
- Identificación.
- Mitigación.
- Revisión.

!**Pasted image 20251102145041.png**

Es, sin embargo un proceso complejo que necesita revisión constante y verlo con un equipo dedicado a ello. Un modelo de amenaza efectivo incluye:

- Inteligencia de amenaza (threat intelligence).
- Identificación de activos (asset identification).
- Capacidades de mitigación (mitigation capabilities).
- Evaluación de riesgos (risk assessment).

Para ayudarnos en esta tarea tenemos frameworks como **STRIDE** (**S**poofing identity (suplantar identidad), **T**ampering with data (manipular información), **R**epudiation threats (amenazas de repudio), **I**nformation disclosure (divulgación de información), **D**enial of service (denegación de servicio) y **E**levation of privileges (elevación de privilegios)) y **PASTA** (**P**rocess for **A**ttack **S**imulation and **T**hreat **A**nalysis (Proceso para la simulación de ataques y análisis de amenazas)).

STRIDE incluye seis principios:


| **Principio**          | **Descripción**                                                                                                                                                                                                                                                         |
| ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Spoofing               | Este principio requiere autentificar las peticiones y los usuarios que acceden al sistema. El spoofing (suplantación) involucra a una parte que se hace pasar por otro.<br><br>Access keys (such as API keys) or signatures via encryption helps remediate this threat. |
| Tampering              | Ofreciendo medidas anti tampering (manipulación) a un sistema o aplicación ayudas a ofrecer y mantener la integridad.                                                                                                                                                   |
| Repudiation            | Dicta el uso de servicios como el registro de actividad para que un sistema o aplicación realice un seguimiento.                                                                                                                                                        |
| Information Disclosure | Las aplicaciones o servicios que tratan con información de múltiples usuarios necesitan ser configuradas de manera apropiada para mostrar sólo la información relevante al dueño.                                                                                       |
| Denial of Service      | Las aplicaciones y servicios usan recursos. Estos deben tener medidas para que en caso de abuso del servicio no se caiga todo el sistema.                                                                                                                               |
| Elevation of Privilege | Este es el peor caso. Significa que un usuario ya consiguió entrar y escalar sus privilegios para hacer lo que quiera. Suele terminar en divulgación de información confidencial u otras formas de post explotación.                                                    |

Una brecha de seguridad se conoce como un incidente. Las acciones tomadas para resolver una amenaza se conocen como IR (Incident Response).

Estos incidentes se clasifican usando una calificación de urgencia e impacto. La urgencia se determina por el tipo de ataque sufrido y el impacto por las posibles consecuencias que puede tener el incidente.

!**Pasted image 20251102154056.png**

A un incidente responde un **C**omputer **S**ecurity **I**ncident **R**espose **T**eam (**CSIRT**; Equipo de Respuesta a Incidentes de Seguridad de Ordenadores), que es un grupo formado por empleados con conocimiento técnicos sobre los sistemas. Para resolver un incidente normalmente nos remitimos a estos seis pasos o fases:


| Acción               | Explicación                                                                                                                        |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| Preparación          | Incluye construir los recursos necesarios para manejar el incidente.                                                               |
| Identificación       | Búsqueda de cualquier comportamiento inusual que indique un incidente.                                                             |
| Contención           | Suele ser hecho aislando la máquina víctima, desactivando sus cuentas, etc.                                                        |
| Erradicación         | Incluye eliminar la amenaza del entorno atacado. Asegura la limpieza del entorno.                                                  |
| Recuperación         | Incluye recuperar los sistemas afectados desde un backup o reconstruirlos.                                                         |
| Lecciones Aprendidas | Una parte muy importante es reflexionar sobre por qué ha ocurrido lo ocurrido. Nos permite mejorar nuestros sistemas de seguridad. |
