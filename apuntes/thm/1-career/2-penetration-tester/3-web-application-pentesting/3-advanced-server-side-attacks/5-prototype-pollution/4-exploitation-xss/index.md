---
layout: apunte
title: "4. Exploitation - XSS"
---

<h2>Acercamiento Estándar</h2>
Como ya sabemos, numerosas propiedades están presentes de forma heredada en el prototipo de un objeto en JavaScript. Entre estas, las propiedades `constructor` y `__proto__` destacan como objetivos de explotación. La propiedad `constructor` apunta a la función que construye el prototipo del objeto, mientras que `__proto__` es una referencia al objeto prototipo del que actualmente el objeto hereda directamente.

--------------------------------
<h2>Regla de Oro</h2>
El concepto orbita entorno a la habilidad del atacante para influenciar ciertos parámetros clave, como `x` y `val`, en expresiones similares a `Person[x][y] = val`. Supón que un atacante asigna `__proto__` a `x`. En dicho caso, el atributo identificado por `y`, es configurado universalmente a lo largo de todos los objetos que comparten la misma clase que el objeto con el valor denotado por `val`.

En un escenario más complejo, cuando un atacante tiene control sobre `x`, `y` y `val` en una estructura como `Person[x][y][z] = val`, asignar `x` como `constructor` e `y` como `prototype` conlleva a que una nueva propiedad definida por `z` se establezca a lo largo de todos los objetos en la aplicación con el `val` asignado. Este acercamiento necesita una organización de las propiedades de un objeto más complejas, haciéndolo menos relevante en la práctica.

----------------------------
<h2>Algunas Funciones Importantes</h2>
Cuando se trata de identificar vulnerabilidades potenciales de contaminación de prototipos, los pentesters deberían enfocarse en vectores/funciones comúnmente susceptibles a la contaminación de prototipos. Es crucial realizar una investigación concienzuda de cómo gestiona la aplicación la manipulación de objetos. Entenderemos unas cuantas funciones que un atacante puede explotar y entonces realizamos la explotación.

- **Property Definition by Path:** Las funciones que configuran propiedades de objetos basadas en una ruta dada (como `object[a][b][c] = value`) pueden ser peligrosas si los componentes de la ruta son controlados por el usuario. Estas funciones deberían ser inspeccionadas para asegurar que no modifican el prototipo de objeto sin avisar. Considera un endpoint que permite a los usuarios actualizar reseñas sobre cualquier amigo.

<h4>Estructura de Objeto Inicial</h4>


-----------------------------------
<h2>Ejemplo Práctico</h2>
