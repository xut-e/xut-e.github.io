[
  {
    "title": "2. The Digital Treasure Hunt",
    "path": "/apuntes/ctfs/1-talent-arena/2026/1-osint/2-the-digital-treasure-hunt/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/1. OSINT/2. The Digital Treasure Hunt.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 1. OSINT",
    "content": "1. Como nos dicen que es un desarrollador, empezaremos buscando su nombre en la plataforma de programadores/desarrolladores y código más famosa del mundo: GitHub.\n   ![[Pasted image 20260210174727.png]]\n   Efectivamente encontramos un usuario.\n2. Si nos metemos en su perfil veremos que sólo tiene un repositorio, por lo que nos meteremos en dicho repositorio.\n   ![[Pasted image 20260210174823.png]]\n3. Vemos un TODO en el que supuestamente ha borrado información sensible, pero nosotros sabemos que no por borrar una parte de código en GitHub se elimina, así que vamos a los commits del repo.\n   ![[Pasted image 20260210174955.png]]\n   Efectivamente vemos que el `.gitignore` no se creó hasta antes de modificar el último commit.\n4. Visto esto decidimos entrar en el commit \"Create utils.js\".\n   ![[Pasted image 20260210175122.png]]\n   En dicho commit nos encontramos un ID: `qcSWnAj0`. Además hay un guiño a la plataforma `pastebin`: \"a more... pasteable place\".\n5. Si vamos a `pastebin.com/ID`, que nos habíamos encontrado, encontramos una nota privada del usuario `DEVZERO-99`.\n   ![[Pasted image 20260210175421.png]]\n   En dicho documento se explica una migración de un proyecto \"secreto\" (no tanto compañero ;) ). Además podemos ver una wallet y el nombre de la testnet usada.\n6. Si vamos a la testnet usada e introducimos el id de la wallet:\n   ![[Pasted image 20260210175631.png]]\n   Podemos ver que ha habido un par de transacciones y una creación de contrato que parece que puede contener información.\n7. Vamos a darle al `Tansaction Hash` de este contrato.\n   ![[Pasted image 20260210180449.png]]\n8. Una vez allí le damos a `+ Click to show more`.\n   ![[Pasted image 20260210180522.png]]\n9. Allí le damos a `View Input As` y seleccionamos `UTF-8`.\n   ![[Pasted image 20260210180603.png]]\n   Aparece un mensaje \"Some secrets are hidden in plain sight. The journey is the reward.\" (\"Algunos secretos están ocultos a simple vista. El viaje es la recompensa.\"). Seguido de una cadena que parece base64: `TVdDe2Qzdl96M3IwX24zdjNyX2QxM3NfMG5fY2g0MW59`.\n10. Convertimos la cadena ASCII.\n    ![[Pasted image 20260210180933.png]]\n\n>[!SUCCESS] ¡¡Reto resuelto!!",
    "modified": "2026-02-11T01:16:12"
  },
  {
    "title": "2. The Rust Dance",
    "path": "/apuntes/ctfs/1-talent-arena/2026/3-reverse-engineering/2-the-rust-dance/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/3. Reverse Engineering/2. The Rust Dance.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 3. Reverse Engineering",
    "content": "1. Empezamos comprobando el tipo de archivo que tenemos en frente.\n   ![[Pasted image 20260210201613.png]]\n2. Ahora vamos a ejecutar el código una vez para ver su comportamiento.\n   ![[Pasted image 20260210201659.png]]\n   Parece que debemos de introducir el código correcto para que el programa nos devuelva la flag.\n3. Vamos a hacer una serie de comprobaciones para ver qué strings hay dentro del código.\n\t1. Empezamos investigando las strings con `strings ./rust-dance`.\n\t   ![[Pasted image 20260210202014.png]]\n\t   Pero hay demasiadas.\n\t   ![[Pasted image 20260210202041.png]]\n\t2. Así que seremos un poco más selectivos.\n\t   ![[Pasted image 20260210202235.png]]\n\t   Aquí vemos algunas coincidencias, pero (aunque hay más) no vemos nada muy interesante.\n\t3. Vamos a observar trazas dinámicas, para ello usamos `strace` y filtramos después.\n\t   ![[Pasted image 20260210202548.png]]\n\t   ![[Pasted image 20260210202734.png]]\n\t   Como `strace` no revela comparaciones en `libc`, el siguiente paso es usar `ltrace` para ver si `memcmp/strcmp/bcmp` existen. Sin embargo, nos ayuda a conocer el punto en el que introducir un `breakpoint` más adelante.\n\t4. Usamos `ltrace`.\n\t   ![[Pasted image 20260210203610.png]]\n\t   Parece que no hay ninguna llamada típica por lo que parece que NO hay una comprobación directa entre dos strings. Lo más probable es que la validación la haga en el código propio sin acceder a más valores de memoria.\n4. Como no hemos detectado nada con `ltrace`, vamos a \"engancharnos\" al punto exacto después del `read()` (que obtuvimos con `strace`) y localizar el bucle de verificación.\n\t1. Para ello arrancamos `gdb` con `gdb -1 ./rust-dance`.\n\t   ![[Pasted image 20260210204016.png]]\n\t2. Introducimos dónde queremos parar la ejecución (cuando llama a la función `read()`).\n\t   ![[Pasted image 20260210204113.png]]\n\t3. Ejecutamos el programa con `run`.\n\t   ![[Pasted image 20260210204153.png]]\n\t   Si nos fijamos en las variables, `$rdi` pone `0x3`. Esto significa que está leyendo un fichero/librería, no `stdin`, que es `fd==0`.\n\t4. Escribimos una condición para que cumpla nuestros requisitos.\n\t   ![[Pasted image 20260210204834.png]]\n\t5. Llegamos al punto donde lee `stdin`, así que salimos del syscall con el comando `ni`. Y entonces introducimos el input.\n\t   ![[Pasted image 20260210205052.png]]\n\t6. Comprobamos que está lo que acabamos de escribir:\n\t   ![[Pasted image 20260210205138.png]]\n\t7. Hacemos `finish` hasta que lleguemos a `rip 0x555555565383`\n\t8. Usamos `disassemble $rip-80, $rip+250` para buscar operaciones que nos recuerden a las que se mencionan en el enunciado (twist, moonwalk, slide, etc.)",
    "modified": "2026-02-11T01:16:12"
  },
  {
    "title": "2. Companion API",
    "path": "/apuntes/ctfs/1-talent-arena/2026/2-web/2-companion-api/",
    "src": "content/Ciberseguridad/CTFs/1. Talent Arena/2026/2. Web/2. Companion API.md",
    "breadcrumb": "CTFs > 1. Talent Arena > 2026 > 2. Web",
    "content": "1. Vamos a la dirección de la API donde encontramos las siguientes instrucciones:\n   ![[Pasted image 20260210184552.png]]\n2. Realizamos la petición por cURL.\n   ![[Pasted image 20260210184637.png]]\n   Guardamos este token en una variable de entorno.\n3. Vamos a intentar encontrar endpoints.\n\t1. Trasteando por la página encontramos lo siguiente:\n\t   ![[Pasted image 20260210185020.png]]\n\t   Esto significa que conocemos los endpoints:\n\t\t- `/api/v1/auth`\n\t\t  ![[Pasted image 20260210185857.png]]\n\t\t- `/api/v1/tickets`\n\t\t  ![[Pasted image 20260210185932.png]]\n\t\t- `/api/v1/users`\n\t\t  ![[Pasted image 20260210185949.png]]\n\t2. Vamos a buscar ahora fuzzeando. Nosotros sabemos que muy seguramente haya algún endpoint para admin, por lo que vamos a fuzzear ahí.\n\t   ![[Pasted image 20260210185726.png]]\n\t   Parece que hemos encontrado otro endpoint: `/api/v1/admin/console`.\n\t   \n\t   En total tenemos los siguientes endpoints para investigar:\n\t   - `/api/v1/auth/login`\n\t   - `/api/v1/users/me`\n\t   - `/api/v1/tickets`\n\t   - `/api/v1/admin/console`\n4. Vamos  a comenzar la investigación de los endpoints.\n\t1. Empezaremos por ver que opciones de método tiene cada uno de ellos.\n\t\t1. `/api/v1/auth/login`:\n\t\t   ![[Pasted image 20260210190408.png]]\n\t\t2. `/api/v1/users/me`:\n\t\t   ![[Pasted image 20260210190427.png]]\n\t\t3. `/api/v1/tickets`:\n\t\t   ![[Pasted image 20260210190549.png]]\n\t\t   Parece que este endpoint necesita un id para obtener el ticket, lo investigaremos más adelante.\n\t\t4. `/api/v1/admin/console`:\n\t\t   ![[Pasted image 20260210190643.png]]\n\t2. Teniendo ya todos los métodos parece que podemos ver que todos son `GET` o `POST` menos uno. En `/api/v1/users/me` está permitido el método `PATCH`.\n\t   ![[Pasted image 20260210190820.png]]\n\t   Parece que podemos haber encontrado un método para modificar algún parámetro importante.\n5. Para seguir investigando endpoints, vamos a ver si podemos obtener algún ticket, aprovechándonos de que este id iba metido en el propio endpoint.\n\t1. Para ello vamos a crear una lista con una secuencia de números de 0000 a 9999.\n\t   ![[Pasted image 20260210191045.png]]\n\t2. Una vez creada vamos a fuzzear el endpoint `/api/v1/tickets/numero`.\n\t   ![[Pasted image 20260210191237.png]]\n\t3. Parece que hemos encontrado ciertos tickets a los que se puede acceder. Vamos a hacer peticiones y observar los resultados.\n\t   ![[Pasted image 20260210192035.png]]\n\t   Parece que acabamos de encontrar el primer fragmento (referido en las instrucciones del reto como `FRAGMENT_2003`): `zWSPcwMG3Y1M`.\n6. Hemos observado también una ruta: `/api/v1/dev/panel`. Vamos a probar a entrar.\n   ![[Pasted image 20260210192656.png]]\n   Parece que sólo `staff` puede verlo.\n7. Además de encontrar el primer fragmento, hemos podido observar que hay al menos un rol más: `staff`. Si vamos a ver lo que nos devuelve el endpoint `/api/v1/users/me`:\n   ![[Pasted image 20260210192416.png]]\n8. Recordamos que en este endpoint podemos usar el método `PATCH`, por lo que vamos a probar a cambiarnos el parámetro `role`.\n   ![[Pasted image 20260210192535.png]]\n   Parece que ha funcionado.\n9. Vamos a obtener un nuevo token, ahora como `staff`, gracias al método `PATCH`. Metemos el token en una nueva variable de entorno.\n   ![[Pasted image 20260210192917.png]]\n10. Con dicho token intentamos volver a acceder al panel de `staff`.\n    ![[Pasted image 20260210193010.png]]\n    Parece que acabamos de encontrar el segundo fragmento: `lYE3tlwIp_Mk`. Además parece que hay otra ruta.\n11. Vamos a ver qué hay en dicha ruta.\n    ![[Pasted image 20260210193146.png]]\n    Parece que acabamos de encontrar la clave de firmado de los JWTs.\n12. En [JWT.io](www.jwt.io) podemos comprobar que efectivamente lo es.\n    ![[Pasted image 20260210193403.png]]\n13. Si le damos a la opción de `JWT Encoder`, en lugar de `JWT Decoder` podemos modificar el contenido del token.\n    ![[Pasted image 20260210193512.png]]\n14. Antes de proceder a comprobar si funciona, vamos a intentar acceder al endpoint `/api/v1/admin/console` con el token actual para comprobar que no funciona.\n    ![[Pasted image 20260210193616.png]]\n15. Si guardamos el token de administrador y hacemos otra petición:\n    ![[Pasted image 20260210193716.png]]\n    Efectivamente obtenemos el fragmento tres: `3bvyvMCM0StL`.\n16. Pero el reto no se acaba aquí, como dice en las instrucciones debemos hacer una última petición a `/api/v1/finalize` con los tres fragmentos encontrados para obtener la flag.\n    ![[Pasted image 20260210194617.png]]\n\n>[!SUCCESS] Reto de API superado, ¡phew! Este fue más complicadillo, ¿eh?",
    "modified": "2026-02-11T01:16:12"
  },
  {
    "title": "0. Ciberseguridad",
    "path": "/apuntes/0-ciberseguridad/",
    "src": "content/Ciberseguridad/0. Ciberseguridad.md",
    "breadcrumb": "",
    "content": "1. [[0. Recursos Web]]\n2. [[0. THM]]\n3. [[0. CTFs]]",
    "modified": "2026-02-10T01:18:20"
  },
  {
    "title": "0. CTFs",
    "path": "/apuntes/ctfs/0-ctfs/",
    "src": "content/Ciberseguridad/CTFs/0. CTFs.md",
    "breadcrumb": "CTFs",
    "content": "[[1. Talent Arena]]",
    "modified": "2026-02-10T01:18:20"
  }
]