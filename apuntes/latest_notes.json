[
  {
    "title": "7. Pitchfork",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/7-pitchfork/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/7. Pitchfork.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "El ataque Pitchfork en el Intruder de Burp Suite es similar a tener múltiples ataques Sniper a la vez. Mientras que el Sniper usa un set de payloads para testear todas las posiciones de forma simultánea, Pitchfork utiliza un set de payloads por posición (hasta un máximo de 20) e itera a través de ellos a la vez.\n\nPara entender Pitchfork vamos a revisar un ejemplo de fuerza bruta,pero esta vez con dos diccionarios.\n\n1. El primer diccionario contiene nombres de usuario: `joel`, `harriet` y `alex`.\n2. El segundo diccionario contiene contraseñas: `J03l`, `Emma1815` y `Sk1ll`.\n\nPodemos usar estos dos diccionarios para realizar un ataque en el formulario de login. Las peticiones ahora se mostrarán así:\n\n| Numero de Petición | Cuerpo de la Petición                |\n| ------------------ | ------------------------------------ |\n| 1                  | `username=joel&password=J03l`        |\n| 2                  | `username=harriet&password=Emma1815` |\n| 3                  | `username=alex&password=Sk1ll`       |\nComo se puede observar, el ataque de tipo Pitchfork coge un ítem de cada set de payloads y lo sustituye en la posición correspondiente.\n\n>[!CAUTION] Pitchfork deja de probar combinaciones cuando una de las dos listas se acaba.",
    "modified": "2025-11-16T00:59:50"
  },
  {
    "title": "3. Payloads",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/3-payloads/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/3. Payloads.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "En la pestaña Payloads de Burp Suite, podemos crear, asignar y configurar payloads para nuestro ataque. Esta subpestaña está dividida en 4 secciones.\n\n![[Pasted image 20251115141048.png]]\n\n1. **Payload sets:**\n\t- Esta sección nos permite elegir la posición para la cual queremos configurar el conjunto de payloads y seleccionar el tipo de payload que queremos usar.\n\t- Al usar tipos de ataque que sólo permiten un tipo de conjunto de payloads (como Sniper o Battering Ram), el desplegable de payload set sólo tendrá una opción.\n\t- Si usamos tipos de ataque que requieran múltiples conjuntos de payloads (como Pitchfork o Cluster Bomb), habrá un ítem en el desplegable para cada posición.\n2. **Payload settings:**\n\t- Esta sección ofrece opciones específicas del payload seleccionado para el set de payloads actual.\n\t- Por ejemplo, al usar el tipo de payload \"Simple List\", podemos añadir o eliminar manualmente payloads del set usando **Add**, **Paste**, **Load** y **Remove** o **Clear**.\n\t- Cada tipo de payload tendrá su propio set de opciones y funcionalidad. Explora las opciones disponibles para entender las posibilidades.\n\t  \n\t  ![[Pasted image 20251115175908.png]]\n\t  \n3. **Payload processing:**\n\t- En esta sección, podemos definir reglas para que se apliquen a cada payload en el set antes de mandarse al objetivo.\n\t- Podemos por ejemplo poner cada palabra en mayúscula, saltar payloads que coincidan con una regex o aplicar otras transformaciones o filtros.\n\t- Aunque probablemente no uses esta sección muy a menudo tiene bastante valor cuando se requiere un procesado de un payload concreto para tu ataque.\n4. **Payload encoding:**\n\t- Esta sección nos permite personalizar el tipo de encoding de nuestros payloads.\n\t- Por defecto, Burp Suite aplica URLencoding para asegurar la transmisión de los payloads.\n\t- Podemos eliminar el encoding por defecto modificando la lista de caracteres que tengan que ser encodeados o desmarcando la opción \"URL-encode there characters\".\n\nHaciendo uso de estas secciones podemos crear y personalizar conjuntos de payloads para ajustarse a nuestras necesidades.",
    "modified": "2025-11-16T00:59:50"
  },
  {
    "title": "9. Practical Example",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/9-practical-example/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/9. Practical Example.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Para poner a prueba nuestro nuevo conocimiento teórico, vamos a intentar ganar acceso al portal de soporte que nos dan. Sigue una estructura de login típica y después de inspeccionar el código fuente, encontramos que no se han tomado medidas protectoras.\n\n```html\n---\n<form method=\"POST\">\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"text\" name=username placeholder=\"Username\" required>\n        <label for=\"username\">Username</label>\n    </div>\n    <div class=\"form-floating mb-3\">\n        <input class=\"form-control\" type=\"password\" name=password  placeholder=\"Password\" required>\n        <label for=\"password\">Password</label>\n    </div>\n    <div class=\"d-grid\"><button class=\"btn btn-primary btn-lg\" type=\"submit\">Login!</button></div>\n</form>\n---\n```\n\nComo no tiene medidas de protección tenemos varias formas de explotar este formulario, como un ataque cluster bomb para bruteforcear las credenciales. Sin embargo, tenemos un acercamiento más sencillo a nuestra disposición.\n\nAproximadamente hace 3 meses, Bastion Hosting sufrió un ataque que exfiltró nombres de usuario, correos y algunas contraseñas en texto plano. Aunque la compañía alertó a los usuarios para que cambiasen sus contraseñas puede que algunos empleados no hicieran caso.\n\nComo poseemos una lista de nombres de usuarios cada uno acompañados de una contraseña, podemos probar un ataque de credential-stuffing, mucho más rápido que uno de brute-forcing.\n\n-----------------------------\n<h2>Challenge</h2>\n1. Primero descargamos la lista con nombres de usuario y contraseñas del link dado.\n   ![[Pasted image 20251115210129.png]]\n2. Entramos en la página dada.\n   ![[Pasted image 20251115210202.png]]\n3. Abrimos Burp Suite.\n   ![[Pasted image 20251115210219.png]]\n4. Mandamos una petición de login que interceptamos y mandamos al Intruder.\n   ![[Pasted image 20251115210247.png]]\n5. Una vez en el intruder seleccionamos Pitchfork.\n   ![[Pasted image 20251115210312.png]]\n6. Le damos a `Auto §` y se rellenarán username y password:\n   ![[Pasted image 20251115210455.png]]\n7. Descomprimimos las listas:\n   ![[Pasted image 20251115210548.png]]\n8. En el primer payload set seleccionamos la lista de usuarios y en la segunda la de contraseñlas con el botón `Load`.\n   ![[Pasted image 20251115210725.png]]\n   ![[Pasted image 20251115210742.png]]\n9. Le damos a comenzar ataque y esperamos. Como no devuelve códigos de estado válidos porque todos son diferentes, debemos fijarnos en la longitud de la respuesta, la que es diferente será del usuario que ha olvidado cambiar la contraseña y por lo tanto es un login exitoso.\n   ![[Pasted image 20251115210954.png]]",
    "modified": "2025-11-16T00:59:50"
  },
  {
    "title": "8. Cluster Bomb",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/8-cluster-bomb/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/8. Cluster Bomb.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "El tipo de ataque Cluster bomb en el intruder de Burp Suite nos permite elegir múltiples sets de payloads, uno por posición (hasta un máximo de 20). Al contrario que Pitchfork, donde todos los sets de payloads se testean de forma simultánea, Cluster bomb itera a través de cada set de payloads individualmente asegurándose de que cada combinación posible se compruebe.\n\nPara ilustrarlo usaremos los mismos diccionarios de antes:\n\n1. El primer diccionario contiene nombres de usuario: `joel`, `harriet` y `alex`.\n2. El segundo diccionario contiene contraseñas: `J03l`, `Emma1815` y `Sk1ll`.\n\nEn este caso, la tabla de peticiones se ve así:\n\n| Número de Petición | Cuerpo de la Petición                |\n| ------------------ | ------------------------------------ |\n| 1                  | `username=joel&password=J03l`        |\n| 2                  | `username=harriet&password=J03l`     |\n| 3                  | `username=alex&password=J03l`        |\n| 4                  | `username=joel&password=Emma1815`    |\n| 5                  | `username=harriet&password=Emma1815` |\n| 6                  | `username=alex&password=Emma1815`    |\n| 7                  | `username=joel&password=Sk1ll`       |\n| 8                  | `username=harriet&password=Sk1ll`    |\n| 9                  | `username=alex&password=Sk1ll`       |\nPodemos calcular el número de peticiones multiplicando las entradas de cada diccionario entre sí. La edición de comunidad tiene un límite de frecuencia de petición. Puede saturar la red en ataques muy grandes ya que prueba cada combinación.",
    "modified": "2025-11-16T00:59:50"
  },
  {
    "title": "5. Sniper",
    "path": "/apuntes/thm/1-career/2-penetration-tester/1-jr-penetration-tester/4-burp-suite/3-burp-suite-intruder/5-sniper/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/1. Jr Penetration Tester/4. Burp Suite/3. Burp Suite - Intruder/5. Sniper.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 1. Jr Penetration Tester > 4. Burp Suite > 3. Burp Suite - Intruder",
    "content": "Es el tipo de ataque por defecto y el más común de Burp Suite Intruder. Es particularmente efectivo para posiciones únicas de ataque como ataques de fuerza bruta en contraseñas o fuzzing endpoints de APIs. En un ataque Sniper, proporcionamos un conjunto de payloads que puede ser desde una lista de palabras hasta un rango de números y el Intruder lo inserta en la posición definida.\n\nTomemos la siguiente petición de ejemplo:\n\n```python\nPOST /support/login/ HTTP/1.1\nHost: MACHINE_IP\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 37\nOrigin: http://MACHINE_IP\nConnection: close\nReferer: http://MACHINE_IP/support/login/\nUpgrade-Insecure-Requests: 1\n\nusername=§pentester§&password=§Expl01ted§\n```\n\nEn este ejemplo tenemos dos posiciones definidas: `username` y `password`. En un ataque sniper, el intruder toma cada payload del conjunto de payloads u lo sustituye en cada una de las posiciones por turnos. Asumiendo un diccionario de tres palabras: `burp`, `suite` e `intruder`, el Intruder generaría seis peticiones:\n\n| Número de Petición | Cuerpo de la Petición                  |\n| ------------------ | -------------------------------------- |\n| 1                  | `username=burp&password=Expl01ted`     |\n| 2                  | `username=suite&password=Expl01ted`    |\n| 3                  | `username=intruder&password=Expl01ted` |\n| 4                  | `username=pentester&password=burp`     |\n| 5                  | `username=pentester&password=suite`    |\n| 6                  | `username=pentester&password=intruder` |\nObserva cómo al principio la segunda posición no la cambia y al final no toca la primera. La forma de calcular el número de peticiones es `peticiones = numeroDePalabras * numeroDePosiciones`.",
    "modified": "2025-11-16T00:59:50"
  }
]