[
  {
    "title": "1. Breaking the Logging Form",
    "path": "/apuntes/recursos-web/1-dvwa/1-brute-force/1-breaking-the-logging-form/",
    "src": "content/Ciberseguridad/Recursos Web/1. DVWA/1. Brute Force/1. Breaking the Logging Form.md",
    "breadcrumb": "Recursos Web > 1. DVWA > 1. Brute Force",
    "content": "Para romper este portal de login, vamos a usar dos herramientas distintas:\n\n- FFUF\n- WFUZZ\n\n![[Pasted image 20251203172440.png]]\n\n---------------------------------\n<h2>FFUF</h2>\n1. Si abrimos las herramientas de desarrollador, podemos ver que en la petición se mandan los parámetros `username` y `password` por GET.\n   ![[Pasted image 20251203174307.png]]\n2. Podemos ver que hay una cookie de sesión además.\n   ![[Pasted image 20251203174358.png]]\n3. Usamos `ffuf` para el ataque.\n   ![[Pasted image 20251203175228.png]]\n   Como la longitud es siempre la misma, vamos a restringirla.\n4. Arreglamos el comando y le añadimos `time` para poder compararla después.\n   ![[Pasted image 20251203180015.png]]\n5. Iniciamos sesión con las credenciales.\n   ![[Pasted image 20251203175900.png]]\n\n-----------------------------------------------\n<h2>WFUZZ</h2>\n1. Cerramos y volvemos a iniciar sesión, mandamos una petición y vemos que seguimos teniendo una cookie y el método es GET con parámetros `username` y `password`.\n   ![[Pasted image 20251204105136.png]]\n2. Metemos el comando correspondiente:\n   ![[Pasted image 20251204113336.png]]\n3. Obtenemos las mismas credenciales con ambos, nos registramos.\n   ![[Pasted image 20251203175900.png]]\n\n----------------------------------------------------\n\n>[!NOTE] Conclusión: Aunque ambos sirven y nos han reportado correctamente el usuario:contraseña, WFUZZ ha demostrado ser más eficiente. Sin embargo, la documentación CLI está mejor redactada (y tiene más ejemplos, por lo que es más clara) del lado de FFUF. Cada una tiene sus ventajas, queda a preferencia del usuario.",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "2. Anatomy of SSRF Attack",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/2-anatomy-of-ssrf-attack/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/2. Anatomy of SSRF Attack.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "Al desarrolar software de red es común hacer peticiones a servidores externos. Los desarrolladores suelen usar estas peticiones para obtener recursos remotos como actualizaciones de software o información importante de otras aplicaciones. Aunque estas peticiones suelen ser segurasm la implementación indebida puede llevar a SSRF.\n\n![[Pasted image 20260122124036.png]]\n\nUna vulnerabilidad SSRF puede surgir cuando la información dada por el usuario se utiliza para construir una petición, como formar una URL. Para ejecutar un ataque SSRF, in atacante puede manipular el valor de un parámetro en el software vulnerable.\n\nLas vulnerabilidades SSRF pueden ser encontradas en varios tipos de software y lenguajes de programación, aunque la mayoría se encuentran en aplicaciones web.\n\n------------------------------------------------\n<h2>OWASP Ranking</h2>\nSSRF es una amenaza de seguridad seria, mereciendo su lugar en la lista del OWASP Top 10.\n\n| **Max Incidence Rate** | **Avg Incidence Rate  <br>** | **Avg Weighted Exploit** | **Avg Weighted Impact  <br>** | **Max Coverage  <br>** | **Total Occurrences  <br>** | **Total CVEs** |\n| ---------------------- | ---------------------------- | ------------------------ | ----------------------------- | ---------------------- | --------------------------- | -------------- |\n| 2.72%                  | 2.72%                        | 8.28                     | 6.72                          | 67.2%                  | 9503                        | 385            |\n\nLa tabla de arriba ofrece una vista detallada de la prevalencia, impacto y cubierta de una vulnerabilidad SSRF en un contexto específico. La interpretación es la siguiente:\n\n- **Max Incidence Rate:** Sugiere cómo de habitualmente esta vulnerabilidad ha sido encontrada relativa a otras vulnerabilidades.\n- **Avg Incidence Rate:** Muestra cómo de comín es esta vulnerabilidad comparada con otras.\n- **Avg Weighted Exploit:** Indica la dificultad media o esfuerzo requerido para explotar una vulnerabilidad SSRF.\n- **Avg Weighted Impact:** Potencial medio de impacto oo severidad de explotar una vulnerabilidad SSRF.\n- **Max Coverage:** Indica cuántos de los sistemas han sido explotados debido a esta vulnerabilidad.\n- **Total Occurrences:** Explotaciones totales debido a esta vulnerabilidad que OWASP ha analizado.\n- **Total CVEs:** CVEs totales sobre SSRF. Estos son CVE-2021-21311, CVE-2018-11759 y CVE-2017-9506 (información de 2021).\n\n----------------------------------------\n<h2>Riesgo de SSRF</h2>\n<h4>Exposición de Información</h4>\nComo hemos explicado antes, los cibercriminales pueden ganar acceso no autorizado alterando las peticiones en nombre de la aplicación web vulnerable para ganar acceso a información sensible hosteada en la red interna.\n<h4>Reconocimiento</h4>\nUn atacante puede llevar acabo escaneo de redes internas ejecutando scripts maliciosos en servidores vulnerables o redirigiendo a scripts hosteados en un servidor externo.\n<h4>Denegación de Servicio</h4>\nEs un escenario común en el que los servidores o redes no esperan tantas peticiones. Los atacantes inundan los servidores con demasiadas peticiones (legítimas), haciendo que se caigan incapaces de manejar peticiones genuinas.",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "4. Types of SSRF - Basic - continued",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/4-types-of-ssrf-basic-continued/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/4. Types of SSRF - Basic - continued.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "En esta tarea vamos a continuar aprendiendo sobre técnicas básicas de SSRF.\n\n----------------------------------------\n<h2>Escenario 2: Acceder a un Servidor Interno</h2>\nEn aplicaciones web complejas, es común para las aplicaciones front-end interactuar con servidores back-end internos. Estos servidores suelen estar hosteados en direcciones IP no ruteables, por lo que un usuario de internet no puede acceder a ellos. En este contexto, un atacante explota la validación del input vulnerable de la web para engañar al servidor para que mande peticiones internas a recursos en la misma red.\n\nPor ejemplo, si un servidor interno ofrece manejo de base de datos o controles administrativos, el atacante podría construir una URL que inicie una acción no deseada en estos sistemas internos. Técnicamente se consigue a través de input manipulado, como direcciones IP especiales (como `192.168.x.x` o `10.x.x.x` para IPv4) o nombres de dominio (por ejemplo `internal-database.hrms.thm`).\n\nAdemás, como estos servidores internos pueden estar faltos del mismo nivel de seguridad y monitorización que los servidores externos, dicha explotación puede no ser vista. El atacante puede usar también este método para realizar reconocimiento en la red interna, identificando otros objetivos o sistemas vulnerables.\n\n<h4>Cómo Funciona</h4>\n- En este caso, trataremos de acceder a recursos internos inaccesibles a través de peticiones directas.\n- Ahora que hemos adquirido las credenciales del panel de login, vamos a iniciar sesión en la dashboard.\n- Una vez logueados en la app HRMS, veremos un dashboard que lista empleados y sus departamentos. Hay un menú que muestra los datos de los empleados y su salario.\n  ![[Pasted image 20260122222157.png]]\n- Desde el archivo de configuración, podemos ver que el panel de admin está hosteado en `http://192.168.2.10/admin.php`. Si intentamos loguearnos no es accesible directamente.\n  ![[Pasted image 20260122222313.png]]\n- No tenemos ruta a esa IP ya que forma parte de una red privada y sólo puede ser accedida por una máquina en la misma red.\n-",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "3. Types of SSRF - Basic",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/3-types-of-ssrf-basic/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/3. Types of SSRF - Basic.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "El SSRF básico es una técnica de ataque web donde un atacante engaña al servidor para que haga peticiones en su ppropio nombre, normalmente a sistemas internos o a servicios de terceros. Explotando las vulnerabilidades en la validación de input, el atacante puede ganar acceso no autorizado a información sensible o control sobre recursos remostos.\n\nUn SSRF básico puede emplearse contra un servidor local o interno. exploraremos ambos escenarios en detalle.\n\n----------------------------------------\n<h2>Escenario 1: SSRF Contra un Servidor Local</h2>\n\nEn este ataque, el atacante hace una petición no autorizada al servidor que hostea la aplicación web. El atacante da una dirección IP loopback o localhost para obtener la respuesta. La vulnerabilidad surge debido a cómo la aplicación maneja el input para formar la query o llamada a la API.\n\nPor ejemplo, en la aplicación HRMS, hay una funcionalidad que carga páginas adicionales basado en un parámetro URL. Por ejemplo, navegar a `http://hrms.thm?url=localhost/copyright` cargaría una página de copyright de la aplicación. Esta funcionalidad está hecha para uso interno y está diseñada para pedir y mostrar páginas del servidor local (usando por ello `localhost` en la query).\n\nSin embargo, debido a validación insuficiente en el input URL, un atacante puede manipular esta funcionalidad para hacer un ataque SSRF. Cambiando el parámetro de la URL para apuntar a otra página/servicio, el atacante puede forzar que el servidor HRMS haga peticiones a donde él quiera. Por ejemplo, si el atacante usa una URL como `http://hrms.thm/?url=localhost/config` y `config` es una página válida, el servidor HRMS intentará cargar el contenido de esta página y cargar el resultado..\n\nLa idea principal es suplantar una petición legítima y hacer que el servidor realice una ación que no debería.\n\n<h4>Cómo Funciona</h4>\n- Supón que te han mandado hacer un pentest en el sitio web HRMS e identificar cualquier agujero de SSRF que veas. Visita el sitio web `http://hrms.thm` y verás que la página de login está protegida mediante un usuario y contraseña.\n  ![[Pasted image 20260122133737.png]]\n- Vemos que una vez que visitamos la página `http://hrms.thm`, automáticamente nos redirige a `http://hrms.thm/?url=localhost/copyright`. La página web muestra el estado del copyright de la web.\n  ![[Pasted image 20260122133829.png]]\n- Esto significa que el desarrollador probablemente ha incurrido en algunos errores al manejar un archivo que muestra el estado del copyright. Aquí está el código de la página que toma los parámetros.\n\n```php\n$uri = rtrim($_GET['url'], \"/\");\n...\t\t\t\t\t\n$path = ROOTPATH . $file;\n...\nif (file_exists($path)) {\n  echo \"<pre>\";\n  echo htmlspecialchars(file_get_contents($path));\n  echo \"</pre>\";\n  } else { ?>\n    <p class=\"text-xl\"><?= ltrim($file, \"/\") ?> is not found</p>\n <?php\n... \n```\n\n- Podemos ver que en el código de arrina el parámetro `url` no tiene el filtrado adecuado y carga lo que el parámetro le pase desde `localhost`.\n- Intentaremos cambiar la URL a `http://hrms.thm/?url=localhost/hello`. Muestra un error: `hello.php is not found`.\n  ![[Pasted image 20260122134059.png]]\n- Así que la página llama a un archivo PHP y lo muestra en el footer de la página actual. ¿Qué pasa si llamamos a archivos sensibles como `connection.php` o `config.php`?\n- Cuando intentamos acceder al archivo `http://hrms.thm/?url=localhost/config`, veremos que el footer muestra el contenido de esta página.\n\n```php\n<?php \n$adminURL = \"xxxxxxx\";\n$username = \"xxxxx\"; \n$password = \"xxxx\"; \n...\n?>\n```",
    "modified": "2026-01-23T00:56:08"
  },
  {
    "title": "1. Introduction",
    "path": "/apuntes/thm/1-career/2-penetration-tester/3-web-application-pentesting/3-advanced-server-side-attacks/2-ssrf/1-introduction/",
    "src": "content/Ciberseguridad/THM/1. Career/2. Penetration Tester/3. Web Application Pentesting/3. Advanced Server-Side Attacks/2. SSRF/1. Introduction.md",
    "breadcrumb": "THM > 1. Career > 2. Penetration Tester > 3. Web Application Pentesting > 3. Advanced Server-Side Attacks > 2. SSRF",
    "content": "El marco de los ataques web evoluciona constantemente con métodos más sofisticados de comprometer sistemas. Cada día que pasa, la expansión de las amenazas basadas en web, garantiza la necesidad de medidas de ciberseguridad robusta para contrarestar estas tácticas empleadas. En esta unidad exploraremos un tipo de ataque conocido como **Server Side Request Forgery (SSRF)**.\n\nSSRF es una vulnerabilidad de aplicación web que permite al atacante forzar al servidor a hacer peticiones no autorizadas a cualquier fuente local o externa en nombre del servidor. SSRF permite a un atacante interactuar con sistemas internos, llevando potencialmente a filtración de información o incluso RCE.\n\n-------------------------------------------\n<h2>Objetivos de Aprendizaje</h2>\n- Entender cómo funciona SSRF.\n- Probar varios tipos de SSRF.\n- Herramientas importantes para la explotación.\n- Medidas de mitigación y defensa claves.\n\n-----------------------------------------\n<h2>Pre-requisitos</h2>\n- [[Ciberseguridad/THM/0. Pre Career/1. Pre Security/3. How the Web Works/3. How Websites Work/0. How Websites Work]]\n- [[0. Protocols and Servers]]\n- [[Ciberseguridad/THM/0. Pre Career/2. Cyber Security 101/8. Web Hacking/5. OWASP Top 10 - 2021/0. OWASP Top 10 - 2021]]",
    "modified": "2026-01-23T00:56:08"
  }
]