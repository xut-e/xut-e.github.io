---
layout: apunte
title: "5. Exploiting HTTP Basic Authentication"
---

<h2>Basic Authentication in 2k24?</h2>
La autentificación básica ofrece un método más directo de securizar el acceso a los dispositivos. Sólo requiere un usuario y una contraseña, haciéndolo sencillo de implementar y manejar en dispositivos con capacidades de procesamiento básicas. Los dispositivos de redo como los routers suelen usar este método. En este escenario el objetivo principal es protegerlo de acceso no autorizado.

Mientras que la autentificación básica no ofrece las robustas funcionalidades de seguridad ofrecida por esquemas más complejos como OAuth o autentificación basada en tokens, su simplicidad lo hace adecuado para entornos donde el manejo de sesión y el rastreo de usuarios no se requiera.

La autentificación básica HTTP se define en [RFC 7617](https://datatracker.ietf.org/doc/html/rfc7617), el cual especifica que las credenciales deberían ser transportadas como una string bas64-encodeada en el header de autorización HTTP. Es directo pero no es seguro en conexiones no-HTTPS ya que bas64 no es un mecanismo de encriptación. El riesgo real viene dado por credenciales débiles.

La [autentificación básica HTTP](_https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication_) ofrece un mecanismo simple de pregunta respuesta para pedir credenciales de usuario.

!**Pasted image 20251202172103.png**

El formato del header de autorización es el siguiente:

```html
Authorization: Basic <credentials>
```

Donde `<credentials>` es el encoding base64 de `username:password`.

-------------------------------------
<h2>Explotación</h2>
Para demostrar esto, iremos a la página dada.

!**Pasted image 20251202172348.png**

Introducimos cualquier usuario y contraseña en el pop--up.

!**Pasted image 20251202172436.png**

Capturamos la petición básica de autentificación usando Burp Suite

!**Pasted image 20251202172701.png**

Convertimos el texto base64:

!**Pasted image 20251202172950.png**

Una vez decodeado lo highlighteamos con el intruder.

!**Pasted image 20251202173135.png**

Usaremos la lista `/usr/share/wordlists/SecLists/Passwords/Common-Credentials/500-worst-passwords.txt`.

!**Pasted image 20251202173242.png**

Ahora necesitamos configurar dos normas:

1. La primera que configuraremos añade el prefijo `admin:` para que el payload sea `username:password`.
   !**Pasted image 20251202173353.png**
2. La segunda convierte el payload a base64.
   !**Pasted image 20251202173411.png**

También deberíamos borrar el `=` porque base64 lo utiliza para hacer que tengan la misma longitud. Para hacerlo vamos hasta abajo y lo borramos de la lista de caracteres a quitar en el payload.

!**Pasted image 20251202173526.png**

Una vez hecho vamos arrancamos el ataque.

!**Pasted image 20251202174019.png**

Encontramos la contraseña.

!**Pasted image 20251202174418.png**

Nos registramos pa obtener la flag.

!**Pasted image 20251202174510.png**